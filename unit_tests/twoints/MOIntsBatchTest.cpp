//
//                     V.E.L.O.X. C.H.E.M. MP
//      ---------------------------------------------------
//           An Electronic Structure Code for Nanoscale
//
//  Copyright Â© 2018 by Velox Chem MP developers. All rights reserved.
//  Contact: Zilvinas Rinkevicius (rinkevic@kth.se), KTH, Sweden.

#include "MOIntsBatchTest.hpp"

#include "MOIntsBatch.hpp"

#include "mpi.h"

#include "ElectronRepulsionIntegralsDriver.hpp"
#include "MolecularBasisSetter.hpp"
#include "MoleculeSetter.hpp"
#include "CheckFunctions.hpp"
#include "EriScreenerType.hpp"

TEST_F(CMOIntsBatchTest, DefaultConstructor)
{
    CMOIntsBatch mbatcha;
    
    CMOIntsBatch mbatchb({}, {}, {-1, -1}, moints::oooo);
    
    ASSERT_EQ(mbatcha, mbatchb);
}

TEST_F(CMOIntsBatchTest, CopyConstructor)
{
    CDenseMatrix ma({1.0, -1.0, -3.0, -2.0, 5.0, 4.0, 6.0, 4.0, -4.0}, 3, 3);
    
    CDenseMatrix mb({1.0, -1.0, -3.0, -2.0, 5.0, 4.0}, 3, 2);
    
    CMOIntsBatch mbatcha({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {2, 3}, moints::vvvv);
    
    CMOIntsBatch mbatchb(mbatcha);
    
    ASSERT_EQ(mbatchb, mbatcha);
}

TEST_F(CMOIntsBatchTest, MoveConstructor)
{
    CDenseMatrix ma({1.0, -1.0, -3.0, -2.0, 5.0, 4.0, 6.0, 4.0, -4.0}, 3, 3);
    
    CDenseMatrix mb({1.0, -1.0, -3.0, -2.0, 5.0, 4.0}, 3, 2);
    
    CMOIntsBatch mbatcha({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {2, 3}, moints::vvvv);
    
    CMOIntsBatch mbatchb(CMOIntsBatch({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1},
                                      {0, 1}}, {2, 3}, moints::vvvv));
    
    ASSERT_EQ(mbatchb, mbatcha);
}

TEST_F(CMOIntsBatchTest, CopyAssignment)
{
    CDenseMatrix ma({1.0, -1.0, -3.0, -2.0, 5.0, 4.0, 6.0, 4.0, -4.0}, 3, 3);
    
    CDenseMatrix mb({1.0, -1.0, -3.0, -2.0, 5.0, 4.0}, 3, 2);
    
    CMOIntsBatch mbatcha({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {2, 3}, moints::vvvv);
    
    CMOIntsBatch mbatchb = mbatcha;
    
    ASSERT_EQ(mbatchb, mbatcha);
}

TEST_F(CMOIntsBatchTest, MoveAssignment)
{
    CDenseMatrix ma({1.0, -1.0, -3.0, -2.0, 5.0, 4.0, 6.0, 4.0, -4.0}, 3, 3);
    
    CDenseMatrix mb({1.0, -1.0, -3.0, -2.0, 5.0, 4.0}, 3, 2);
    
    CMOIntsBatch mbatcha({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {2, 3}, moints::vvvv);
    
    CMOIntsBatch mbatchb = CMOIntsBatch({ma, ma, mb, mb}, {{0, 1}, {0, 1},
                                        {0, 1}, {0, 1}}, {2, 3}, moints::vvvv);
    
    ASSERT_EQ(mbatchb, mbatcha);
}

TEST_F(CMOIntsBatchTest, Append)
{
    CDenseMatrix bvec({ 1.0, -1.0, -3.0,
                       -2.0,  5.0,  4.0,
                        6.0,  4.0, -4.0},
                        3, 3);
    
    CDenseMatrix kvec({ 1.0, -1.0,
                       -3.0, -2.0,
                        5.0, 4.0},
                        3, 2);
    
    CDenseMatrix ma({2.0, 3.0, -2.0,
                    -2.0, 1.0,  2.0,
                     2.0, 5.0,  1.0},
                    3, 3);
    
    CAOFockMatrix fmata({ma}, {fockmat::restjk}, {1.0}, {0});
    
    CMOIntsBatch mbatcha;
    
    mbatcha.append(fmata, bvec, kvec, {0}, {1});
    
    CDenseMatrix mc({-75.0, -80.0, 10.0, 24.0, 103.0, 112.0}, 3, 2);
    
    CMOIntsBatch mbatchb({mc}, {{0, 1}}, {-1, -1}, moints::oooo);
    
    ASSERT_EQ(mbatchb, mbatcha);
}

TEST_F(CMOIntsBatchTest, SetBatchType)
{
    CDenseMatrix ma({1.0, -1.0, -3.0, -2.0, 5.0, 4.0, 6.0, 4.0, -4.0}, 3, 3);
    
    CDenseMatrix mb({1.0, -1.0, -3.0, -2.0, 5.0, 4.0}, 3, 2);
    
    CMOIntsBatch mbatcha({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {2, 3}, moints::vvvv);
    
    mbatcha.setBatchType(moints::ovov);
    
    CMOIntsBatch mbatchb({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {2, 3}, moints::ovov);
    
    ASSERT_EQ(mbatcha, mbatcha);
}

TEST_F(CMOIntsBatchTest, SetExternalIndexes)
{
    CDenseMatrix ma({1.0, -1.0, -3.0, -2.0, 5.0, 4.0, 6.0, 4.0, -4.0}, 3, 3);
    
    CDenseMatrix mb({1.0, -1.0, -3.0, -2.0, 5.0, 4.0}, 3, 2);
    
    CMOIntsBatch mbatcha({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {2, 3}, moints::vvvv);
    
    mbatcha.setExternalIndexes({0, 2});
    
    CMOIntsBatch mbatchb({ma, ma, mb, mb}, {{0, 1}, {0, 1}, {0, 1}, {0, 1}},
                         {0,2}, moints::vvvv);
    
    ASSERT_EQ(mbatcha, mbatcha);
}

TEST_F(CMOIntsBatchTest, AppendForOOVV)
{
    auto mh2o = vlxmol::getMoleculeH2O();
    
    auto mbas = vlxbas::getMolecularBasisForH2O();
    
    const int nrows = 24, ncols = 24;

    std::vector<double> denvals00{ 0.0095186019501707,   0.0198338857587629,   0.0331284691808949,
                                  -0.0199531501425190,  -0.0048825505291082,  -0.0199531501425189,
                                  -0.0048825505291071,  -0.0000000000000004,  -0.0000000000000002,
                                   0.0029972104792981,  -0.0029972104792979,  -0.0534350863659201,
                                  -0.0348061419804969,  -0.0007297784768462,  -0.0007297784768462,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0017728811371704,   0.0000000000000000,   0.0003716105102611,
                                   0.0198338857587629,   0.0413278154030384,   0.0690297037880422,
                                  -0.0415763262846669,  -0.0101737576497756,  -0.0415763262846667,
                                  -0.0101737576497734,  -0.0000000000000008,  -0.0000000000000004,
                                   0.0062452795644321,  -0.0062452795644318,  -0.1113425484161860,
                                  -0.0725254661722748,  -0.0015206374859189,  -0.0015206374859191,
                                  -0.0000000000000001,  -0.0000000000000001,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000001,
                                  -0.0036941477459170,   0.0000000000000000,   0.0007743238393473,
                                   0.0331284691808949,   0.0690297037880422,   0.1153000699067805,
                                  -0.0694447906340229,  -0.0169931913924419,  -0.0694447906340226,
                                  -0.0169931913924383,  -0.0000000000000013,  -0.0000000000000006,
                                   0.0104314683513265,  -0.0104314683513261,  -0.1859750645230089,
                                  -0.1211390294439259,  -0.0025399154104395,  -0.0025399154104398,
                                  -0.0000000000000002,  -0.0000000000000001,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000001,
                                  -0.0061703219045826,   0.0000000000000000,   0.0012933503681454,
                                  -0.0199531501425190,  -0.0415763262846669,  -0.0694447906340229,
                                   0.0418263315026808,   0.0102349341106740,   0.0418263315026806,
                                   0.0102349341106718,   0.0000000000000008,   0.0000000000000004,
                                  -0.0062828334471002,   0.0062828334470999,   0.1120120692848752,
                                   0.0729615736065348,   0.0015297813266610,   0.0015297813266612,
                                   0.0000000000000001,   0.0000000000000001,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000001,
                                   0.0037163612576705,  -0.0000000000000000,  -0.0007789799746428,
                                  -0.0048825505291082,  -0.0101737576497756,  -0.0169931913924419,
                                   0.0102349341106740,   0.0025044959116992,   0.0102349341106740,
                                   0.0025044959116986,   0.0000000000000002,   0.0000000000000001,
                                  -0.0015374139698407,   0.0015374139698406,   0.0274094358157486,
                                   0.0178537507748226,   0.0003743386168378,   0.0003743386168379,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0009093963356858,  -0.0000000000000000,  -0.0001906169732694,
                                  -0.0199531501425189,  -0.0415763262846667,  -0.0694447906340226,
                                   0.0418263315026806,   0.0102349341106740,   0.0418263315026804,
                                   0.0102349341106718,   0.0000000000000008,   0.0000000000000004,
                                  -0.0062828334471001,   0.0062828334470999,   0.1120120692848747,
                                   0.0729615736065344,   0.0015297813266610,   0.0015297813266611,
                                   0.0000000000000001,   0.0000000000000001,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000001,
                                   0.0037163612576705,  -0.0000000000000000,  -0.0007789799746428,
                                  -0.0048825505291071,  -0.0101737576497734,  -0.0169931913924383,
                                   0.0102349341106718,   0.0025044959116986,   0.0102349341106718,
                                   0.0025044959116981,   0.0000000000000002,   0.0000000000000001,
                                  -0.0015374139698404,   0.0015374139698403,   0.0274094358157427,
                                   0.0178537507748188,   0.0003743386168378,   0.0003743386168378,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0009093963356857,  -0.0000000000000000,  -0.0001906169732694,
                                  -0.0000000000000004,  -0.0000000000000008,  -0.0000000000000013,
                                   0.0000000000000008,   0.0000000000000002,   0.0000000000000008,
                                   0.0000000000000002,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000001,   0.0000000000000001,   0.0000000000000020,
                                   0.0000000000000013,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000001,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000002,  -0.0000000000000004,  -0.0000000000000006,
                                   0.0000000000000004,   0.0000000000000001,   0.0000000000000004,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000001,   0.0000000000000001,   0.0000000000000010,
                                   0.0000000000000006,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0029972104792981,   0.0062452795644321,   0.0104314683513265,
                                  -0.0062828334471002,  -0.0015374139698407,  -0.0062828334471001,
                                  -0.0015374139698404,  -0.0000000000000001,  -0.0000000000000001,
                                   0.0009437594621816,  -0.0009437594621816,  -0.0168256012444412,
                                  -0.0109597327458378,  -0.0002297921175630,  -0.0002297921175631,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0005582435268009,   0.0000000000000000,   0.0001170124479837,
                                  -0.0029972104792979,  -0.0062452795644318,  -0.0104314683513261,
                                   0.0062828334470999,   0.0015374139698406,   0.0062828334470999,
                                   0.0015374139698403,   0.0000000000000001,   0.0000000000000001,
                                  -0.0009437594621816,   0.0009437594621815,   0.0168256012444404,
                                   0.0109597327458373,   0.0002297921175630,   0.0002297921175631,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0005582435268009,  -0.0000000000000000,  -0.0001170124479837,
                                  -0.0534350863659201,  -0.1113425484161860,  -0.1859750645230089,
                                   0.1120120692848752,   0.0274094358157486,   0.1120120692848747,
                                   0.0274094358157427,   0.0000000000000020,   0.0000000000000010,
                                  -0.0168256012444412,   0.0168256012444404,   0.2999714107051324,
                                   0.1953931063121058,   0.0040967965823557,   0.0040967965823561,
                                   0.0000000000000003,   0.0000000000000002,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000002,
                                   0.0099525179408846,  -0.0000000000000000,  -0.0020861298554387,
                                  -0.0348061419804969,  -0.0725254661722748,  -0.1211390294439259,
                                   0.0729615736065348,   0.0178537507748226,   0.0729615736065344,
                                   0.0178537507748188,   0.0000000000000013,   0.0000000000000006,
                                  -0.0109597327458378,   0.0109597327458373,   0.1953931063121058,
                                   0.1272736821970770,   0.0026685403394731,   0.0026685403394734,
                                   0.0000000000000002,   0.0000000000000001,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000001,
                                   0.0064827957821886,  -0.0000000000000000,  -0.0013588474703853,
                                  -0.0007297784768462,  -0.0015206374859189,  -0.0025399154104395,
                                   0.0015297813266610,   0.0003743386168378,   0.0015297813266610,
                                   0.0003743386168378,   0.0000000000000000,   0.0000000000000000,
                                  -0.0002297921175630,   0.0002297921175630,   0.0040967965823557,
                                   0.0026685403394731,   0.0000559511394694,   0.0000559511394694,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0001359244248984,  -0.0000000000000000,  -0.0000284908806543,
                                  -0.0007297784768462,  -0.0015206374859191,  -0.0025399154104398,
                                   0.0015297813266612,   0.0003743386168379,   0.0015297813266611,
                                   0.0003743386168378,   0.0000000000000000,   0.0000000000000000,
                                  -0.0002297921175631,   0.0002297921175631,   0.0040967965823561,
                                   0.0026685403394734,   0.0000559511394694,   0.0000559511394694,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0001359244248984,  -0.0000000000000000,  -0.0000284908806543,
                                  -0.0000000000000001,  -0.0000000000000001,  -0.0000000000000002,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000003,
                                   0.0000000000000002,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000001,  -0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000002,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000001,  -0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000002,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0017728811371704,  -0.0036941477459170,  -0.0061703219045826,
                                   0.0037163612576705,   0.0009093963356858,   0.0037163612576705,
                                   0.0009093963356857,   0.0000000000000001,   0.0000000000000000,
                                  -0.0005582435268009,   0.0005582435268009,   0.0099525179408846,
                                   0.0064827957821886,   0.0001359244248984,   0.0001359244248984,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0003302068458150,  -0.0000000000000000,  -0.0000692140786499,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0003716105102611,   0.0007743238393473,   0.0012933503681454,
                                  -0.0007789799746428,  -0.0001906169732694,  -0.0007789799746428,
                                  -0.0001906169732694,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0001170124479837,  -0.0001170124479837,  -0.0020861298554387,
                                  -0.0013588474703853,  -0.0000284908806543,  -0.0000284908806543,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000692140786499,   0.0000000000000000,   0.0000145078418091};
    
    std::vector<double> denvals01{ 0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000001,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000001,   0.0000000000000001,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0000000000000001,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000002,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000001,  -0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000002,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000001,  -0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000002,
                                   0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000001,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0616722203653251,   0.1285062427884347,   0.2146435224821419,
                                  -0.1292789717454018,  -0.0316346595594947,  -0.1292789717454012,
                                  -0.0316346595594879,  -0.0000000000000023,  -0.0000000000000011,
                                   0.0194193040247067,  -0.0194193040247059,  -0.3462126516951466,
                                  -0.2255133757588734,  -0.0047283266258571,  -0.0047283266258576,
                                  -0.0000000000000004,  -0.0000000000000002,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000002,
                                  -0.0114867200819488,   0.0000000000000000,   0.0024077112793319,
                                   0.0484221793351723,   0.1008971672680262,   0.1685281813626263,
                                  -0.1015038783595045,  -0.0248380737603252,  -0.1015038783595041,
                                  -0.0248380737603199,  -0.0000000000000018,  -0.0000000000000009,
                                   0.0152471407138971,  -0.0152471407138965,  -0.2718301856035269,
                                  -0.1770626881729054,  -0.0037124637069375,  -0.0037124637069379,
                                  -0.0000000000000003,  -0.0000000000000002,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000002,
                                  -0.0090188421381011,   0.0000000000000000,   0.0018904237055923,
                                   0.0028951231052361,   0.0060325603725638,   0.0100761642380677,
                                  -0.0060688351401033,  -0.0014850484265760,  -0.0060688351401033,
                                  -0.0014850484265756,  -0.0000000000000001,  -0.0000000000000001,
                                   0.0009116142638695,  -0.0009116142638695,  -0.0162525078764837,
                                  -0.0105864355269166,  -0.0002219652151736,  -0.0002219652151736,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0005392293080359,   0.0000000000000000,   0.0001130269108886,
                                   0.0028951231052361,   0.0060325603725637,   0.0100761642380677,
                                  -0.0060688351401033,  -0.0014850484265760,  -0.0060688351401033,
                                  -0.0014850484265756,  -0.0000000000000001,  -0.0000000000000001,
                                   0.0009116142638695,  -0.0009116142638695,  -0.0162525078764837,
                                  -0.0105864355269166,  -0.0002219652151736,  -0.0002219652151736,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0005392293080359,   0.0000000000000000,   0.0001130269108886,
                                   0.0000000000000000,   0.0000000000000001,   0.0000000000000001,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0000000000000001,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000002,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0018245313321243,   0.0038017711208091,   0.0063500848467324,
                                  -0.0038246317894355,  -0.0009358902145160,  -0.0038246317894355,
                                  -0.0009358902145158,  -0.0000000000000001,  -0.0000000000000000,
                                   0.0005745071027319,  -0.0005745071027319,  -0.0102424694109244,
                                  -0.0066716621754147,  -0.0001398843762441,  -0.0001398843762441,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0003398269199440,   0.0000000000000000,   0.0000712305255402,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000};

    const CAODensityMatrix dmat({CDenseMatrix(denvals00, nrows, ncols),
                                 CDenseMatrix(denvals01, nrows, ncols)}, denmat::rmoij);
    
    CElectronRepulsionIntegralsDriver eridrv(mpi::rank(MPI_COMM_WORLD),
                                             mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto qqdata = eridrv.compute(ericut::qq, 1.0e-16, mh2o, mbas);
    
    CAOFockMatrix fock(dmat);
    
    ASSERT_TRUE(fockmat::rgenk == fock.getFockType(0));
    
    ASSERT_TRUE(fockmat::rgenk == fock.getFockType(1));
    
    eridrv.compute(fock, dmat, mh2o, mbas, qqdata, MPI_COMM_WORLD);
    
    ASSERT_EQ(fock.getNumberOfRows(0), nrows);
    
    ASSERT_EQ(fock.getNumberOfColumns(0), ncols);
    
    ASSERT_EQ(fock.getNumberOfRows(1), nrows);
    
    ASSERT_EQ(fock.getNumberOfColumns(1), ncols);
    
    std::vector<double> cmo{       0.0865653123758714,  -0.0000000000000068,  -0.0000000000000067,
                                   0.1176272483807372,   0.1321763490114022,  -0.0000000000000013,
                                   0.0000000000000354,  -0.2431475746488514,   0.0000000000000003,
                                   0.0850454715113338,  -0.0000000000000001,  -0.0000000000000009,
                                  -0.0000000000000088,  -0.1603547403081165,   0.0000000000000001,
                                  -0.0000000000000003,   0.0020693670933410,   0.0882543920055903,
                                  -0.0000000000000004,   0.0877947002569277,  -0.0000000000000280,
                                  -0.0000000000000294,   0.4097852203657574,   0.5703408129706526,
                                  -0.0000000000000055,   0.0000000000002267,  -1.5221235216317683,
                                   0.0000000000000020,   0.7061187972634262,  -0.0000000000000003,
                                  -0.0000000000000067,  -0.0000000000000480,  -0.8625974528194988,
                                   0.0000000000000006,  -0.0000000000000018,  -0.0760176170351653,
                                   0.2552944248648566,   0.0000000000000037,   1.1180959846314091,
                                   0.0000000000000148,   0.0000000000000388,  -0.4102851593894383,
                                   0.0312369106014287,   0.0000000000000001,  -0.0000000000004410,
                                   2.8134534523045152,  -0.0000000000000033,  -1.7285606333558992,
                                  -0.0000000000000023,   0.0000000000000106,  -0.0000000000000188,
                                  -0.5893480341936161,  -0.0000000000000019,   0.0000000000000016,
                                   0.5471704031457996,   1.9397849790829920,  -0.0000000000000514,
                                  -0.0630345671708565,  -0.0225832181632007,   0.9752875595344664,
                                  -0.8116539542756627,  -0.4224628037952045,   0.0000000000000050,
                                   0.3457802375887412,  -0.5485430805905478,   0.0000000000000007,
                                   0.7644886329281337,   0.0000000000000040,  -0.3469083852810287,
                                   0.2502177338105950,   0.4299098481286945,   0.0000000000000000,
                                  -0.0000000000000020,  -0.3214738506300444,  -1.2243152067923875,
                                  -1.1234452924417055,  -0.9050049939433298,  -1.4652266687760065,
                                  -0.6387648191448356,   0.5594607495054565,  -0.0273897595523694,
                                  -0.0000000000000006,   0.8283291051606878,  -0.5061336583897520,
                                   0.0000000000000005,   0.1819720873721704,   0.0000000000000003,
                                  -0.0806322453663168,   0.2858609033825558,   0.1695931714784805,
                                  -0.0000000000000007,  -0.0000000000000005,  -0.0585316130809272,
                                  -0.2260280384130985,  -0.2567362432910080,  -0.0630345671708634,
                                   0.0225832181631842,  -0.9752875595344347,  -0.8116539542757170,
                                  -0.4224628037952187,   0.0000000000000032,  -0.3457802375885443,
                                  -0.5485430805906159,   0.0000000000000005,   0.7644886329281407,
                                   0.0000000000000018,   0.3469083852810221,  -0.2502177338105541,
                                   0.4299098481287152,   0.0000000000000008,   0.0000000000000029,
                                  -0.3214738506300351,  -1.2243152067923515,   1.1234452924417568,
                                  -0.9050049939432361,   1.4652266687760434,   0.6387648191448018,
                                   0.5594607495054987,  -0.0273897595523693,   0.0000000000000004,
                                  -0.8283291051605348,  -0.5061336583900413,   0.0000000000000009,
                                   0.1819720873722162,  -0.0000000000000015,   0.0806322453663131,
                                  -0.2858609033825447,   0.1695931714785024,   0.0000000000000014,
                                  -0.0000000000000008,  -0.0585316130809241,  -0.2260280384131032,
                                   0.2567362432910227,   0.0000000000000067,   0.2783790399746797,
                                  -0.2625579452954626,  -0.0000000000000091,   0.0000000000000071,
                                   0.0000000000000003,   0.7619841246892235,   0.0000000000001156,
                                  -0.0000000000000010,  -0.0000000000000147,   0.0000000000000005,
                                   0.0107352824770600,  -0.8118819256587012,   0.0000000000000375,
                                   0.0000000000000007,   0.0000000000000014,   0.0000000000000031,
                                   0.0000000000000080,   0.5372941014527848,   0.0000000000000184,
                                   0.6575977107077506,  -0.5535588193665368,  -0.0000000000000122,
                                  -0.0000000000000167,  -0.0000000000000011,  -1.7398059722997565,
                                  -0.0000000000002501,   0.0000000000000004,   0.0000000000000345,
                                  -0.0000000000000029,   0.8031360632838600,  -0.0870230350642416,
                                   0.0000000000000010,   0.0000000000000010,   0.0000000000000011,
                                   0.0000000000000042,   0.0000000000000131,   1.1131042250063430,
                                   0.0162576201970382,   0.0158638055593965,   0.0589887741358876,
                                  -0.2584952186673700,   0.0718343717968702,  -0.0000000000000006,
                                  -0.2555152960452323,  -0.0166377601924611,  -0.0000000000000006,
                                  -0.4362222979852579,  -0.0000000000000010,  -0.4812518456809418,
                                  -0.6847776439345692,  -0.7065505503192341,  -0.0000000000000003,
                                   0.0000000000000014,   0.3788091571171208,   0.6219308651795875,
                                   0.6317467576750881,  -0.0162576201970346,   0.0158638055593917,
                                   0.0589887741358705,   0.2584952186673702,  -0.0718343717968740,
                                   0.0000000000000005,  -0.2555152960452179,   0.0166377601923948,
                                   0.0000000000000007,   0.4362222979852519,   0.0000000000000016,
                                  -0.4812518456809459,  -0.6847776439345028,   0.7065505503192999,
                                   0.0000000000000014,   0.0000000000000015,  -0.3788091571171135,
                                  -0.6219308651795747,   0.6317467576751145,   0.1824055308200072,
                                  -0.0000000000000033,  -0.0000000000000060,   0.3383563039014154,
                                  -0.7842579100679037,   0.0000000000000071,   0.0000000000000184,
                                  -0.0746193748424870,  -0.0000000000000001,   0.0393115494527195,
                                   0.0000000000000001,  -0.0000000000000028,  -0.0000000000000321,
                                  -0.6429713961925460,  -0.0000000000000005,  -0.0000000000000003,
                                   0.0356103356848657,   0.4382051027309739,  -0.0000000000000064,
                                   0.3639835671808570,   0.0000000000000031,   0.0000000000000028,
                                   0.0324981028287030,   1.2136334412320056,  -0.0000000000000107,
                                  -0.0000000000001232,   0.6179857745760859,  -0.0000000000000013,
                                  -1.1698413199002242,  -0.0000000000000036,   0.0000000000000091,
                                  -0.0000000000000051,  -0.1650989935977304,  -0.0000000000000005,
                                   0.0000000000000003,   0.5542618062675311,   0.9145953611513860,
                                  -0.0000000000000227,   0.0118914102799715,   0.0132512914284749,
                                   0.1272114481156374,  -0.0593662929896508,   0.1347962695876050,
                                  -0.0000000000000015,  -0.1808598664178773,   0.3258153007268215,
                                   0.0000000000000002,   0.4476484732597431,  -0.0000000000000003,
                                   0.6692380282153021,  -0.5363572551906081,  -0.5107338732688083,
                                   0.0000000000000011,  -0.0000000000000001,  -0.3268160170578290,
                                   0.5119996673522782,   0.5187548005325751,   0.0118914102799691,
                                  -0.0132512914284725,  -0.1272114481156283,  -0.0593662929896583,
                                   0.1347962695876078,  -0.0000000000000015,   0.1808598664177914,
                                   0.3258153007268665,   0.0000000000000015,   0.4476484732597322,
                                   0.0000000000000019,  -0.6692380282153133,   0.5363572551905565,
                                  -0.5107338732688551,  -0.0000000000000001,  -0.0000000000000013,
                                  -0.3268160170578344,   0.5119996673522629,  -0.5187548005325904,
                                   0.0000000000000000,   0.0000000000000002,   0.0000000000000009,
                                  -0.0000000000000003,  -0.0000000000000088,  -0.9666698858986440,
                                   0.0000000000000004,   0.0000000000000000,   0.0000000000000007,
                                  -0.0000000000000000,  -0.0575138935579061,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000004,  -0.0006009709175925,
                                  -0.0000000000000003,   0.0000000000000003,   0.0000000000000001,
                                   0.0000000000000003,  -0.0000000000000001,  -0.0000000000000001,
                                  -0.0000000000000007,   0.0000000000000000,   0.0000000000000090,
                                   1.0429350728471172,  -0.0000000000000001,   0.0000000000000003,
                                   0.0000000000000036,   0.0000000000000015,  -0.5506687922130418,
                                  -0.0000000000000006,  -0.0000000000000001,  -0.0000000000000000,
                                   0.3075997070960279,   0.0000000000000014,   0.0000000000000007,
                                  -0.0000000000000002,  -0.0000000000000010,  -0.0000000000000001,
                                  -0.0000000000000000,  -0.0000000000000001,   0.0000000000000005,
                                   0.0000000000000009,  -0.0124837996390757,  -0.0000000000000012,
                                  -0.0000000000000004,  -0.6714890555668267,  -0.0000000000000006,
                                   0.7408439282092582,   0.0000000000000004,  -0.0000000000000001,
                                  -0.0000000000000012,  -0.4224557672872926,   0.3921160131188095,
                                  -0.0000000000000019,  -0.0000000000000000,  -0.0000000000000013,
                                  -0.0000000000000000,  -0.0000000000000001,   0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000000,  -0.0124837996390748,
                                  -0.0000000000000002,  -0.0000000000000002,   0.6714890555668157,
                                  -0.0000000000000027,   0.7408439282092669,   0.0000000000000013,
                                   0.0000000000000004,   0.0000000000000001,  -0.4224557672872939,
                                  -0.3921160131188113,  -0.0000000000000007,   0.0000000000000004,
                                   0.0000000000000028,   0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000002,  -0.0000000000000002,
                                   0.0000000000000004,   0.0000000000000002,   0.0000000000000001,
                                  -0.1623721805951368,   0.0000000000000003,  -0.0000000000000022,
                                  -0.0000000000000006,   0.0000000000000013,   0.0000000000000008,
                                  -0.0000000000000008,  -1.0631972632710496,   0.0000000000000013,
                                   0.0000000000000003,   0.0000000000000037,   0.0000000000000011,
                                   0.0201007026554311,   0.1095825696887489,   0.0000000000000026,
                                   0.0000000000000000,   0.0000000000000003,  -0.0522403143723784,
                                  -0.0000000000000048,  -0.0000000000000004,  -0.0000000000000014,
                                  -0.0000000000000004,  -0.0263569460580094,   0.1768105865748913,
                                  -0.0000000000000088,   0.0000000000000006,   0.0000000000000041,
                                   0.0000000000000050,   0.0000000000000206,   1.3488763881347419,
                                   0.0083598092020529,  -0.0000000000000003,  -0.0000000000000004,
                                  -0.0024226440183690,   0.0042506830118886,   0.0000000000000000,
                                  -0.0000000000000036,   0.0392111927134023,   0.0000000000000001,
                                   0.1773802352735442,   0.0000000000000006,  -0.0000000000000014,
                                   0.0000000000000043,   0.0924220222593967,  -0.0000000000000029,
                                   0.0000000000000014,   1.0841645257671728,   0.1403193374310093,
                                  -0.0000000000000058,  -0.0000000000000000,   0.0000000000000002,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000001,
                                  -0.0049485651799192,  -0.0000000000000003,   0.0000000000000000,
                                  -0.0000000000000011,  -0.0000000000000002,   0.1976723304812793,
                                   0.0000000000000001,   0.0000000000000002,  -0.0000000000000001,
                                   1.0378440942419251,  -0.0000000000000002,   0.0000000000000028,
                                   0.0000000000000002,  -0.0000000000000005,  -0.0103703506060628,
                                  -0.0000000000000011,  -0.0000000000000039,   0.1077412892957206,
                                   0.0066832449968003,  -0.0000000000000002,  -0.0000000000000037,
                                   0.0403195140449439,   0.0000000000000002,  -0.0299605956587978,
                                  -0.0000000000000001,   0.0000000000000009,  -0.0000000000000105,
                                  -0.2941718163885338,  -0.0000000000000003,  -0.0000000000000005,
                                   0.1847207533457229,  -1.1465414075992626,   0.0000000000000171};
    
    CDenseMatrix bvec(cmo, 24, 19);
    
    CMOIntsBatch mbatcha;
    
    mbatcha.append(fock, bvec, bvec, {0, 0}, {0, 1});
    
    std::vector<double> intsvals00{0.0183045066527498,   0.0000000000000002,  -0.0000000000000011,
                                   0.0198581545059845,  -0.0223974102846798,   0.0000000000000002,
                                   0.0000000000000013,  -0.0066354935581203,  -0.0000000000000000,
                                  -0.0055661112972723,  -0.0000000000000000,   0.0000000000000001,
                                  -0.0000000000000004,  -0.0049805411304713,  -0.0000000000000000,
                                   0.0000000000000000,   0.0050969403126583,   0.0045507200408708,
                                  -0.0000000000000003,   0.0000000000000002,   0.0120047797140947,
                                  -0.0213554322947950,  -0.0000000000000008,  -0.0000000000000007,
                                  -0.0000000000000000,   0.0026255656971952,   0.0000000000000012,
                                   0.0000000000000000,  -0.0000000000000002,   0.0000000000000000,
                                   0.0024474041393517,  -0.0112143630472833,   0.0000000000000006,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000005,
                                  -0.0000000000000004,  -0.0150022063150205,  -0.0000000000000012,
                                  -0.0213554322947952,   0.0598474804135823,   0.0000000000000004,
                                   0.0000000000000005,   0.0000000000000000,   0.0040403595939956,
                                   0.0000000000000004,  -0.0000000000000001,   0.0000000000000004,
                                  -0.0000000000000000,   0.0005234117525934,   0.0333490940876621,
                                  -0.0000000000000010,  -0.0000000000000000,   0.0000000000000001,
                                  -0.0000000000000005,   0.0000000000000005,   0.0313073203177596,
                                   0.0198581545059843,  -0.0000000000000006,   0.0000000000000003,
                                   0.0368444696637770,  -0.0365329424940878,   0.0000000000000003,
                                   0.0000000000000005,   0.0007274003071560,  -0.0000000000000000,
                                  -0.0092888709099137,  -0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000002,  -0.0125895222401630,   0.0000000000000000,
                                   0.0000000000000000,   0.0056302287389981,   0.0110092382177021,
                                   0.0000000000000009,  -0.0223974102846796,  -0.0000000000000007,
                                   0.0000000000000006,  -0.0365329424940880,   0.1304771088976125,
                                  -0.0000000000000009,   0.0000000000000013,  -0.0191190541013689,
                                   0.0000000000000001,   0.0186194619166595,   0.0000000000000001,
                                   0.0000000000000002,   0.0000000000000017,   0.0272185499498652,
                                   0.0000000000000002,  -0.0000000000000000,   0.0187312684585598,
                                  -0.0160948107968883,   0.0000000000000001,   0.0000000000000002,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000003,
                                  -0.0000000000000009,   0.0185325932661947,  -0.0000000000000000,
                                   0.0000000000000002,  -0.0000000000000001,  -0.0000000000000002,
                                   0.0071229552009510,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000002,   0.0131713424183439,  -0.0000000000000001,
                                  -0.0000000000000002,   0.0000000000000001,   0.0000000000000000,
                                   0.0000000000000013,   0.0026255656971952,   0.0040403595939955,
                                   0.0000000000000006,   0.0000000000000013,  -0.0000000000000000,
                                   0.0165928073394068,  -0.0000000000000018,  -0.0000000000000000,
                                  -0.0000000000000014,  -0.0000000000000000,  -0.0016610403317301,
                                   0.0003967891907764,  -0.0000000000000008,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000006,   0.0000000000000007,
                                   0.0024234677008010,  -0.0066354935581199,   0.0000000000000011,
                                   0.0000000000000007,   0.0007274003071563,  -0.0191190541013694,
                                   0.0000000000000002,  -0.0000000000000015,   0.0313599890159831,
                                   0.0000000000000000,   0.0131741733509728,   0.0000000000000001,
                                  -0.0000000000000004,   0.0000000000000001,   0.0037906599181818,
                                  -0.0000000000000000,   0.0000000000000000,   0.0009965287487586,
                                  -0.0013078069776513,  -0.0000000000000004,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000001,  -0.0000000000000000,
                                   0.0000000000000001,  -0.0000000000000001,  -0.0000000000000000,
                                   0.0000000000000000,   0.0132916055564137,   0.0000000000000001,
                                  -0.0000000000000006,   0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000004,   0.0009319104667312,
                                   0.0000000000000001,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0055661112972726,  -0.0000000000000001,   0.0000000000000001,
                                  -0.0092888709099139,   0.0186194619166599,  -0.0000000000000002,
                                  -0.0000000000000016,   0.0131741733509726,   0.0000000000000001,
                                   0.0545278880888816,   0.0000000000000001,  -0.0000000000000000,
                                   0.0000000000000006,   0.0147405735972390,  -0.0000000000000002,
                                   0.0000000000000001,   0.0516048416072652,   0.0023579296917952,
                                   0.0000000000000001,  -0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,   0.0000000000000001,
                                   0.0071229552009510,  -0.0000000000000000,   0.0000000000000001,
                                  -0.0000000000000006,   0.0000000000000001,   0.0397329301225203,
                                   0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                   0.0403452086001876,  -0.0000000000000002,   0.0000000000000003,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0024474041393517,   0.0005234117525934,   0.0000000000000001,
                                   0.0000000000000002,   0.0000000000000000,  -0.0016610403317302,
                                  -0.0000000000000003,   0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0194491304471135,  -0.0026273984557487,
                                   0.0000000000000001,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000005,  -0.0000000000000003,  -0.0109077153263727,
                                  -0.0000000000000004,  -0.0112143630472833,   0.0333490940876621,
                                   0.0000000000000003,   0.0000000000000017,   0.0000000000000000,
                                   0.0003967891907764,  -0.0000000000000001,  -0.0000000000000000,
                                   0.0000000000000008,   0.0000000000000000,  -0.0026273984557487,
                                   0.0416400947830074,  -0.0000000000000004,   0.0000000000000000,
                                   0.0000000000000001,   0.0000000000000005,   0.0000000000000007,
                                   0.0359598084467058,  -0.0049805411304709,   0.0000000000000005,
                                  -0.0000000000000011,  -0.0125895222401632,   0.0272185499498651,
                                  -0.0000000000000002,  -0.0000000000000007,   0.0037906599181829,
                                   0.0000000000000000,   0.0147405735972382,  -0.0000000000000000,
                                   0.0000000000000001,  -0.0000000000000003,   0.0268714342478048,
                                  -0.0000000000000001,   0.0000000000000000,   0.0106705551671494,
                                  -0.0024101780317307,  -0.0000000000000015,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000002,   0.0131713424183438,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000005,  -0.0000000000000002,
                                   0.0403452086001876,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000001,   0.0789254150706671,  -0.0000000000000005,
                                  -0.0000000000000000,  -0.0000000000000001,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0009319104667312,
                                   0.0000000000000001,  -0.0000000000000002,  -0.0000000000000000,
                                   0.0000000000000001,   0.0000000000000000,  -0.0000000000000005,
                                   0.0229362095675348,   0.0000000000000001,   0.0000000000000000,
                                   0.0000000000000001,   0.0050969403126586,  -0.0000000000000005,
                                  -0.0000000000000005,   0.0056302287389981,   0.0187312684585601,
                                  -0.0000000000000002,   0.0000000000000006,   0.0009965287487593,
                                   0.0000000000000001,   0.0516048416072648,   0.0000000000000003,
                                  -0.0000000000000004,   0.0000000000000006,   0.0106705551671493,
                                  -0.0000000000000000,   0.0000000000000001,   0.0911250157641020,
                                   0.0082251185282000,  -0.0000000000000001,   0.0045507200408710,
                                  -0.0000000000000004,   0.0000000000000006,   0.0110092382177025,
                                  -0.0160948107968886,   0.0000000000000001,   0.0000000000000006,
                                  -0.0013078069776518,  -0.0000000000000000,   0.0023579296917957,
                                  -0.0000000000000000,  -0.0000000000000003,   0.0000000000000006,
                                  -0.0024101780317317,  -0.0000000000000001,   0.0000000000000000,
                                   0.0082251185281999,   0.0292277156749956,   0.0000000000000007,
                                  -0.0000000000000002,  -0.0150022063150204,   0.0313073203177596,
                                   0.0000000000000006,   0.0000000000000003,   0.0000000000000000,
                                   0.0024234677008009,   0.0000000000000001,  -0.0000000000000000,
                                  -0.0000000000000003,   0.0000000000000000,  -0.0109077153263727,
                                   0.0359598084467058,  -0.0000000000000014,  -0.0000000000000000,
                                   0.0000000000000001,  -0.0000000000000000,   0.0000000000000007,
                                   0.0593943692763444};
    
    std::vector<double> intsvals01{0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0009940859533827,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,  -0.0033142660575273,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0117183719998292,
                                  -0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000003,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0017026430549663,  -0.0000000000000000,  -0.0000000000000001,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000005,  -0.0061459447980728,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000001,   0.0000000000000002,   0.0000000000000000,
                                  -0.0000000000000000,   0.0045494629299885,   0.0000000000000000,
                                   0.0000000000000004,   0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000009,   0.0106382221938838,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000001,  -0.0002885767804854,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000004,
                                   0.0000000000000000,  -0.0151992854700786,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0255846952768092,
                                   0.0000000000000005,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000002,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000003,  -0.0000000000000011,
                                  -0.0187240691146328,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000001,  -0.0000000000000000,  -0.0104334406823539,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000002,
                                  -0.0204478132010725,   0.0000000000000001,   0.0000000000000000,
                                   0.0000000000000002,   0.0000000000000000,   0.0259811982244513,
                                   0.0000000000000006,  -0.0000000000000006,   0.0392987344309772,
                                  -0.1084105939904657,   0.0000000000000011,  -0.0000000000000007,
                                   0.0153880822670017,  -0.0000000000000001,  -0.0063750324473473,
                                   0.0000000000000001,  -0.0000000000000001,  -0.0000000000000014,
                                  -0.0217002215192173,   0.0000000000000001,   0.0000000000000001,
                                   0.0068663156705158,   0.0245018534530724,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000006,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0008105884427033,
                                   0.0000000000000000,   0.0000000000000024,   0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,   0.0000000000000006,
                                  -0.0000513799531814,   0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,   0.0000000000000001,
                                   0.0060221691442700,   0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000001,   0.0000000000000001,  -0.0147848214675959,
                                  -0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                  -0.0032256504878225,  -0.0000000000000001,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,  -0.0000000000000003,
                                  -0.0117799747518622,   0.0355469948462550,   0.0000000000000008,
                                   0.0000000000000002,   0.0000000000000000,   0.0043829226442787,
                                   0.0000000000000004,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0017128877281128,   0.0221970446473854,
                                  -0.0000000000000009,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000001,   0.0000000000000003,   0.0180884548838974,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,   0.0010059113764878,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000003,
                                   0.0000000000000000,   0.0149911326412152,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,   0.0100040705785784,
                                  -0.0000000000000002,   0.0000000000000001,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0048699754683999,  -0.0000000000000000,
                                  -0.0000000000000001,   0.0068412505134537,  -0.0144213935610568,
                                   0.0000000000000002,   0.0000000000000015,  -0.0123900201384534,
                                  -0.0000000000000001,  -0.0292812151141052,  -0.0000000000000000,
                                   0.0000000000000002,  -0.0000000000000002,  -0.0043934359017860,
                                   0.0000000000000001,  -0.0000000000000000,  -0.0264046508800805,
                                   0.0089078990330972,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000001,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000001,   0.0000000000000000,
                                  -0.0000000000000000,   0.0017515566368915,  -0.0000000000000000,
                                  -0.0000000000000001,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000001,  -0.0040780198356641,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0000000000000000,  -0.0000000000000000,   0.0068044198607017,
                                  -0.0000000000000000,   0.0000000000000009,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000017,
                                   0.0076647431831781,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000001,  -0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,   0.0000000000000000,   0.0000000000000001,
                                   0.0042665598987024,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000006,  -0.0000000000000000,   0.0237474750454186,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0405814079329876,  -0.0000000000000007,   0.0000000000000001,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0065157825808777,
                                   0.0000000000000004,   0.0000000000000004,  -0.0103002022928557,
                                  -0.0185851445089088,   0.0000000000000002,   0.0000000000000001,
                                  -0.0045580316890069,  -0.0000000000000001,  -0.0395695022694916,
                                  -0.0000000000000001,   0.0000000000000002,  -0.0000000000000003,
                                  -0.0015021880413911,   0.0000000000000001,  -0.0000000000000001,
                                  -0.0550141946455520,   0.0010271812228873,  -0.0000000000000002,
                                  -0.0000000000000003,  -0.0155991494360518,   0.0384766415297702,
                                   0.0000000000000011,   0.0000000000000000,   0.0000000000000001,
                                   0.0037205432999860,   0.0000000000000001,  -0.0000000000000000,
                                  -0.0000000000000002,   0.0000000000000001,  -0.0087945999028421,
                                   0.0378100617820326,  -0.0000000000000016,   0.0000000000000001,
                                   0.0000000000000001,  -0.0000000000000002,   0.0000000000000010,
                                   0.0439533378269159,  -0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000000,   0.0000000000000001,
                                   0.0047356897596693,  -0.0000000000000000,  -0.0000000000000000,
                                  -0.0000000000000002,  -0.0000000000000001,   0.0076083914948593,
                                   0.0000000000000000,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0078069486962243,  -0.0000000000000002,  -0.0000000000000001,
                                  -0.0000000000000000,  -0.0000000000000001,   0.0000000000000000,
                                   0.0000000000000000,  -0.0000000000000000,   0.0000000000000000,
                                   0.0000000000000001,   0.0125610493752445,  -0.0000000000000000,
                                  -0.0000000000000000,  -0.0000000000000003,  -0.0000000000000001,
                                   0.0292583250730323,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000001,   0.0438508637364812,  -0.0000000000000001,
                                   0.0000000000000001,  -0.0000000000000000,  -0.0000000000000000,
                                   0.0000000000000000,   0.0000000000000000,  -0.0000000000000001,
                                   0.0000000000000000,   0.0000000000000000,  -0.0000000000000002,
                                  -0.0000000000000000,  -0.0000000000000000,   0.0032361293955715,
                                   0.0000000000000000,  -0.0000000000000003,   0.0000000000000000,
                                  -0.0000000000000001,  -0.0000000000000000,  -0.0000000000000006,
                                   0.0086438050751475,   0.0000000000000000,   0.0000000000000000,
                                  -0.0000000000000001};
    
    CMOIntsBatch mbatchb({CDenseMatrix(intsvals00, 19, 19), CDenseMatrix(intsvals01, 19, 19)},
                         {{0, 0}, {0, 1}}, {-1, -1}, moints::oooo);
    
    ASSERT_EQ(mbatchb, mbatcha);
}

