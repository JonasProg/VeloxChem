//
//                           VELOXCHEM 1.0-RC
//      ---------------------------------------------------
//                     An Electronic Structure Code
//
//  Copyright Â© 2018-2020 by VeloxChem developers. All rights reserved.
//  Contact: https://veloxchem.org/contact

#include "ElectricFieldIntegralsDriverTest.hpp"

#include <mpi.h>

#include "ElectricFieldIntegralsDriver.hpp"
#include "MolecularBasisSetter.hpp"
#include "MoleculeSetter.hpp"

TEST_F(CElectricFieldIntegralsDriverTest, ComputeSSForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix efxmat(4, 4);

    CDenseMatrix efymat(4, 4);

    CDenseMatrix efzmat(4, 4);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{0.000000000000000,
                                 0.000000000000000,
                                 0.069515318968538,
                                 0.102997219418035,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.077350784474952,
                                 0.104344392470321,
                                 0.069515318968538,
                                 0.077350784474952,
                                 0.175590605071006,
                                 0.139355348997530,
                                 0.102997219418035,
                                 0.104344392470321,
                                 0.139355348997530,
                                 0.151793289591550};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 4, 4));

    std::vector<double> intyvals{0.000000000000000,
                                 0.000000000000000,
                                 0.104272978452806,
                                 0.154495829127052,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.116026176712429,
                                 0.156516588705482,
                                 0.104272978452806,
                                 0.116026176712429,
                                 0.263385907606509,
                                 0.209033023496294,
                                 0.154495829127052,
                                 0.156516588705482,
                                 0.209033023496294,
                                 0.227689934387325};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 4, 4));

    std::vector<double> intzvals{0.000000000000000,
                                 0.000000000000000,
                                 0.191167127163479,
                                 0.283242353399595,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.212714657306119,
                                 0.286947079293383,
                                 0.191167127163479,
                                 0.212714657306119,
                                 0.482874163945266,
                                 0.383227209743206,
                                 0.283242353399595,
                                 0.286947079293383,
                                 0.383227209743206,
                                 0.417431546376763};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 4, 4));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeSPForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix efxmat(4, 12);

    CDenseMatrix efymat(4, 12);

    CDenseMatrix efzmat(4, 12);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.088857803941875, -0.096950123499849, 0.000000000000000,  0.000000000000000,  -0.162905973893438,
        -0.177741893083056, 2.300387143089191,  1.418609226553403,  0.055475794026943,  0.223252564473668,  0.000000000000000,  0.000000000000000,
        -0.086287151265088, -0.092338673812369, 0.000000000000000,  0.000000000000000,  -0.158193110652661, -0.169287568656009, 1.909059014190762,
        1.276615297284585,  0.069526279667211,  0.230092327418285,  0.035757029899980,  0.040197040029245,  -0.058039631443688, -0.038758745757674,
        0.065554554816630,  0.073694573386950,  -0.106405990980095, -0.071057700555736, 0.133303413218098,  0.118193316594225,  0.101553994697348,
        0.071805235324299,  0.021387863907378,  0.024072948829603,  -0.067167448116338, -0.066048813633112, 0.039211083830193,  0.044133739520939,
        -0.123140321546619, -0.121089491660705, 0.484025161072659,  0.373247241960366,  0.124028545905978,  0.168105028862311};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 4, 12));

    std::vector<double> intyvals{
        2.300387143089191,  1.418609226553403,  -0.018572375924620, 0.142460794890461,  0.000000000000000,  0.000000000000000,  -0.244358960840157,
        -0.266612839624583, 0.000000000000000,  0.000000000000000,  -0.088857803941875, -0.096950123499848, 1.909059014190763,  1.276615297284585,
        -0.002379679720363, 0.153143432574644,  0.000000000000000,  0.000000000000000,  -0.237289665978991, -0.253931352984014, 0.000000000000000,
        0.000000000000000,  -0.086287151265088, -0.092338673812369, 0.163100938134748,  0.151690849951930,  0.053187635160941,  0.039506280526237,
        0.098331832224946,  0.110541860080425,  -0.159608986470142, -0.106586550833603, 0.035757029899980,  0.040197040029245,  -0.058039631443688,
        -0.038758745757674, 0.501848380995474,  0.393308032651702,  0.068055672475697,  0.113064350834718,  0.058816625745290,  0.066200609281408,
        -0.184710482319929, -0.181634237491058, 0.021387863907378,  0.024072948829603,  -0.067167448116338, -0.066048813633112};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 4, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.244358960840157, -0.266612839624583, 2.300387143089191,  1.418609226553403,  -0.333277098218762,
        -0.200904225838170, 0.000000000000000,  0.000000000000000,  -0.162905973893438, -0.177741893083056, 0.000000000000000,  0.000000000000000,
        -0.237289665978991, -0.253931352984014, 1.909059014190763,  1.276615297284585,  -0.307980007117549, -0.173889370510828, 0.000000000000000,
        0.000000000000000,  -0.158193110652661, -0.169287568656009, 0.098331832224946,  0.110541860080425,  -0.159608986470142, -0.106586550833603,
        0.289740419030511,  0.294055366722174,  -0.152369392868787, -0.097764277365525, 0.065554554816630,  0.073694573386950,  -0.106405990980095,
        -0.071057700555736, 0.058816625745290,  0.066200609281408,  -0.184710482319929, -0.181634237491058, 0.577597065667439,  0.478566393089880,
        -0.169829039602999, -0.120858530782553, 0.039211083830193,  0.044133739520939,  -0.123140321546619, -0.121089491660705};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 4, 12));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeSDForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix efxmat(4, 20);

    CDenseMatrix efymat(4, 20);

    CDenseMatrix efzmat(4, 20);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.066856052112916, -0.209598337903359, 0.000000000000000,  0.000000000000000,  0.218594673455293,
        0.168810112109284,  0.000000000000000,  0.000000000000000,  0.237987936539176,  0.244588749497303,  0.000000000000000,  0.000000000000000,
        -0.122569428873678, -0.384263619489492, 0.000000000000000,  0.000000000000000,  -0.130683754587968, -0.206233178524079, 0.000000000000000,
        0.000000000000000,  -0.072473973373670, -0.202705213604674, 0.000000000000000,  0.000000000000000,  0.190421091285356,  0.152320371200589,
        0.000000000000000,  0.000000000000000,  0.212793778429521,  0.225924076306674,  0.000000000000000,  0.000000000000000,  -0.132868951185061,
        -0.371626224941902, 0.000000000000000,  0.000000000000000,  -0.123330351543344, -0.195141803785166, 0.069434309188802,  0.062870161418931,
        -0.025557393273805, -0.016219686483601, 0.041919549704205,  0.045978782378192,  0.058461788991855,  0.031489811306403,  0.013978528401800,
        0.020446577595064,  0.066603335968289,  0.036819509705402,  0.127296233512804,  0.115261962601374,  -0.046855221001976, -0.029736091886602,
        0.029775777454515,  0.023800587281818,  -0.040068663906601, -0.023218201503711, 0.100406177719547,  0.087480156302481,  -0.047446772077059,
        -0.065534558943466, 0.011347318955916,  0.013948135931742,  0.093562986070773,  0.073621526700058,  -0.027628129769039, -0.020127513255867,
        0.109111760277401,  0.096710631932788,  0.184077992485835,  0.160380286554548,  -0.086985748807942, -0.120146691396355, 0.062467295860700,
        0.052825383986119,  -0.068489327412586, -0.072692125571425};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 4, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.021670108729357,  -0.088577645841851, 0.000000000000000,  0.000000000000000,  0.059592799005732,
        -0.243588526065089, 0.000000000000000,  0.000000000000000,  0.356981904808764,  0.366883124245954,  0.000000000000000,  0.000000000000000,
        0.218594673455293,  0.168810112109284,  0.000000000000000,  0.000000000000000,  0.096664416675001,  0.232617898645535,  0.000000000000000,
        0.000000000000000,  0.009387378746449,  -0.088979120827180, 0.000000000000000,  0.000000000000000,  0.025815291552735,  -0.244692582274744,
        0.000000000000000,  0.000000000000000,  0.319190667644281,  0.338886114460011,  0.000000000000000,  0.000000000000000,  0.190421091285356,
        0.152320371200589,  0.000000000000000,  0.000000000000000,  0.098440485821673,  0.223476173313845,  0.058992433308961,  0.055846405302982,
        0.000677431451359,  -0.001270757259855, 0.162229191599642,  0.153577614583200,  0.001862936491237,  -0.003494582464600, 0.020967792602700,
        0.030669866392596,  0.099905003952433,  0.055229264558104,  0.041919549704205,  0.045978782378192,  0.058461788991855,  0.031489811306403,
        -0.063718006956411, -0.056600327458269, 0.033529455409058,  0.020513751661747,  0.070376033314824,  0.062546812059758,  -0.003278761363260,
        -0.021380152416839, 0.193534091615766,  0.172003733164333,  -0.009016593748964, -0.058795419146307, -0.041442194653558, -0.030191269883801,
        0.163667640416101,  0.145065947899182,  0.011347318955916,  0.013948135931742,  0.093562986070773,  0.073621526700058,  -0.098858816043740,
        -0.085578137766334, 0.060205361086710,  0.075573858038929};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 4, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.218594673455293,  0.168810112109284,  0.000000000000000,  0.000000000000000,  0.454790327723578,
        0.193243975084704,  0.000000000000000,  0.000000000000000,  0.189758960093159,  -0.187870178674984, 0.000000000000000,  0.000000000000000,
        0.303193551815719,  0.128829316723136,  0.000000000000000,  0.000000000000000,  -0.091081113939705, -0.070337546712202, 0.000000000000000,
        0.000000000000000,  0.190421091285356,  0.152320371200589,  0.000000000000000,  0.000000000000000,  0.381939994466384,  0.160786581305823,
        0.000000000000000,  0.000000000000000,  0.135167779854302,  -0.198268707812488, 0.000000000000000,  0.000000000000000,  0.254626662977589,
        0.107191054203882,  0.000000000000000,  0.000000000000000,  -0.079342121368898, -0.063466821333579, 0.041919549704205,  0.045978782378192,
        0.058461788991855,  0.031489811306403,  0.169469598255656,  0.172592255730526,  0.113953694093121,  0.058926454133950,  0.210519970549217,
        0.202775939025989,  0.034497691313995,  0.013387927654761,  0.112979732170437,  0.115061503820350,  0.075969129395414,  0.039284302755967,
        -0.017466479043419, -0.019157825990913, -0.024359078746606, -0.013120754711001, 0.011347318955916,  0.013948135931742,  0.093562986070773,
        0.073621526700058,  0.127485007046165,  0.120765480685047,  0.175828535591832,  0.110153175227127,  0.229752323368335,  0.206330223321528,
        0.041356373904781,  -0.027156752561479, 0.084990004697443,  0.080510320456698,  0.117219023727888,  0.073435450151418,  -0.004728049564965,
        -0.005811723304893, -0.038984577529489, -0.030675636125024};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 4, 20));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeSFForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix efxmat(4, 28);

    CDenseMatrix efymat(4, 28);

    CDenseMatrix efzmat(4, 28);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.148428671659304,  0.204139322774194,  0.000000000000000,  0.000000000000000,  0.154393581334957,
        0.364069047516647,  0.000000000000000,  0.000000000000000,  -0.358630033660812, -0.221558103908656, 0.000000000000000,  0.000000000000000,
        -0.279873925723781, -0.293511291303175, -0.000000000000000, -0.000000000000000, 0.132277652375463,  0.340613222416058,  0.000000000000000,
        0.000000000000000,  0.324403308707871,  0.359463054946641,  0.000000000000000,  0.000000000000000,  -0.008417356445494, -0.056893472273156,
        0.000000000000000,  0.000000000000000,  0.129907616346590,  0.184446308906085,  0.000000000000000,  0.000000000000000,  0.148195994788565,
        0.332956509732216,  0.000000000000000,  0.000000000000000,  -0.290480867806213, -0.193006872727686, 0.000000000000000,  0.000000000000000,
        -0.237078155184618, -0.262781626368535, 0.000000000000000,  0.000000000000000,  0.129439244605841,  0.311947345378103,  0.000000000000000,
        0.000000000000000,  0.276456689059750,  0.322495533102488,  -0.000000000000000, -0.000000000000000, -0.011270051394940, -0.052602330537235,
        0.028599450990946,  0.024159182917711,  0.019547435829854,  0.009483339074046,  0.081508713698598,  0.072464634582749,  0.018059214807158,
        0.010688503831686,  0.023579385923736,  0.026383846474127,  -0.051301471434153, -0.021437883984942, -0.022743010940096, -0.017036662840588,
        -0.038228094104757, -0.017385116167539, 0.079622070598542,  0.071036562271751,  0.015042321219830,  0.009313289476569,  0.032929392527564,
        0.025753597043085,  0.044021860026864,  0.020255742856949,  -0.017081275165154, -0.015507720552011, -0.000429410656597, -0.000783923485335,
        0.022618724636114,  0.021452587205156,  0.047124387661378,  0.043857934014237,  0.053002599262739,  0.051113955344241,  0.051974250368702,
        0.067592289621590,  -0.001873451476836, -0.000265654600990, -0.108567780828800, -0.066626045964349, -0.024891817613369, -0.023100024395851,
        -0.087075808850445, -0.069460340285849, 0.050984674764866,  0.049238788055832,  0.045088319755401,  0.062065483055190,  0.032592322331712,
        0.030429712827675,  0.101305116473776,  0.083299858387483,  -0.010086121612403, -0.009818192482216, -0.003555318894960, -0.009049614738206};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 4, 28));

    std::vector<double> intyvals{
        -0.000000000000000, 0.000000000000000,  -0.083659047405178, -0.096557198747100, 0.000000000000000,  0.000000000000000,  -0.067435756918670,
        0.152904731727346,  -0.000000000000000, 0.000000000000000,  -0.166580709008547, 0.155981469158844,  0.000000000000000,  0.000000000000000,
        -0.419810888585672, -0.440266936954762, 0.000000000000000,  0.000000000000000,  -0.358630033660812, -0.221558103908656, 0.000000000000000,
        0.000000000000000,  -0.231057746348845, -0.404482632494335, 0.000000000000000,  0.000000000000000,  -0.072554697582311, -0.164142287674419,
        0.000000000000000,  0.000000000000000,  -0.071626460008596, -0.086753638024364, 0.000000000000000,  0.000000000000000,  -0.037863715679962,
        0.144644447554033,  0.000000000000000,  0.000000000000000,  -0.112628145232670, 0.151108284771698,  0.000000000000000,  0.000000000000000,
        -0.355617232776927, -0.394172439552803, 0.000000000000000,  0.000000000000000,  -0.290480867806213, -0.193006872727686, 0.000000000000000,
        0.000000000000000,  -0.209693465281117, -0.367753461252566, 0.000000000000000,  0.000000000000000,  -0.069044011021896, -0.150008015641753,
        -0.009807717377948, -0.007844691841722, -0.011294820815515, -0.005244617777247, 0.070808180879708,  0.065660648192665,  -0.012562356914786,
        -0.002974387421818, 0.099271558868322,  0.093023101000190,  -0.027708904975298, -0.008551613844216, -0.034114516410145, -0.025554994260882,
        -0.057342141157135, -0.026077674251308, 0.023579385923736,  0.026383846474127,  -0.051301471434153, -0.021437883984942, -0.074097646412309,
        -0.064656733270875, -0.029130039860959, -0.015233529321010, -0.035934131112498, -0.031886606827246, -0.008590719703214, -0.004985159956152,
        -0.009154326243544, -0.008579445462949, -0.026200304374760, -0.022040365125102, 0.037444869131658,  0.036880783615509,  -0.016624050698795,
        0.015647424896632,  0.049423465200836,  0.049017409221674,  -0.045384830935266, 0.006543778084898,  -0.037337726420054, -0.034650036593776,
        -0.130613713275668, -0.104190510428774, -0.001873451476836, -0.000265654600990, -0.108567780828800, -0.066626045964349, -0.052053187932315,
        -0.049851789320534, -0.075047348293770, -0.080828635304583, -0.023558350218157, -0.022701743863240, -0.024289108185950, -0.030758017657702};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 4, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000, -0.031298014306759, -0.016498776978657, 0.000000000000000,  0.000000000000000,  -0.431719747784760,
        -0.124788614397417, 0.000000000000000, 0.000000000000000,  -0.418870404190930, 0.136757558034544,  0.000000000000000,  -0.000000000000000,
        0.139999849556835,  0.388975412117223, 0.000000000000000,  0.000000000000000,  -0.279246936127287, 0.091171705356363,  0.000000000000000,
        -0.000000000000000, 0.179883228243650, 0.051995255998924,  0.000000000000000,  0.000000000000000,  0.159967628678993,  0.084327082335359,
        0.000000000000000,  0.000000000000000, -0.025106237196436, -0.014205795971537, 0.000000000000000,  0.000000000000000,  -0.337458086847674,
        -0.100360051590511, 0.000000000000000, 0.000000000000000,  -0.305207841849983, 0.142398396178793,  -0.000000000000000, -0.000000000000000,
        0.139448445995294,  0.356641253634051, 0.000000000000000,  0.000000000000000,  -0.203471894566655, 0.094932264119195,  0.000000000000000,
        -0.000000000000000, 0.140607536186531, 0.041816688162713,  0.000000000000000,  0.000000000000000,  0.128320767892897,  0.072607401632299,
        0.003025555550140,  0.003187562362683, -0.004519645402239, -0.001855498886131, 0.076800869530420,  0.076037420923836,  -0.063883717685223,
        -0.025036160811448, 0.162472100152760, 0.154211222828710,  -0.065846223675136, -0.022890662421762, 0.093985189170810,  0.084067866959922,
        0.015493704792638,  0.010011655535757, 0.108314733435174,  0.102807481885807,  -0.043897482450091, -0.015260441614508, -0.032000362304342,
        -0.031682258718265, 0.026618215702176, 0.010431733671437,  -0.015463950589605, -0.016291985409270, 0.023100409833665,  0.009483660973559,
        0.000387595552593,  0.000515277121460, -0.009419552783614, -0.005403715497070, 0.025315380925514,  0.026618858457857,  -0.127929077570906,
        -0.059652276302102, 0.074649406574395, 0.074765950174326,  -0.119098169030967, -0.020539498992843, 0.059493272889652,  0.057518651348077,
        0.048275346112709,  0.069812705799734, 0.049766271049597,  0.049843966782884,  -0.079398779353978, -0.013692999328562, -0.010548075385631,
        -0.011091191024107, 0.053303782321211, 0.024855115125876,  -0.001981043935474, -0.002633638620795, 0.048144380894029,  0.027618990318360};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 4, 28));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeSGForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix efxmat(4, 36);

    CDenseMatrix efymat(4, 36);

    CDenseMatrix efzmat(4, 36);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.052417723720611, -0.032811650378630, 0.000000000000000,  0.000000000000000,  -0.378670710021570,
        -0.358310947051602, 0.000000000000000,  0.000000000000000,  -0.199164543873251, -0.363686365010613, 0.000000000000000,  0.000000000000000,
        0.469442821916389,  0.249082516171487,  0.000000000000000,  0.000000000000000,  0.260837313903166,  0.267985413821132,  0.000000000000000,
        0.000000000000000,  -0.039276424896962, -0.151558585893727, 0.000000000000000,  0.000000000000000,  -0.521879565909281, -0.393871140628333,
        0.000000000000000,  0.000000000000000,  0.014732850245091,  0.099474456871862,  0.000000000000000,  0.000000000000000,  0.108526145370195,
        0.112191135280812,  0.000000000000000,  0.000000000000000,  -0.040818855461206, -0.027942518274941, 0.000000000000000,  0.000000000000000,
        -0.305114755324468, -0.308873830911820, 0.000000000000000,  0.000000000000000,  -0.175266209303487, -0.317077596687778, 0.000000000000000,
        0.000000000000000,  0.361786992649796,  0.210740707823022,  0.000000000000000,  0.000000000000000,  0.211957128416173,  0.231442102503019,
        0.000000000000000,  0.000000000000000,  -0.041301594348022, -0.132978219891946, 0.000000000000000,  0.000000000000000,  -0.412070200657273,
        -0.337491407049940, 0.000000000000000,  0.000000000000000,  0.019089836618510,  0.087492301355562,  0.000000000000000,  0.000000000000000,
        0.088246957627996,  0.096905372315235,  0.000936361601020,  0.000502492930650,  -0.004348198011044, -0.001418967104775, 0.036327034031610,
        0.029624055715074,  -0.026804832259898, -0.010024824895229, 0.061821046925058,  0.053139259864553,  -0.007441658801714, -0.004946184176507,
        0.002527915584413,  0.005096096072061,  0.040642382706785,  0.012791398168988,  -0.030183955690945, -0.024943769424156, 0.017659517421082,
        0.006865892859227,  0.031652878389249,  0.027591487775498,  0.001565276532047,  -0.000826684202884, 0.025701695266568,  0.019404814328407,
        -0.040738900723211, -0.014002295818754, -0.022263304013723, -0.019485604488985, -0.002206312104514, 0.000230689122873,  -0.012727001704475,
        -0.010526396034590, 0.007321320743812,  0.002855393478877,  0.000795883803457,  0.000791998013924,  -0.012132671009474, -0.006331332255228,
        0.013729342222410,  0.014245758700507,  -0.084014412879746, -0.057559597952870, 0.018750920538417,  0.019809254435727,  -0.038938461548216,
        -0.047354473747162, -0.004181839073603, -0.003946027641166, 0.109999091428896,  0.052337990434926,  -0.010850204903446, -0.011300981202484,
        0.057236830100159,  0.041712190500975,  0.008950975716975,  0.009518127236302,  -0.005287137625370, -0.017120756068759, 0.012345140412294,
        0.012608124981570,  -0.118781935469934, -0.069585436276159, -0.006162152284650, -0.006566260342193, 0.000706324146145,  0.010576874836107,
        -0.004559886247415, -0.004750541847151, 0.023793734648172,  0.017422466226853};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 4, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.095249968924769,  0.107567169616531,  0.000000000000000,  0.000000000000000,  0.216183108936259,
        0.169637661095417,  0.000000000000000,  0.000000000000000,  0.166533793823305,  -0.125985604400979, 0.000000000000000,  0.000000000000000,
        0.351925926700029,  0.056010177582512,  0.000000000000000,  0.000000000000000,  0.391255970854749,  0.401978120731698,  0.000000000000000,
        0.000000000000000,  0.469442821916389,  0.249082516171487,  0.000000000000000,  0.000000000000000,  0.333854114255713,  0.416098752533356,
        0.000000000000000,  0.000000000000000,  0.175527592013670,  0.287558136069866,  0.000000000000000,  0.000000000000000,  -0.012548483967249,
        0.010184539709980,  0.000000000000000,  0.000000000000000,  0.078219628135298,  0.093081118502699,  0.000000000000000,  0.000000000000000,
        0.171242689406307,  0.145520825080207,  0.000000000000000,  0.000000000000000,  0.110252830557892,  -0.114380185542040, 0.000000000000000,
        0.000000000000000,  0.260187566193474,  0.042639036627239,  0.000000000000000,  0.000000000000000,  0.317935692624259,  0.347163153754528,
        0.000000000000000,  0.000000000000000,  0.361786992649796,  0.210740707823022,  0.000000000000000,  0.000000000000000,  0.277459845845585,
        0.360729792200193,  0.000000000000000,  0.000000000000000,  0.151683307135093,  0.250357672534026,  0.000000000000000,  0.000000000000000,
        -0.008249306072735, 0.009228751667698,  -0.013388463285919, -0.011189269082623, 0.006079985812750,  0.002489134841933,  -0.012226407679612,
        -0.009427290820542, 0.016629475745472,  0.005788230291708,  0.053146597450144,  0.047750295485057,  0.022560274790192,  0.004937035960085,
        0.033759474709593,  0.031838234502215,  0.035433928787700,  0.009832814271272,  -0.045275933536417, -0.037415654136234, 0.026489276131623,
        0.010298839288840,  0.002527915584413,  0.005096096072061,  0.040642382706785,  0.012791398168988,  -0.056451392150010, -0.047593404855643,
        0.019826280097814,  0.008651705611497,  -0.046448274032393, -0.039766893027790, 0.007810760478400,  0.004420581699765,  -0.004173185897101,
        -0.003746224157500, -0.001726203249977, -0.000373298520269, -0.004600870558950, -0.004809061198845, 0.020610376351899,  0.016178226452975,
        -0.005540263882139, -0.005678298466601, 0.049010017225784,  0.029456740236498,  0.012620208523035,  0.013666203964008,  0.045443303407182,
        -0.002326736002172, 0.005466109822306,  0.006229770868664,  0.086378771898709,  0.026494235960346,  -0.016275307355169, -0.016951471803727,
        0.085855245150239,  0.062568285751462,  -0.004181839073603, -0.003946027641166, 0.109999091428896,  0.052337990434926,  -0.018697102864577,
        -0.019602238982641, 0.071069486545912,  0.060513784670334,  -0.014356456577883, -0.015141182440600, 0.035304806412883,  0.038521078221383,
        -0.000996438180397, -0.001078359103771, -0.003444910161634, 0.000242716312565};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 4, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.071821938147383, -0.025014896216598, 0.000000000000000,  0.000000000000000,  0.065199164463588,
        0.012416267770927,  0.000000000000000,  0.000000000000000,  0.477433565632349,  -0.075771397657990, 0.000000000000000,  0.000000000000000,
        0.106556693055631,  -0.383007602384752, 0.000000000000000,  0.000000000000000,  -0.396572713437637, -0.267422493322078, 0.000000000000000,
        0.000000000000000,  0.071037795370421,  -0.255338401589835, 0.000000000000000,  0.000000000000000,  -0.198930652346812, 0.031571415690829,
        0.000000000000000,  0.000000000000000,  -0.333240173925006, -0.063460924162515, 0.000000000000000,  0.000000000000000,  -0.071223421996155,
        -0.024806438748126, 0.000000000000000,  0.000000000000000,  -0.054246208730990, -0.020688586198962, 0.000000000000000,  0.000000000000000,
        0.048375496352987,  0.009699221936818,  0.000000000000000,  0.000000000000000,  0.340170646376816,  -0.076064620725075, 0.000000000000000,
        0.000000000000000,  0.045023947308625,  -0.340020317511549, 0.000000000000000,  0.000000000000000,  -0.310438955722247, -0.228328693794502,
        0.000000000000000,  0.000000000000000,  0.030015964872417,  -0.226680211674366, 0.000000000000000,  0.000000000000000,  -0.141737769323673,
        0.031693591968781,  0.000000000000000,  0.000000000000000,  -0.247252536915265, -0.049573801010401, 0.000000000000000,  0.000000000000000,
        -0.053794156991565, -0.020516181313971, -0.003578398719285, -0.003586034522146, -0.006715418479521, -0.001981399183465, 0.005757231865391,
        0.005461312669594,  0.006487148108635,  0.001817865710195,  0.082791729471058,  0.075719741255144,  0.053835591179936,  0.013622212585667,
        0.107718657926880,  0.095367563716325,  0.025922412630552,  0.003722309171989,  0.011759998073997,  0.007913065645005,  -0.032168154009201,
        -0.010699634738659, 0.071812438617920,  0.063578375810883,  0.017281608420368,  0.002481539447993,  -0.034496553946274, -0.031549892189643,
        -0.022431496324973, -0.005675921910695, -0.029425851756443, -0.027913375866811, -0.033156534777468, -0.009291313629884, -0.003548578729958,
        -0.003556150901129, -0.006659456658858, -0.001964887523603, -0.000221718406667, -0.000316580099328, -0.017221446520823, -0.006731133202944,
        0.000878469902046,  0.001010791617311,  0.015941764765318,  0.005107235938666,  0.017400838835814,  0.019118177637374,  0.121730400858601,
        0.021150400917231,  0.027972213009243,  0.029999142166552,  0.038136025501553,  -0.030964838738505, 0.007283497915939,  0.007340219523210,
        -0.091216560733117, -0.049770232517396, 0.018648142006162,  0.019999428111035,  0.025424017001035,  -0.020643225825670, -0.007250349514923,
        -0.007965907348906, -0.050721000357750, -0.008812667048846, -0.004489957277124, -0.005166268266255, -0.081480131022739, -0.026103650353182,
        -0.000219870753279, -0.000313941931833, -0.017077934466483, -0.006675040426253};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 4, 36));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputePSForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix efxmat(12, 4);

    CDenseMatrix efymat(12, 4);

    CDenseMatrix efzmat(12, 4);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.035757029899980,  0.021387863907378,  0.000000000000000,  0.000000000000000,  0.040197040029245,
        0.024072948829603,  -0.088857803941875, -0.086287151265088, -0.058039631443688, -0.067167448116338, -0.096950123499849, -0.092338673812369,
        -0.038758745757674, -0.066048813633112, 0.000000000000000,  0.000000000000000,  0.065554554816630,  0.039211083830193,  0.000000000000000,
        0.000000000000000,  0.073694573386950,  0.044133739520939,  -0.162905973893438, -0.158193110652661, -0.106405990980095, -0.123140321546619,
        -0.177741893083056, -0.169287568656009, -0.071057700555736, -0.121089491660705, 2.300387143089191,  1.909059014190762,  0.133303413218098,
        0.484025161072659,  1.418609226553403,  1.276615297284585,  0.118193316594225,  0.373247241960366,  0.055475794026943,  0.069526279667211,
        0.101553994697348,  0.124028545905978,  0.223252564473668,  0.230092327418285,  0.071805235324299,  0.168105028862311};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 12, 4));

    std::vector<double> intyvals{
        2.300387143089191,  1.909059014190763,  0.163100938134748,  0.501848380995474,  1.418609226553403,  1.276615297284585,  0.151690849951930,
        0.393308032651702,  -0.018572375924620, -0.002379679720363, 0.053187635160941,  0.068055672475697,  0.142460794890461,  0.153143432574644,
        0.039506280526237,  0.113064350834718,  0.000000000000000,  0.000000000000000,  0.098331832224946,  0.058816625745290,  0.000000000000000,
        0.000000000000000,  0.110541860080425,  0.066200609281408,  -0.244358960840157, -0.237289665978991, -0.159608986470142, -0.184710482319929,
        -0.266612839624583, -0.253931352984014, -0.106586550833603, -0.181634237491058, 0.000000000000000,  0.000000000000000,  0.035757029899980,
        0.021387863907378,  0.000000000000000,  0.000000000000000,  0.040197040029245,  0.024072948829603,  -0.088857803941875, -0.086287151265088,
        -0.058039631443688, -0.067167448116338, -0.096950123499848, -0.092338673812369, -0.038758745757674, -0.066048813633112};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 12, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.098331832224946,  0.058816625745290,  0.000000000000000,  0.000000000000000,  0.110541860080425,
        0.066200609281408,  -0.244358960840157, -0.237289665978991, -0.159608986470142, -0.184710482319929, -0.266612839624583, -0.253931352984014,
        -0.106586550833603, -0.181634237491058, 2.300387143089191,  1.909059014190763,  0.289740419030511,  0.577597065667439,  1.418609226553403,
        1.276615297284585,  0.294055366722174,  0.478566393089880,  -0.333277098218762, -0.307980007117549, -0.152369392868787, -0.169829039602999,
        -0.200904225838170, -0.173889370510828, -0.097764277365525, -0.120858530782553, 0.000000000000000,  0.000000000000000,  0.065554554816630,
        0.039211083830193,  0.000000000000000,  0.000000000000000,  0.073694573386950,  0.044133739520939,  -0.162905973893438, -0.158193110652661,
        -0.106405990980095, -0.123140321546619, -0.177741893083056, -0.169287568656009, -0.071057700555736, -0.121089491660705};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 12, 4));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputePPForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix efxmat(12, 12);

    CDenseMatrix efymat(12, 12);

    CDenseMatrix efzmat(12, 12);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.002796979981041, 0.020878756920296,  0.000000000000000,  0.000000000000000,  -0.076044264053243,
        -0.034787819742586, 0.000000000000000,  0.000000000000000,  0.030370104598094,  0.047130780717984,  0.000000000000000,  0.000000000000000,
        0.003833204002038,  0.025231458193826,  0.000000000000000,  0.000000000000000,  -0.072495379291668, -0.035980694703059, 0.000000000000000,
        0.000000000000000,  0.038702251135634,  0.054202048519402,  -0.002796979981041, 0.003833204002038,  0.176258516513564,  0.118749198961110,
        -0.076044264053243, -0.072495379291668, 0.057889689813178,  0.054014182290085,  -0.168696022419575, -0.128310687649110, -0.025310267738910,
        -0.027610620857732, 0.020878756920296,  0.025231458193826,  0.118749198961110,  0.130413137174711,  -0.034787819742586, -0.035980694703059,
        0.054014182290085,  0.073621526700058,  -0.457075627882885, -0.329183730090095, -0.027610620857732, -0.065534558943466, 0.000000000000000,
        0.000000000000000,  -0.076044264053243, -0.034787819742586, 0.000000000000000,  0.000000000000000,  -0.100732774595066, -0.023923738202731,
        0.000000000000000,  0.000000000000000,  0.055678525096507,  0.086406431316303,  0.000000000000000,  0.000000000000000,  -0.072495379291668,
        -0.035980694703059, 0.000000000000000,  0.000000000000000,  -0.089532057206928, -0.021107315287387, 0.000000000000000,  0.000000000000000,
        0.070954127081995,  0.099370422285570,  -0.076044264053243, -0.072495379291668, 0.057889689813178,  0.054014182290085,  -0.100732774595066,
        -0.089532057206928, 0.250813420060840,  0.188312918577129,  -0.309276041102555, -0.235236260690036, -0.046402157521334, -0.050619471572509,
        -0.034787819742586, -0.035980694703059, 0.054014182290085,  0.073621526700058,  -0.023923738202731, -0.021107315287387, 0.188312918577129,
        0.225228739742968,  -0.837971984451955, -0.603503505165174, -0.050619471572509, -0.120146691396355, 0.000000000000000,  0.000000000000000,
        -0.168696022419575, -0.457075627882885, 0.000000000000000,  0.000000000000000,  -0.309276041102555, -0.837971984451955, 0.000000000000000,
        0.000000000000000,  -0.035100595941291, -0.225009222604570, 0.000000000000000,  0.000000000000000,  -0.128310687649110, -0.329183730090095,
        0.000000000000000,  0.000000000000000,  -0.235236260690036, -0.603503505165174, 0.000000000000000,  0.000000000000000,  0.001211817889519,
        -0.129741236723620, 0.030370104598094,  0.038702251135634,  -0.025310267738910, -0.027610620857732, 0.055678525096507,  0.070954127081995,
        -0.046402157521334, -0.050619471572509, -0.035100595941291, 0.001211817889519,  0.096901434220999,  0.039378409346490,  0.047130780717984,
        0.054202048519402,  -0.027610620857732, -0.065534558943466, 0.086406431316303,  0.099370422285570,  -0.050619471572509, -0.120146691396355,
        -0.225009222604570, -0.129741236723620, 0.039378409346490,  -0.014971113968138};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 12, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.087216468481593, -0.353326479244394, 0.000000000000000,  0.000000000000000,  -0.372646261146924,
        -0.866961834237444, 0.000000000000000,  0.000000000000000,  -0.135507731326154, -0.315258848813616, 0.000000000000000,  0.000000000000000,
        -0.031134718298297, -0.210966716314094, 0.000000000000000,  0.000000000000000,  -0.295649076766426, -0.633487417417723, 0.000000000000000,
        0.000000000000000,  -0.107508755187791, -0.230359060879172, -0.087216468481593, -0.031134718298297, 0.171665646701125,  0.083619515060683,
        -0.007691694947863, 0.010541311005605,  0.001839250656315,  -0.005607652997438, -0.002796979981041, 0.003833204002038,  0.000668818420478,
        -0.002039146544523, -0.353326479244394, -0.210966716314094, 0.083619515060683,  0.011007659366001,  0.057416581530815,  0.069386510033020,
        -0.005607652997438, -0.058795419146307, 0.020878756920296,  0.025231458193826,  -0.002039146544523, -0.021380152416839, 0.000000000000000,
        0.000000000000000,  -0.007691694947863, 0.057416581530815,  0.000000000000000,  0.000000000000000,  -0.151099161892599, -0.035885607304096,
        0.000000000000000,  0.000000000000000,  -0.076044264053243, -0.034787819742586, 0.000000000000000,  0.000000000000000,  0.010541311005605,
        0.069386510033020,  0.000000000000000,  0.000000000000000,  -0.134298085810392, -0.031660972931081, 0.000000000000000,  0.000000000000000,
        -0.072495379291668, -0.035980694703059, -0.372646261146924, -0.295649076766426, 0.001839250656315,  -0.005607652997438, -0.151099161892599,
        -0.134298085810392, 0.376220130091260,  0.282469377865693,  -0.076044264053243, -0.072495379291668, 0.057889689813178,  0.054014182290085,
        -0.866961834237444, -0.633487417417723, -0.005607652997438, -0.058795419146307, -0.035885607304096, -0.031660972931081, 0.282469377865693,
        0.337843109614452,  -0.034787819742586, -0.035980694703059, 0.054014182290085,  0.073621526700058,  0.000000000000000,  0.000000000000000,
        -0.002796979981041, 0.020878756920296,  0.000000000000000,  0.000000000000000,  -0.076044264053243, -0.034787819742586, 0.000000000000000,
        0.000000000000000,  0.030370104598094,  0.047130780717984,  0.000000000000000,  0.000000000000000,  0.003833204002038,  0.025231458193826,
        0.000000000000000,  0.000000000000000,  -0.072495379291668, -0.035980694703059, 0.000000000000000,  0.000000000000000,  0.038702251135634,
        0.054202048519402,  -0.135507731326154, -0.107508755187791, 0.000668818420478,  -0.002039146544523, -0.076044264053243, -0.072495379291668,
        0.057889689813178,  0.054014182290085,  0.030370104598094,  0.038702251135634,  0.238074279400720,  0.153571897400717,  -0.315258848813616,
        -0.230359060879172, -0.002039146544523, -0.021380152416839, -0.034787819742586, -0.035980694703059, 0.054014182290085,  0.073621526700058,
        0.047130780717984,  0.054202048519402,  0.153571897400717,  0.162155375443859};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 12, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.007691694947863, 0.057416581530815,  0.000000000000000,  0.000000000000000,  -0.151099161892599,
        -0.035885607304096, 0.000000000000000,  0.000000000000000,  -0.076044264053243, -0.034787819742586, 0.000000000000000,  0.000000000000000,
        0.010541311005605,  0.069386510033020,  0.000000000000000,  0.000000000000000,  -0.134298085810392, -0.031660972931081, 0.000000000000000,
        0.000000000000000,  -0.072495379291668, -0.035980694703059, -0.007691694947863, 0.010541311005605,  0.484710920412302,  0.326560297143052,
        -0.350165288910269, -0.301311024595136, 0.112835582951630,  0.101286859607244,  -0.076044264053243, -0.072495379291668, 0.057889689813178,
        0.054014182290085,  0.057416581530815,  0.069386510033020,  0.326560297143052,  0.358636127230456,  -0.540092015904964, -0.415046751540577,
        0.101286859607244,  0.110153175227127,  -0.034787819742586, -0.035980694703059, 0.054014182290085,  0.073621526700058,  0.000000000000000,
        0.000000000000000,  -0.350165288910269, -0.540092015904964, 0.000000000000000,  0.000000000000000,  -0.429220294071489, -0.770972073536380,
        0.000000000000000,  0.000000000000000,  -0.233443525940179, -0.360061343936643, 0.000000000000000,  0.000000000000000,  -0.301311024595136,
        -0.415046751540577, 0.000000000000000,  0.000000000000000,  -0.313834785204869, -0.514203940315840, 0.000000000000000,  0.000000000000000,
        -0.200874016396757, -0.276697834360385, -0.151099161892599, -0.134298085810392, 0.112835582951630,  0.101286859607244,  -0.429220294071489,
        -0.313834785204869, 0.519746337040403,  0.344602673221971,  -0.100732774595066, -0.089532057206928, 0.075223721967753,  0.067524573071496,
        -0.035885607304096, -0.031660972931081, 0.101286859607244,  0.110153175227127,  -0.770972073536380, -0.514203940315840, 0.344602673221971,
        0.280923615900374,  -0.023923738202731, -0.021107315287387, 0.067524573071496,  0.073435450151418,  0.000000000000000,  0.000000000000000,
        -0.076044264053243, -0.034787819742586, 0.000000000000000,  0.000000000000000,  -0.100732774595066, -0.023923738202731, 0.000000000000000,
        0.000000000000000,  0.055678525096507,  0.086406431316303,  0.000000000000000,  0.000000000000000,  -0.072495379291668, -0.035980694703059,
        0.000000000000000,  0.000000000000000,  -0.089532057206928, -0.021107315287387, 0.000000000000000,  0.000000000000000,  0.070954127081995,
        0.099370422285570,  -0.076044264053243, -0.072495379291668, 0.057889689813178,  0.054014182290085,  -0.233443525940179, -0.200874016396757,
        0.075223721967753,  0.067524573071496,  0.055678525096507,  0.070954127081995,  0.436469512234654,  0.281548478567981,  -0.034787819742586,
        -0.035980694703059, 0.054014182290085,  0.073621526700058,  -0.360061343936643, -0.276697834360385, 0.067524573071496,  0.073435450151418,
        0.086406431316303,  0.099370422285570,  0.281548478567981,  0.297284854980407};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 12, 12));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputePDForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix efxmat(12, 20);

    CDenseMatrix efymat(12, 20);

    CDenseMatrix efzmat(12, 20);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.920021819481803,  0.547386535115186,  -0.000136307295682, 0.046110471736725,  0.000000000000000,  0.000000000000000,  0.010019051618405,
        -0.033680426897209, 0.000000000000000,  0.000000000000000,  0.128269838917847,  0.066708855044915,  0.000000000000000,  0.000000000000000,
        -0.061740802163683, -0.076473013579689, 0.000000000000000,  0.000000000000000,  -0.013958069016598, -0.004718613315250, 0.731835644921182,
        0.510646118913834,  0.006099753276956,  0.056965782405635,  0.000000000000000,  0.000000000000000,  -0.002280007173577, -0.037285289828634,
        0.000000000000000,  0.000000000000000,  0.112357923386821,  0.066960301237165,  0.000000000000000,  0.000000000000000,  -0.066693839061115,
        -0.080728581575829, 0.000000000000000,  0.000000000000000,  -0.011504332418318, -0.004509208515069, -0.004235511098966, 0.007961671496746,
        0.097596004265236,  0.059233875845743,  -0.001347330359128, 0.007001997744882,  -0.118721026349637, -0.067211930387710, -0.027935617015365,
        -0.032945678554122, -0.022181678643362, -0.022398451434672, -0.147230610590158, -0.111243834089349, 0.017723350603900,  0.017951584982866,
        -0.059787116745003, -0.050645494595187, 0.064621379377754,  0.038499891156097,  0.097526365503405,  0.091880291944522,  0.101878779291985,
        0.143915330193647,  0.011433904509982,  0.015142323274662,  -0.116147774867671, -0.105442066764073, 0.018387580651963,  0.008658849459014,
        -0.038192003327139, -0.049068402861976, -0.164210750210443, -0.130403817257430, 0.030406355344472,  0.067592289621590,  -0.067420974649624,
        -0.057322730103678, 0.066352571536769,  0.074070841319774,  0.000000000000000,  0.000000000000000,  -0.061740802163683, -0.076473013579689,
        0.000000000000000,  0.000000000000000,  0.124108523887489,  0.021737071235693,  0.000000000000000,  0.000000000000000,  0.092952718694931,
        0.010022362154094,  0.920021819481803,  0.547386535115186,  -0.079650976748910, -0.052377500297723, 0.000000000000000,  0.000000000000000,
        -0.107693997088241, -0.073474065855818, 0.000000000000000,  0.000000000000000,  -0.066693839061115, -0.080728581575829, 0.000000000000000,
        0.000000000000000,  0.096543185279206,  0.017990841562467,  0.000000000000000,  0.000000000000000,  0.070528255455369,  0.006633359459869,
        0.731835644921182,  0.510646118913834,  -0.079793827332056, -0.047002845381418, 0.000000000000000,  0.000000000000000,  -0.099299877234726,
        -0.075312948305715, -0.147230610590158, -0.111243834089349, 0.017723350603900,  0.017951584982866,  -0.060095680551155, -0.050359046741257,
        -0.120690313694714, -0.076517645311077, 0.026284560408550,  0.024591094467302,  -0.171073198463051, -0.103875712544075, -0.193850691404473,
        -0.135306902709234, 0.120421531558137,  0.082353341353980,  -0.064865149998132, -0.043780205047407, 0.043182134924452,  0.034318675122862,
        -0.164210750210443, -0.130403817257430, 0.030406355344472,  0.067592289621590,  -0.006269369592344, -0.005712095571410, -0.131843073680129,
        -0.125701089935214, 0.070333878978906,  0.060891972486756,  -0.179081590063366, -0.180885662552780, -0.113957176434286, -0.076064018159743,
        0.141038479356836,  0.230966006221452,  -0.102460639734477, -0.079100855104423, 0.058678876490746,  0.083299858387483,  0.000000000000000,
        0.000000000000000,  0.059306371121666,  0.219480341236371,  0.000000000000000,  0.000000000000000,  0.409405132258013,  0.798040762733599,
        -0.531174845138148, -0.316033763399529, 0.338102579801716,  0.626104100324311,  0.000000000000000,  0.000000000000000,  0.108728347056388,
        0.402380625600014,  0.920021819481802,  0.547386535115186,  -0.058346660902879, -0.056664342401697, 0.000000000000000,  0.000000000000000,
        0.014624659325420,  0.123685623580112,  0.000000000000000,  0.000000000000000,  0.274843616548334,  0.541273662929573,  -0.422525506597808,
        -0.294821674215539, 0.220299262959457,  0.405580979713124,  0.000000000000000,  0.000000000000000,  0.026811875429937,  0.226756976563538,
        0.731835644921182,  0.510646118913834,  -0.027604252579265, -0.005391994522243, -0.004726152177105, 0.013078462197076,  -0.017649139909490,
        0.000777501740736,  0.036388916455892,  0.045559555477507,  0.017723350603900,  0.017951584982866,  0.002626346346680,  0.009876948142058,
        -0.042570056433255, -0.019027277046068, -0.008664612324693, 0.023977180694639,  -0.032356756500732, 0.001425419858015,  0.042315548306715,
        0.041567809078901,  0.096559027916372,  0.056075676081716,  -0.036646294123979, -0.019065951636535, 0.000659988062085,  0.033358718187760,
        0.025243003387072,  0.031753896143374,  0.030406355344472,  0.067592289621590,  -0.064964583217136, -0.050485543516674, -0.033193483418297,
        -0.020032735493002, -0.067184872560628, -0.034954244666980, 0.001209978113822,  0.061157650010893,  0.145031887429178,  0.128338695694167,
        0.096652499825536,  0.121748391716273};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 12, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.087222509154863,  0.228917567866871,  0.000000000000000,  0.000000000000000,  0.239861900175872,
        0.629523311633896,  -0.531174845138148, -0.316033763399529, 0.444994112233255,  0.681694812861740,  0.000000000000000,  0.000000000000000,
        0.324116341232869,  0.549328757311649,  -0.920021819481802, -0.547386535115186, -0.002707039212341, -0.130168119724654, 0.000000000000000,
        0.000000000000000,  0.037633324162056,  0.132704040610250,  0.000000000000000,  0.000000000000000,  0.103491641445654,  0.364936111678186,
        -0.422525506597808, -0.294821674215540, 0.313930865781808,  0.461381230744095,  0.000000000000000,  0.000000000000000,  0.225411629899389,
        0.377382873174968,  -0.731835644921182, -0.510646118913834, 0.005830092792817,  -0.101437032223741, -0.018693392902408, 0.000330622611554,
        -0.030809937610967, -0.008600519993929, -0.051406830481623, 0.000909212181775,  -0.084727328430159, -0.023651429983306, -0.020653334499458,
        -0.017577783986377, -0.061054788636057, -0.037692653241628, -0.001347330359128, 0.007001997744882,  -0.012312562050107, -0.005225316524975,
        -0.032557404523584, -0.047154927749163, -0.076367745616182, -0.052816085142886, -0.039588892895651, -0.022353373902492, -0.015455245334180,
        0.017314662814436,  -0.108869455463040, -0.061471778231852, -0.042501924668996, 0.047615322739698,  -0.049641599340500, -0.043269835634162,
        -0.065020152857579, -0.060923071211315, 0.011433904509982,  0.015142323274662,  -0.009273690996837, 0.015647424896632,  -0.113267226170999,
        -0.111080643386239, -0.090487809295496, -0.142862300467188, 0.000000000000000,  0.000000000000000,  0.010019051618405,  -0.033680426897209,
        0.920021819481803,  0.547386535115186,  0.023772793157330,  -0.034263274267979, 0.000000000000000,  0.000000000000000,  0.139429078042396,
        0.015033543231140,  0.000000000000000,  0.000000000000000,  0.124108523887489,  0.021737071235693,  0.000000000000000,  0.000000000000000,
        0.084771616041070,  0.084258725549851,  0.000000000000000,  0.000000000000000,  -0.002280007173577, -0.037285289828634, 0.731835644921182,
        0.510646118913834,  0.000658827067283,  -0.032010477412695, 0.000000000000000,  0.000000000000000,  0.105792383183054,  0.009950039189804,
        0.000000000000000,  0.000000000000000,  0.096543185279206,  0.017990841562467,  0.000000000000000,  0.000000000000000,  0.085675987551340,
        0.088168775625693,  -0.123760348389828, -0.097533595299688, -0.012312562050107, -0.005225316524975, -0.243930425197102, -0.177272774993615,
        0.019846270145876,  0.018588636928083,  0.039426840612826,  0.036886641700952,  -0.256609797694577, -0.155813568816112, -0.060095680551155,
        -0.050359046741257, -0.120690313694714, -0.076517645311077, 0.135707636991783,  0.100726866431294,  -0.028581008707618, -0.025688452913965,
        -0.114868597888361, -0.092962818992541, -0.009273690996837, 0.015647424896632,  -0.119181651094573, -0.080824097802585, 0.031169251290062,
        0.126215097942108,  0.105500818468359,  0.091337958730134,  -0.268622385095049, -0.271328493829170, -0.006269369592344, -0.005712095571410,
        -0.131843073680129, -0.125701089935214, 0.161783106223814,  0.127691693888015,  -0.043701422896391, -0.080828635304583, 0.920021819481803,
        0.547386535115186,  -0.000136307295682, 0.046110471736725,  0.000000000000000,  0.000000000000000,  0.010019051618405,  -0.033680426897209,
        0.000000000000000,  0.000000000000000,  0.128269838917847,  0.066708855044915,  0.000000000000000,  0.000000000000000,  -0.061740802163683,
        -0.076473013579689, 0.000000000000000,  0.000000000000000,  -0.013958069016598, -0.004718613315250, 0.731835644921182,  0.510646118913834,
        0.006099753276956,  0.056965782405635,  0.000000000000000,  0.000000000000000,  -0.002280007173577, -0.037285289828634, 0.000000000000000,
        0.000000000000000,  0.112357923386821,  0.066960301237165,  0.000000000000000,  0.000000000000000,  -0.066693839061115, -0.080728581575829,
        0.000000000000000,  0.000000000000000,  -0.011504332418318, -0.004509208515069, 0.051406769824080,  0.055477850153369,  0.049228520492723,
        0.031058142271773,  -0.123760348389828, -0.097533595299688, -0.012312562050107, -0.005225316524975, -0.027935617015365, -0.032945678554122,
        -0.022181678643362, -0.022398451434672, 0.036388916455892,  0.045559555477507,  -0.141889345845394, -0.075028335811236, 0.073754357470306,
        0.063393334180708,  -0.051460581676278, -0.029121869421432, 0.154936593866289,  0.141018992975069,  0.053299650259788,  0.088874652166054,
        -0.114868597888361, -0.092962818992541, -0.009273690996837, 0.015647424896632,  0.018387580651963,  0.008658849459014,  -0.038192003327139,
        -0.049068402861976, 0.025243003387072,  0.031753896143374,  -0.129904770461778, -0.114041947869468, 0.070363573421296,  0.060610152369634,
        -0.050237338140504, -0.058026785946450};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 12, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.010019051618405,  -0.033680426897209, 0.920021819481803,  0.547386535115186,  0.023772793157330,
        -0.034263274267979, 0.000000000000000,  0.000000000000000,  0.139429078042396,  0.015033543231140,  0.000000000000000,  0.000000000000000,
        0.124108523887489,  0.021737071235693,  0.000000000000000,  0.000000000000000,  0.084771616041070,  0.084258725549851,  0.000000000000000,
        0.000000000000000,  -0.002280007173577, -0.037285289828634, 0.731835644921182,  0.510646118913834,  0.000658827067283,  -0.032010477412695,
        0.000000000000000,  0.000000000000000,  0.105792383183054,  0.009950039189804,  0.000000000000000,  0.000000000000000,  0.096543185279206,
        0.017990841562467,  0.000000000000000,  0.000000000000000,  0.085675987551340,  0.088168775625693,  -0.001347330359128, 0.007001997744882,
        -0.118721026349637, -0.067211930387710, -0.007450731274158, 0.024670984297033,  -0.185715535887306, -0.101158230761291, -0.278611509492701,
        -0.234704795827857, 0.019847502088669,  0.005232378083003,  -0.126866417658809, -0.107378461129204, -0.062649333167698, -0.042706765022312,
        -0.047911890054267, -0.056076523135562, 0.131031687741676,  0.067291467880137,  0.011433904509982,  0.015142323274662,  -0.116147774867671,
        -0.105442066764073, 0.124811819447682,  0.128015381577238,  -0.175292047096776, -0.107707783675164, -0.222642708447173, -0.189527439719251,
        0.009044629819944,  0.043271233899374,  -0.075161643627804, -0.064678536808066, -0.073548118841492, -0.059652276302102, -0.027670647373702,
        -0.034466019512789, 0.116609702909860,  0.100805602186475,  0.000000000000000,  0.000000000000000,  0.295434318222651,  0.339742080804161,
        0.000000000000000,  0.000000000000000,  0.566131763438858,  0.739820897877866,  1.062349690276296,  0.632067526799059,  0.226941612315607,
        0.493372726670372,  0.000000000000000,  0.000000000000000,  0.377421175625906,  0.493213931918577,  0.000000000000000,  0.000000000000000,
        -0.123097632592771, -0.141559200335067, 0.000000000000000,  0.000000000000000,  0.220738623682643,  0.244173475928068,  0.000000000000000,
        0.000000000000000,  0.372405411723838,  0.470338860717922,  0.845051013195616,  0.589643348431079,  0.089661252115595,  0.276997166663992,
        0.000000000000000,  0.000000000000000,  0.248270274482559,  0.313559240478614,  0.000000000000000,  0.000000000000000,  -0.091974426534434,
        -0.101738948303362, -0.060095680551155, -0.050359046741257, -0.062649333167698, -0.042706765022312, -0.214648956458607, -0.148081162974004,
        -0.238544151566167, -0.133257059007202, -0.172834099761113, -0.076742568092893, -0.150296185260005, -0.058758047951456, -0.143099304305738,
        -0.098720775316003, -0.159029434377444, -0.088838039338135, 0.025039866896314,  0.020982936142190,  0.026103888819874,  0.017794485425963,
        -0.006269369592344, -0.005712095571410, -0.073548118841492, -0.059652276302102, -0.143261078606958, -0.099893525965223, -0.230848714987843,
        -0.139899574436031, -0.073945178154151, -0.013956169733040, -0.103681440312813, 0.060435934881379,  -0.095507385737972, -0.066595683976815,
        -0.153899143325229, -0.093266382957354, 0.002612237330143,  0.002380039821421,  0.030645049517288,  0.024855115125876,  0.000000000000000,
        0.000000000000000,  -0.061740802163683, -0.076473013579689, 0.000000000000000,  0.000000000000000,  0.124108523887489,  0.021737071235693,
        0.000000000000000,  0.000000000000000,  0.092952718694931,  0.010022362154094,  0.920021819481803,  0.547386535115186,  -0.079650976748910,
        -0.052377500297723, 0.000000000000000,  0.000000000000000,  -0.107693997088241, -0.073474065855818, 0.000000000000000,  0.000000000000000,
        -0.066693839061115, -0.080728581575829, 0.000000000000000,  0.000000000000000,  0.096543185279206,  0.017990841562467,  0.000000000000000,
        0.000000000000000,  0.070528255455369,  0.006633359459869,  0.731835644921182,  0.510646118913834,  -0.079793827332056, -0.047002845381418,
        0.000000000000000,  0.000000000000000,  -0.099299877234726, -0.075312948305715, 0.036388916455892,  0.045559555477507,  -0.141889345845394,
        -0.075028335811236, -0.126866417658810, -0.107378461129204, -0.062649333167698, -0.042706765022312, -0.185741006328467, -0.156469863885238,
        0.013231668059113,  0.003488252055335,  0.098271283441517,  0.114153035238036,  -0.133507758247558, -0.065569259909364, 0.057547868032568,
        0.060755387997163,  -0.063226329375077, -0.027667938739872, 0.025243003387072,  0.031753896143374,  -0.129904770461778, -0.114041947869468,
        -0.075161643627804, -0.064678536808066, -0.073548118841492, -0.059652276302102, -0.148428472298115, -0.126351626479501, 0.006029753213296,
        0.028847489266249,  0.187446522470851,  0.181914162250627,  -0.114001948062200, -0.057997553423412, 0.023841862663867,  0.029004287162780,
        -0.048195207380087, -0.037789633273222};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 12, 20));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputePFForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix efxmat(12, 28);

    CDenseMatrix efymat(12, 28);

    CDenseMatrix efzmat(12, 28);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.016286584752050, -0.053738580658803, 0.000000000000000,  0.000000000000000,  0.002997761613370,
        -0.074199413799500, 0.000000000000000,  0.000000000000000,  -0.036540877984552, 0.031770656903591,  0.000000000000000,  0.000000000000000,
        -0.189515517568633, -0.098574265253688, 0.000000000000000,  0.000000000000000,  0.074038350446840,  0.088591381384726,  0.000000000000000,
        0.000000000000000,  0.032317936535225,  0.007811363563214,  0.000000000000000,  0.000000000000000,  0.040022481713869,  0.084376660594691,
        0.000000000000000,  0.000000000000000,  -0.020618182692179, -0.057631290165249, 0.000000000000000,  0.000000000000000,  -0.007139993724414,
        -0.083893928515159, 0.000000000000000,  0.000000000000000,  -0.016598904913577, 0.033965574635539,  0.000000000000000,  0.000000000000000,
        -0.152847260163900, -0.093613892252923, 0.000000000000000,  0.000000000000000,  0.071720736505591,  0.088428946698086,  0.000000000000000,
        0.000000000000000,  0.023546534889181,  0.006937081963613,  0.000000000000000,  0.000000000000000,  0.042287894401280,  0.089793905618954,
        -0.007631545922405, -0.003119407660035, -0.047634478909012, -0.023035491851315, -0.001619096369925, 0.012909357767115,  -0.045390459849871,
        -0.025760679749420, -0.005434106751864, -0.000690360030673, 0.083237720284987,  0.038141375102812,  0.001573468979613,  -0.009566499899934,
        0.003723312823755,  0.008156155589569,  -0.102795583196465, -0.077511049470192, 0.000653732069025,  -0.004001311596866, -0.068361371105772,
        -0.056954324349521, -0.069762136395590, -0.033417852169948, -0.040135803233918, -0.038360736495434, 0.023689931061057,  0.011769883474286,
        0.021055830743804,  0.021198820222163,  -0.067597570811291, -0.068578621099573, 0.053096041587014,  0.055569932118781,  -0.074628019862525,
        -0.103183920273163, -0.002981965876940, -0.001787234734684, 0.112808299055741,  0.081333188708423,  0.016033789279088,  0.010716384491335,
        0.023001016669470,  0.032337181475644,  -0.060960147585840, -0.054642704950407, -0.010763054367364, -0.032085935310480, -0.035233895732980,
        -0.033108306950916, -0.098336456436993, -0.085280191400072, -0.057295282131903, -0.056014249408113, 0.034359146150808,  0.043962067444652,
        0.000000000000000,  0.000000000000000,  0.113542380425614,  0.069160115712409,  0.000000000000000,  0.000000000000000,  0.093322815697758,
        0.047489241730186,  0.000000000000000,  0.000000000000000,  -0.126666856633544, 0.001697624243240,  0.000000000000000,  0.000000000000000,
        -0.058212494899588, 0.017427411137164,  0.000000000000000,  0.000000000000000,  0.027911182035354,  -0.062893244461206, 0.000000000000000,
        0.000000000000000,  0.177196853849916,  0.046032857184500,  0.000000000000000,  0.000000000000000,  -0.010146950914531, -0.019834432984710,
        0.000000000000000,  0.000000000000000,  0.094401079367708,  0.066220137443962,  0.000000000000000,  0.000000000000000,  0.081323772151574,
        0.039928563771562,  0.000000000000000,  0.000000000000000,  -0.083244668983281, 0.005226241328195,  0.000000000000000,  0.000000000000000,
        -0.036877849007000, 0.021742827010149,  0.000000000000000,  0.000000000000000,  0.015575506792274,  -0.075729128836177, 0.000000000000000,
        0.000000000000000,  0.134235026475027,  0.037839523551366,  0.000000000000000,  0.000000000000000,  -0.012257637871368, -0.019614777883909,
        -0.058275977463333, -0.040413410071946, -0.026057937075625, -0.016831615093471, -0.116448761392473, -0.077122018225697, -0.035299029573483,
        -0.024886930675707, -0.005670057407032, 0.000151879989152,  0.128805505689939,  0.060466381878242,  0.063210117696215,  0.050316113583317,
        0.112403314452344,  0.054427100779712,  -0.049137775095503, -0.018363935712124, -0.057629336752106, -0.034763935975653, -0.048276766018626,
        -0.028434327444654, -0.091154431806884, -0.049289525994695, 0.034335117135553,  0.025520307694803,  -0.002136312939451, 0.000332328851531,
        -0.035779102563683, -0.030581496818209, -0.048697126828104, -0.057559597952870, -0.029853977665367, -0.020786105429104, -0.071213656596423,
        -0.115540824003233, 0.012122095362786,  0.012505705449104,  0.178704772562878,  0.125961874168578,  0.020844183392874,  0.018434163088554,
        0.160067535887911,  0.141532790282630,  0.044400135089277,  0.050417642745834,  -0.100275274991631, -0.149219967251817, -0.018495244420035,
        -0.012522647079607, -0.144066057199962, -0.142169988187840, 0.015919979519049,  0.013958319190761,  0.000603421711036,  0.010576874836107,
        0.000000000000000,  0.000000000000000,  -0.022354544013052, -0.097778107717253, 0.000000000000000,  0.000000000000000,  -0.178236071602306,
        -0.394579850381695, 0.000000000000000,  0.000000000000000,  -0.584235962346610, -0.774810346859410, 0.000000000000000,  0.000000000000000,
        -0.172594809186819, -0.155814341951802, 0.000000000000000,  0.000000000000000,  -0.153333195716708, -0.354753966962010, 0.000000000000000,
        0.000000000000000,  0.154825839132206,  0.108956129744586,  0.000000000000000,  0.000000000000000,  0.010528408110401,  0.043065502123016,
        0.000000000000000,  0.000000000000000,  -0.025323844614805, -0.094096541078115, 0.000000000000000,  0.000000000000000,  -0.065901009872495,
        -0.217838721401706, 0.000000000000000,  0.000000000000000,  -0.352996247441147, -0.490779236778147, 0.000000000000000,  0.000000000000000,
        -0.091606590745716, -0.064197756122217, 0.000000000000000,  0.000000000000000,  -0.036642816152291, -0.169301605193553, 0.000000000000000,
        0.000000000000000,  0.076830444123161,  0.023521202114890,  0.000000000000000,  0.000000000000000,  -0.021992444207543, -0.010500575920087,
        0.039413632306756,  0.039423157193442,  -0.035641071796718, -0.018538962020282, 0.002719237355396,  0.022466108036876,  0.005933486810758,
        -0.007811016355985, 0.016900388374552,  0.022624396597277,  0.000653732069025,  -0.004001311596866, -0.036589828281072, -0.034674136480715,
        0.038449560823913,  0.018539119068794,  -0.019274885895737, 0.003729094902414,  0.026135152148115,  0.000990784413389,  0.050357639497236,
        0.048544415894257,  -0.050623336482432, -0.024946643636364, 0.027743180998836,  0.018809964241315,  -0.027500986431190, -0.009492760701818,
        0.053362274575214,  0.053031058610468,  -0.054142181222456, -0.061869779331119, -0.016292658750002, -0.007634939928496, -0.020946656231459,
        -0.055711453384207, -0.004897119511538, -0.001604004924754, -0.010763054367364, -0.032085935310480, -0.058885552481050, -0.057422274711226,
        0.054453056273303,  0.055567564233514,  -0.047622039815147, -0.037418506210853, 0.005036336356401,  -0.030428370398171, 0.077044372185598,
        0.075524935179814,  -0.073149944570769, -0.077275973851418, 0.044347266100862,  0.040278573199524,  -0.028528309877514, -0.019300445043568};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 12, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.009953060759718,  0.059436919138423,  0.000000000000000,  0.000000000000000,  -0.242871944672757,
        -0.410202577508122, 0.000000000000000,  0.000000000000000,  -0.358849460998730, -0.573066346472354, 0.000000000000000,  0.000000000000000,
        -0.330524407160680, -0.237959562996542, 0.000000000000000,  0.000000000000000,  -0.475390419846852, -0.543830495259167, 0.000000000000000,
        0.000000000000000,  0.020635834315737,  0.226369881876172,  0.000000000000000,  0.000000000000000,  0.052856950739973,  0.152900572835449,
        0.000000000000000,  0.000000000000000,  0.024470967999458,  0.075244391639100,  0.000000000000000,  0.000000000000000,  -0.112994079650857,
        -0.231712885328933, 0.000000000000000,  0.000000000000000,  -0.151583318104392, -0.291432992535108, 0.000000000000000,  0.000000000000000,
        -0.218979307548966, -0.142209332999654, 0.000000000000000,  0.000000000000000,  -0.299743560878069, -0.352173214348616, 0.000000000000000,
        0.000000000000000,  -0.002290823488431, 0.163791967356209,  0.000000000000000,  0.000000000000000,  0.026351591352647,  0.106856006386164,
        -0.040895026329243, -0.037677233139095, 0.038193920950807,  0.018193576729079,  -0.014766571026501, 0.007366722476965,  0.028533354711047,
        0.003808859932358,  -0.053963877345953, -0.018066294289666, 0.072649388354233,  0.019841277712546,  -0.035278604131394, -0.042646219730660,
        0.041552321510376,  0.025335915393435,  -0.005434106751864, -0.000690360030673, 0.022733594800723,  0.009569192997064,  -0.045337917134276,
        -0.060974761941691, 0.036262152515013,  0.026614208812875,  -0.020171611550573, -0.027733576074646, 0.014453090754734,  0.011258063301300,
        -0.056496870360201, -0.054853448552896, 0.053429238923300,  0.055571142122110,  -0.018052847789535, -0.009749957818161, 0.013294684587546,
        -0.032394123984181, -0.071008889026593, -0.057204606493552, 0.061451364270864,  -0.005846221736130, -0.045524061415144, -0.048491954301780,
        0.073620570164528,  0.082515215463218,  -0.002981965876940, -0.001787234734684, 0.028755870245932,  0.005140265700432,  -0.062733744460791,
        -0.068281227785374, 0.076338266089066,  0.113986631088246,  -0.028325998755375, -0.030964135716002, 0.032172237184315,  0.051493479667392,
        0.000000000000000,  0.000000000000000,  -0.062482128870438, -0.032484037074175, 0.000000000000000,  0.000000000000000,  -0.026232207523093,
        0.020603061642398,  0.000000000000000,  0.000000000000000,  -0.077644531825933, -0.061478557591839, 0.000000000000000,  0.000000000000000,
        -0.087318742349382, 0.026141116705746,  0.000000000000000,  0.000000000000000,  -0.126666856633544, 0.001697624243240,  0.000000000000000,
        0.000000000000000,  -0.133124153792477, -0.052464636510162, 0.000000000000000,  0.000000000000000,  -0.060767411058312, -0.056404212428915,
        0.000000000000000,  0.000000000000000,  -0.050388540576963, -0.030848583565305, 0.000000000000000,  0.000000000000000,  -0.007337366032779,
        0.017987903255151,  0.000000000000000,  0.000000000000000,  -0.053795050693794, -0.071373927729347, 0.000000000000000,  0.000000000000000,
        -0.055316773510499, 0.032614240515223,  0.000000000000000,  0.000000000000000,  -0.083244668983281, 0.005226241328195,  0.000000000000000,
        0.000000000000000,  -0.109022718511797, -0.043812576438213, 0.000000000000000,  0.000000000000000,  -0.055949748908284, -0.054891930034151,
        0.020176990233298,  0.013294449316725,  0.016162629306637,  0.009740854867931,  -0.100213847269102, -0.069091872180575, 0.028484040867341,
        0.008561204327136,  -0.053862822934696, -0.018237369054497, 0.049708584656177,  0.015624715589549,  0.094815176544322,  0.075474170374975,
        0.168604971678516,  0.081640651169569,  -0.005670057407032, 0.000151879989152,  0.128805505689939,  0.060466381878242,  0.106287158539119,
        0.069167281212148,  0.058706556835832,  0.036205551825631,  0.072553080221909,  0.052742006755722,  0.007605222205620,  0.007344025833236,
        0.014494767755922,  0.012245805189211,  0.028328376601926,  0.029456740236498,  -0.020985272820663, -0.014884139419245, 0.026824449040087,
        -0.026917391243936, 0.054501881224932,  0.060839063953420,  0.048645368810767,  -0.044251738778002, 0.031266275089312,  0.027651244632830,
        0.240101303831867,  0.212299185423945,  0.012122095362786,  0.012505705449104,  0.178704772562878,  0.125961874168578,  0.029366798195679,
        0.020324074319175,  0.104648755643390,  0.138090245144431,  0.037216290896248,  0.032308401693722,  0.020739189123005,  0.038521078221383,
        0.000000000000000,  0.000000000000000,  -0.016286584752050, -0.053738580658803, 0.000000000000000,  0.000000000000000,  0.002997761613370,
        -0.074199413799500, 0.000000000000000,  0.000000000000000,  -0.036540877984552, 0.031770656903591,  0.000000000000000,  0.000000000000000,
        -0.189515517568633, -0.098574265253688, 0.000000000000000,  0.000000000000000,  0.074038350446840,  0.088591381384726,  0.000000000000000,
        0.000000000000000,  0.032317936535225,  0.007811363563214,  0.000000000000000,  0.000000000000000,  0.040022481713869,  0.084376660594691,
        0.000000000000000,  0.000000000000000,  -0.020618182692179, -0.057631290165249, 0.000000000000000,  0.000000000000000,  -0.007139993724414,
        -0.083893928515159, 0.000000000000000,  0.000000000000000,  -0.016598904913577, 0.033965574635539,  0.000000000000000,  0.000000000000000,
        -0.152847260163900, -0.093613892252923, 0.000000000000000,  0.000000000000000,  0.071720736505591,  0.088428946698086,  0.000000000000000,
        0.000000000000000,  0.023546534889181,  0.006937081963613,  0.000000000000000,  0.000000000000000,  0.042287894401280,  0.089793905618954,
        0.058185439284763,  0.051941870393300,  0.002269445338027,  0.000530901348578,  0.062634466377342,  0.066662705375011,  0.003328042188000,
        -0.002754084727939, -0.085231421132542, -0.067447324075653, 0.022733594800723,  0.009569192997064,  0.001573468979614,  -0.009566499899934,
        0.003723312823755,  0.008156155589569,  0.016900388374551,  0.022624396597277,  0.091409920295420,  0.038856961561756,  0.085847179487669,
        0.072053709909431,  0.047162268495300,  0.021797975881605,  -0.027258566997733, -0.027587877745869, 0.033453742326782,  0.016380699535135,
        0.051883096198148,  0.050363104443079,  0.001729041325186,  -0.005734545137511, 0.083191033464303,  0.084041445365238,  -0.006948198172950,
        -0.041832648023114, -0.040357317926474, -0.037146368085120, 0.028755870245932,  0.005140265700432,  0.016033789279088,  0.010716384491335,
        0.023001016669470,  0.032337181475644,  -0.004897119511538, -0.001604004924754, 0.115315588847349,  0.082203449201507,  0.036994084772513,
        0.035223324840582,  0.064095115617988,  0.061962862000045,  -0.051263860629966, -0.050308193799673, 0.047923048525336,  0.056257647524186};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 12, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.062482128870438, -0.032484037074175, 0.000000000000000,  0.000000000000000,  -0.026232207523093,
        0.020603061642398,  0.000000000000000,  0.000000000000000,  -0.077644531825933, -0.061478557591839, 0.000000000000000,  0.000000000000000,
        -0.087318742349382, 0.026141116705745,  0.000000000000000,  0.000000000000000,  -0.126666856633544, 0.001697624243240,  0.000000000000000,
        0.000000000000000,  -0.133124153792477, -0.052464636510162, 0.000000000000000,  0.000000000000000,  -0.060767411058312, -0.056404212428915,
        0.000000000000000,  0.000000000000000,  -0.050388540576963, -0.030848583565305, 0.000000000000000,  0.000000000000000,  -0.007337366032779,
        0.017987903255151,  0.000000000000000,  0.000000000000000,  -0.053795050693794, -0.071373927729347, 0.000000000000000,  0.000000000000000,
        -0.055316773510499, 0.032614240515223,  0.000000000000000,  0.000000000000000,  -0.083244668983281, 0.005226241328195,  0.000000000000000,
        0.000000000000000,  -0.109022718511797, -0.043812576438213, 0.000000000000000,  0.000000000000000,  -0.055949748908284, -0.054891930034151,
        -0.019170120488378, -0.019622619084725, -0.013671238449745, -0.004347749762440, -0.000912886659689, 0.013981483213447,  0.103776271289505,
        0.044116851178516,  -0.017289053843552, 0.012359572799452,  0.077439642169797,  0.028720299054683,  -0.198378878071349, -0.169806577656310,
        -0.053701380476139, -0.023340249325876, -0.127582621044178, -0.101837926190678, 0.036368647311203,  0.016814436994460,  -0.088225899595790,
        -0.093558762000849, -0.088777635696995, -0.033441685830306, -0.021879985510115, -0.026258957407759, -0.063996060409695, -0.026468625279654,
        -0.003934575722218, -0.005189364725468, -0.013116880653577, -0.008113087784300, 0.025525169171511,  0.029117290143461,  0.131420537105795,
        0.067898211324321,  0.071632250914302,  0.077045333405703,  0.087169398681930,  -0.009329982399340, -0.106059537128055, -0.102266507050561,
        -0.068727039506593, -0.067651489647170, -0.044979136935113, -0.041515192725172, 0.050291339659004,  0.009556019573035,  -0.061738949941931,
        -0.065866961236010, -0.100236522744144, -0.047636788121625, -0.007014133451289, -0.009536006101505, -0.078729428290200, -0.051646509028533,
        0.000000000000000,  0.000000000000000,  -0.039855175000947, -0.032993608585310, 0.000000000000000,  0.000000000000000,  -0.517574405222173,
        -0.476599167795438, 0.000000000000000,  0.000000000000000,  -0.514116580115088, -0.641328372905193, 0.000000000000000,  0.000000000000000,
        0.068878773039258,  -0.199001350467501, 0.000000000000000,  0.000000000000000,  -0.342744386743392, -0.427552248603462, 0.000000000000000,
        0.000000000000000,  0.215656002175905,  0.198582986581433,  0.000000000000000,  0.000000000000000,  0.203704227782616,  0.168633999436031,
        0.000000000000000,  0.000000000000000,  -0.026538804959185, -0.022356601240471, 0.000000000000000,  0.000000000000000,  -0.313139626208897,
        -0.290678082019645, 0.000000000000000,  0.000000000000000,  -0.259250625706452, -0.366913567404331, 0.000000000000000,  0.000000000000000,
        0.082967517264579,  -0.136027861007630, 0.000000000000000,  0.000000000000000,  -0.172833750470968, -0.244609044936221, 0.000000000000000,
        0.000000000000000,  0.130474844253707,  0.121115867508185,  0.000000000000000,  0.000000000000000,  0.135642780902501,  0.114267073006854,
        -0.004148456993255, -0.003247507786871, 0.006301479233598,  0.003083869047915,  -0.089081256649562, -0.056805666152654, 0.124582793287276,
        0.053193334157815,  -0.119927609452869, -0.046430485588418, 0.173604077565774,  0.060523968166272,  0.025085704957168,  0.064842551325676,
        -0.006424512239996, -0.021118883567151, -0.079951739635246, -0.030953657058945, 0.115736051710516,  0.040349312110848,  0.037117190270651,
        0.023669027563606,  -0.051909497203032, -0.022163889232423, 0.021203224632190,  0.016598373132898,  -0.032207560527281, -0.015761997356009,
        -0.000198890185649, -0.000188623410770, 0.009128521235905,  0.005107235938666,  -0.025533651207546, -0.018738783849239, 0.158820383068316,
        0.066704525965932,  -0.017049848135308, 0.002730538591562,  0.183984149005671,  0.004709360640051,  0.076709135641212,  0.089203184733401,
        -0.058142160280798, -0.147983041846568, -0.011366565423538, 0.001820359061041,  0.122656099337114,  0.003139573760034,  0.010639021336478,
        0.007807826603850,  -0.066175159611798, -0.027793552485805, 0.001016549837763,  0.000964075210601,  -0.046656886316845, -0.026103650353182,
        0.000000000000000,  0.000000000000000,  0.113542380425614,  0.069160115712409,  0.000000000000000,  0.000000000000000,  0.093322815697758,
        0.047489241730186,  0.000000000000000,  0.000000000000000,  -0.126666856633544, 0.001697624243240,  0.000000000000000,  0.000000000000000,
        -0.058212494899588, 0.017427411137164,  0.000000000000000,  0.000000000000000,  0.027911182035354,  -0.062893244461206, 0.000000000000000,
        0.000000000000000,  0.177196853849916,  0.046032857184500,  0.000000000000000,  0.000000000000000,  -0.010146950914531, -0.019834432984710,
        0.000000000000000,  0.000000000000000,  0.094401079367708,  0.066220137443962,  0.000000000000000,  0.000000000000000,  0.081323772151574,
        0.039928563771562,  0.000000000000000,  0.000000000000000,  -0.083244668983281, 0.005226241328195,  0.000000000000000,  0.000000000000000,
        -0.036877849007000, 0.021742827010149,  0.000000000000000,  0.000000000000000,  0.015575506792274,  -0.075729128836177, 0.000000000000000,
        0.000000000000000,  0.134235026475027,  0.037839523551366,  0.000000000000000,  0.000000000000000,  -0.012257637871368, -0.019614777883909,
        0.036157088268691,  0.038587554091535,  0.045543345539691,  0.016981036019419,  0.067550077383792,  0.076808022651461,  0.104213044444056,
        0.040995591431260,  -0.127582621044178, -0.101837926190678, 0.036368647311203,  0.016814436994460,  -0.132252585380899, -0.113204385104207,
        -0.035800920317426, -0.015560166217250, 0.089029797026596,  0.097224511291683,  0.047132436077128,  0.014708268225967,  0.104763537979411,
        0.099596373221427,  0.024884182137863,  0.005508000329196,  -0.005011993586124, -0.007396760706647, -0.031970180695833, -0.013756275778840,
        0.008451321783854,  0.011262910977018,  0.050771490585102,  0.032607989297045,  0.056327135437778,  0.060745955231206,  0.122596741878270,
        0.060146910167361,  -0.044979136935113, -0.041515192725172, 0.050291339659004,  0.009556019573035,  -0.070706358085370, -0.068177671367040,
        -0.045818026337728, -0.045100993098113, 0.109114865026897,  0.111641327343347,  0.045259948966093,  -0.017293332043536, 0.053185554414962,
        0.055291320834682,  0.017134972642481,  0.003957587535003,  -0.002509363959092, -0.003476850723917, -0.040841835544466, -0.026992953184691};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 12, 28));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputePGForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix efxmat(12, 36);

    CDenseMatrix efymat(12, 36);

    CDenseMatrix efzmat(12, 36);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, 0.000000000000000,  -0.027719471933182, -0.034128443682612, 0.000000000000000,  0.000000000000000,  0.032126932110667,
        0.087829592600264,  0.000000000000000,  0.000000000000000,  -0.015411831636015, 0.053673893191894,  0.000000000000000,  0.000000000000000,
        0.085326592678368,  -0.020381738930349, 0.000000000000000,  0.000000000000000,  0.236064584988568,  0.114296641831983,  0.000000000000000,
        0.000000000000000,  -0.057792990256204, -0.085996830305580, 0.000000000000000,  0.000000000000000,  -0.055556740653776, -0.011388794109751,
        0.000000000000000,  0.000000000000000,  -0.085745436294697, -0.138034677826463, 0.000000000000000,  0.000000000000000,  -0.053973260360700,
        -0.079805618386698, -0.000000000000000, 0.000000000000000,  -0.023647888001694, -0.033097571676218, 0.000000000000000,  0.000000000000000,
        0.035309587279893,  0.086844253245226,  0.000000000000000,  0.000000000000000,  -0.004755472454641, 0.056891237359226,  0.000000000000000,
        0.000000000000000,  0.049892281034057,  -0.022521850983314, 0.000000000000000,  0.000000000000000,  0.175358849644204,  0.102866244894461,
        0.000000000000000,  0.000000000000000,  -0.054399910028117, -0.082136846728862, 0.000000000000000,  0.000000000000000,  -0.037191843989023,
        -0.009656102239242, 0.000000000000000,  0.000000000000000,  -0.077709824178631, -0.135489040754616, 0.000000000000000,  0.000000000000000,
        -0.048483305039960, -0.077688400165636, -0.019351599744358, -0.016512518009040, 0.002859322801777,  0.000882464322828,  -0.009499529546007,
        -0.003376277240892, 0.054733346956197,  0.020827985215847,  -0.007187142857156, 0.004843822474703,  0.014135750482016,  0.009228159985579,
        -0.010655776580075, -0.009765915932325, -0.055689346265758, -0.019988560572736, 0.014949219791467,  0.003103841367977,  0.008817374414190,
        -0.001077233564283, -0.062081873111588, -0.048094579883349, -0.010644932298823, -0.002233525054529, -0.053128700625746, -0.042444630655896,
        0.063163573489844,  0.022837857546277,  -0.051566899950157, -0.047916660768641, -0.012376630198424, -0.006150028651179, -0.016477350805450,
        -0.015503815421044, -0.022990128906035, -0.008634579130305, -0.009529453814726, -0.010037447375114, 0.004567648715567,  -0.000053306144024,
        0.012974645737711,  0.014303680254105,  0.103578098247642,  0.077912925959147,  0.015269525033799,  0.017873799452763,  0.043738314041710,
        0.058765511089975,  -0.005441091024943, -0.006057348341077, -0.100581250888862, -0.056785828176818, 0.009975211999210,  0.008421577642830,
        -0.003591865427524, -0.015908409135918, -0.022720533952098, -0.023205196241632, -0.012131101607352, 0.001129930192513,  -0.013189006572434,
        -0.013494315204349, 0.114499303736761,  0.070785739636221,  -0.035038526403916, -0.037505911371370, -0.029598454188515, -0.037922904670258,
        -0.015897381116538, -0.016896486643672, -0.042909482418621, -0.034344538806299, 0.000000000000000,  0.000000000000000,  -0.034348249172716,
        -0.010300493143410, 0.000000000000000,  0.000000000000000,  -0.193637174131322, -0.044170155815567, 0.000000000000000,  0.000000000000000,
        -0.053059348680012, 0.048559867112511,  0.000000000000000,  0.000000000000000,  0.086622882448322,  -0.029225991069300, 0.000000000000000,
        0.000000000000000,  -0.002385008198858, -0.065229008870258, 0.000000000000000,  0.000000000000000,  0.061653184470477,  0.124955311372214,
        0.000000000000000,  0.000000000000000,  -0.162564988378552, 0.035895245708214,  -0.000000000000000, 0.000000000000000,  0.012911231402748,
        0.012541918548442,  0.000000000000000,  0.000000000000000,  0.075827354888991,  0.035942607034397,  0.000000000000000,  0.000000000000000,
        -0.023909082966048, -0.008989403146859, 0.000000000000000,  0.000000000000000,  -0.135797170654530, -0.034531606977224, 0.000000000000000,
        0.000000000000000,  -0.033275354602793, 0.055454495999948,  0.000000000000000,  0.000000000000000,  0.046655247991084,  -0.029706174225215,
        0.000000000000000,  0.000000000000000,  -0.011160516471864, -0.066123025960839, 0.000000000000000,  -0.000000000000000, 0.057332616734403,
        0.125067166666129,  0.000000000000000,  0.000000000000000,  -0.099022146834863, 0.042280642516659,  -0.000000000000000, 0.000000000000000,
        0.013468114413783,  0.010048552167805,  0.000000000000000,  0.000000000000000,  0.056488505078308,  0.032076650773268,  -0.001945335453191,
        -0.000878016375417, 0.007977873189073,  0.003148174827857,  -0.050284957832014, -0.029753416387810, 0.056026583700142,  0.024699871626191,
        -0.040369578167873, -0.014703159840634, 0.021680711910842,  0.015096915608018,  0.023735652932931,  0.022050061356336,  -0.114606050872990,
        -0.039287719154696, 0.034384633687205,  0.021547467695175,  -0.060516760886439, -0.023892756710156, 0.026200036782323,  0.032371543012896,
        0.009315277730856,  0.007305805876045,  -0.019656411643325, -0.007465888748930, 0.104723562105892,  0.040403466205881,  0.030429759531628,
        0.019287015836564,  0.006655727847116,  -0.000059496987040, 0.025023775918753,  0.016714372805323,  -0.011636638129917, -0.005823840074303,
        -0.001231968236743, -0.001098371528569, 0.015731861072408,  0.009429176960238,  -0.007232983740426, -0.005210784993464, 0.121601239520664,
        0.097993865748430,  0.014094068103768,  0.018035462389772,  0.071262276804118,  0.098291459402687,  0.005161659819890,  0.005648541770225,
        -0.198433527497166, -0.105492140784044, -0.006353834391244, -0.007812631853294, -0.118380311909020, -0.093064140225329, 0.032465209162273,
        0.035760093682038,  0.034019305743492,  0.056697048284397,  0.007151616883181,  0.009324281856794,  0.201420895593008,  0.137006757667606,
        0.003227313215998,  0.002382974431996,  0.001250821428769,  -0.017688624382160, 0.007034794785291,  0.006563978228903,  -0.028398092589046,
        -0.025094861266549, 0.000000000000000,  0.000000000000000,  0.041586555339313,  0.053477861718773,  0.000000000000000,  0.000000000000000,
        0.049461798565168,  0.163469447777943,  0.000000000000000,  0.000000000000000,  0.297881234159634,  0.400191779500556,  0.000000000000000,
        0.000000000000000,  0.571034858681923,  0.477756717017004,  0.000000000000000,  -0.000000000000000, -0.091206070466308, -0.174920539622637,
        0.000000000000000,  0.000000000000000,  0.105464180887670,  0.144722867566501,  -0.000000000000001, 0.000000000000000,  -0.272865190104925,
        -0.140405787463408, 0.000000000000000,  0.000000000000000,  -0.064503428105063, -0.089417401751985, 0.000000000000001,  -0.000000000000000,
        -0.022323480953221, -0.057275575292343, 0.000000000000000,  0.000000000000000,  0.047757178421549,  0.066162232752057,  0.000000000000000,
        0.000000000000000,  0.046029508169549,  0.144860120579112,  0.000000000000000,  0.000000000000000,  0.115809098100226,  0.202882192227732,
        0.000000000000000,  0.000000000000000,  0.316946680714697,  0.277351466066061,  -0.000000000000000, 0.000000000000000,  -0.062815811723054,
        -0.138363674310893, 0.000000000000000,  0.000000000000000,  0.000910353421161,  0.023807506801408,  -0.000000000000000, -0.000000000000000,
        -0.142269688903391, -0.050817654776508, 0.000000000000000,  0.000000000000000,  0.011365428626938,  -0.000280363185107, 0.000000000000000,
        0.000000000000000,  -0.012718756717171, -0.042069058995670, 0.027382226978900,  0.022251187193817,  0.017602621811866,  0.005714333682344,
        0.051564288348326,  0.049862889714601,  0.034941463124185,  0.015054411727733,  -0.004183956922740, 0.011682212143254,  -0.004006402717154,
        0.005923294110106,  -0.005265057551242, -0.002331900011152, -0.010644932298823, -0.002233525054529, -0.038626686721330, -0.038165468133198,
        -0.025607696542728, -0.011503011398974, -0.036974811002585, -0.022034147790611, -0.024468699347171, -0.004105710628080, 0.036161734209020,
        0.034321086082249,  0.028429213697219,  0.011363506888451,  0.033169187449222,  0.021258755197542,  0.021819964028684,  0.004355677979506,
        -0.011211038723090, -0.011988840736985, -0.007648866439131, -0.003833474925741, 0.019061200081894,  0.019755660293403,  0.028770809311883,
        0.020664480781133,  0.032773570104142,  0.035661413570622,  0.074094876768451,  0.064592644548627,  -0.012311568443809, -0.009606373695916,
        0.026311278639401,  0.044771123723892,  -0.010121058210754, -0.010165722537620, -0.012131101607352, 0.001129930192513,  -0.023677103334576,
        -0.025972817631283, -0.056421498674152, -0.050895007746684, -0.030731816700633, -0.030176107572321, -0.022537113580337, -0.002442520274782,
        0.026247889736457,  0.028301906636573,  0.056406744765156,  0.043831531811440,  0.026638661283078,  0.026418343535145,  0.023256162877729,
        0.006933939661096,  -0.006522839377576, -0.007370523322005, -0.018673014370404, -0.017714134979640};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 12, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.056109201035973, -0.104416421147424, 0.000000000000000,  0.000000000000000,  -0.007052880368677,
        -0.093341946393638, 0.000000000000000,  0.000000000000000,  0.408994715467187,  0.422969367720058,  0.000000000000000,  0.000000000000000,
        0.343979150605261,  0.272508523259808,  0.000000000000000,  -0.000000000000000, 0.105514417024165,  -0.079673338095985, 0.000000000000000,
        0.000000000000000,  0.504545158637119,  0.355453959284707,  0.000000000000001,  -0.000000000000000, -0.021666455572916, -0.202578023878515,
        0.000000000000000,  0.000000000000000,  -0.152253264899222, -0.269012049767796, 0.000000000000001,  -0.000000000000000, 0.007921857304034,
        0.006761503858931,  0.000000000000000,  0.000000000000000,  -0.042455086033245, -0.087789026062612, 0.000000000000000,  0.000000000000000,
        -0.033631013903103, -0.110128583753678, 0.000000000000000,  0.000000000000000,  0.190192786078273,  0.222194396706215,  0.000000000000000,
        0.000000000000000,  0.130603861710943,  0.084065330456003,  0.000000000000000,  0.000000000000000,  0.083316562980449,  -0.052641803565509,
        0.000000000000000,  0.000000000000000,  0.297456674862599,  0.217137024213301,  0.000000000000001,  0.000000000000000,  0.014768903829017,
        -0.126297590612636, 0.000000000000000,  0.000000000000000,  -0.074735510433220, -0.177236380589337, 0.000000000000001,  0.000000000000000,
        0.017976665002240,  0.020622488962703,  -0.025977472259398, -0.025199708600114, -0.015878829846611, -0.007012367840964, -0.052457010358831,
        -0.046777369422556, -0.036963299652011, -0.013980236843987, -0.018007817103312, -0.000147081982624, -0.031657728897384, -0.004102145009207,
        -0.066180823822749, -0.045368195573251, -0.062903370165190, -0.017039844798290, -0.026169003561775, -0.035578933659884, -0.018259884530903,
        -0.012400706035876, -0.010655776580075, -0.009765915932325, -0.024563502295504, -0.008743202607132, -0.026915161698164, -0.039127390315844,
        -0.013569158857827, -0.012122319013825, -0.028606386062199, -0.037029192245768, -0.011486132886464, -0.009845905163092, 0.012604087153263,
        0.009064890342407,  0.009358293471343,  0.002546257718443,  -0.016990614714734, -0.018462172291846, -0.034390816959770, -0.031872713477647,
        -0.034495651573815, -0.036659229505253, -0.069565857423671, -0.054094132490834, -0.012562308168701, -0.010176423500910, -0.024343992399780,
        0.021186711566606,  -0.044138303377610, -0.044184461332476, -0.088162750823386, -0.034146511746030, -0.015364426668568, -0.018954836262258,
        -0.059414719863755, -0.064152015359949, -0.005441091024943, -0.006057348341077, -0.044325454706822, -0.019568534094229, -0.015883774481244,
        -0.020059074471229, -0.057226447364999, -0.071313963182481, -0.017836911549195, -0.021318395424808, -0.046404483973274, -0.060593001289816,
        0.008576169866677,  0.008653232256883,  0.013099840119583,  0.006599304222264,  0.000000000000000,  0.000000000000000,  0.067520274120582,
        0.034551210812500,  0.000000000000000,  -0.000000000000000, 0.108351941624654,  0.020797720346358,  0.000000000000000,  0.000000000000000,
        0.062467169540410,  0.029664013228951,  0.000000000000000,  -0.000000000000000, 0.133838919844079,  0.100600318814463,  0.000000000000000,
        0.000000000000000,  -0.003577512298288, -0.097843513305386, 0.000000000000000,  0.000000000000000,  0.086622882448322,  -0.029225991069300,
        0.000000000000000,  0.000000000000000,  0.097087379577201,  -0.049779021293237, 0.000000000000000,  0.000000000000000,  0.097394441134442,
        0.035844977531953,  0.000000000000000,  0.000000000000000,  -0.006301973931712, 0.003491775565766,  0.000000000000000,  0.000000000000000,
        0.051014874746834,  0.030921411210901,  0.000000000000000,  0.000000000000000,  0.074184928177652,  0.016159966029563,  0.000000000000000,
        0.000000000000000,  0.036923028033780,  0.032884295910201,  0.000000000000000,  0.000000000000000,  0.096211990060306,  0.100312021478450,
        0.000000000000000,  0.000000000000000,  -0.016740774707796, -0.099184538941259, 0.000000000000000,  0.000000000000000,  0.046655247991084,
        -0.029706174225215, 0.000000000000000,  0.000000000000000,  0.059873323598832,  -0.057292911640342, 0.000000000000000,  0.000000000000000,
        0.074570131564915,  0.028368836696460,  0.000000000000000,  0.000000000000000,  -0.002875813000259, 0.003336304632653,  0.026279949746357,
        0.017732803501833,  -0.009209480212269, -0.004968660228122, 0.017082474816523,  0.009584278298234,  -0.035592986814882, -0.014469222746498,
        -0.032495083241601, -0.011599197184648, -0.054984464494309, -0.013272970979682, 0.045979747559766,  0.050746594143176,  -0.086189764663302,
        -0.025433960086201, 0.051576950530808,  0.032321201542763,  -0.090775141329659, -0.035839135065235, 0.023735652932931,  0.022050061356336,
        -0.114606050872990, -0.039287719154696, 0.037857664159515,  0.013894469059733,  -0.052927934506533, -0.025598827231280, 0.063744404603548,
        0.039537689535706,  -0.013422837822497, -0.010169055734300, 0.008092350003026,  0.005861648554244,  0.003899284817776,  0.001036598681730,
        0.007096272476813,  0.006643115467335,  -0.024065965546445, -0.023170844923795, 0.002926546009990,  0.002084680134384,  -0.071864474937185,
        -0.050279348743690, 0.011122528878920,  0.014100072159633,  -0.070886208584636, 0.010543702628087,  0.036766592345515,  0.040467211823892,
        -0.131341967170813, -0.031213069035640, -0.009530751586866, -0.011718947779941, -0.177570467863530, -0.139596210337993, 0.005161659819890,
        0.005648541770225,  -0.198433527497166, -0.105492140784044, -0.013317150539384, -0.017101068634869, -0.124539753708439, -0.123034231040854,
        0.007536278401946,  0.005511585965846,  -0.047871528899535, -0.065129269753611, 0.001532805792799,  0.001485625064173,  0.005467154045899,
        -0.000014113381351, 0.000000000000000,  -0.000000000000000, -0.027719471933182, -0.034128443682612, 0.000000000000000,  0.000000000000000,
        0.032126932110667,  0.087829592600264,  0.000000000000000,  0.000000000000000,  -0.015411831636015, 0.053673893191894,  0.000000000000000,
        0.000000000000000,  0.085326592678368,  -0.020381738930349, 0.000000000000000,  0.000000000000000,  0.236064584988568,  0.114296641831983,
        0.000000000000000,  0.000000000000000,  -0.057792990256204, -0.085996830305580, 0.000000000000000,  0.000000000000000,  -0.055556740653776,
        -0.011388794109751, 0.000000000000000,  0.000000000000000,  -0.085745436294697, -0.138034677826463, 0.000000000000000,  0.000000000000000,
        -0.053973260360700, -0.079805618386698, 0.000000000000000,  -0.000000000000000, -0.023647888001694, -0.033097571676218, 0.000000000000000,
        0.000000000000000,  0.035309587279893,  0.086844253245226,  0.000000000000000,  0.000000000000000,  -0.004755472454641, 0.056891237359226,
        0.000000000000000,  0.000000000000000,  0.049892281034056,  -0.022521850983314, 0.000000000000000,  0.000000000000000,  0.175358849644204,
        0.102866244894461,  0.000000000000000,  0.000000000000000,  -0.054399910028117, -0.082136846728862, 0.000000000000000,  0.000000000000000,
        -0.037191843989023, -0.009656102239242, 0.000000000000000,  0.000000000000000,  -0.077709824178631, -0.135489040754616, 0.000000000000000,
        0.000000000000000,  -0.048483305039960, -0.077688400165636, -0.000653818622047, -0.001452529810442, -0.012505430011188, -0.004668618744989,
        0.074828099184821,  0.064544781690888,  -0.014562210750731, -0.004207588199776, 0.042846716072871,  0.045143220573732,  -0.026979174851092,
        -0.005626121669939, -0.048533653620306, -0.040274369180456, -0.024563502295504, -0.008743202607132, 0.014949219791467,  0.003103841367977,
        0.008817374414190,  -0.001077233564283, -0.005265057551242, -0.002331900011152, -0.057333698254204, -0.019101562002934, 0.066952560806318,
        0.054273924781774,  -0.035512247309614, -0.012812418426965, -0.035068016068038, -0.034627757934162, -0.025934456706302, -0.011048293015105,
        -0.035332256138873, -0.030690358142319, -0.007496260523213, -0.003036848305615, -0.005383106692943, -0.005746301824924, -0.023202085125532,
        -0.018425001526577, 0.031674812264830,  0.033656892617606,  -0.021664345761497, -0.004944044995934, 0.026364838729533,  0.029356582875135,
        -0.030571409472598, 0.009604233125327,  -0.013840741519172, -0.014750330810418, -0.044325454706822, -0.019568534094229, 0.009975211999210,
        0.008421577642830,  -0.003591865427524, -0.015908409135918, -0.010121058210754, -0.010165722537620, -0.096514795880412, -0.054696010931369,
        0.013439746297327,  0.014064365009343,  -0.063844032697579, -0.047201327478934, -0.031379798170350, -0.033719413300250, -0.054102410625086,
        -0.054134051161469, -0.020078571491445, -0.021223692240502, -0.014906389469612, -0.015818459428934};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 12, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.067520274120582,  0.034551210812500,  -0.000000000000000, 0.000000000000000,  0.108351941624654,
        0.020797720346358,  0.000000000000000,  0.000000000000000,  0.062467169540410,  0.029664013228951,  -0.000000000000000, 0.000000000000000,
        0.133838919844079,  0.100600318814464,  0.000000000000000,  0.000000000000000,  -0.003577512298288, -0.097843513305386, 0.000000000000000,
        0.000000000000000,  0.086622882448322,  -0.029225991069300, 0.000000000000000,  0.000000000000000,  0.097087379577201,  -0.049779021293237,
        0.000000000000000,  0.000000000000000,  0.097394441134442,  0.035844977531953,  0.000000000000000,  0.000000000000000,  -0.006301973931712,
        0.003491775565766,  0.000000000000000,  0.000000000000000,  0.051014874746835,  0.030921411210901,  0.000000000000000,  0.000000000000000,
        0.074184928177652,  0.016159966029563,  0.000000000000000,  0.000000000000000,  0.036923028033780,  0.032884295910201,  -0.000000000000000,
        0.000000000000000,  0.096211990060306,  0.100312021478450,  0.000000000000000,  0.000000000000000,  -0.016740774707796, -0.099184538941259,
        0.000000000000000,  0.000000000000000,  0.046655247991084,  -0.029706174225215, 0.000000000000000,  0.000000000000000,  0.059873323598832,
        -0.057292911640342, 0.000000000000000,  0.000000000000000,  0.074570131564914,  0.028368836696460,  0.000000000000000,  0.000000000000000,
        -0.002875813000259, 0.003336304632653,  -0.013472475664942, -0.014285490735522, 0.023456758961513,  0.006833222260598,  -0.036330578559426,
        -0.033436866736619, 0.008298764657589,  0.001388289663991,  -0.004731487930280, 0.010762783362884,  -0.077798977958080, -0.021515554568946,
        -0.040904207646706, -0.019233438861685, -0.014793566021999, 0.000360547265056,  -0.128093596037582, -0.112393098686524, 0.056867700231873,
        0.017502281347601,  -0.103629758445141, -0.080535458268479, -0.009944537833321, -0.001474891316918, -0.092957864336766, -0.091469921637758,
        0.054568684813945,  0.013238287209897,  -0.041915114399110, -0.045564981141663, 0.073402030924920,  0.021199627161956,  0.000314701552989,
        -0.000402800318282, 0.010290505525690,  0.003345662646915,  -0.001719070563616, -0.002480076332648, 0.034973888754381,  0.015888305763481,
        -0.008918124685547, -0.010173629277676, 0.007463990092319,  0.002202191159676,  0.017279275647770,  0.020471824385103,  -0.112120387508006,
        -0.016735700871584, 0.017499544814961,  0.020527321880359,  -0.002302895884072, 0.054155646548478,  -0.049373792253550, -0.052953384174489,
        0.089274203418645,  0.036940916135935,  -0.023082397773233, -0.023581852719256, -0.009271853638932, 0.019652042090113,  -0.042326292667903,
        -0.047123265885467, 0.069745995218733,  0.005499899566420,  -0.015894365033219, -0.018737300671426, 0.109052798179110,  0.038687567371925,
        -0.000191935236850, -0.000299347244519, 0.017018429887364,  0.007627894361812,  0.000000000000000,  0.000000000000000,  -0.086196753129514,
        -0.049714406642715, 0.000000000000000,  0.000000000000000,  0.075103042150092,  0.047306950127438,  0.000000000000000,  0.000000000000000,
        0.576027596994225,  0.458896218647285,  0.000000000000000,  0.000000000000000,  0.299005452547327,  0.462953475542727,  0.000000000000001,
        -0.000000000000001, -0.242793815760132, 0.026259113537720,  0.000000000000000,  0.000000000000000,  0.199336968364885,  0.308635650361818,
        0.000000000000000,  -0.000000000000000, -0.240011498747594, -0.191206757769702, 0.000000000000000,  0.000000000000000,  -0.383859993211580,
        -0.241791078429127, 0.000000000000000,  -0.000000000000000, -0.085478446853434, -0.049300119920692, 0.000000000000000,  0.000000000000000,
        -0.052455269268475, -0.032003305158101, 0.000000000000000,  0.000000000000000,  0.042616352092208,  0.027840103574332,  0.000000000000000,
        0.000000000000000,  0.294607120234062,  0.258031574269224,  0.000000000000000,  0.000000000000000,  0.120809426825642,  0.285012630577839,
        0.000000000000001,  0.000000000000000,  -0.127469377653165, 0.069343728950326,  0.000000000000000,  0.000000000000000,  0.080539617883761,
        0.190008420385226,  0.000000000000000,  0.000000000000000,  -0.122752966764192, -0.107513155945510, 0.000000000000000,  0.000000000000000,
        -0.217816910693505, -0.142293862713254, -0.000000000000000, -0.000000000000000, -0.052018142024571, -0.031736610948451, 0.004758633041585,
        0.003459262945929,  0.011189231711310,  0.003737986520492,  -0.006298263903058, -0.003681415822122, -0.013044126374255, -0.003920931204150,
        -0.056313778132239, -0.018040650847181, -0.128814251550335, -0.032899805001476, -0.002844402126475, 0.041543881624560,  -0.082098596119403,
        -0.010136552046870, 0.078777550390293,  0.074903036789755,  0.073161225673835,  0.029438834470205,  -0.001896268084316, 0.027695921083040,
        -0.054732397412935, -0.006757701364580, 0.023464074221766,  0.007516937852992,  0.053672604812640,  0.013708252083948,  0.032191126615632,
        0.018816125313066,  0.066669979246194,  0.020040315043436,  0.004718977766239,  0.003430435754713,  0.011095988113716,  0.003706836632821,
        0.000107230855929,  0.000106349203679,  0.019066615940309,  0.006987869500106,  -0.000818833752543, -0.000635410792996, -0.020217529392207,
        -0.005574503789630, -0.002865845715585, 0.001952506942716,  -0.173242151552754, -0.012201369547039, 0.028009092921720,  0.037477271299498,
        -0.061784598720857, 0.083886653418146,  0.043981982064696,  0.048103233418169,  0.146340318449938,  0.105472981994656,  0.018672728614480,
        0.024984847532998,  -0.041189732480571, 0.055924435612097,  0.001194102381494,  -0.000813544559465, 0.072184229813647,  0.005083903977933,
        0.004185150290777,  0.003247655164201,  0.103334039115723,  0.028491908258109,  0.000106337265463,  0.000105462960315,  0.018907727474140,
        0.006929637254271,  0.000000000000000,  0.000000000000000,  -0.034348249172716, -0.010300493143410, 0.000000000000000,  0.000000000000000,
        -0.193637174131322, -0.044170155815567, 0.000000000000000,  0.000000000000000,  -0.053059348680012, 0.048559867112511,  0.000000000000000,
        0.000000000000000,  0.086622882448322,  -0.029225991069300, 0.000000000000000,  0.000000000000000,  -0.002385008198858, -0.065229008870258,
        0.000000000000000,  0.000000000000000,  0.061653184470477,  0.124955311372214,  0.000000000000000,  0.000000000000000,  -0.162564988378552,
        0.035895245708214,  0.000000000000000,  0.000000000000000,  0.012911231402748,  0.012541918548442,  0.000000000000000,  0.000000000000000,
        0.075827354888991,  0.035942607034397,  0.000000000000000,  0.000000000000000,  -0.023909082966048, -0.008989403146859, 0.000000000000000,
        0.000000000000000,  -0.135797170654531, -0.034531606977224, 0.000000000000000,  0.000000000000000,  -0.033275354602793, 0.055454495999948,
        0.000000000000000,  0.000000000000000,  0.046655247991084,  -0.029706174225215, 0.000000000000000,  0.000000000000000,  -0.011160516471864,
        -0.066123025960840, -0.000000000000000, 0.000000000000000,  0.057332616734403,  0.125067166666129,  0.000000000000000,  0.000000000000000,
        -0.099022146834863, 0.042280642516659,  -0.000000000000000, -0.000000000000000, 0.013468114413783,  0.010048552167805,  0.000000000000000,
        0.000000000000000,  0.056488505078308,  0.032076650773268,  0.005832312996846,  0.005386432497109,  0.001586652481160,  0.000839110862672,
        0.068706992590537,  0.066087761630552,  -0.041754104447579, -0.010627004695460, 0.069868226744723,  0.074087057039274,  -0.068906326842370,
        -0.017630989819940, -0.103629758445141, -0.080535458268479, -0.009944537833321, -0.001474891316918, -0.085395730691722, -0.074928732457682,
        0.037911800154582,  0.011668187565068,  0.045453924390911,  0.047879443028715,  -0.006506451160898, 0.001589623362487,  0.113282215317940,
        0.099608535755137,  -0.004517696479463, 0.000936036549055,  -0.009761966019594, -0.013085109418471, 0.039682958414285,  0.011872806943266,
        -0.014728649492547, -0.015303921432033, 0.021029601043865,  0.005978042414418,  0.000492772792906,  0.000686600780123,  0.004180585230942,
        0.001787169217075,  0.019154207762268,  0.022097898064915,  -0.055124264476421, -0.018922887733640, 0.038539974391846,  0.043335066814434,
        -0.092461668921028, -0.010023819198948, -0.023082397773233, -0.023581852719256, -0.009271853638932, 0.019652042090113,  -0.032915861502367,
        -0.035302256116326, 0.059516135612430,  0.024627277423957,  0.036734876292655,  0.040178865813072,  0.005423648815038,  0.037778944806717,
        0.036631569058730,  0.039833730748165,  0.003981944748166,  0.006386555028005,  -0.005685447312573, -0.006841036862466, 0.060943119347485,
        0.021802165134309,  -0.001780548255138, -0.002559213571080, 0.030641761711779,  0.013964289420727};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 12, 36));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeDSForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix efxmat(20, 4);

    CDenseMatrix efymat(20, 4);

    CDenseMatrix efzmat(20, 4);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.069434309188802,  0.100406177719547,  0.000000000000000,  0.000000000000000,  0.062870161418931,
        0.087480156302481,  -0.066856052112916, -0.072473973373670, -0.025557393273805, -0.047446772077059, -0.209598337903359, -0.202705213604674,
        -0.016219686483601, -0.065534558943466, 0.000000000000000,  0.000000000000000,  0.041919549704205,  0.011347318955916,  0.000000000000000,
        0.000000000000000,  0.045978782378192,  0.013948135931742,  0.218594673455293,  0.190421091285356,  0.058461788991855,  0.093562986070773,
        0.168810112109284,  0.152320371200589,  0.031489811306403,  0.073621526700058,  0.000000000000000,  0.000000000000000,  0.013978528401800,
        -0.027628129769039, 0.000000000000000,  0.000000000000000,  0.020446577595064,  -0.020127513255867, 0.237987936539176,  0.212793778429521,
        0.066603335968289,  0.109111760277401,  0.244588749497303,  0.225924076306674,  0.036819509705402,  0.096710631932788,  0.000000000000000,
        0.000000000000000,  0.127296233512804,  0.184077992485835,  0.000000000000000,  0.000000000000000,  0.115261962601374,  0.160380286554548,
        -0.122569428873678, -0.132868951185061, -0.046855221001976, -0.086985748807942, -0.384263619489492, -0.371626224941902, -0.029736091886602,
        -0.120146691396355, 0.000000000000000,  0.000000000000000,  0.029775777454515,  0.062467295860700,  0.000000000000000,  0.000000000000000,
        0.023800587281818,  0.052825383986119,  -0.130683754587968, -0.123330351543344, -0.040068663906601, -0.068489327412586, -0.206233178524079,
        -0.195141803785166, -0.023218201503711, -0.072692125571425};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 20, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.058992433308961,  0.070376033314824,  0.000000000000000,  0.000000000000000,  0.055846405302982,
        0.062546812059758,  0.021670108729357,  0.009387378746449,  0.000677431451359,  -0.003278761363260, -0.088577645841851, -0.088979120827180,
        -0.001270757259855, -0.021380152416839, 0.000000000000000,  0.000000000000000,  0.162229191599642,  0.193534091615766,  0.000000000000000,
        0.000000000000000,  0.153577614583200,  0.172003733164333,  0.059592799005732,  0.025815291552735,  0.001862936491237,  -0.009016593748964,
        -0.243588526065089, -0.244692582274744, -0.003494582464600, -0.058795419146307, 0.000000000000000,  0.000000000000000,  0.020967792602700,
        -0.041442194653558, 0.000000000000000,  0.000000000000000,  0.030669866392596,  -0.030191269883801, 0.356981904808764,  0.319190667644281,
        0.099905003952433,  0.163667640416101,  0.366883124245954,  0.338886114460011,  0.055229264558104,  0.145065947899182,  0.000000000000000,
        0.000000000000000,  0.041919549704205,  0.011347318955916,  0.000000000000000,  0.000000000000000,  0.045978782378192,  0.013948135931742,
        0.218594673455293,  0.190421091285356,  0.058461788991855,  0.093562986070773,  0.168810112109284,  0.152320371200589,  0.031489811306403,
        0.073621526700058,  0.000000000000000,  0.000000000000000,  -0.063718006956411, -0.098858816043740, 0.000000000000000,  0.000000000000000,
        -0.056600327458269, -0.085578137766334, 0.096664416675001,  0.098440485821673,  0.033529455409058,  0.060205361086710,  0.232617898645535,
        0.223476173313845,  0.020513751661747,  0.075573858038929};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 20, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.041919549704205,  0.011347318955916,  0.000000000000000,  0.000000000000000,  0.045978782378192,
        0.013948135931742,  0.218594673455293,  0.190421091285356,  0.058461788991855,  0.093562986070773,  0.168810112109284,  0.152320371200589,
        0.031489811306403,  0.073621526700058,  0.000000000000000,  0.000000000000000,  0.169469598255656,  0.127485007046165,  0.000000000000000,
        0.000000000000000,  0.172592255730526,  0.120765480685047,  0.454790327723578,  0.381939994466384,  0.113953694093121,  0.175828535591832,
        0.193243975084704,  0.160786581305823,  0.058926454133950,  0.110153175227127,  0.000000000000000,  0.000000000000000,  0.210519970549217,
        0.229752323368335,  0.000000000000000,  0.000000000000000,  0.202775939025989,  0.206330223321528,  0.189758960093159,  0.135167779854302,
        0.034497691313995,  0.041356373904781,  -0.187870178674984, -0.198268707812488, 0.013387927654761,  -0.027156752561479, 0.000000000000000,
        0.000000000000000,  0.112979732170437,  0.084990004697443,  0.000000000000000,  0.000000000000000,  0.115061503820350,  0.080510320456698,
        0.303193551815719,  0.254626662977589,  0.075969129395414,  0.117219023727888,  0.128829316723136,  0.107191054203882,  0.039284302755967,
        0.073435450151418,  0.000000000000000,  0.000000000000000,  -0.017466479043419, -0.004728049564965, 0.000000000000000,  0.000000000000000,
        -0.019157825990913, -0.005811723304893, -0.091081113939705, -0.079342121368898, -0.024359078746606, -0.038984577529489, -0.070337546712202,
        -0.063466821333579, -0.013120754711001, -0.030675636125024};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 20, 4));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeDPForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix efxmat(20, 12);

    CDenseMatrix efymat(20, 12);

    CDenseMatrix efzmat(20, 12);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.920021819481803,  0.731835644921182,  -0.004235511098966, 0.097526365503405,  0.000000000000000,  0.000000000000000,  -0.147230610590158,
        -0.164210750210443, 0.000000000000000,  0.000000000000000,  -0.004726152177105, -0.036646294123979, 0.547386535115186,  0.510646118913834,
        0.007961671496746,  0.091880291944522,  0.000000000000000,  0.000000000000000,  -0.111243834089349, -0.130403817257430, 0.000000000000000,
        0.000000000000000,  0.013078462197076,  -0.019065951636535, -0.000136307295682, 0.006099753276956,  0.097596004265236,  0.101878779291985,
        -0.061740802163683, -0.066693839061115, 0.017723350603900,  0.030406355344472,  0.059306371121666,  0.014624659325420,  -0.017649139909490,
        0.000659988062085,  0.046110471736725,  0.056965782405635,  0.059233875845743,  0.143915330193647,  -0.076473013579689, -0.080728581575829,
        0.017951584982866,  0.067592289621590,  0.219480341236371,  0.123685623580112,  0.000777501740736,  0.033358718187760,  0.000000000000000,
        0.000000000000000,  -0.001347330359128, 0.011433904509982,  0.000000000000000,  0.000000000000000,  -0.060095680551155, -0.006269369592344,
        0.000000000000000,  0.000000000000000,  0.036388916455892,  0.025243003387072,  0.000000000000000,  0.000000000000000,  0.007001997744882,
        0.015142323274662,  0.000000000000000,  0.000000000000000,  -0.050359046741257, -0.005712095571410, 0.000000000000000,  0.000000000000000,
        0.045559555477507,  0.031753896143374,  0.010019051618405,  -0.002280007173577, -0.118721026349637, -0.116147774867671, 0.124108523887489,
        0.096543185279206,  -0.120690313694714, -0.131843073680129, 0.409405132258013,  0.274843616548334,  0.017723350603900,  0.030406355344472,
        -0.033680426897209, -0.037285289828634, -0.067211930387710, -0.105442066764073, 0.021737071235693,  0.017990841562467,  -0.076517645311077,
        -0.125701089935214, 0.798040762733599,  0.541273662929573,  0.017951584982866,  0.067592289621590,  0.000000000000000,  0.000000000000000,
        -0.027935617015365, 0.018387580651963,  0.000000000000000,  0.000000000000000,  0.026284560408550,  0.070333878978906,  -0.531174845138148,
        -0.422525506597808, 0.002626346346680,  -0.064964583217136, 0.000000000000000,  0.000000000000000,  -0.032945678554122, 0.008658849459014,
        0.000000000000000,  0.000000000000000,  0.024591094467302,  0.060891972486756,  -0.316033763399529, -0.294821674215539, 0.009876948142058,
        -0.050485543516674, 0.128269838917847,  0.112357923386821,  -0.022181678643362, -0.038192003327139, 0.092952718694931,  0.070528255455369,
        -0.171073198463051, -0.179081590063366, 0.338102579801716,  0.220299262959457,  -0.042570056433255, -0.033193483418297, 0.066708855044915,
        0.066960301237165,  -0.022398451434672, -0.049068402861976, 0.010022362154094,  0.006633359459869,  -0.103875712544075, -0.180885662552780,
        0.626104100324311,  0.405580979713124,  -0.019027277046068, -0.020032735493002, 0.000000000000000,  0.000000000000000,  -0.147230610590158,
        -0.164210750210443, 0.920021819481803,  0.731835644921182,  -0.193850691404473, -0.113957176434286, 0.000000000000000,  0.000000000000000,
        -0.008664612324693, -0.067184872560628, 0.000000000000000,  0.000000000000000,  -0.111243834089349, -0.130403817257430, 0.547386535115186,
        0.510646118913834,  -0.135306902709234, -0.076064018159743, 0.000000000000000,  0.000000000000000,  0.023977180694639,  -0.034954244666980,
        -0.061740802163683, -0.066693839061115, 0.017723350603900,  0.030406355344472,  -0.079650976748910, -0.079793827332056, 0.120421531558137,
        0.141038479356836,  0.108728347056388,  0.026811875429937,  -0.032356756500732, 0.001209978113822,  -0.076473013579689, -0.080728581575829,
        0.017951584982866,  0.067592289621590,  -0.052377500297723, -0.047002845381418, 0.082353341353980,  0.230966006221452,  0.402380625600014,
        0.226756976563538,  0.001425419858015,  0.061157650010893,  0.000000000000000,  0.000000000000000,  -0.059787116745003, -0.067420974649624,
        0.000000000000000,  0.000000000000000,  -0.064865149998132, -0.102460639734477, 0.920021819481802,  0.731835644921182,  0.042315548306715,
        0.145031887429178,  0.000000000000000,  0.000000000000000,  -0.050645494595187, -0.057322730103678, 0.000000000000000,  0.000000000000000,
        -0.043780205047407, -0.079100855104423, 0.547386535115186,  0.510646118913834,  0.041567809078901,  0.128338695694167,  -0.013958069016598,
        -0.011504332418318, 0.064621379377754,  0.066352571536769,  -0.107693997088241, -0.099299877234726, 0.043182134924452,  0.058678876490746,
        -0.058346660902879, -0.027604252579265, 0.096559027916372,  0.096652499825536,  -0.004718613315250, -0.004509208515069, 0.038499891156097,
        0.074070841319774,  -0.073474065855818, -0.075312948305715, 0.034318675122862,  0.083299858387483,  -0.056664342401697, -0.005391994522243,
        0.056075676081716,  0.121748391716273};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 20, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.018693392902408, -0.039588892895651, 0.000000000000000,  0.000000000000000,  -0.123760348389828,
        -0.114868597888361, 0.920021819481803,  0.731835644921182,  0.051406769824080,  0.154936593866289,  0.000000000000000,  0.000000000000000,
        0.000330622611554,  -0.022353373902492, 0.000000000000000,  0.000000000000000,  -0.097533595299688, -0.092962818992541, 0.547386535115186,
        0.510646118913834,  0.055477850153369,  0.141018992975069,  0.087222509154863,  0.037633324162056,  -0.030809937610967, -0.015455245334180,
        0.010019051618405,  -0.002280007173577, -0.012312562050107, -0.009273690996837, -0.000136307295682, 0.006099753276956,  0.049228520492723,
        0.053299650259788,  0.228917567866871,  0.132704040610250,  -0.008600519993929, 0.017314662814436,  -0.033680426897209, -0.037285289828634,
        -0.005225316524975, 0.015647424896632,  0.046110471736725,  0.056965782405635,  0.031058142271773,  0.088874652166054,  0.000000000000000,
        0.000000000000000,  -0.051406830481623, -0.108869455463040, 0.920021819481803,  0.731835644921182,  -0.243930425197102, -0.119181651094573,
        0.000000000000000,  0.000000000000000,  -0.123760348389828, -0.114868597888361, 0.000000000000000,  0.000000000000000,  0.000909212181775,
        -0.061471778231852, 0.547386535115186,  0.510646118913834,  -0.177272774993615, -0.080824097802585, 0.000000000000000,  0.000000000000000,
        -0.097533595299688, -0.092962818992541, 0.239861900175872,  0.103491641445654,  -0.084727328430159, -0.042501924668996, 0.023772793157330,
        0.000658827067283,  0.019846270145876,  0.031169251290062,  0.010019051618405,  -0.002280007173577, -0.012312562050107, -0.009273690996837,
        0.629523311633896,  0.364936111678186,  -0.023651429983306, 0.047615322739698,  -0.034263274267979, -0.032010477412695, 0.018588636928083,
        0.126215097942108,  -0.033680426897209, -0.037285289828634, -0.005225316524975, 0.015647424896632,  -0.531174845138148, -0.422525506597808,
        -0.020653334499458, -0.049641599340500, 0.000000000000000,  0.000000000000000,  0.039426840612826,  0.105500818468359,  0.000000000000000,
        0.000000000000000,  -0.027935617015365, 0.018387580651963,  -0.316033763399529, -0.294821674215540, -0.017577783986377, -0.043269835634162,
        0.000000000000000,  0.000000000000000,  0.036886641700952,  0.091337958730134,  0.000000000000000,  0.000000000000000,  -0.032945678554122,
        0.008658849459014,  0.444994112233255,  0.313930865781808,  -0.061054788636057, -0.065020152857579, 0.139429078042396,  0.105792383183054,
        -0.256609797694577, -0.268622385095049, 0.128269838917847,  0.112357923386821,  -0.022181678643362, -0.038192003327139, 0.681694812861740,
        0.461381230744095,  -0.037692653241628, -0.060923071211315, 0.015033543231140,  0.009950039189804,  -0.155813568816112, -0.271328493829170,
        0.066708855044915,  0.066960301237165,  -0.022398451434672, -0.049068402861976, 0.000000000000000,  0.000000000000000,  -0.001347330359128,
        0.011433904509982,  0.000000000000000,  0.000000000000000,  -0.060095680551155, -0.006269369592344, 0.000000000000000,  0.000000000000000,
        0.036388916455892,  0.025243003387072,  0.000000000000000,  0.000000000000000,  0.007001997744882,  0.015142323274662,  0.000000000000000,
        0.000000000000000,  -0.050359046741257, -0.005712095571410, 0.000000000000000,  0.000000000000000,  0.045559555477507,  0.031753896143374,
        0.324116341232869,  0.225411629899389,  -0.012312562050107, -0.009273690996837, 0.124108523887489,  0.096543185279206,  -0.120690313694714,
        -0.131843073680129, -0.061740802163683, -0.066693839061115, -0.141889345845394, -0.129904770461778, 0.549328757311649,  0.377382873174968,
        -0.005225316524975, 0.015647424896632,  0.021737071235693,  0.017990841562467,  -0.076517645311077, -0.125701089935214, -0.076473013579689,
        -0.080728581575829, -0.075028335811236, -0.114041947869468, -0.920021819481802, -0.731835644921182, -0.032557404523584, -0.113267226170999,
        0.000000000000000,  0.000000000000000,  0.135707636991783,  0.161783106223814,  0.000000000000000,  0.000000000000000,  0.073754357470306,
        0.070363573421296,  -0.547386535115186, -0.510646118913834, -0.047154927749163, -0.111080643386239, 0.000000000000000,  0.000000000000000,
        0.100726866431294,  0.127691693888015,  0.000000000000000,  0.000000000000000,  0.063393334180708,  0.060610152369634,  -0.002707039212341,
        0.005830092792817,  -0.076367745616182, -0.090487809295496, 0.084771616041070,  0.085675987551340,  -0.028581008707618, -0.043701422896391,
        -0.013958069016598, -0.011504332418318, -0.051460581676278, -0.050237338140504, -0.130168119724654, -0.101437032223741, -0.052816085142886,
        -0.142862300467188, 0.084258725549851,  0.088168775625693,  -0.025688452913965, -0.080828635304583, -0.004718613315250, -0.004509208515069,
        -0.029121869421432, -0.058026785946450};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 20, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.001347330359128, 0.011433904509982,  0.000000000000000,  0.000000000000000,  -0.060095680551155,
        -0.006269369592344, 0.000000000000000,  0.000000000000000,  0.036388916455892,  0.025243003387072,  0.000000000000000,  0.000000000000000,
        0.007001997744882,  0.015142323274662,  0.000000000000000,  0.000000000000000,  -0.050359046741257, -0.005712095571410, 0.000000000000000,
        0.000000000000000,  0.045559555477507,  0.031753896143374,  0.010019051618405,  -0.002280007173577, -0.118721026349637, -0.116147774867671,
        0.295434318222651,  0.220738623682643,  -0.062649333167698, -0.073548118841492, -0.061740802163683, -0.066693839061115, -0.141889345845394,
        -0.129904770461778, -0.033680426897209, -0.037285289828634, -0.067211930387710, -0.105442066764073, 0.339742080804161,  0.244173475928068,
        -0.042706765022312, -0.059652276302102, -0.076473013579689, -0.080728581575829, -0.075028335811236, -0.114041947869468, 0.920021819481803,
        0.731835644921182,  -0.007450731274158, 0.124811819447682,  0.000000000000000,  0.000000000000000,  -0.214648956458607, -0.143261078606958,
        0.000000000000000,  0.000000000000000,  -0.126866417658810, -0.075161643627804, 0.547386535115186,  0.510646118913834,  0.024670984297033,
        0.128015381577238,  0.000000000000000,  0.000000000000000,  -0.148081162974004, -0.099893525965223, 0.000000000000000,  0.000000000000000,
        -0.107378461129204, -0.064678536808066, 0.023772793157330,  0.000658827067283,  -0.185715535887306, -0.175292047096776, 0.566131763438858,
        0.372405411723838,  -0.238544151566167, -0.230848714987843, 0.124108523887489,  0.096543185279206,  -0.062649333167698, -0.073548118841492,
        -0.034263274267979, -0.032010477412695, -0.101158230761291, -0.107707783675164, 0.739820897877866,  0.470338860717922,  -0.133257059007202,
        -0.139899574436031, 0.021737071235693,  0.017990841562467,  -0.042706765022312, -0.059652276302102, 0.000000000000000,  0.000000000000000,
        -0.278611509492701, -0.222642708447173, 1.062349690276296,  0.845051013195616,  -0.172834099761113, -0.073945178154151, 0.000000000000000,
        0.000000000000000,  -0.185741006328467, -0.148428472298115, 0.000000000000000,  0.000000000000000,  -0.234704795827857, -0.189527439719251,
        0.632067526799059,  0.589643348431079,  -0.076742568092893, -0.013956169733040, 0.000000000000000,  0.000000000000000,  -0.156469863885238,
        -0.126351626479501, 0.139429078042396,  0.105792383183054,  0.019847502088669,  0.009044629819944,  0.226941612315607,  0.089661252115595,
        -0.150296185260005, -0.103681440312813, 0.092952718694931,  0.070528255455369,  0.013231668059113,  0.006029753213296,  0.015033543231140,
        0.009950039189804,  0.005232378083003,  0.043271233899374,  0.493372726670372,  0.276997166663992,  -0.058758047951456, 0.060435934881379,
        0.010022362154094,  0.006633359459869,  0.003488252055335,  0.028847489266249,  0.000000000000000,  0.000000000000000,  -0.126866417658809,
        -0.075161643627804, 0.000000000000000,  0.000000000000000,  -0.143099304305738, -0.095507385737972, 0.920021819481803,  0.731835644921182,
        0.098271283441517,  0.187446522470851,  0.000000000000000,  0.000000000000000,  -0.107378461129204, -0.064678536808066, 0.000000000000000,
        0.000000000000000,  -0.098720775316003, -0.066595683976815, 0.547386535115186,  0.510646118913834,  0.114153035238036,  0.181914162250627,
        0.124108523887489,  0.096543185279206,  -0.062649333167698, -0.073548118841492, 0.377421175625906,  0.248270274482559,  -0.159029434377444,
        -0.153899143325229, -0.079650976748910, -0.079793827332056, -0.133507758247558, -0.114001948062200, 0.021737071235693,  0.017990841562467,
        -0.042706765022312, -0.059652276302102, 0.493213931918577,  0.313559240478614,  -0.088838039338135, -0.093266382957354, -0.052377500297723,
        -0.047002845381418, -0.065569259909364, -0.057997553423412, 0.000000000000000,  0.000000000000000,  -0.047911890054267, -0.027670647373702,
        0.000000000000000,  0.000000000000000,  0.025039866896314,  0.002612237330143,  0.000000000000000,  0.000000000000000,  0.057547868032568,
        0.023841862663867,  0.000000000000000,  0.000000000000000,  -0.056076523135562, -0.034466019512789, 0.000000000000000,  0.000000000000000,
        0.020982936142190,  0.002380039821421,  0.000000000000000,  0.000000000000000,  0.060755387997163,  0.029004287162780,  0.084771616041070,
        0.085675987551340,  0.131031687741676,  0.116609702909860,  -0.123097632592771, -0.091974426534434, 0.026103888819874,  0.030645049517288,
        -0.107693997088241, -0.099299877234726, -0.063226329375077, -0.048195207380087, 0.084258725549851,  0.088168775625693,  0.067291467880137,
        0.100805602186475,  -0.141559200335067, -0.101738948303362, 0.017794485425963,  0.024855115125876,  -0.073474065855818, -0.075312948305715,
        -0.027667938739872, -0.037789633273222};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 20, 12));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeDDForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix efxmat(20, 20);

    CDenseMatrix efymat(20, 20);

    CDenseMatrix efzmat(20, 20);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.004953239818823,  -0.034300016209091, 0.000000000000000,  0.000000000000000,  0.016179925902208,
        -0.158242513906405, 0.000000000000000,  0.000000000000000,  0.195823160091747,  0.208129475609348,  0.000000000000000,  0.000000000000000,
        0.019945963682600,  0.062308255371020,  0.000000000000000,  0.000000000000000,  0.064757046936906,  0.163594128216089,  0.000000000000000,
        0.000000000000000,  0.006002734611315,  -0.018463886954508, 0.000000000000000,  0.000000000000000,  -0.007556404220300, -0.135423849573450,
        0.000000000000000,  0.000000000000000,  0.126779616537151,  0.151527173577071,  0.000000000000000,  0.000000000000000,  -0.013823262814380,
        0.031282929898008,  0.000000000000000,  0.000000000000000,  0.059641822791460,  0.141166932721302,  0.004953239818823,  0.006002734611315,
        0.090910370772331,  0.027577474694504,  0.001120609639354,  0.009141972802109,  -0.044957860818552, -0.043645977685922, -0.013664856541293,
        -0.022959774304288, 0.021359310881542,  0.012250685278706,  0.019945963682600,  -0.013823262814380, 0.005860030853299,  -0.012758370747317,
        -0.069182345578098, -0.066055549859427, -0.007248584536389, -0.007053155364719, -0.034300016209091, -0.018463886954508, 0.027577474694504,
        -0.014279028821229, 0.025482562939588,  0.034537695039955,  -0.043645977685922, -0.103183920273163, 0.043738367555542,  0.023159744167377,
        0.012250685278706,  0.008126890679986,  0.062308255371020,  0.031282929898008,  -0.012758370747317, -0.055711453384207, -0.154830999219211,
        -0.136386110498194, -0.007053155364719, -0.010966189145654, 0.000000000000000,  0.000000000000000,  0.001120609639354,  0.025482562939588,
        0.000000000000000,  0.000000000000000,  0.006134451758753,  -0.006188114186561, 0.000000000000000,  0.000000000000000,  0.080295163672104,
        0.012767966046470,  0.000000000000000,  0.000000000000000,  -0.048996322022740, -0.013860643196978, 0.000000000000000,  0.000000000000000,
        -0.014639505587594, -0.002327870094926, 0.000000000000000,  0.000000000000000,  0.009141972802109,  0.034537695039955,  0.000000000000000,
        0.000000000000000,  -0.003572211864070, -0.006021984629874, 0.000000000000000,  0.000000000000000,  0.061779539555610,  0.013004215760258,
        0.000000000000000,  0.000000000000000,  -0.046906772953399, -0.012884541136339, 0.000000000000000,  0.000000000000000,  -0.011263715934582,
        -0.002370943411511, 0.016179925902208,  -0.007556404220300, -0.044957860818552, -0.043645977685922, 0.006134451758753,  -0.003572211864070,
        0.279018049700567,  0.178889127743231,  -0.002745131209461, 0.002423384627472,  0.094806571818964,  0.081648002892440,  0.237071278527037,
        0.142591145638571,  -0.034970491930533, -0.041915762456284, 0.129190504222779,  0.091544160142883,  -0.069087032663493, -0.057051065274513,
        -0.158242513906405, -0.135423849573450, -0.043645977685922, -0.103183920273163, -0.006188114186561, -0.006021984629874, 0.178889127743231,
        0.198311348499033,  -0.052396076785670, -0.037880170672413, 0.081648002892440,  0.106451173686400,  0.103965037750846,  0.064668687304876,
        -0.041915762456284, -0.115540824003233, 0.110539562916934,  0.085763399201844,  -0.057051065274513, -0.085280191400072, 0.000000000000000,
        0.000000000000000,  -0.013664856541293, 0.043738367555542,  0.000000000000000,  0.000000000000000,  -0.002745131209461, -0.052396076785670,
        0.000000000000000,  0.000000000000000,  -0.068548819864470, -0.082135285741580, 0.000000000000000,  0.000000000000000,  0.043605258948053,
        0.161658450290483,  0.000000000000000,  0.000000000000000,  -0.041532200665367, 0.037453434730415,  0.000000000000000,  0.000000000000000,
        -0.022959774304288, 0.023159744167377,  0.000000000000000,  0.000000000000000,  0.002423384627472,  -0.037880170672413, 0.000000000000000,
        0.000000000000000,  -0.049040695567665, -0.059402502984265, 0.000000000000000,  0.000000000000000,  0.043532045720303,  0.144944790090600,
        0.000000000000000,  0.000000000000000,  -0.046886817078406, 0.016569178259927,  0.195823160091747,  0.126779616537151,  0.021359310881542,
        0.012250685278706,  0.080295163672104,  0.061779539555610,  0.094806571818964,  0.081648002892440,  -0.068548819864470, -0.049040695567665,
        0.275370507183507,  0.179329401188665,  0.080068796702761,  0.022029127679566,  -0.024659158154671, -0.028783092259457, 0.065413633651800,
        0.029556715783589,  0.000487776196991,  -0.009074455446308, 0.208129475609348,  0.151527173577071,  0.012250685278706,  0.008126890679986,
        0.012767966046470,  0.013004215760258,  0.081648002892440,  0.106451173686400,  -0.082135285741580, -0.059402502984265, 0.179329401188665,
        0.212030211923917,  -0.148417212077255, -0.143076692208620, -0.028783092259457, -0.084124285931292, 0.121376823226352,  0.082102100180791,
        -0.009074455446308, -0.019941997356779, 0.000000000000000,  0.000000000000000,  0.019945963682600,  0.062308255371020,  0.000000000000000,
        0.000000000000000,  0.237071278527037,  0.103965037750846,  0.000000000000000,  0.000000000000000,  0.080068796702761,  -0.148417212077255,
        0.000000000000000,  0.000000000000000,  0.030641223349444,  0.045945464192980,  0.000000000000000,  0.000000000000000,  -0.042325021971956,
        -0.006066098359494, 0.000000000000000,  0.000000000000000,  -0.013823262814380, 0.031282929898008,  0.000000000000000,  0.000000000000000,
        0.142591145638571,  0.064668687304876,  0.000000000000000,  0.000000000000000,  0.022029127679566,  -0.143076692208620, 0.000000000000000,
        0.000000000000000,  -0.011799952346599, 0.021824734883835,  0.000000000000000,  0.000000000000000,  -0.012131252601562, 0.015812876728159,
        0.019945963682600,  -0.013823262814380, 0.005860030853299,  -0.012758370747317, -0.048996322022740, -0.046906772953399, -0.034970491930533,
        -0.041915762456284, 0.043605258948053,  0.043532045720303,  -0.024659158154671, -0.028783092259457, 0.030641223349444,  -0.011799952346599,
        0.098457380204610,  0.011146239641142,  -0.087194876463423, -0.071666244656248, -0.050134350375101, -0.042515761045691, 0.062308255371020,
        0.031282929898008,  -0.012758370747317, -0.055711453384207, -0.013860643196978, -0.012884541136339, -0.041915762456284, -0.115540824003233,
        0.161658450290483,  0.144944790090600,  -0.028783092259457, -0.084124285931292, 0.045945464192980,  0.021824734883835,  0.011146239641142,
        -0.086028627876648, -0.236819272293761, -0.190871310640812, -0.042515761045691, -0.077275973851418, 0.000000000000000,  0.000000000000000,
        -0.069182345578098, -0.154830999219211, 0.000000000000000,  0.000000000000000,  0.129190504222779,  0.110539562916934,  0.000000000000000,
        0.000000000000000,  0.065413633651800,  0.121376823226352,  0.000000000000000,  0.000000000000000,  -0.087194876463423, -0.236819272293761,
        0.000000000000000,  0.000000000000000,  -0.037404312128101, -0.089421323200312, 0.000000000000000,  0.000000000000000,  -0.066055549859427,
        -0.136386110498194, 0.000000000000000,  0.000000000000000,  0.091544160142883,  0.085763399201844,  0.000000000000000,  0.000000000000000,
        0.029556715783589,  0.082102100180791,  0.000000000000000,  0.000000000000000,  -0.071666244656248, -0.190871310640812, 0.000000000000000,
        0.000000000000000,  -0.011208688472162, -0.053422357458652, 0.064757046936906,  0.059641822791460,  -0.007248584536389, -0.007053155364719,
        -0.014639505587594, -0.011263715934582, -0.069087032663493, -0.057051065274513, -0.041532200665367, -0.046886817078406, 0.000487776196991,
        -0.009074455446308, -0.042325021971956, -0.012131252601562, -0.050134350375101, -0.042515761045691, -0.037404312128101, -0.011208688472162,
        0.115337442109112,  0.055622865437456,  0.163594128216089,  0.141166932721302,  -0.007053155364719, -0.010966189145654, -0.002327870094926,
        -0.002370943411511, -0.057051065274513, -0.085280191400072, 0.037453434730415,  0.016569178259927,  -0.009074455446308, -0.019941997356779,
        -0.006066098359494, 0.015812876728159,  -0.042515761045691, -0.077275973851418, -0.089421323200312, -0.053422357458652, 0.055622865437456,
        0.046074164574895};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 20, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.013308855316504, -0.086303775745475, 0.000000000000000,  0.000000000000000,  0.049224974857788,
        0.066963995560873,  0.000000000000000,  0.000000000000000,  0.180652727042726,  0.152119261057422,  0.000000000000000,  0.000000000000000,
        -0.103678415606436, -0.252298708082955, 0.000000000000000,  0.000000000000000,  -0.068531330571928, -0.134132665900682, 0.000000000000000,
        0.000000000000000,  0.003077214120299,  -0.049379646112449, 0.000000000000000,  0.000000000000000,  0.008704169054784,  0.036024816721030,
        0.000000000000000,  0.000000000000000,  0.126798997107724,  0.115568896900552,  0.000000000000000,  0.000000000000000,  -0.093229634284854,
        -0.208869135084580, 0.000000000000000,  0.000000000000000,  -0.052586916582972, -0.110435181622516, -0.013308855316504, 0.003077214120299,
        0.157559965262158,  0.064325237376109,  0.049224974857788,  0.008704169054784,  0.028241858292918,  0.007092787857795,  0.015830323565680,
        0.008986022932178,  0.024817820888236,  0.021429876569480,  0.001120609639354,  0.009141972802109,  0.003288904967851,  -0.004374739375958,
        0.020761597771408,  0.031211331850953,  0.010144912223213,  0.012187967076155,  -0.086303775745475, -0.049379646112449, 0.064325237376109,
        0.023425954830061,  0.066963995560873,  0.036024816721030,  0.007092787857795,  -0.032394123984181, 0.022778509375448,  0.014571099587219,
        0.021429876569480,  0.024925561332890,  0.025482562939588,  0.034537695039955,  -0.004374739375958, -0.041832648023114, 0.078150752389518,
        0.074600180523814,  0.012187967076155,  0.028021510192908,  0.000000000000000,  0.000000000000000,  0.049224974857788,  0.066963995560873,
        0.000000000000000,  0.000000000000000,  0.104159834685036,  0.073496668206607,  0.000000000000000,  0.000000000000000,  0.146981433096181,
        -0.137777240371863, 0.000000000000000,  0.000000000000000,  0.196846185458605,  0.072362339778655,  0.000000000000000,  0.000000000000000,
        0.013503797580127,  -0.047797339528795, 0.000000000000000,  0.000000000000000,  0.008704169054784,  0.036024816721030,  0.000000000000000,
        0.000000000000000,  0.023848526637396,  0.036588666517281,  0.000000000000000,  0.000000000000000,  0.073512077309241,  -0.132239845741738,
        0.000000000000000,  0.000000000000000,  0.122759733863910,  0.045680167664270,  0.000000000000000,  0.000000000000000,  0.014264208334727,
        -0.043857771152758, 0.049224974857788,  0.008704169054784,  0.028241858292918,  0.007092787857795,  0.104159834685036,  0.023848526637396,
        0.224955308915711,  0.081251208400392,  0.041317649606836,  0.045551532909863,  0.054346318361133,  0.039256910150909,  0.006134451758753,
        -0.003572211864070, 0.028199164452176,  0.015077390988263,  0.058373652071595,  0.073799200389413,  0.035925229897510,  0.044876420582992,
        0.066963995560873,  0.036024816721030,  0.007092787857795,  -0.032394123984181, 0.073496668206607,  0.036588666517281,  0.081251208400392,
        -0.053878204677643, 0.117995052969092,  0.113377981196922,  0.039256910150909,  0.004585025474042,  -0.006188114186561, -0.006021984629874,
        0.015077390988263,  -0.026917391243936, 0.182955834405473,  0.162826416216213,  0.044876420582992,  0.113986631088246,  0.000000000000000,
        0.000000000000000,  0.015830323565680,  0.022778509375448,  0.000000000000000,  0.000000000000000,  0.041317649606836,  0.117995052969092,
        0.000000000000000,  0.000000000000000,  -0.102823229796706, -0.123202928612370, 0.000000000000000,  0.000000000000000,  -0.002745131209461,
        -0.052396076785670, 0.000000000000000,  0.000000000000000,  0.024887959108237,  -0.046609548603253, 0.000000000000000,  0.000000000000000,
        0.008986022932178,  0.014571099587219,  0.000000000000000,  0.000000000000000,  0.045551532909863,  0.113377981196922,  0.000000000000000,
        0.000000000000000,  -0.073561043351498, -0.089103754476397, 0.000000000000000,  0.000000000000000,  0.002423384627472,  -0.037880170672413,
        0.000000000000000,  0.000000000000000,  0.033891416915055,  -0.023550672603342, 0.180652727042726,  0.126798997107724,  0.024817820888236,
        0.021429876569480,  0.146981433096181,  0.073512077309241,  0.054346318361133,  0.039256910150909,  -0.102823229796706, -0.073561043351498,
        0.413055760775261,  0.268994101782997,  0.080295163672104,  0.061779539555610,  0.094806571818964,  0.081648002892440,  -0.173276380950044,
        -0.107753952799820, -0.016599084746298, -0.006282446406052, 0.152119261057422,  0.115568896900552,  0.021429876569480,  0.024925561332890,
        -0.137777240371863, -0.132239845741738, 0.039256910150909,  0.004585025474042,  -0.123202928612370, -0.089103754476397, 0.268994101782997,
        0.318045317885876,  0.012767966046470,  0.013004215760258,  0.081648002892440,  0.106451173686400,  -0.202114650816313, -0.144979322044944,
        -0.006282446406052, 0.000651544715819,  0.000000000000000,  0.000000000000000,  0.001120609639354,  0.025482562939588,  0.000000000000000,
        0.000000000000000,  0.006134451758753,  -0.006188114186561, 0.000000000000000,  0.000000000000000,  0.080295163672104,  0.012767966046470,
        0.000000000000000,  0.000000000000000,  -0.048996322022740, -0.013860643196978, 0.000000000000000,  0.000000000000000,  -0.014639505587594,
        -0.002327870094926, 0.000000000000000,  0.000000000000000,  0.009141972802109,  0.034537695039955,  0.000000000000000,  0.000000000000000,
        -0.003572211864070, -0.006021984629874, 0.000000000000000,  0.000000000000000,  0.061779539555610,  0.013004215760258,  0.000000000000000,
        0.000000000000000,  -0.046906772953399, -0.012884541136339, 0.000000000000000,  0.000000000000000,  -0.011263715934582, -0.002370943411511,
        -0.103678415606436, -0.093229634284854, 0.003288904967851,  -0.004374739375958, 0.196846185458605,  0.122759733863910,  0.028199164452176,
        0.015077390988263,  -0.002745131209461, 0.002423384627472,  0.094806571818964,  0.081648002892440,  -0.048996322022740, -0.046906772953399,
        0.341257835942054,  0.203801842676167,  -0.158469515397967, -0.114071592012046, 0.046705205223875,  0.037199906669401,  -0.252298708082955,
        -0.208869135084580, -0.004374739375958, -0.041832648023114, 0.072362339778655,  0.045680167664270,  0.015077390988263,  -0.026917391243936,
        -0.052396076785670, -0.037880170672413, 0.081648002892440,  0.106451173686400,  -0.013860643196978, -0.012884541136339, 0.203801842676167,
        0.222302285611220,  -0.115195303106786, -0.090505286024866, 0.037199906669401,  0.061962862000045,  0.000000000000000,  0.000000000000000,
        0.020761597771408,  0.078150752389518,  0.000000000000000,  0.000000000000000,  0.058373652071595,  0.182955834405473,  0.000000000000000,
        0.000000000000000,  -0.173276380950044, -0.202114650816313, 0.000000000000000,  0.000000000000000,  -0.158469515397967, -0.115195303106786,
        0.000000000000000,  0.000000000000000,  -0.035367753147413, -0.099278233368629, 0.000000000000000,  0.000000000000000,  0.031211331850953,
        0.074600180523814,  0.000000000000000,  0.000000000000000,  0.073799200389413,  0.162826416216213,  0.000000000000000,  0.000000000000000,
        -0.107753952799820, -0.144979322044944, 0.000000000000000,  0.000000000000000,  -0.114071592012046, -0.090505286024866, 0.000000000000000,
        0.000000000000000,  -0.010886144911569, -0.058449720507290, -0.068531330571928, -0.052586916582972, 0.010144912223213,  0.012187967076155,
        0.013503797580127,  0.014264208334727,  0.035925229897510,  0.044876420582992,  0.024887959108237,  0.033891416915055,  -0.016599084746298,
        -0.006282446406052, -0.014639505587594, -0.011263715934582, 0.046705205223875,  0.037199906669401,  -0.035367753147413, -0.010886144911569,
        0.151811754060007,  0.060475272821832,  -0.134132665900682, -0.110435181622516, 0.012187967076155,  0.028021510192908,  -0.047797339528795,
        -0.043857771152758, 0.044876420582992,  0.113986631088246,  -0.046609548603253, -0.023550672603342, -0.006282446406052, 0.000651544715819,
        -0.002327870094926, -0.002370943411511, 0.037199906669401,  0.061962862000045,  -0.099278233368629, -0.058449720507290, 0.060475272821832,
        0.024266748800437};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 20, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.001120609639354,  0.025482562939588,  0.000000000000000,  0.000000000000000,  0.006134451758753,
        -0.006188114186561, 0.000000000000000,  0.000000000000000,  0.080295163672104,  0.012767966046470,  0.000000000000000,  0.000000000000000,
        -0.048996322022740, -0.013860643196978, 0.000000000000000,  0.000000000000000,  -0.014639505587594, -0.002327870094926, 0.000000000000000,
        0.000000000000000,  0.009141972802109,  0.034537695039955,  0.000000000000000,  0.000000000000000,  -0.003572211864070, -0.006021984629874,
        0.000000000000000,  0.000000000000000,  0.061779539555610,  0.013004215760258,  0.000000000000000,  0.000000000000000,  -0.046906772953399,
        -0.012884541136339, 0.000000000000000,  0.000000000000000,  -0.011263715934582, -0.002370943411511, 0.001120609639354,  0.009141972802109,
        0.439745319022310,  0.239933535572890,  0.011610566763428,  -0.009644348963128, 0.102762347940253,  0.075769304740026,  0.246375753435235,
        0.180491849411885,  -0.005472447752548, 0.000024266857636,  -0.106159426702262, -0.102745831364470, 0.103190701003259,  0.070542783613159,
        -0.014639505587594, -0.011263715934582, -0.011190913719809, -0.009925579302556, 0.025482562939588,  0.034537695039955,  0.239933535572890,
        0.255452206957293,  -0.072997233039649, -0.067826182671112, 0.075769304740026,  0.067898211324321,  0.143096051710749,  0.114772988625601,
        0.000024266857636,  -0.021065051088889, -0.165377700118365, -0.145651903022449, 0.070542783613159,  0.060146910167361,  -0.002327870094926,
        -0.002370943411511, -0.009925579302556, -0.011658664700013, 0.000000000000000,  0.000000000000000,  0.011610566763428,  -0.072997233039649,
        0.000000000000000,  0.000000000000000,  0.029370542198981,  -0.136824921527630, 0.000000000000000,  0.000000000000000,  0.191004482835566,
        0.196850394427756,  0.000000000000000,  0.000000000000000,  0.173660772352338,  0.086750891367746,  0.000000000000000,  0.000000000000000,
        0.143232009756482,  0.182142255286033,  0.000000000000000,  0.000000000000000,  -0.009644348963128, -0.067826182671112, 0.000000000000000,
        0.000000000000000,  -0.002458035247186, -0.101873841897006, 0.000000000000000,  0.000000000000000,  0.107122104794399,  0.142174265723753,
        0.000000000000000,  0.000000000000000,  0.104445754498729,  0.056177835718874,  0.000000000000000,  0.000000000000000,  0.129229623740403,
        0.158825691727183,  0.006134451758753,  -0.003572211864070, 0.102762347940253,  0.075769304740026,  0.029370542198981,  -0.002458035247186,
        0.577557837278160,  0.327849621130881,  0.278835744695778,  0.143957367167928,  0.101745380527605,  0.058849206505711,  0.173660772352338,
        0.104445754498729,  0.123364624911298,  0.091460211929518,  0.066455721921001,  0.059371309500587,  -0.087904854731122, -0.057609431564095,
        -0.006188114186561, -0.006021984629874, 0.075769304740026,  0.067898211324321,  -0.136824921527630, -0.101873841897006, 0.327849621130881,
        0.250636672156666,  0.081034249998922,  0.026704318823638,  0.058849206505711,  -0.026815435187395, 0.086750891367746,  0.056177835718874,
        0.091460211929518,  0.066704525965932,  0.015234184772119,  0.014040010393797,  -0.057609431564095, -0.047636788121625, 0.000000000000000,
        0.000000000000000,  0.246375753435235,  0.143096051710749,  0.000000000000000,  0.000000000000000,  0.278835744695778,  0.081034249998922,
        0.000000000000000,  0.000000000000000,  -0.063846570897926, -0.157178937643404, 0.000000000000000,  0.000000000000000,  0.185890496463852,
        0.054022833332614,  0.000000000000000,  0.000000000000000,  -0.102656563931348, -0.059623354879479, 0.000000000000000,  0.000000000000000,
        0.180491849411885,  0.114772988625601,  0.000000000000000,  0.000000000000000,  0.143957367167928,  0.026704318823638,  0.000000000000000,
        0.000000000000000,  -0.095441780598399, -0.131396964231863, 0.000000000000000,  0.000000000000000,  0.095971578111952,  0.017802879215758,
        0.000000000000000,  0.000000000000000,  -0.075204937254952, -0.047822078594000, 0.080295163672104,  0.061779539555610,  -0.005472447752548,
        0.000024266857636,  0.191004482835566,  0.107122104794399,  0.101745380527605,  0.058849206505711,  -0.063846570897926, -0.095441780598399,
        0.452900666120615,  0.204890311089203,  0.127336321890377,  0.071414736529599,  0.067830253685070,  0.039232804337141,  -0.033456318196710,
        -0.025741474814837, 0.002280186563561,  -0.000010111190682, 0.012767966046470,  0.013004215760258,  0.000024266857636,  -0.021065051088889,
        0.196850394427756,  0.142174265723753,  0.058849206505711,  -0.026815435187395, -0.157178937643404, -0.131396964231863, 0.204890311089203,
        0.045829552890295,  0.131233596285170,  0.094782843815836,  0.039232804337141,  -0.017876956791597, -0.005319985852696, -0.005418423233441,
        -0.000010111190682, 0.008777104620371,  0.000000000000000,  0.000000000000000,  -0.106159426702262, -0.165377700118365, 0.000000000000000,
        0.000000000000000,  0.173660772352338,  0.086750891367746,  0.000000000000000,  0.000000000000000,  0.127336321890377,  0.131233596285170,
        0.000000000000000,  0.000000000000000,  -0.115346768094634, -0.209117331000752, 0.000000000000000,  0.000000000000000,  -0.177871524402590,
        -0.158682737229949, 0.000000000000000,  0.000000000000000,  -0.102745831364470, -0.145651903022449, 0.000000000000000,  0.000000000000000,
        0.104445754498729,  0.056177835718874,  0.000000000000000,  0.000000000000000,  0.071414736529599,  0.094782843815836,  0.000000000000000,
        0.000000000000000,  -0.089496163996126, -0.148688704996067, 0.000000000000000,  0.000000000000000,  -0.145005954440121, -0.135158880495309,
        -0.048996322022740, -0.046906772953399, 0.103190701003259,  0.070542783613159,  0.173660772352338,  0.104445754498729,  0.123364624911298,
        0.091460211929518,  0.185890496463852,  0.095971578111952,  0.067830253685070,  0.039232804337141,  -0.115346768094634, -0.089496163996126,
        0.474753983185412,  0.251632777856282,  -0.083102481054580, -0.067279843105254, 0.024634689216001,  0.009665505378143,  -0.013860643196978,
        -0.012884541136339, 0.070542783613159,  0.060146910167361,  0.086750891367746,  0.056177835718874,  0.091460211929518,  0.066704525965932,
        0.054022833332614,  0.017802879215758,  0.039232804337141,  -0.017876956791597, -0.209117331000752, -0.148688704996067, 0.251632777856282,
        0.195049567185056,  -0.013208437792838, -0.011927716390217, 0.009665505378143,  0.003957587535003,  0.000000000000000,  0.000000000000000,
        -0.014639505587594, -0.002327870094926, 0.000000000000000,  0.000000000000000,  0.066455721921001,  0.015234184772119,  0.000000000000000,
        0.000000000000000,  -0.033456318196710, -0.005319985852696, 0.000000000000000,  0.000000000000000,  -0.083102481054580, -0.013208437792838,
        0.000000000000000,  0.000000000000000,  -0.027914409776041, 0.020865620584650,  0.000000000000000,  0.000000000000000,  -0.011263715934582,
        -0.002370943411511, 0.000000000000000,  0.000000000000000,  0.059371309500587,  0.014040010393797,  0.000000000000000,  0.000000000000000,
        -0.025741474814837, -0.005418423233441, 0.000000000000000,  0.000000000000000,  -0.067279843105254, -0.011927716390217, 0.000000000000000,
        0.000000000000000,  -0.013197730468145, 0.029835323940458,  -0.014639505587594, -0.011263715934582, -0.011190913719809, -0.009925579302556,
        0.143232009756482,  0.129229623740403,  -0.087904854731122, -0.057609431564095, -0.102656563931348, -0.075204937254952, 0.002280186563561,
        -0.000010111190682, -0.177871524402590, -0.145005954440121, 0.024634689216001,  0.009665505378143,  -0.027914409776041, -0.013197730468145,
        0.417550006811354,  0.220247803289488,  -0.002327870094926, -0.002370943411511, -0.009925579302556, -0.011658664700013, 0.182142255286033,
        0.158825691727183,  -0.057609431564095, -0.047636788121625, -0.059623354879479, -0.047822078594000, -0.000010111190682, 0.008777104620371,
        -0.158682737229949, -0.135158880495309, 0.009665505378143,  0.003957587535003,  0.020865620584650,  0.029835323940458,  0.220247803289488,
        0.232329188635600};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 20, 20));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeDFForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix efxmat(20, 28);

    CDenseMatrix efymat(20, 28);

    CDenseMatrix efzmat(20, 28);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.643788410658111,  0.370049943201491,  -0.041601690874276, -0.032402615586490, 0.000000000000000,  0.000000000000000,  -0.012569197803349,
        0.057990329344673,  -0.166225452864014, -0.095546484485625, -0.063270063057882, 0.092628410738158,  0.000000000000000,  0.000000000000000,
        -0.214561362527757, -0.231537205596162, 0.000000000000000,  0.000000000000000,  -0.022281088747674, -0.065117445331536, 0.000000000000000,
        0.000000000000000,  -0.136415003026567, -0.267836054228313, 0.000000000000000,  0.000000000000000,  -0.029549221450173, -0.080460780564390,
        0.491503586060572,  0.357377837277564,  -0.023015345842423, -0.007236127282692, 0.000000000000000,  0.000000000000000,  -0.010159276559428,
        0.030087650753718,  -0.126905680227588, -0.092274560805309, -0.022346793191254, 0.071106761737525,  0.000000000000000,  0.000000000000000,
        -0.122917410265235, -0.155685556074787, 0.000000000000000,  0.000000000000000,  0.024690842170054,  -0.022191016218650, 0.000000000000000,
        0.000000000000000,  -0.104794135485267, -0.210733882251746, 0.000000000000000,  0.000000000000000,  -0.015542717148137, -0.052932401832864,
        -0.005218847402385, 0.000843361031349,  0.118942897956342,  0.060254364708139,  0.004097830913681,  0.007272877592291,  -0.027036380615844,
        0.007376232712501,  -0.003725313194211, -0.000530845252668, -0.016271487248552, -0.000148970791636, 0.017887943418830,  0.004698747991682,
        -0.030755461385854, -0.020173822744100, 0.025991729448635,  -0.003181714250840, -0.001973363487233, 0.007731232877058,  -0.082077904244595,
        -0.076744932991294, 0.013556232533123,  0.009236062915759,  -0.033299658392120, -0.033820178861608, 0.031351925629181,  0.007432023154218,
        0.050045660118352,  0.052978576854569,  0.103394448442615,  0.136245576708930,  -0.015720688187376, -0.007647888537685, 0.011502360847644,
        0.057885493374544,  -0.007411473799205, -0.005210240384168, -0.000792097501676, 0.021574956101582,  0.038415589980781,  0.027816463387019,
        -0.034432715320252, -0.047682027242366, 0.046901802440825,  0.032186004153375,  0.012715554215377,  0.035088176612970,  -0.082133484962802,
        -0.080090866612812, 0.015787631964424,  0.016331813568690,  -0.018114473010937, -0.021961624608277, 0.013216003150743,  -0.002398293144777,
        0.000000000000000,  0.000000000000000,  -0.019457764032903, -0.027978421306197, 0.525651036143242,  0.302144513396516,  0.001474705755343,
        -0.013704954992802, 0.000000000000000,  0.000000000000000,  -0.027254139857581, -0.006317149869367, 0.000000000000000,  0.000000000000000,
        -0.087328617406724, -0.002572322932609, 0.000000000000000,  0.000000000000000,  0.028578021071017,  -0.006176490721368, 0.000000000000000,
        0.000000000000000,  0.023392814733089,  0.001347430410651,  0.000000000000000,  0.000000000000000,  0.044566007462144,  0.043759286851811,
        0.000000000000000,  0.000000000000000,  -0.023845803505515, -0.032528159851260, 0.401310997532173,  0.291797782236476,  -0.006229615157572,
        -0.013612511980564, 0.000000000000000,  0.000000000000000,  -0.014970098966084, -0.008392780129625, 0.000000000000000,  0.000000000000000,
        -0.057017862284489, 0.000548551694873,  0.000000000000000,  0.000000000000000,  0.020088882106636,  -0.010227003537303, 0.000000000000000,
        0.000000000000000,  0.014490760052972,  0.001050885892521,  0.000000000000000,  0.000000000000000,  0.045918706194562,  0.050461941795577,
        0.017375648996170,  0.006541795521960,  0.053695132938621,  0.035225462198571,  0.009915054361617,  -0.007861676204612, 0.115090443610073,
        0.070942644504510,  0.012614532884311,  0.011017844894319,  -0.229331723732032, -0.114778672028992, -0.038425873949279, -0.020659481968745,
        -0.032893364969797, -0.031793062709966, 0.091330369420626,  0.044093415401182,  0.014585982178419,  0.019669350513363,  0.099730338238713,
        0.061998317388428,  0.146285676351432,  0.082077499179149,  0.079559757458758,  0.062397073335623,  -0.012148928584515, -0.010296436469421,
        -0.033138834274158, -0.030034856670247, 0.060115021634457,  0.077912925959147,  -0.029318648282109, -0.021949257151322, 0.120851192042403,
        0.201071401123430,  0.014053788147188,  0.015910309333591,  -0.197721487437491, -0.163858501965587, -0.015277308472341, -0.011774175008018,
        -0.053982432443343, -0.068269508811883, -0.010788675725573, -0.015139493538878, 0.032894747942320,  0.081723870780740,  0.019969873000651,
        0.013591115747747,  0.140774834477389,  0.145826462632720,  0.090405294981211,  0.079598020659647,  -0.017380001164556, -0.037922904670258,
        0.000000000000000,  0.000000000000000,  0.053059694564359,  -0.025781304409541, 0.000000000000000,  0.000000000000000,  -0.025311223630699,
        -0.120716074556702, 0.000000000000000,  0.000000000000000,  0.051042810261246,  0.061303196298774,  0.000000000000000,  0.000000000000000,
        0.093444192617394,  0.089241492988768,  0.575821859743234,  0.330982731227388,  -0.103348336578568, -0.157380107246559, 0.000000000000000,
        0.000000000000000,  0.001985275974830,  -0.108357412977596, 0.000000000000000,  0.000000000000000,  -0.000662859372283, 0.008728891111437,
        0.000000000000000,  0.000000000000000,  0.053012810809224,  -0.003754085919185, 0.000000000000000,  0.000000000000000,  -0.015483182894337,
        -0.090843622544229, 0.000000000000000,  0.000000000000000,  0.025823754784297,  0.037127247885382,  0.000000000000000,  0.000000000000000,
        0.056133296061152,  0.058907042377442,  0.439614171846543,  0.319648455121797,  -0.090761851598549, -0.129606401562061, 0.000000000000000,
        0.000000000000000,  0.008319506957741,  -0.076849977699960, 0.000000000000000,  -0.000000000000000, -0.004552868993110, 0.002434617594168,
        0.084212619270010,  0.047522703044152,  -0.000769083783213, 0.004199972245065,  0.096801228959629,  0.045127529728943,  -0.003102165184310,
        0.005342454819159,  0.000140371727376,  0.002049940277313,  -0.164391759666009, -0.088749099940529, -0.057960483649109, -0.026951135996252,
        -0.191480500902827, -0.094360181107428, -0.071369518176150, -0.066782316606238, 0.110698952361473,  0.063191805913304,  0.012589588416611,
        -0.009097416689012, 0.055211391893209,  0.040151933051634,  -0.057619522534957, -0.037922475765935, 0.007602805346875,  0.004062435746305,
        0.063021525927635,  0.049424100924937,  0.006978050895141,  0.011662108355464,  0.004433284008739,  -0.004944722778227, 0.008624148874078,
        0.038358625840546,  -0.013625542648430, -0.009058011551389, -0.152589336999611, -0.131326914049557, 0.002527354103028,  0.010300210222788,
        -0.162414209184519, -0.151421481736891, -0.085447663647855, -0.071873485313182, 0.107841697628998,  0.177776911787895,  -0.002437915728080,
        -0.009442487603551, 0.068460823909881,  0.080831406879594,  -0.029341677168306, -0.024216777534248, 0.007015992192473,  0.004294522880672,
        0.000000000000000,  0.000000000000000,  -0.020736545636985, -0.045560883127148, 0.000000000000000,  0.000000000000000,  -0.052946285019728,
        -0.043213020423231, 0.000000000000000,  0.000000000000000,  -0.174496036036521, 0.103367419103416,  -0.407167541779890, -0.234040133706530,
        0.093293151585292,  0.245899418426476,  0.000000000000000,  0.000000000000000,  -0.004136816348443, 0.064195474795314,  0.525651036143242,
        0.302144513396516,  0.079678413206310,  0.007534303169106,  0.000000000000000,  0.000000000000000,  -0.025736698749878, -0.005312943595132,
        0.000000000000000,  0.000000000000000,  -0.026759950849880, -0.049354022031023, 0.000000000000000,  0.000000000000000,  -0.000711615821615,
        -0.019912721243450, 0.000000000000000,  0.000000000000000,  -0.073337626079362, 0.093901569986059,  -0.310854162018399, -0.226025590212426,
        0.080438438138831,  0.186735624531259,  0.000000000000000,  0.000000000000000,  0.023273724682086,  0.051484686375245,  0.401310997532173,
        0.291797782236476,  0.028844715561900,  -0.002793418653743, 0.000000000000000,  0.000000000000000,  -0.045530546012430, -0.025649543485286,
        -0.077227179768866, -0.063535716459862, 0.034286163611627,  0.025378864053322,  0.004824869464012,  -0.016886547919025, -0.011615805983144,
        0.019926133075741,  0.004269875790651,  0.008125550400633,  0.014585982178419,  0.019669350513363,  0.076885313789338,  0.067730310467328,
        -0.087669069037043, -0.044880536976351, 0.050951362229748,  0.031268379398064,  -0.050210438859431, 0.006312865088716,  -0.069209765981479,
        -0.049861136400554, 0.131052052528619,  0.071099083546190,  -0.058493314516761, -0.033264945733133, 0.021388053056588,  0.007536223455040,
        -0.084078542178337, -0.075233903483705, 0.043161096204351,  0.064592644548627,  0.010278193656895,  0.004301355839506,  0.032715684319359,
        0.094208506373732,  0.028192684640434,  0.030026044757662,  0.032894747942320,  0.081723870780740,  0.048076391437530,  0.043675602212559,
        -0.077084825098578, -0.091532181151055, 0.037983931617826,  0.036513016792058,  0.009036035176601,  0.078956337150761,  -0.043224159557888,
        -0.030532820915232, 0.121854827307041,  0.157743297135383,  -0.070392603516344, -0.057687265215317, 0.013171340965524,  0.006933939661096,
        0.000000000000000,  0.000000000000000,  0.047008162575254,  0.096966906794863,  0.000000000000000,  0.000000000000000,  0.143608133210118,
        0.252914447256780,  0.000000000000000,  0.000000000000000,  -0.183096707580722, -0.137209795975866, 0.000000000000000,  0.000000000000000,
        -0.035133696012197, -0.126526036489013, -0.166225452864013, -0.095546484485625, 0.095655595829957,  0.189158267197358,  0.000000000000000,
        0.000000000000000,  0.092143656308944,  0.150738102924253,  0.643788410658110,  0.370049943201490,  -0.034527167296116, -0.017226848225773,
        0.000000000000000,  0.000000000000000,  0.021067371184310,  0.062060640269925,  0.000000000000000,  0.000000000000000,  0.114819670900386,
        0.202978461796569,  0.000000000000000,  0.000000000000000,  -0.112504743115970, -0.099532581947555, 0.000000000000000,  0.000000000000000,
        -0.000228936380797, -0.075583889188295, -0.126905680227588, -0.092274560805309, 0.065185541404274,  0.133766848508879,  0.000000000000000,
        0.000000000000000,  0.031970933938248,  0.085086380561050,  0.491503586060572,  0.357377837277565,  -0.024294170607166, 0.000704425732528,
        0.017131735064723,  0.026310679472860,  -0.038832240038667, -0.014358938413540, 0.074181751580473,  0.067975132488886,  0.013556232533123,
        0.009236062915759,  -0.010602647540966, -0.008409612297313, 0.043527881571780,  0.030160001942655,  -0.003282771390876, -0.017579584032520,
        -0.022795491264264, -0.009088374304417, -0.040001554562793, -0.019388200495036, -0.001023749573018, 0.005350829066810,  -0.033862692997768,
        -0.003784486153374, -0.066604311011003, -0.026536020431376, -0.015584017374435, -0.002559394563143, 0.104359663288135,  0.049006650437963,
        0.009835048001791,  0.016091142830776,  -0.024931796901898, -0.016948230448463, 0.085986354112475,  0.082114137554927,  0.015787631964424,
        0.016331813568690,  -0.000121274112363, -0.000579375648806, 0.051509002660015,  0.056463905628132,  0.032543957918874,  0.020859112603683,
        -0.015733754237356, -0.017512965437297, -0.027244949352553, -0.020011577005208, 0.008938221119142,  0.013635113626964,  -0.041435241082563,
        -0.024537664905495, -0.045991671295876, -0.029045656070568, 0.042271058215507,  0.047630947371092,  0.084257586157922,  0.111269393046851};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 20, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.044039838274604,  0.096621104871552,  0.000000000000000,  0.000000000000000,  0.034444155054797,
        0.145726522961761,  0.000000000000000,  0.000000000000000,  -0.074365048807561, -0.073799224679074, 0.000000000000000,  0.000000000000000,
        -0.226046456305408, -0.175767445198796, -0.166225452864014, -0.095546484485625, 0.111012176617673,  0.210587315446187,  0.000000000000000,
        0.000000000000000,  0.151589695211714,  0.220643815636594,  -0.643788410658111, -0.370049943201491, 0.016998118969748,  -0.040675699902647,
        0.000000000000000,  0.000000000000000,  0.019108350024578,  0.061738376104080,  0.000000000000000,  0.000000000000000,  0.002342271074932,
        0.079372452967381,  0.000000000000000,  0.000000000000000,  -0.011481850754015, -0.030670486658012, 0.000000000000000,  0.000000000000000,
        -0.144803404635305, -0.125487664199779, -0.126905680227588, -0.092274560805309, 0.086479114790416,  0.157583692710222,  0.000000000000000,
        0.000000000000000,  0.098158429721347,  0.166043184704554,  -0.491503586060572, -0.357377837277564, 0.012575886404451,  -0.039885602123067,
        0.018774927217402,  0.027483106319211,  -0.040909489484991, -0.015628297783406, -0.010310334659717, 0.009619933640629,  -0.076851953674346,
        -0.017463886485257, 0.047197024530567,  0.013637510343786,  -0.025094395589548, -0.007384374957257, 0.023623808692115,  0.019064869963922,
        -0.018740679123625, -0.016803708130670, -0.003725313194211, -0.000530845252668, -0.042910958515737, -0.018984135812884, 0.029844498755278,
        0.040384033558345,  -0.015660555761307, -0.014436405884088, -0.019832754980844, -0.028779393347429, -0.084594178416877, -0.048055055458676,
        0.009961397044001,  0.016228538361460,  -0.027111511800764, -0.018627040556579, -0.039713202405021, -0.021792917951038, -0.031252331576760,
        0.021654323071549,  0.047144350665551,  0.033344755450987,  -0.013194895951888, 0.013639519718882,  0.020276882091018,  0.016763690710061,
        -0.028510058400279, -0.042768827949486, -0.007411473799205, -0.005210240384168, -0.032920245481995, -0.016541358215991, 0.042931862847755,
        0.045350711827526,  -0.024420209294521, -0.040133080662313, -0.062001825638022, -0.069171577665458, -0.082142382213926, -0.126057041757494,
        0.000000000000000,  0.000000000000000,  0.021310962808149,  0.036472470213233,  0.000000000000000,  0.000000000000000,  -0.099731914485907,
        -0.045907881244532, 0.000000000000000,  0.000000000000000,  -0.075664455380054, 0.092993978110289,  -0.407167541779890, -0.234040133706530,
        0.020519303746356,  0.243755815982635,  0.000000000000000,  0.000000000000000,  -0.162636844595940, 0.066712123347156,  -0.525651036143242,
        -0.302144513396516, -0.016062496745629, 0.029599405859129,  0.000000000000000,  0.000000000000000,  0.022800788763930,  0.051764831821811,
        0.000000000000000,  0.000000000000000,  0.034002843288144,  0.046458004610611,  0.000000000000000,  0.000000000000000,  -0.029693135927558,
        -0.022014493028492, 0.000000000000000,  0.000000000000000,  -0.007633443532633, 0.074864862905734,  -0.310854162018399, -0.226025590212426,
        0.032923552901757,  0.187192750943654,  0.000000000000000,  0.000000000000000,  -0.077254437756750, 0.061026268885950,  -0.401310997532173,
        -0.291797782236476, -0.016176068999744, 0.020263091267052,  0.000000000000000,  0.000000000000000,  0.008511317994638,  0.040451410300721,
        0.081617894962899,  0.061790231661264,  -0.036261196652481, -0.023648608142435, 0.030074680446469,  -0.000411123362558, -0.062792649702907,
        -0.010363537325124, 0.091078966880438,  0.055303786037941,  -0.167434874809171, -0.045260934924555, 0.044863752164939,  0.050514075493373,
        -0.115080206511874, -0.071374755901322, 0.012614532884311,  0.011017844894319,  -0.051688822894404, -0.023373921362844, 0.054668286852112,
        0.057068499434547,  -0.100048529326098, -0.075083498442280, 0.036051881302812,  0.042186312481525,  -0.011293439736667, -0.016379753666240,
        0.089193541630598,  0.078005179442332,  -0.040366334425676, -0.054094132490834, 0.011202797326813,  0.005102563367947,  -0.019325511962262,
        0.053957760978720,  0.049863895007086,  0.048608944430811,  -0.080425481095290, 0.041213537605741,  0.035345301043913,  0.033863789705877,
        -0.122070185468031, -0.148423438494291, 0.014053788147188,  0.015910309333591,  -0.040723190611914, 0.003001935106892,  0.034273746648010,
        0.026614521245460,  -0.127434065789165, -0.219479241865572, 0.044249272982563,  0.043522965871227,  -0.027455678945418, -0.060593001289816,
        0.000000000000000,  -0.000000000000000, -0.030863998506576, 0.011564216177063,  0.000000000000000,  0.000000000000000,  -0.031381399134796,
        -0.059031206161037, 0.575821859743234,  0.330982731227387,  -0.060812661360863, -0.106294110330914, 0.000000000000000,  0.000000000000000,
        0.140166288926091,  0.133862239483152,  0.000000000000000,  0.000000000000000,  0.051042810261246,  0.061303196298774,  0.000000000000000,
        0.000000000000000,  0.018782961109250,  0.130366854151246,  0.000000000000000,  0.000000000000000,  -0.022604764344904, 0.022922153082859,
        -0.000000000000000, 0.000000000000000,  -0.029248259041756, 0.001208825875670,  0.000000000000000,  0.000000000000000,  -0.024661836458250,
        -0.048033520667583, 0.439614171846543,  0.319648455121797,  -0.069242055944967, -0.098667028324243, 0.000000000000000,  0.000000000000000,
        0.084199944091729,  0.088360563566163,  0.000000000000000,  0.000000000000000,  0.025823754784297,  0.037127247885382,  0.000000000000000,
        0.000000000000000,  0.009030311356426,  0.096481625007085,  0.000000000000000,  0.000000000000000,  -0.028109896474455, 0.004990178408427,
        -0.025889572126414, -0.012402468781236, -0.002652817122874, -0.004123108367637, 0.104491509734478,  0.060225355594916,  -0.046129265519860,
        -0.024584745381224, -0.071252541736670, -0.065074033041811, -0.026294180693534, -0.010765777370470, -0.086940725473663, -0.040426703994378,
        -0.287220751354241, -0.141540271661142, 0.000140371727376,  0.002049940277312,  -0.164391759666009, -0.088749099940529, -0.078820418267003,
        -0.031564378629913, -0.016725354744334, -0.018008326686457, -0.116209207917281, -0.073257163869058, 0.011110887954389,  0.004054357953868,
        -0.025000348697499, -0.019113998176685, -0.006959133185693, -0.008596535447830, 0.007104321442163,  0.001431214879695,  -0.042490099207406,
        -0.016934497890326, -0.096802282521546, -0.079421828272673, -0.019316083204012, 0.068337816746598,  0.003791031154542,  0.015450315334182,
        -0.243621313776779, -0.227132222605337, -0.013625542648430, -0.009058011551389, -0.152589336999611, -0.131326914049557, -0.002566324562387,
        0.007072186307557,  -0.030331938179634, -0.057486737643356, -0.067399336150297, -0.054569760781302, 0.007114512511412,  0.001337278194286,
        0.000000000000000,  0.000000000000000,  -0.019457764032903, -0.027978421306197, 0.525651036143242,  0.302144513396516,  0.001474705755343,
        -0.013704954992802, 0.000000000000000,  0.000000000000000,  -0.027254139857581, -0.006317149869367, 0.000000000000000,  0.000000000000000,
        -0.087328617406724, -0.002572322932609, 0.000000000000000,  0.000000000000000,  0.028578021071017,  -0.006176490721368, 0.000000000000000,
        0.000000000000000,  0.023392814733089,  0.001347430410651,  0.000000000000000,  0.000000000000000,  0.044566007462144,  0.043759286851811,
        0.000000000000000,  0.000000000000000,  -0.023845803505515, -0.032528159851260, 0.401310997532173,  0.291797782236476,  -0.006229615157572,
        -0.013612511980564, 0.000000000000000,  0.000000000000000,  -0.014970098966084, -0.008392780129625, 0.000000000000000,  0.000000000000000,
        -0.057017862284489, 0.000548551694873,  0.000000000000000,  0.000000000000000,  0.020088882106636,  -0.010227003537303, 0.000000000000000,
        0.000000000000000,  0.014490760052972,  0.001050885892521,  0.000000000000000,  0.000000000000000,  0.045918706194562,  0.050461941795577,
        -0.117247327590854, -0.085793529166093, -0.014280140732403, -0.007194798424245, -0.083714315413334, -0.066391700926830, 0.014509398200448,
        0.015165424522246,  0.070654861970961,  0.034996421561351,  -0.051688822894404, -0.023373921362844, -0.038425873949279, -0.020659481968745,
        -0.032893364969797, -0.031793062709966, 0.004269875790651,  0.008125550400633,  -0.251878369078024, -0.117437775485859, -0.124980149221170,
        -0.078473741944895, -0.095108832631669, -0.051787828778285, 0.053220479430862,  0.044331466331438,  -0.025448438650585, -0.018596052678233,
        -0.081912608443698, -0.071620748334602, -0.012422355843615, -0.004944044995934, -0.046345460645118, -0.033609023411295, 0.025222661761921,
        0.096320492844085,  -0.011933785430150, -0.014200049530770, -0.040723190611914, 0.003001935106892,  -0.015277308472341, -0.011774175008018,
        -0.053982432443343, -0.068269508811883, 0.028192684640434,  0.030026044757662,  -0.202602697296045, -0.168566784827979, -0.020894476670569,
        -0.014392323276188, -0.088733638195768, -0.105575717237708, 0.080862600034997,  0.071461650551404,  -0.031572096758092, -0.054134051161469,
        0.643788410658110,  0.370049943201490,  0.004667080820545,  0.057551242417801,  0.000000000000000,  0.000000000000000,  -0.035092395612743,
        -0.126523185353469, 0.166225452864014,  0.095546484485625,  -0.055386371848610, -0.131276321359604, 0.000000000000000,  0.000000000000000,
        0.177208865948650,  0.221903016935552,  0.000000000000000,  0.000000000000000,  0.235180667640609,  0.145891575323404,  0.000000000000000,
        0.000000000000000,  0.084917532703595,  0.167366125441627,  0.000000000000000,  0.000000000000000,  0.032517545750824,  0.080806582487701,
        0.491503586060572,  0.357377837277564,  -0.004225223101433, 0.049410231412426,  0.000000000000000,  0.000000000000000,  -0.048250774535756,
        -0.109765044660990, 0.126905680227588,  0.092274560805309,  -0.070689287827624, -0.111741222310270, 0.000000000000000,  0.000000000000000,
        0.094631101258918,  0.145921774007323,  0.000000000000000,  0.000000000000000,  0.148677436040038,  0.108012052386918,  0.000000000000000,
        0.000000000000000,  0.030375214993299,  0.093388594004771,  0.000000000000000,  0.000000000000000,  0.017501738307868,  0.053254665998709,
        0.001390541456371,  0.019613621732834,  0.080221578104393,  0.043046825047628,  -0.074328605128100, -0.056096010095108, -0.015660555761307,
        -0.014436405884088, 0.009506240404792,  0.015031618789642,  0.012301982521677,  -0.005495353200061, -0.012623612533028, 0.002470819094579,
        0.031548794195979,  0.018664300908529,  -0.010602647540966, -0.008409612297313, -0.020406849469464, -0.015044394108340, -0.034336958466413,
        -0.004387346482253, -0.063609083765925, -0.011275795093055, 0.031656466239440,  0.032647752015257,  -0.029274676182857, -0.006162663784351,
        0.053606160206444,  0.063148586092748,  0.073719819009410,  0.109332980245216,  -0.069148029869096, -0.062785957617633, -0.024420209294521,
        -0.040133080662313, -0.011940947775104, -0.007292906163276, -0.008738495395595, -0.033938320431902, -0.040815670034057, -0.028617741583598,
        0.031933003636202,  0.042740662837808,  -0.000121274112363, -0.000579375648806, -0.025598552492750, -0.035015248734044, -0.046020691499887,
        -0.026485412213732, -0.020481634095587, 0.021605432884416,  0.017988123968727,  0.021824229077593,  -0.011036288251877, 0.004077103252894};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 20, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.019457764032903, -0.027978421306197, 0.525651036143242,  0.302144513396516,  0.001474705755343,
        -0.013704954992802, 0.000000000000000,  0.000000000000000,  -0.027254139857581, -0.006317149869367, 0.000000000000000,  0.000000000000000,
        -0.087328617406724, -0.002572322932609, 0.000000000000000,  0.000000000000000,  0.028578021071017,  -0.006176490721368, 0.000000000000000,
        0.000000000000000,  0.023392814733089,  0.001347430410651,  0.000000000000000,  0.000000000000000,  0.044566007462144,  0.043759286851811,
        0.000000000000000,  0.000000000000000,  -0.023845803505515, -0.032528159851260, 0.401310997532173,  0.291797782236476,  -0.006229615157572,
        -0.013612511980564, 0.000000000000000,  0.000000000000000,  -0.014970098966084, -0.008392780129625, 0.000000000000000,  0.000000000000000,
        -0.057017862284489, 0.000548551694873,  0.000000000000000,  0.000000000000000,  0.020088882106636,  -0.010227003537303, 0.000000000000000,
        0.000000000000000,  0.014490760052972,  0.001050885892521,  0.000000000000000,  0.000000000000000,  0.045918706194562,  0.050461941795577,
        0.013856898061713,  0.019455852506036,  -0.091707846058266, -0.036677574657363, 0.003058916833263,  0.017300818209191,  -0.168221117680945,
        -0.069157384901741, 0.017157220807178,  -0.005654130982780, -0.041617285017402, -0.021952250600734, 0.214779779831138,  0.158297048912439,
        0.045410368976767,  0.023570789517845,  -0.102262298050791, -0.094624407933164, -0.027538689893419, -0.013914004850852, -0.025658802736006,
        -0.017177413097203, 0.019007207013239,  0.011037799892852,  -0.029298987593773, -0.035258309158622, 0.148324329624513,  0.061593115242963,
        0.011108915536614,  0.015392113153739,  -0.063513734425569, -0.051226704539081, 0.056896222754146,  0.066563274258566,  -0.120034215818339,
        -0.050551712745381, -0.043069811227568, -0.042735656532064, -0.038117449659885, 0.002860044119419,  0.092163044258571,  0.082488837191837,
        0.040454650275549,  0.043769116332432,  -0.098557935093508, -0.092956266182827, -0.024269696053578, 0.011749367206873,  -0.005184470196426,
        -0.004426857324550, 0.018997690547889,  0.012103345010844,  -0.017318007835208, -0.023800037878720, 0.106564052020161,  0.085538239615168,
        0.000000000000000,  0.000000000000000,  -0.099726785232941, -0.069924048035908, 0.000000000000000,  0.000000000000000,  -0.031830979904670,
        0.082268466395153,  0.664901811456054,  0.382185937942500,  -0.113214310429768, 0.039797932459286,  0.000000000000000,  0.000000000000000,
        -0.148995094548039, -0.221584022531941, 0.000000000000000,  0.000000000000000,  -0.169053015654707, -0.104828769999095, 0.000000000000000,
        0.000000000000000,  -0.188799492772350, -0.209400164657060, 0.000000000000000,  0.000000000000000,  -0.101219367539492, -0.121565029293707,
        -0.000000000000000, 0.000000000000000,  -0.069449593434248, -0.054552610860953, 0.000000000000000,  0.000000000000000,  -0.004624055777315,
        0.056656197152045,  0.507622720910352,  0.369098243221234,  -0.071588264280840, 0.011951677958368,  0.000000000000000,  0.000000000000000,
        -0.071709930362820, -0.148562344600097, 0.000000000000000,  0.000000000000000,  -0.079258538541382, -0.065896788922882, 0.000000000000000,
        0.000000000000000,  -0.119528392401070, -0.137011399747438, 0.000000000000000,  0.000000000000000,  -0.081732224345262, -0.097543825289344,
        0.026366038642949,  0.020088601462778,  0.008134280558022,  0.002407508298947,  0.008508517899519,  -0.004406977283476, -0.217962442248637,
        -0.099829819165752, 0.039132227088277,  0.021070087839932,  -0.255064053322841, -0.090850672268524, 0.093179588332841,  0.020309739984946,
        0.092916505304545,  0.051849433310747,  0.111115971286706,  0.046772714736576,  -0.107429643864426, -0.047714687245377, 0.098899502752317,
        0.067186306286732,  0.191173044650556,  0.078545863285750,  0.028436803214819,  0.025478547495396,  0.071977573382070,  0.036239681369830,
        0.002022910436959,  0.001904586090994,  0.004217486592776,  0.002202191159676,  -0.025169353585389, -0.019888375068210, -0.172863411667454,
        -0.085736869678104, -0.013970452559411, 0.006162929777557,  -0.159389269022106, 0.043631008142370,  -0.009686923788688, -0.027437586662276,
        0.088518364338505,  0.129257153959373,  0.011866709091834,  0.000716581015083,  -0.083089776256410, -0.004350165088665, 0.062031309659187,
        0.046114290204356,  0.136305475497079,  0.069434981817336,  0.003579143656212,  0.003465436997566,  0.062551004719878,  0.038687567371925,
        0.000000000000000,  0.000000000000000,  -0.033766368350787, -0.014041968396816, 0.000000000000000,  0.000000000000000,  -0.283421524486472,
        -0.057205865505701, 0.000000000000000,  0.000000000000000,  -0.078117725274196, 0.120632831884838,  0.705234869555693,  0.405369402589923,
        0.182895159275838,  0.188685995886233,  0.000000000000000,  0.000000000000000,  -0.052078483516131, 0.080421887923225,  0.000000000000000,
        0.000000000000000,  0.118092301869363,  0.023835777294042,  0.000000000000000,  0.000000000000000,  0.172583660459576,  0.071770060694838,
        0.000000000000000,  0.000000000000000,  -0.021640063286593, -0.010585089245443, 0.000000000000000,  0.000000000000000,  -0.145050007606867,
        -0.022980089567368, 0.000000000000000,  0.000000000000000,  0.005668202822781,  0.100607051225477,  0.538415202360114,  0.391487806058665,
        0.095038342680401,  0.106698449731165,  0.000000000000000,  0.000000000000000,  0.003778801881854,  0.067071367483651,  -0.000000000000000,
        0.000000000000000,  0.060437503169528,  0.009575037319737,  0.000000000000000,  0.000000000000000,  0.110604767909251,  0.054101567254488,
        0.007340635226419,  0.005537133249482,  -0.000416075398271, -0.000379034884731, 0.122954749670083,  0.077203501456469,  -0.058147384669310,
        -0.024304703175748, 0.064721790555510,  0.022235757490684,  -0.220474335571700, -0.072304107962971, -0.156899811649893, -0.099877908077262,
        -0.100830105321219, -0.000800047995225, 0.043147860370340,  0.014823838327122,  -0.146982890381134, -0.048202738641981, -0.051231145695868,
        -0.032168125606862, 0.024228076945546,  0.010126959656561,  -0.037518802268364, -0.028300903275130, 0.002126607591165,  0.001937289410846,
        0.000762183002338,  0.000868533348873,  -0.000668357662450, 0.001550490847274,  0.058322266413808,  0.049361000603209,  -0.042588323400502,
        0.016397232489638,  0.020353444834818,  0.018844987360719,  -0.127259387105301, 0.028702908534639,  -0.079191064963056, -0.043692107712574,
        -0.004485888936398, 0.153802050060915,  0.013568963223212,  0.012563324907146,  -0.084839591403534, 0.019135272356426,  -0.024300944339087,
        -0.020567083584671, 0.017745134750209,  -0.006832180204016, -0.003895602011952, -0.004439170449798, 0.003416050274746,  -0.007924730997180,
        0.000000000000000,  0.000000000000000,  0.182950087669414,  0.148933482543690,  0.000000000000000,  0.000000000000000,  0.134211962934807,
        0.189554595796061,  0.000000000000000,  0.000000000000000,  -0.169053015654707, -0.104828769999095, 0.000000000000000,  0.000000000000000,
        -0.099330063032026, -0.147722681687961, 0.664901811456054,  0.382185937942500,  0.027663202615821,  0.127155240791865,  0.000000000000000,
        0.000000000000000,  0.247171950376108,  0.183701373906927,  -0.000000000000000, -0.000000000000000, -0.018677154437436, -0.042783665229675,
        0.000000000000000,  0.000000000000000,  0.131996602982501,  0.117296748825997,  0.000000000000000,  0.000000000000000,  0.090344282539445,
        0.125005144973737,  0.000000000000000,  0.000000000000000,  -0.079258538541382, -0.065896788922882, 0.000000000000000,  0.000000000000000,
        -0.047806620241880, -0.099041563066731, 0.507622720910351,  0.369098243221235,  -0.005539482163022, 0.066865668727436,  0.000000000000000,
        0.000000000000000,  0.144539172404325,  0.118021499328738,  0.000000000000000,  -0.000000000000000, -0.019604084618987, -0.034964295020439,
        -0.049053187551067, -0.038930675315084, -0.040938934303479, -0.018215029622874, -0.073131284382718, -0.053207266203305, -0.222504725894186,
        -0.094976370700260, 0.111115971286706,  0.046772714736576,  -0.107429643864426, -0.047714687245377, 0.062119725555227,  0.013539826656631,
        0.061944336869697,  0.034566288873831,  -0.053464415650645, -0.017907174440548, -0.165539350102487, -0.051088432897377, -0.123195709322876,
        -0.075855404376548, -0.057822738114524, -0.015851670158254, 0.005921457509503,  0.006748574708255,  0.038914264310957,  0.020281954614679,
        -0.004334079391413, -0.004119620205152, -0.031527905964130, -0.018922887733640, -0.056428860594317, -0.042356968450039, -0.164687700574948,
        -0.083089671671140, 0.011866709091834,  0.000716581015083,  -0.083089776256410, -0.004350165088665, -0.006457949192459, -0.018291724441517,
        0.059012242892337,  0.086171435972915,  -0.023859376802607, 0.005565778931655,  -0.090147788808431, 0.047256145716258,  -0.053804093250281,
        -0.039092464034720, -0.027798705713897, -0.015946232647547, 0.001274265832884,  0.001255854410138,  0.034982059525560,  0.021802165134309,
        0.000000000000000,  0.000000000000000,  -0.021023754222567, -0.041016676670190, 0.000000000000000,  0.000000000000000,  0.023392814733089,
        0.001347430410651,  0.000000000000000,  0.000000000000000,  -0.049415790328234, 0.005186720496564,  0.000000000000000,  -0.000000000000000,
        0.036386923919468,  0.001071801221921,  0.000000000000000,  0.000000000000000,  0.079250014123749,  -0.001258324275921, 0.525651036143241,
        0.302144513396516,  0.047870454975970,  -0.011032551345012, 0.000000000000000,  0.000000000000000,  -0.024268743756904, -0.028538887708471,
        0.000000000000000,  0.000000000000000,  -0.030381397069012, -0.047906013320817, 0.000000000000000,  0.000000000000000,  0.014490760052972,
        0.001050885892521,  0.000000000000000,  0.000000000000000,  -0.032852091273365, 0.009518353540163,  -0.000000000000000, 0.000000000000000,
        0.023757442618537,  -0.000228563206197, 0.000000000000000,  0.000000000000000,  0.050264081219418,  -0.004770791255352, 0.401310997532173,
        0.291797782236476,  0.022510392280822,  -0.011528254960397, 0.000000000000000,  0.000000000000000,  -0.027020932003534, -0.033050476893003,
        0.016266568672701,  0.025959604931590,  -0.131849333110009, -0.051525623718912, -0.025658802736006, -0.017177413097203, 0.019007207013239,
        0.011037799892852,  0.140661736829258,  0.120467371370862,  0.017072518603614,  0.008209693535777,  -0.089491574929641, -0.065957103713517,
        -0.018920987073653, -0.009821162299102, -0.179106577393878, -0.137740388553238, 0.011876479352713,  0.007203118342981,  -0.047831041926482,
        -0.016767717766929, -0.130523490438020, -0.047265748447584, 0.016520139449269,  0.021356090220773,  -0.095074595764748, -0.038734917983886,
        0.016315913438844,  0.022710332021227,  -0.089276385666471, -0.072223329011301, -0.005184470196426, -0.004426857324550, 0.018997690547889,
        0.012103345010844,  0.108743900569154,  0.101612100598247,  0.014397752522703,  -0.013987157515196, -0.038401268441071, -0.034370348829932,
        -0.016856104281479, -0.018237131805180, -0.095131412547539, -0.086976587988652, 0.012339150609031,  0.014297639028627,  0.046613690197901,
        0.057783340564876,  -0.082355462898360, -0.026546745140541, 0.011313698646088,  0.015614800112892,  -0.067046557365519, -0.053947674545232};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 20, 28));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeDGForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix efxmat(20, 36);

    CDenseMatrix efymat(20, 36);

    CDenseMatrix efzmat(20, 36);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.011885256012755,  0.011283203704734,  0.000000000000000,  0.000000000000000,  0.096321539272257,
        0.056658158854561,  0.000000000000000,  0.000000000000000,  0.025295139532738,  -0.036644470332363, 0.000000000000000,  0.000000000000000,
        0.146198422437586,  0.040021501899015,  0.000000000000000,  0.000000000000000,  0.196601938964464,  0.192853643654489,  0.000000000000000,
        0.000000000000000,  0.004117502642774,  0.053617541670748,  0.000000000000000,  0.000000000000000,  0.164106785192920,  0.256755771039228,
        0.000000000000000,  0.000000000000000,  0.068295035137178,  0.134905885458978,  0.000000000000000,  0.000000000000000,  0.013643594089339,
        0.054239851777940,  0.000000000000000,  0.000000000000000,  -0.006995969617732, -0.014654755077496, 0.000000000000000,  0.000000000000000,
        0.048599887340154,  0.015483156082062,  0.000000000000000,  0.000000000000000,  0.013585184722957,  -0.011074721231029, 0.000000000000000,
        0.000000000000000,  0.071043010018966,  0.031134420647601,  0.000000000000000,  0.000000000000000,  0.101847818718429,  0.116850544235397,
        0.000000000000000,  0.000000000000000,  -0.042485641066233, 0.006389471490048,  0.000000000000000,  0.000000000000000,  0.107056429219124,
        0.184638722432351,  0.000000000000000,  0.000000000000000,  0.033265475189580,  0.082706796909282,  0.000000000000000,  0.000000000000000,
        0.020101950190122,  0.061649629056140,  -0.001340544375042, -0.001182101323894, -0.041416515866325, -0.013619458289060, -0.006314243850471,
        0.001969002148436,  -0.071218043080683, -0.031268022008570, 0.001817657748231,  0.001733117801385,  0.014406289729441,  -0.007136933919876,
        -0.009580438510568, -0.011596743739206, 0.026182363519909,  0.007806396106105,  0.027148732061012,  0.015785315583069,  0.019880268624551,
        0.012888021717789,  0.038867475522011,  0.011483276070869,  0.009247701292301,  0.000977655064967,  -0.060099095230663, -0.055139593082327,
        -0.016756595968372, -0.007806560679617, -0.043589421789329, -0.043109046156837, -0.021033332280330, -0.000628564659451, -0.031595760730941,
        -0.031608937524597, 0.042465352520745,  0.017676394622529,  0.022244229127252,  0.023078278988758,  -0.040256056550310, -0.034079895652133,
        0.031216427571015,  0.036205339849068,  -0.090961179591337, -0.093032256690036, -0.011340259009289, -0.010029876889044, -0.018707929066577,
        -0.042521605965630, -0.013003683786423, -0.015180055894711, 0.023455640837860,  0.012756472120510,  0.022204355079380,  0.019968839215169,
        0.036905064833600,  0.042254345172381,  0.030045792341971,  0.024559341548373,  0.003432600113203,  -0.002661007830096, -0.028295128438108,
        -0.030433959905839, -0.022845579473559, -0.015178180071792, -0.011716160239501, -0.015474180448228, -0.003145562180766, 0.015089804395607,
        -0.041654309758760, -0.045738873104634, 0.051507322272185,  0.054247851028291,  0.000000000000000,  0.000000000000000,  -0.028585702949952,
        -0.016962286952553, 0.000000000000000,  0.000000000000000,  0.025244335771744,  0.015662706619446,  0.000000000000000,  0.000000000000000,
        -0.013478001774499, -0.024777778908927, 0.000000000000000,  0.000000000000000,  0.050252619045454,  0.013766977651832,  0.000000000000000,
        0.000000000000000,  0.060043088368964,  -0.019783841745477, 0.000000000000000,  0.000000000000000,  0.007797749940026,  0.023962851760790,
        0.000000000000000,  0.000000000000000,  -0.027683269902629, -0.000334409742606, 0.000000000000000,  0.000000000000000,  -0.063716494767059,
        -0.024553867909641, 0.000000000000000,  0.000000000000000,  -0.056996486626745, -0.039746515421872, 0.000000000000000,  0.000000000000000,
        -0.023071477047751, -0.017573950121230, 0.000000000000000,  0.000000000000000,  0.024408007766067,  0.013632475810466,  0.000000000000000,
        0.000000000000000,  -0.010217796730871, -0.032934875737105, 0.000000000000000,  0.000000000000000,  0.029621766312500,  0.015551456298163,
        0.000000000000000,  0.000000000000000,  0.027667470960453,  -0.023482381534204, 0.000000000000000,  0.000000000000000,  0.009501852933760,
        0.027993873659935,  0.000000000000000,  0.000000000000000,  -0.014626293036211, -0.000037064420121, 0.000000000000000,  0.000000000000000,
        -0.050790102116365, -0.021218404997305, 0.000000000000000,  0.000000000000000,  -0.048665148023163, -0.041352917294286, 0.037828311663751,
        0.026073889704900,  -0.009044653652582, -0.003410630684890, 0.015588198424122,  0.004923622874818,  -0.115221826806026, -0.051332767917868,
        0.019862937694727,  0.010624903247452,  -0.053765673845509, -0.032913565283217, 0.014733966814967,  0.015477291318891,  0.171990552744018,
        0.065267505767581,  -0.034633323902294, -0.020589947633544, -0.009935795927648, 0.007151402297108,  0.013101777927459,  -0.002224758972502,
        0.018785500475289,  0.002114497933127,  0.038881548908117,  0.014247532470673,  -0.165731545708711, -0.066769500771021, 0.068536401324881,
        0.046210999724449,  0.022248445862123,  0.013810501899129,  0.031497264958369,  0.024093769091729,  0.030450860790419,  0.014981760061900,
        0.014689787941694,  0.013857030648389,  -0.010136181435184, -0.003204991995125, -0.006742639158355, -0.005139986138487, -0.149534272401285,
        -0.133718007481937, 0.020624991697237,  0.025908741760640,  -0.093598041361890, -0.138507239631920, 0.005864300914950,  0.006857831223546,
        0.192627495766880,  0.121319984970412,  -0.001757124170684, -0.002183379107541, 0.019150740417581,  0.036764845074798,  -0.019227247616134,
        -0.020996908422819, 0.007497319564657,  -0.016441833202387, -0.008010664576510, -0.010513074318517, -0.196068338241717, -0.139941956224679,
        0.018333709913521,  0.013592586707619,  0.039113416960612,  0.065666221194129,  0.024489060074909,  0.023309932014206,  0.043407448389207,
        0.042500687255567,  0.000000000000000,  0.000000000000000,  -0.020652777070103, 0.001951256766643,  0.000000000000000,  0.000000000000000,
        -0.026439776466452, 0.086199173656037,  0.000000000000000,  0.000000000000000,  0.090199956778452,  0.128537761279381,  0.000000000000000,
        0.000000000000000,  -0.084470191070331, -0.055088805822438, 0.000000000000000,  0.000000000000000,  -0.101958825125040, -0.071141907232810,
        0.000000000000000,  0.000000000000000,  0.102803997804524,  0.044829430480213,  0.000000000000000,  0.000000000000000,  0.076589710022345,
        0.118877289982355,  0.000000000000000,  0.000000000000000,  -0.009700643403789, -0.026996935647630, 0.000000000000000,  0.000000000000000,
        0.041629764925726,  -0.008410848767451, 0.000000000000000,  0.000000000000000,  -0.015726194002125, -0.001291579384961, 0.000000000000000,
        0.000000000000000,  -0.028740120199940, 0.050627174664987,  0.000000000000000,  0.000000000000000,  0.061920947017349,  0.089126794285495,
        0.000000000000000,  0.000000000000000,  -0.036286738289792, -0.026111303759207, 0.000000000000000,  0.000000000000000,  -0.055234416362811,
        -0.039212496660734, 0.000000000000000,  0.000000000000000,  0.072154118611446,  0.017803703287263,  0.000000000000000,  0.000000000000000,
        0.042168569403128,  0.075693045891536,  0.000000000000000,  0.000000000000000,  -0.003823732922308, -0.017148924833194, 0.000000000000000,
        0.000000000000000,  0.035707135068243,  0.003191987036577,  0.001196617722428,  -0.000773473222193, -0.004019431608391, -0.002294477472328,
        0.050648752452391,  0.019504913713758,  -0.030372851247738, -0.018169006186381, -0.000393311591215, -0.012370125851978, -0.017569457364606,
        -0.014550188197780, -0.018538890964908, -0.003516797540552, 0.171714544990124,  0.063765693386900,  -0.000868383523038, 0.013043915673053,
        0.120595095731362,  0.045301683413859,  -0.069724797204441, -0.039511341188223, -0.052471203754110, -0.025354704606484, -0.017099089577243,
        -0.021636518847164, -0.118858513348877, -0.051985398519745, -0.042040261662826, -0.023311380583841, -0.014653721030870, -0.004303700153384,
        -0.044286113254135, -0.025072904997145, 0.000515565711918,  0.001867795873846,  0.002679740807098,  0.002136327553555,  -0.006674940397725,
        -0.004279218129428, 0.011707287096854,  0.007816618890784,  -0.052343467591436, -0.048255009655264, -0.008311732888493, -0.007122333379428,
        -0.040677243500726, -0.075233094762924, -0.001492322555322, 0.001771634153614,  0.188417936938696,  0.113485252638829,  0.008519714667757,
        0.010078519512841,  0.133066007315949,  0.106854079866999,  0.007703995775951,  0.016601862190301,  -0.072790184096596, -0.105908182527279,
        -0.003992081905903, -0.004356025308656, -0.151944575493316, -0.120805205051272, -0.006109228488577, -0.004784247177524, -0.013138812353571,
        0.000522708785884,  -0.016367612906806, -0.014293358710024, 0.005209075556236,  0.005591795432063,  0.000000000000000,  0.000000000000000,
        0.060592736930296,  0.034686709159196,  0.000000000000000,  0.000000000000000,  0.026884899435899,  0.026299966146533,  0.000000000000000,
        0.000000000000000,  0.041279543944596,  -0.046873413271158, 0.000000000000000,  0.000000000000000,  0.005359817311516,  -0.228123028793546,
        0.000000000000000,  0.000000000000000,  -0.166412938521970, -0.120391428388492, 0.000000000000000,  0.000000000000000,  -0.058116379075654,
        -0.116598339212732, 0.000000000000000,  0.000000000000000,  -0.097117659517724, -0.006049773428198, 0.000000000000000,  0.000000000000000,
        0.019332556464527,  -0.001222130977995, 0.000000000000000,  0.000000000000000,  -0.008669797427427, -0.020623740815880, 0.000000000000000,
        0.000000000000000,  0.056784216368956,  0.040725430988788,  0.000000000000000,  0.000000000000000,  0.026715030149190,  0.021277135773874,
        0.000000000000000,  0.000000000000000,  -0.002122745280852, -0.033426770507322, 0.000000000000000,  0.000000000000000,  -0.024977218184051,
        -0.162444373219704, 0.000000000000000,  0.000000000000000,  -0.088432404334729, -0.062372770750822, 0.000000000000000,  0.000000000000000,
        -0.041241857848343, -0.065993282106353, 0.000000000000000,  0.000000000000000,  -0.044436422817422, -0.019096009300679, 0.000000000000000,
        0.000000000000000,  0.040965162755292,  0.007551059548377,  0.000000000000000,  0.000000000000000,  -0.005575225316062, -0.017034947820545,
        -0.053873876753120, -0.035462281651682, -0.020841743190153, -0.008461413562988, -0.067812547060896, -0.047734850163801, -0.075100330447797,
        -0.037399678297803, 0.021461827487573,  0.011184969461319,  0.003825029059886,  -0.019136939648888, 0.031195552497534,  0.030105217815824,
        0.018785500475289,  0.002114497933127,  0.031001523726871,  0.020121715467801,  0.077897120634642,  0.036449815611840,  0.060029497708440,
        0.046005683999416,  0.056284636447048,  0.007399645475930,  -0.018508224680359, -0.006188482259711, -0.090259594491082, -0.038484704709578,
        -0.047697080485373, -0.022721044443779, -0.043044465852519, -0.009292763349525, 0.020891764272205,  0.018260078776947,  0.011826798573145,
        0.007632070360832,  -0.029417949493597, -0.027308269837145, -0.024787083430362, -0.021575332641100, -0.017083025596692, -0.012863317395602,
        -0.108243550115071, -0.111975869862367, 0.007823100844254,  0.008796880915652,  -0.052414006047294, -0.090958253707096, 0.011924688272469,
        0.013343084268453,  0.007497319564657,  -0.016441833202387, -0.018930923134536, -0.023292555955625, 0.105702265867730,  0.110345008410396,
        0.006418205312583,  0.007052933338069,  0.024189216027150,  -0.008214936345579, 0.022370002654337,  0.028339523673393,  -0.112357330522098,
        -0.105387504414765, -0.014168109363580, -0.009797215112504, -0.028566647640943, -0.011462603742135, 0.009999705929182,  0.010121475528509,
        0.021865617531937,  0.024151360356236,  0.000000000000000,  0.000000000000000,  -0.018973136929280, -0.061876193266490, 0.000000000000000,
        0.000000000000000,  -0.113930795906007, -0.163022280900859, 0.000000000000000,  0.000000000000000,  -0.180765427399488, -0.240841402330939,
        0.000000000000000,  0.000000000000000,  0.205146186702765,  0.146216131137512,  0.000000000000000,  0.000000000000000,  -0.019911685854892,
        0.090904066219744,  0.000000000000000,  0.000000000000000,  -0.055392645245404, -0.061523547353682, 0.000000000000000,  0.000000000000000,
        -0.137213668305967, -0.145057908694453, 0.000000000000000,  0.000000000000000,  0.074187936470035,  0.030694005247501,  0.000000000000000,
        0.000000000000000,  0.016858251274937,  0.013165893294989,  0.000000000000000,  0.000000000000000,  -0.019350101191977, -0.065135273184259,
        0.000000000000000,  0.000000000000000,  -0.048927901420123, -0.097468360479946, 0.000000000000000,  0.000000000000000,  -0.124423320968896,
        -0.178073327403155, 0.000000000000000,  0.000000000000000,  0.112645578599609,  0.099927394296621,  0.000000000000000,  0.000000000000000,
        -0.035095678608364, 0.041881252008727,  0.000000000000000,  0.000000000000000,  -0.030395979133903, -0.029934816458258, 0.000000000000000,
        0.000000000000000,  -0.045261084793541, -0.068643006600352, 0.000000000000000,  0.000000000000000,  0.046425005387462,  0.002486874551341,
        0.000000000000000,  0.000000000000000,  -0.004905978356124, -0.013666587067200, 0.024654588450234,  0.028835504127538,  -0.033299016621525,
        -0.012543303460905, 0.025128317472699,  0.035596392353774,  0.034622676713065,  0.009849727109584,  0.054236707480515,  0.048234811571844,
        -0.016756595968372, -0.007806560679617, -0.006650466218523, -0.005906650547425, -0.021598048329159, -0.012235564856315, 0.015460191761038,
        -0.000453577020803, 0.025241688629474,  0.009664636457591,  -0.041736338902528, -0.030557403415889, 0.005509019981830,  -0.000084924520875,
        -0.034406000617422, -0.009760176971791, 0.053661745953829,  0.017779912591897,  -0.017191803670935, -0.000587918153489, -0.041701352276637,
        -0.015651284424477, 0.001325917893327,  0.000206583235493,  -0.040595297993968, -0.013581232423580, 0.039631919594115,  0.044189916020072,
        -0.036685974608933, -0.040590062937236, 0.007027402302087,  0.011934694761743,  0.029478734841901,  0.014503115897639,  0.031119555958944,
        0.032367025525618,  -0.022845579473559, -0.015178180071792, 0.000298460585050,  -0.000058844022446, -0.035514775974370, -0.026269557262863,
        0.020953214296370,  0.017180260861709,  0.028427303835730,  0.022421589220215,  -0.024806458524791, -0.025554340527071, -0.000016749950457,
        0.002244553727799,  -0.027119174294669, -0.022316228845006, 0.052772267050483,  0.030148034913274,  0.026846379770161,  0.033019859876126,
        -0.045703801471697, -0.054344532177685, 0.022704486717041,  0.023449325590335,  -0.040069235591989, -0.035301818225401};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 20, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.002590004341459,  0.036418221353295,  0.000000000000000,  0.000000000000000,  -0.107227634235531,
        -0.162466259364259, 0.000000000000000,  0.000000000000000,  -0.041796382726669, -0.122802037677593, 0.000000000000000,  0.000000000000000,
        0.085346755037342,  0.066598146818149,  0.000000000000000,  0.000000000000000,  0.247206147897746,  0.157542195423441,  0.000000000000000,
        0.000000000000000,  -0.058602254979121, -0.087233859526994, 0.000000000000000,  0.000000000000000,  -0.206525985444624, -0.221199985669730,
        0.000000000000000,  0.000000000000000,  -0.036868667641242, 0.066112026613027,  0.000000000000000,  0.000000000000000,  0.029366464729866,
        0.078540619229779,  0.000000000000000,  0.000000000000000,  0.016272251476634,  0.051757925760538,  0.000000000000000,  0.000000000000000,
        -0.045055622465930, -0.096992257143076, 0.000000000000000,  0.000000000000000,  -0.002357280829796, -0.051611973757300, 0.000000000000000,
        0.000000000000000,  0.008784665570900,  0.018297549379809,  0.000000000000000,  0.000000000000000,  0.147124872289709,  0.105607371142730,
        0.000000000000000,  0.000000000000000,  -0.044190933246180, -0.057100107053651, 0.000000000000000,  0.000000000000000,  -0.112730684639950,
        -0.150688196484771, 0.000000000000000,  0.000000000000000,  -0.023869661182466, 0.058419692962325,  0.000000000000000,  0.000000000000000,
        0.017763605508011,  0.064129590208888,  -0.025846769664198, -0.024955707403962, 0.046311454726502,  0.018249209492114,  0.027282231279303,
        0.037014938632861,  0.039272937303392,  0.011726118773680,  -0.013883503644430, 0.000062005454769,  0.061203083148550,  0.011360976103171,
        0.052168407959057,  0.023296577165719,  0.027580947306575,  0.009911702193991,  0.020129126204498,  0.018967482755006,  0.004031838406286,
        0.007766920648476,  -0.009580438510568, -0.011596743739206, 0.036541884621594,  0.014280180515941,  0.017243569743229,  0.026763024764947,
        0.014128807530544,  0.010172649488700,  -0.027611884944020, -0.038249337853875, 0.036598956843925,  0.022290404017323,  -0.032941642418223,
        -0.036049370755622, 0.011182985923804,  0.006424427105464,  -0.040082716053939, -0.043447823463635, 0.053316698046145,  0.054377995960928,
        0.007108470739223,  0.012028772097823,  0.035028589892846,  0.017211245530159,  -0.027158666662432, -0.022802653492279, 0.035729055188275,
        -0.007647844712874, 0.029448871171872,  0.024677029593265,  0.029591154478035,  0.013362415020634,  0.010071894993856,  0.010337404565295,
        0.021661894032660,  0.032591082085207,  -0.013003683786423, -0.015180055894711, 0.042151889831156,  0.027971343651759,  0.011859506275717,
        0.014690271517930,  0.028990988337900,  0.032899506092587,  -0.039225489583598, -0.047856921161099, 0.063727680193398,  0.086620860228224,
        -0.030461185913216, -0.035002039986375, 0.018386594001256,  0.027255851986788,  0.000000000000000,  0.000000000000000,  -0.043920534178028,
        -0.044019988486516, 0.000000000000000,  0.000000000000000,  -0.021407348086233, -0.019563126778687, 0.000000000000000,  0.000000000000000,
        0.096646083749855,  -0.046204593785946, 0.000000000000000,  0.000000000000000,  -0.019593389985326, -0.178209894102140, 0.000000000000000,
        0.000000000000000,  -0.116377031547833, -0.136877963176390, 0.000000000000000,  0.000000000000000,  0.048627330626447,  -0.154290276051058,
        0.000000000000000,  0.000000000000000,  0.039648647978370,  0.044832276368658,  0.000000000000000,  0.000000000000000,  -0.047328930029485,
        -0.033210603568771, 0.000000000000000,  0.000000000000000,  0.025203065156759,  0.011368238816287,  0.000000000000000,  0.000000000000000,
        -0.035069850263058, -0.041307091803690, 0.000000000000000,  0.000000000000000,  -0.031458404806840, -0.018803234758586, 0.000000000000000,
        0.000000000000000,  0.027129840791570,  -0.033352641667079, 0.000000000000000,  0.000000000000000,  -0.026931990237524, -0.103656612372220,
        0.000000000000000,  0.000000000000000,  -0.065376178534351, -0.081941422029325, 0.000000000000000,  0.000000000000000,  0.006635718900626,
        -0.111407374954930, 0.000000000000000,  0.000000000000000,  0.034016799687956,  0.046920764373346,  0.000000000000000,  0.000000000000000,
        -0.016721247838413, -0.020195442515406, 0.000000000000000,  0.000000000000000,  0.027108638371078,  0.016458134179100,  0.049457306258177,
        0.038956440362916,  0.020539252484212,  0.012370191106115,  0.070504715906853,  0.045672733055029,  0.078751389647389,  0.034398347018562,
        0.030854553317311,  0.015599059190668,  0.077639208408467,  0.010235005630158,  0.080949644287577,  0.062119245161638,  0.165630752899815,
        0.046111309099946,  0.002140420474959,  0.002963425773181,  0.069617290694936,  0.042409317526097,  0.014733966814967,  0.015477291318891,
        0.066659532469688,  0.024750892546118,  -0.003290267321676, -0.004971529678617, 0.056316162212602,  0.042193843884048,  0.033937106383815,
        0.033260754110835,  0.024383496610160,  0.024632900998981,  -0.025271530013024, -0.014795038054974, -0.012126768523203, -0.003755865963898,
        0.026128566282701,  0.025426813604315,  0.035484485220462,  0.040331382713232,  0.018076874637669,  0.013314771749990,  0.100291814516328,
        0.093619080223668,  0.006639532038105,  0.007578631451823,  0.034421685749602,  -0.046161553881474, 0.006499071068831,  0.007523062573968,
        0.139226923555691,  0.049761716854405,  -0.020395193276773, -0.025112038545243, 0.121661216215714,  0.140982379306061,  0.005864300914950,
        0.006857831223546,  0.073626946053081,  0.030428192113591,  -0.028396099688654, -0.035162653826508, 0.119854130646136,  0.162520757576669,
        0.009088436487475,  0.007489781745634,  0.069208851812297,  0.105286195228816,  -0.013261677613321, -0.011987252959398, -0.011257360756754,
        -0.005551610701371, 0.000000000000000,  0.000000000000000,  0.036304783661201,  -0.008280721242968, 0.000000000000000,  0.000000000000000,
        0.019475082215688,  -0.039557965450910, 0.000000000000000,  0.000000000000000,  0.047474531054832,  0.060164572291818,  0.000000000000000,
        0.000000000000000,  0.032412171912581,  -0.001077907705153, 0.000000000000000,  0.000000000000000,  -0.152938237687560, -0.106712860849215,
        0.000000000000000,  0.000000000000000,  -0.084470191070331, -0.055088805822438, 0.000000000000000,  0.000000000000000,  -0.095896404837313,
        -0.140025032131878, 0.000000000000000,  0.000000000000000,  -0.002981123317895, -0.073532588980461, 0.000000000000000,  0.000000000000000,
        -0.005404713216138, -0.001314485191918, 0.000000000000000,  0.000000000000000,  0.031986230316688,  0.002907998131840,  0.000000000000000,
        0.000000000000000,  0.018425440777910,  -0.022705635152589, 0.000000000000000,  0.000000000000000,  0.040597602069339,  0.046898491291966,
        0.000000000000000,  0.000000000000000,  0.041915170036619,  -0.003955716512077, 0.000000000000000,  0.000000000000000,  -0.082851624544216,
        -0.058818744991101, 0.000000000000000,  0.000000000000000,  -0.036286738289792, -0.026111303759207, 0.000000000000000,  0.000000000000000,
        -0.062228310191351, -0.094760511489758, 0.000000000000000,  0.000000000000000,  0.006303978653502,  -0.045023769300891, 0.000000000000000,
        0.000000000000000,  -0.002481839905074, -0.000098104025923, -0.047465504370413, -0.027490655066165, -0.001152690928546, 0.001046542065227,
        -0.012555561519490, -0.001927526723842, 0.023805214003140,  0.012418432489544,  0.012689239849267,  0.002053071185229,  0.070706675940882,
        0.022827007653704,  -0.085173873008531, -0.042442005805350, 0.090624250404326,  0.027783373215933,  -0.001302575284557, 0.019565873509579,
        0.180892643597043,  0.067952525120789,  -0.018538890964908, -0.003516797540552, 0.171714544990124,  0.063765693386900,  0.006221463000749,
        0.017005045640925,  0.054658298747385,  0.029187398101281,  -0.080381223185167, -0.041068463824682, -0.008409268114289, 0.001306351420403,
        -0.016754785725854, -0.011057648017189, -0.004144086542079, -0.001724280919032, -0.016590108246074, -0.014574426653664, 0.002801231484677,
        0.004235765940487,  -0.004375360185757, -0.002633343105051, 0.036078729320792,  0.028101902670144,  -0.006732750145990, -0.005049912210102,
        0.068902155481181,  0.004190610062658,  0.006460393646516,  0.018078223984980,  0.084224763352317,  -0.011337138661589, 0.012779572001635,
        0.015117779269262,  0.199599010973924,  0.160281119800498,  -0.001492322555322, 0.001771634153614,  0.188417936938696,  0.113485252638829,
        0.007775515189346,  0.006986572898710,  0.083886386517476,  0.099688797719997,  -0.013455725721547, -0.009985597787396, 0.002712333129894,
        0.020444057839203,  -0.003768508983683, -0.003511717408905, -0.005107706411459, -0.002356434382625, 0.000000000000000,  0.000000000000000,
        -0.028585702949952, -0.016962286952553, 0.000000000000000,  0.000000000000000,  0.025244335771744,  0.015662706619446,  0.000000000000000,
        0.000000000000000,  -0.013478001774499, -0.024777778908927, 0.000000000000000,  0.000000000000000,  0.050252619045454,  0.013766977651832,
        0.000000000000000,  0.000000000000000,  0.060043088368964,  -0.019783841745477, 0.000000000000000,  0.000000000000000,  0.007797749940026,
        0.023962851760790,  0.000000000000000,  0.000000000000000,  -0.027683269902629, -0.000334409742606, 0.000000000000000,  0.000000000000000,
        -0.063716494767059, -0.024553867909641, 0.000000000000000,  0.000000000000000,  -0.056996486626745, -0.039746515421872, 0.000000000000000,
        0.000000000000000,  -0.023071477047751, -0.017573950121230, 0.000000000000000,  0.000000000000000,  0.024408007766067,  0.013632475810466,
        0.000000000000000,  0.000000000000000,  -0.010217796730871, -0.032934875737105, 0.000000000000000,  0.000000000000000,  0.029621766312500,
        0.015551456298163,  0.000000000000000,  0.000000000000000,  0.027667470960453,  -0.023482381534204, 0.000000000000000,  0.000000000000000,
        0.009501852933760,  0.027993873659935,  0.000000000000000,  0.000000000000000,  -0.014626293036211, -0.000037064420121, 0.000000000000000,
        0.000000000000000,  -0.050790102116365, -0.021218404997305, 0.000000000000000,  0.000000000000000,  -0.048665148023163, -0.041352917294286,
        0.000848507344817,  0.002050708730869,  0.016835057286785,  0.008276690526208,  -0.102185590126653, -0.063856847114568, 0.031305165058879,
        0.010866174049312,  -0.016451988824428, -0.003087244532004, 0.053588039516509,  0.010489374826365,  0.002671450434917,  -0.006076026539992,
        0.066659532469688,  0.024750892546118,  -0.034633323902295, -0.020589947633544, -0.009935795927648, 0.007151402297108,  0.031195552497534,
        0.030105217815824,  0.176782030886784,  0.062889417765321,  -0.048274274737856, -0.018661622200022, 0.091917366360131,  0.037397555491975,
        0.045493703564947,  0.032753951248265,  0.050916770357431,  0.025979860110099,  0.068787823935446,  0.048318825536129,  0.004353673288537,
        0.003196226067515,  0.008289821628019,  0.007924708129673,  0.023969226904575,  0.023495169709888,  -0.016599957815390, -0.012224463157402,
        0.032403906063205,  0.007437019539672,  0.027793699180225,  0.035177240969333,  0.033610702257501,  -0.040554234372030, -0.014903656344118,
        -0.016035497237303, 0.073626946053081,  0.030428192113591,  -0.001757124170684, -0.002183379107541, 0.019150740417581,  0.036764845074798,
        0.011924688272469,  0.013343084268453,  0.185998144135355,  0.119895856082844,  0.009194233382659,  0.011731323782346,  0.109232646444820,
        0.095145256399057,  0.016405104089318,  0.012206493377831,  0.074710017094969,  0.093283509089661,  0.030942807618110,  0.029292105982659,
        0.009015439979366,  0.015576154443790,  0.000000000000000,  0.000000000000000,  -0.031214941564679, -0.077223764924976, 0.000000000000000,
        0.000000000000000,  -0.018214051101604, -0.094809281251442, 0.000000000000000,  0.000000000000000,  0.023388822950316,  0.110531463243715,
        0.000000000000000,  0.000000000000000,  0.018115871212023,  0.011433677149975,  0.000000000000000,  0.000000000000000,  -0.144339754099817,
        -0.179815748810287, 0.000000000000000,  0.000000000000000,  -0.286375439097333, -0.159196736284912, 0.000000000000000,  0.000000000000000,
        -0.126081410433175, -0.149751530862630, 0.000000000000000,  0.000000000000000,  -0.074998196807654, -0.135461906995578, 0.000000000000000,
        0.000000000000000,  0.012550113150202,  0.044438664334823,  0.000000000000000,  0.000000000000000,  -0.019614238706371, -0.063625928732585,
        0.000000000000000,  0.000000000000000,  0.002660751037064,  -0.073756240895296, 0.000000000000000,  0.000000000000000,  0.041589148818730,
        0.091119836738900,  0.000000000000000,  0.000000000000000,  0.044438052256959,  0.019648557762484,  0.000000000000000,  0.000000000000000,
        -0.066195971803588, -0.104382390491787, 0.000000000000000,  0.000000000000000,  -0.163915885236742, -0.111835472186382, 0.000000000000000,
        0.000000000000000,  -0.045156569276079, -0.067964617989772, 0.000000000000000,  0.000000000000000,  -0.037137754143773, -0.083182900246152,
        0.000000000000000,  0.000000000000000,  0.018195385423622,  0.055572463628317,  0.033416174422431,  0.035994471773871,  -0.015094105479675,
        -0.008295711111428, 0.006146850252930,  0.028719611566581,  -0.029940431018899, -0.015896992608195, -0.058980298730890, -0.042153245004500,
        0.014128807530544,  0.010172649488700,  0.003804720785416,  0.016065797900644,  -0.020854290231362, -0.004452307670357, -0.026235244887291,
        -0.011985543018237, -0.024030021929088, -0.013259313941312, -0.006650466218523, -0.005906650547425, 0.003264802314885,  0.003301517727291,
        -0.034999010659357, -0.012102594210378, 0.040898970376356,  0.004603491904861,  0.041435507982725,  0.041690499877750,  0.016383071690004,
        -0.001247827004645, -0.017417666693034, -0.021202337605542, 0.040357534026884,  0.014412335818750,  0.030838944212514,  0.035277348792181,
        -0.023847582723422, -0.031233702528294, 0.034456953208901,  0.044209007905738,  -0.045750386684079, -0.061244835721138, -0.027750283322318,
        -0.027177052103042, 0.028990988337900,  0.032899506092587,  0.000017015394023,  0.005039185884722,  -0.013743147795892, -0.006703473390523,
        -0.024333308855959, -0.021307658925337, -0.038228731968983, -0.040264661785752, 0.000298460585050,  -0.000058844022446, 0.009356221609539,
        0.010246134412133,  -0.030530483293505, -0.025716505108797, 0.015367451787585,  -0.010912511865660, 0.011635091802365,  0.015380103112149,
        -0.002404292870179, -0.017797934028128, -0.038004323548220, -0.041833877448133, 0.042329208373203,  0.042590992662471};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 20, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.028585702949952, -0.016962286952553, 0.000000000000000,  0.000000000000000,  0.025244335771744,
        0.015662706619446,  0.000000000000000,  0.000000000000000,  -0.013478001774499, -0.024777778908927, 0.000000000000000,  0.000000000000000,
        0.050252619045454,  0.013766977651832,  0.000000000000000,  0.000000000000000,  0.060043088368964,  -0.019783841745477, 0.000000000000000,
        0.000000000000000,  0.007797749940026,  0.023962851760790,  0.000000000000000,  0.000000000000000,  -0.027683269902629, -0.000334409742606,
        0.000000000000000,  0.000000000000000,  -0.063716494767059, -0.024553867909641, 0.000000000000000,  0.000000000000000,  -0.056996486626745,
        -0.039746515421872, 0.000000000000000,  0.000000000000000,  -0.023071477047751, -0.017573950121230, 0.000000000000000,  0.000000000000000,
        0.024408007766067,  0.013632475810466,  0.000000000000000,  0.000000000000000,  -0.010217796730871, -0.032934875737105, 0.000000000000000,
        0.000000000000000,  0.029621766312500,  0.015551456298163,  0.000000000000000,  0.000000000000000,  0.027667470960453,  -0.023482381534204,
        0.000000000000000,  0.000000000000000,  0.009501852933760,  0.027993873659935,  0.000000000000000,  0.000000000000000,  -0.014626293036211,
        -0.000037064420121, 0.000000000000000,  0.000000000000000,  -0.050790102116365, -0.021218404997305, 0.000000000000000,  0.000000000000000,
        -0.048665148023163, -0.041352917294286, -0.011994697864997, -0.012827035700520, -0.028374592453595, -0.008781164481172, 0.026783664253582,
        0.034207055492402,  0.059502910471922,  0.016259104027094,  -0.000401060083056, 0.013020403825331,  0.089470160789660,  0.023773848913278,
        0.030930585182243,  0.006883996146576,  0.002111145572903,  -0.001624547931319, 0.178624121972769,  0.131202648561780,  -0.049247414507529,
        -0.017414882282057, -0.071088963164714, -0.066919656281481, -0.005254302102812, -0.003600524300465, -0.029361749240852, -0.018230413576771,
        -0.019645422662239, -0.006890574635213, -0.055899153454405, -0.061089074157605, -0.110157083970234, -0.032381211276187, -0.025056913239365,
        -0.028328106490242, -0.060045239210192, -0.017825073499687, -0.002831631030021, -0.004119456078642, -0.026173514834417, -0.014678630772404,
        0.025169378481909,  0.030285591598605,  0.048939679467629,  0.018018599713761,  0.038307400957664,  0.046431283578579,  0.072694399448475,
        -0.010896910669794, -0.017364005530259, -0.019749610190573, -0.003642418615236, -0.029170376611448, 0.053200507546582,  0.052278451898063,
        -0.051796536206951, -0.020971532939920, -0.047418927648394, -0.049784896874023, -0.009739133726513, -0.028280281211792, -0.003676968352852,
        -0.003347711423099, -0.020669670563328, -0.004589445416171, -0.039239911917076, -0.046801967625539, -0.097160470319306, -0.036638758192052,
        -0.006655512109195, -0.009723762123982, -0.053204645981584, -0.030538506261808, 0.000000000000000,  0.000000000000000,  0.105981927436430,
        0.074164338713575,  0.000000000000000,  0.000000000000000,  0.148267422253013,  0.082951034100972,  0.000000000000000,  0.000000000000000,
        0.084134616434897,  -0.042967837550999, 0.000000000000000,  0.000000000000000,  0.184222079761811,  0.026720833837846,  0.000000000000000,
        0.000000000000000,  0.076044894969382,  0.187837295652909,  0.000000000000000,  0.000000000000000,  0.144186279081242,  0.117397667342901,
        0.000000000000000,  0.000000000000000,  0.124090750184675,  0.163976831917982,  0.000000000000000,  0.000000000000000,  0.138129774894610,
        0.143005612328319,  0.000000000000000,  0.000000000000000,  -0.008267756951553, 0.007524432304918,  0.000000000000000,  0.000000000000000,
        0.068020045139742,  0.054007974167752,  0.000000000000000,  0.000000000000000,  0.077852935882281,  0.049912083274951,  0.000000000000000,
        0.000000000000000,  0.042313145353785,  -0.020963988253917, 0.000000000000000,  0.000000000000000,  0.099204161873319,  0.004634360905861,
        0.000000000000000,  0.000000000000000,  0.024540567321814,  0.119355879965159,  0.000000000000000,  0.000000000000000,  0.058579769811633,
        0.072998838913620,  0.000000000000000,  0.000000000000000,  0.044430403574626,  0.088473319970647,  0.000000000000000,  0.000000000000000,
        0.081322040651049,  0.087906241178030,  0.000000000000000,  0.000000000000000,  -0.002392108045340, 0.005907244270498,  0.017509839435011,
        0.013500215950969,  -0.031773947779158, -0.010689897553285, 0.040080426380946,  0.022791295134890,  -0.013711685403661, -0.002408323441791,
        0.014091631794267,  0.006325333835657,  0.199864132297329,  0.055254622233605,  0.055883968671235,  0.042456205573131,  0.075458239721735,
        0.000893804938698,  -0.006089688736305, -0.040576417737122, -0.142403358525220, -0.048342609612964, 0.038412425857755,  -0.001796949348471,
        0.042554701287081,  0.005404251565740,  0.058097526250438,  0.017702239391756,  -0.144398210746072, -0.035680679570398, 0.043168062074503,
        0.028879328784526,  -0.147152700045005, -0.045797703579729, -0.000695904294210, 0.000190306006017,  -0.017077062378632, -0.006244191743141,
        0.000829364599355,  0.000830778204108,  -0.031894463327716, -0.013240688029918, 0.008330309955452,  0.006412284056349,  -0.007402749080861,
        -0.003201217322819, -0.002368554451060, 0.002733590812990,  0.168215838049949,  0.006861567738549,  0.039494174346432,  0.050140755375687,
        0.009643978240485,  -0.136417486519130, -0.029838538990373, -0.041131331805478, -0.143619744911637, -0.071003579119037, -0.008465125858531,
        -0.013129344325585, 0.019040722268577,  -0.047434716249222, 0.006772101565022,  -0.005080468203737, -0.109230483216805, 0.001663877627608,
        0.014725375166561,  0.011692561457391,  -0.137478146348387, -0.044262838341434, 0.000090804982601,  0.000098222420227,  -0.018580497183975,
        -0.007584080955479, 0.000000000000000,  0.000000000000000,  -0.072522911069222, -0.021193255636765, 0.000000000000000,  0.000000000000000,
        0.043291185261938,  0.006050918832400,  0.000000000000000,  0.000000000000000,  0.156281049076133,  -0.070305713465462, 0.000000000000000,
        0.000000000000000,  -0.093085797844948, -0.204373531720469, 0.000000000000000,  0.000000000000000,  -0.134780635701855, -0.123419396429426,
        0.000000000000000,  0.000000000000000,  -0.062057198563299, -0.136249021146979, 0.000000000000000,  0.000000000000000,  -0.065117103781722,
        0.029294047277276,  0.000000000000000,  0.000000000000000,  -0.221266058005460, -0.030926918476714, 0.000000000000000,  0.000000000000000,
        -0.071918553476979, -0.021016645173126, 0.000000000000000,  0.000000000000000,  -0.041177489000018, -0.015011208149372, 0.000000000000000,
        0.000000000000000,  0.021073130614317,  0.002651457664122,  0.000000000000000,  0.000000000000000,  0.048412896914781,  -0.057532564560393,
        0.000000000000000,  0.000000000000000,  -0.058358999424029, -0.125766039920964, 0.000000000000000,  0.000000000000000,  -0.032341187344344,
        -0.077404340289002, 0.000000000000000,  0.000000000000000,  -0.038905999616019, -0.083844026613976, 0.000000000000000,  0.000000000000000,
        -0.020172040381159, 0.023971901900164,  0.000000000000000,  0.000000000000000,  -0.107707112028733, -0.013551894727734, 0.000000000000000,
        0.000000000000000,  -0.040834343258352, -0.014886114748127, -0.010512015838288, -0.007623866254945, -0.002411136122860, -0.000858562848764,
        0.012096863702184,  0.007738386801869,  0.006636054255825,  0.001833128620934,  0.083240392507376,  0.049200952210183,  0.120586003695772,
        0.026838616729248,  -0.018151160633037, -0.000441424182427, 0.145156539233387,  0.016838071571821,  -0.090106477456476, -0.023033946120037,
        -0.049903408928615, -0.035153667207245, -0.012100773755358, -0.000294282788284, 0.096771026155592,  0.011225381047881,  -0.034683496878073,
        -0.020500396754243, -0.050244168206572, -0.011182756970520, -0.061828414477828, -0.039551754765107, -0.033917610640884, -0.009369324062550,
        -0.010424415706303, -0.007560334036154, -0.002391043321836, -0.000851408158358, -0.000618166404004, -0.000766849843022, -0.002655079382824,
        0.001826008389819,  0.002705343616742,  0.002577852394683,  0.005655127001396,  -0.001600447281839, 0.020372149000606,  0.020410652455123,
        0.083796408317218,  -0.027115016459066, 0.006286348427873,  0.017877105741353,  0.057775633619905,  -0.100355769394647, 0.020177112780982,
        0.038657952522264,  -0.100502816745995, -0.131639504925904, 0.004190898951915,  0.011918070494235,  0.038517089079937,  -0.066903846263098,
        -0.008488395416919, -0.008504438522968, -0.034915170132174, 0.011297923524611,  -0.013827311818901, -0.013175690017271, -0.028903982451580,
        0.008180063884956,  -0.000613015017304, -0.000760459427664, -0.002632953721300, 0.001810791653237,  0.000000000000000,  0.000000000000000,
        -0.052154791790633, -0.022078296054757, 0.000000000000000,  0.000000000000000,  -0.266953466322197, -0.176187191922409, 0.000000000000000,
        0.000000000000000,  -0.066330902145362, -0.141009506781485, 0.000000000000000,  0.000000000000000,  0.144186279081242,  0.117397667342901,
        0.000000000000000,  0.000000000000000,  0.050696596646255,  0.125224863768606,  0.000000000000000,  0.000000000000000,  0.064066847194110,
        -0.071110555614571, 0.000000000000000,  0.000000000000000,  -0.211082384654922, -0.160356388248646, 0.000000000000000,  0.000000000000000,
        0.020517261587323,  0.050045967670165,  0.000000000000000,  0.000000000000000,  0.118329583963309,  0.077138495124765,  0.000000000000000,
        0.000000000000000,  -0.030316416736708, -0.015614428540481, 0.000000000000000,  0.000000000000000,  -0.143762872287987, -0.106771778859599,
        0.000000000000000,  0.000000000000000,  -0.019530375511864, -0.075313165142238, 0.000000000000000,  0.000000000000000,  0.058579769811633,
        0.072998838913620,  0.000000000000000,  0.000000000000000,  0.016360378214542,  0.079570586643440,  0.000000000000000,  0.000000000000000,
        0.050387687030291,  -0.056198004855489, 0.000000000000000,  0.000000000000000,  -0.084953664744779, -0.088227001821340, 0.000000000000000,
        0.000000000000000,  0.015932444508984,  0.031203758407395,  0.000000000000000,  0.000000000000000,  0.074704199282808,  0.055991686866140,
        -0.007890902792113, -0.005296547605723, -0.005548401558903, -0.002407088343062, -0.074543778784424, -0.044157304843231, 0.079552312425941,
        0.022118574988351,  -0.039812532263860, -0.011427568589008, 0.180259284830670,  0.046573276596554,  0.038412425857755,  -0.001796949348471,
        0.042554701287081,  0.005404251565740,  -0.004059792490870, -0.027050945158081, -0.094935572350146, -0.032228406408643, 0.023873613789772,
        0.043953663363524,  0.039995988649167,  -0.003609738032752, -0.079365004137132, -0.025745205822834, 0.016574198087166,  -0.000418651455637,
        0.008966173976941,  0.007640635543341,  -0.080748736459233, -0.025890125961575, 0.019264597332049,  0.014543702509033,  -0.027150318632794,
        -0.008921964269337, -0.000239681447488, -0.000232222358506, -0.007127943280788, -0.002818878717910, -0.017842161395273, -0.013880088249016,
        0.066642910517429,  0.022617917177725,  -0.006029193129230, 0.004854295438140,  0.142252007953293,  0.001095252195953,  -0.008465125858531,
        -0.013129344325585, 0.019040722268577,  -0.047434716249222, -0.019892359326915, -0.027420887870319, -0.095746496607758, -0.047335719412691,
        0.046548445895208,  0.061081875647008,  -0.006223290316663, -0.096888556311445, -0.006165642011775, 0.003889584948262,  -0.000560843936550,
        -0.007240651359653, 0.005239496945312,  0.004242986654654,  -0.077647691279895, -0.024665764143497, 0.000859788265546,  0.000858161776085,
        -0.026640812177463, -0.011114790073212, 0.000000000000000,  0.000000000000000,  0.052256635554162,  0.039353348822856,  0.000000000000000,
        0.000000000000000,  0.024146123761066,  0.022931546462610,  0.000000000000000,  0.000000000000000,  -0.027683269902629, -0.000334409742606,
        0.000000000000000,  0.000000000000000,  0.012476603648421,  -0.024956567345703, 0.000000000000000,  0.000000000000000,  -0.025017953487068,
        0.008243267393949,  0.000000000000000,  0.000000000000000,  -0.053371854851051, 0.018845968419163,  0.000000000000000,  0.000000000000000,
        -0.068383153748047, -0.025441024898428, 0.000000000000000,  0.000000000000000,  0.033330743247006,  0.015994236295388,  0.000000000000000,
        0.000000000000000,  -0.016936431292093, -0.015995989816084, 0.000000000000000,  0.000000000000000,  0.045927033316007,  0.041016261396239,
        0.000000000000000,  0.000000000000000,  0.029086717478015,  0.020040185266230,  0.000000000000000,  0.000000000000000,  -0.014626293036211,
        -0.000037064420121, 0.000000000000000,  0.000000000000000,  0.000977386026737,  -0.029393880423742, 0.000000000000000,  0.000000000000000,
        -0.011528112900189, 0.009784325639251,  0.000000000000000,  0.000000000000000,  -0.023938788374485, 0.022707046424288,  0.000000000000000,
        0.000000000000000,  -0.039226611252689, -0.033008386837012, 0.000000000000000,  0.000000000000000,  0.028843205296852,  0.013873251031891,
        0.000000000000000,  0.000000000000000,  -0.016341931843570, -0.016746540999823, 0.023533866180624,  0.027325042796872,  0.056757008412488,
        0.016498264229843,  0.031829863010311,  0.046120461135441,  0.078159846014789,  0.020146453646391,  -0.029361749240852, -0.018230413576771,
        -0.019645422662239, -0.006890574635213, 0.106334415446137,  0.090093351431884,  0.007780608241462,  0.003949635021511,  -0.074426717488654,
        -0.054667770234075, 0.020519756044804,  0.007256200950857,  -0.149212837589477, -0.111559334622153, -0.010801085802420, -0.003408891616664,
        -0.058635196077413, -0.023136583101930, 0.050506739176219,  0.010107542553440,  0.031702346722895,  0.037265968036295,  0.066041709518094,
        0.018759339254624,  -0.008251460226665, -0.010361776502444, -0.020293010722522, -0.005520226239465, 0.006598188067556,  0.009657239401684,
        0.049280305840459,  0.028623569434321,  0.036965427342859,  0.044699333277088,  0.060803245146578,  0.021926751533124,  -0.003676968352852,
        -0.003347711423099, -0.020669670563328, -0.004589445416171, 0.053830803454296,  0.055833041350473,  0.011021785467611,  0.023637696100177,
        -0.022166878144409, -0.021782688290859, 0.021581890086230,  0.008738138724967,  -0.050135815204868, -0.050662348625758, -0.010198194180847,
        -0.005441608263198, 0.031014747057841,  0.039791655922766,  0.031699552831208,  -0.019999310745200, 0.025634181024714,  0.030715275669813,
        0.056369464176294,  0.021025073436356,  -0.002690744043626, -0.003955961223719, -0.016528548424767, -0.009972234100983};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 20, 36));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeFSForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix efxmat(28, 4);

    CDenseMatrix efymat(28, 4);

    CDenseMatrix efzmat(28, 4);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.028599450990946,  0.022618724636114,  0.000000000000000,  0.000000000000000,  0.024159182917711,
        0.021452587205156,  0.148428671659304,  0.129907616346590,  0.019547435829854,  0.047124387661378,  0.204139322774194,  0.184446308906085,
        0.009483339074046,  0.043857934014237,  0.000000000000000,  0.000000000000000,  0.081508713698598,  0.053002599262739,  0.000000000000000,
        0.000000000000000,  0.072464634582749,  0.051113955344241,  0.154393581334957,  0.148195994788565,  0.018059214807158,  0.051974250368702,
        0.364069047516647,  0.332956509732216,  0.010688503831686,  0.067592289621590,  0.000000000000000,  0.000000000000000,  0.023579385923736,
        -0.001873451476836, 0.000000000000000,  0.000000000000000,  0.026383846474127,  -0.000265654600990, -0.358630033660812, -0.290480867806213,
        -0.051301471434153, -0.108567780828800, -0.221558103908656, -0.193006872727686, -0.021437883984942, -0.066626045964349, 0.000000000000000,
        0.000000000000000,  -0.022743010940096, -0.024891817613369, 0.000000000000000,  0.000000000000000,  -0.017036662840588, -0.023100024395851,
        -0.279873925723781, -0.237078155184618, -0.038228094104757, -0.087075808850445, -0.293511291303175, -0.262781626368535, -0.017385116167539,
        -0.069460340285849, -0.000000000000000, 0.000000000000000,  0.079622070598542,  0.050984674764866,  -0.000000000000000, 0.000000000000000,
        0.071036562271751,  0.049238788055832,  0.132277652375463,  0.129439244605841,  0.015042321219830,  0.045088319755401,  0.340613222416058,
        0.311947345378103,  0.009313289476569,  0.062065483055190,  0.000000000000000,  0.000000000000000,  0.032929392527564,  0.032592322331712,
        0.000000000000000,  0.000000000000000,  0.025753597043085,  0.030429712827675,  0.324403308707871,  0.276456689059750,  0.044021860026864,
        0.101305116473776,  0.359463054946641,  0.322495533102488,  0.020255742856949,  0.083299858387483,  0.000000000000000,  -0.000000000000000,
        -0.017081275165154, -0.010086121612403, 0.000000000000000,  -0.000000000000000, -0.015507720552011, -0.009818192482216, -0.008417356445494,
        -0.011270051394940, -0.000429410656597, -0.003555318894960, -0.056893472273156, -0.052602330537235, -0.000783923485335, -0.009049614738206};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 28, 4));

    std::vector<double> intyvals{
        -0.000000000000000, 0.000000000000000,  -0.009807717377948, -0.009154326243544, 0.000000000000000,  0.000000000000000,  -0.007844691841722,
        -0.008579445462949, -0.083659047405178, -0.071626460008596, -0.011294820815515, -0.026200304374760, -0.096557198747100, -0.086753638024364,
        -0.005244617777247, -0.022040365125102, 0.000000000000000,  0.000000000000000,  0.070808180879708,  0.037444869131658,  0.000000000000000,
        0.000000000000000,  0.065660648192665,  0.036880783615509,  -0.067435756918670, -0.037863715679962, -0.012562356914786, -0.016624050698795,
        0.152904731727346,  0.144644447554033,  -0.002974387421818, 0.015647424896632,  -0.000000000000000, 0.000000000000000,  0.099271558868322,
        0.049423465200836,  0.000000000000000,  0.000000000000000,  0.093023101000190,  0.049017409221674,  -0.166580709008547, -0.112628145232670,
        -0.027708904975298, -0.045384830935266, 0.155981469158844,  0.151108284771698,  -0.008551613844216, 0.006543778084898,  0.000000000000000,
        0.000000000000000,  -0.034114516410145, -0.037337726420054, 0.000000000000000,  0.000000000000000,  -0.025554994260882, -0.034650036593776,
        -0.419810888585672, -0.355617232776927, -0.057342141157135, -0.130613713275668, -0.440266936954762, -0.394172439552803, -0.026077674251308,
        -0.104190510428774, 0.000000000000000,  0.000000000000000,  0.023579385923736,  -0.001873451476836, 0.000000000000000,  0.000000000000000,
        0.026383846474127,  -0.000265654600990, -0.358630033660812, -0.290480867806213, -0.051301471434153, -0.108567780828800, -0.221558103908656,
        -0.193006872727686, -0.021437883984942, -0.066626045964349, 0.000000000000000,  0.000000000000000,  -0.074097646412309, -0.052053187932315,
        0.000000000000000,  0.000000000000000,  -0.064656733270875, -0.049851789320534, -0.231057746348845, -0.209693465281117, -0.029130039860959,
        -0.075047348293770, -0.404482632494335, -0.367753461252566, -0.015233529321010, -0.080828635304583, 0.000000000000000,  0.000000000000000,
        -0.035934131112498, -0.023558350218157, 0.000000000000000,  0.000000000000000,  -0.031886606827246, -0.022701743863240, -0.072554697582311,
        -0.069044011021896, -0.008590719703214, -0.024289108185950, -0.164142287674419, -0.150008015641753, -0.004985159956152, -0.030758017657702};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 28, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.003025555550140,  0.000387595552593,  0.000000000000000,  0.000000000000000,  0.003187562362683,
        0.000515277121460,  -0.031298014306759, -0.025106237196436, -0.004519645402239, -0.009419552783614, -0.016498776978657, -0.014205795971537,
        -0.001855498886131, -0.005403715497070, 0.000000000000000,  0.000000000000000,  0.076800869530420,  0.025315380925514,  0.000000000000000,
        0.000000000000000,  0.076037420923836,  0.026618858457857,  -0.431719747784760, -0.337458086847674, -0.063883717685223, -0.127929077570906,
        -0.124788614397417, -0.100360051590511, -0.025036160811448, -0.059652276302102, 0.000000000000000,  0.000000000000000,  0.162472100152760,
        0.074649406574395,  0.000000000000000,  0.000000000000000,  0.154211222828710,  0.074765950174326,  -0.418870404190930, -0.305207841849983,
        -0.065846223675136, -0.119098169030967, 0.136757558034544,  0.142398396178793,  -0.022890662421762, -0.020539498992843, 0.000000000000000,
        -0.000000000000000, 0.093985189170810,  0.059493272889652,  -0.000000000000000, -0.000000000000000, 0.084067866959922,  0.057518651348077,
        0.139999849556835,  0.139448445995294,  0.015493704792638,  0.048275346112709,  0.388975412117223,  0.356641253634051,  0.010011655535757,
        0.069812705799734,  0.000000000000000,  0.000000000000000,  0.108314733435174,  0.049766271049597,  0.000000000000000,  0.000000000000000,
        0.102807481885807,  0.049843966782884,  -0.279246936127287, -0.203471894566655, -0.043897482450091, -0.079398779353978, 0.091171705356363,
        0.094932264119195,  -0.015260441614508, -0.013692999328562, 0.000000000000000,  0.000000000000000,  -0.032000362304342, -0.010548075385631,
        -0.000000000000000, -0.000000000000000, -0.031682258718265, -0.011091191024107, 0.179883228243650,  0.140607536186531,  0.026618215702176,
        0.053303782321211,  0.051995255998924,  0.041816688162713,  0.010431733671437,  0.024855115125876,  0.000000000000000,  0.000000000000000,
        -0.015463950589605, -0.001981043935474, 0.000000000000000,  0.000000000000000,  -0.016291985409270, -0.002633638620795, 0.159967628678993,
        0.128320767892897,  0.023100409833665,  0.048144380894029,  0.084327082335359,  0.072607401632299,  0.009483660973559,  0.027618990318360};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 28, 4));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeFPForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix efxmat(28, 12);

    CDenseMatrix efymat(28, 12);

    CDenseMatrix efzmat(28, 12);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.007631545922405, 0.021055830743804,  0.000000000000000,  0.000000000000000,  -0.058275977463333,
        -0.035779102563683, 0.000000000000000,  0.000000000000000,  0.039413632306756,  0.053362274575214,  0.000000000000000,  0.000000000000000,
        -0.003119407660035, 0.021198820222163,  0.000000000000000,  0.000000000000000,  -0.040413410071946, -0.030581496818209, 0.000000000000000,
        0.000000000000000,  0.039423157193442,  0.053031058610468,  -0.016286584752050, -0.020618182692179, -0.047634478909012, -0.067597570811291,
        0.113542380425614,  0.094401079367708,  -0.026057937075625, -0.048697126828104, -0.022354544013052, -0.025323844614805, -0.035641071796718,
        -0.054142181222456, -0.053738580658803, -0.057631290165249, -0.023035491851315, -0.068578621099573, 0.069160115712409,  0.066220137443962,
        -0.016831615093471, -0.057559597952870, -0.097778107717253, -0.094096541078115, -0.018538962020282, -0.061869779331119, 0.000000000000000,
        0.000000000000000,  -0.001619096369925, 0.053096041587014,  0.000000000000000,  0.000000000000000,  -0.116448761392473, -0.029853977665367,
        0.000000000000000,  0.000000000000000,  0.002719237355396,  -0.016292658750002, 0.000000000000000,  0.000000000000000,  0.012909357767115,
        0.055569932118781,  0.000000000000000,  0.000000000000000,  -0.077122018225697, -0.020786105429104, 0.000000000000000,  0.000000000000000,
        0.022466108036876,  -0.007634939928496, 0.002997761613370,  -0.007139993724414, -0.045390459849871, -0.074628019862525, 0.093322815697758,
        0.081323772151574,  -0.035299029573483, -0.071213656596423, -0.178236071602306, -0.065901009872495, 0.005933486810758,  -0.020946656231459,
        -0.074199413799500, -0.083893928515159, -0.025760679749420, -0.103183920273163, 0.047489241730186,  0.039928563771562,  -0.024886930675707,
        -0.115540824003233, -0.394579850381695, -0.217838721401706, -0.007811016355985, -0.055711453384207, 0.000000000000000,  0.000000000000000,
        -0.005434106751864, -0.002981965876940, 0.000000000000000,  0.000000000000000,  -0.005670057407032, 0.012122095362786,  0.000000000000000,
        0.000000000000000,  0.016900388374552,  -0.004897119511538, 0.000000000000000,  0.000000000000000,  -0.000690360030673, -0.001787234734684,
        0.000000000000000,  0.000000000000000,  0.000151879989152,  0.012505705449104,  0.000000000000000,  0.000000000000000,  0.022624396597277,
        -0.001604004924754, -0.036540877984552, -0.016598904913577, 0.083237720284987,  0.112808299055741,  -0.126666856633544, -0.083244668983281,
        0.128805505689939,  0.178704772562878,  -0.584235962346610, -0.352996247441147, 0.000653732069025,  -0.010763054367364, 0.031770656903591,
        0.033965574635539,  0.038141375102812,  0.081333188708423,  0.001697624243240,  0.005226241328195,  0.060466381878242,  0.125961874168578,
        -0.774810346859410, -0.490779236778147, -0.004001311596866, -0.032085935310480, 0.000000000000000,  0.000000000000000,  0.001573468979613,
        0.016033789279088,  0.000000000000000,  0.000000000000000,  0.063210117696215,  0.020844183392874,  0.000000000000000,  0.000000000000000,
        -0.036589828281072, -0.058885552481050, 0.000000000000000,  0.000000000000000,  -0.009566499899934, 0.010716384491335,  0.000000000000000,
        0.000000000000000,  0.050316113583317,  0.018434163088554,  0.000000000000000,  0.000000000000000,  -0.034674136480715, -0.057422274711226,
        -0.189515517568633, -0.152847260163900, 0.003723312823755,  0.023001016669470,  -0.058212494899588, -0.036877849007000, 0.112403314452344,
        0.160067535887911,  -0.172594809186819, -0.091606590745716, 0.038449560823913,  0.054453056273303,  -0.098574265253688, -0.093613892252923,
        0.008156155589569,  0.032337181475644,  0.017427411137164,  0.021742827010149,  0.054427100779712,  0.141532790282630,  -0.155814341951802,
        -0.064197756122217, 0.018539119068794,  0.055567564233514,  0.000000000000000,  0.000000000000000,  -0.102795583196465, -0.060960147585840,
        0.000000000000000,  0.000000000000000,  -0.049137775095503, 0.044400135089277,  0.000000000000000,  0.000000000000000,  -0.019274885895737,
        -0.047622039815147, 0.000000000000000,  0.000000000000000,  -0.077511049470192, -0.054642704950407, 0.000000000000000,  0.000000000000000,
        -0.018363935712124, 0.050417642745834,  0.000000000000000,  0.000000000000000,  0.003729094902414,  -0.037418506210853, 0.074038350446840,
        0.071720736505591,  0.000653732069025,  -0.010763054367364, 0.027911182035354,  0.015575506792274,  -0.057629336752106, -0.100275274991631,
        -0.153333195716708, -0.036642816152291, 0.026135152148115,  0.005036336356401,  0.088591381384726,  0.088428946698086,  -0.004001311596866,
        -0.032085935310480, -0.062893244461206, -0.075729128836177, -0.034763935975653, -0.149219967251817, -0.354753966962010, -0.169301605193553,
        0.000990784413389,  -0.030428370398171, 0.000000000000000,  0.000000000000000,  -0.068361371105772, -0.035233895732980, 0.000000000000000,
        0.000000000000000,  -0.048276766018626, -0.018495244420035, 0.000000000000000,  0.000000000000000,  0.050357639497236,  0.077044372185598,
        0.000000000000000,  0.000000000000000,  -0.056954324349521, -0.033108306950916, 0.000000000000000,  0.000000000000000,  -0.028434327444654,
        -0.012522647079607, 0.000000000000000,  0.000000000000000,  0.048544415894257,  0.075524935179814,  0.032317936535225,  0.023546534889181,
        -0.069762136395590, -0.098336456436993, 0.177196853849916,  0.134235026475027,  -0.091154431806884, -0.144066057199962, 0.154825839132206,
        0.076830444123161,  -0.050623336482432, -0.073149944570769, 0.007811363563214,  0.006937081963613,  -0.033417852169948, -0.085280191400072,
        0.046032857184500,  0.037839523551366,  -0.049289525994695, -0.142169988187840, 0.108956129744586,  0.023521202114890,  -0.024946643636364,
        -0.077275973851418, 0.000000000000000,  0.000000000000000,  -0.040135803233918, -0.057295282131903, 0.000000000000000,  0.000000000000000,
        0.034335117135553,  0.015919979519049,  0.000000000000000,  0.000000000000000,  0.027743180998836,  0.044347266100862,  0.000000000000000,
        0.000000000000000,  -0.038360736495434, -0.056014249408113, 0.000000000000000,  0.000000000000000,  0.025520307694803,  0.013958319190761,
        0.000000000000000,  0.000000000000000,  0.018809964241315,  0.040278573199524,  0.040022481713869,  0.042287894401280,  0.023689931061057,
        0.034359146150808,  -0.010146950914531, -0.012257637871368, -0.002136312939451, 0.000603421711036,  0.010528408110401,  -0.021992444207543,
        -0.027500986431190, -0.028528309877514, 0.084376660594691,  0.089793905618954,  0.011769883474286,  0.043962067444652,  -0.019834432984710,
        -0.019614777883909, 0.000332328851531,  0.010576874836107,  0.043065502123016,  -0.010500575920087, -0.009492760701818, -0.019300445043568};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 28, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.040895026329243, -0.056496870360201, 0.000000000000000,  0.000000000000000,  0.020176990233298,
        0.014494767755922,  0.000000000000000,  0.000000000000000,  0.058185439284763,  0.051883096198148,  0.000000000000000,  0.000000000000000,
        -0.037677233139095, -0.054853448552896, 0.000000000000000,  0.000000000000000,  0.013294449316725,  0.012245805189211,  0.000000000000000,
        0.000000000000000,  0.051941870393300,  0.050363104443079,  0.009953060759718,  0.024470967999458,  0.038193920950807,  0.053429238923300,
        -0.062482128870438, -0.050388540576963, 0.016162629306637,  0.028328376601926,  -0.016286584752050, -0.020618182692179, 0.002269445338027,
        0.001729041325186,  0.059436919138423,  0.075244391639100,  0.018193576729079,  0.055571142122110,  -0.032484037074175, -0.030848583565305,
        0.009740854867931,  0.029456740236498,  -0.053738580658803, -0.057631290165249, 0.000530901348578,  -0.005734545137511, 0.000000000000000,
        0.000000000000000,  -0.014766571026501, -0.018052847789535, 0.000000000000000,  0.000000000000000,  -0.100213847269102, -0.020985272820663,
        0.000000000000000,  0.000000000000000,  0.062634466377342,  0.083191033464303,  0.000000000000000,  0.000000000000000,  0.007366722476965,
        -0.009749957818161, 0.000000000000000,  0.000000000000000,  -0.069091872180575, -0.014884139419245, 0.000000000000000,  0.000000000000000,
        0.066662705375011,  0.084041445365238,  -0.242871944672757, -0.112994079650857, 0.028533354711047,  0.013294684587546,  -0.026232207523093,
        -0.007337366032779, 0.028484040867341,  0.026824449040087,  0.002997761613370,  -0.007139993724414, 0.003328042188000,  -0.006948198172950,
        -0.410202577508122, -0.231712885328933, 0.003808859932358,  -0.032394123984181, 0.020603061642398,  0.017987903255151,  0.008561204327136,
        -0.026917391243936, -0.074199413799500, -0.083893928515159, -0.002754084727939, -0.041832648023114, 0.000000000000000,  0.000000000000000,
        -0.053963877345953, -0.071008889026593, 0.000000000000000,  0.000000000000000,  -0.053862822934696, 0.054501881224932,  0.000000000000000,
        0.000000000000000,  -0.085231421132542, -0.040357317926474, 0.000000000000000,  0.000000000000000,  -0.018066294289666, -0.057204606493552,
        0.000000000000000,  0.000000000000000,  -0.018237369054497, 0.060839063953420,  0.000000000000000,  0.000000000000000,  -0.067447324075653,
        -0.037146368085120, -0.358849460998730, -0.151583318104392, 0.072649388354233,  0.061451364270864,  -0.077644531825933, -0.053795050693794,
        0.049708584656177,  0.048645368810767,  -0.036540877984552, -0.016598904913577, 0.022733594800723,  0.028755870245932,  -0.573066346472354,
        -0.291432992535108, 0.019841277712546,  -0.005846221736130, -0.061478557591839, -0.071373927729347, 0.015624715589549,  -0.044251738778002,
        0.031770656903591,  0.033965574635539,  0.009569192997064,  0.005140265700432,  0.000000000000000,  0.000000000000000,  -0.035278604131394,
        -0.045524061415144, 0.000000000000000,  0.000000000000000,  0.094815176544322,  0.031266275089312,  0.000000000000000,  0.000000000000000,
        0.001573468979614,  0.016033789279088,  0.000000000000000,  0.000000000000000,  -0.042646219730660, -0.048491954301780, 0.000000000000000,
        0.000000000000000,  0.075474170374975,  0.027651244632830,  0.000000000000000,  0.000000000000000,  -0.009566499899934, 0.010716384491335,
        -0.330524407160680, -0.218979307548966, 0.041552321510376,  0.073620570164528,  -0.087318742349382, -0.055316773510499, 0.168604971678516,
        0.240101303831867,  -0.189515517568633, -0.152847260163900, 0.003723312823755,  0.023001016669470,  -0.237959562996542, -0.142209332999654,
        0.025335915393435,  0.082515215463218,  0.026141116705746,  0.032614240515223,  0.081640651169569,  0.212299185423945,  -0.098574265253688,
        -0.093613892252923, 0.008156155589569,  0.032337181475644,  0.000000000000000,  0.000000000000000,  -0.005434106751864, -0.002981965876940,
        0.000000000000000,  0.000000000000000,  -0.005670057407032, 0.012122095362786,  0.000000000000000,  0.000000000000000,  0.016900388374551,
        -0.004897119511538, 0.000000000000000,  0.000000000000000,  -0.000690360030673, -0.001787234734684, 0.000000000000000,  0.000000000000000,
        0.000151879989152,  0.012505705449104,  0.000000000000000,  0.000000000000000,  0.022624396597277,  -0.001604004924754, -0.475390419846852,
        -0.299743560878069, 0.022733594800723,  0.028755870245932,  -0.126666856633544, -0.083244668983281, 0.128805505689939,  0.178704772562878,
        0.074038350446840,  0.071720736505591,  0.091409920295420,  0.115315588847349,  -0.543830495259167, -0.352173214348616, 0.009569192997064,
        0.005140265700432,  0.001697624243240,  0.005226241328195,  0.060466381878242,  0.125961874168578,  0.088591381384726,  0.088428946698086,
        0.038856961561756,  0.082203449201507,  0.000000000000000,  0.000000000000000,  -0.045337917134276, -0.062733744460791, 0.000000000000000,
        0.000000000000000,  0.106287158539119,  0.029366798195679,  0.000000000000000,  0.000000000000000,  0.085847179487669,  0.036994084772513,
        0.000000000000000,  0.000000000000000,  -0.060974761941691, -0.068281227785374, 0.000000000000000,  0.000000000000000,  0.069167281212148,
        0.020324074319175,  0.000000000000000,  0.000000000000000,  0.072053709909431,  0.035223324840582,  0.020635834315737,  -0.002290823488431,
        0.036262152515013,  0.076338266089066,  -0.133124153792477, -0.109022718511797, 0.058706556835832,  0.104648755643390,  0.032317936535225,
        0.023546534889181,  0.047162268495300,  0.064095115617988,  0.226369881876172,  0.163791967356209,  0.026614208812875,  0.113986631088246,
        -0.052464636510162, -0.043812576438213, 0.036205551825631,  0.138090245144431,  0.007811363563214,  0.006937081963613,  0.021797975881605,
        0.061962862000045,  0.000000000000000,  0.000000000000000,  -0.020171611550573, -0.028325998755375, 0.000000000000000,  0.000000000000000,
        0.072553080221909,  0.037216290896248,  0.000000000000000,  0.000000000000000,  -0.027258566997733, -0.051263860629966, 0.000000000000000,
        0.000000000000000,  -0.027733576074646, -0.030964135716002, 0.000000000000000,  0.000000000000000,  0.052742006755722,  0.032308401693722,
        0.000000000000000,  0.000000000000000,  -0.027587877745869, -0.050308193799673, 0.052856950739973,  0.026351591352647,  0.014453090754734,
        0.032172237184315,  -0.060767411058312, -0.055949748908284, 0.007605222205620,  0.020739189123005,  0.040022481713869,  0.042287894401280,
        0.033453742326782,  0.047923048525336,  0.152900572835449,  0.106856006386164,  0.011258063301300,  0.051493479667392,  -0.056404212428915,
        -0.054891930034151, 0.007344025833236,  0.038521078221383,  0.084376660594691,  0.089793905618954,  0.016380699535135,  0.056257647524186};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 28, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.019170120488378, -0.003934575722218, 0.000000000000000,  0.000000000000000,  -0.004148456993255,
        -0.000198890185649, 0.000000000000000,  0.000000000000000,  0.036157088268691,  0.008451321783854,  0.000000000000000,  0.000000000000000,
        -0.019622619084725, -0.005189364725468, 0.000000000000000,  0.000000000000000,  -0.003247507786871, -0.000188623410770, 0.000000000000000,
        0.000000000000000,  0.038587554091535,  0.011262910977018,  -0.062482128870438, -0.050388540576963, -0.013671238449745, -0.013116880653577,
        -0.039855175000947, -0.026538804959185, 0.006301479233598,  0.009128521235905,  0.113542380425614,  0.094401079367708,  0.045543345539691,
        0.050771490585102,  -0.032484037074175, -0.030848583565305, -0.004347749762440, -0.008113087784300, -0.032993608585310, -0.022356601240471,
        0.003083869047915,  0.005107235938666,  0.069160115712409,  0.066220137443962,  0.016981036019419,  0.032607989297045,  0.000000000000000,
        0.000000000000000,  -0.000912886659689, 0.025525169171511,  0.000000000000000,  0.000000000000000,  -0.089081256649562, -0.025533651207546,
        0.000000000000000,  0.000000000000000,  0.067550077383792,  0.056327135437778,  0.000000000000000,  0.000000000000000,  0.013981483213447,
        0.029117290143461,  0.000000000000000,  0.000000000000000,  -0.056805666152654, -0.018738783849239, 0.000000000000000,  0.000000000000000,
        0.076808022651461,  0.060745955231206,  -0.026232207523093, -0.007337366032779, 0.103776271289505,  0.131420537105795,  -0.517574405222173,
        -0.313139626208897, 0.124582793287276,  0.158820383068316,  0.093322815697758,  0.081323772151574,  0.104213044444056,  0.122596741878270,
        0.020603061642398,  0.017987903255151,  0.044116851178516,  0.067898211324321,  -0.476599167795438, -0.290678082019645, 0.053193334157815,
        0.066704525965932,  0.047489241730186,  0.039928563771562,  0.040995591431260,  0.060146910167361,  0.000000000000000,  0.000000000000000,
        -0.017289053843552, 0.071632250914302,  0.000000000000000,  0.000000000000000,  -0.119927609452869, -0.017049848135308, 0.000000000000000,
        0.000000000000000,  -0.127582621044178, -0.044979136935113, 0.000000000000000,  0.000000000000000,  0.012359572799452,  0.077045333405703,
        0.000000000000000,  0.000000000000000,  -0.046430485588418, 0.002730538591562,  0.000000000000000,  0.000000000000000,  -0.101837926190678,
        -0.041515192725172, -0.077644531825933, -0.053795050693794, 0.077439642169797,  0.087169398681930,  -0.514116580115088, -0.259250625706452,
        0.173604077565774,  0.183984149005671,  -0.126666856633544, -0.083244668983281, 0.036368647311203,  0.050291339659004,  -0.061478557591839,
        -0.071373927729347, 0.028720299054683,  -0.009329982399340, -0.641328372905193, -0.366913567404331, 0.060523968166272,  0.004709360640051,
        0.001697624243240,  0.005226241328195,  0.016814436994460,  0.009556019573035,  0.000000000000000,  0.000000000000000,  -0.198378878071349,
        -0.106059537128055, 0.000000000000000,  0.000000000000000,  0.025085704957168,  0.076709135641212,  0.000000000000000,  0.000000000000000,
        -0.132252585380899, -0.070706358085370, 0.000000000000000,  0.000000000000000,  -0.169806577656310, -0.102266507050561, 0.000000000000000,
        0.000000000000000,  0.064842551325676,  0.089203184733401,  0.000000000000000,  0.000000000000000,  -0.113204385104207, -0.068177671367040,
        -0.087318742349382, -0.055316773510499, -0.053701380476139, -0.068727039506593, 0.068878773039258,  0.082967517264579,  -0.006424512239996,
        -0.058142160280798, -0.058212494899588, -0.036877849007000, -0.035800920317426, -0.045818026337728, 0.026141116705745,  0.032614240515223,
        -0.023340249325876, -0.067651489647170, -0.199001350467501, -0.136027861007630, -0.021118883567151, -0.147983041846568, 0.017427411137164,
        0.021742827010149,  -0.015560166217250, -0.045100993098113, 0.000000000000000,  0.000000000000000,  -0.127582621044178, -0.044979136935113,
        0.000000000000000,  0.000000000000000,  -0.079951739635246, -0.011366565423538, 0.000000000000000,  0.000000000000000,  0.089029797026596,
        0.109114865026897,  0.000000000000000,  0.000000000000000,  -0.101837926190678, -0.041515192725172, 0.000000000000000,  0.000000000000000,
        -0.030953657058945, 0.001820359061041,  0.000000000000000,  0.000000000000000,  0.097224511291683,  0.111641327343347,  -0.126666856633544,
        -0.083244668983281, 0.036368647311203,  0.050291339659004,  -0.342744386743392, -0.172833750470968, 0.115736051710516,  0.122656099337114,
        0.027911182035354,  0.015575506792274,  0.047132436077128,  0.045259948966093,  0.001697624243240,  0.005226241328195,  0.016814436994460,
        0.009556019573035,  -0.427552248603462, -0.244609044936221, 0.040349312110848,  0.003139573760034,  -0.062893244461206, -0.075729128836177,
        0.014708268225967,  -0.017293332043536, 0.000000000000000,  0.000000000000000,  -0.088225899595790, -0.061738949941931, 0.000000000000000,
        0.000000000000000,  0.037117190270651,  0.010639021336478,  0.000000000000000,  0.000000000000000,  0.104763537979411,  0.053185554414962,
        0.000000000000000,  0.000000000000000,  -0.093558762000849, -0.065866961236010, 0.000000000000000,  0.000000000000000,  0.023669027563606,
        0.007807826603850,  0.000000000000000,  0.000000000000000,  0.099596373221427,  0.055291320834682,  -0.133124153792477, -0.109022718511797,
        -0.088777635696995, -0.100236522744144, 0.215656002175905,  0.130474844253707,  -0.051909497203032, -0.066175159611798, 0.177196853849916,
        0.134235026475027,  0.024884182137863,  0.017134972642481,  -0.052464636510162, -0.043812576438213, -0.033441685830306, -0.047636788121625,
        0.198582986581433,  0.121115867508185,  -0.022163889232423, -0.027793552485805, 0.046032857184500,  0.037839523551366,  0.005508000329196,
        0.003957587535003,  0.000000000000000,  0.000000000000000,  -0.021879985510115, -0.007014133451289, 0.000000000000000,  0.000000000000000,
        0.021203224632190,  0.001016549837763,  0.000000000000000,  0.000000000000000,  -0.005011993586124, -0.002509363959092, 0.000000000000000,
        0.000000000000000,  -0.026258957407759, -0.009536006101505, 0.000000000000000,  0.000000000000000,  0.016598373132898,  0.000964075210601,
        0.000000000000000,  0.000000000000000,  -0.007396760706647, -0.003476850723917, -0.060767411058312, -0.055949748908284, -0.063996060409695,
        -0.078729428290200, 0.203704227782616,  0.135642780902501,  -0.032207560527281, -0.046656886316845, -0.010146950914531, -0.012257637871368,
        -0.031970180695833, -0.040841835544466, -0.056404212428915, -0.054891930034151, -0.026468625279654, -0.051646509028533, 0.168633999436031,
        0.114267073006854,  -0.015761997356009, -0.026103650353182, -0.019834432984710, -0.019614777883909, -0.013756275778840, -0.026992953184691};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 28, 12));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeFDForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix efxmat(28, 20);

    CDenseMatrix efymat(28, 20);

    CDenseMatrix efzmat(28, 20);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.643788410658111,  0.491503586060572,  -0.005218847402385, 0.050045660118352,  0.000000000000000,  0.000000000000000,  0.017375648996170,
        -0.033138834274158, 0.000000000000000,  0.000000000000000,  0.084212619270010,  0.063021525927635,  0.000000000000000,  0.000000000000000,
        -0.077227179768866, -0.084078542178337, 0.000000000000000,  0.000000000000000,  0.017131735064723,  0.009835048001791,  0.370049943201491,
        0.357377837277564,  0.000843361031349,  0.052978576854569,  0.000000000000000,  0.000000000000000,  0.006541795521960,  -0.030034856670247,
        0.000000000000000,  0.000000000000000,  0.047522703044152,  0.049424100924937,  0.000000000000000,  0.000000000000000,  -0.063535716459862,
        -0.075233903483705, 0.000000000000000,  0.000000000000000,  0.026310679472860,  0.016091142830776,  -0.041601690874276, -0.023015345842423,
        0.118942897956342,  0.103394448442615,  -0.019457764032903, -0.023845803505515, 0.053695132938621,  0.060115021634457,  0.053059694564359,
        0.053012810809224,  -0.000769083783213, 0.006978050895141,  -0.020736545636985, -0.026759950849880, 0.034286163611627,  0.043161096204351,
        0.047008162575254,  0.021067371184310,  -0.038832240038667, -0.024931796901898, -0.032402615586490, -0.007236127282692, 0.060254364708139,
        0.136245576708930,  -0.027978421306197, -0.032528159851260, 0.035225462198571,  0.077912925959147,  -0.025781304409541, -0.003754085919185,
        0.004199972245065,  0.011662108355464,  -0.045560883127148, -0.049354022031023, 0.025378864053322,  0.064592644548627,  0.096966906794863,
        0.062060640269925,  -0.014358938413540, -0.016948230448463, 0.000000000000000,  0.000000000000000,  0.004097830913681,  -0.015720688187376,
        0.525651036143242,  0.401310997532173,  0.009915054361617,  -0.029318648282109, 0.000000000000000,  0.000000000000000,  0.096801228959629,
        0.004433284008739,  0.000000000000000,  0.000000000000000,  0.004824869464012,  0.010278193656895,  0.000000000000000,  0.000000000000000,
        0.074181751580473,  0.085986354112475,  0.000000000000000,  0.000000000000000,  0.007272877592291,  -0.007647888537685, 0.302144513396516,
        0.291797782236476,  -0.007861676204612, -0.021949257151322, 0.000000000000000,  0.000000000000000,  0.045127529728943,  -0.004944722778227,
        0.000000000000000,  0.000000000000000,  -0.016886547919025, 0.004301355839506,  0.000000000000000,  0.000000000000000,  0.067975132488886,
        0.082114137554927,  -0.012569197803349, -0.010159276559428, -0.027036380615844, 0.011502360847644,  0.001474705755343,  -0.006229615157572,
        0.115090443610073,  0.120851192042403,  -0.025311223630699, -0.015483182894337, -0.003102165184310, 0.008624148874078,  -0.052946285019728,
        -0.000711615821615, -0.011615805983144, 0.032715684319359,  0.143608133210118,  0.114819670900386,  0.013556232533123,  0.015787631964424,
        0.057990329344673,  0.030087650753718,  0.007376232712501,  0.057885493374544,  -0.013704954992802, -0.013612511980564, 0.070942644504510,
        0.201071401123430,  -0.120716074556702, -0.090843622544229, 0.005342454819159,  0.038358625840546,  -0.043213020423231, -0.019912721243450,
        0.019926133075741,  0.094208506373732,  0.252914447256780,  0.202978461796569,  0.009236062915759,  0.016331813568690,  -0.166225452864014,
        -0.126905680227588, -0.003725313194211, -0.007411473799205, 0.000000000000000,  0.000000000000000,  0.012614532884311,  0.014053788147188,
        0.000000000000000,  0.000000000000000,  0.000140371727376,  -0.013625542648430, 0.000000000000000,  0.000000000000000,  0.004269875790651,
        0.028192684640434,  0.000000000000000,  0.000000000000000,  -0.010602647540966, -0.000121274112363, -0.095546484485625, -0.092274560805309,
        -0.000530845252668, -0.005210240384168, 0.000000000000000,  0.000000000000000,  0.011017844894319,  0.015910309333591,  0.000000000000000,
        0.000000000000000,  0.002049940277313,  -0.009058011551389, 0.000000000000000,  0.000000000000000,  0.008125550400633,  0.030026044757662,
        0.000000000000000,  0.000000000000000,  -0.008409612297313, -0.000579375648806, -0.063270063057882, -0.022346793191254, -0.016271487248552,
        -0.000792097501676, -0.027254139857581, -0.014970098966084, -0.229331723732032, -0.197721487437491, 0.051042810261246,  0.025823754784297,
        -0.164391759666009, -0.152589336999611, -0.174496036036521, -0.073337626079362, 0.014585982178419,  0.032894747942320,  -0.183096707580722,
        -0.112504743115970, 0.043527881571780,  0.051509002660015,  0.092628410738158,  0.071106761737525,  -0.000148970791636, 0.021574956101582,
        -0.006317149869367, -0.008392780129625, -0.114778672028992, -0.163858501965587, 0.061303196298774,  0.037127247885382,  -0.088749099940529,
        -0.131326914049557, 0.103367419103416,  0.093901569986059,  0.019669350513363,  0.081723870780740,  -0.137209795975866, -0.099532581947555,
        0.030160001942655,  0.056463905628132,  0.000000000000000,  0.000000000000000,  0.017887943418830,  0.038415589980781,  0.000000000000000,
        0.000000000000000,  -0.038425873949279, -0.015277308472341, 0.000000000000000,  0.000000000000000,  -0.057960483649109, 0.002527354103028,
        -0.407167541779890, -0.310854162018399, 0.076885313789338,  0.048076391437530,  0.000000000000000,  0.000000000000000,  -0.003282771390876,
        0.032543957918874,  0.000000000000000,  0.000000000000000,  0.004698747991682,  0.027816463387019,  0.000000000000000,  0.000000000000000,
        -0.020659481968745, -0.011774175008018, 0.000000000000000,  0.000000000000000,  -0.026951135996252, 0.010300210222788,  -0.234040133706530,
        -0.226025590212426, 0.067730310467328,  0.043675602212559,  0.000000000000000,  0.000000000000000,  -0.017579584032520, 0.020859112603683,
        -0.214561362527757, -0.122917410265235, -0.030755461385854, -0.034432715320252, -0.087328617406724, -0.057017862284489, -0.032893364969797,
        -0.053982432443343, 0.093444192617394,  0.056133296061152,  -0.191480500902827, -0.162414209184519, 0.093293151585292,  0.080438438138831,
        -0.087669069037043, -0.077084825098578, -0.035133696012197, -0.000228936380797, -0.022795491264264, -0.015733754237356, -0.231537205596162,
        -0.155685556074787, -0.020173822744100, -0.047682027242366, -0.002572322932609, 0.000548551694873,  -0.031793062709966, -0.068269508811883,
        0.089241492988768,  0.058907042377442,  -0.094360181107428, -0.151421481736891, 0.245899418426476,  0.186735624531259,  -0.044880536976351,
        -0.091532181151055, -0.126526036489013, -0.075583889188295, -0.009088374304417, -0.017512965437297, 0.000000000000000,  0.000000000000000,
        0.025991729448635,  0.046901802440825,  0.000000000000000,  0.000000000000000,  0.091330369420626,  -0.010788675725573, 0.575821859743234,
        0.439614171846543,  -0.071369518176150, -0.085447663647855, 0.000000000000000,  0.000000000000000,  0.050951362229748,  0.037983931617826,
        -0.166225452864013, -0.126905680227588, -0.040001554562793, -0.027244949352553, 0.000000000000000,  0.000000000000000,  -0.003181714250840,
        0.032186004153375,  0.000000000000000,  0.000000000000000,  0.044093415401182,  -0.015139493538878, 0.330982731227388,  0.319648455121797,
        -0.066782316606238, -0.071873485313182, 0.000000000000000,  0.000000000000000,  0.031268379398064,  0.036513016792058,  -0.095546484485625,
        -0.092274560805309, -0.019388200495036, -0.020011577005208, -0.022281088747674, 0.024690842170054,  -0.001973363487233, 0.012715554215377,
        0.028578021071017,  0.020088882106636,  0.014585982178419,  0.032894747942320,  -0.103348336578568, -0.090761851598549, 0.110698952361473,
        0.107841697628998,  -0.004136816348443, 0.023273724682086,  -0.050210438859431, 0.009036035176601,  0.095655595829957,  0.065185541404274,
        -0.001023749573018, 0.008938221119142,  -0.065117445331536, -0.022191016218650, 0.007731232877058,  0.035088176612970,  -0.006176490721368,
        -0.010227003537303, 0.019669350513363,  0.081723870780740,  -0.157380107246559, -0.129606401562061, 0.063191805913304,  0.177776911787895,
        0.064195474795314,  0.051484686375245,  0.006312865088716,  0.078956337150761,  0.189158267197358,  0.133766848508879,  0.005350829066810,
        0.013635113626964,  0.000000000000000,  0.000000000000000,  -0.082077904244595, -0.082133484962802, 0.000000000000000,  0.000000000000000,
        0.099730338238713,  0.019969873000651,  0.000000000000000,  0.000000000000000,  0.012589588416611,  -0.002437915728080, 0.525651036143242,
        0.401310997532173,  -0.069209765981479, -0.043224159557888, 0.000000000000000,  0.000000000000000,  -0.033862692997768, -0.041435241082563,
        0.000000000000000,  0.000000000000000,  -0.076744932991294, -0.080090866612812, 0.000000000000000,  0.000000000000000,  0.061998317388428,
        0.013591115747747,  0.000000000000000,  0.000000000000000,  -0.009097416689012, -0.009442487603551, 0.302144513396516,  0.291797782236476,
        -0.049861136400554, -0.030532820915232, 0.000000000000000,  0.000000000000000,  -0.003784486153374, -0.024537664905495, -0.136415003026567,
        -0.104794135485267, 0.013556232533123,  0.015787631964424,  0.023392814733089,  0.014490760052972,  0.146285676351432,  0.140774834477389,
        0.001985275974830,  0.008319506957741,  0.055211391893209,  0.068460823909881,  0.079678413206310,  0.028844715561900,  0.131052052528619,
        0.121854827307041,  0.092143656308944,  0.031970933938248,  -0.066604311011003, -0.045991671295876, -0.267836054228313, -0.210733882251746,
        0.009236062915759,  0.016331813568690,  0.001347430410651,  0.001050885892521,  0.082077499179149,  0.145826462632720,  -0.108357412977596,
        -0.076849977699960, 0.040151933051634,  0.080831406879594,  0.007534303169106,  -0.002793418653743, 0.071099083546190,  0.157743297135383,
        0.150738102924253,  0.085086380561050,  -0.026536020431376, -0.029045656070568, 0.000000000000000,  0.000000000000000,  -0.033299658392120,
        -0.018114473010937, 0.000000000000000,  0.000000000000000,  0.079559757458758,  0.090405294981211,  0.000000000000000,  0.000000000000000,
        -0.057619522534957, -0.029341677168306, 0.000000000000000,  0.000000000000000,  -0.058493314516761, -0.070392603516344, 0.643788410658110,
        0.491503586060572,  -0.015584017374435, 0.042271058215507,  0.000000000000000,  0.000000000000000,  -0.033820178861608, -0.021961624608277,
        0.000000000000000,  0.000000000000000,  0.062397073335623,  0.079598020659647,  0.000000000000000,  -0.000000000000000, -0.037922475765935,
        -0.024216777534248, 0.000000000000000,  0.000000000000000,  -0.033264945733133, -0.057687265215317, 0.370049943201490,  0.357377837277565,
        -0.002559394563143, 0.047630947371092,  -0.029549221450173, -0.015542717148137, 0.031351925629181,  0.013216003150743,  0.044566007462144,
        0.045918706194562,  -0.012148928584515, -0.017380001164556, -0.000662859372283, -0.004552868993110, 0.007602805346875,  0.007015992192473,
        -0.025736698749878, -0.045530546012430, 0.021388053056588,  0.013171340965524,  -0.034527167296116, -0.024294170607166, 0.104359663288135,
        0.084257586157922,  -0.080460780564390, -0.052932401832864, 0.007432023154218,  -0.002398293144777, 0.043759286851811,  0.050461941795577,
        -0.010296436469421, -0.037922904670258, 0.008728891111437,  0.002434617594168,  0.004062435746305,  0.004294522880672,  -0.005312943595132,
        -0.025649543485286, 0.007536223455040,  0.006933939661096,  -0.017226848225773, 0.000704425732528,  0.049006650437963,  0.111269393046851};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 28, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.018774927217402,  0.009961397044001,  0.000000000000000,  0.000000000000000,  0.081617894962899,
        0.089193541630598,  0.000000000000000,  -0.000000000000000, -0.025889572126414, -0.025000348697499, 0.000000000000000,  0.000000000000000,
        -0.117247327590854, -0.081912608443698, 0.643788410658110,  0.491503586060572,  0.001390541456371,  0.053606160206444,  0.000000000000000,
        0.000000000000000,  0.027483106319211,  0.016228538361460,  0.000000000000000,  0.000000000000000,  0.061790231661264,  0.078005179442332,
        -0.000000000000000, 0.000000000000000,  -0.012402468781236, -0.019113998176685, 0.000000000000000,  0.000000000000000,  -0.085793529166093,
        -0.071620748334602, 0.370049943201490,  0.357377837277564,  0.019613621732834,  0.063148586092748,  0.044039838274604,  0.019108350024578,
        -0.040909489484991, -0.027111511800764, 0.021310962808149,  0.034002843288144,  -0.036261196652481, -0.040366334425676, -0.030863998506576,
        -0.029248259041756, -0.002652817122874, -0.006959133185693, -0.019457764032903, -0.023845803505515, -0.014280140732403, -0.012422355843615,
        0.004667080820545,  -0.004225223101433, 0.080221578104393,  0.073719819009410,  0.096621104871552,  0.061738376104080,  -0.015628297783406,
        -0.018627040556579, 0.036472470213233,  0.046458004610611,  -0.023648608142435, -0.054094132490834, 0.011564216177063,  0.001208825875670,
        -0.004123108367637, -0.008596535447830, -0.027978421306197, -0.032528159851260, -0.007194798424245, -0.004944044995934, 0.057551242417801,
        0.049410231412426,  0.043046825047628,  0.109332980245216,  0.000000000000000,  0.000000000000000,  -0.010310334659717, -0.039713202405021,
        0.000000000000000,  0.000000000000000,  0.030074680446469,  0.011202797326813,  0.000000000000000,  0.000000000000000,  0.104491509734478,
        0.007104321442163,  0.525651036143242,  0.401310997532173,  -0.083714315413334, -0.046345460645118, 0.000000000000000,  0.000000000000000,
        -0.074328605128100, -0.069148029869096, 0.000000000000000,  0.000000000000000,  0.009619933640629,  -0.021792917951038, 0.000000000000000,
        0.000000000000000,  -0.000411123362558, 0.005102563367947,  0.000000000000000,  0.000000000000000,  0.060225355594916,  0.001431214879695,
        0.302144513396516,  0.291797782236476,  -0.066391700926830, -0.033609023411295, 0.000000000000000,  0.000000000000000,  -0.056096010095108,
        -0.062785957617633, 0.034444155054797,  0.002342271074932,  -0.076851953674346, -0.031252331576760, -0.099731914485907, -0.029693135927558,
        -0.062792649702907, -0.019325511962262, -0.031381399134796, -0.024661836458250, -0.046129265519860, -0.042490099207406, 0.001474705755343,
        -0.006229615157572, 0.014509398200448,  0.025222661761921,  -0.035092395612743, -0.048250774535756, -0.015660555761307, -0.024420209294521,
        0.145726522961761,  0.079372452967381,  -0.017463886485257, 0.021654323071549,  -0.045907881244532, -0.022014493028492, -0.010363537325124,
        0.053957760978720,  -0.059031206161037, -0.048033520667583, -0.024584745381224, -0.016934497890326, -0.013704954992802, -0.013612511980564,
        0.015165424522246,  0.096320492844085,  -0.126523185353469, -0.109765044660990, -0.014436405884088, -0.040133080662313, 0.000000000000000,
        0.000000000000000,  0.047197024530567,  0.047144350665551,  0.000000000000000,  0.000000000000000,  0.091078966880438,  0.049863895007086,
        0.575821859743234,  0.439614171846543,  -0.071252541736670, -0.096802282521546, 0.000000000000000,  0.000000000000000,  0.070654861970961,
        -0.011933785430150, 0.166225452864014,  0.126905680227588,  0.009506240404792,  -0.011940947775104, 0.000000000000000,  0.000000000000000,
        0.013637510343786,  0.033344755450987,  0.000000000000000,  0.000000000000000,  0.055303786037941,  0.048608944430811,  0.330982731227387,
        0.319648455121797,  -0.065074033041811, -0.079421828272673, 0.000000000000000,  0.000000000000000,  0.034996421561351,  -0.014200049530770,
        0.095546484485625,  0.092274560805309,  0.015031618789642,  -0.007292906163276, -0.074365048807561, -0.011481850754015, -0.025094395589548,
        -0.013194895951888, -0.075664455380054, -0.007633443532633, -0.167434874809171, -0.080425481095290, -0.060812661360863, -0.069242055944967,
        -0.026294180693534, -0.019316083204012, -0.027254139857581, -0.014970098966084, -0.051688822894404, -0.040723190611914, -0.055386371848610,
        -0.070689287827624, 0.012301982521677,  -0.008738495395595, -0.073799224679074, -0.030670486658012, -0.007384374957257, 0.013639519718882,
        0.092993978110289,  0.074864862905734,  -0.045260934924555, 0.041213537605741,  -0.106294110330914, -0.098667028324243, -0.010765777370470,
        0.068337816746598,  -0.006317149869367, -0.008392780129625, -0.023373921362844, 0.003001935106892,  -0.131276321359604, -0.111741222310270,
        -0.005495353200061, -0.033938320431902, 0.000000000000000,  0.000000000000000,  0.023623808692115,  0.020276882091018,  -0.407167541779890,
        -0.310854162018399, 0.044863752164939,  0.035345301043913,  0.000000000000000,  0.000000000000000,  -0.086940725473663, 0.003791031154542,
        0.000000000000000,  0.000000000000000,  -0.038425873949279, -0.015277308472341, 0.000000000000000,  0.000000000000000,  -0.012623612533028,
        -0.040815670034057, 0.000000000000000,  0.000000000000000,  0.019064869963922,  0.016763690710061,  -0.234040133706530, -0.226025590212426,
        0.050514075493373,  0.033863789705877,  0.000000000000000,  0.000000000000000,  -0.040426703994378, 0.015450315334182,  0.000000000000000,
        0.000000000000000,  -0.020659481968745, -0.011774175008018, 0.000000000000000,  0.000000000000000,  0.002470819094579,  -0.028617741583598,
        -0.226046456305408, -0.144803404635305, -0.018740679123625, -0.028510058400279, 0.020519303746356,  0.032923552901757,  -0.115080206511874,
        -0.122070185468031, 0.140166288926091,  0.084199944091729,  -0.287220751354241, -0.243621313776779, -0.087328617406724, -0.057017862284489,
        -0.032893364969797, -0.053982432443343, 0.177208865948650,  0.094631101258918,  0.031548794195979,  0.031933003636202,  -0.175767445198796,
        -0.125487664199779, -0.016803708130670, -0.042768827949486, 0.243755815982635,  0.187192750943654,  -0.071374755901322, -0.148423438494291,
        0.133862239483152,  0.088360563566163,  -0.141540271661142, -0.227132222605337, -0.002572322932609, 0.000548551694873,  -0.031793062709966,
        -0.068269508811883, 0.221903016935552,  0.145921774007323,  0.018664300908529,  0.042740662837808,  -0.166225452864014, -0.126905680227588,
        -0.003725313194211, -0.007411473799205, 0.000000000000000,  0.000000000000000,  0.012614532884311,  0.014053788147188,  0.000000000000000,
        0.000000000000000,  0.000140371727376,  -0.013625542648430, 0.000000000000000,  0.000000000000000,  0.004269875790651,  0.028192684640434,
        0.000000000000000,  0.000000000000000,  -0.010602647540966, -0.000121274112363, -0.095546484485625, -0.092274560805309, -0.000530845252668,
        -0.005210240384168, 0.000000000000000,  0.000000000000000,  0.011017844894319,  0.015910309333591,  0.000000000000000,  0.000000000000000,
        0.002049940277312,  -0.009058011551389, 0.000000000000000,  0.000000000000000,  0.008125550400633,  0.030026044757662,  0.000000000000000,
        0.000000000000000,  -0.008409612297313, -0.000579375648806, 0.111012176617673,  0.086479114790416,  -0.042910958515737, -0.032920245481995,
        -0.162636844595940, -0.077254437756750, -0.051688822894404, -0.040723190611914, 0.051042810261246,  0.025823754784297,  -0.164391759666009,
        -0.152589336999611, 0.028578021071017,  0.020088882106636,  -0.251878369078024, -0.202602697296045, 0.235180667640609,  0.148677436040038,
        -0.020406849469464, -0.025598552492750, 0.210587315446187,  0.157583692710222,  -0.018984135812884, -0.016541358215991, 0.066712123347156,
        0.061026268885950,  -0.023373921362844, 0.003001935106892,  0.061303196298774,  0.037127247885382,  -0.088749099940529, -0.131326914049557,
        -0.006176490721368, -0.010227003537303, -0.117437775485859, -0.168566784827979, 0.145891575323404,  0.108012052386918,  -0.015044394108340,
        -0.035015248734044, 0.000000000000000,  0.000000000000000,  0.029844498755278,  0.042931862847755,  -0.525651036143242, -0.401310997532173,
        0.054668286852112,  0.034273746648010,  0.000000000000000,  0.000000000000000,  -0.078820418267003, -0.002566324562387, 0.000000000000000,
        0.000000000000000,  -0.124980149221170, -0.020894476670569, 0.000000000000000,  0.000000000000000,  -0.034336958466413, -0.046020691499887,
        0.000000000000000,  0.000000000000000,  0.040384033558345,  0.045350711827526,  -0.302144513396516, -0.291797782236476, 0.057068499434547,
        0.026614521245460,  0.000000000000000,  0.000000000000000,  -0.031564378629913, 0.007072186307557,  0.000000000000000,  0.000000000000000,
        -0.078473741944895, -0.014392323276188, 0.000000000000000,  0.000000000000000,  -0.004387346482253, -0.026485412213732, 0.151589695211714,
        0.098158429721347,  -0.015660555761307, -0.024420209294521, -0.016062496745629, -0.016176068999744, -0.100048529326098, -0.127434065789165,
        0.018782961109250,  0.009030311356426,  -0.016725354744334, -0.030331938179634, 0.023392814733089,  0.014490760052972,  -0.095108832631669,
        -0.088733638195768, 0.084917532703595,  0.030375214993299,  -0.063609083765925, -0.020481634095587, 0.220643815636594,  0.166043184704554,
        -0.014436405884088, -0.040133080662313, 0.029599405859129,  0.020263091267052,  -0.075083498442280, -0.219479241865572, 0.130366854151246,
        0.096481625007085,  -0.018008326686457, -0.057486737643356, 0.001347430410651,  0.001050885892521,  -0.051787828778285, -0.105575717237708,
        0.167366125441627,  0.093388594004771,  -0.011275795093055, 0.021605432884416,  -0.643788410658111, -0.491503586060572, -0.019832754980844,
        -0.062001825638022, 0.000000000000000,  0.000000000000000,  0.036051881302812,  0.044249272982563,  0.000000000000000,  0.000000000000000,
        -0.116209207917281, -0.067399336150297, 0.000000000000000,  0.000000000000000,  0.053220479430862,  0.080862600034997,  0.000000000000000,
        0.000000000000000,  0.031656466239440,  0.017988123968727,  -0.370049943201491, -0.357377837277564, -0.028779393347429, -0.069171577665458,
        0.000000000000000,  0.000000000000000,  0.042186312481525,  0.043522965871227,  0.000000000000000,  0.000000000000000,  -0.073257163869058,
        -0.054569760781302, 0.000000000000000,  0.000000000000000,  0.044331466331438,  0.071461650551404,  0.000000000000000,  0.000000000000000,
        0.032647752015257,  0.021824229077593,  0.016998118969748,  0.012575886404451,  -0.084594178416877, -0.082142382213926, 0.022800788763930,
        0.008511317994638,  -0.011293439736667, -0.027455678945418, -0.022604764344904, -0.028109896474455, 0.011110887954389,  0.007114512511412,
        0.044566007462144,  0.045918706194562,  -0.025448438650585, -0.031572096758092, 0.032517545750824,  0.017501738307868,  -0.029274676182857,
        -0.011036288251877, -0.040675699902647, -0.039885602123067, -0.048055055458676, -0.126057041757494, 0.051764831821811,  0.040451410300721,
        -0.016379753666240, -0.060593001289816, 0.022922153082859,  0.004990178408427,  0.004054357953868,  0.001337278194286,  0.043759286851811,
        0.050461941795577,  -0.018596052678233, -0.054134051161469, 0.080806582487701,  0.053254665998709,  -0.006162663784351, 0.004077103252894};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 28, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.013856898061713,  0.011108915536614,  0.000000000000000,  -0.000000000000000, 0.026366038642949,
        0.002022910436959,  0.000000000000000,  0.000000000000000,  0.007340635226419,  0.000762183002338,  0.000000000000000,  0.000000000000000,
        -0.049053187551067, -0.004334079391413, 0.000000000000000,  0.000000000000000,  0.016266568672701,  0.016315913438844,  0.000000000000000,
        0.000000000000000,  0.019455852506036,  0.015392113153739,  0.000000000000000,  0.000000000000000,  0.020088601462778,  0.001904586090994,
        0.000000000000000,  0.000000000000000,  0.005537133249482,  0.000868533348873,  0.000000000000000,  0.000000000000000,  -0.038930675315084,
        -0.004119620205152, 0.000000000000000,  0.000000000000000,  0.025959604931590,  0.022710332021227,  -0.019457764032903, -0.023845803505515,
        -0.091707846058266, -0.063513734425569, -0.099726785232941, -0.069449593434248, 0.008134280558022,  0.004217486592776,  -0.033766368350787,
        -0.021640063286593, -0.000416075398271, -0.000668357662450, 0.182950087669414,  0.131996602982501,  -0.040938934303479, -0.031527905964130,
        -0.021023754222567, -0.030381397069012, -0.131849333110009, -0.089276385666471, -0.027978421306197, -0.032528159851260, -0.036677574657363,
        -0.051226704539081, -0.069924048035908, -0.054552610860953, 0.002407508298947,  0.002202191159676,  -0.014041968396816, -0.010585089245443,
        -0.000379034884731, 0.001550490847274,  0.148933482543690,  0.117296748825997,  -0.018215029622874, -0.018922887733640, -0.041016676670190,
        -0.047906013320817, -0.051525623718912, -0.072223329011301, 0.525651036143242,  0.401310997532173,  0.003058916833263,  0.056896222754146,
        0.000000000000000,  0.000000000000000,  0.008508517899519,  -0.025169353585389, 0.000000000000000,  0.000000000000000,  0.122954749670083,
        0.058322266413808,  0.000000000000000,  0.000000000000000,  -0.073131284382718, -0.056428860594317, 0.000000000000000,  0.000000000000000,
        -0.025658802736006, -0.005184470196426, 0.302144513396516,  0.291797782236476,  0.017300818209191,  0.066563274258566,  0.000000000000000,
        0.000000000000000,  -0.004406977283476, -0.019888375068210, 0.000000000000000,  0.000000000000000,  0.077203501456469,  0.049361000603209,
        0.000000000000000,  0.000000000000000,  -0.053207266203305, -0.042356968450039, 0.000000000000000,  0.000000000000000,  -0.017177413097203,
        -0.004426857324550, 0.001474705755343,  -0.006229615157572, -0.168221117680945, -0.120034215818339, -0.031830979904670, -0.004624055777315,
        -0.217962442248637, -0.172863411667454, -0.283421524486472, -0.145050007606867, -0.058147384669310, -0.042588323400502, 0.134211962934807,
        0.090344282539445,  -0.222504725894186, -0.164687700574948, 0.023392814733089,  0.014490760052972,  0.019007207013239,  0.018997690547889,
        -0.013704954992802, -0.013612511980564, -0.069157384901741, -0.050551712745381, 0.082268466395153,  0.056656197152045,  -0.099829819165752,
        -0.085736869678104, -0.057205865505701, -0.022980089567368, -0.024304703175748, 0.016397232489638,  0.189554595796061,  0.125005144973737,
        -0.094976370700260, -0.083089671671140, 0.001347430410651,  0.001050885892521,  0.011037799892852,  0.012103345010844,  0.000000000000000,
        0.000000000000000,  0.017157220807178,  -0.043069811227568, 0.664901811456054,  0.507622720910352,  0.039132227088277,  -0.013970452559411,
        0.000000000000000,  0.000000000000000,  0.064721790555510,  0.020353444834818,  0.000000000000000,  0.000000000000000,  0.111115971286706,
        0.011866709091834,  0.000000000000000,  0.000000000000000,  0.140661736829258,  0.108743900569154,  0.000000000000000,  0.000000000000000,
        -0.005654130982780, -0.042735656532064, 0.382185937942500,  0.369098243221234,  0.021070087839932,  0.006162929777557,  0.000000000000000,
        0.000000000000000,  0.022235757490684,  0.018844987360719,  0.000000000000000,  0.000000000000000,  0.046772714736576,  0.000716581015083,
        0.000000000000000,  0.000000000000000,  0.120467371370862,  0.101612100598247,  -0.027254139857581, -0.014970098966084, -0.041617285017402,
        -0.038117449659885, -0.113214310429768, -0.071588264280840, -0.255064053322841, -0.159389269022106, -0.078117725274196, 0.005668202822781,
        -0.220474335571700, -0.127259387105301, -0.169053015654707, -0.079258538541382, -0.107429643864426, -0.083089776256410, -0.049415790328234,
        -0.032852091273365, 0.017072518603614,  0.014397752522703,  -0.006317149869367, -0.008392780129625, -0.021952250600734, 0.002860044119419,
        0.039797932459286,  0.011951677958368,  -0.090850672268524, 0.043631008142370,  0.120632831884838,  0.100607051225477,  -0.072304107962971,
        0.028702908534639,  -0.104828769999095, -0.065896788922882, -0.047714687245377, -0.004350165088665, 0.005186720496564,  0.009518353540163,
        0.008209693535777,  -0.013987157515196, 0.000000000000000,  0.000000000000000,  0.214779779831138,  0.092163044258571,  0.000000000000000,
        0.000000000000000,  0.093179588332841,  -0.009686923788688, 0.705234869555693,  0.538415202360114,  -0.156899811649893, -0.079191064963056,
        0.000000000000000,  0.000000000000000,  0.062119725555227,  -0.006457949192459, 0.000000000000000,  -0.000000000000000, -0.089491574929641,
        -0.038401268441071, 0.000000000000000,  0.000000000000000,  0.158297048912439,  0.082488837191837,  0.000000000000000,  0.000000000000000,
        0.020309739984946,  -0.027437586662276, 0.405369402589923,  0.391487806058665,  -0.099877908077262, -0.043692107712574, 0.000000000000000,
        0.000000000000000,  0.013539826656631,  -0.018291724441517, -0.000000000000000, 0.000000000000000,  -0.065957103713517, -0.034370348829932,
        -0.087328617406724, -0.057017862284489, 0.045410368976767,  0.040454650275549,  -0.148995094548039, -0.071709930362820, 0.092916505304545,
        0.088518364338505,  0.182895159275838,  0.095038342680401,  -0.100830105321219, -0.004485888936398, -0.099330063032026, -0.047806620241880,
        0.061944336869697,  0.059012242892337,  0.036386923919468,  0.023757442618537,  -0.018920987073653, -0.016856104281479, -0.002572322932609,
        0.000548551694873,  0.023570789517845,  0.043769116332432,  -0.221584022531941, -0.148562344600097, 0.051849433310747,  0.129257153959373,
        0.188685995886233,  0.106698449731165,  -0.000800047995225, 0.153802050060915,  -0.147722681687961, -0.099041563066731, 0.034566288873831,
        0.086171435972915,  0.001071801221921,  -0.000228563206197, -0.009821162299102, -0.018237131805180, 0.000000000000000,  0.000000000000000,
        -0.102262298050791, -0.098557935093508, 0.000000000000000,  0.000000000000000,  0.111115971286706,  0.011866709091834,  0.000000000000000,
        0.000000000000000,  0.043147860370340,  0.013568963223212,  0.664901811456054,  0.507622720910351,  -0.053464415650645, -0.023859376802607,
        0.000000000000000,  0.000000000000000,  -0.179106577393878, -0.095131412547539, 0.000000000000000,  0.000000000000000,  -0.094624407933164,
        -0.092956266182827, 0.000000000000000,  0.000000000000000,  0.046772714736576,  0.000716581015083,  0.000000000000000,  0.000000000000000,
        0.014823838327122,  0.012563324907146,  0.382185937942500,  0.369098243221235,  -0.017907174440548, 0.005565778931655,  0.000000000000000,
        0.000000000000000,  -0.137740388553238, -0.086976587988652, 0.028578021071017,  0.020088882106636,  -0.027538689893419, -0.024269696053578,
        -0.169053015654707, -0.079258538541382, -0.107429643864426, -0.083089776256410, -0.052078483516131, 0.003778801881854,  -0.146982890381134,
        -0.084839591403534, 0.027663202615821,  -0.005539482163022, -0.165539350102487, -0.090147788808431, 0.079250014123749,  0.050264081219418,
        0.011876479352713,  0.012339150609031,  -0.006176490721368, -0.010227003537303, -0.013914004850852, 0.011749367206873,  -0.104828769999095,
        -0.065896788922882, -0.047714687245377, -0.004350165088665, 0.080421887923225,  0.067071367483651,  -0.048202738641981, 0.019135272356426,
        0.127155240791865,  0.066865668727436,  -0.051088432897377, 0.047256145716258,  -0.001258324275921, -0.004770791255352, 0.007203118342981,
        0.014297639028627,  0.000000000000000,  0.000000000000000,  -0.025658802736006, -0.005184470196426, 0.000000000000000,  0.000000000000000,
        0.098899502752317,  0.062031309659187,  0.000000000000000,  -0.000000000000000, -0.051231145695868, -0.024300944339087, 0.000000000000000,
        0.000000000000000,  -0.123195709322876, -0.053804093250281, 0.525651036143241,  0.401310997532173,  -0.047831041926482, 0.046613690197901,
        0.000000000000000,  0.000000000000000,  -0.017177413097203, -0.004426857324550, 0.000000000000000,  0.000000000000000,  0.067186306286732,
        0.046114290204356,  0.000000000000000,  0.000000000000000,  -0.032168125606862, -0.020567083584671, 0.000000000000000,  0.000000000000000,
        -0.075855404376548, -0.039092464034720, 0.302144513396516,  0.291797782236476,  -0.016767717766929, 0.057783340564876,  0.023392814733089,
        0.014490760052972,  0.019007207013239,  0.018997690547889,  -0.188799492772350, -0.119528392401070, 0.191173044650556,  0.136305475497079,
        0.118092301869363,  0.060437503169528,  0.024228076945546,  0.017745134750209,  0.247171950376108,  0.144539172404325,  -0.057822738114524,
        -0.027798705713897, 0.047870454975970,  0.022510392280822,  -0.130523490438020, -0.082355462898360, 0.001347430410651,  0.001050885892521,
        0.011037799892852,  0.012103345010844,  -0.209400164657060, -0.137011399747438, 0.078545863285750,  0.069434981817336,  0.023835777294042,
        0.009575037319737,  0.010126959656561,  -0.006832180204016, 0.183701373906927,  0.118021499328738,  -0.015851670158254, -0.015946232647547,
        -0.011032551345012, -0.011528254960397, -0.047265748447584, -0.026546745140541, 0.000000000000000,  0.000000000000000,  -0.029298987593773,
        -0.017318007835208, 0.000000000000000,  0.000000000000000,  0.028436803214819,  0.003579143656212,  0.000000000000000,  0.000000000000000,
        -0.037518802268364, -0.003895602011952, -0.000000000000000, 0.000000000000000,  0.005921457509503,  0.001274265832884,  0.000000000000000,
        0.000000000000000,  0.016520139449269,  0.011313698646088,  0.000000000000000,  0.000000000000000,  -0.035258309158622, -0.023800037878720,
        0.000000000000000,  0.000000000000000,  0.025478547495396,  0.003465436997566,  0.000000000000000,  0.000000000000000,  -0.028300903275130,
        -0.004439170449798, -0.000000000000000, -0.000000000000000, 0.006748574708255,  0.001255854410138,  0.000000000000000,  0.000000000000000,
        0.021356090220773,  0.015614800112892,  0.044566007462144,  0.045918706194562,  0.148324329624513,  0.106564052020161,  -0.101219367539492,
        -0.081732224345262, 0.071977573382070,  0.062551004719878,  0.172583660459576,  0.110604767909251,  0.002126607591165,  0.003416050274746,
        -0.018677154437436, -0.019604084618987, 0.038914264310957,  0.034982059525560,  -0.024268743756904, -0.027020932003534, -0.095074595764748,
        -0.067046557365519, 0.043759286851811,  0.050461941795577,  0.061593115242963,  0.085538239615168,  -0.121565029293707, -0.097543825289344,
        0.036239681369830,  0.038687567371925,  0.071770060694838,  0.054101567254488,  0.001937289410846,  -0.007924730997180, -0.042783665229675,
        -0.034964295020439, 0.020281954614679,  0.021802165134309,  -0.028538887708471, -0.033050476893003, -0.038734917983886, -0.053947674545232};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 28, 20));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeFFForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix efxmat(28, 28);

    CDenseMatrix efymat(28, 28);

    CDenseMatrix efzmat(28, 28);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.010227655319745, -0.039340605847321, 0.000000000000000,  0.000000000000000,  0.012658284904276,
        -0.078432776921148, 0.000000000000000,  0.000000000000000,  -0.043685877531498, 0.026058713769039,  0.000000000000000,  0.000000000000000,
        -0.107699958452901, -0.088340029750936, 0.000000000000000,  0.000000000000000,  0.098766627247183,  0.092924223133202,  0.000000000000000,
        0.000000000000000,  -0.029432583472737, -0.014639844227523, 0.000000000000000,  0.000000000000000,  0.043601179088453,  0.107500327609554,
        0.000000000000000,  0.000000000000000,  -0.003019886738694, -0.025938134227310, 0.000000000000000,  0.000000000000000,  0.000642994002580,
        -0.074686519096162, 0.000000000000000,  0.000000000000000,  -0.022154546565600, 0.020428679818651,  0.000000000000000,  0.000000000000000,
        -0.050960692800125, -0.063371907605655, 0.000000000000000,  0.000000000000000,  0.069068670766447,  0.075576354075987,  0.000000000000000,
        0.000000000000000,  -0.039381415374130, -0.021918545033261, 0.000000000000000,  0.000000000000000,  0.043524181854545,  0.105232961526166,
        -0.010227655319745, -0.003019886738694, 0.076032312189591,  0.021006946791862,  -0.042723338118501, -0.020853739292967, -0.070538452157395,
        -0.053083993905692, -0.008698508864906, -0.012939853941806, -0.024948878597190, -0.025532145587752, 0.022967348858346,  0.033820372358810,
        0.023644218847902,  0.015334969896229,  -0.007753594935491, -0.012767505310523, -0.008299625655395, -0.013740637139756, 0.043309426131685,
        0.015322026548897,  0.034283858707810,  0.016955393037861,  -0.035855151086739, -0.041761619116810, 0.005242811454939,  0.005013147963114,
        -0.039340605847321, -0.025938134227310, 0.021006946791862,  0.002016255789066,  -0.012439313974390, 0.001523999380942,  -0.053083993905692,
        -0.093032256690036, 0.002810342532787,  -0.002222272349346, -0.025532145587752, -0.038543357352044, -0.021574594775417, -0.007397581022817,
        0.015334969896229,  0.025214212287923,  -0.000299605552213, -0.005561163476224, -0.013740637139756, -0.024399423592820, 0.045417750062191,
        0.030190980859065,  0.016955393037861,  0.014503115897639,  -0.103124039091005, -0.102635240943110, 0.005013147963114,  0.007885327630906,
        0.000000000000000,  0.000000000000000,  -0.042723338118501, -0.012439313974390, 0.000000000000000,  0.000000000000000,  -0.006632349634639,
        0.009786974858734,  0.000000000000000,  0.000000000000000,  -0.050223153601753, -0.059984264717547, 0.000000000000000,  0.000000000000000,
        -0.054206740257405, 0.029463261764762,  0.000000000000000,  0.000000000000000,  0.010997367479547,  0.009828283257857,  0.000000000000000,
        0.000000000000000,  -0.103861902122730, -0.048555630583624, 0.000000000000000,  0.000000000000000,  -0.029512060155019, -0.038182208987104,
        0.000000000000000,  0.000000000000000,  -0.020853739292967, 0.001523999380942,  0.000000000000000,  0.000000000000000,  -0.006302892105680,
        0.004250739854165,  0.000000000000000,  0.000000000000000,  -0.026084674647525, -0.061937221237217, 0.000000000000000,  0.000000000000000,
        -0.013689537554470, 0.031181338293878,  0.000000000000000,  0.000000000000000,  0.026723040879842,  0.011836855479724,  0.000000000000000,
        0.000000000000000,  -0.070835901194388, -0.033508562517575, 0.000000000000000,  0.000000000000000,  -0.013243462469201, -0.026271264885997,
        0.012658284904276,  0.000642994002580,  -0.070538452157395, -0.053083993905692, -0.006632349634639, -0.006302892105680, 0.084177070946360,
        -0.007948173175195, 0.010247279997139,  0.012093760230179,  -0.036525798022901, -0.041825485281963, -0.056445754237878, -0.036022768410696,
        0.061299417478063,  0.044344238887089,  -0.062835783569906, -0.025628406853147, 0.005783577836663,  -0.025605735497368, 0.114082047278970,
        0.079787243710838,  -0.032054857852470, -0.024611908911590, 0.065806127982497,  0.054341965937371,  -0.020817607919767, -0.001439715662977,
        -0.078432776921148, -0.074686519096162, -0.053083993905692, -0.093032256690036, 0.009786974858734,  0.004250739854165,  -0.007948173175195,
        -0.083005531896711, 0.032586332494316,  0.038016947552563,  -0.041825485281963, -0.110960178325588, -0.035354616059137, -0.028053017643183,
        0.044344238887089,  0.070506817804655,  -0.041455663941860, -0.032200059451257, -0.025605735497368, -0.076099653186081, 0.046128300570965,
        0.032442850284532,  -0.024611908911590, -0.028358752351186, 0.028025082156990,  0.030580147829351,  -0.001439715662977, 0.015089804395607,
        0.000000000000000,  0.000000000000000,  -0.008698508864906, 0.002810342532787,  0.000000000000000,  0.000000000000000,  0.010247279997139,
        0.032586332494316,  0.000000000000000,  0.000000000000000,  -0.027094502261658, -0.016321163180893, 0.000000000000000,  0.000000000000000,
        0.019758852018042,  0.026595012758092,  0.000000000000000,  0.000000000000000,  -0.037559448472539, -0.032506226106485, 0.000000000000000,
        0.000000000000000,  0.008883760994855,  -0.001627811537717, 0.000000000000000,  0.000000000000000,  0.025044240441076,  -0.003948855046270,
        0.000000000000000,  0.000000000000000,  -0.012939853941806, -0.002222272349346, 0.000000000000000,  0.000000000000000,  0.012093760230179,
        0.038016947552563,  0.000000000000000,  0.000000000000000,  -0.024226350471546, -0.016328007784436, 0.000000000000000,  0.000000000000000,
        0.012828957360288,  0.021229878993205,  0.000000000000000,  0.000000000000000,  -0.033737280723351, -0.029100805101408, 0.000000000000000,
        0.000000000000000,  0.005154092686932,  -0.001137471919082, 0.000000000000000,  0.000000000000000,  0.027427989838970,  0.003928621915619,
        -0.043685877531498, -0.022154546565600, -0.024948878597190, -0.025532145587752, -0.050223153601753, -0.026084674647525, -0.036525798022901,
        -0.041825485281963, -0.027094502261658, -0.024226350471546, 0.384380021416957,  0.212922388755730,  0.042965601179275,  0.012873957992328,
        0.106628525244577,  0.076991316916565,  0.013406089610227,  0.024344603707048,  -0.025517625934646, -0.033837180100271, -0.083413698567089,
        -0.037288725902073, -0.142180895741272, -0.100370791793001, -0.097312057547628, -0.063444264429294, -0.014421933384641, -0.005003608456684,
        0.026058713769039,  0.020428679818651,  -0.025532145587752, -0.038543357352044, -0.059984264717547, -0.061937221237217, -0.041825485281963,
        -0.110960178325588, -0.016321163180893, -0.016328007784436, 0.212922388755730,  0.214375635405289,  -0.007326369900511, -0.010726627901277,
        0.076991316916565,  0.091870495071689,  0.047426012654044,  0.035979492648731,  -0.033837180100271, -0.097677116605601, 0.004402556009653,
        0.008005470491085,  -0.100370791793001, -0.123573888011922, -0.101486392778027, -0.080535095377744, -0.005003608456684, 0.003125690629412,
        0.000000000000000,  0.000000000000000,  0.022967348858346,  -0.021574594775417, 0.000000000000000,  0.000000000000000,  -0.056445754237878,
        -0.035354616059137, 0.000000000000000,  0.000000000000000,  0.042965601179275,  -0.007326369900511, 0.000000000000000,  0.000000000000000,
        0.031236140263841,  -0.018195759699781, 0.000000000000000,  0.000000000000000,  -0.061714698949944, 0.049541631038050,  0.000000000000000,
        0.000000000000000,  -0.044946527839675, -0.031528733240571, 0.000000000000000,  0.000000000000000,  0.005704043443056,  0.007416595766668,
        0.000000000000000,  0.000000000000000,  0.033820372358810,  -0.007397581022817, 0.000000000000000,  0.000000000000000,  -0.036022768410696,
        -0.028053017643183, 0.000000000000000,  0.000000000000000,  0.012873957992328,  -0.010726627901277, 0.000000000000000,  0.000000000000000,
        0.004531805539053,  -0.019121135382378, 0.000000000000000,  0.000000000000000,  -0.037061935149649, 0.057640913032014,  0.000000000000000,
        0.000000000000000,  -0.022008679672979, -0.023963547238237, 0.000000000000000,  0.000000000000000,  0.000013816543018,  0.003471707549771,
        -0.107699958452901, -0.050960692800125, 0.023644218847902,  0.015334969896229,  -0.054206740257405, -0.013689537554470, 0.061299417478063,
        0.044344238887089,  0.019758852018042,  0.012828957360288,  0.106628525244577,  0.076991316916565,  0.031236140263841,  0.004531805539053,
        0.262815647464461,  0.131764383018170,  0.114892625381809,  0.055379328946895,  0.002861212715605,  0.001539698150534,  0.030388601544068,
        0.031726737998997,  0.026402644432426,  0.007945124189304,  0.084776889202852,  0.049392094577151,  -0.008505047893905, -0.008465868629226,
        -0.088340029750936, -0.063371907605655, 0.015334969896229,  0.025214212287923,  0.029463261764762,  0.031181338293878,  0.044344238887089,
        0.070506817804655,  0.026595012758092,  0.021229878993205,  0.076991316916565,  0.091870495071689,  -0.018195759699781, -0.019121135382378,
        0.131764383018170,  0.136178783923716,  -0.028290965047150, -0.047802519172050, 0.001539698150534,  -0.016578176069754, 0.021771221714016,
        0.021859475394250,  0.007945124189304,  0.014676865181858,  0.041944171709316,  0.031967222008425,  -0.008465868629226, -0.015063302123390,
        0.000000000000000,  0.000000000000000,  -0.007753594935491, -0.000299605552213, 0.000000000000000,  0.000000000000000,  -0.062835783569906,
        -0.041455663941860, 0.000000000000000,  0.000000000000000,  0.013406089610227,  0.047426012654044,  0.000000000000000,  0.000000000000000,
        0.114892625381809,  -0.028290965047150, 0.000000000000000,  0.000000000000000,  -0.037854079641958, -0.020283739796771, 0.000000000000000,
        0.000000000000000,  0.057749882872252,  0.045952778112902,  0.000000000000000,  0.000000000000000,  -0.006966046458424, 0.026527600224674,
        0.000000000000000,  0.000000000000000,  -0.012767505310523, -0.005561163476224, 0.000000000000000,  0.000000000000000,  -0.025628406853147,
        -0.032200059451257, 0.000000000000000,  0.000000000000000,  0.024344603707048,  0.035979492648731,  0.000000000000000,  0.000000000000000,
        0.055379328946895,  -0.047802519172050, 0.000000000000000,  0.000000000000000,  -0.025977577176869, -0.019730791355794, 0.000000000000000,
        0.000000000000000,  0.035142085534293,  0.048703706384790,  0.000000000000000,  0.000000000000000,  -0.027645561152171, 0.010592542879537,
        0.098766627247183,  0.069068670766447,  -0.008299625655395, -0.013740637139756, 0.010997367479547,  0.026723040879842,  0.005783577836663,
        -0.025605735497368, -0.037559448472539, -0.033737280723351, -0.025517625934646, -0.033837180100271, -0.061714698949944, -0.037061935149649,
        0.002861212715605,  0.001539698150534,  -0.037854079641958, -0.025977577176869, 0.102777126045623,  0.002658701519551,  0.029601045533675,
        0.006887889397839,  -0.072429373724166, -0.054220567550707, 0.070673102151196,  0.027404531830423,  -0.001539677358537, 0.001732625499484,
        0.092924223133202,  0.075576354075987,  -0.013740637139756, -0.024399423592820, 0.009828283257857,  0.011836855479724,  -0.025605735497368,
        -0.076099653186081, -0.032506226106485, -0.029100805101408, -0.033837180100271, -0.097677116605601, 0.049541631038050,  0.057640913032014,
        0.001539698150534,  -0.016578176069754, -0.020283739796771, -0.019730791355794, 0.002658701519551,  -0.072713556911942, -0.063790138874066,
        -0.068235857914663, -0.054220567550707, -0.086612006573995, 0.080455164487233,  0.056899500310428,  0.001732625499484,  0.008779968089592,
        0.000000000000000,  0.000000000000000,  0.043309426131685,  0.045417750062191,  0.000000000000000,  0.000000000000000,  0.114082047278970,
        0.046128300570965,  0.000000000000000,  0.000000000000000,  -0.083413698567089, 0.004402556009653,  0.000000000000000,  0.000000000000000,
        0.030388601544068,  0.021771221714016,  0.000000000000000,  0.000000000000000,  0.029601045533675,  -0.063790138874066, 0.000000000000000,
        0.000000000000000,  0.059996383469393,  0.025429212525053,  0.000000000000000,  0.000000000000000,  -0.040889872903647, -0.005941227280491,
        0.000000000000000,  0.000000000000000,  0.015322026548897,  0.030190980859065,  0.000000000000000,  0.000000000000000,  0.079787243710838,
        0.032442850284532,  0.000000000000000,  0.000000000000000,  -0.037288725902073, 0.008005470491085,  0.000000000000000,  0.000000000000000,
        0.031726737998997,  0.021859475394250,  0.000000000000000,  0.000000000000000,  0.006887889397839,  -0.068235857914663, 0.000000000000000,
        0.000000000000000,  0.013542049227940,  0.012266567871697,  0.000000000000000,  0.000000000000000,  -0.025868880711085, 0.004743438253236,
        -0.029432583472737, -0.039381415374130, 0.034283858707810,  0.016955393037861,  -0.103861902122730, -0.070835901194388, -0.032054857852470,
        -0.024611908911590, 0.008883760994855,  0.005154092686932,  -0.142180895741272, -0.100370791793001, -0.044946527839675, -0.022008679672979,
        0.026402644432426,  0.007945124189304,  0.057749882872252,  0.035142085534293,  -0.072429373724166, -0.054220567550707, 0.059996383469393,
        0.013542049227940,  0.171756215623503,  0.079003056113365,  0.036879793831116,  0.008402489180644,  -0.041299237086079, -0.026620254660376,
        -0.014639844227523, -0.021918545033261, 0.016955393037861,  0.014503115897639,  -0.048555630583624, -0.033508562517575, -0.024611908911590,
        -0.028358752351186, -0.001627811537717, -0.001137471919082, -0.100370791793001, -0.123573888011922, -0.031528733240571, -0.023963547238237,
        0.007945124189304,  0.014676865181858,  0.045952778112902,  0.048703706384790,  -0.054220567550707, -0.086612006573995, 0.025429212525053,
        0.012266567871697,  0.079003056113365,  0.066726146833519,  -0.065836240846656, -0.066764709124370, -0.026620254660376, -0.054344532177685,
        0.000000000000000,  0.000000000000000,  -0.035855151086739, -0.103124039091005, 0.000000000000000,  0.000000000000000,  0.065806127982497,
        0.028025082156990,  0.000000000000000,  0.000000000000000,  -0.097312057547628, -0.101486392778027, 0.000000000000000,  0.000000000000000,
        0.084776889202852,  0.041944171709316,  0.000000000000000,  0.000000000000000,  0.070673102151196,  0.080455164487233,  0.000000000000000,
        0.000000000000000,  0.036879793831116,  -0.065836240846656, 0.000000000000000,  0.000000000000000,  -0.014108811585051, -0.040366264302148,
        0.000000000000000,  0.000000000000000,  -0.041761619116810, -0.102635240943110, 0.000000000000000,  0.000000000000000,  0.054341965937371,
        0.030580147829351,  0.000000000000000,  0.000000000000000,  -0.063444264429294, -0.080535095377744, 0.000000000000000,  0.000000000000000,
        0.049392094577151,  0.031967222008425,  0.000000000000000,  0.000000000000000,  0.027404531830423,  0.056899500310428,  0.000000000000000,
        0.000000000000000,  0.008402489180644,  -0.066764709124370, 0.000000000000000,  0.000000000000000,  -0.004752610200354, -0.026598481812314,
        0.043601179088453,  0.043524181854545,  0.005242811454939,  0.005013147963114,  -0.029512060155019, -0.013243462469201, -0.020817607919767,
        -0.001439715662977, 0.025044240441076,  0.027427989838970,  -0.014421933384641, -0.005003608456684, 0.005704043443056,  0.000013816543018,
        -0.008505047893905, -0.008465868629226, -0.006966046458424, -0.027645561152171, -0.001539677358537, 0.001732625499484,  -0.040889872903647,
        -0.025868880711085, -0.041299237086079, -0.026620254660376, -0.014108811585051, -0.004752610200354, 0.076970610099210,  0.021106585480372,
        0.107500327609554,  0.105232961526166,  0.005013147963114,  0.007885327630906,  -0.038182208987104, -0.026271264885997, -0.001439715662977,
        0.015089804395607,  -0.003948855046270, 0.003928621915619,  -0.005003608456684, 0.003125690629412,  0.007416595766668,  0.003471707549771,
        -0.008465868629226, -0.015063302123390, 0.026527600224674,  0.010592542879537,  0.001732625499484,  0.008779968089592,  -0.005941227280491,
        0.004743438253236,  -0.026620254660376, -0.054344532177685, -0.040366264302148, -0.026598481812314, 0.021106585480372,  0.000605301135855};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 28, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.013009307845394, -0.057513712127115, 0.000000000000000,  0.000000000000000,  -0.032867655075811,
        -0.014836156329413, 0.000000000000000,  0.000000000000000,  -0.104180041833706, -0.099656759937945, 0.000000000000000,  0.000000000000000,
        0.028583671745064,  0.034711470033678,  0.000000000000000,  0.000000000000000,  0.167508352623606,  0.101326655700131,  0.000000000000000,
        0.000000000000000,  0.005639474097059,  -0.083130811469015, 0.000000000000000,  0.000000000000000,  -0.026407777943760, -0.070605610156524,
        0.000000000000000,  0.000000000000000,  -0.004129886424731, -0.038026409197177, 0.000000000000000,  0.000000000000000,  -0.041432900287137,
        -0.022112089866854, 0.000000000000000,  0.000000000000000,  -0.065021783354748, -0.078173474287022, 0.000000000000000,  0.000000000000000,
        0.009736967515911,  0.024133979402245,  0.000000000000000,  0.000000000000000,  0.104170234930109,  0.081022907375014,  0.000000000000000,
        0.000000000000000,  -0.025606924774064, -0.088163483642774, 0.000000000000000,  0.000000000000000,  -0.028089631646737, -0.069505859193298,
        -0.013009307845394, -0.004129886424731, 0.118158283382066,  0.035317480649566,  0.039874354528610,  0.013270541635890,  0.038889065653291,
        0.020166783886432,  0.005607209768205,  0.017540419347016,  0.009766094116518,  0.012075743175336,  -0.015805765834459, -0.019850928601875,
        -0.010401598014226, -0.005541851554001, -0.008698508864906, -0.012939853941806, 0.021641389861958,  0.014778942367211,  -0.002105110245230,
        -0.008924598695126, -0.029658645476827, -0.026848355958749, 0.026563108839701,  0.028767569000833,  -0.002236596493653, -0.001837002740968,
        -0.057513712127115, -0.038026409197177, 0.035317480649566,  0.008771397220994,  0.045221437960302,  0.029997436025471,  0.020166783886432,
        0.017211245530159,  -0.009013701672895, 0.000473811663809,  0.012075743175336,  0.017616282906143,  0.009631571246521,  0.002923346926007,
        -0.005541851554001, -0.008645216205356, 0.002810342532787,  -0.002222272349346, 0.014778942367211,  0.016318813120539,  0.029374571027904,
        0.028745054821363,  -0.026848355958749, -0.061244835721138, 0.069810634310515,  0.069072942452887,  -0.001837002740968, -0.002296613080935,
        0.000000000000000,  0.000000000000000,  0.039874354528610,  0.045221437960302,  0.000000000000000,  0.000000000000000,  0.020908328979499,
        0.024539000255623,  0.000000000000000,  0.000000000000000,  -0.024257587206099, 0.008320371633044,  0.000000000000000,  0.000000000000000,
        -0.087312002516991, 0.018004445891245,  0.000000000000000,  0.000000000000000,  0.033977826323174,  -0.063024764881919, 0.000000000000000,
        0.000000000000000,  0.110912804987275,  0.039517196359829,  0.000000000000000,  0.000000000000000,  0.020823528871332,  -0.021911520258294,
        0.000000000000000,  0.000000000000000,  0.013270541635890,  0.029997436025471,  0.000000000000000,  0.000000000000000,  -0.003463517946518,
        0.011331590517870,  0.000000000000000,  0.000000000000000,  0.006436511682611,  0.010438749578855,  0.000000000000000,  0.000000000000000,
        -0.040551817114757, 0.019963007684382,  0.000000000000000,  0.000000000000000,  0.013441984103049,  -0.068025902521092, 0.000000000000000,
        0.000000000000000,  0.062862118565981,  0.026098705156404,  0.000000000000000,  0.000000000000000,  0.013993447127177,  -0.024574254267033,
        -0.032867655075811, -0.041432900287137, 0.038889065653291,  0.020166783886432,  0.020908328979499,  -0.003463517946518, 0.208826159583605,
        0.062232414045062,  -0.080603305559616, -0.035936592227011, 0.071631477122948,  0.020466668270488,  -0.032002791275696, -0.025558639915452,
        0.051992150538926,  0.046191827259666,  0.010247279997139,  0.012093760230179,  0.054521657058873,  0.022620006308931,  -0.034383161280525,
        -0.037553311370836, 0.033790261775659,  0.036618854825404,  0.035466988241028,  0.043450409802296,  0.036261154910333,  0.037526635356619,
        -0.014836156329413, -0.022112089866854, 0.020166783886432,  0.017211245530159,  0.024539000255623,  0.011331590517870,  0.062232414045062,
        -0.012004044284712, -0.038200040866425, -0.029925115613093, 0.020466668270488,  -0.034313283661176, -0.017447444653927, -0.014654676780496,
        0.046191827259666,  0.071871991373292,  0.032586332494316,  0.038016947552563,  0.022620006308931,  -0.025392925617697, -0.023605424409898,
        -0.017868903378334, 0.036618854825404,  0.069028589587239,  0.096692311619218,  0.097036655296601,  0.037526635356619,  0.086620860228224,
        0.000000000000000,  0.000000000000000,  0.005607209768205,  -0.009013701672895, 0.000000000000000,  0.000000000000000,  -0.080603305559616,
        -0.038200040866425, 0.000000000000000,  0.000000000000000,  -0.059863424382884, -0.022401128360012, 0.000000000000000,  0.000000000000000,
        0.131358335396844,  -0.006128454415406, 0.000000000000000,  0.000000000000000,  0.006882523126853,  0.036966995992792,  0.000000000000000,
        0.000000000000000,  0.002016404265049,  -0.012762901109450, 0.000000000000000,  0.000000000000000,  0.017936459535662,  0.021073747814767,
        0.000000000000000,  0.000000000000000,  0.017540419347016,  0.000473811663809,  0.000000000000000,  0.000000000000000,  -0.035936592227011,
        -0.029925115613093, 0.000000000000000,  0.000000000000000,  -0.041568610749272, -0.024987393608937, 0.000000000000000,  0.000000000000000,
        0.066070126747136,  -0.030110953344379, 0.000000000000000,  0.000000000000000,  0.014494905815387,  0.027058857382323,  0.000000000000000,
        0.000000000000000,  -0.009490002584228, -0.022818216774644, 0.000000000000000,  0.000000000000000,  0.003250667187870,  0.015409477495025,
        -0.104180041833706, -0.065021783354748, 0.009766094116518,  0.012075743175336,  -0.024257587206099, 0.006436511682611,  0.071631477122948,
        0.020466668270488,  -0.059863424382884, -0.041568610749272, 0.296999954909861,  0.099265425607682,  -0.025910031300548, -0.026333636822709,
        0.091718317086086,  0.065699128914338,  -0.027094502261658, -0.024226350471546, 0.078211093271187,  0.040960128818723,  -0.024075953980945,
        -0.020704369632195, 0.040173100824328,  0.056361845561907,  -0.043004538708967, -0.048088623045773, -0.005955605887198, 0.006776832540884,
        -0.099656759937945, -0.078173474287022, 0.012075743175336,  0.017616282906143,  0.008320371633044,  0.010438749578855,  0.020466668270488,
        -0.034313283661176, -0.022401128360012, -0.024987393608937, 0.099265425607682,  -0.018578198727665, 0.043436322787624,  0.048702056447617,
        0.065699128914338,  0.059980569823320,  -0.016321163180893, -0.016328007784436, 0.040960128818723,  -0.004789986643569, 0.056228199336190,
        0.058954355806922,  0.056361845561907,  0.132617396927019,  -0.046044420818546, -0.043625330342916, 0.006776832540884,  0.025889417642312,
        0.000000000000000,  0.000000000000000,  -0.015805765834459, 0.009631571246521,  0.000000000000000,  0.000000000000000,  -0.032002791275696,
        -0.017447444653927, 0.000000000000000,  0.000000000000000,  -0.025910031300548, 0.043436322787624,  0.000000000000000,  0.000000000000000,
        0.046854210395761,  -0.027293639549671, 0.000000000000000,  0.000000000000000,  0.042965601179275,  -0.007326369900511, 0.000000000000000,
        0.000000000000000,  0.058978224435179,  0.038109650782611,  0.000000000000000,  0.000000000000000,  -0.001276784881021, 0.019341006056238,
        0.000000000000000,  0.000000000000000,  -0.019850928601875, 0.002923346926007,  0.000000000000000,  0.000000000000000,  -0.025558639915452,
        -0.014654676780496, 0.000000000000000,  0.000000000000000,  -0.026333636822709, 0.048702056447617,  0.000000000000000,  0.000000000000000,
        0.006797708308579,  -0.028681703073568, 0.000000000000000,  0.000000000000000,  0.012873957992328,  -0.010726627901277, 0.000000000000000,
        0.000000000000000,  0.035328210971951,  0.029874318384915,  0.000000000000000,  0.000000000000000,  -0.013788696582447, 0.007950549719049,
        0.028583671745064,  0.009736967515911,  -0.010401598014226, -0.005541851554001, -0.087312002516991, -0.040551817114757, 0.051992150538926,
        0.046191827259666,  0.131358335396844,  0.066070126747136,  0.091718317086086,  0.065699128914338,  0.046854210395761,  0.006797708308579,
        0.394223471196691,  0.197646574527255,  0.019758852018042,  0.012828957360288,  0.106628525244577,  0.076991316916565,  0.031178361201980,
        -0.000451918880830, -0.056292774978965, -0.036861188286366, 0.164365387822100,  0.090949056223223,  -0.021731731331612, -0.018283558543514,
        0.034711470033678,  0.024133979402245,  -0.005541851554001, -0.008645216205356, 0.018004445891245,  0.019963007684382,  0.046191827259666,
        0.071871991373292,  -0.006128454415406, -0.030110953344379, 0.065699128914338,  0.059980569823320,  -0.027293639549671, -0.028681703073568,
        0.197646574527255,  0.204268175885574,  0.026595012758092,  0.021229878993205,  0.076991316916565,  0.091870495071689,  -0.030200239643130,
        -0.031552386324070, -0.036861188286366, -0.059316467028070, 0.095633510432251,  0.071270975779953,  -0.018283558543514, -0.031686231701066,
        0.000000000000000,  0.000000000000000,  -0.008698508864906, 0.002810342532787,  0.000000000000000,  0.000000000000000,  0.010247279997139,
        0.032586332494316,  0.000000000000000,  0.000000000000000,  -0.027094502261658, -0.016321163180893, 0.000000000000000,  0.000000000000000,
        0.019758852018042,  0.026595012758092,  0.000000000000000,  0.000000000000000,  -0.037559448472539, -0.032506226106485, 0.000000000000000,
        0.000000000000000,  0.008883760994855,  -0.001627811537717, 0.000000000000000,  0.000000000000000,  0.025044240441076,  -0.003948855046270,
        0.000000000000000,  0.000000000000000,  -0.012939853941806, -0.002222272349346, 0.000000000000000,  0.000000000000000,  0.012093760230179,
        0.038016947552563,  0.000000000000000,  0.000000000000000,  -0.024226350471546, -0.016328007784436, 0.000000000000000,  0.000000000000000,
        0.012828957360288,  0.021229878993205,  0.000000000000000,  0.000000000000000,  -0.033737280723351, -0.029100805101408, 0.000000000000000,
        0.000000000000000,  0.005154092686932,  -0.001137471919082, 0.000000000000000,  0.000000000000000,  0.027427989838970,  0.003928621915619,
        0.167508352623606,  0.104170234930109,  0.021641389861958,  0.014778942367211,  0.033977826323174,  0.013441984103049,  0.054521657058873,
        0.022620006308931,  0.006882523126853,  0.014494905815387,  0.078211093271187,  0.040960128818723,  0.042965601179275,  0.012873957992328,
        0.106628525244577,  0.076991316916565,  -0.037559448472539, -0.033737280723351, 0.433735766284009,  0.224106209805239,  0.118668653252736,
        0.057575255099304,  0.076332996454987,  0.054298388025145,  -0.055991447299890, -0.038728546310568, -0.005306446077417, 0.002883343534504,
        0.101326655700131,  0.081022907375014,  0.014778942367211,  0.016318813120539,  -0.063024764881919, -0.068025902521092, 0.022620006308931,
        -0.025392925617697, 0.036966995992792,  0.027058857382323,  0.040960128818723,  -0.004789986643569, -0.007326369900511, -0.010726627901277,
        0.076991316916565,  0.091870495071689,  -0.032506226106485, -0.029100805101408, 0.224106209805239,  0.231071316467685,  -0.002894644384840,
        -0.006607364590216, 0.054298388025145,  0.081787518487017,  -0.086760056313249, -0.068679703029760, 0.002883343534504,  0.013859593547961,
        0.000000000000000,  0.000000000000000,  -0.002105110245230, 0.029374571027904,  0.000000000000000,  0.000000000000000,  -0.034383161280525,
        -0.023605424409898, 0.000000000000000,  0.000000000000000,  -0.024075953980945, 0.056228199336190,  0.000000000000000,  0.000000000000000,
        0.031178361201980,  -0.030200239643130, 0.000000000000000,  0.000000000000000,  0.118668653252736,  -0.002894644384840, 0.000000000000000,
        0.000000000000000,  0.059137721772631,  0.028285280820057,  0.000000000000000,  0.000000000000000,  0.032947131758094,  0.038378521088993,
        0.000000000000000,  0.000000000000000,  -0.008924598695126, 0.028745054821363,  0.000000000000000,  0.000000000000000,  -0.037553311370836,
        -0.017868903378334, 0.000000000000000,  0.000000000000000,  -0.020704369632195, 0.058954355806922,  0.000000000000000,  0.000000000000000,
        -0.000451918880830, -0.031552386324070, 0.000000000000000,  0.000000000000000,  0.057575255099304,  -0.006607364590216, 0.000000000000000,
        0.000000000000000,  0.014322253629907,  0.013444371070923,  0.000000000000000,  0.000000000000000,  0.015294947382209,  0.026464809719590,
        0.005639474097059,  -0.025606924774064, -0.029658645476827, -0.026848355958749, 0.110912804987275,  0.062862118565981,  0.033790261775659,
        0.036618854825404,  0.002016404265049,  -0.009490002584228, 0.040173100824328,  0.056361845561907,  0.058978224435179,  0.035328210971951,
        -0.056292774978965, -0.036861188286366, 0.008883760994855,  0.005154092686932,  0.076332996454987,  0.054298388025145,  0.059137721772631,
        0.014322253629907,  0.175073770271189,  0.044349910362193,  -0.062371056379423, -0.052290481024363, 0.016212400974286,  -0.001771675185594,
        -0.083130811469015, -0.088163483642774, -0.026848355958749, -0.061244835721138, 0.039517196359829,  0.026098705156404,  0.036618854825404,
        0.069028589587239,  -0.012762901109450, -0.022818216774644, 0.056361845561907,  0.132617396927019,  0.038109650782611,  0.029874318384915,
        -0.036861188286366, -0.059316467028070, -0.001627811537717, -0.001137471919082, 0.054298388025145,  0.081787518487017,  0.028285280820057,
        0.013444371070923,  0.044349910362193,  -0.012415033310075, -0.027828770055101, -0.030386602995757, -0.001771675185594, -0.017797934028128,
        0.000000000000000,  0.000000000000000,  0.026563108839701,  0.069810634310515,  0.000000000000000,  0.000000000000000,  0.035466988241028,
        0.096692311619218,  0.000000000000000,  0.000000000000000,  -0.043004538708967, -0.046044420818546, 0.000000000000000,  0.000000000000000,
        0.164365387822100,  0.095633510432251,  0.000000000000000,  0.000000000000000,  -0.055991447299890, -0.086760056313249, 0.000000000000000,
        0.000000000000000,  -0.062371056379423, -0.027828770055101, 0.000000000000000,  0.000000000000000,  -0.023495392511800, -0.062046593097088,
        0.000000000000000,  0.000000000000000,  0.028767569000833,  0.069072942452887,  0.000000000000000,  0.000000000000000,  0.043450409802296,
        0.097036655296601,  0.000000000000000,  0.000000000000000,  -0.048088623045773, -0.043625330342916, 0.000000000000000,  0.000000000000000,
        0.090949056223223,  0.071270975779953,  0.000000000000000,  0.000000000000000,  -0.038728546310568, -0.068679703029760, 0.000000000000000,
        0.000000000000000,  -0.052290481024363, -0.030386602995757, 0.000000000000000,  0.000000000000000,  -0.007528858983842, -0.040778514862258,
        -0.026407777943760, -0.028089631646737, -0.002236596493653, -0.001837002740968, 0.020823528871332,  0.013993447127177,  0.036261154910333,
        0.037526635356619,  0.017936459535662,  0.003250667187870,  -0.005955605887198, 0.006776832540884,  -0.001276784881021, -0.013788696582447,
        -0.021731731331612, -0.018283558543514, 0.025044240441076,  0.027427989838970,  -0.005306446077417, 0.002883343534504,  0.032947131758094,
        0.015294947382209,  0.016212400974286,  -0.001771675185594, -0.023495392511800, -0.007528858983842, 0.111346100051134,  0.027852817758785,
        -0.070605610156524, -0.069505859193298, -0.001837002740968, -0.002296613080935, -0.021911520258294, -0.024574254267033, 0.037526635356619,
        0.086620860228224,  0.021073747814767,  0.015409477495025,  0.006776832540884,  0.025889417642312,  0.019341006056238,  0.007950549719049,
        -0.018283558543514, -0.031686231701066, -0.003948855046270, 0.003928621915619,  0.002883343534504,  0.013859593547961,  0.038378521088993,
        0.026464809719590,  -0.001771675185594, -0.017797934028128, -0.062046593097088, -0.040778514862258, 0.027852817758785,  -0.004839061833613};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 28, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.018301137408641, 0.006913789740663,  0.000000000000000,  0.000000000000000,  -0.016744512213617,
        -0.005641358406124, 0.000000000000000,  0.000000000000000,  -0.030332483653627, -0.001533407270810, 0.000000000000000,  0.000000000000000,
        -0.009401296381531, -0.000300869958954, 0.000000000000000,  0.000000000000000,  0.052935931295206,  0.002830646216603,  0.000000000000000,
        0.000000000000000,  -0.018258570170325, -0.008275335638081, 0.000000000000000,  0.000000000000000,  0.001402362109576,  0.000080144079994,
        0.000000000000000,  0.000000000000000,  -0.012156955576494, 0.012357289632049,  0.000000000000000,  0.000000000000000,  -0.017904220095523,
        -0.005559591977999, 0.000000000000000,  0.000000000000000,  -0.019101547339633, -0.001217749712602, 0.000000000000000,  0.000000000000000,
        -0.005773225414380, -0.000151479724006, 0.000000000000000,  0.000000000000000,  0.034414635222503,  0.002134930715638,  0.000000000000000,
        0.000000000000000,  -0.023071600006077, -0.008191171857635, 0.000000000000000,  0.000000000000000,  0.000837515208648,  0.000079014347443,
        -0.018301137408641, -0.012156955576494, 0.387721115392667,  0.167320826395308,  -0.036283199989565, -0.039925467218794, 0.058917853384915,
        0.028067375690990,  -0.102939118587976, -0.067486273403794, 0.004303810561380,  0.003104307856548,  -0.032704260360426, -0.020463851226109,
        -0.005398810978619, -0.003384726719547, 0.187783391082640,  0.128051474998809,  0.006828078676473,  0.003047360580971,  -0.040485891294321,
        -0.052063211293870, 0.077390285965051,  0.034823964628125,  0.001402362109576,  0.000837515208648,  -0.001880067862725, -0.001311044823940,
        0.006913789740663,  0.012357289632049,  0.167320826395308,  0.180907338561850,  -0.062397669090243, -0.061695885547305, 0.028067375690990,
        0.018018599713761,  -0.042521122238564, -0.035879559442874, 0.003104307856548,  0.004203098279031,  -0.010899265157056, -0.008936344403453,
        -0.003384726719547, -0.004195753458773, 0.090466391102577,  0.077045944220638,  0.003047360580971,  -0.007316475197809, -0.091481033105387,
        -0.090908384071647, 0.034823964628125,  0.021926751533124,  0.000080144079994,  0.000079014347443,  -0.001311044823940, -0.001105589292831,
        0.000000000000000,  0.000000000000000,  -0.036283199989565, -0.062397669090243, 0.000000000000000,  0.000000000000000,  0.002234951088832,
        -0.055718261384109, 0.000000000000000,  0.000000000000000,  -0.043257402721998, 0.018347947291250,  0.000000000000000,  0.000000000000000,
        -0.135363830603229, -0.070609917547152, 0.000000000000000,  0.000000000000000,  0.035382876637504,  0.058636843544408,  0.000000000000000,
        0.000000000000000,  0.034217072348120,  0.005502738602901,  0.000000000000000,  0.000000000000000,  0.080686512009034,  0.097582172749817,
        0.000000000000000,  0.000000000000000,  -0.039925467218794, -0.061695885547305, 0.000000000000000,  0.000000000000000,  -0.007092167577451,
        -0.045048466591679, 0.000000000000000,  0.000000000000000,  -0.022423909860105, 0.013408063092834,  0.000000000000000,  0.000000000000000,
        -0.066617256026560, -0.048884204413805, 0.000000000000000,  0.000000000000000,  0.012668719809540,  0.042326020121170,  0.000000000000000,
        0.000000000000000,  0.016054492055951,  0.003387104260717,  0.000000000000000,  0.000000000000000,  0.074630934733430,  0.095625100095023,
        -0.016744512213617, -0.017904220095523, 0.058917853384915,  0.028067375690990,  0.002234951088832,  -0.007092167577451, 0.538836258177675,
        0.240482514199508,  -0.034512623110586, -0.013194374955840, 0.164471890567409,  0.078712584086334,  -0.164718304378308, -0.066674177823917,
        -0.071242286002929, -0.047109263843366, 0.075175229560597,  0.032441004734010,  0.146262327294793,  0.065330914651317,  0.034217072348120,
        0.016054492055951,  -0.040990872631658, -0.024955492914899, 0.038038011211921,  0.033986981126430,  -0.109075971883195, -0.055811539740640,
        -0.005641358406124, -0.005559591977999, 0.028067375690990,  0.018018599713761,  -0.055718261384109, -0.045048466591679, 0.240482514199508,
        0.173171495877638,  0.010060682395738,  -0.000922253635114, 0.078712584086334,  -0.002858293903553, -0.027702385313823, -0.008462065274031,
        -0.047109263843366, -0.071411058816723, 0.025134043957267,  0.000497889146806,  0.065330914651317,  -0.007372663566212, 0.005502738602901,
        0.003387104260717,  -0.024955492914899, -0.013254753093464, 0.008813794946049,  0.008618635709278,  -0.055811539740640, -0.036638758192052,
        0.000000000000000,  0.000000000000000,  -0.102939118587976, -0.042521122238564, 0.000000000000000,  0.000000000000000,  -0.034512623110586,
        0.010060682395738,  0.000000000000000,  0.000000000000000,  -0.104808708524305, -0.077351212322623, 0.000000000000000,  0.000000000000000,
        -0.020236791657490, 0.027480788694659,  0.000000000000000,  0.000000000000000,  -0.064999451439933, 0.002170847005084,  0.000000000000000,
        0.000000000000000,  -0.113258478828540, -0.028146950066365, 0.000000000000000,  0.000000000000000,  -0.101884125099304, -0.073677547233048,
        0.000000000000000,  0.000000000000000,  -0.067486273403794, -0.035879559442874, 0.000000000000000,  0.000000000000000,  -0.013194374955840,
        -0.000922253635114, 0.000000000000000,  0.000000000000000,  -0.073010982464837, -0.071851178973716, 0.000000000000000,  0.000000000000000,
        -0.004279596126444, 0.028935190464990,  0.000000000000000,  0.000000000000000,  -0.017247005845238, 0.002888107524372,  0.000000000000000,
        0.000000000000000,  -0.048110774884342, -0.001062270026649, 0.000000000000000,  0.000000000000000,  -0.078898458809975, -0.063908265318812,
        -0.030332483653627, -0.019101547339633, 0.004303810561380,  0.003104307856548,  -0.043257402721998, -0.022423909860105, 0.164471890567409,
        0.078712584086334,  -0.104808708524305, -0.073010982464837, 0.571063488950154,  0.213644855929271,  0.057107135937003,  0.046106092863638,
        0.026639457091239,  -0.019299376674002, -0.064999451439933, -0.017247005845238, 0.149637053657393,  0.062249928685205,  -0.065463570853655,
        -0.026560095189449, -0.116128674727897, -0.049509526207862, -0.024150381333614, -0.017850753494073, -0.031693620739929, -0.018261417735586,
        -0.001533407270810, -0.001217749712602, 0.003104307856548,  0.004203098279031,  0.018347947291250,  0.013408063092834,  0.078712584086334,
        -0.002858293903553, -0.077351212322623, -0.071851178973716, 0.213644855929271,  0.012733653629032,  0.012780503914315,  -0.002433176005379,
        -0.019299376674002, -0.099644476462213, 0.002170847005084,  0.002888107524372,  0.062249928685205,  -0.024605702561989, -0.067971320326667,
        -0.048990197765746, -0.049509526207862, 0.008298230379477,  -0.001599441530602, -0.000993382027803, -0.018261417735586, 0.003300590166120,
        0.000000000000000,  0.000000000000000,  -0.032704260360426, -0.010899265157056, 0.000000000000000,  0.000000000000000,  -0.164718304378308,
        -0.027702385313823, 0.000000000000000,  0.000000000000000,  0.057107135937003,  0.012780503914315,  0.000000000000000,  0.000000000000000,
        0.113729567910554,  -0.029450612827043, 0.000000000000000,  0.000000000000000,  0.038071423958002,  0.008520335942877,  0.000000000000000,
        0.000000000000000,  0.068632626824295,  0.011542660547426,  0.000000000000000,  0.000000000000000,  0.167155108508847,  0.055707355247177,
        0.000000000000000,  0.000000000000000,  -0.020463851226109, -0.008936344403453, 0.000000000000000,  0.000000000000000,  -0.066674177823917,
        -0.008462065274031, 0.000000000000000,  0.000000000000000,  0.046106092863638,  -0.002433176005379, 0.000000000000000,  0.000000000000000,
        0.015358048442698,  -0.045635814666466, 0.000000000000000,  0.000000000000000,  0.030737395242425,  -0.001622117336919, 0.000000000000000,
        0.000000000000000,  0.027780907426632,  0.003525860530846,  0.000000000000000,  0.000000000000000,  0.104593017377893,  0.045674649173205,
        -0.009401296381531, -0.005773225414380, -0.005398810978619, -0.003384726719547, -0.135363830603229, -0.066617256026560, -0.071242286002929,
        -0.047109263843366, -0.020236791657490, -0.004279596126444, 0.026639457091239,  -0.019299376674002, 0.113729567910554,  0.015358048442698,
        0.388512747758605,  0.118442414859405,  -0.013491194438326, -0.002853064084296, 0.017759638060826,  -0.012866251116001, 0.056401596084678,
        0.027757190011067,  0.029684285834554,  0.019628859934736,  0.048051070394491,  0.029507596562388,  0.027593922779606,  0.017299714344350,
        -0.000300869958954, -0.000151479724006, -0.003384726719547, -0.004195753458773, -0.070609917547152, -0.048884204413805, -0.047109263843366,
        -0.071411058816723, 0.027480788694659,  0.028935190464990,  -0.019299376674002, -0.099644476462213, -0.029450612827043, -0.045635814666466,
        0.118442414859405,  -0.006772269140300, 0.018320525796439,  0.019290126976660,  -0.012866251116001, -0.066429650974809, 0.029420798977980,
        0.020368418505752,  0.019628859934736,  0.029754607840301,  0.001537779790207,  0.000774229700473,  0.017299714344350,  0.021444962122620,
        0.000000000000000,  0.000000000000000,  0.187783391082640,  0.090466391102577,  0.000000000000000,  0.000000000000000,  0.075175229560597,
        0.025134043957267,  0.000000000000000,  0.000000000000000,  -0.064999451439933, 0.002170847005084,  0.000000000000000,  0.000000000000000,
        -0.013491194438326, 0.018320525796439,  0.000000000000000,  0.000000000000000,  -0.050642498991028, -0.079160251493526, 0.000000000000000,
        0.000000000000000,  0.160135095370011,  0.025459980286684,  0.000000000000000,  0.000000000000000,  -0.017755679821168, -0.025872185401280,
        0.000000000000000,  0.000000000000000,  0.128051474998809,  0.077045944220638,  0.000000000000000,  0.000000000000000,  0.032441004734010,
        0.000497889146806,  0.000000000000000,  0.000000000000000,  -0.017247005845238, 0.002888107524372,  0.000000000000000,  0.000000000000000,
        -0.002853064084296, 0.019290126976660,  0.000000000000000,  0.000000000000000,  -0.058638477593805, -0.074257935244026, 0.000000000000000,
        0.000000000000000,  0.066895561368075,  0.001962359750751,  0.000000000000000,  0.000000000000000,  -0.018742865683200, -0.022851361198563,
        0.052935931295206,  0.034414635222503,  0.006828078676473,  0.003047360580971,  0.035382876637504,  0.012668719809540,  0.146262327294793,
        0.065330914651317,  -0.064999451439933, -0.017247005845238, 0.149637053657393,  0.062249928685205,  0.038071423958002,  0.030737395242425,
        0.017759638060826,  -0.012866251116001, -0.050642498991028, -0.058638477593805, 0.446365944235660,  0.161769915358267,  0.110488367716104,
        0.048576453192764,  0.010455444114384,  -0.002152290180215, -0.001786813275048, -0.002675697958940, -0.020354518651547, -0.011982965488446,
        0.002830646216603,  0.002134930715638,  0.003047360580971,  -0.007316475197809, 0.058636843544408,  0.042326020121170,  0.065330914651317,
        -0.007372663566212, 0.002170847005084,  0.002888107524372,  0.062249928685205,  -0.024605702561989, 0.008520335942877,  -0.001622117336919,
        -0.012866251116001, -0.066429650974809, -0.079160251493526, -0.074257935244026, 0.161769915358267,  0.033238405764022,  0.066057495289467,
        0.047469415498444,  -0.002152290180215, -0.007588968726905, -0.000312462623859, -0.000085713930499, -0.011982965488446, 0.000220678955940,
        0.000000000000000,  0.000000000000000,  -0.040485891294321, -0.091481033105387, 0.000000000000000,  0.000000000000000,  0.034217072348120,
        0.005502738602901,  0.000000000000000,  0.000000000000000,  -0.065463570853655, -0.067971320326667, 0.000000000000000,  0.000000000000000,
        0.056401596084678,  0.029420798977980,  0.000000000000000,  0.000000000000000,  0.110488367716104,  0.066057495289467,  0.000000000000000,
        0.000000000000000,  0.070098811245936,  -0.044804496488356, 0.000000000000000,  0.000000000000000,  -0.044498402212672, -0.063644468146559,
        0.000000000000000,  0.000000000000000,  -0.052063211293870, -0.090908384071647, 0.000000000000000,  0.000000000000000,  0.016054492055951,
        0.003387104260717,  0.000000000000000,  0.000000000000000,  -0.026560095189449, -0.048990197765746, 0.000000000000000,  0.000000000000000,
        0.027757190011067,  0.020368418505752,  0.000000000000000,  0.000000000000000,  0.048576453192764,  0.047469415498444,  0.000000000000000,
        0.000000000000000,  0.024749241666853,  -0.038330709807924, 0.000000000000000,  0.000000000000000,  -0.044537296799407, -0.062659770563808,
        -0.018258570170325, -0.023071600006077, 0.077390285965051,  0.034823964628125,  0.034217072348120,  0.016054492055951,  -0.040990872631658,
        -0.024955492914899, -0.113258478828540, -0.048110774884342, -0.116128674727897, -0.049509526207862, 0.068632626824295,  0.027780907426632,
        0.029684285834554,  0.019628859934736,  0.160135095370011,  0.066895561368075,  0.010455444114384,  -0.002152290180215, 0.070098811245936,
        0.024749241666853,  0.457537694124888,  0.190987453251625,  -0.020786542041213, -0.020134833992815, 0.065392985180582,  0.032356293888187,
        -0.008275335638081, -0.008191171857635, 0.034823964628125,  0.021926751533124,  0.005502738602901,  0.003387104260717,  -0.024955492914899,
        -0.013254753093464, -0.028146950066365, -0.001062270026649, -0.049509526207862, 0.008298230379477,  0.011542660547426,  0.003525860530846,
        0.019628859934736,  0.029754607840301,  0.025459980286684,  0.001962359750751,  -0.002152290180215, -0.007588968726905, -0.044804496488356,
        -0.038330709807924, 0.190987453251625,  0.146882902242268,  -0.005751395316630, -0.005646946399943, 0.032356293888187,  0.021025073436356,
        0.000000000000000,  0.000000000000000,  0.001402362109576,  0.000080144079994,  0.000000000000000,  0.000000000000000,  0.038038011211921,
        0.008813794946049,  0.000000000000000,  0.000000000000000,  -0.024150381333614, -0.001599441530602, 0.000000000000000,  0.000000000000000,
        0.048051070394491,  0.001537779790207,  0.000000000000000,  0.000000000000000,  -0.001786813275048, -0.000312462623859, 0.000000000000000,
        0.000000000000000,  -0.020786542041213, -0.005751395316630, 0.000000000000000,  0.000000000000000,  -0.025194390773345, 0.006519844806395,
        0.000000000000000,  0.000000000000000,  0.000837515208648,  0.000079014347443,  0.000000000000000,  0.000000000000000,  0.033986981126430,
        0.008618635709278,  0.000000000000000,  0.000000000000000,  -0.017850753494073, -0.000993382027803, 0.000000000000000,  0.000000000000000,
        0.029507596562388,  0.000774229700473,  0.000000000000000,  0.000000000000000,  -0.002675697958940, -0.000085713930499, 0.000000000000000,
        0.000000000000000,  -0.020134833992815, -0.005646946399943, 0.000000000000000,  0.000000000000000,  -0.016273727193881, 0.011968897851745,
        0.001402362109576,  0.000837515208648,  -0.001880067862725, -0.001311044823940, 0.080686512009034,  0.074630934733430,  -0.109075971883195,
        -0.055811539740640, -0.101884125099304, -0.078898458809975, -0.031693620739929, -0.018261417735586, 0.167155108508847,  0.104593017377893,
        0.027593922779606,  0.017299714344350,  -0.017755679821168, -0.018742865683200, -0.020354518651547, -0.011982965488446, -0.044498402212672,
        -0.044537296799407, 0.065392985180582,  0.032356293888187,  -0.025194390773345, -0.016273727193881, 0.396962511771036,  0.173765213392214,
        0.000080144079994,  0.000079014347443,  -0.001311044823940, -0.001105589292831, 0.097582172749817,  0.095625100095023,  -0.055811539740640,
        -0.036638758192052, -0.073677547233048, -0.063908265318812, -0.018261417735586, 0.003300590166120,  0.055707355247177,  0.045674649173205,
        0.017299714344350,  0.021444962122620,  -0.025872185401280, -0.022851361198563, -0.011982965488446, 0.000220678955940,  -0.063644468146559,
        -0.062659770563808, 0.032356293888187,  0.021025073436356,  0.006519844806395,  0.011968897851745,  0.173765213392214,  0.186341817332167};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 28, 28));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeFGForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix efxmat(28, 36);

    CDenseMatrix efymat(28, 36);

    CDenseMatrix efzmat(28, 36);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.495517528199490,  0.275539272477144,  -0.038771655867001, -0.030128716619864, 0.000000000000000,  0.000000000000000,  0.021925969456185,
        0.063676119082738,  -0.093644010706377, -0.052072027957585, -0.031421923493153, 0.050510109316397,  0.000000000000000,  0.000000000000000,
        0.085283282608543,  -0.009242649744478, 0.000000000000000,  0.000000000000000,  0.112528601457117,  0.093663217522025,  0.000000000000000,
        0.000000000000000,  -0.098530061444032, -0.085632481031848, 0.000000000000000,  0.000000000000000,  0.035529788135172,  0.019126486802906,
        0.000000000000000,  0.000000000000000,  -0.085725322621612, -0.169617123577750, 0.000000000000000,  0.000000000000000,  -0.033918945572197,
        -0.070851095228930, 0.363571407598650,  0.275109587406145,  -0.026893499762042, -0.016656631259332, 0.000000000000000,  0.000000000000000,
        0.007249632901165,  0.038720818647564,  -0.068708537737124, -0.051990825111875, -0.013217980452234, 0.041842379496094,  0.000000000000000,
        0.000000000000000,  0.043219126504357,  -0.005086667595776, 0.000000000000000,  0.000000000000000,  0.042371541014168,  0.059310261641682,
        0.000000000000000,  0.000000000000000,  -0.060830004093136, -0.063782731864899, 0.000000000000000,  0.000000000000000,  0.044676537411749,
        0.027250781766110,  0.000000000000000,  0.000000000000000,  -0.070136543745727, -0.149515856880569, 0.000000000000000,  0.000000000000000,
        -0.017765043707566, -0.051510995736330, -0.020000534163060, -0.011663341407438, 0.116957107204764,  0.046276744694083,  -0.012068656939891,
        -0.001987475522041, -0.023245808362752, 0.000829223214172,  -0.038222294517738, -0.020926999917081, 0.023338879523334,  0.018709351969044,
        0.002901531623274,  -0.001765904155944, 0.001455216155906,  0.004828448104561,  0.001747923308253,  0.016996228475496,  -0.027362183631560,
        -0.015270965529882, 0.006019230895090,  0.001634903508596,  -0.006583216074172, -0.000121322217528, 0.040349594691658,  0.015072803939129,
        -0.023578902637638, -0.009591456204165, -0.047566172565820, -0.053320589608116, -0.011544965828903, -0.007388116273025, -0.020938808397182,
        -0.026336037223255, 0.026287979969026,  0.004959821283066,  0.014257072296303,  0.020651422211248,  0.079306513069755,  0.107195871361058,
        -0.022233535485628, -0.015087241295247, 0.000921800322196,  0.018625131793499,  -0.015046008564142, -0.011474745292610, 0.031707088763138,
        0.035566556888266,  0.008241072448228,  0.005789713161800,  0.008129919102265,  0.005370995145140,  -0.018969236328074, -0.012040725905877,
        -0.026032407033095, -0.028249005901169, 0.009149740378762,  0.006752359857383,  -0.000309213675287, -0.002992616834914, 0.027532154969259,
        0.021660236060421,  -0.016511669546028, -0.011258433076061, -0.063377058156753, -0.069040634593835, -0.012568774043957, -0.012700028795143,
        -0.012063115407276, -0.017994859079825, 0.008771432352323,  0.001006181309490,  0.000000000000000,  0.000000000000000,  0.004228408429836,
        -0.000641488554707, 0.429130767441230,  0.238624009705489,  0.068384903814781,  0.008756678211379,  0.000000000000000,  0.000000000000000,
        0.008623817752409,  0.020243610978489,  -0.162196184367970, -0.090191398075684, 0.089623525875737,  0.089678279728668,  0.000000000000000,
        0.000000000000000,  -0.001281452796233, -0.081773748092009, 0.000000000000000,  0.000000000000000,  -0.033823877000547, -0.020705442167648,
        0.000000000000000,  0.000000000000000,  0.051341640521161,  -0.055331822541242, 0.000000000000000,  0.000000000000000,  0.047244428200846,
        0.023009990985470,  0.000000000000000,  0.000000000000000,  0.018884831992785,  0.032336209346427,  0.000000000000000,  0.000000000000000,
        -0.014902578215020, -0.015165938866033, 0.314862075070098,  0.238251891518375,  0.028597177585710,  0.001412052193159,  0.000000000000000,
        0.000000000000000,  0.002327960080713,  0.015163228371743,  -0.119006678274461, -0.090050750621194, 0.047621431808505,  0.075083504484309,
        0.000000000000000,  0.000000000000000,  -0.013903018713107, -0.066145933382563, 0.000000000000000,  0.000000000000000,  -0.029474724631435,
        -0.012524992387179, 0.000000000000000,  0.000000000000000,  0.017451740992966,  -0.058367137387878, 0.000000000000000,  0.000000000000000,
        0.018555095867934,  0.012225797538697,  0.000000000000000,  0.000000000000000,  0.025530019163269,  0.039910988079775,  0.002821746251213,
        0.001823549325589,  0.038609687852406,  0.015733852463180,  0.011587233053103,  0.000441292966863,  0.181758739685585,  0.088205826899949,
        -0.001559127652046, 0.005231901245039,  -0.030522324236442, 0.024446801557656,  0.013265066149216,  0.017498603299787,  -0.055884196962891,
        -0.015092704837574, -0.037044505346093, -0.024485772180668, -0.066678265794082, -0.042434392367344, -0.065014774295269, -0.033173351012860,
        -0.017002568626539, 0.002943014532163,  0.033510200006090,  0.012077624602472,  0.046618519087858,  0.023471431718333,  0.057922181063101,
        0.041069553902700,  0.042799054408205,  0.000546244697017,  0.059892835576021,  0.048640272943754,  -0.040588046282986, -0.023565062194973,
        -0.034326846043453, -0.031898970795668, 0.027025385401839,  0.026949563174315,  -0.016036873232623, -0.012820803603329, 0.150564506395381,
        0.189079238518400,  0.006316164661257,  0.009135212801257,  0.040000484976378,  0.090870526922684,  0.013525447712679,  0.016173231139270,
        -0.026480371611684, -0.009426232595302, -0.000772886610090, -0.002019799086960, -0.072038128603519, -0.093734047338315, -0.007819307509892,
        -0.006187167108025, 0.004441002687956,  0.017904420594588,  -0.023287815604907, -0.029358704013483, 0.040245064025287,  0.029539706971889,
        0.005819601941540,  0.005291708975430,  0.001859964914866,  -0.024759917716730, 0.064008888692380,  0.062941610850408,  -0.040078437821898,
        -0.051542323173488, -0.000000000000000, -0.000000000000000, -0.019484930072459, -0.000554214845418, 0.000000000000000,  0.000000000000000,
        -0.003908769726898, -0.026897000711773, 0.362681693937869,  0.201674097082973,  -0.016982013889627, -0.036454337345816, 0.000000000000000,
        0.000000000000000,  0.026799252389312,  0.008648421648054,  0.000000000000000,  0.000000000000000,  -0.052063971557068, -0.028284089228279,
        0.000000000000000,  0.000000000000000,  0.051403996726748,  0.023873779369639,  0.000000000000000,  0.000000000000000,  -0.004564052391538,
        0.001875232787547,  0.000000000000000,  0.000000000000000,  -0.006591505477871, 0.041293768889715,  0.000000000000000,  0.000000000000000,
        -0.037230321086746, -0.001100702758751, -0.000000000000001, -0.000000000000001, -0.016430332691232, -0.003924765373842, 0.000000000000000,
        0.000000000000000,  -0.002768686674967, -0.024823832177832, 0.266107022398143,  0.201359599813872,  -0.022315659536671, -0.039298965387063,
        0.000000000000000,  0.000000000000000,  0.020473917899002,  0.006845664360199,  0.000000000000000,  0.000000000000000,  -0.030057206022979,
        -0.018248692991707, 0.000000000000000,  0.000000000000000,  0.034381608582693,  0.016385682374341,  0.000000000000000,  0.000000000000000,
        -0.002755422434943, 0.000832946166802,  0.000000000000000,  0.000000000000000,  -0.002407172621357, 0.037723692279908,  0.000000000000000,
        0.000000000000000,  -0.034011245045462, -0.009043854251906, -0.057095775138048, -0.033177962169074, 0.013663426371615,  0.006393460430865,
        -0.037088849256635, -0.019719691116400, 0.103874937684010,  0.057711240692583,  -0.051045368537294, -0.035925897039539, 0.098974821039385,
        0.060216367115805,  -0.016829142734363, -0.013893293692461, -0.325496224962933, -0.130977548296811, 0.012734409257961,  -0.001130289386685,
        -0.013860764148549, -0.020520329716035, 0.044717290954987,  0.025776700174854,  -0.005447481478041, 0.007699909767714,  0.002090593690711,
        0.012412167156632,  0.240618044239689,  0.109196129703018,  -0.043015173519122, -0.016060115378025, 0.008607786920398,  -0.003799190910244,
        -0.037195546177788, -0.023034195404697, -0.014264573822190, -0.010801225392248, -0.022053154656447, -0.019142734477593, 0.010991619743029,
        0.006968976455964,  -0.010440105862817, -0.012533801141531, 0.098422347680854,  0.100154091657133,  -0.044881552233915, -0.042640213198283,
        0.101785870582803,  0.179889922566002,  0.003265085336714,  0.005190301670372,  -0.225536147685195, -0.162131828545232, -0.003336175456351,
        -0.004018920674357, -0.034518318109483, -0.046698910776527, 0.002267627685740,  -0.001294523166503, 0.012419447819679,  0.047832166027461,
        0.009374813550565,  0.008150934921488,  0.187317368596301,  0.155274472249375,  0.010264232041557,  0.015894370958031,  -0.005918201449069,
        -0.033575344977941, -0.033180118185167, -0.028619796656098, -0.018312096774155, -0.019723075304881, 0.000000000000000,  0.000000000000000,
        -0.015939669922916, 0.001487389160714,  0.000000000000000,  0.000000000000000,  0.016912121353892,  0.024622645049630,  0.000000000000000,
        0.000000000000000,  0.060377239548936,  -0.032180257190423, 0.000000000000000,  0.000000000000000,  -0.017866355147639, 0.022220521882251,
        0.000000000000000,  0.000000000000000,  -0.001818463911552, 0.042904136178799,  0.418788747250357,  0.232873188478858,  -0.012597599550901,
        -0.109343035918742, 0.000000000000000,  0.000000000000000,  0.057177899992422,  -0.026110375219128, -0.000000000000000, 0.000000000000000,
        -0.015237338673435, -0.007784214353718, 0.000000000000000,  0.000000000000000,  0.027880112416108,  -0.006607251205175, 0.000000000000000,
        0.000000000000000,  -0.013018440368777, -0.000723991083540, 0.000000000000000,  0.000000000000000,  -0.000982267249211, 0.016335954799271,
        0.000000000000000,  0.000000000000000,  0.030469005790301,  -0.032080643352194, 0.000000000000000,  0.000000000000000,  0.004330144855606,
        0.017852785249041,  0.000000000000000,  0.000000000000000,  0.008375007378567,  0.034375894912285,  0.307273922029634,  0.232510038312909,
        -0.025975518496919, -0.101944447452485, 0.000000000000000,  0.000000000000000,  0.021164284607243,  -0.026463779522629, 0.000000000000000,
        -0.000000000000001, -0.007165335094684, -0.005444459926912, 0.000000000000000,  0.000000000000000,  0.028114439390574,  0.001282960560409,
        0.000420387283869,  0.002571707112004,  -0.003073146941675, -0.000641295129297, -0.042870176034394, -0.009962507224475, -0.035073733879244,
        -0.014424924670316, 0.023518456231548,  0.013138783926980,  -0.041641819603063, -0.020053962879059, 0.025171571577394,  0.009800704813572,
        -0.168138915752248, -0.069797543180771, -0.016464393094112, -0.010897933102582, -0.176383345047320, -0.061209533042756, 0.016372166613829,
        -0.020538619458980, 0.103291311874612,  0.045141143959689,  0.022132134152567,  0.009745623252070,  0.033018884645194,  0.020391935699621,
        0.046689542277122,  0.020521196260844,  0.021066006078372,  0.012707602133806,  0.068430900821501,  0.033019008211550,  0.013606386604537,
        0.006754505105219,  -0.004088858140228, -0.002931755552263, -0.001124375065800, -0.001231676591712, -0.000252120436950, 0.003778026761212,
        -0.024725492116276, -0.030942504778052, 0.000694019070747,  -0.004291360324461, -0.034420861399280, -0.026501463531132, 0.001753041175017,
        0.001176972335182,  -0.120051619996792, -0.087881678413282, 0.002198755845580,  0.007057941327906,  -0.105633139454202, -0.080871598233361,
        -0.058710903240483, -0.060742028156067, 0.076976241560095,  0.126481266628943,  -0.006486387583173, -0.009529264045238, 0.034791296226036,
        0.028680052661837,  0.000658435773402,  -0.001216725366004, 0.021655023077028,  0.023666419624668,  0.025445257226568,  0.020243025707378,
        0.011535249834706,  0.013750419425965,  0.000000000000000,  0.000000000000000,  0.038238488181321,  -0.005686657804720, 0.000000000000000,
        0.000000000000000,  -0.005792354577275, -0.034326330967437, 0.000000000000000,  0.000000000000000,  0.058962303036205,  0.027232035521969,
        0.000000000000000,  0.000000000000000,  -0.085705178541317, 0.026770065736590,  -0.324392368735939, -0.180382796151369, -0.041878059913197,
        0.120785867950593,  0.000000000000000,  0.000000000000000,  0.023354002627085,  0.061306306341305,  0.362681693937869,  0.201674097082973,
        -0.052503365894405, -0.043300460123191, 0.000000000000000,  0.000000000000000,  -0.034161820624103, -0.055385805117757, -0.000000000000000,
        0.000000000000001,  -0.005058802922596, -0.006961924278589, 0.000000000000000,  0.000000000000000,  0.040553004583137,  0.006225382181176,
        0.000000000000000,  0.000000000000000,  -0.006206736486453, -0.033299400661983, 0.000000000000000,  0.000000000000000,  0.026042629183323,
        0.019689115330702,  0.000000000000000,  0.000000000000000,  -0.039698657342100, 0.034624693792291,  -0.238013356548923, -0.180101501242389,
        0.011508151989376,  0.112722640390171,  0.000000000000000,  0.000000000000000,  0.023291820398660,  0.051455703916961,  0.266107022398143,
        0.201359599813872,  -0.039779768873586, -0.045503692641197, 0.000000000000000,  0.000000000000000,  -0.008016451017863, -0.043771876526157,
        0.000000000000000,  0.000000000000000,  -0.002307733425699, -0.006190804618496, 0.074375336601968,  0.038848178223299,  0.007282022371444,
        0.004197325624888,  0.049717126145239,  0.022987307747210,  0.059011220992505,  0.038236217640905,  -0.014180651117262, -0.005843600972487,
        -0.009926969787026, 0.026993305864006,  -0.035108019745605, -0.021051735131030, -0.005447481478041, 0.007699909767714,  0.027249178717159,
        0.032968223705166,  -0.123633857240891, -0.059985287764133, -0.027521091711146, -0.011110427623298, -0.073707387020870, -0.003172032181236,
        -0.032239867223512, -0.030844982903852, 0.162389772952766,  0.074614898112427,  0.024765037735896,  -0.003240570282081, 0.028438431001407,
        0.004930338401422,  -0.030957657544587, -0.023872767128552, -0.007422383083514, -0.006817167927937, 0.041862788066891,  0.035086172580360,
        0.007177792280353,  0.005563330515229,  -0.010309627987827, -0.015278105539476, 0.064954585176275,  0.076731829172877,  -0.007679947224760,
        -0.006855531666898, 0.044618274377805,  0.089236133159752,  0.005711592429420,  0.010105513623383,  0.012419447819679,  0.047832166027461,
        0.051284656599452,  0.052502167044181,  -0.102390204172770, -0.126806442911403, 0.009995437082358,  0.015085734579188,  -0.006880648798803,
        0.035637004372556,  -0.046961507120800, -0.043699672106136, 0.127648838743170,  0.150317725571316,  -0.007496538644754, -0.012845703371134,
        0.008882943154826,  -0.000835519875268, -0.013930556851910, -0.013276872750391, -0.011517616030249, -0.013401209951217, 0.000000000000000,
        0.000000000000000,  -0.019526337413873, -0.035380979249095, 0.000000000000000,  0.000000000000000,  -0.073684169457495, -0.027565327105839,
        0.000000000000000,  0.000000000000000,  -0.070176876900823, 0.052992414184381,  0.000000000000000,  0.000000000000000,  0.036755647976351,
        -0.030300555551068, 0.000000000000000,  0.000000000000000,  -0.062718632115243, -0.051170082723497, -0.162196184367970, -0.090191398075684,
        0.030929743285897,  0.111075237212041,  0.000000000000000,  0.000000000000000,  -0.049068830167435, 0.029523394560696,  0.429130767441230,
        0.238624009705490,  0.061020839382406,  0.004611198036242,  0.000000000000000,  0.000000000000000,  0.008663013047911,  0.000158804370806,
        0.000000000000000,  0.000000000000000,  -0.022015158967714, -0.041099105597345, 0.000000000000000,  0.000000000000000,  -0.024451074013130,
        -0.014254575672138, 0.000000000000000,  0.000000000000000,  -0.029791544740356, 0.056093423144569,  0.000000000000000,  0.000000000000000,
        0.006419060716539,  -0.027494078670054, 0.000000000000000,  0.000000000000000,  -0.038389668994684, -0.039041754568989, -0.119006678274461,
        -0.090050750621195, 0.029784088849569,  0.092632039711840,  0.000000000000000,  0.000000000000000,  -0.007204026239904, 0.024945708824169,
        0.314862075070098,  0.238251891518377,  0.031709418241807,  -0.000328516080759, 0.000000000000000,  0.000000000000000,  -0.013432808812416,
        -0.014763588775298, -0.044803233590867, -0.043414587111777, 0.020591578895679,  0.010768469437867,  -0.028699970860765, -0.031420310809530,
        -0.073718519124520, -0.024818202721964, -0.032001610505917, -0.010329779370049, 0.046618519087858,  0.023471431718333,  0.000911668339408,
        0.000561974447271,  0.086380681119852,  0.046140446253987,  -0.044549459938266, -0.025687452998130, -0.068704033156299, -0.028582889361367,
        0.042542559453491,  0.032669571561928,  -0.000744330351356, 0.006084894521037,  0.047369415656209,  0.022504161222462,  -0.140498183779856,
        -0.050881038280949, 0.029686551907077,  0.004658574134639,  0.110210771950670,  0.045986250357196,  -0.002796710750218, -0.000612787139917,
        0.036244664782799,  0.015459708842460,  -0.060823255885309, -0.060742299180192, 0.018308682588912,  0.029545228042712,  -0.003194041801151,
        -0.003855980666803, -0.042904624006887, -0.026896353959178, 0.021532078121908,  0.027981961605053,  0.040245064025287,  0.029539706971889,
        -0.000748970247318, -0.000650470411859, 0.078945393933925,  0.063756260570429,  -0.004998551222593, -0.005769708022775, -0.049067456718522,
        -0.049209108084842, 0.014985963914903,  0.017190088445818,  0.010267846490257,  0.002889459823276,  0.012084288833499,  0.013429993755908,
        -0.087833239638372, -0.053743774061822, -0.013574726445516, -0.011512804655803, 0.078576138172502,  0.121276590645881,  -0.035049362299109,
        -0.032423259860599, 0.026494207997747,  0.028835597688984,  0.000000000000000,  0.000000000000000,  0.033744238224943,  0.070309439568094,
        0.000000000000000,  0.000000000000000,  0.066667095599769,  0.162450884712940,  0.000000000000000,  0.000000000000000,  -0.093345849385383,
        -0.037312595635954, 0.000000000000000,  0.000000000000000,  0.087673556398341,  0.095853603353766,  0.000000000000000,  -0.000000000000000,
        -0.107355024718797, -0.046926977259923, 0.000000000000000,  0.000000000000000,  -0.060995705472796, -0.078363343277769, -0.093644010706377,
        -0.052072027957584, -0.067280505220823, 0.033720637619344,  0.000000000000000,  0.000000000000000,  0.030789880490886,  0.065346204108312,
        0.495517528199489,  0.275539272477144,  -0.035348134431101, -0.028673576519591, 0.000000000000000,  0.000000000000000,  0.018164307836052,
        0.051253123095961,  0.000000000000000,  0.000000000000000,  0.065332181957614,  0.145588008468614,  0.000000000000000,  0.000000000000000,
        -0.065237929108468, -0.037843625117684, 0.000000000000000,  0.000000000000000,  0.048707404983375,  0.068825252133162,  0.000000000000000,
        -0.000000000000000, -0.055611576338454, -0.032796651426632, 0.000000000000000,  0.000000000000000,  -0.010517331405151, -0.047276036826448,
        -0.068708537737123, -0.051990825111874, -0.022141250387076, 0.032507395254678,  0.000000000000000,  0.000000000000000,  0.010757970182593,
        0.039707729555696,  0.363571407598650,  0.275109587406144,  -0.026352462519177, -0.015911842693784, 0.021575370186247,  0.026335360454958,
        -0.030175401930147, -0.007162135396939, 0.055029482465831,  0.054085800109942,  -0.011544965828903, -0.007388116273025, -0.026525794164938,
        -0.012788086641749, 0.010017449809867,  -0.002149865532647, 0.004722270023111,  0.009079293746964,  0.022224381359584,  0.009336261995804,
        0.008067685092781,  0.002902132058496,  0.003876479988218,  0.005080403811980,  0.016160611392730,  -0.008227626141908, -0.002231138707965,
        -0.001490459849091, -0.035045386693046, -0.024827570816645, -0.012851810031891, -0.003395968129825, -0.016520780171149, -0.003723989604880,
        -0.025976701774506, 0.000512669427732,  -0.023328614681515, -0.012613761657876, 0.122022818074663,  0.049679300512485,  0.012351358423379,
        0.018177003346631,  -0.012532965274433, -0.004249045776179, 0.065744868663988,  0.070490475106004,  -0.012568774043957, -0.012700028795143,
        -0.022280185446223, -0.018191167648886, -0.003310977934220, -0.013832385519667, -0.012408208393333, -0.008434433693164, 0.016072864437851,
        0.013962010918029,  0.005719223993145,  0.004167415411582,  0.008529174785519,  0.013155951089971,  0.024545448840593,  0.016265779094530,
        -0.002486029556897, -0.005601774861865, -0.010039964563147, -0.008339974709400, -0.005968825905147, 0.000891539716368,  -0.022799989126947,
        -0.015469951201636, 0.000308449487716,  0.020802936862990,  0.013498892221838,  0.020151685544466,  0.085086584815045,  0.113350632462477};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 28, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.032521822300160,  0.070258856165048,  0.000000000000000,  0.000000000000000,  0.027045461357756,
        0.093061042872770,  0.000000000000000,  0.000000000000000,  0.041755712375233,  0.019487444541660,  0.000000000000000,  0.000000000000000,
        0.103105308961643,  0.093515509840237,  -0.000000000000000, -0.000000000000000, -0.022198755062527, -0.035800636923074, 0.000000000000000,
        0.000000000000000,  -0.200696424612640, -0.108598977240431, -0.093644010706378, -0.052072027957585, -0.028883960394654, 0.056349785497414,
        0.000000000000000,  0.000000000000000,  0.050865526993367,  0.111343800974824,  -0.495517528199489, -0.275539272477144, 0.010588892219244,
        -0.028687749579410, 0.000000000000000,  0.000000000000000,  0.017542790476286,  0.051207802143814,  0.000000000000000,  0.000000000000000,
        0.009597382089732,  0.056747659493725,  0.000000000000000,  0.000000000000000,  0.048000822701524,  0.027589851379948,  0.000000000000000,
        0.000000000000000,  0.053987548954381,  0.065932797354899,  -0.000000000000000, -0.000000000000000, -0.002157666961844, -0.021412023655005,
        0.000000000000000,  0.000000000000000,  -0.108863316787259, -0.079843600410750, -0.068708537737123, -0.051990825111874, 0.015486250077637,
        0.058796723407755,  0.000000000000000,  0.000000000000000,  0.044691656403266,  0.098699619353272,  -0.363571407598651, -0.275109587406143,
        0.011928137692011,  -0.026161372325987, 0.022295388086252,  0.026724067353080,  -0.028342874826704, -0.006341457522645, -0.015965584610032,
        -0.002959029966831, -0.044021037409211, -0.004392926560941, 0.037296395247085,  0.013285172526462,  -0.030172012835055, -0.012624405247884,
        -0.012318366353250, 0.000106459231806,  0.003493419700774,  -0.000643649828756, -0.004319562127043, -0.011158026247670, 0.014473014344828,
        0.006886525948837,  0.002901531623274,  -0.001765904155944, -0.015357897060252, -0.008322465627439, 0.000323296912306,  -0.008825352006042,
        -0.010646208996438, 0.000957537331884,  0.034542881170338,  0.036321517192378,  0.005176489783751,  0.002771460146952,  0.002280267726754,
        -0.010286327126154, -0.093446033303419, -0.041232797128253, 0.012371672585811,  0.018198264129397,  -0.011118409235957, -0.003507904567854,
        -0.032542010362868, -0.022141452303732, -0.008218155914861, 0.018667049637875,  0.027473547867778,  0.021571702035067,  -0.021735324704919,
        -0.014097564433289, -0.015524009569793, -0.010882308665217, -0.001050835862238, 0.002855663746131,  0.008795795741659,  0.005363828336886,
        0.011793100417640,  0.011204728560106,  0.008241072448228,  0.005789713161800,  -0.014226510744440, -0.013518485892913, 0.010859217677017,
        0.008482369519230,  0.001369217141072,  0.008941836703087,  0.042829934959027,  0.046394913791748,  0.004743146627596,  0.003734701718614,
        -0.024429939721710, -0.035723209473220, -0.070441518221534, -0.105012395535754, 0.000000000000000,  0.000000000000000,  0.009656128462570,
        0.024500071608469,  0.000000000000000,  0.000000000000000,  -0.068217895098814, -0.027457512637360, 0.000000000000000,  0.000000000000000,
        -0.008373898410992, 0.036701163506110,  0.000000000000000,  0.000000000000000,  0.006984793780462,  -0.020808016203559, 0.000000000000000,
        0.000000000000000,  0.046733644482835,  -0.057089485398141, -0.162196184367970, -0.090191398075684, 0.041990206403357,  0.114971481869521,
        0.000000000000000,  0.000000000000000,  -0.075764644589684, 0.040636471787285,  -0.429130767441230, -0.238624009705489, -0.031432611698583,
        0.012051392197012,  0.000000000000000,  0.000000000000000,  0.026049032916456,  0.039993891770241,  0.000000000000000,  0.000000000000000,
        0.023643883751557,  0.035648666767769,  0.000000000000000,  0.000000000000000,  -0.021853782980509, -0.014175923245905, 0.000000000000000,
        0.000000000000000,  0.004969401602478,  0.029319579240569,  0.000000000000000,  0.000000000000000,  -0.009987953324825, -0.013145528922339,
        0.000000000000000,  0.000000000000000,  0.013132082283015,  -0.047986161500724, -0.119006678274461, -0.090050750621195, 0.034152726500302,
        0.098253793599004,  0.000000000000000,  0.000000000000000,  -0.023537465419253, 0.042968181705596,  -0.314862075070098, -0.238251891518376,
        -0.017061378844667, 0.009428130258959,  0.000000000000000,  0.000000000000000,  0.015954625498737,  0.036324886406655,  0.049319261105562,
        0.038624767759098,  -0.042638564636378, -0.023280060921275, -0.031853964343502, -0.032971756731201, -0.085571656201633, -0.030079959888420,
        0.023568923662896,  0.016335232908215,  -0.156353858171322, -0.029900309860129, -0.066838110974085, -0.034297299907401, -0.076681205419733,
        -0.026616068085238, -0.009424703789033, -0.009121075137611, -0.025796903380482, -0.028063983796328, 0.013265066149216,  0.017498603299787,
        -0.103001999232270, -0.041226792291980, 0.004985890302584,  0.002258402132129,  -0.039721173419733, -0.030808610350808, 0.032256992974801,
        0.033575851690527,  -0.104077946423851, -0.064705331497429, 0.061170260198492,  0.054738008392734,  -0.002807184487949, -0.005850301721797,
        0.061655232939885,  0.059847703428466,  -0.039635793809136, -0.050285786303011, -0.003235073239668, -0.003889541601526, -0.051974544285619,
        -0.031702077766243, 0.013575783911075,  0.016794335183503,  -0.053419264305066, 0.025317322575876,  -0.006321367015255, -0.004886226284306,
        -0.046322938160133, -0.015000414603520, 0.002933429554196,  0.002055909812388,  -0.047223851646313, -0.072704947051724, 0.013525447712679,
        0.016173231139270,  -0.071116557869918, -0.048846101738115, 0.017690518908219,  0.021146751748293,  -0.052107229133622, -0.065754003451913,
        0.019893402300994,  0.016714824652521,  -0.109621183997768, -0.176377887732142, 0.046637345610535,  0.048006059407209,  -0.009741285512649,
        -0.023130685872613, 0.000000000000000,  0.000000000000000,  -0.028437393459465, -0.007700732102727, 0.000000000000000,  0.000000000000000,
        0.019155055291221,  0.045358048402932,  0.000000000000000,  0.000000000000000,  0.068090407819282,  0.023481569946876,  0.000000000000000,
        0.000000000000000,  0.023825885797847,  0.081058312614401,  -0.324392368735939, -0.180382796151368, -0.085264702877420, 0.097215793593694,
        0.000000000000000,  0.000000000000000,  -0.064606864456065, 0.010579279226022,  -0.362681693937869, -0.201674097082973, -0.000435263628715,
        0.022169791177839,  0.000000000000000,  0.000000000000000,  -0.034136427469397, -0.000998528441438, -0.000000000000000, 0.000000000000000,
        0.014778221855102,  -0.006313904046296, 0.000000000000000,  0.000000000000000,  -0.023042418223395, -0.011555637535336, 0.000000000000000,
        0.000000000000000,  0.009063230949718,  0.040654124534466,  0.000000000000000,  0.000000000000000,  0.031553474053209,  0.018023222997098,
        0.000000000000000,  0.000000000000000,  0.031266998863800,  0.071066370041399,  -0.238013356548923, -0.180101501242389, -0.013539519696439,
        0.097515396230415,  0.000000000000000,  0.000000000000000,  -0.028912926050860, 0.019005005305500,  -0.266107022398143, -0.201359599813872,
        0.015781392525031,  0.029790218337948,  0.000000000000000,  0.000000000000000,  -0.006583409572158, 0.006181065622356,  0.000000000000000,
        -0.000000000000000, 0.019672398232444,  0.000904968058954,  -0.069820779916592, -0.047083925140606, -0.007563816727112, -0.008595924939425,
        -0.049769260542380, -0.018154901418729, -0.063537998990796, -0.034905231445078, -0.023956729734577, -0.011394713431006, -0.123207135184890,
        -0.023523235543958, -0.031417331922658, -0.016453846842608, -0.260014242019450, -0.072568992363367, 0.037861186432126,  0.032026315882929,
        -0.135184494031348, -0.077085562527495, -0.016829142734363, -0.013893293692461, -0.103267095310790, -0.040074022882533, 0.048130442578445,
        0.038027613905308,  -0.106917229214468, -0.076060760745780, -0.024498573039396, -0.021458395396821, -0.005301565676808, -0.021955378957874,
        0.035474259590918,  0.015705651435556,  0.007142937014143,  0.002455223607688,  -0.036670031148188, -0.032950186773683, -0.014468755861664,
        -0.018643807950357, 0.010442130065092,  0.016111787713500,  -0.059559567500013, -0.062409452301245, -0.006704495922181, -0.006486508553212,
        -0.042365976083434, 0.037893727058604,  0.014179191199189,  0.020308540750958,  -0.126914955002139, -0.023847923180304, 0.048504510385826,
        0.049153066482216,  -0.131155469264006, -0.165722201891842, 0.003265085336714,  0.005190301670372,  -0.069449689322837, -0.019647509141118,
        0.052955025098692,  0.049258855531182,  -0.128587296365825, -0.203288500662297, 0.006819305805399,  0.008584661148347,  -0.036457477944608,
        -0.072367739690848, 0.019080040796290,  0.015395058675346,  0.004287410478782,  0.000429736494716,  0.000000000000000,  0.000000000000000,
        0.023416369116569,  -0.006524375606127, 0.000000000000000,  0.000000000000000,  -0.003702617351838, -0.011270028660839, 0.000000000000000,
        0.000000000000000,  0.027231179986626,  -0.017871296773990, 0.418788747250357,  0.232873188478858,  -0.027486228840600, -0.090825934350200,
        0.000000000000000,  0.000000000000000,  -0.002727695867328, 0.064356204268198,  0.000000000000000,  0.000000000000000,  -0.017866355147638,
        0.022220521882251,  0.000000000000000,  0.000000000000000,  -0.066236380419635, 0.033792250799254,  0.000000000000000,  0.000000000000000,
        -0.028543773106763, -0.021107538185307, 0.000000000000000,  0.000000000000000,  -0.005903401796957, -0.001081842171932, 0.000000000000000,
        0.000000000000000,  0.024913875523276,  0.001081599062495,  -0.000000000000000, 0.000000000000001,  0.003501871540907,  -0.007362807392332,
        0.000000000000000,  0.000000000000000,  0.019657582772732,  -0.017481954064668, 0.307273922029635,  0.232510038312910,  -0.022367064450580,
        -0.087067126411618, 0.000000000000000,  0.000000000000000,  0.012562511067851,  0.051563842368428,  0.000000000000000,  0.000000000000000,
        0.004330144855606,  0.017852785249041,  0.000000000000000,  0.000000000000000,  -0.030763795279662, 0.033837957028751,  0.000000000000000,
        0.000000000000000,  -0.009774579778275, -0.014401486766915, 0.000000000000000,  0.000000000000000,  -0.002643335276936, -0.000261359852972,
        0.074309852614785,  0.036864197964915,  0.013431398883031,  0.007044104433084,  0.006092982482974,  -0.002532626679908, 0.011979827555921,
        0.003276018634559,  0.010714999027544,  0.008000393925102,  -0.074515134387096, -0.039339496498085, 0.037348476261657,  -0.012371365447670,
        -0.036824451252261, -0.013023475357620, -0.024696589641168, -0.016346899653873, -0.264575017570980, -0.091814299564134, 0.025171571577394,
        0.009800704813572,  -0.168138915752248, -0.069797543180771, -0.025752243538618, -0.013480241838778, 0.020602555009789,  0.008367378318638,
        0.083807883389838,  0.033210059769771,  0.044236266843060,  0.023935765173759,  0.028347925999664,  0.016244508320444,  0.002216854566762,
        0.002058432823849,  0.025823972182706,  0.020681034360647,  0.012017400604638,  0.014371401939773,  -0.000120888313810, -0.001720119942205,
        0.005667148180764,  0.008493976941152,  0.005808115506399,  0.002268598626459,  -0.067361500285846, -0.053319715443261, -0.057250035594636,
        -0.059761217876749, -0.023066775103898, 0.053246534617874,  0.003298133768370,  0.010586911991860,  -0.158449709181303, -0.121307397350042,
        0.001753041175017,  0.001176972335182,  -0.120051619996792, -0.087881678413282, 0.001711427185908,  0.006599637803707,  0.014434444690434,
        0.010458030641004,  0.001037993466072,  -0.003270401978489, 0.040847718902424,  0.046242446979916,  0.005942078048543,  0.005075125765395,
        0.003483752194072,  0.004270418892889,  0.000000000000000,  0.000000000000000,  -0.019484930072459, -0.000554214845418, 0.000000000000000,
        0.000000000000000,  -0.003908769726898, -0.026897000711773, 0.362681693937869,  0.201674097082973,  -0.016982013889627, -0.036454337345816,
        0.000000000000000,  0.000000000000000,  0.026799252389312,  0.008648421648054,  0.000000000000000,  0.000000000000000,  -0.052063971557068,
        -0.028284089228279, 0.000000000000000,  0.000000000000000,  0.051403996726748,  0.023873779369639,  0.000000000000000,  0.000000000000000,
        -0.004564052391538, 0.001875232787547,  0.000000000000000,  0.000000000000000,  -0.006591505477871, 0.041293768889715,  0.000000000000000,
        0.000000000000000,  -0.037230321086746, -0.001100702758751, 0.000000000000000,  0.000000000000000,  -0.016430332691232, -0.003924765373842,
        0.000000000000000,  0.000000000000000,  -0.002768686674967, -0.024823832177832, 0.266107022398143,  0.201359599813872,  -0.022315659536671,
        -0.039298965387063, 0.000000000000000,  0.000000000000000,  0.020473917899002,  0.006845664360199,  0.000000000000000,  0.000000000000000,
        -0.030057206022979, -0.018248692991707, 0.000000000000000,  0.000000000000000,  0.034381608582693,  0.016385682374341,  0.000000000000000,
        0.000000000000000,  -0.002755422434943, 0.000832946166802,  0.000000000000000,  0.000000000000000,  -0.002407172621357, 0.037723692279908,
        0.000000000000000,  0.000000000000000,  -0.034011245045462, -0.009043854251906, 0.005956947832196,  0.002686903526838,  -0.008048400911386,
        -0.006172708297053, 0.094357840555033,  0.042259279108697,  -0.047630875760027, -0.020560983559598, -0.048714163855672, -0.043956406145683,
        -0.054340146911246, -0.009731848716725, 0.036387731066032,  0.017325663178128,  -0.103267095310790, -0.040074022882533, 0.012734409257961,
        -0.001130289386685, -0.013860764148549, -0.020520329716035, -0.035108019745605, -0.021051735131030, -0.338791175956255, -0.128655378353703,
        0.007685484926605,  -0.006861054698113, -0.127337878841826, -0.058679588295054, -0.017297342903795, -0.003933795116593, -0.021034654840392,
        -0.019113321742193, -0.100778123962908, -0.059200446526624, 0.007629705790920,  0.001870541392208,  -0.010262437167728, -0.008750241426534,
        -0.010454918440866, -0.011781769221193, -0.003649879479844, -0.008660179454355, -0.035406466157546, -0.018660743345164, -0.053100334902128,
        -0.049586418596892, -0.018068498888599, 0.071887198233668,  0.000969108840927,  -0.002409722856218, -0.069449689322837, -0.019647509141118,
        -0.003336175456351, -0.004018920674357, -0.034518318109483, -0.046698910776527, 0.005711592429420,  0.010105513623383,  -0.221710239723858,
        -0.165894313078710, -0.010350264853144, -0.008519958035174, -0.100333118135062, -0.103932066148227, 0.011592754594747,  0.016652253462044,
        -0.032102099808756, -0.056821725739260, -0.045069917333454, -0.039099621581535, 0.003314664419689,  -0.000814760336320, 0.000000000000000,
        0.000000000000000,  -0.029172927007612, -0.039506368483015, 0.429130767441230,  0.238624009705489,  -0.002800699883346, -0.016726829964790,
        0.000000000000000,  0.000000000000000,  0.005247700358305,  -0.031579686029797, 0.162196184367970,  0.090191398075684,  -0.019746791944196,
        -0.093777962890705, 0.000000000000000,  0.000000000000000,  0.022696028652379,  0.080615604090448,  0.000000000000000,  0.000000000000000,
        -0.077564318757360, 0.030403129586979,  0.000000000000000,  0.000000000000000,  -0.052293620211546, 0.037949344802667,  0.000000000000000,
        0.000000000000000,  -0.052710702559526, -0.023117805453949, 0.000000000000000,  0.000000000000000,  0.015428509800254,  0.027757156451744,
        0.000000000000000,  0.000000000000000,  -0.018327850993626, -0.036202766924309, 0.314862075070098,  0.238251891518377,  0.007406742081963,
        -0.011555311304337, 0.000000000000000,  0.000000000000000,  0.007958058402961,  -0.033338858649369, 0.119006678274461,  0.090050750621196,
        -0.013341306367794, -0.081935989166207, 0.000000000000000,  0.000000000000000,  0.023983361354396,  0.064395940722007,  0.000000000000000,
        0.000000000000000,  -0.025905832023150, 0.028114615205214,  0.000000000000000,  0.000000000000000,  -0.012283500841264, 0.030843826553300,
        0.000000000000000,  0.000000000000000,  -0.021152386900555, -0.012304449964930, 0.000000000000000,  0.000000000000000,  0.022737733397158,
        0.037027011013553,  -0.062336669204244, -0.054770874379691, 0.011773127798268,  0.010650611507470,  0.001345651331760,  -0.021732501801496,
        0.090793587268467,  0.048349706243899,  0.048660430643922,  0.017196671447143,  -0.039721173419733, -0.030808610350808, 0.012396142742073,
        -0.004556800345153, 0.039779236203970,  0.003778877792745,  0.043916740244856,  0.027727020022944,  0.075073139011090,  0.042535917369199,
        0.000911668339408,  0.000561974447271,  -0.026702044326658, -0.016581363636586, 0.045146508343349,  0.025268860793036,  -0.100176903853126,
        -0.009751045224811, -0.054768187580363, -0.039518107981029, -0.030945917331091, 0.004715512469439,  0.031207510580161,  0.031767553065501,
        -0.030333807567089, -0.013928119248247, -0.047234254397076, -0.048398887816370, 0.017956656459394,  0.029599379000367,  -0.017229567162721,
        -0.015241858308471, 0.082215636468654,  0.132197577896765,  -0.012189410242991, -0.017080358664064, -0.052107229133622, -0.065754003451913,
        -0.009094016196092, -0.012576174532347, 0.007182959956483,  -0.004099462319554, 0.002324795892505,  0.003550898228622,  0.072398833943733,
        0.089137035366534,  -0.000748970247318, -0.000650470411859, -0.028181453085836, -0.030851425372322, 0.014024896331059,  0.017053474652245,
        -0.018329867687925, 0.030372806715416,  -0.005778570503023, -0.005258148040707, 0.007209955363866,  0.029565641523794,  0.058384335007685,
        0.057559153360704,  -0.023803388837498, -0.031399501085207, 0.495517528199490,  0.275539272477144,  -0.007144911581242, 0.030143736278655,
        0.000000000000000,  0.000000000000000,  -0.050729418487554, -0.110034871218969, 0.093644010706378,  0.052072027957585,  -0.037577896281140,
        -0.074913530137377, 0.000000000000000,  0.000000000000000,  0.037611107049452,  0.038072307146000,  0.000000000000000,  0.000000000000000,
        -0.198400470018061, -0.104883056517167, 0.000000000000000,  0.000000000000000,  0.031721004985501,  0.076414321887167,  0.000000000000000,
        0.000000000000000,  0.087119925145322,  0.036951637897200,  0.000000000000000,  0.000000000000000,  0.052028313562850,  0.100472441913805,
        0.000000000000000,  0.000000000000000,  0.035141361496980,  0.070901678631976,  0.363571407598650,  0.275109587406145,  -0.011376698302859,
        0.026906919414473,  0.000000000000000,  0.000000000000000,  -0.045620827398961, -0.098036290879517, 0.068708537737123,  0.051990825111875,
        -0.040749907849901, -0.069798390412846, 0.000000000000000,  0.000000000000000,  0.045489879892118,  0.036286813210894,  0.000000000000000,
        0.000000000000000,  -0.096274642906548, -0.070790558554247, 0.000000000000000,  0.000000000000000,  0.018952144339363,  0.054198895712841,
        0.000000000000000,  0.000000000000000,  0.061913643818693,  0.037504555503845,  0.000000000000000,  0.000000000000000,  0.017414022535904,
        0.060895162811164,  0.000000000000000,  0.000000000000000,  0.018386561067332,  0.051556316688477,  -0.005620398964964, 0.009329401207043,
        0.098481073726698,  0.044621617511644,  -0.033854222184096, -0.035282742619660, 0.005176489783751,  0.002771460146952,  0.017861487409260,
        0.013711809910287,  0.006863681885040,  -0.008154520947737, 0.016034969837867,  -0.000672672309036, 0.018023431283106,  0.005400316974544,
        0.010743418426024,  -0.002817917578522, 0.016676602767751,  0.013449665896077,  0.004722270023111,  0.009079293746964,  0.018934859208597,
        0.006763257135195,  0.029578993609511,  0.014575718054416,  -0.003424339612450, 0.005182814576366,  -0.026918571056527, -0.005608167723551,
        -0.029812727796677, 0.006405765523796,  0.020218790497176,  0.025947330325133,  -0.028120507072469, -0.005780499157360, 0.023671419655311,
        0.035223116971208,  0.076197914974304,  0.111154752383056,  -0.043251349588134, -0.046625826008145, 0.004743146627596,  0.003734701718614,
        -0.005565092875262, -0.004912413569848, -0.013368469373746, -0.029661220271218, 0.008034149246901,  0.004842848145511,  0.009437393859801,
        0.006301757315642,  0.015866811035455,  0.010834259090445,  0.022741053454485,  0.030216625259016,  -0.012408208393333, -0.008434433693164,
        0.011698780337409,  0.010266242888845,  0.022338792547705,  0.018279701674240,  0.008534633093111,  0.016671516876895,  -0.035008276555995,
        -0.023694336441593, 0.010063530629728,  0.040475053346858,  0.012042801244845,  0.017973598297058,  -0.010185988390798, -0.001747322517815};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 28, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.010183557065821, -0.016390294001437, 0.350383804386655,  0.194835688051796,  0.026774639136442,
        -0.003253800828067, 0.000000000000000,  0.000000000000000,  0.005663023554838,  -0.004627933260267, 0.000000000000000,  -0.000000000000000,
        0.028527057170750,  -0.001673688642345, 0.000000000000000,  0.000000000000000,  0.008742463984280,  -0.000472810308748, 0.000000000000000,
        0.000000000000000,  -0.045474040496020, 0.003959064310395,  0.000000000000000,  0.000000000000000,  -0.000388644081156, -0.007096366820800,
        0.000000000000000,  0.000000000000000,  -0.002231597162138, -0.000044015072444, 0.000000000000000,  0.000000000000000,  0.014008363127110,
        0.024533013855323,  0.000000000000000,  0.000000000000000,  -0.013566265915810, -0.020971186322248, 0.257083807758544,  0.194531854824317,
        0.014698538654326,  -0.004140968191871, 0.000000000000000,  0.000000000000000,  0.004199249461640,  -0.007420169988944, -0.000000000000000,
        -0.000000000000000, 0.013994802608057,  -0.002797515156815, 0.000000000000000,  0.000000000000000,  0.004115282650596,  -0.000714431511997,
        0.000000000000000,  0.000000000000000,  -0.022609017579171, 0.006364436864439,  0.000000000000000,  0.000000000000000,  0.002109925206639,
        -0.011236344596122, 0.000000000000000,  0.000000000000000,  -0.001060339623905, -0.000032109718550, 0.000000000000000,  0.000000000000000,
        0.019705227467327,  0.031409806601562,  0.007945838177628,  0.012138916845319,  -0.087259970471693, -0.027222101689358, -0.034137448127990,
        -0.019202981981899, -0.119393845676869, -0.031921307312891, -0.037446023409825, -0.039580829803223, -0.018794513568376, -0.005006086936072,
        -0.095427202071149, -0.060956249038864, -0.006307762797230, -0.002218672739718, -0.030378365393214, -0.018510129737846, 0.006894653443070,
        0.002753632671849,  0.170239436882258,  0.113903145993823,  0.010501336343031,  0.004641146671350,  -0.039978558085485, -0.051023603607681,
        -0.015768194632599, -0.002683658844411, 0.002543502174088,  0.001297703204075,  0.003990931400685,  0.001694084915403,  -0.011172495016510,
        -0.017805500166742, 0.132789277653934,  0.041683743772027,  0.007281926867834,  0.011068933762722,  -0.047080080267748, -0.037636447105826,
        0.015626309519573,  0.024709182081242,  -0.055730759975656, -0.007645543926910, -0.043379349062423, -0.045229453620507, -0.008860301849644,
        0.007718276322370,  -0.027138535052635, -0.025373519126399, -0.003841318915161, -0.002495615113054, -0.006904504110029, -0.006177258109770,
        0.004757946816679,  0.002018959279896,  0.056698724169281,  0.053632671229101,  0.007895207907333,  0.011453332181391,  -0.063553608955842,
        -0.066588641700975, -0.004912586964433, 0.013603760921708,  0.000182003197913,  0.000151096724911,  0.002926962626918,  0.001276557172024,
        -0.010901835696634, -0.016581364914718, 0.072086236413348,  0.057222826152703,  0.000000000000000,  -0.000000000000000, -0.050175725970438,
        -0.037785479399126, 0.000000000000000,  0.000000000000000,  0.038311849288474,  0.063847929999998,  0.458760087396700,  0.255099796736046,
        -0.023081173523662, 0.019166611283681,  0.000000000000000,  0.000000000000000,  0.071566464832006,  -0.015300020109184, 0.000000000000000,
        0.000000000000000,  0.108084025750608,  0.076863193679308,  0.000000000000000,  0.000000000000000,  0.001514692444754,  -0.061485235818035,
        0.000000000000000,  0.000000000000000,  -0.038808778317585, -0.007950627816421, 0.000000000000000,  0.000000000000000,  -0.094778614976006,
        -0.100104223644032, 0.000000000000000,  0.000000000000000,  -0.101156934776608, -0.088545855268081, 0.000000000000000,  0.000000000000000,
        -0.035480698513077, -0.032882716565227, 0.000000000000000,  0.000000000000000,  0.027998734540220,  0.044496359291952,  0.336601716857429,
        0.254701985660741,  -0.018424362372461, 0.006228610036471,  0.000000000000000,  0.000000000000000,  0.030981559811141,  -0.014512033477159,
        0.000000000000000,  0.000000000000000,  0.037378485780683,  0.050816439061928,  0.000000000000000,  0.000000000000000,  0.005505707810199,
        -0.046340657987638, 0.000000000000000,  0.000000000000000,  -0.014912234239941, -0.004962124871150, 0.000000000000000,  0.000000000000000,
        -0.057419627622772, -0.069203513947952, 0.000000000000000,  0.000000000000000,  -0.075914746471205, -0.077415170281508, 0.015501274770103,
        0.012026876831922,  0.031954831966683,  0.011563852030169,  -0.025368791292168, -0.020273090392738, -0.130327834765193, -0.039540703773411,
        0.008804664707530,  0.006125601562245,  -0.270789085525523, -0.070661444280709, -0.043687609981882, -0.022535627984613, -0.036688239912572,
        0.000967020889994,  -0.070174302253201, -0.004603957006603, 0.129915556912884,  0.049138675969954,  0.003938094543640,  -0.017158037702817,
        -0.014614720793539, 0.006959281010784,  0.026318524507193,  0.008766923478390,  0.050251191517008,  0.017307678576384,  0.057682551111344,
        0.038482049433143,  0.242825477514219,  0.077901876754593,  0.031740660602899,  0.026177556418585,  0.059760990684086,  0.020566480326861,
        0.001363488928044,  0.001376744344984,  0.020018213132842,  0.009375236115085,  -0.023196088482936, -0.018783469747772, -0.068690447136593,
        -0.031997365086380, -0.004917887826137, 0.006680553827698,  -0.124387836962662, 0.039859193137262,  -0.014852330312023, -0.018978964254773,
        0.000141302482206,  0.067584235064244,  0.011235989556862,  0.021615536716291,  0.084936641659240,  0.039947683759035,  -0.023046412470354,
        -0.033040216733744, 0.010733280585501,  0.066835018438781,  0.000828799404815,  -0.000068248639545, 0.030197408175478,  0.002785846006290,
        0.036250141800009,  0.029101961183648,  0.135259118018618,  0.058633981602301,  0.003201311111037,  0.003246062271369,  0.035626747621670,
        0.017085067287216,  0.000000000000000,  0.000000000000000,  0.110170304401078,  0.045469379655934,  0.000000000000000,  0.000000000000000,
        0.103484798925315,  0.012687144698513,  0.000000000000000,  0.000000000000000,  0.072040606367864,  0.038164269064665,  0.512909370391382,
        0.285210243274089,  0.105602420750903,  0.067592594257324,  0.000000000000000,  0.000000000000000,  -0.044593190014475, -0.099120248088490,
        0.000000000000000,  0.000000000000000,  0.025396257231672,  -0.026380806921521, 0.000000000000000,  0.000000000000000,  0.001616400473400,
        -0.064716704084707, 0.000000000000000,  0.000000000000000,  0.088125259066021,  0.021231751816271,  0.000000000000000,  0.000000000000000,
        -0.008995396921282, 0.004590157033335,  0.000000000000000,  0.000000000000000,  0.066442114341126,  0.035911511514130,  -0.000000000000000,
        0.000000000000000,  0.042082818821364,  0.002468080764101,  0.000000000000000,  0.000000000000000,  0.039249080295220,  0.033866665963993,
        0.376332160118174,  0.284765476970799,  0.041602657570937,  0.034999585412125,  0.000000000000000,  0.000000000000000,  -0.029131884651757,
        -0.080099723118746, 0.000000000000000,  0.000000000000000,  0.004963730725213,  -0.020526647256081, 0.000000000000000,  0.000000000000000,
        -0.028340055500569, -0.058169190497974, 0.000000000000000,  0.000000000000000,  0.038840309943256,  0.003509432723176,  0.000000000000000,
        0.000000000000000,  -0.002059831198103, 0.003919769845446,  -0.021774441970662, -0.014558652104892, 0.016337935404754,  0.005737900640210,
        -0.045455708568655, -0.021733305706539, 0.001200819477073,  -0.001052714874519, -0.047477127849512, -0.027845717620302, -0.269221198288162,
        -0.070388527787652, -0.090656081667063, -0.055602983990882, -0.207574272689072, -0.011578228070461, 0.063924784600885,  0.025487278619721,
        0.181922876113216,  0.071945240320285,  -0.006115341313006, -0.001415943590237, -0.095641883361470, -0.011624470302985, -0.006038928591169,
        0.012787041669855,  0.207135962038832,  0.051142849487500,  -0.034204619902685, -0.018207800579963, 0.121046154315676,  0.037516912795347,
        0.002387930367435,  0.000740618707259,  0.013043098972243,  0.004913338507546,  -0.001280146136960, -0.001396231834518, 0.010027254092190,
        -0.001295195647711, -0.014355679394100, -0.012153823167890, -0.001782890000647, -0.001968980611194, -0.009218409341708, -0.008744220083485,
        -0.124093938445293, 0.025146099011514,  -0.054157992229403, -0.039511719984516, -0.024856062345631, 0.192430304639706,  -0.007709894023523,
        -0.018925595170255, 0.123887253131674,  0.089576674967063,  -0.004885314007162, -0.009178161551128, -0.022076374344680, 0.061960600008985,
        0.006734907180048,  0.007025510518234,  0.090095705260444,  -0.011698036894401, -0.022900464996518, -0.019896318783728, 0.065680489497885,
        -0.002277058860505, -0.000062896449401, -0.000076868431068, 0.008551972018418,  0.000873248687373,  0.000000000000000,  0.000000000000000,
        -0.074323857581978, -0.018693266928880, 0.000000000000000,  0.000000000000000,  0.031313335132017,  0.005504581181627,  0.000000000000000,
        0.000000000000000,  0.045150547186829,  0.023793154036005,  0.000000000000000,  0.000000000000000,  -0.075885202354510, 0.070657787484412,
        0.529730519903882,  0.294563872631550,  -0.024732068226964, 0.067419830331080,  0.000000000000000,  0.000000000000000,  -0.050590134903007,
        0.047105191656275,  0.000000000000001,  -0.000000000000000, -0.018812727994512, -0.009913814181669, 0.000000000000000,  0.000000000000000,
        -0.160045935119199, -0.028134526039424, -0.000000000000000, 0.000000000000000,  -0.073704492102127, -0.018537489704472, 0.000000000000000,
        0.000000000000000,  -0.039698734421836, -0.014002935890421, 0.000000000000000,  0.000000000000000,  0.012637252940237,  0.002613622062131,
        0.000000000000000,  0.000000000000000,  0.001974045671700,  0.019115478594093,  0.000000000000000,  0.000000000000000,  -0.011838316817097,
        0.067900990173820,  0.388674183674654,  0.294104519968722,  0.009033033698551,  0.040433028558449,  0.000000000000000,  0.000000000000000,
        -0.007892211211398, 0.045267326782547,  0.000000000000000,  -0.000000000000000, -0.000822519029875, -0.007964782747539, 0.000000000000000,
        0.000000000000000,  -0.064590403916769, -0.013358512762005, 0.000000000000001,  0.000000000000000,  -0.039367911634988, -0.013886244758001,
        0.014473665238632,  0.008219251025385,  -0.010168008738706, -0.004397250782982, -0.014558179134856, -0.006658356721194, 0.008588935092346,
        0.003943405594371,  -0.065099507330223, -0.019593804047750, 0.019787914651026,  0.021658836740260,  0.026421464059262,  0.004774045294185,
        -0.152177965195922, -0.016632198041934, -0.000618696062595, -0.032978752798884, -0.084155764890325, 0.008144967263216,  0.017614309372841,
        0.003182696862790,  -0.101451976797281, -0.011088132027956, 0.027124794720926,  0.008164085019896,  -0.008244964437927, -0.009024515308442,
        0.074408471133706,  0.034031601019435,  -0.043899001583103, -0.020155184149006, 0.014353051361644,  0.008150757266840,  -0.010083275332550,
        -0.004360607026458, 0.000277848074022,  0.000179472463081,  -0.007543564484329, -0.006169584450851, -0.003228569374702, -0.002335016137091,
        0.006743050844393,  0.006382039528203,  0.002511970853905,  0.009089936723190,  0.036292392255393,  0.058836775066119,  0.008271366203572,
        0.010375459391074,  -0.031201462184231, 0.061510218803496,  -0.052240142437596, -0.039988705939754, 0.011584575420938,  0.128490755072244,
        0.005514244135714,  0.006916972927383,  -0.020800974789487, 0.041006812535664,  -0.001046654522461, -0.003787473634663, -0.015121830106414,
        -0.024515322944216, 0.016501576804035,  0.011934526922907,  -0.034464482093566, -0.032619313144149, 0.000275532673405,  0.000177976859222,
        -0.007480701446960, -0.006118171247094, 0.000000000000000,  0.000000000000000,  -0.054650228613481, -0.013560881084457, 0.000000000000000,
        0.000000000000000,  -0.182940796554030, -0.026685831970212, 0.000000000000000,  0.000000000000000,  0.023693747993953,  0.062992788587543,
        0.000000000000000,  0.000000000000000,  0.025396257231672,  -0.026380806921520, 0.000000000000000,  0.000000000000000,  -0.029728793342983,
        -0.066080165392327, 0.512909370391383,  0.285210243274089,  0.084438873057844,  0.089576600025258,  0.000000000000000,  0.000000000000000,
        -0.057322374687495, 0.046975392716835,  -0.000000000000000, 0.000000000000000,  0.009459390916373,  0.007278515212522,  0.000000000000000,
        0.000000000000000,  0.123176613136825,  0.047302592946113,  0.000000000000000,  0.000000000000000,  -0.029313296151098, -0.010391309207438,
        0.000000000000000,  0.000000000000000,  -0.075620460965751, -0.004937812078599, 0.000000000000000,  0.000000000000000,  0.035386262794937,
        0.056468607832131,  0.000000000000000,  0.000000000000000,  0.004963730725213,  -0.020526647256081, 0.000000000000000,  0.000000000000000,
        -0.019421256434505, -0.053399815412497, 0.376332160118174,  0.284765476970799,  0.037466215299926,  0.052105124792193,  0.000000000000000,
        0.000000000000000,  0.003235131901784,  0.042558532922744,  0.000000000000000,  -0.000000000000000, 0.005609169057389,  0.001051604569972,
        0.000000000000000,  0.000000000000000,  0.072853373196407,  0.037234003645057,  0.011462124287311,  0.006736433993267,  0.007470165862076,
        0.002983821404029,  0.078517685383210,  0.038297820175070,  -0.051126516699877, -0.013822576408251, -0.011789060723932, -0.019475088153070,
        -0.252527308668081, -0.063705913070726, -0.006115341313006, -0.001415943590237, -0.095641883361470, -0.011624470302985, 0.042616523067257,
        0.016991519079814,  0.121281917408810,  0.047963493546856,  -0.085559963906225, -0.054423030999018, -0.127872703221179, -0.001891169484640,
        0.043643706427670,  0.006337631071685,  -0.037220982183113, -0.006177313917832, -0.001511918633801, -0.001810702941391, 0.070537793446074,
        0.022444168709352,  -0.024604771397595, -0.016086626023593, 0.012145944936099,  0.004124075666656,  0.000453653762437,  0.000485834657201,
        0.005177190425252,  0.001473909685240,  0.029736657629253,  0.025383216309886,  -0.024284379734905, 0.003725872237050,  -0.008371685679860,
        -0.008431084273694, -0.112259982739097, 0.017702908807371,  -0.004885314007162, -0.009178161551128, -0.022076374344680, 0.061960600008985,
        -0.005139929349015, -0.012617063446837, 0.082591502087783,  0.059717783311375,  -0.050086897223434, -0.031863252025243, -0.006459083725065,
        0.140796471298885,  -0.000852652564897, -0.001560176444467, -0.010809853554400, -0.005545468543665, -0.007576455033305, -0.006712649787782,
        0.039268252180976,  -0.000532240679454, -0.001359999390211, -0.001479806172187, 0.007221629606214,  -0.001774849452500, 0.000000000000000,
        0.000000000000000,  0.093291421633894,  0.087672415179338,  0.000000000000000,  0.000000000000000,  0.037664327532809,  0.093472428258163,
        0.000000000000000,  0.000000000000000,  -0.038808778317585, -0.007950627816421, 0.000000000000000,  0.000000000000000,  0.030235808996222,
        0.073045797514312,  0.000000000000000,  -0.000000000000000, -0.045035010729420, -0.032026330699711, 0.000000000000000,  0.000000000000000,
        -0.090713875866318, -0.074387335445714, 0.458760087396699,  0.255099796736046,  -0.100051917186872, 0.003397866114446,  0.000000000000000,
        0.000000000000000,  0.049983445717402,  0.065203171268132,  0.000000000000000,  0.000000000000000,  -0.030844422533938, -0.035638799953965,
        0.000000000000000,  0.000000000000000,  0.072142638972670,  0.076801376708861,  0.000000000000000,  0.000000000000000,  0.033812830417572,
        0.065439390663376,  0.000000000000000,  0.000000000000000,  -0.014912234239941, -0.004962124871150, 0.000000000000000,  0.000000000000000,
        0.006784281761754,  0.053712440319208,  0.000000000000000,  0.000000000000000,  -0.015574369075285, -0.021173516275804, 0.000000000000000,
        0.000000000000000,  -0.031833942445510, -0.052190032060738, 0.336601716857430,  0.254701985660740,  -0.048000293615011, -0.003612937624643,
        0.000000000000000,  0.000000000000000,  0.032822904153343,  0.045265577115601,  -0.000000000000000, -0.000000000000000, -0.026209878755205,
        -0.031374178014094, -0.029510450423437, -0.025080518486728, -0.052848494728578, -0.017632239181047, -0.027634524415611, -0.026125046702657,
        -0.170368467145607, -0.049443619848432, 0.026318524507193,  0.008766923478390,  0.050251191517008,  0.017307678576384,  -0.024778947398579,
        0.012164416420586,  0.002489429070943,  -0.008611905913522, 0.029239292605501,  0.001918315419418,  -0.054131482047035, -0.020474448320814,
        0.062832304610029,  0.002987325235677,  0.025285473336252,  0.009413770392878,  0.061003071646796,  0.023513333127718,  -0.171124222350124,
        -0.036334548437547, -0.031509259059135, -0.022798307031129, -0.145134795008025, -0.045356293961940, 0.010020021490870,  0.009330654378625,
        0.014965786955260,  0.004352281098126,  -0.003172297502620, -0.003222331106843, -0.030557099639993, -0.014874005406505, -0.034021327907352,
        -0.027683310754140, -0.085932456361449, -0.042349759597889, 0.000828799404815,  -0.000068248639545, 0.030197408175478,  0.002785846006290,
        0.023276787571049,  0.034411747839220,  -0.013889678644159, -0.056472618191506, -0.004681662315359, -0.009006473631788, -0.035390267358017,
        -0.016644868232931, -0.016029803048912, -0.025989012127203, 0.016274003670901,  0.014620856022614,  -0.003274102339921, 0.006545194025933,
        -0.064496310747964, 0.045384454383070,  -0.023651557988638, -0.019073378210753, -0.078770602450118, -0.035325129047081, 0.001292181327646,
        0.001318419562605,  0.007558389892851,  0.003941044173965,  0.000000000000000,  0.000000000000000,  -0.011913691805578, -0.024446336643780,
        0.000000000000000,  0.000000000000000,  -0.002231597162138, -0.000044015072444, 0.000000000000000,  0.000000000000000,  -0.025230960314048,
        0.006650875238922,  0.000000000000000,  0.000000000000000,  0.012153900331121,  -0.003875312960781, 0.000000000000000,  0.000000000000000,
        -0.044683704808543, 0.002416586022490,  -0.000000000000000, 0.000000000000000,  -0.004515415159442, -0.001590635220645, 0.000000000000000,
        0.000000000000000,  0.010898520600424,  -0.004536894779548, 0.350383804386655,  0.194835688051797,  0.037743963351298,  -0.003037446546853,
        0.000000000000000,  0.000000000000000,  -0.007097812889304, -0.016262606331298, 0.000000000000000,  0.000000000000000,  -0.018640226134359,
        -0.031332146864967, 0.000000000000000,  0.000000000000000,  -0.001060339623905, -0.000032109718550, 0.000000000000000,  0.000000000000000,
        -0.014191096919368, 0.010930376002955,  0.000000000000000,  0.000000000000000,  0.006698135434004,  -0.005857770905140, 0.000000000000000,
        0.000000000000000,  -0.021033666880825, 0.003651538839094,  0.000000000000000,  -0.000000000000000, -0.001783488852568, -0.002295071413843,
        0.000000000000000,  0.000000000000000,  0.006668098622365,  -0.007357643743774, 0.257083807758544,  0.194531854824317,  0.019910594535113,
        -0.003983134188851, 0.000000000000000,  0.000000000000000,  -0.011997369818648, -0.020856782655438, 0.009938708041426,  0.017139431298143,
        -0.135929405242008, -0.043090016688346, 0.002543502174088,  0.001297703204075,  0.003990931400685,  0.001694084915403,  0.086672832416228,
        0.075098684453098,  0.051598507216269,  0.016600598560059,  -0.085042555594577, -0.066958433385923, -0.003780619864307, -0.003650323622113,
        0.155267200898648,  0.094607329771210,  -0.035239339820135, -0.014074122545008, -0.010940294794199, -0.014402742369363, 0.000356947710838,
        -0.001236106549225, -0.046988236924650, -0.044500695570629, -0.026116620997535, -0.007850084666908, -0.046639928621393, -0.025581788794199,
        -0.139011105098108, -0.040248512150681, 0.006128297194329,  0.011157704131271,  -0.091885818125601, -0.029293738617557, 0.010867026355064,
        0.016544933491476,  -0.074510149507429, -0.058492808981632, 0.000182003197913,  0.000151096724911,  0.002926962626918,  0.001276557172024,
        0.067924152621360,  0.070209688182530,  0.029074837633946,  -0.007759660324717, -0.044475883651826, -0.043105461556264, -0.005976428937689,
        -0.019371963935103, 0.035289687673483,  0.031572652561047,  -0.024318394840805, -0.010319125208359, -0.015017551539493, -0.014934036200836,
        -0.001938529770264, -0.010348258268818, -0.044272491989045, -0.045969432968496, -0.013797981215943, 0.006524004508580,  0.014731680273793,
        0.023966472334395,  -0.070118124578984, -0.013920408286978, 0.007230647833298,  0.011015265174740,  -0.050650843679437, -0.039507309650397};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 28, 36));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeGSForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix efxmat(36, 4);

    CDenseMatrix efymat(36, 4);

    CDenseMatrix efzmat(36, 4);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.000936361601020,  0.000795883803457,  0.000000000000000,  0.000000000000000,  0.000502492930650,
        0.000791998013924,  -0.052417723720611, -0.040818855461206, -0.004348198011044, -0.012132671009474, -0.032811650378630, -0.027942518274941,
        -0.001418967104775, -0.006331332255228, 0.000000000000000,  0.000000000000000,  0.036327034031610,  0.013729342222410,  0.000000000000000,
        0.000000000000000,  0.029624055715074,  0.014245758700507,  -0.378670710021570, -0.305114755324468, -0.026804832259898, -0.084014412879746,
        -0.358310947051602, -0.308873830911820, -0.010024824895229, -0.057559597952870, 0.000000000000000,  0.000000000000000,  0.061821046925058,
        0.018750920538417,  0.000000000000000,  0.000000000000000,  0.053139259864553,  0.019809254435727,  -0.199164543873251, -0.175266209303487,
        -0.007441658801714, -0.038938461548216, -0.363686365010613, -0.317077596687778, -0.004946184176507, -0.047354473747162, 0.000000000000000,
        0.000000000000000,  0.002527915584413,  -0.004181839073603, 0.000000000000000,  0.000000000000000,  0.005096096072061,  -0.003946027641166,
        0.469442821916389,  0.361786992649796,  0.040642382706785,  0.109999091428896,  0.249082516171487,  0.210740707823022,  0.012791398168988,
        0.052337990434926,  0.000000000000000,  0.000000000000000,  -0.030183955690945, -0.010850204903446, 0.000000000000000,  0.000000000000000,
        -0.024943769424156, -0.011300981202484, 0.260837313903166,  0.211957128416173,  0.017659517421082,  0.057236830100159,  0.267985413821132,
        0.231442102503019,  0.006865892859227,  0.041712190500975,  0.000000000000000,  0.000000000000000,  0.031652878389249,  0.008950975716975,
        0.000000000000000,  0.000000000000000,  0.027591487775498,  0.009518127236302,  -0.039276424896962, -0.041301594348022, 0.001565276532047,
        -0.005287137625370, -0.151558585893727, -0.132978219891946, -0.000826684202884, -0.017120756068759, 0.000000000000000,  0.000000000000000,
        0.025701695266568,  0.012345140412294,  0.000000000000000,  0.000000000000000,  0.019404814328407,  0.012608124981570,  -0.521879565909281,
        -0.412070200657273, -0.040738900723211, -0.118781935469934, -0.393871140628333, -0.337491407049940, -0.014002295818754, -0.069585436276159,
        0.000000000000000,  0.000000000000000,  -0.022263304013723, -0.006162152284650, 0.000000000000000,  0.000000000000000,  -0.019485604488985,
        -0.006566260342193, 0.014732850245091,  0.019089836618510,  -0.002206312104514, 0.000706324146145,  0.099474456871862,  0.087492301355562,
        0.000230689122873,  0.010576874836107,  0.000000000000000,  0.000000000000000,  -0.012727001704475, -0.004559886247415, 0.000000000000000,
        0.000000000000000,  -0.010526396034590, -0.004750541847151, 0.108526145370195,  0.088246957627996,  0.007321320743812,  0.023793734648172,
        0.112191135280812,  0.096905372315235,  0.002855393478877,  0.017422466226853};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 36, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.013388463285919, -0.004600870558950, 0.000000000000000,  0.000000000000000,  -0.011189269082623,
        -0.004809061198845, 0.095249968924769,  0.078219628135298,  0.006079985812750,  0.020610376351899,  0.107567169616531,  0.093081118502699,
        0.002489134841933,  0.016178226452975,  0.000000000000000,  0.000000000000000,  -0.012226407679612, -0.005540263882139, 0.000000000000000,
        0.000000000000000,  -0.009427290820542, -0.005678298466601, 0.216183108936259,  0.171242689406307,  0.016629475745472,  0.049010017225784,
        0.169637661095417,  0.145520825080207,  0.005788230291708,  0.029456740236498,  0.000000000000000,  0.000000000000000,  0.053146597450144,
        0.012620208523035,  0.000000000000000,  0.000000000000000,  0.047750295485057,  0.013666203964008,  0.166533793823305,  0.110252830557892,
        0.022560274790192,  0.045443303407182,  -0.125985604400979, -0.114380185542040, 0.004937035960085,  -0.002326736002172, 0.000000000000000,
        0.000000000000000,  0.033759474709593,  0.005466109822306,  0.000000000000000,  0.000000000000000,  0.031838234502215,  0.006229770868664,
        0.351925926700029,  0.260187566193474,  0.035433928787700,  0.086378771898709,  0.056010177582512,  0.042639036627239,  0.009832814271272,
        0.026494235960346,  0.000000000000000,  0.000000000000000,  -0.045275933536417, -0.016275307355169, 0.000000000000000,  0.000000000000000,
        -0.037415654136234, -0.016951471803727, 0.391255970854749,  0.317935692624259,  0.026489276131623,  0.085855245150239,  0.401978120731698,
        0.347163153754528,  0.010298839288840,  0.062568285751462,  0.000000000000000,  0.000000000000000,  0.002527915584413,  -0.004181839073603,
        0.000000000000000,  0.000000000000000,  0.005096096072061,  -0.003946027641166, 0.469442821916389,  0.361786992649796,  0.040642382706785,
        0.109999091428896,  0.249082516171487,  0.210740707823022,  0.012791398168988,  0.052337990434926,  0.000000000000000,  0.000000000000000,
        -0.056451392150010, -0.018697102864577, 0.000000000000000,  0.000000000000000,  -0.047593404855643, -0.019602238982641, 0.333854114255713,
        0.277459845845585,  0.019826280097814,  0.071069486545912,  0.416098752533356,  0.360729792200193,  0.008651705611497,  0.060513784670334,
        0.000000000000000,  0.000000000000000,  -0.046448274032393, -0.014356456577883, 0.000000000000000,  0.000000000000000,  -0.039766893027790,
        -0.015141182440600, 0.175527592013670,  0.151683307135093,  0.007810760478400,  0.035304806412883,  0.287558136069866,  0.250357672534026,
        0.004420581699765,  0.038521078221383,  0.000000000000000,  0.000000000000000,  -0.004173185897101, -0.000996438180397, 0.000000000000000,
        0.000000000000000,  -0.003746224157500, -0.001078359103771, -0.012548483967249, -0.008249306072735, -0.001726203249977, -0.003444910161634,
        0.010184539709980,  0.009228751667698,  -0.000373298520269, 0.000242716312565};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 36, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.003578398719285, -0.000221718406667, 0.000000000000000,  0.000000000000000,  -0.003586034522146,
        -0.000316580099328, -0.071821938147383, -0.054246208730990, -0.006715418479521, -0.017221446520823, -0.025014896216598, -0.020688586198962,
        -0.001981399183465, -0.006731133202944, 0.000000000000000,  0.000000000000000,  0.005757231865391,  0.000878469902046,  0.000000000000000,
        0.000000000000000,  0.005461312669594,  0.001010791617311,  0.065199164463588,  0.048375496352987,  0.006487148108635,  0.015941764765318,
        0.012416267770927,  0.009699221936818,  0.001817865710195,  0.005107235938666,  0.000000000000000,  0.000000000000000,  0.082791729471058,
        0.017400838835814,  0.000000000000000,  0.000000000000000,  0.075719741255144,  0.019118177637374,  0.477433565632349,  0.340170646376816,
        0.053835591179936,  0.121730400858601,  -0.075771397657990, -0.076064620725075, 0.013622212585667,  0.021150400917231,  0.000000000000000,
        0.000000000000000,  0.107718657926880,  0.027972213009243,  0.000000000000000,  0.000000000000000,  0.095367563716325,  0.029999142166552,
        0.106556693055631,  0.045023947308625,  0.025922412630552,  0.038136025501553,  -0.383007602384752, -0.340020317511549, 0.003722309171989,
        -0.030964838738505, 0.000000000000000,  0.000000000000000,  0.011759998073997,  0.007283497915939,  0.000000000000000,  0.000000000000000,
        0.007913065645005,  0.007340219523210,  -0.396572713437637, -0.310438955722247, -0.032168154009201, -0.091216560733117, -0.267422493322078,
        -0.228328693794502, -0.010699634738659, -0.049770232517396, 0.000000000000000,  0.000000000000000,  0.071812438617920,  0.018648142006162,
        0.000000000000000,  0.000000000000000,  0.063578375810883,  0.019999428111035,  0.071037795370421,  0.030015964872417,  0.017281608420368,
        0.025424017001035,  -0.255338401589835, -0.226680211674366, 0.002481539447993,  -0.020643225825670, 0.000000000000000,  0.000000000000000,
        -0.034496553946274, -0.007250349514923, 0.000000000000000,  0.000000000000000,  -0.031549892189643, -0.007965907348906, -0.198930652346812,
        -0.141737769323673, -0.022431496324973, -0.050721000357750, 0.031571415690829,  0.031693591968781,  -0.005675921910695, -0.008812667048846,
        0.000000000000000,  0.000000000000000,  -0.029425851756443, -0.004489957277124, 0.000000000000000,  0.000000000000000,  -0.027913375866811,
        -0.005166268266255, -0.333240173925006, -0.247252536915265, -0.033156534777468, -0.081480131022739, -0.063460924162515, -0.049573801010401,
        -0.009291313629884, -0.026103650353182, 0.000000000000000,  0.000000000000000,  -0.003548578729958, -0.000219870753279, 0.000000000000000,
        0.000000000000000,  -0.003556150901129, -0.000313941931833, -0.071223421996155, -0.053794156991565, -0.006659456658858, -0.017077934466483,
        -0.024806438748126, -0.020516181313971, -0.001964887523603, -0.006675040426253};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 36, 4));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeGPForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix efxmat(36, 12);

    CDenseMatrix efymat(36, 12);

    CDenseMatrix efzmat(36, 12);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, -0.019351599744358, -0.009529453814726, 0.000000000000000,  0.000000000000000,  -0.001945335453191,
        -0.001231968236743, 0.000000000000000,  0.000000000000000,  0.027382226978900,  0.019061200081894,  0.000000000000000,  0.000000000000000,
        -0.016512518009040, -0.010037447375114, 0.000000000000000,  0.000000000000000,  -0.000878016375417, -0.001098371528569, 0.000000000000000,
        0.000000000000000,  0.022251187193817,  0.019755660293403,  -0.027719471933182, -0.023647888001694, 0.002859322801777,  0.004567648715567,
        -0.034348249172716, -0.023909082966048, 0.007977873189073,  0.015731861072408,  0.041586555339313,  0.047757178421549,  0.017602621811866,
        0.028770809311883,  -0.034128443682612, -0.033097571676218, 0.000882464322828,  -0.000053306144024, -0.010300493143410, -0.008989403146859,
        0.003148174827857,  0.009429176960238,  0.053477861718773,  0.066162232752057,  0.005714333682344,  0.020664480781133,  0.000000000000000,
        0.000000000000000,  -0.009499529546007, 0.012974645737711,  0.000000000000000,  0.000000000000000,  -0.050284957832014, -0.007232983740426,
        0.000000000000000,  0.000000000000000,  0.051564288348326,  0.032773570104142,  0.000000000000000,  0.000000000000000,  -0.003376277240892,
        0.014303680254105,  0.000000000000000,  0.000000000000000,  -0.029753416387810, -0.005210784993464, 0.000000000000000,  0.000000000000000,
        0.049862889714601,  0.035661413570622,  0.032126932110667,  0.035309587279893,  0.054733346956197,  0.103578098247642,  -0.193637174131322,
        -0.135797170654530, 0.056026583700142,  0.121601239520664,  0.049461798565168,  0.046029508169549,  0.034941463124185,  0.074094876768451,
        0.087829592600264,  0.086844253245226,  0.020827985215847,  0.077912925959147,  -0.044170155815567, -0.034531606977224, 0.024699871626191,
        0.097993865748430,  0.163469447777943,  0.144860120579112,  0.015054411727733,  0.064592644548627,  0.000000000000000,  0.000000000000000,
        -0.007187142857156, 0.015269525033799,  0.000000000000000,  0.000000000000000,  -0.040369578167873, 0.014094068103768,  0.000000000000000,
        0.000000000000000,  -0.004183956922740, -0.012311568443809, 0.000000000000000,  0.000000000000000,  0.004843822474703,  0.017873799452763,
        0.000000000000000,  0.000000000000000,  -0.014703159840634, 0.018035462389772,  0.000000000000000,  0.000000000000000,  0.011682212143254,
        -0.009606373695916, -0.015411831636015, -0.004755472454641, 0.014135750482016,  0.043738314041710,  -0.053059348680012, -0.033275354602793,
        0.021680711910842,  0.071262276804118,  0.297881234159634,  0.115809098100226,  -0.004006402717154, 0.026311278639401,  0.053673893191894,
        0.056891237359226,  0.009228159985579,  0.058765511089975,  0.048559867112511,  0.055454495999948,  0.015096915608018,  0.098291459402687,
        0.400191779500556,  0.202882192227732,  0.005923294110106,  0.044771123723892,  0.000000000000000,  0.000000000000000,  -0.010655776580075,
        -0.005441091024943, 0.000000000000000,  0.000000000000000,  0.023735652932931,  0.005161659819890,  0.000000000000000,  0.000000000000000,
        -0.005265057551242, -0.010121058210754, 0.000000000000000,  0.000000000000000,  -0.009765915932325, -0.006057348341077, 0.000000000000000,
        0.000000000000000,  0.022050061356336,  0.005648541770225,  0.000000000000000,  0.000000000000000,  -0.002331900011152, -0.010165722537620,
        0.085326592678368,  0.049892281034057,  -0.055689346265758, -0.100581250888862, 0.086622882448322,  0.046655247991084,  -0.114606050872990,
        -0.198433527497166, 0.571034858681923,  0.316946680714697,  -0.010644932298823, -0.012131101607352, -0.020381738930349, -0.022521850983314,
        -0.019988560572736, -0.056785828176818, -0.029225991069300, -0.029706174225215, -0.039287719154696, -0.105492140784044, 0.477756717017004,
        0.277351466066061,  -0.002233525054529, 0.001129930192513,  0.000000000000000,  0.000000000000000,  0.014949219791467,  0.009975211999210,
        0.000000000000000,  0.000000000000000,  0.034384633687205,  -0.006353834391244, 0.000000000000000,  -0.000000000000000, -0.038626686721330,
        -0.023677103334576, 0.000000000000000,  0.000000000000000,  0.003103841367977,  0.008421577642830,  0.000000000000000,  0.000000000000000,
        0.021547467695175,  -0.007812631853294, -0.000000000000000, 0.000000000000000,  -0.038165468133198, -0.025972817631283, 0.236064584988568,
        0.175358849644204,  0.008817374414190,  -0.003591865427524, -0.002385008198858, -0.011160516471864, -0.060516760886439, -0.118380311909020,
        -0.091206070466308, -0.062815811723054, -0.025607696542728, -0.056421498674152, 0.114296641831983,  0.102866244894461,  -0.001077233564283,
        -0.015908409135918, -0.065229008870258, -0.066123025960839, -0.023892756710156, -0.093064140225329, -0.174920539622637, -0.138363674310893,
        -0.011503011398974, -0.050895007746684, 0.000000000000000,  0.000000000000000,  -0.062081873111588, -0.022720533952098, 0.000000000000000,
        0.000000000000000,  0.026200036782323,  0.032465209162273,  0.000000000000000,  0.000000000000000,  -0.036974811002585, -0.030731816700633,
        0.000000000000000,  0.000000000000000,  -0.048094579883349, -0.023205196241632, 0.000000000000000,  -0.000000000000000, 0.032371543012896,
        0.035760093682038,  0.000000000000000,  0.000000000000000,  -0.022034147790611, -0.030176107572321, -0.057792990256204, -0.054399910028117,
        -0.010644932298823, -0.012131101607352, 0.061653184470477,  0.057332616734403,  0.009315277730856,  0.034019305743492,  0.105464180887670,
        0.000910353421161,  -0.024468699347171, -0.022537113580337, -0.085996830305580, -0.082136846728862, -0.002233525054529, 0.001129930192513,
        0.124955311372214,  0.125067166666129,  0.007305805876045,  0.056697048284397,  0.144722867566501,  0.023807506801408,  -0.004105710628080,
        -0.002442520274782, 0.000000000000000,  0.000000000000000,  -0.053128700625746, -0.013189006572434, 0.000000000000000,  0.000000000000000,
        -0.019656411643325, 0.007151616883181,  -0.000000000000001, -0.000000000000000, 0.036161734209020,  0.026247889736457,  0.000000000000000,
        0.000000000000000,  -0.042444630655896, -0.013494315204349, 0.000000000000000,  0.000000000000000,  -0.007465888748930, 0.009324281856794,
        0.000000000000000,  -0.000000000000000, 0.034321086082249,  0.028301906636573,  -0.055556740653776, -0.037191843989023, 0.063163573489844,
        0.114499303736761,  -0.162564988378552, -0.099022146834863, 0.104723562105892,  0.201420895593008,  -0.272865190104925, -0.142269688903391,
        0.028429213697219,  0.056406744765156,  -0.011388794109751, -0.009656102239242, 0.022837857546277,  0.070785739636221,  0.035895245708214,
        0.042280642516659,  0.040403466205881,  0.137006757667606,  -0.140405787463408, -0.050817654776508, 0.011363506888451,  0.043831531811440,
        0.000000000000000,  0.000000000000000,  -0.051566899950157, -0.035038526403916, -0.000000000000000, -0.000000000000000, 0.030429759531628,
        0.003227313215998,  0.000000000000000,  0.000000000000000,  0.033169187449222,  0.026638661283078,  0.000000000000000,  0.000000000000000,
        -0.047916660768641, -0.037505911371370, 0.000000000000000,  0.000000000000000,  0.019287015836564,  0.002382974431996,  0.000000000000000,
        0.000000000000000,  0.021258755197542,  0.026418343535145,  -0.085745436294697, -0.077709824178631, -0.012376630198424, -0.029598454188515,
        0.012911231402748,  0.013468114413783,  0.006655727847116,  0.001250821428769,  -0.064503428105063, 0.011365428626938,  0.021819964028684,
        0.023256162877729,  -0.138034677826463, -0.135489040754616, -0.006150028651179, -0.037922904670258, 0.012541918548442,  0.010048552167805,
        -0.000059496987040, -0.017688624382160, -0.089417401751985, -0.000280363185107, 0.004355677979506,  0.006933939661096,  0.000000000000000,
        0.000000000000000,  -0.016477350805450, -0.015897381116538, 0.000000000000000,  0.000000000000000,  0.025023775918753,  0.007034794785291,
        0.000000000000001,  0.000000000000000,  -0.011211038723090, -0.006522839377576, 0.000000000000000,  0.000000000000000,  -0.015503815421044,
        -0.016896486643672, 0.000000000000000,  0.000000000000000,  0.016714372805323,  0.006563978228903,  -0.000000000000000, 0.000000000000000,
        -0.011988840736985, -0.007370523322005, -0.053973260360700, -0.048483305039960, -0.022990128906035, -0.042909482418621, 0.075827354888991,
        0.056488505078308,  -0.011636638129917, -0.028398092589046, -0.022323480953221, -0.012718756717171, -0.007648866439131, -0.018673014370404,
        -0.079805618386698, -0.077688400165636, -0.008634579130305, -0.034344538806299, 0.035942607034397,  0.032076650773268,  -0.005823840074303,
        -0.025094861266549, -0.057275575292343, -0.042069058995670, -0.003833474925741, -0.017714134979640};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 36, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.025977472259398, -0.016990614714734, 0.000000000000000,  0.000000000000000,  0.026279949746357,
        0.007096272476813,  0.000000000000000,  0.000000000000000,  -0.000653818622047, -0.005383106692943, 0.000000000000000,  0.000000000000000,
        -0.025199708600114, -0.018462172291846, 0.000000000000000,  0.000000000000000,  0.017732803501833,  0.006643115467335,  -0.000000000000000,
        -0.000000000000000, -0.001452529810442, -0.005746301824924, -0.056109201035973, -0.042455086033245, -0.015878829846611, -0.034390816959770,
        0.067520274120582,  0.051014874746834,  -0.009209480212269, -0.024065965546445, -0.027719471933182, -0.023647888001694, -0.012505430011188,
        -0.023202085125532, -0.104416421147424, -0.087789026062612, -0.007012367840964, -0.031872713477647, 0.034551210812500,  0.030921411210901,
        -0.004968660228122, -0.023170844923795, -0.034128443682612, -0.033097571676218, -0.004668618744989, -0.018425001526577, 0.000000000000000,
        0.000000000000000,  -0.052457010358831, -0.034495651573815, 0.000000000000000,  0.000000000000000,  0.017082474816523,  0.002926546009990,
        0.000000000000000,  0.000000000000000,  0.074828099184821,  0.031674812264830,  0.000000000000000,  0.000000000000000,  -0.046777369422556,
        -0.036659229505253, -0.000000000000000, 0.000000000000000,  0.009584278298234,  0.002084680134384,  0.000000000000000,  0.000000000000000,
        0.064544781690888,  0.033656892617606,  -0.007052880368677, -0.033631013903103, -0.036963299652011, -0.069565857423671, 0.108351941624654,
        0.074184928177652,  -0.035592986814882, -0.071864474937185, 0.032126932110667,  0.035309587279893,  -0.014562210750731, -0.021664345761497,
        -0.093341946393638, -0.110128583753678, -0.013980236843987, -0.054094132490834, 0.020797720346358,  0.016159966029563,  -0.014469222746498,
        -0.050279348743690, 0.087829592600264,  0.086844253245226,  -0.004207588199776, -0.004944044995934, 0.000000000000000,  0.000000000000000,
        -0.018007817103312, -0.012562308168701, 0.000000000000000,  0.000000000000000,  -0.032495083241601, 0.011122528878920,  0.000000000000000,
        0.000000000000000,  0.042846716072871,  0.026364838729533,  0.000000000000000,  0.000000000000000,  -0.000147081982624, -0.010176423500910,
        0.000000000000000,  0.000000000000000,  -0.011599197184648, 0.014100072159633,  0.000000000000000,  0.000000000000000,  0.045143220573732,
        0.029356582875135,  0.408994715467187,  0.190192786078273,  -0.031657728897384, -0.024343992399780, 0.062467169540410,  0.036923028033780,
        -0.054984464494309, -0.070886208584636, -0.015411831636015, -0.004755472454641, -0.026979174851092, -0.030571409472598, 0.422969367720058,
        0.222194396706215,  -0.004102145009207, 0.021186711566606,  0.029664013228951,  0.032884295910201,  -0.013272970979682, 0.010543702628087,
        0.053673893191894,  0.056891237359226,  -0.005626121669939, 0.009604233125327,  0.000000000000000,  0.000000000000000,  -0.066180823822749,
        -0.044138303377610, 0.000000000000000,  0.000000000000000,  0.045979747559766,  0.036766592345515,  0.000000000000000,  0.000000000000000,
        -0.048533653620306, -0.013840741519172, 0.000000000000000,  0.000000000000000,  -0.045368195573251, -0.044184461332476, -0.000000000000000,
        0.000000000000000,  0.050746594143176,  0.040467211823892,  0.000000000000000,  0.000000000000000,  -0.040274369180456, -0.014750330810418,
        0.343979150605261,  0.130603861710943,  -0.062903370165190, -0.088162750823386, 0.133838919844079,  0.096211990060306,  -0.086189764663302,
        -0.131341967170813, 0.085326592678368,  0.049892281034056,  -0.024563502295504, -0.044325454706822, 0.272508523259808,  0.084065330456003,
        -0.017039844798290, -0.034146511746030, 0.100600318814463,  0.100312021478450,  -0.025433960086201, -0.031213069035640, -0.020381738930349,
        -0.022521850983314, -0.008743202607132, -0.019568534094229, 0.000000000000000,  0.000000000000000,  -0.026169003561775, -0.015364426668568,
        0.000000000000000,  0.000000000000000,  0.051576950530808,  -0.009530751586866, 0.000000000000000,  0.000000000000000,  0.014949219791467,
        0.009975211999210,  -0.000000000000000, 0.000000000000000,  -0.035578933659884, -0.018954836262258, 0.000000000000000,  0.000000000000000,
        0.032321201542763,  -0.011718947779941, 0.000000000000000,  0.000000000000000,  0.003103841367977,  0.008421577642830,  0.105514417024165,
        0.083316562980449,  -0.018259884530903, -0.059414719863755, -0.003577512298288, -0.016740774707796, -0.090775141329659, -0.177570467863530,
        0.236064584988568,  0.175358849644204,  0.008817374414190,  -0.003591865427524, -0.079673338095985, -0.052641803565509, -0.012400706035876,
        -0.064152015359949, -0.097843513305386, -0.099184538941259, -0.035839135065235, -0.139596210337993, 0.114296641831983,  0.102866244894461,
        -0.001077233564283, -0.015908409135918, 0.000000000000000,  0.000000000000000,  -0.010655776580075, -0.005441091024943, 0.000000000000000,
        0.000000000000000,  0.023735652932931,  0.005161659819890,  0.000000000000000,  0.000000000000000,  -0.005265057551242, -0.010121058210754,
        0.000000000000000,  0.000000000000000,  -0.009765915932325, -0.006057348341077, 0.000000000000000,  0.000000000000000,  0.022050061356336,
        0.005648541770225,  0.000000000000000,  0.000000000000000,  -0.002331900011152, -0.010165722537620, 0.504545158637119,  0.297456674862599,
        -0.024563502295504, -0.044325454706822, 0.086622882448322,  0.046655247991084,  -0.114606050872990, -0.198433527497166, -0.057792990256204,
        -0.054399910028117, -0.057333698254204, -0.096514795880412, 0.355453959284707,  0.217137024213301,  -0.008743202607132, -0.019568534094229,
        -0.029225991069300, -0.029706174225215, -0.039287719154696, -0.105492140784044, -0.085996830305580, -0.082136846728862, -0.019101562002934,
        -0.054696010931369, 0.000000000000001,  0.000000000000001,  -0.026915161698164, -0.015883774481244, 0.000000000000000,  0.000000000000000,
        0.037857664159515,  -0.013317150539384, 0.000000000000000,  0.000000000000000,  0.066952560806318,  0.013439746297327,  -0.000000000000000,
        0.000000000000000,  -0.039127390315844, -0.020059074471229, 0.000000000000000,  0.000000000000000,  0.013894469059733,  -0.017101068634869,
        0.000000000000000,  0.000000000000000,  0.054273924781774,  0.014064365009343,  -0.021666455572916, 0.014768903829017,  -0.013569158857827,
        -0.057226447364999, 0.097087379577201,  0.059873323598832,  -0.052927934506533, -0.124539753708439, -0.055556740653776, -0.037191843989023,
        -0.035512247309614, -0.063844032697579, -0.202578023878515, -0.126297590612636, -0.012122319013825, -0.071313963182481, -0.049779021293237,
        -0.057292911640342, -0.025598827231280, -0.123034231040854, -0.011388794109751, -0.009656102239242, -0.012812418426965, -0.047201327478934,
        0.000000000000000,  0.000000000000000,  -0.028606386062199, -0.017836911549195, 0.000000000000000,  0.000000000000000,  0.063744404603548,
        0.007536278401946,  0.000000000000000,  0.000000000000000,  -0.035068016068038, -0.031379798170350, 0.000000000000000,  0.000000000000000,
        -0.037029192245768, -0.021318395424808, 0.000000000000000,  0.000000000000000,  0.039537689535706,  0.005511585965846,  0.000000000000000,
        0.000000000000000,  -0.034627757934162, -0.033719413300250, -0.152253264899222, -0.074735510433220, -0.011486132886464, -0.046404483973274,
        0.097394441134442,  0.074570131564915,  -0.013422837822497, -0.047871528899535, -0.085745436294697, -0.077709824178631, -0.025934456706302,
        -0.054102410625086, -0.269012049767796, -0.177236380589337, -0.009845905163092, -0.060593001289816, 0.035844977531953,  0.028368836696460,
        -0.010169055734300, -0.065129269753611, -0.138034677826463, -0.135489040754616, -0.011048293015105, -0.054134051161469, 0.000000000000001,
        0.000000000000001,  0.012604087153263,  0.008576169866677,  0.000000000000000,  0.000000000000000,  0.008092350003026,  0.001532805792799,
        0.000000000000000,  0.000000000000000,  -0.035332256138873, -0.020078571491445, -0.000000000000000, 0.000000000000000,  0.009064890342407,
        0.008653232256883,  0.000000000000000,  0.000000000000000,  0.005861648554244,  0.001485625064173,  0.000000000000000,  0.000000000000000,
        -0.030690358142319, -0.021223692240502, 0.007921857304034,  0.017976665002240,  0.009358293471343,  0.013099840119583,  -0.006301973931712,
        -0.002875813000259, 0.003899284817776,  0.005467154045899,  -0.053973260360700, -0.048483305039960, -0.007496260523213, -0.014906389469612,
        0.006761503858931,  0.020622488962703,  0.002546257718443,  0.006599304222264,  0.003491775565766,  0.003336304632653,  0.001036598681730,
        -0.000014113381351, -0.079805618386698, -0.077688400165636, -0.003036848305615, -0.015818459428934};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 36, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.013472475664942, -0.001719070563616, 0.000000000000000,  0.000000000000000,  0.004758633041585,
        0.000107230855929,  0.000000000000000,  0.000000000000000,  0.005832312996846,  0.000492772792906,  0.000000000000000,  0.000000000000000,
        -0.014285490735522, -0.002480076332648, 0.000000000000000,  0.000000000000000,  0.003459262945929,  0.000106349203679,  0.000000000000000,
        0.000000000000000,  0.005386432497109,  0.000686600780123,  0.067520274120582,  0.051014874746835,  0.023456758961513,  0.034973888754381,
        -0.086196753129514, -0.052455269268475, 0.011189231711310,  0.019066615940309,  -0.034348249172716, -0.023909082966048, 0.001586652481160,
        0.004180585230942,  0.034551210812500,  0.030921411210901,  0.006833222260598,  0.015888305763481,  -0.049714406642715, -0.032003305158101,
        0.003737986520492,  0.006987869500106,  -0.010300493143410, -0.008989403146859, 0.000839110862672,  0.001787169217075,  -0.000000000000000,
        0.000000000000000,  -0.036330578559426, -0.008918124685547, 0.000000000000000,  0.000000000000000,  -0.006298263903058, -0.000818833752543,
        0.000000000000000,  0.000000000000000,  0.068706992590537,  0.019154207762268,  0.000000000000000,  0.000000000000000,  -0.033436866736619,
        -0.010173629277676, 0.000000000000000,  0.000000000000000,  -0.003681415822122, -0.000635410792996, 0.000000000000000,  0.000000000000000,
        0.066087761630552,  0.022097898064915,  0.108351941624654,  0.074184928177652,  0.008298764657589,  0.007463990092319,  0.075103042150092,
        0.042616352092208,  -0.013044126374255, -0.020217529392207, -0.193637174131322, -0.135797170654531, -0.041754104447579, -0.055124264476421,
        0.020797720346358,  0.016159966029563,  0.001388289663991,  0.002202191159676,  0.047306950127438,  0.027840103574332,  -0.003920931204150,
        -0.005574503789630, -0.044170155815567, -0.034531606977224, -0.010627004695460, -0.018922887733640, 0.000000000000000,  0.000000000000000,
        -0.004731487930280, 0.017279275647770,  0.000000000000000,  0.000000000000000,  -0.056313778132239, -0.002865845715585, 0.000000000000000,
        0.000000000000000,  0.069868226744723,  0.038539974391846,  0.000000000000000,  0.000000000000000,  0.010762783362884,  0.020471824385103,
        0.000000000000000,  0.000000000000000,  -0.018040650847181, 0.001952506942716,  0.000000000000000,  0.000000000000000,  0.074087057039274,
        0.043335066814434,  0.062467169540410,  0.036923028033780,  -0.077798977958080, -0.112120387508006, 0.576027596994225,  0.294607120234062,
        -0.128814251550335, -0.173242151552754, -0.053059348680012, -0.033275354602793, -0.068906326842370, -0.092461668921028, 0.029664013228951,
        0.032884295910201,  -0.021515554568946, -0.016735700871584, 0.458896218647285,  0.258031574269224,  -0.032899805001476, -0.012201369547039,
        0.048559867112511,  0.055454495999948,  -0.017630989819940, -0.010023819198948, -0.000000000000000, -0.000000000000000, -0.040904207646706,
        0.017499544814961,  0.000000000000000,  0.000000000000000,  -0.002844402126475, 0.028009092921720,  0.000000000000000,  0.000000000000000,
        -0.103629758445141, -0.023082397773233, 0.000000000000000,  0.000000000000000,  -0.019233438861685, 0.020527321880359,  0.000000000000000,
        0.000000000000000,  0.041543881624560,  0.037477271299498,  0.000000000000000,  0.000000000000000,  -0.080535458268479, -0.023581852719256,
        0.133838919844079,  0.096211990060306,  -0.014793566021999, -0.002302895884072, 0.299005452547327,  0.120809426825642,  -0.082098596119403,
        -0.061784598720857, 0.086622882448322,  0.046655247991084,  -0.009944537833321, -0.009271853638932, 0.100600318814464,  0.100312021478450,
        0.000360547265056,  0.054155646548478,  0.462953475542727,  0.285012630577839,  -0.010136552046870, 0.083886653418146,  -0.029225991069300,
        -0.029706174225215, -0.001474891316918, 0.019652042090113,  0.000000000000000,  0.000000000000000,  -0.128093596037582, -0.049373792253550,
        0.000000000000001,  0.000000000000001,  0.078777550390293,  0.043981982064696,  0.000000000000000,  0.000000000000000,  -0.085395730691722,
        -0.032915861502367, 0.000000000000000,  0.000000000000000,  -0.112393098686524, -0.052953384174489, -0.000000000000001, 0.000000000000000,
        0.074903036789755,  0.048103233418169,  0.000000000000000,  0.000000000000000,  -0.074928732457682, -0.035302256116326, -0.003577512298288,
        -0.016740774707796, 0.056867700231873,  0.089274203418645,  -0.242793815760132, -0.127469377653165, 0.073161225673835,  0.146340318449938,
        -0.002385008198858, -0.011160516471864, 0.037911800154582,  0.059516135612430,  -0.097843513305386, -0.099184538941259, 0.017502281347601,
        0.036940916135935,  0.026259113537720,  0.069343728950326,  0.029438834470205,  0.105472981994656,  -0.065229008870258, -0.066123025960840,
        0.011668187565068,  0.024627277423957,  0.000000000000000,  0.000000000000000,  -0.103629758445141, -0.023082397773233, 0.000000000000000,
        0.000000000000000,  -0.001896268084316, 0.018672728614480,  0.000000000000000,  -0.000000000000000, 0.045453924390911,  0.036734876292655,
        0.000000000000000,  0.000000000000000,  -0.080535458268479, -0.023581852719256, 0.000000000000000,  0.000000000000000,  0.027695921083040,
        0.024984847532998,  0.000000000000000,  0.000000000000000,  0.047879443028715,  0.040178865813072,  0.086622882448322,  0.046655247991084,
        -0.009944537833321, -0.009271853638932, 0.199336968364885,  0.080539617883761,  -0.054732397412935, -0.041189732480571, 0.061653184470477,
        0.057332616734403,  -0.006506451160898, 0.005423648815038,  -0.029225991069300, -0.029706174225215, -0.001474891316918, 0.019652042090113,
        0.308635650361818,  0.190008420385226,  -0.006757701364580, 0.055924435612097,  0.124955311372214,  0.125067166666129,  0.001589623362487,
        0.037778944806717,  0.000000000000000,  0.000000000000000,  -0.092957864336766, -0.042326292667903, 0.000000000000000,  0.000000000000000,
        0.023464074221766,  0.001194102381494,  0.000000000000000,  0.000000000000000,  0.113282215317940,  0.036631569058730,  0.000000000000000,
        0.000000000000000,  -0.091469921637758, -0.047123265885467, -0.000000000000000, 0.000000000000000,  0.007516937852992,  -0.000813544559465,
        0.000000000000000,  0.000000000000000,  0.099608535755137,  0.039833730748165,  0.097087379577201,  0.059873323598832,  0.054568684813945,
        0.069745995218733,  -0.240011498747594, -0.122752966764192, 0.053672604812640,  0.072184229813647,  -0.162564988378552, -0.099022146834863,
        -0.004517696479463, 0.003981944748166,  -0.049779021293237, -0.057292911640342, 0.013238287209897,  0.005499899566420,  -0.191206757769702,
        -0.107513155945510, 0.013708252083948,  0.005083903977933,  0.035895245708214,  0.042280642516659,  0.000936036549055,  0.006386555028005,
        0.000000000000000,  0.000000000000000,  -0.041915114399110, -0.015894365033219, 0.000000000000000,  0.000000000000000,  0.032191126615632,
        0.004185150290777,  0.000000000000000,  -0.000000000000000, -0.009761966019594, -0.005685447312573, 0.000000000000000,  0.000000000000000,
        -0.045564981141663, -0.018737300671426, 0.000000000000000,  0.000000000000000,  0.018816125313066,  0.003247655164201,  0.000000000000000,
        -0.000000000000000, -0.013085109418471, -0.006841036862466, 0.097394441134442,  0.074570131564914,  0.073402030924920,  0.109052798179110,
        -0.383859993211580, -0.217816910693505, 0.066669979246194,  0.103334039115723,  0.012911231402748,  0.013468114413783,  0.039682958414285,
        0.060943119347485,  0.035844977531953,  0.028368836696460,  0.021199627161956,  0.038687567371925,  -0.241791078429127, -0.142293862713254,
        0.020040315043436,  0.028491908258109,  0.012541918548442,  0.010048552167805,  0.011872806943266,  0.021802165134309,  0.000000000000000,
        0.000000000000000,  0.000314701552989,  -0.000191935236850, 0.000000000000000,  -0.000000000000000, 0.004718977766239,  0.000106337265463,
        0.000000000000000,  0.000000000000000,  -0.014728649492547, -0.001780548255138, 0.000000000000000,  0.000000000000000,  -0.000402800318282,
        -0.000299347244519, -0.000000000000000, -0.000000000000000, 0.003430435754713,  0.000105462960315,  0.000000000000000,  0.000000000000000,
        -0.015303921432033, -0.002559213571080, -0.006301973931712, -0.002875813000259, 0.010290505525690,  0.017018429887364,  -0.085478446853434,
        -0.052018142024571, 0.011095988113716,  0.018907727474140,  0.075827354888991,  0.056488505078308,  0.021029601043865,  0.030641761711779,
        0.003491775565766,  0.003336304632653,  0.003345662646915,  0.007627894361812,  -0.049300119920692, -0.031736610948451, 0.003706836632821,
        0.006929637254271,  0.035942607034397,  0.032076650773268,  0.005978042414418,  0.013964289420727};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 36, 12));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeGDForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix efxmat(36, 20);

    CDenseMatrix efymat(36, 20);

    CDenseMatrix efzmat(36, 20);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.001340544375042, 0.022244229127252,  0.000000000000000,  0.000000000000000,  0.037828311663751,
        0.014689787941694,  0.000000000000000,  0.000000000000000,  0.001196617722428,  0.002679740807098,  0.000000000000000,  0.000000000000000,
        -0.053873876753120, -0.029417949493597, 0.000000000000000,  0.000000000000000,  0.024654588450234,  0.039631919594115,  0.000000000000000,
        0.000000000000000,  -0.001182101323894, 0.023078278988758,  0.000000000000000,  0.000000000000000,  0.026073889704900,  0.013857030648389,
        0.000000000000000,  0.000000000000000,  -0.000773473222193, 0.002136327553555,  0.000000000000000,  0.000000000000000,  -0.035462281651682,
        -0.027308269837145, 0.000000000000000,  0.000000000000000,  0.028835504127538,  0.044189916020072,  0.011885256012755,  -0.006995969617732,
        -0.041416515866325, -0.040256056550310, -0.028585702949952, -0.023071477047751, -0.009044653652582, -0.010136181435184, -0.020652777070103,
        -0.015726194002125, -0.004019431608391, -0.006674940397725, 0.060592736930296,  0.056784216368956,  -0.020841743190153, -0.024787083430362,
        -0.018973136929280, -0.019350101191977, -0.033299016621525, -0.036685974608933, 0.011283203704734,  -0.014654755077496, -0.013619458289060,
        -0.034079895652133, -0.016962286952553, -0.017573950121230, -0.003410630684890, -0.003204991995125, 0.001951256766643,  -0.001291579384961,
        -0.002294477472328, -0.004279218129428, 0.034686709159196,  0.040725430988788,  -0.008461413562988, -0.021575332641100, -0.061876193266490,
        -0.065135273184259, -0.012543303460905, -0.040590062937236, 0.000000000000000,  0.000000000000000,  -0.006314243850471, 0.031216427571015,
        0.000000000000000,  0.000000000000000,  0.015588198424122,  -0.006742639158355, 0.000000000000000,  0.000000000000000,  0.050648752452391,
        0.011707287096854,  0.000000000000000,  0.000000000000000,  -0.067812547060896, -0.017083025596692, 0.000000000000000,  0.000000000000000,
        0.025128317472699,  0.007027402302087,  0.000000000000000,  0.000000000000000,  0.001969002148436,  0.036205339849068,  0.000000000000000,
        0.000000000000000,  0.004923622874818,  -0.005139986138487, 0.000000000000000,  0.000000000000000,  0.019504913713758,  0.007816618890784,
        0.000000000000000,  0.000000000000000,  -0.047734850163801, -0.012863317395602, 0.000000000000000,  0.000000000000000,  0.035596392353774,
        0.011934694761743,  0.096321539272257,  0.048599887340154,  -0.071218043080683, -0.090961179591337, 0.025244335771744,  0.024408007766067,
        -0.115221826806026, -0.149534272401285, -0.026439776466452, -0.028740120199940, -0.030372851247738, -0.052343467591436, 0.026884899435899,
        0.026715030149190,  -0.075100330447797, -0.108243550115071, -0.113930795906007, -0.048927901420123, 0.034622676713065,  0.029478734841901,
        0.056658158854561,  0.015483156082062,  -0.031268022008570, -0.093032256690036, 0.015662706619446,  0.013632475810466,  -0.051332767917868,
        -0.133718007481937, 0.086199173656037,  0.050627174664987,  -0.018169006186381, -0.048255009655264, 0.026299966146533,  0.021277135773874,
        -0.037399678297803, -0.111975869862367, -0.163022280900859, -0.097468360479946, 0.009849727109584,  0.014503115897639,  0.000000000000000,
        0.000000000000000,  0.001817657748231,  -0.011340259009289, 0.000000000000000,  0.000000000000000,  0.019862937694727,  0.020624991697237,
        0.000000000000000,  0.000000000000000,  -0.000393311591215, -0.008311732888493, 0.000000000000000,  0.000000000000000,  0.021461827487573,
        0.007823100844254,  0.000000000000000,  0.000000000000000,  0.054236707480515,  0.031119555958944,  0.000000000000000,  0.000000000000000,
        0.001733117801385,  -0.010029876889044, 0.000000000000000,  0.000000000000000,  0.010624903247452,  0.025908741760640,  0.000000000000000,
        0.000000000000000,  -0.012370125851978, -0.007122333379428, 0.000000000000000,  0.000000000000000,  0.011184969461319,  0.008796880915652,
        0.000000000000000,  0.000000000000000,  0.048234811571844,  0.032367025525618,  0.025295139532738,  0.013585184722957,  0.014406289729441,
        -0.018707929066577, -0.013478001774499, -0.010217796730871, -0.053765673845509, -0.093598041361890, 0.090199956778452,  0.061920947017349,
        -0.017569457364606, -0.040677243500726, 0.041279543944596,  -0.002122745280852, 0.003825029059886,  -0.052414006047294, -0.180765427399488,
        -0.124423320968896, -0.016756595968372, -0.022845579473559, -0.036644470332363, -0.011074721231029, -0.007136933919876, -0.042521605965630,
        -0.024777778908927, -0.032934875737105, -0.032913565283217, -0.138507239631920, 0.128537761279381,  0.089126794285495,  -0.014550188197780,
        -0.075233094762924, -0.046873413271158, -0.033426770507322, -0.019136939648888, -0.090958253707096, -0.240841402330939, -0.178073327403155,
        -0.007806560679617, -0.015178180071792, 0.000000000000000,  0.000000000000000,  -0.009580438510568, -0.013003683786423, 0.000000000000000,
        0.000000000000000,  0.014733966814967,  0.005864300914950,  0.000000000000000,  0.000000000000000,  -0.018538890964908, -0.001492322555322,
        0.000000000000000,  0.000000000000000,  0.031195552497534,  0.011924688272469,  0.000000000000000,  0.000000000000000,  -0.006650466218523,
        0.000298460585050,  0.000000000000000,  0.000000000000000,  -0.011596743739206, -0.015180055894711, 0.000000000000000,  0.000000000000000,
        0.015477291318891,  0.006857831223546,  0.000000000000000,  0.000000000000000,  -0.003516797540552, 0.001771634153614,  0.000000000000000,
        0.000000000000000,  0.030105217815824,  0.013343084268453,  0.000000000000000,  0.000000000000000,  -0.005906650547425, -0.000058844022446,
        0.146198422437586,  0.071043010018966,  0.026182363519909,  0.023455640837860,  0.050252619045454,  0.029621766312500,  0.171990552744018,
        0.192627495766880,  -0.084470191070331, -0.036286738289792, 0.171714544990124,  0.188417936938696,  0.005359817311516,  -0.024977218184051,
        0.018785500475289,  0.007497319564657,  0.205146186702765,  0.112645578599609,  -0.021598048329159, -0.035514775974370, 0.040021501899015,
        0.031134420647601,  0.007806396106105,  0.012756472120510,  0.013766977651832,  0.015551456298163,  0.065267505767581,  0.121319984970412,
        -0.055088805822438, -0.026111303759207, 0.063765693386900,  0.113485252638829,  -0.228123028793546, -0.162444373219704, 0.002114497933127,
        -0.016441833202387, 0.146216131137512,  0.099927394296621,  -0.012235564856315, -0.026269557262863, 0.000000000000000,  0.000000000000000,
        0.027148732061012,  0.022204355079380,  0.000000000000000,  0.000000000000000,  -0.034633323902294, -0.001757124170684, 0.000000000000000,
        0.000000000000000,  -0.000868383523038, 0.008519714667757,  0.000000000000000,  0.000000000000000,  0.031001523726871,  -0.018930923134536,
        0.000000000000000,  0.000000000000000,  0.015460191761038,  0.020953214296370,  0.000000000000000,  0.000000000000000,  0.015785315583069,
        0.019968839215169,  0.000000000000000,  0.000000000000000,  -0.020589947633544, -0.002183379107541, 0.000000000000000,  0.000000000000000,
        0.013043915673053,  0.010078519512841,  0.000000000000000,  0.000000000000000,  0.020121715467801,  -0.023292555955625, 0.000000000000000,
        0.000000000000000,  -0.000453577020803, 0.017180260861709,  0.196601938964464,  0.101847818718429,  0.019880268624551,  0.036905064833600,
        0.060043088368964,  0.027667470960453,  -0.009935795927648, 0.019150740417581,  -0.101958825125040, -0.055234416362811, 0.120595095731362,
        0.133066007315949,  -0.166412938521970, -0.088432404334729, 0.077897120634642,  0.105702265867730,  -0.019911685854892, -0.035095678608364,
        0.025241688629474,  0.028427303835730,  0.192853643654489,  0.116850544235397,  0.012888021717789,  0.042254345172381,  -0.019783841745477,
        -0.023482381534204, 0.007151402297108,  0.036764845074798,  -0.071141907232810, -0.039212496660734, 0.045301683413859,  0.106854079866999,
        -0.120391428388492, -0.062372770750822, 0.036449815611840,  0.110345008410396,  0.090904066219744,  0.041881252008727,  0.009664636457591,
        0.022421589220215,  0.000000000000000,  0.000000000000000,  0.038867475522011,  0.030045792341971,  0.000000000000000,  0.000000000000000,
        0.013101777927459,  -0.019227247616134, 0.000000000000000,  0.000000000000000,  -0.069724797204441, 0.007703995775951,  0.000000000000000,
        0.000000000000000,  0.060029497708440,  0.006418205312583,  0.000000000000000,  0.000000000000000,  -0.041736338902528, -0.024806458524791,
        0.000000000000000,  0.000000000000000,  0.011483276070869,  0.024559341548373,  0.000000000000000,  0.000000000000000,  -0.002224758972502,
        -0.020996908422819, 0.000000000000000,  0.000000000000000,  -0.039511341188223, 0.016601862190301,  0.000000000000000,  0.000000000000000,
        0.046005683999416,  0.007052933338069,  0.000000000000000,  0.000000000000000,  -0.030557403415889, -0.025554340527071, 0.004117502642774,
        -0.042485641066233, 0.009247701292301,  0.003432600113203,  0.007797749940026,  0.009501852933760,  0.018785500475289,  0.007497319564657,
        0.102803997804524,  0.072154118611446,  -0.052471203754110, -0.072790184096596, -0.058116379075654, -0.041241857848343, 0.056284636447048,
        0.024189216027150,  -0.055392645245404, -0.030395979133903, 0.005509019981830,  -0.000016749950457, 0.053617541670748,  0.006389471490048,
        0.000977655064967,  -0.002661007830096, 0.023962851760790,  0.027993873659935,  0.002114497933127,  -0.016441833202387, 0.044829430480213,
        0.017803703287263,  -0.025354704606484, -0.105908182527279, -0.116598339212732, -0.065993282106353, 0.007399645475930,  -0.008214936345579,
        -0.061523547353682, -0.029934816458258, -0.000084924520875, 0.002244553727799,  0.000000000000000,  0.000000000000000,  -0.060099095230663,
        -0.028295128438108, 0.000000000000000,  0.000000000000000,  0.038881548908117,  -0.008010664576510, 0.000000000000000,  0.000000000000000,
        -0.017099089577243, -0.003992081905903, 0.000000000000000,  0.000000000000000,  -0.018508224680359, 0.022370002654337,  0.000000000000000,
        0.000000000000000,  -0.034406000617422, -0.027119174294669, 0.000000000000000,  0.000000000000000,  -0.055139593082327, -0.030433959905839,
        0.000000000000000,  0.000000000000000,  0.014247532470673,  -0.010513074318517, 0.000000000000000,  0.000000000000000,  -0.021636518847164,
        -0.004356025308656, 0.000000000000000,  0.000000000000000,  -0.006188482259711, 0.028339523673393,  0.000000000000000,  0.000000000000000,
        -0.009760176971791, -0.022316228845006, 0.164106785192920,  0.107056429219124,  -0.016756595968372, -0.022845579473559, -0.027683269902629,
        -0.014626293036211, -0.165731545708711, -0.196068338241717, 0.076589710022345,  0.042168569403128,  -0.118858513348877, -0.151944575493316,
        -0.097117659517724, -0.044436422817422, -0.090259594491082, -0.112357330522098, -0.137213668305967, -0.045261084793541, 0.053661745953829,
        0.052772267050483,  0.256755771039228,  0.184638722432351,  -0.007806560679617, -0.015178180071792, -0.000334409742606, -0.000037064420121,
        -0.066769500771021, -0.139941956224679, 0.118877289982355,  0.075693045891536,  -0.051985398519745, -0.120805205051272, -0.006049773428198,
        -0.019096009300679, -0.038484704709578, -0.105387504414765, -0.145057908694453, -0.068643006600352, 0.017779912591897,  0.030148034913274,
        0.000000000000000,  0.000000000000000,  -0.043589421789329, -0.011716160239501, 0.000000000000000,  0.000000000000000,  0.068536401324881,
        0.018333709913521,  0.000000000000000,  0.000000000000000,  -0.042040261662826, -0.006109228488577, 0.000000000000000,  0.000000000000000,
        -0.047697080485373, -0.014168109363580, 0.000000000000000,  0.000000000000000,  -0.017191803670935, 0.026846379770161,  0.000000000000000,
        0.000000000000000,  -0.043109046156837, -0.015474180448228, 0.000000000000000,  0.000000000000000,  0.046210999724449,  0.013592586707619,
        0.000000000000000,  0.000000000000000,  -0.023311380583841, -0.004784247177524, 0.000000000000000,  0.000000000000000,  -0.022721044443779,
        -0.009797215112504, 0.000000000000000,  0.000000000000000,  -0.000587918153489, 0.033019859876126,  0.068295035137178,  0.033265475189580,
        -0.021033332280330, -0.003145562180766, -0.063716494767059, -0.050790102116365, 0.022248445862123,  0.039113416960612,  -0.009700643403789,
        -0.003823732922308, -0.014653721030870, -0.013138812353571, 0.019332556464527,  0.040965162755292,  -0.043044465852519, -0.028566647640943,
        0.074187936470035,  0.046425005387462,  -0.041701352276637, -0.045703801471697, 0.134905885458978,  0.082706796909282,  -0.000628564659451,
        0.015089804395607,  -0.024553867909641, -0.021218404997305, 0.013810501899129,  0.065666221194129,  -0.026996935647630, -0.017148924833194,
        -0.004303700153384, 0.000522708785884,  -0.001222130977995, 0.007551059548377,  -0.009292763349525, -0.011462603742135, 0.030694005247501,
        0.002486874551341,  -0.015651284424477, -0.054344532177685, 0.000000000000000,  0.000000000000000,  -0.031595760730941, -0.041654309758760,
        0.000000000000000,  0.000000000000000,  0.031497264958369,  0.024489060074909,  0.000000000000000,  0.000000000000000,  -0.044286113254135,
        -0.016367612906806, 0.000000000000000,  0.000000000000000,  0.020891764272205,  0.009999705929182,  0.000000000000000,  0.000000000000000,
        0.001325917893327,  0.022704486717041,  0.000000000000000,  0.000000000000000,  -0.031608937524597, -0.045738873104634, 0.000000000000000,
        0.000000000000000,  0.024093769091729,  0.023309932014206,  0.000000000000000,  0.000000000000000,  -0.025072904997145, -0.014293358710024,
        0.000000000000000,  0.000000000000000,  0.018260078776947,  0.010121475528509,  0.000000000000000,  0.000000000000000,  0.000206583235493,
        0.023449325590335,  0.013643594089339,  0.020101950190122,  0.042465352520745,  0.051507322272185,  -0.056996486626745, -0.048665148023163,
        0.030450860790419,  0.043407448389207,  0.041629764925726,  0.035707135068243,  0.000515565711918,  0.005209075556236,  -0.008669797427427,
        -0.005575225316062, 0.011826798573145,  0.021865617531937,  0.016858251274937,  -0.004905978356124, -0.040595297993968, -0.040069235591989,
        0.054239851777940,  0.061649629056140,  0.017676394622529,  0.054247851028291,  -0.039746515421872, -0.041352917294286, 0.014981760061900,
        0.042500687255567,  -0.008410848767451, 0.003191987036577,  0.001867795873846,  0.005591795432063,  -0.020623740815880, -0.017034947820545,
        0.007632070360832,  0.024151360356236,  0.013165893294989,  -0.013666587067200, -0.013581232423580, -0.035301818225401};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 36, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.025846769664198, -0.040082716053939, 0.000000000000000,  0.000000000000000,  0.049457306258177,
        0.026128566282701,  0.000000000000000,  0.000000000000000,  -0.047465504370413, -0.016590108246074, 0.000000000000000,  0.000000000000000,
        0.000848507344817,  0.008289821628019,  0.000000000000000,  0.000000000000000,  0.033416174422431,  0.030838944212514,  0.000000000000000,
        0.000000000000000,  -0.024955707403962, -0.043447823463635, 0.000000000000000,  0.000000000000000,  0.038956440362916,  0.025426813604315,
        0.000000000000000,  0.000000000000000,  -0.027490655066165, -0.014574426653664, 0.000000000000000,  0.000000000000000,  0.002050708730869,
        0.007924708129673,  0.000000000000000,  0.000000000000000,  0.035994471773871,  0.035277348792181,  0.002590004341459,  0.016272251476634,
        0.046311454726502,  0.053316698046145,  -0.043920534178028, -0.035069850263058, 0.020539252484212,  0.035484485220462,  0.036304783661201,
        0.031986230316688,  -0.001152690928546, 0.002801231484677,  -0.028585702949952, -0.023071477047751, 0.016835057286785,  0.023969226904575,
        -0.031214941564679, -0.019614238706371, -0.015094105479675, -0.023847582723422, 0.036418221353295,  0.051757925760538,  0.018249209492114,
        0.054377995960928,  -0.044019988486516, -0.041307091803690, 0.012370191106115,  0.040331382713232,  -0.008280721242968, 0.002907998131840,
        0.001046542065227,  0.004235765940487,  -0.016962286952553, -0.017573950121230, 0.008276690526208,  0.023495169709888,  -0.077223764924976,
        -0.063625928732585, -0.008295711111428, -0.031233702528294, 0.000000000000000,  0.000000000000000,  0.027282231279303,  0.007108470739223,
        0.000000000000000,  0.000000000000000,  0.070504715906853,  0.018076874637669,  0.000000000000000,  0.000000000000000,  -0.012555561519490,
        -0.004375360185757, 0.000000000000000,  0.000000000000000,  -0.102185590126653, -0.016599957815390, 0.000000000000000,  0.000000000000000,
        0.006146850252930,  0.034456953208901,  0.000000000000000,  0.000000000000000,  0.037014938632861,  0.012028772097823,  0.000000000000000,
        0.000000000000000,  0.045672733055029,  0.013314771749990,  0.000000000000000,  0.000000000000000,  -0.001927526723842, -0.002633343105051,
        0.000000000000000,  0.000000000000000,  -0.063856847114568, -0.012224463157402, 0.000000000000000,  0.000000000000000,  0.028719611566581,
        0.044209007905738,  -0.107227634235531, -0.045055622465930, 0.039272937303392,  0.035028589892846,  -0.021407348086233, -0.031458404806840,
        0.078751389647389,  0.100291814516328,  0.019475082215688,  0.018425440777910,  0.023805214003140,  0.036078729320792,  0.025244335771744,
        0.024408007766067,  0.031305165058879,  0.032403906063205,  -0.018214051101604, 0.002660751037064,  -0.029940431018899, -0.045750386684079,
        -0.162466259364259, -0.096992257143076, 0.011726118773680,  0.017211245530159,  -0.019563126778687, -0.018803234758586, 0.034398347018562,
        0.093619080223668,  -0.039557965450910, -0.022705635152589, 0.012418432489544,  0.028101902670144,  0.015662706619446,  0.013632475810466,
        0.010866174049312,  0.007437019539672,  -0.094809281251442, -0.073756240895296, -0.015896992608195, -0.061244835721138, 0.000000000000000,
        0.000000000000000,  -0.013883503644430, -0.027158666662432, 0.000000000000000,  0.000000000000000,  0.030854553317311,  0.006639532038105,
        0.000000000000000,  0.000000000000000,  0.012689239849267,  -0.006732750145990, 0.000000000000000,  0.000000000000000,  -0.016451988824428,
        0.027793699180225,  0.000000000000000,  0.000000000000000,  -0.058980298730890, -0.027750283322318, 0.000000000000000,  0.000000000000000,
        0.000062005454769,  -0.022802653492279, 0.000000000000000,  0.000000000000000,  0.015599059190668,  0.007578631451823,  0.000000000000000,
        0.000000000000000,  0.002053071185229,  -0.005049912210102, 0.000000000000000,  0.000000000000000,  -0.003087244532004, 0.035177240969333,
        0.000000000000000,  0.000000000000000,  -0.042153245004500, -0.027177052103042, -0.041796382726669, -0.002357280829796, 0.061203083148550,
        0.035729055188275,  0.096646083749855,  0.027129840791570,  0.077639208408467,  0.034421685749602,  0.047474531054832,  0.040597602069339,
        0.070706675940882,  0.068902155481181,  -0.013478001774499, -0.010217796730871, 0.053588039516509,  0.033610702257501,  0.023388822950316,
        0.041589148818730,  0.014128807530544,  0.028990988337900,  -0.122802037677593, -0.051611973757300, 0.011360976103171,  -0.007647844712874,
        -0.046204593785946, -0.033352641667079, 0.010235005630158,  -0.046161553881474, 0.060164572291818,  0.046898491291966,  0.022827007653704,
        0.004190610062658,  -0.024777778908927, -0.032934875737105, 0.010489374826365,  -0.040554234372030, 0.110531463243715,  0.091119836738900,
        0.010172649488700,  0.032899506092587,  0.000000000000000,  0.000000000000000,  0.052168407959057,  0.029448871171872,  0.000000000000000,
        0.000000000000000,  0.080949644287577,  0.006499071068831,  0.000000000000000,  0.000000000000000,  -0.085173873008531, 0.006460393646516,
        0.000000000000000,  0.000000000000000,  0.002671450434917,  -0.014903656344118, 0.000000000000000,  0.000000000000000,  0.003804720785416,
        0.000017015394023,  0.000000000000000,  0.000000000000000,  0.023296577165719,  0.024677029593265,  0.000000000000000,  0.000000000000000,
        0.062119245161638,  0.007523062573968,  0.000000000000000,  0.000000000000000,  -0.042442005805350, 0.018078223984980,  0.000000000000000,
        0.000000000000000,  -0.006076026539992, -0.016035497237303, 0.000000000000000,  0.000000000000000,  0.016065797900644,  0.005039185884722,
        0.085346755037342,  0.008784665570900,  0.027580947306575,  0.029591154478035,  -0.019593389985326, -0.026931990237524, 0.165630752899815,
        0.139226923555691,  0.032412171912581,  0.041915170036619,  0.090624250404326,  0.084224763352317,  0.050252619045454,  0.029621766312500,
        0.066659532469688,  0.073626946053081,  0.018115871212023,  0.044438052256959,  -0.020854290231362, -0.013743147795892, 0.066598146818149,
        0.018297549379809,  0.009911702193991,  0.013362415020634,  -0.178209894102140, -0.103656612372220, 0.046111309099946,  0.049761716854405,
        -0.001077907705153, -0.003955716512077, 0.027783373215933,  -0.011337138661589, 0.013766977651832,  0.015551456298163,  0.024750892546118,
        0.030428192113591,  0.011433677149975,  0.019648557762484,  -0.004452307670357, -0.006703473390523, 0.000000000000000,  0.000000000000000,
        0.020129126204498,  0.010071894993856,  0.000000000000000,  0.000000000000000,  0.002140420474959,  -0.020395193276773, 0.000000000000000,
        0.000000000000000,  -0.001302575284557, 0.012779572001635,  0.000000000000000,  0.000000000000000,  -0.034633323902295, -0.001757124170684,
        0.000000000000000,  0.000000000000000,  -0.026235244887291, -0.024333308855959, 0.000000000000000,  0.000000000000000,  0.018967482755006,
        0.010337404565295,  0.000000000000000,  0.000000000000000,  0.002963425773181,  -0.025112038545243, 0.000000000000000,  0.000000000000000,
        0.019565873509579,  0.015117779269262,  0.000000000000000,  0.000000000000000,  -0.020589947633544, -0.002183379107541, 0.000000000000000,
        0.000000000000000,  -0.011985543018237, -0.021307658925337, 0.247206147897746,  0.147124872289709,  0.004031838406286,  0.021661894032660,
        -0.116377031547833, -0.065376178534351, 0.069617290694936,  0.121661216215714,  -0.152938237687560, -0.082851624544216, 0.180892643597043,
        0.199599010973924,  0.060043088368964,  0.027667470960453,  -0.009935795927648, 0.019150740417581,  -0.144339754099817, -0.066195971803588,
        -0.024030021929088, -0.038228731968983, 0.157542195423441,  0.105607371142730,  0.007766920648476,  0.032591082085207,  -0.136877963176390,
        -0.081941422029325, 0.042409317526097,  0.140982379306061,  -0.106712860849215, -0.058818744991101, 0.067952525120789,  0.160281119800498,
        -0.019783841745477, -0.023482381534204, 0.007151402297108,  0.036764845074798,  -0.179815748810287, -0.104382390491787, -0.013259313941312,
        -0.040264661785752, 0.000000000000000,  0.000000000000000,  -0.009580438510568, -0.013003683786423, 0.000000000000000,  0.000000000000000,
        0.014733966814967,  0.005864300914950,  0.000000000000000,  0.000000000000000,  -0.018538890964908, -0.001492322555322, 0.000000000000000,
        0.000000000000000,  0.031195552497534,  0.011924688272469,  0.000000000000000,  0.000000000000000,  -0.006650466218523, 0.000298460585050,
        0.000000000000000,  0.000000000000000,  -0.011596743739206, -0.015180055894711, 0.000000000000000,  0.000000000000000,  0.015477291318891,
        0.006857831223546,  0.000000000000000,  0.000000000000000,  -0.003516797540552, 0.001771634153614,  0.000000000000000,  0.000000000000000,
        0.030105217815824,  0.013343084268453,  0.000000000000000,  0.000000000000000,  -0.005906650547425, -0.000058844022446, -0.058602254979121,
        -0.044190933246180, 0.036541884621594,  0.042151889831156,  0.048627330626447,  0.006635718900626,  0.066659532469688,  0.073626946053081,
        -0.084470191070331, -0.036286738289792, 0.171714544990124,  0.188417936938696,  0.007797749940026,  0.009501852933760,  0.176782030886784,
        0.185998144135355,  -0.286375439097333, -0.163915885236742, 0.003264802314885,  0.009356221609539,  -0.087233859526994, -0.057100107053651,
        0.014280180515941,  0.027971343651759,  -0.154290276051058, -0.111407374954930, 0.024750892546118,  0.030428192113591,  -0.055088805822438,
        -0.026111303759207, 0.063765693386900,  0.113485252638829,  0.023962851760790,  0.027993873659935,  0.062889417765321,  0.119895856082844,
        -0.159196736284912, -0.111835472186382, 0.003301517727291,  0.010246134412133,  0.000000000000000,  0.000000000000000,  0.017243569743229,
        0.011859506275717,  0.000000000000000,  0.000000000000000,  -0.003290267321676, -0.028396099688654, 0.000000000000000,  0.000000000000000,
        0.006221463000749,  0.007775515189346,  0.000000000000000,  0.000000000000000,  -0.048274274737856, 0.009194233382659,  0.000000000000000,
        0.000000000000000,  -0.034999010659357, -0.030530483293505, 0.000000000000000,  0.000000000000000,  0.026763024764947,  0.014690271517930,
        0.000000000000000,  0.000000000000000,  -0.004971529678617, -0.035162653826508, 0.000000000000000,  0.000000000000000,  0.017005045640925,
        0.006986572898710,  0.000000000000000,  0.000000000000000,  -0.018661622200022, 0.011731323782346,  0.000000000000000,  0.000000000000000,
        -0.012102594210378, -0.025716505108797, -0.206525985444624, -0.112730684639950, 0.014128807530544,  0.028990988337900,  0.039648647978370,
        0.034016799687956,  0.056316162212602,  0.119854130646136,  -0.095896404837313, -0.062228310191351, 0.054658298747385,  0.083886386517476,
        -0.027683269902629, -0.014626293036211, 0.091917366360131,  0.109232646444820,  -0.126081410433175, -0.045156569276079, 0.040898970376356,
        0.015367451787585,  -0.221199985669730, -0.150688196484771, 0.010172649488700,  0.032899506092587,  0.044832276368658,  0.046920764373346,
        0.042193843884048,  0.162520757576669,  -0.140025032131878, -0.094760511489758, 0.029187398101281,  0.099688797719997,  -0.000334409742606,
        -0.000037064420121, 0.037397555491975,  0.095145256399057,  -0.149751530862630, -0.067964617989772, 0.004603491904861,  -0.010912511865660,
        0.000000000000000,  0.000000000000000,  -0.027611884944020, -0.039225489583598, 0.000000000000000,  0.000000000000000,  0.033937106383815,
        0.009088436487475,  0.000000000000000,  0.000000000000000,  -0.080381223185167, -0.013455725721547, 0.000000000000000,  0.000000000000000,
        0.045493703564947,  0.016405104089318,  0.000000000000000,  0.000000000000000,  0.041435507982725,  0.011635091802365,  0.000000000000000,
        0.000000000000000,  -0.038249337853875, -0.047856921161099, 0.000000000000000,  0.000000000000000,  0.033260754110835,  0.007489781745634,
        0.000000000000000,  0.000000000000000,  -0.041068463824682, -0.009985597787396, 0.000000000000000,  0.000000000000000,  0.032753951248265,
        0.012206493377831,  0.000000000000000,  0.000000000000000,  0.041690499877750,  0.015380103112149,  -0.036868667641242, -0.023869661182466,
        0.036598956843925,  0.063727680193398,  -0.047328930029485, -0.016721247838413, 0.024383496610160,  0.069208851812297,  -0.002981123317895,
        0.006303978653502,  -0.008409268114289, 0.002712333129894,  -0.063716494767059, -0.050790102116365, 0.050916770357431,  0.074710017094969,
        -0.074998196807654, -0.037137754143773, 0.016383071690004,  -0.002404292870179, 0.066112026613027,  0.058419692962325,  0.022290404017323,
        0.086620860228224,  -0.033210603568771, -0.020195442515406, 0.024632900998981,  0.105286195228816,  -0.073532588980461, -0.045023769300891,
        0.001306351420403,  0.020444057839203,  -0.024553867909641, -0.021218404997305, 0.025979860110099,  0.093283509089661,  -0.135461906995578,
        -0.083182900246152, -0.001247827004645, -0.017797934028128, 0.000000000000000,  0.000000000000000,  -0.032941642418223, -0.030461185913216,
        0.000000000000000,  0.000000000000000,  -0.025271530013024, -0.013261677613321, 0.000000000000000,  0.000000000000000,  -0.016754785725854,
        -0.003768508983683, 0.000000000000000,  0.000000000000000,  0.068787823935446,  0.030942807618110,  0.000000000000000,  0.000000000000000,
        -0.017417666693034, -0.038004323548220, 0.000000000000000,  0.000000000000000,  -0.036049370755622, -0.035002039986375, 0.000000000000000,
        0.000000000000000,  -0.014795038054974, -0.011987252959398, 0.000000000000000,  0.000000000000000,  -0.011057648017189, -0.003511717408905,
        0.000000000000000,  0.000000000000000,  0.048318825536129,  0.029292105982659,  0.000000000000000,  0.000000000000000,  -0.021202337605542,
        -0.041833877448133, 0.029366464729866,  0.017763605508011,  0.011182985923804,  0.018386594001256,  0.025203065156759,  0.027108638371078,
        -0.012126768523203, -0.011257360756754, -0.005404713216138, -0.002481839905074, -0.004144086542079, -0.005107706411459, -0.056996486626745,
        -0.048665148023163, 0.004353673288537,  0.009015439979366,  0.012550113150202,  0.018195385423622,  0.040357534026884,  0.042329208373203,
        0.078540619229779,  0.064129590208888,  0.006424427105464,  0.027255851986788,  0.011368238816287,  0.016458134179100,  -0.003755865963898,
        -0.005551610701371, -0.001314485191918, -0.000098104025923, -0.001724280919032, -0.002356434382625, -0.039746515421872, -0.041352917294286,
        0.003196226067515,  0.015576154443790,  0.044438664334823,  0.055572463628317,  0.014412335818750,  0.042590992662471};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 36, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.011994697864997, -0.002831631030021, 0.000000000000000,  0.000000000000000,  0.017509839435011,
        0.000829364599355,  0.000000000000000,  0.000000000000000,  -0.010512015838288, -0.000618166404004, 0.000000000000000,  0.000000000000000,
        -0.007890902792113, -0.000239681447488, 0.000000000000000,  0.000000000000000,  0.023533866180624,  0.006598188067556,  0.000000000000000,
        0.000000000000000,  -0.012827035700520, -0.004119456078642, 0.000000000000000,  0.000000000000000,  0.013500215950969,  0.000830778204108,
        0.000000000000000,  0.000000000000000,  -0.007623866254945, -0.000766849843022, 0.000000000000000,  0.000000000000000,  -0.005296547605723,
        -0.000232222358506, 0.000000000000000,  0.000000000000000,  0.027325042796872,  0.009657239401684,  -0.028585702949952, -0.023071477047751,
        -0.028374592453595, -0.026173514834417, 0.105981927436430,  0.068020045139742,  -0.031773947779158, -0.031894463327716, -0.072522911069222,
        -0.041177489000018, -0.002411136122860, -0.002655079382824, -0.052154791790633, -0.030316416736708, -0.005548401558903, -0.007127943280788,
        0.052256635554162,  0.045927033316007,  0.056757008412488,  0.049280305840459,  -0.016962286952553, -0.017573950121230, -0.008781164481172,
        -0.014678630772404, 0.074164338713575,  0.054007974167752,  -0.010689897553285, -0.013240688029918, -0.021193255636765, -0.015011208149372,
        -0.000858562848764, 0.001826008389819,  -0.022078296054757, -0.015614428540481, -0.002407088343062, -0.002818878717910, 0.039353348822856,
        0.041016261396239,  0.016498264229843,  0.028623569434321,  0.000000000000000,  0.000000000000000,  0.026783664253582,  0.025169378481909,
        0.000000000000000,  0.000000000000000,  0.040080426380946,  0.008330309955452,  0.000000000000000,  0.000000000000000,  0.012096863702184,
        0.002705343616742,  0.000000000000000,  0.000000000000000,  -0.074543778784424, -0.017842161395273, 0.000000000000000,  0.000000000000000,
        0.031829863010311,  0.036965427342859,  0.000000000000000,  0.000000000000000,  0.034207055492402,  0.030285591598605,  0.000000000000000,
        0.000000000000000,  0.022791295134890,  0.006412284056349,  0.000000000000000,  0.000000000000000,  0.007738386801869,  0.002577852394683,
        0.000000000000000,  0.000000000000000,  -0.044157304843231, -0.013880088249016, 0.000000000000000,  0.000000000000000,  0.046120461135441,
        0.044699333277088,  0.025244335771744,  0.024408007766067,  0.059502910471922,  0.048939679467629,  0.148267422253013,  0.077852935882281,
        -0.013711685403661, -0.007402749080861, 0.043291185261938,  0.021073130614317,  0.006636054255825,  0.005655127001396,  -0.266953466322197,
        -0.143762872287987, 0.079552312425941,  0.066642910517429,  0.024146123761066,  0.029086717478015,  0.078159846014789,  0.060803245146578,
        0.015662706619446,  0.013632475810466,  0.016259104027094,  0.018018599713761,  0.082951034100972,  0.049912083274951,  -0.002408323441791,
        -0.003201217322819, 0.006050918832400,  0.002651457664122,  0.001833128620934,  -0.001600447281839, -0.176187191922409, -0.106771778859599,
        0.022118574988351,  0.022617917177725,  0.022931546462610,  0.020040185266230,  0.020146453646391,  0.021926751533124,  0.000000000000000,
        0.000000000000000,  -0.000401060083056, 0.038307400957664,  0.000000000000000,  0.000000000000000,  0.014091631794267,  -0.002368554451060,
        0.000000000000000,  0.000000000000000,  0.083240392507376,  0.020372149000606,  0.000000000000000,  0.000000000000000,  -0.039812532263860,
        -0.006029193129230, 0.000000000000000,  0.000000000000000,  -0.029361749240852, -0.003676968352852, 0.000000000000000,  0.000000000000000,
        0.013020403825331,  0.046431283578579,  0.000000000000000,  0.000000000000000,  0.006325333835657,  0.002733590812990,  0.000000000000000,
        0.000000000000000,  0.049200952210183,  0.020410652455123,  0.000000000000000,  0.000000000000000,  -0.011427568589008, 0.004854295438140,
        0.000000000000000,  0.000000000000000,  -0.018230413576771, -0.003347711423099, -0.013478001774499, -0.010217796730871, 0.089470160789660,
        0.072694399448475,  0.084134616434897,  0.042313145353785,  0.199864132297329,  0.168215838049949,  0.156281049076133,  0.048412896914781,
        0.120586003695772,  0.083796408317218,  -0.066330902145362, -0.019530375511864, 0.180259284830670,  0.142252007953293,  -0.027683269902629,
        -0.014626293036211, -0.019645422662239, -0.020669670563328, -0.024777778908927, -0.032934875737105, 0.023773848913278,  -0.010896910669794,
        -0.042967837550999, -0.020963988253917, 0.055254622233605,  0.006861567738549,  -0.070305713465462, -0.057532564560393, 0.026838616729248,
        -0.027115016459066, -0.141009506781485, -0.075313165142238, 0.046573276596554,  0.001095252195953,  -0.000334409742606, -0.000037064420121,
        -0.006890574635213, -0.004589445416171, 0.000000000000000,  0.000000000000000,  0.030930585182243,  -0.017364005530259, 0.000000000000000,
        0.000000000000000,  0.055883968671235,  0.039494174346432,  0.000000000000000,  0.000000000000000,  -0.018151160633037, 0.006286348427873,
        0.000000000000000,  0.000000000000000,  0.038412425857755,  -0.008465125858531, 0.000000000000000,  0.000000000000000,  0.106334415446137,
        0.053830803454296,  0.000000000000000,  0.000000000000000,  0.006883996146576,  -0.019749610190573, 0.000000000000000,  0.000000000000000,
        0.042456205573131,  0.050140755375687,  0.000000000000000,  0.000000000000000,  -0.000441424182427, 0.017877105741353,  0.000000000000000,
        0.000000000000000,  -0.001796949348471, -0.013129344325585, 0.000000000000000,  0.000000000000000,  0.090093351431884,  0.055833041350473,
        0.050252619045454,  0.029621766312500,  0.002111145572903,  -0.003642418615236, 0.184222079761811,  0.099204161873319,  0.075458239721735,
        0.009643978240485,  -0.093085797844948, -0.058358999424029, 0.145156539233387,  0.057775633619905,  0.144186279081242,  0.058579769811633,
        0.042554701287081,  0.019040722268577,  0.012476603648421,  0.000977386026737,  0.007780608241462,  0.011021785467611,  0.013766977651832,
        0.015551456298163,  -0.001624547931319, -0.029170376611448, 0.026720833837846,  0.004634360905861,  0.000893804938698,  -0.136417486519130,
        -0.204373531720469, -0.125766039920964, 0.016838071571821,  -0.100355769394647, 0.117397667342901,  0.072998838913620,  0.005404251565740,
        -0.047434716249222, -0.024956567345703, -0.029393880423742, 0.003949635021511,  0.023637696100177,  0.000000000000000,  0.000000000000000,
        0.178624121972769,  0.053200507546582,  0.000000000000000,  0.000000000000000,  -0.006089688736305, -0.029838538990373, 0.000000000000000,
        0.000000000000000,  -0.090106477456476, 0.020177112780982,  0.000000000000000,  0.000000000000000,  -0.004059792490870, -0.019892359326915,
        0.000000000000000,  0.000000000000000,  -0.074426717488654, -0.022166878144409, 0.000000000000000,  0.000000000000000,  0.131202648561780,
        0.052278451898063,  0.000000000000000,  0.000000000000000,  -0.040576417737122, -0.041131331805478, 0.000000000000000,  0.000000000000000,
        -0.023033946120037, 0.038657952522264,  0.000000000000000,  0.000000000000000,  -0.027050945158081, -0.027420887870319, 0.000000000000000,
        0.000000000000000,  -0.054667770234075, -0.021782688290859, 0.060043088368964,  0.027667470960453,  -0.049247414507529, -0.051796536206951,
        0.076044894969382,  0.024540567321814,  -0.142403358525220, -0.143619744911637, -0.134780635701855, -0.032341187344344, -0.049903408928615,
        -0.100502816745995, 0.050696596646255,  0.016360378214542,  -0.094935572350146, -0.095746496607758, -0.025017953487068, -0.011528112900189,
        0.020519756044804,  0.021581890086230,  -0.019783841745477, -0.023482381534204, -0.017414882282057, -0.020971532939920, 0.187837295652909,
        0.119355879965159,  -0.048342609612964, -0.071003579119037, -0.123419396429426, -0.077404340289002, -0.035153667207245, -0.131639504925904,
        0.125224863768606,  0.079570586643440,  -0.032228406408643, -0.047335719412691, 0.008243267393949,  0.009784325639251,  0.007256200950857,
        0.008738138724967,  0.000000000000000,  0.000000000000000,  -0.071088963164714, -0.047418927648394, 0.000000000000000,  0.000000000000000,
        0.038412425857755,  -0.008465125858531, 0.000000000000000,  0.000000000000000,  -0.012100773755358, 0.004190898951915,  0.000000000000000,
        0.000000000000000,  0.023873613789772,  0.046548445895208,  0.000000000000000,  0.000000000000000,  -0.149212837589477, -0.050135815204868,
        0.000000000000000,  0.000000000000000,  -0.066919656281481, -0.049784896874023, 0.000000000000000,  0.000000000000000,  -0.001796949348471,
        -0.013129344325585, 0.000000000000000,  0.000000000000000,  -0.000294282788284, 0.011918070494235,  0.000000000000000,  0.000000000000000,
        0.043953663363524,  0.061081875647008,  0.000000000000000,  0.000000000000000,  -0.111559334622153, -0.050662348625758, 0.007797749940026,
        0.009501852933760,  -0.005254302102812, -0.009739133726513, 0.144186279081242,  0.058579769811633,  0.042554701287081,  0.019040722268577,
        -0.062057198563299, -0.038905999616019, 0.096771026155592,  0.038517089079937,  0.064066847194110,  0.050387687030291,  0.039995988649167,
        -0.006223290316663, -0.053371854851051, -0.023938788374485, -0.010801085802420, -0.010198194180847, 0.023962851760790,  0.027993873659935,
        -0.003600524300465, -0.028280281211792, 0.117397667342901,  0.072998838913620,  0.005404251565740,  -0.047434716249222, -0.136249021146979,
        -0.083844026613976, 0.011225381047881,  -0.066903846263098, -0.071110555614571, -0.056198004855489, -0.003609738032752, -0.096888556311445,
        0.018845968419163,  0.022707046424288,  -0.003408891616664, -0.005441608263198, 0.000000000000000,  0.000000000000000,  -0.029361749240852,
        -0.003676968352852, 0.000000000000000,  0.000000000000000,  0.058097526250438,  0.006772101565022,  0.000000000000000,  0.000000000000000,
        -0.034683496878073, -0.008488395416919, 0.000000000000000,  0.000000000000000,  -0.079365004137132, -0.006165642011775, 0.000000000000000,
        0.000000000000000,  -0.058635196077413, 0.031014747057841,  0.000000000000000,  0.000000000000000,  -0.018230413576771, -0.003347711423099,
        0.000000000000000,  0.000000000000000,  0.017702239391756,  -0.005080468203737, 0.000000000000000,  0.000000000000000,  -0.020500396754243,
        -0.008504438522968, 0.000000000000000,  0.000000000000000,  -0.025745205822834, 0.003889584948262,  0.000000000000000,  0.000000000000000,
        -0.023136583101930, 0.039791655922766,  -0.027683269902629, -0.014626293036211, -0.019645422662239, -0.020669670563328, 0.124090750184675,
        0.044430403574626,  -0.144398210746072, -0.109230483216805, -0.065117103781722, -0.020172040381159, -0.050244168206572, -0.034915170132174,
        -0.211082384654922, -0.084953664744779, 0.016574198087166,  -0.000560843936550, -0.068383153748047, -0.039226611252689, 0.050506739176219,
        0.031699552831208,  -0.000334409742606, -0.000037064420121, -0.006890574635213, -0.004589445416171, 0.163976831917982,  0.088473319970647,
        -0.035680679570398, 0.001663877627608,  0.029294047277276,  0.023971901900164,  -0.011182756970520, 0.011297923524611,  -0.160356388248646,
        -0.088227001821340, -0.000418651455637, -0.007240651359653, -0.025441024898428, -0.033008386837012, 0.010107542553440,  -0.019999310745200,
        0.000000000000000,  0.000000000000000,  -0.055899153454405, -0.039239911917076, 0.000000000000000,  0.000000000000000,  0.043168062074503,
        0.014725375166561,  0.000000000000000,  0.000000000000000,  -0.061828414477828, -0.013827311818901, 0.000000000000000,  0.000000000000000,
        0.008966173976941,  0.005239496945312,  0.000000000000000,  0.000000000000000,  0.031702346722895,  0.025634181024714,  0.000000000000000,
        0.000000000000000,  -0.061089074157605, -0.046801967625539, 0.000000000000000,  0.000000000000000,  0.028879328784526,  0.011692561457391,
        0.000000000000000,  0.000000000000000,  -0.039551754765107, -0.013175690017271, 0.000000000000000,  0.000000000000000,  0.007640635543341,
        0.004242986654654,  0.000000000000000,  0.000000000000000,  0.037265968036295,  0.030715275669813,  -0.063716494767059, -0.050790102116365,
        -0.110157083970234, -0.097160470319306, 0.138129774894610,  0.081322040651049,  -0.147152700045005, -0.137478146348387, -0.221266058005460,
        -0.107707112028733, -0.033917610640884, -0.028903982451580, 0.020517261587323,  0.015932444508984,  -0.080748736459233, -0.077647691279895,
        0.033330743247006,  0.028843205296852,  0.066041709518094,  0.056369464176294,  -0.024553867909641, -0.021218404997305, -0.032381211276187,
        -0.036638758192052, 0.143005612328319,  0.087906241178030,  -0.045797703579729, -0.044262838341434, -0.030926918476714, -0.013551894727734,
        -0.009369324062550, 0.008180063884956,  0.050045967670165,  0.031203758407395,  -0.025890125961575, -0.024665764143497, 0.015994236295388,
        0.013873251031891,  0.018759339254624,  0.021025073436356,  0.000000000000000,  0.000000000000000,  -0.025056913239365, -0.006655512109195,
        0.000000000000000,  0.000000000000000,  -0.000695904294210, 0.000090804982601,  0.000000000000000,  0.000000000000000,  -0.010424415706303,
        -0.000613015017304, 0.000000000000000,  0.000000000000000,  0.019264597332049,  0.000859788265546,  0.000000000000000,  0.000000000000000,
        -0.008251460226665, -0.002690744043626, 0.000000000000000,  0.000000000000000,  -0.028328106490242, -0.009723762123982, 0.000000000000000,
        0.000000000000000,  0.000190306006017,  0.000098222420227,  0.000000000000000,  0.000000000000000,  -0.007560334036154, -0.000760459427664,
        0.000000000000000,  0.000000000000000,  0.014543702509033,  0.000858161776085,  0.000000000000000,  0.000000000000000,  -0.010361776502444,
        -0.003955961223719, -0.056996486626745, -0.048665148023163, -0.060045239210192, -0.053204645981584, -0.008267756951553, -0.002392108045340,
        -0.017077062378632, -0.018580497183975, -0.071918553476979, -0.040834343258352, -0.002391043321836, -0.002632953721300, 0.118329583963309,
        0.074704199282808,  -0.027150318632794, -0.026640812177463, -0.016936431292093, -0.016341931843570, -0.020293010722522, -0.016528548424767,
        -0.039746515421872, -0.041352917294286, -0.017825073499687, -0.030538506261808, 0.007524432304918,  0.005907244270498,  -0.006244191743141,
        -0.007584080955479, -0.021016645173126, -0.014886114748127, -0.000851408158358, 0.001810791653237,  0.077138495124765,  0.055991686866140,
        -0.008921964269337, -0.011114790073212, -0.015995989816084, -0.016746540999823, -0.005520226239465, -0.009972234100983};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 36, 20));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeGFForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix efxmat(36, 28);

    CDenseMatrix efymat(36, 28);

    CDenseMatrix efzmat(36, 28);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.495517528199490,  0.363571407598650,  -0.020000534163060, 0.014257072296303,  0.000000000000000,  0.000000000000000,  0.002821746251213,
        -0.034326846043453, -0.000000000000000, -0.000000000000001, -0.057095775138048, -0.022053154656447, 0.000000000000000,  0.000000000000000,
        0.000420387283869,  -0.004088858140228, 0.000000000000000,  0.000000000000000,  0.074375336601968,  0.041862788066891,  0.000000000000000,
        0.000000000000000,  -0.044803233590867, -0.060823255885309, 0.000000000000000,  0.000000000000000,  0.021575370186247,  0.012351358423379,
        0.275539272477144,  0.275109587406145,  -0.011663341407438, 0.020651422211248,  0.000000000000000,  0.000000000000000,  0.001823549325589,
        -0.031898970795668, -0.000000000000000, -0.000000000000001, -0.033177962169074, -0.019142734477593, 0.000000000000000,  0.000000000000000,
        0.002571707112004,  -0.002931755552263, 0.000000000000000,  0.000000000000000,  0.038848178223299,  0.035086172580360,  0.000000000000000,
        0.000000000000000,  -0.043414587111777, -0.060742299180192, 0.000000000000000,  0.000000000000000,  0.026335360454958,  0.018177003346631,
        -0.038771655867001, -0.026893499762042, 0.116957107204764,  0.079306513069755,  0.004228408429836,  -0.014902578215020, 0.038609687852406,
        0.027025385401839,  -0.019484930072459, -0.016430332691232, 0.013663426371615,  0.010991619743029,  -0.015939669922916, -0.013018440368777,
        -0.003073146941675, -0.001124375065800, 0.038238488181321,  0.040553004583137,  0.007282022371444,  0.007177792280353,  -0.019526337413873,
        -0.022015158967714, 0.020591578895679,  0.018308682588912,  0.033744238224943,  0.018164307836052,  -0.030175401930147, -0.012532965274433,
        -0.030128716619864, -0.016656631259332, 0.046276744694083,  0.107195871361058,  -0.000641488554707, -0.015165938866033, 0.015733852463180,
        0.026949563174315,  -0.000554214845418, -0.003924765373842, 0.006393460430865,  0.006968976455964,  0.001487389160714,  -0.000723991083540,
        -0.000641295129297, -0.001231676591712, -0.005686657804720, 0.006225382181176,  0.004197325624888,  0.005563330515229,  -0.035380979249095,
        -0.041099105597345, 0.010768469437867,  0.029545228042712,  0.070309439568094,  0.051253123095961,  -0.007162135396939, -0.004249045776179,
        0.000000000000000,  0.000000000000000,  -0.012068656939891, -0.022233535485628, 0.429130767441230,  0.314862075070098,  0.011587233053103,
        -0.016036873232623, 0.000000000000000,  0.000000000000000,  -0.037088849256635, -0.010440105862817, 0.000000000000000,  0.000000000000000,
        -0.042870176034394, -0.000252120436950, 0.000000000000000,  0.000000000000000,  0.049717126145239,  -0.010309627987827, 0.000000000000000,
        0.000000000000000,  -0.028699970860765, -0.003194041801151, 0.000000000000000,  0.000000000000000,  0.055029482465831,  0.065744868663988,
        0.000000000000000,  0.000000000000000,  -0.001987475522041, -0.015087241295247, 0.238624009705489,  0.238251891518375,  0.000441292966863,
        -0.012820803603329, 0.000000000000000,  0.000000000000000,  -0.019719691116400, -0.012533801141531, 0.000000000000000,  0.000000000000000,
        -0.009962507224475, 0.003778026761212,  0.000000000000000,  0.000000000000000,  0.022987307747210,  -0.015278105539476, 0.000000000000000,
        0.000000000000000,  -0.031420310809530, -0.003855980666803, 0.000000000000000,  0.000000000000000,  0.054085800109942,  0.070490475106004,
        0.021925969456185,  0.007249632901165,  -0.023245808362752, 0.000921800322196,  0.068384903814781,  0.028597177585710,  0.181758739685585,
        0.150564506395381,  -0.003908769726898, -0.002768686674967, 0.103874937684010,  0.098422347680854,  0.016912121353892,  -0.000982267249211,
        -0.035073733879244, -0.024725492116276, -0.005792354577275, -0.006206736486453, 0.059011220992505,  0.064954585176275,  -0.073684169457495,
        -0.024451074013130, -0.073718519124520, -0.042904624006887, 0.066667095599769,  0.065332181957614,  -0.011544965828903, -0.012568774043957,
        0.063676119082738,  0.038720818647564,  0.000829223214172,  0.018625131793499,  0.008756678211379,  0.001412052193159,  0.088205826899949,
        0.189079238518400,  -0.026897000711773, -0.024823832177832, 0.057711240692583,  0.100154091657133,  0.024622645049630,  0.016335954799271,
        -0.014424924670316, -0.030942504778052, -0.034326330967437, -0.033299400661983, 0.038236217640905,  0.076731829172877,  -0.027565327105839,
        -0.014254575672138, -0.024818202721964, -0.026896353959178, 0.162450884712940,  0.145588008468614,  -0.007388116273025, -0.012700028795143,
        -0.093644010706377, -0.068708537737124, -0.038222294517738, -0.015046008564142, 0.000000000000000,  0.000000000000000,  -0.001559127652046,
        0.006316164661257,  0.362681693937869,  0.266107022398143,  -0.051045368537294, -0.044881552233915, 0.000000000000000,  0.000000000000000,
        0.023518456231548,  0.000694019070747,  0.000000000000000,  0.000000000000000,  -0.014180651117262, -0.007679947224760, 0.000000000000000,
        0.000000000000000,  -0.032001610505917, 0.021532078121908,  0.000000000000000,  0.000000000000000,  -0.026525794164938, -0.022280185446223,
        -0.052072027957585, -0.051990825111875, -0.020926999917081, -0.011474745292610, 0.000000000000000,  0.000000000000000,  0.005231901245039,
        0.009135212801257,  0.201674097082973,  0.201359599813872,  -0.035925897039539, -0.042640213198283, 0.000000000000000,  0.000000000000000,
        0.013138783926980,  -0.004291360324461, 0.000000000000000,  0.000000000000000,  -0.005843600972487, -0.006855531666898, 0.000000000000000,
        0.000000000000000,  -0.010329779370049, 0.027981961605053,  0.000000000000000,  0.000000000000000,  -0.012788086641749, -0.018191167648886,
        -0.031421923493153, -0.013217980452234, 0.023338879523334,  0.031707088763138,  0.008623817752409,  0.002327960080713,  -0.030522324236442,
        0.040000484976378,  -0.016982013889627, -0.022315659536671, 0.098974821039385,  0.101785870582803,  0.060377239548936,  0.030469005790301,
        -0.041641819603063, -0.034420861399280, 0.058962303036205,  0.026042629183323,  -0.009926969787026, 0.044618274377805,  -0.070176876900823,
        -0.029791544740356, 0.046618519087858,  0.040245064025287,  -0.093345849385383, -0.065237929108468, 0.010017449809867,  -0.003310977934220,
        0.050510109316397,  0.041842379496094,  0.018709351969044,  0.035566556888266,  0.020243610978489,  0.015163228371743,  0.024446801557656,
        0.090870526922684,  -0.036454337345816, -0.039298965387063, 0.060216367115805,  0.179889922566002,  -0.032180257190423, -0.032080643352194,
        -0.020053962879059, -0.026501463531132, 0.027232035521969,  0.019689115330702,  0.026993305864006,  0.089236133159752,  0.052992414184381,
        0.056093423144569,  0.023471431718333,  0.029539706971889,  -0.037312595635954, -0.037843625117684, -0.002149865532647, -0.013832385519667,
        0.000000000000000,  0.000000000000000,  0.002901531623274,  0.008241072448228,  -0.162196184367970, -0.119006678274461, 0.013265066149216,
        0.013525447712679,  0.000000000000000,  0.000000000000000,  -0.016829142734363, 0.003265085336714,  0.000000000000000,  0.000000000000000,
        0.025171571577394,  0.001753041175017,  0.000000000000000,  0.000000000000000,  -0.035108019745605, 0.005711592429420,  0.000000000000000,
        0.000000000000000,  0.000911668339408,  -0.000748970247318, 0.000000000000000,  0.000000000000000,  0.004722270023111,  -0.012408208393333,
        0.000000000000000,  0.000000000000000,  -0.001765904155944, 0.005789713161800,  -0.090191398075684, -0.090050750621194, 0.017498603299787,
        0.016173231139270,  0.000000000000000,  0.000000000000000,  -0.013893293692461, 0.005190301670372,  0.000000000000000,  0.000000000000000,
        0.009800704813572,  0.001176972335182,  0.000000000000000,  0.000000000000000,  -0.021051735131030, 0.010105513623383,  0.000000000000000,
        0.000000000000000,  0.000561974447271,  -0.000650470411859, 0.000000000000000,  0.000000000000000,  0.009079293746964,  -0.008434433693164,
        0.085283282608543,  0.043219126504357,  0.001455216155906,  0.008129919102265,  0.089623525875737,  0.047621431808505,  -0.055884196962891,
        -0.026480371611684, 0.026799252389312,  0.020473917899002,  -0.325496224962933, -0.225536147685195, -0.017866355147639, 0.004330144855606,
        -0.168138915752248, -0.120051619996792, -0.085705178541317, -0.039698657342100, -0.005447481478041, 0.012419447819679,  0.036755647976351,
        0.006419060716539,  0.086380681119852,  0.078945393933925,  0.087673556398341,  0.048707404983375,  0.022224381359584,  0.016072864437851,
        -0.009242649744478, -0.005086667595776, 0.004828448104561,  0.005370995145140,  0.089678279728668,  0.075083504484309,  -0.015092704837574,
        -0.009426232595302, 0.008648421648054,  0.006845664360199,  -0.130977548296811, -0.162131828545232, 0.022220521882251,  0.017852785249041,
        -0.069797543180771, -0.087881678413282, 0.026770065736590,  0.034624693792291,  0.007699909767714,  0.047832166027461,  -0.030300555551068,
        -0.027494078670054, 0.046140446253987,  0.063756260570429,  0.095853603353766,  0.068825252133162,  0.009336261995804,  0.013962010918029,
        0.000000000000000,  0.000000000000000,  0.001747923308253,  -0.018969236328074, 0.000000000000000,  0.000000000000000,  -0.037044505346093,
        -0.000772886610090, 0.000000000000000,  0.000000000000000,  0.012734409257961,  -0.003336175456351, 0.000000000000000,  0.000000000000000,
        -0.016464393094112, 0.002198755845580,  -0.324392368735939, -0.238013356548923, 0.027249178717159,  0.051284656599452,  0.000000000000000,
        0.000000000000000,  -0.044549459938266, -0.004998551222593, 0.000000000000000,  0.000000000000000,  0.008067685092781,  0.005719223993145,
        0.000000000000000,  0.000000000000000,  0.016996228475496,  -0.012040725905877, 0.000000000000000,  0.000000000000000,  -0.024485772180668,
        -0.002019799086960, 0.000000000000000,  0.000000000000000,  -0.001130289386685, -0.004018920674357, 0.000000000000000,  0.000000000000000,
        -0.010897933102582, 0.007057941327906,  -0.180382796151369, -0.180101501242389, 0.032968223705166,  0.052502167044181,  0.000000000000000,
        0.000000000000000,  -0.025687452998130, -0.005769708022775, -0.000000000000000, -0.000000000000000, 0.002902132058496,  0.004167415411582,
        0.112528601457117,  0.042371541014168,  -0.027362183631560, -0.026032407033095, -0.001281452796233, -0.013903018713107, -0.066678265794082,
        -0.072038128603519, -0.052063971557068, -0.030057206022979, -0.013860764148549, -0.034518318109483, -0.001818463911552, 0.008375007378567,
        -0.176383345047320, -0.105633139454202, -0.041878059913197, 0.011508151989376,  -0.123633857240891, -0.102390204172770, -0.062718632115243,
        -0.038389668994684, -0.068704033156299, -0.049067456718522, -0.107355024718797, -0.055611576338454, 0.003876479988218,  0.008529174785519,
        0.093663217522025,  0.059310261641682,  -0.015270965529882, -0.028249005901169, -0.081773748092009, -0.066145933382563, -0.042434392367344,
        -0.093734047338315, -0.028284089228279, -0.018248692991707, -0.020520329716035, -0.046698910776527, 0.042904136178799,  0.034375894912285,
        -0.061209533042756, -0.080871598233361, 0.120785867950593,  0.112722640390171,  -0.059985287764133, -0.126806442911403, -0.051170082723497,
        -0.039041754568989, -0.028582889361367, -0.049209108084842, -0.046926977259923, -0.032796651426632, 0.005080403811980,  0.013155951089971,
        0.000000000000000,  0.000000000000000,  0.006019230895090,  0.009149740378762,  0.000000000000000,  0.000000000000000,  -0.065014774295269,
        -0.007819307509892, 0.000000000000000,  0.000000000000000,  0.044717290954987,  0.002267627685740,  0.418788747250357,  0.307273922029634,
        0.016372166613829,  -0.058710903240483, 0.000000000000000,  0.000000000000000,  -0.027521091711146, 0.009995437082358,  -0.162196184367970,
        -0.119006678274461, 0.042542559453491,  0.014985963914903,  0.000000000000000,  0.000000000000000,  0.016160611392730,  0.024545448840593,
        0.000000000000000,  0.000000000000000,  0.001634903508596,  0.006752359857383,  0.000000000000000,  0.000000000000000,  -0.033173351012860,
        -0.006187167108025, 0.000000000000000,  0.000000000000000,  0.025776700174854,  -0.001294523166503, 0.232873188478858,  0.232510038312909,
        -0.020538619458980, -0.060742028156067, 0.000000000000000,  0.000000000000000,  -0.011110427623298, 0.015085734579188,  -0.090191398075684,
        -0.090050750621195, 0.032669571561928,  0.017190088445818,  0.000000000000000,  0.000000000000000,  -0.008227626141908, 0.016265779094530,
        -0.098530061444032, -0.060830004093136, -0.006583216074172, -0.000309213675287, -0.033823877000547, -0.029474724631435, -0.017002568626539,
        0.004441002687956,  0.051403996726748,  0.034381608582693,  -0.005447481478041, 0.012419447819679,  -0.012597599550901, -0.025975518496919,
        0.103291311874612,  0.076976241560095,  0.023354002627085,  0.023291820398660,  -0.073707387020870, -0.006880648798803, 0.030929743285897,
        0.029784088849569,  -0.000744330351356, 0.010267846490257,  -0.060995705472796, -0.010517331405151, -0.002231138707965, -0.002486029556897,
        -0.085632481031848, -0.063782731864899, -0.000121322217528, -0.002992616834914, -0.020705442167648, -0.012524992387179, 0.002943014532163,
        0.017904420594588,  0.023873779369639,  0.016385682374341,  0.007699909767714,  0.047832166027461,  -0.109343035918742, -0.101944447452485,
        0.045141143959689,  0.126481266628943,  0.061306306341305,  0.051455703916961,  -0.003172032181236, 0.035637004372556,  0.111075237212041,
        0.092632039711840,  0.006084894521037,  0.002889459823276,  -0.078363343277769, -0.047276036826448, -0.001490459849091, -0.005601774861865,
        0.000000000000000,  0.000000000000000,  0.040349594691658,  0.027532154969259,  0.000000000000000,  0.000000000000000,  0.033510200006090,
        -0.023287815604907, 0.000000000000000,  0.000000000000000,  0.002090593690711,  0.009374813550565,  0.000000000000000,  0.000000000000000,
        0.022132134152567,  -0.006486387583173, 0.362681693937869,  0.266107022398143,  -0.032239867223512, -0.046961507120800, 0.000000000000000,
        0.000000000000000,  0.047369415656209,  0.012084288833499,  -0.093644010706377, -0.068708537737123, -0.035045386693046, -0.010039964563147,
        0.000000000000000,  0.000000000000000,  0.015072803939129,  0.021660236060421,  0.000000000000000,  0.000000000000000,  0.012077624602472,
        -0.029358704013483, 0.000000000000000,  0.000000000000000,  0.012412167156632,  0.008150934921488,  0.000000000000000,  0.000000000000000,
        0.009745623252070,  -0.009529264045238, 0.201674097082973,  0.201359599813872,  -0.030844982903852, -0.043699672106136, 0.000000000000000,
        0.000000000000000,  0.022504161222462,  0.013429993755908,  -0.052072027957584, -0.051990825111874, -0.024827570816645, -0.008339974709400,
        0.035529788135172,  0.044676537411749,  -0.023578902637638, -0.016511669546028, 0.051341640521161,  0.017451740992966,  0.046618519087858,
        0.040245064025287,  -0.004564052391538, -0.002755422434943, 0.240618044239689,  0.187317368596301,  0.057177899992422,  0.021164284607243,
        0.033018884645194,  0.034791296226036,  -0.052503365894405, -0.039779768873586, 0.162389772952766,  0.127648838743170,  -0.049068830167435,
        -0.007204026239904, -0.140498183779856, -0.087833239638372, -0.067280505220823, -0.022141250387076, -0.012851810031891, -0.005968825905147,
        0.019126486802906,  0.027250781766110,  -0.009591456204165, -0.011258433076061, -0.055331822541242, -0.058367137387878, 0.023471431718333,
        0.029539706971889,  0.001875232787547,  0.000832946166802,  0.109196129703018,  0.155274472249375,  -0.026110375219128, -0.026463779522629,
        0.020391935699621,  0.028680052661837,  -0.043300460123191, -0.045503692641197, 0.074614898112427,  0.150317725571316,  0.029523394560696,
        0.024945708824169,  -0.050881038280949, -0.053743774061822, 0.033720637619344,  0.032507395254678,  -0.003395968129825, 0.000891539716368,
        0.000000000000000,  0.000000000000000,  -0.047566172565820, -0.063377058156753, 0.000000000000000,  0.000000000000000,  0.057922181063101,
        0.005819601941540,  0.000000000000000,  0.000000000000000,  -0.043015173519122, 0.010264232041557,  -0.000000000000000, 0.000000000000000,
        0.046689542277122,  0.000658435773402,  0.000000000000000,  0.000000000000000,  0.024765037735896,  -0.007496538644754, 0.429130767441230,
        0.314862075070098,  0.029686551907077,  -0.013574726445516, 0.000000000000000,  0.000000000000000,  -0.016520780171149, -0.022799989126947,
        0.000000000000000,  0.000000000000000,  -0.053320589608116, -0.069040634593835, 0.000000000000000,  0.000000000000000,  0.041069553902700,
        0.005291708975430,  0.000000000000000,  0.000000000000000,  -0.016060115378025, 0.015894370958031,  0.000000000000000,  -0.000000000000001,
        0.020521196260844,  -0.001216725366004, 0.000000000000000,  0.000000000000000,  -0.003240570282081, -0.012845703371134, 0.238624009705490,
        0.238251891518377,  0.004658574134639,  -0.011512804655803, 0.000000000000000,  0.000000000000000,  -0.003723989604880, -0.015469951201636,
        -0.085725322621612, -0.070136543745727, -0.011544965828903, -0.012568774043957, 0.047244428200846,  0.018555095867934,  0.042799054408205,
        0.001859964914866,  -0.006591505477871, -0.002407172621357, 0.008607786920398,  -0.005918201449069, -0.015237338673435, -0.007165335094684,
        0.021066006078372,  0.021655023077028,  -0.034161820624103, -0.008016451017863, 0.028438431001407,  0.008882943154826,  0.061020839382406,
        0.031709418241807,  0.110210771950670,  0.078576138172502,  0.030789880490886,  0.010757970182593,  -0.025976701774506, 0.000308449487716,
        -0.169617123577750, -0.149515856880569, -0.007388116273025, -0.012700028795143, 0.023009990985470,  0.012225797538697,  0.000546244697017,
        -0.024759917716730, 0.041293768889715,  0.037723692279908,  -0.003799190910244, -0.033575344977941, -0.007784214353718, -0.005444459926912,
        0.012707602133806,  0.023666419624668,  -0.055385805117757, -0.043771876526157, 0.004930338401422,  -0.000835519875268, 0.004611198036242,
        -0.000328516080759, 0.045986250357196,  0.121276590645881,  0.065346204108312,  0.039707729555696,  0.000512669427732,  0.020802936862990,
        0.000000000000000,  0.000000000000000,  -0.020938808397182, -0.012063115407276, 0.000000000000000,  0.000000000000000,  0.059892835576021,
        0.064008888692380,  0.000000000000000,  0.000000000000000,  -0.037195546177788, -0.033180118185167, 0.000000000000000,  0.000000000000000,
        0.068430900821501,  0.025445257226568,  -0.000000000000000, 0.000000000000000,  -0.030957657544587, -0.013930556851910, 0.000000000000000,
        0.000000000000000,  -0.002796710750218, -0.035049362299109, 0.495517528199489,  0.363571407598650,  -0.023328614681515, 0.013498892221838,
        0.000000000000000,  0.000000000000000,  -0.026336037223255, -0.017994859079825, 0.000000000000000,  0.000000000000000,  0.048640272943754,
        0.062941610850408,  0.000000000000000,  0.000000000000000,  -0.023034195404697, -0.028619796656098, 0.000000000000000,  0.000000000000000,
        0.033019008211550,  0.020243025707378,  0.000000000000001,  0.000000000000000,  -0.023872767128552, -0.013276872750391, 0.000000000000000,
        0.000000000000000,  -0.000612787139917, -0.032423259860599, 0.275539272477144,  0.275109587406144,  -0.012613761657876, 0.020151685544466,
        -0.033918945572197, -0.017765043707566, 0.026287979969026,  0.008771432352323,  0.018884831992785,  0.025530019163269,  -0.040588046282986,
        -0.040078437821898, -0.037230321086746, -0.034011245045462, -0.014264573822190, -0.018312096774155, 0.027880112416108,  0.028114439390574,
        0.013606386604537,  0.011535249834706,  -0.005058802922596, -0.002307733425699, -0.007422383083514, -0.011517616030249, 0.008663013047911,
        -0.013432808812416, 0.036244664782799,  0.026494207997747,  -0.035348134431101, -0.026352462519177, 0.122022818074663,  0.085086584815045,
        -0.070851095228930, -0.051510995736330, 0.004959821283066,  0.001006181309490,  0.032336209346427,  0.039910988079775,  -0.023565062194973,
        -0.051542323173488, -0.001100702758751, -0.009043854251906, -0.010801225392248, -0.019723075304881, -0.006607251205175, 0.001282960560409,
        0.006754505105219,  0.013750419425965,  -0.006961924278589, -0.006190804618496, -0.006817167927937, -0.013401209951217, 0.000158804370806,
        -0.014763588775298, 0.015459708842460,  0.028835597688984,  -0.028673576519591, -0.015911842693784, 0.049679300512485,  0.113350632462477};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 36, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.022295388086252,  0.012371672585811,  0.000000000000000,  0.000000000000000,  0.049319261105562,
        0.061655232939885,  0.000000000000000,  0.000000000000000,  -0.069820779916592, -0.036670031148188, 0.000000000000000,  0.000000000000000,
        0.074309852614785,  0.025823972182706,  0.000000000000000,  0.000000000000000,  0.005956947832196,  -0.010262437167728, 0.000000000000000,
        0.000000000000000,  -0.062336669204244, -0.047234254397076, 0.495517528199490,  0.363571407598650,  -0.005620398964964, 0.023671419655311,
        0.000000000000000,  0.000000000000000,  0.026724067353080,  0.018198264129397,  0.000000000000000,  0.000000000000000,  0.038624767759098,
        0.059847703428466,  0.000000000000000,  0.000000000000000,  -0.047083925140606, -0.032950186773683, 0.000000000000000,  0.000000000000000,
        0.036864197964915,  0.020681034360647,  0.000000000000000,  0.000000000000000,  0.002686903526838,  -0.008750241426534, 0.000000000000000,
        0.000000000000000,  -0.054770874379691, -0.048398887816370, 0.275539272477144,  0.275109587406145,  0.009329401207043,  0.035223116971208,
        0.032521822300160,  0.017542790476286,  -0.028342874826704, -0.011118409235957, 0.009656128462570,  0.023643883751557,  -0.042638564636378,
        -0.039635793809136, -0.028437393459465, -0.023042418223395, -0.007563816727112, -0.014468755861664, 0.023416369116569,  0.024913875523276,
        0.013431398883031,  0.012017400604638,  -0.019484930072459, -0.016430332691232, -0.008048400911386, -0.010454918440866, -0.029172927007612,
        -0.018327850993626, 0.011773127798268,  0.017956656459394,  -0.007144911581242, -0.011376698302859, 0.098481073726698,  0.076197914974304,
        0.070258856165048,  0.051207802143814,  -0.006341457522645, -0.003507904567854, 0.024500071608469,  0.035648666767769,  -0.023280060921275,
        -0.050285786303011, -0.007700732102727, -0.011555637535336, -0.008595924939425, -0.018643807950357, -0.006524375606127, 0.001081599062495,
        0.007044104433084,  0.014371401939773,  -0.000554214845418, -0.003924765373842, -0.006172708297053, -0.011781769221193, -0.039506368483015,
        -0.036202766924309, 0.010650611507470,  0.029599379000367,  0.030143736278655,  0.026906919414473,  0.044621617511644,  0.111154752383056,
        0.000000000000000,  0.000000000000000,  -0.015965584610032, -0.032542010362868, 0.000000000000000,  0.000000000000000,  -0.031853964343502,
        -0.003235073239668, 0.000000000000000,  0.000000000000000,  -0.049769260542380, 0.010442130065092,  0.000000000000000,  -0.000000000000000,
        0.006092982482974,  -0.000120888313810, 0.000000000000000,  0.000000000000000,  0.094357840555033,  -0.003649879479844, 0.429130767441230,
        0.314862075070098,  0.001345651331760,  -0.017229567162721, 0.000000000000000,  0.000000000000000,  -0.033854222184096, -0.043251349588134,
        0.000000000000000,  0.000000000000000,  -0.002959029966831, -0.022141452303732, 0.000000000000000,  0.000000000000000,  -0.032971756731201,
        -0.003889541601526, 0.000000000000000,  0.000000000000000,  -0.018154901418729, 0.016111787713500,  0.000000000000000,  0.000000000000001,
        -0.002532626679908, -0.001720119942205, 0.000000000000000,  0.000000000000000,  0.042259279108697,  -0.008660179454355, 0.238624009705489,
        0.238251891518377,  -0.021732501801496, -0.015241858308471, 0.000000000000000,  0.000000000000000,  -0.035282742619660, -0.046625826008145,
        0.027045461357756,  0.009597382089732,  -0.044021037409211, -0.008218155914861, -0.068217895098814, -0.021853782980509, -0.085571656201633,
        -0.051974544285619, 0.019155055291221,  0.009063230949718,  -0.063537998990796, -0.059559567500013, -0.003702617351838, 0.003501871540907,
        0.011979827555921,  0.005667148180764,  -0.003908769726898, -0.002768686674967, -0.047630875760027, -0.035406466157546, -0.002800699883346,
        0.007406742081963,  0.090793587268467,  0.082215636468654,  -0.050729418487554, -0.045620827398961, 0.005176489783751,  0.004743146627596,
        0.093061042872770,  0.056747659493725,  -0.004392926560941, 0.018667049637875,  -0.027457512637360, -0.014175923245905, -0.030079959888420,
        -0.031702077766243, 0.045358048402932,  0.040654124534466,  -0.034905231445078, -0.062409452301245, -0.011270028660839, -0.007362807392332,
        0.003276018634559,  0.008493976941152,  -0.026897000711773, -0.024823832177832, -0.020560983559598, -0.018660743345164, -0.016726829964790,
        -0.011555311304337, 0.048349706243899,  0.132197577896765,  -0.110034871218969, -0.098036290879517, 0.002771460146952,  0.003734701718614,
        0.000000000000000,  0.000000000000000,  0.037296395247085,  0.027473547867778,  0.000000000000000,  0.000000000000000,  0.023568923662896,
        0.013575783911075,  0.000000000000000,  0.000000000000000,  -0.023956729734577, -0.006704495922181, 0.000000000000000,  0.000000000000000,
        0.010714999027544,  0.005808115506399,  0.362681693937869,  0.266107022398143,  -0.048714163855672, -0.053100334902128, 0.000000000000000,
        0.000000000000000,  0.048660430643922,  -0.012189410242991, 0.093644010706378,  0.068708537737123,  0.017861487409260,  -0.005565092875262,
        0.000000000000000,  0.000000000000000,  0.013285172526462,  0.021571702035067,  0.000000000000000,  0.000000000000000,  0.016335232908215,
        0.016794335183503,  0.000000000000000,  0.000000000000000,  -0.011394713431006, -0.006486508553212, 0.000000000000000,  0.000000000000000,
        0.008000393925102,  0.002268598626459,  0.201674097082973,  0.201359599813872,  -0.043956406145683, -0.049586418596892, 0.000000000000000,
        0.000000000000000,  0.017196671447143,  -0.017080358664064, 0.052072027957585,  0.051990825111875,  0.013711809910287,  -0.004912413569848,
        0.041755712375233,  0.048000822701524,  -0.030172012835055, -0.021735324704919, -0.008373898410992, 0.004969401602478,  -0.156353858171322,
        -0.053419264305066, 0.068090407819282,  0.031553474053209,  -0.123207135184890, -0.042365976083434, 0.027231179986626,  0.019657582772732,
        -0.074515134387096, -0.067361500285846, -0.016982013889627, -0.022315659536671, -0.054340146911246, -0.018068498888599, 0.005247700358305,
        0.007958058402961,  -0.039721173419733, -0.052107229133622, -0.037577896281140, -0.040749907849901, 0.006863681885040,  -0.013368469373746,
        0.019487444541660,  0.027589851379948,  -0.012624405247884, -0.014097564433289, 0.036701163506110,  0.029319579240569,  -0.029900309860129,
        0.025317322575876,  0.023481569946876,  0.018023222997098,  -0.023523235543958, 0.037893727058604,  -0.017871296773990, -0.017481954064668,
        -0.039339496498085, -0.053319715443261, -0.036454337345816, -0.039298965387063, -0.009731848716725, 0.071887198233668,  -0.031579686029797,
        -0.033338858649369, -0.030808610350808, -0.065754003451913, -0.074913530137377, -0.069798390412846, -0.008154520947737, -0.029661220271218,
        0.000000000000000,  0.000000000000000,  -0.012318366353250, -0.015524009569793, 0.000000000000000,  0.000000000000000,  -0.066838110974085,
        -0.006321367015255, 0.000000000000000,  0.000000000000000,  -0.031417331922658, 0.014179191199189,  0.418788747250357,  0.307273922029635,
        0.037348476261657,  -0.057250035594636, 0.000000000000000,  0.000000000000000,  0.036387731066032,  0.000969108840927,  0.162196184367970,
        0.119006678274461,  0.012396142742073,  -0.009094016196092, 0.000000000000000,  0.000000000000000,  0.016034969837867,  0.008034149246901,
        0.000000000000000,  0.000000000000000,  0.000106459231806,  -0.010882308665217, 0.000000000000000,  0.000000000000000,  -0.034297299907401,
        -0.004886226284306, 0.000000000000000,  0.000000000000000,  -0.016453846842608, 0.020308540750958,  0.232873188478858,  0.232510038312910,
        -0.012371365447670, -0.059761217876749, 0.000000000000000,  0.000000000000000,  0.017325663178128,  -0.002409722856218, 0.090191398075684,
        0.090050750621196,  -0.004556800345153, -0.012576174532347, 0.000000000000000,  0.000000000000000,  -0.000672672309036, 0.004842848145511,
        0.103105308961643,  0.053987548954381,  0.003493419700774,  -0.001050835862238, 0.006984793780462,  -0.009987953324825, -0.076681205419733,
        -0.046322938160133, 0.023825885797847,  0.031266998863800,  -0.260014242019450, -0.126914955002139, -0.027486228840600, -0.022367064450580,
        -0.036824451252261, -0.023066775103898, 0.026799252389312,  0.020473917899002,  -0.103267095310790, -0.069449689322837, -0.019746791944196,
        -0.013341306367794, 0.039779236203970,  0.007182959956483,  0.037611107049452,  0.045489879892118,  0.018023431283106,  0.009437393859801,
        0.093515509840237,  0.065932797354899,  -0.000643649828756, 0.002855663746131,  -0.020808016203559, -0.013145528922339, -0.026616068085238,
        -0.015000414603520, 0.081058312614401,  0.071066370041399,  -0.072568992363367, -0.023847923180304, -0.090825934350200, -0.087067126411618,
        -0.013023475357620, 0.053246534617874,  0.008648421648054,  0.006845664360199,  -0.040074022882533, -0.019647509141118, -0.093777962890705,
        -0.081935989166207, 0.003778877792745,  -0.004099462319554, 0.038072307146000,  0.036286813210894,  0.005400316974544,  0.006301757315642,
        -0.000000000000000, -0.000000000000000, -0.004319562127043, 0.008795795741659,  0.000000000000000,  0.000000000000000,  -0.009424703789033,
        0.002933429554196,  -0.324392368735939, -0.238013356548923, 0.037861186432126,  0.048504510385826,  0.000000000000000,  0.000000000000000,
        -0.024696589641168, 0.003298133768370,  0.000000000000000,  0.000000000000000,  0.012734409257961,  -0.003336175456351, 0.000000000000000,
        0.000000000000000,  0.043916740244856,  0.002324795892505,  0.000000000000000,  0.000000000000000,  0.010743418426024,  0.015866811035455,
        -0.000000000000000, -0.000000000000000, -0.011158026247670, 0.005363828336886,  0.000000000000000,  0.000000000000000,  -0.009121075137611,
        0.002055909812388,  -0.180382796151368, -0.180101501242389, 0.032026315882929,  0.049153066482216,  0.000000000000000,  0.000000000000000,
        -0.016346899653873, 0.010586911991860,  0.000000000000000,  0.000000000000000,  -0.001130289386685, -0.004018920674357, 0.000000000000000,
        0.000000000000000,  0.027727020022944,  0.003550898228622,  0.000000000000000,  0.000000000000000,  -0.002817917578522, 0.010834259090445,
        -0.022198755062527, -0.002157666961844, 0.014473014344828,  0.011793100417640,  0.046733644482835,  0.013132082283015,  -0.025796903380482,
        -0.047223851646313, -0.085264702877420, -0.013539519696439, -0.135184494031348, -0.131155469264006, -0.002727695867328, 0.012562511067851,
        -0.264575017570980, -0.158449709181303, -0.052063971557068, -0.030057206022979, -0.013860764148549, -0.034518318109483, 0.022696028652379,
        0.023983361354396,  0.075073139011090,  0.072398833943733,  -0.198400470018061, -0.096274642906548, 0.016676602767751,  0.022741053454485,
        -0.035800636923074, -0.021412023655005, 0.006886525948837,  0.011204728560106,  -0.057089485398141, -0.047986161500724, -0.028063983796328,
        -0.072704947051724, 0.097215793593694,  0.097515396230415,  -0.077085562527495, -0.165722201891842, 0.064356204268198,  0.051563842368428,
        -0.091814299564134, -0.121307397350042, -0.028284089228279, -0.018248692991707, -0.020520329716035, -0.046698910776527, 0.080615604090448,
        0.064395940722007,  0.042535917369199,  0.089137035366534,  -0.104883056517167, -0.070790558554247, 0.013449665896077,  0.030216625259016,
        0.000000000000000,  0.000000000000000,  0.002901531623274,  0.008241072448228,  -0.162196184367970, -0.119006678274461, 0.013265066149216,
        0.013525447712679,  0.000000000000000,  0.000000000000000,  -0.016829142734363, 0.003265085336714,  0.000000000000000,  0.000000000000000,
        0.025171571577394,  0.001753041175017,  0.000000000000000,  0.000000000000000,  -0.035108019745605, 0.005711592429420,  0.000000000000000,
        0.000000000000000,  0.000911668339408,  -0.000748970247318, 0.000000000000000,  0.000000000000000,  0.004722270023111,  -0.012408208393333,
        0.000000000000000,  0.000000000000000,  -0.001765904155944, 0.005789713161800,  -0.090191398075684, -0.090050750621195, 0.017498603299787,
        0.016173231139270,  0.000000000000000,  0.000000000000000,  -0.013893293692461, 0.005190301670372,  0.000000000000000,  0.000000000000000,
        0.009800704813572,  0.001176972335182,  0.000000000000000,  0.000000000000000,  -0.021051735131030, 0.010105513623383,  0.000000000000000,
        0.000000000000000,  0.000561974447271,  -0.000650470411859, 0.000000000000000,  0.000000000000000,  0.009079293746964,  -0.008434433693164,
        -0.200696424612640, -0.108863316787259, -0.015357897060252, -0.014226510744440, 0.041990206403357,  0.034152726500302,  -0.103001999232270,
        -0.071116557869918, -0.064606864456065, -0.028912926050860, -0.103267095310790, -0.069449689322837, -0.017866355147638, 0.004330144855606,
        -0.168138915752248, -0.120051619996792, 0.051403996726748,  0.034381608582693,  -0.338791175956255, -0.221710239723858, -0.077564318757360,
        -0.025905832023150, -0.026702044326658, -0.028181453085836, 0.031721004985501,  0.018952144339363,  0.018934859208597,  0.011698780337409,
        -0.108598977240431, -0.079843600410750, -0.008322465627439, -0.013518485892913, 0.114971481869521,  0.098253793599004,  -0.041226792291980,
        -0.048846101738115, 0.010579279226022,  0.019005005305500,  -0.040074022882533, -0.019647509141118, 0.022220521882251,  0.017852785249041,
        -0.069797543180771, -0.087881678413282, 0.023873779369639,  0.016385682374341,  -0.128655378353703, -0.165894313078710, 0.030403129586979,
        0.028114615205214,  -0.016581363636586, -0.030851425372322, 0.076414321887167,  0.054198895712841,  0.006763257135195,  0.010266242888845,
        -0.093644010706378, -0.068708537737123, 0.000323296912306,  0.010859217677017,  0.000000000000000,  0.000000000000000,  0.004985890302584,
        0.017690518908219,  -0.362681693937869, -0.266107022398143, 0.048130442578445,  0.052955025098692,  0.000000000000000,  0.000000000000000,
        -0.025752243538618, 0.001711427185908,  0.000000000000000,  0.000000000000000,  0.007685484926605,  -0.010350264853144, 0.000000000000000,
        0.000000000000000,  0.045146508343349,  0.014024896331059,  0.000000000000000,  0.000000000000000,  0.029578993609511,  0.022338792547705,
        -0.052072027957585, -0.051990825111874, -0.008825352006042, 0.008482369519230,  0.000000000000000,  0.000000000000000,  0.002258402132129,
        0.021146751748293,  -0.201674097082973, -0.201359599813872, 0.038027613905308,  0.049258855531182,  0.000000000000000,  0.000000000000000,
        -0.013480241838778, 0.006599637803707,  0.000000000000000,  0.000000000000000,  -0.006861054698113, -0.008519958035174, 0.000000000000000,
        0.000000000000000,  0.025268860793036,  0.017053474652245,  0.000000000000000,  0.000000000000000,  0.014575718054416,  0.018279701674240,
        -0.028883960394654, 0.015486250077637,  -0.010646208996438, 0.001369217141072,  -0.075764644589684, -0.023537465419253, -0.039721173419733,
        -0.052107229133622, -0.000435263628715, 0.015781392525031,  -0.106917229214468, -0.128587296365825, -0.066236380419635, -0.030763795279662,
        0.020602555009789,  0.014434444690434,  -0.004564052391538, -0.002755422434943, -0.127337878841826, -0.100333118135062, -0.052293620211546,
        -0.012283500841264, -0.100176903853126, -0.018329867687925, 0.087119925145322,  0.061913643818693,  -0.003424339612450, 0.008534633093111,
        0.056349785497414,  0.058796723407755,  0.000957537331884,  0.008941836703087,  0.040636471787285,  0.042968181705596,  -0.030808610350808,
        -0.065754003451913, 0.022169791177839,  0.029790218337948,  -0.076060760745780, -0.203288500662297, 0.033792250799254,  0.033837957028751,
        0.008367378318638,  0.010458030641004,  0.001875232787547,  0.000832946166802,  -0.058679588295054, -0.103932066148227, 0.037949344802667,
        0.030843826553300,  -0.009751045224811, 0.030372806715416,  0.036951637897200,  0.037504555503845,  0.005182814576366,  0.016671516876895,
        0.000000000000000,  0.000000000000000,  0.034542881170338,  0.042829934959027,  -0.429130767441230, -0.314862075070098, 0.032256992974801,
        0.019893402300994,  0.000000000000000,  0.000000000000000,  -0.024498573039396, 0.006819305805399,  0.000000000000000,  0.000000000000000,
        0.083807883389838,  0.001037993466072,  0.000000000000000,  0.000000000000000,  -0.017297342903795, 0.011592754594747,  0.000000000000000,
        0.000000000000000,  -0.054768187580363, -0.005778570503023, 0.000000000000000,  0.000000000000000,  -0.026918571056527, -0.035008276555995,
        0.000000000000000,  0.000000000000000,  0.036321517192378,  0.046394913791748,  -0.238624009705489, -0.238251891518376, 0.033575851690527,
        0.016714824652521,  0.000000000000000,  0.000000000000000,  -0.021458395396821, 0.008584661148347,  0.000000000000000,  0.000000000000000,
        0.033210059769771,  -0.003270401978489, 0.000000000000000,  0.000000000000000,  -0.003933795116593, 0.016652253462044,  0.000000000000000,
        0.000000000000000,  -0.039518107981029, -0.005258148040707, 0.000000000000000,  0.000000000000000,  -0.005608167723551, -0.023694336441593,
        0.050865526993367,  0.044691656403266,  0.005176489783751,  0.004743146627596,  -0.031432611698583, -0.017061378844667, -0.104077946423851,
        -0.109621183997768, -0.034136427469397, -0.006583409572158, -0.005301565676808, -0.036457477944608, -0.028543773106763, -0.009774579778275,
        0.044236266843060,  0.040847718902424,  -0.006591505477871, -0.002407172621357, -0.021034654840392, -0.032102099808756, -0.052710702559526,
        -0.021152386900555, -0.030945917331091, 0.007209955363866,  0.052028313562850,  0.017414022535904,  -0.029812727796677, 0.010063530629728,
        0.111343800974824,  0.098699619353272,  0.002771460146952,  0.003734701718614,  0.012051392197012,  0.009428130258959,  -0.064705331497429,
        -0.176377887732142, -0.000998528441438, 0.006181065622356,  -0.021955378957874, -0.072367739690848, -0.021107538185307, -0.014401486766915,
        0.023935765173759,  0.046242446979916,  0.041293768889715,  0.037723692279908,  -0.019113321742193, -0.056821725739260, -0.023117805453949,
        -0.012304449964930, 0.004715512469439,  0.029565641523794,  0.100472441913805,  0.060895162811164,  0.006405765523796,  0.040475053346858,
        -0.495517528199489, -0.363571407598651, 0.002280267726754,  -0.024429939721710, 0.000000000000000,  0.000000000000000,  0.061170260198492,
        0.046637345610535,  -0.000000000000000, 0.000000000000000,  0.035474259590918,  0.019080040796290,  0.000000000000000,  0.000000000000000,
        0.028347925999664,  0.005942078048543,  0.000000000000000,  0.000000000000000,  -0.100778123962908, -0.045069917333454, 0.000000000000000,
        0.000000000000000,  0.031207510580161,  0.058384335007685,  0.000000000000000,  0.000000000000000,  0.020218790497176,  0.012042801244845,
        -0.275539272477144, -0.275109587406143, -0.010286327126154, -0.035723209473220, 0.000000000000000,  0.000000000000000,  0.054738008392734,
        0.048006059407209,  0.000000000000000,  -0.000000000000000, 0.015705651435556,  0.015395058675346,  0.000000000000000,  0.000000000000000,
        0.016244508320444,  0.005075125765395,  0.000000000000000,  0.000000000000000,  -0.059200446526624, -0.039099621581535, 0.000000000000000,
        0.000000000000000,  0.031767553065501,  0.057559153360704,  0.000000000000000,  0.000000000000000,  0.025947330325133,  0.017973598297058,
        0.010588892219244,  0.011928137692011,  -0.093446033303419, -0.070441518221534, 0.026049032916456,  0.015954625498737,  -0.002807184487949,
        -0.009741285512649, 0.014778221855102,  0.019672398232444,  0.007142937014143,  0.004287410478782,  -0.005903401796957, -0.002643335276936,
        0.002216854566762,  0.003483752194072,  -0.037230321086746, -0.034011245045462, 0.007629705790920,  0.003314664419689,  0.015428509800254,
        0.022737733397158,  -0.030333807567089, -0.023803388837498, 0.035141361496980,  0.018386561067332,  -0.028120507072469, -0.010185988390798,
        -0.028687749579410, -0.026161372325987, -0.041232797128253, -0.105012395535754, 0.039993891770241,  0.036324886406655,  -0.005850301721797,
        -0.023130685872613, -0.006313904046296, 0.000904968058954,  0.002455223607688,  0.000429736494716,  -0.001081842171932, -0.000261359852972,
        0.002058432823849,  0.004270418892889,  -0.001100702758751, -0.009043854251906, 0.001870541392208,  -0.000814760336320, 0.027757156451744,
        0.037027011013553,  -0.013928119248247, -0.031399501085207, 0.070901678631976,  0.051556316688477,  -0.005780499157360, -0.001747322517815};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 36, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.007945838177628,  0.007281926867834,  0.000000000000000,  0.000000000000000,  0.015501274770103,
        0.001363488928044,  0.000000000000000,  0.000000000000000,  -0.021774441970662, -0.001280146136960, 0.000000000000000,  0.000000000000000,
        0.014473665238632,  0.000277848074022,  0.000000000000000,  0.000000000000000,  0.011462124287311,  0.000453653762437,  0.000000000000000,
        0.000000000000000,  -0.029510450423437, -0.003172297502620, 0.000000000000000,  0.000000000000000,  0.009938708041426,  0.010867026355064,
        0.000000000000000,  0.000000000000000,  0.012138916845319,  0.011068933762722,  -0.000000000000000, 0.000000000000000,  0.012026876831922,
        0.001376744344984,  0.000000000000000,  0.000000000000000,  -0.014558652104892, -0.001396231834518, 0.000000000000000,  0.000000000000000,
        0.008219251025385,  0.000179472463081,  0.000000000000000,  0.000000000000000,  0.006736433993267,  0.000485834657201,  0.000000000000000,
        0.000000000000000,  -0.025080518486728, -0.003222331106843, 0.000000000000000,  0.000000000000000,  0.017139431298143,  0.016544933491476,
        -0.010183557065821, -0.013566265915810, -0.087259970471693, -0.047080080267748, -0.050175725970438, -0.035480698513077, 0.031954831966683,
        0.020018213132842,  0.110170304401078,  0.066442114341126,  0.016337935404754,  0.010027254092190,  -0.074323857581978, -0.039698734421836,
        -0.010168008738706, -0.007543564484329, -0.054650228613481, -0.029313296151098, 0.007470165862076,  0.005177190425252,  0.093291421633894,
        0.072142638972670,  -0.052848494728578, -0.030557099639993, -0.011913691805578, -0.018640226134359, -0.135929405242008, -0.074510149507429,
        -0.016390294001437, -0.020971186322248, -0.027222101689358, -0.037636447105826, -0.037785479399126, -0.032882716565227, 0.011563852030169,
        0.009375236115085,  0.045469379655934,  0.035911511514130,  0.005737900640210,  -0.001295195647711, -0.018693266928880, -0.014002935890421,
        -0.004397250782982, -0.006169584450851, -0.013560881084457, -0.010391309207438, 0.002983821404029,  0.001473909685240,  0.087672415179338,
        0.076801376708861,  -0.017632239181047, -0.014874005406505, -0.024446336643780, -0.031332146864967, -0.043090016688346, -0.058492808981632,
        0.350383804386655,  0.257083807758544,  -0.034137448127990, 0.015626309519573,  0.000000000000000,  0.000000000000000,  -0.025368791292168,
        -0.023196088482936, 0.000000000000000,  -0.000000000000000, -0.045455708568655, -0.014355679394100, 0.000000000000000,  0.000000000000000,
        -0.014558179134856, -0.003228569374702, 0.000000000000000,  0.000000000000000,  0.078517685383210,  0.029736657629253,  0.000000000000000,
        0.000000000000000,  -0.027634524415611, -0.034021327907352, 0.000000000000000,  0.000000000000000,  0.002543502174088,  0.000182003197913,
        0.194835688051796,  0.194531854824317,  -0.019202981981899, 0.024709182081242,  0.000000000000000,  0.000000000000000,  -0.020273090392738,
        -0.018783469747772, 0.000000000000000,  0.000000000000000,  -0.021733305706539, -0.012153823167890, 0.000000000000000,  0.000000000000000,
        -0.006658356721194, -0.002335016137091, 0.000000000000000,  0.000000000000000,  0.038297820175070,  0.025383216309886,  0.000000000000000,
        0.000000000000000,  -0.026125046702657, -0.027683310754140, 0.000000000000000,  0.000000000000000,  0.001297703204075,  0.000151096724911,
        0.026774639136442,  0.014698538654326,  -0.119393845676869, -0.055730759975656, 0.038311849288474,  0.027998734540220,  -0.130327834765193,
        -0.068690447136593, 0.103484798925315,  0.042082818821364,  0.001200819477073,  -0.001782890000647, 0.031313335132017,  0.012637252940237,
        0.008588935092346,  0.006743050844393,  -0.182940796554030, -0.075620460965751, -0.051126516699877, -0.024284379734905, 0.037664327532809,
        0.033812830417572,  -0.170368467145607, -0.085932456361449, -0.002231597162138, -0.001060339623905, 0.003990931400685,  0.002926962626918,
        -0.003253800828067, -0.004140968191871, -0.031921307312891, -0.007645543926910, 0.063847929999998,  0.044496359291952,  -0.039540703773411,
        -0.031997365086380, 0.012687144698513,  0.002468080764101,  -0.001052714874519, -0.001968980611194, 0.005504581181627,  0.002613622062131,
        0.003943405594371,  0.006382039528203,  -0.026685831970212, -0.004937812078599, -0.013822576408251, 0.003725872237050,  0.093472428258163,
        0.065439390663376,  -0.049443619848432, -0.042349759597889, -0.000044015072444, -0.000032109718550, 0.001694084915403,  0.001276557172024,
        0.000000000000000,  0.000000000000000,  -0.037446023409825, -0.043379349062423, 0.458760087396700,  0.336601716857429,  0.008804664707530,
        -0.004917887826137, 0.000000000000000,  0.000000000000000,  -0.047477127849512, -0.009218409341708, 0.000000000000000,  0.000000000000000,
        -0.065099507330223, 0.002511970853905,  0.000000000000000,  0.000000000000000,  -0.011789060723932, -0.008371685679860, 0.000000000000000,
        0.000000000000000,  0.026318524507193,  0.000828799404815,  0.000000000000000,  0.000000000000000,  0.086672832416228,  0.067924152621360,
        0.000000000000000,  0.000000000000000,  -0.039580829803223, -0.045229453620507, 0.255099796736046,  0.254701985660741,  0.006125601562245,
        0.006680553827698,  0.000000000000000,  0.000000000000000,  -0.027845717620302, -0.008744220083485, 0.000000000000000,  0.000000000000000,
        -0.019593804047750, 0.009089936723190,  0.000000000000000,  0.000000000000000,  -0.019475088153070, -0.008431084273694, 0.000000000000000,
        0.000000000000000,  0.008766923478390,  -0.000068248639545, 0.000000000000000,  0.000000000000000,  0.075098684453098,  0.070209688182530,
        0.005663023554838,  0.004199249461640,  -0.018794513568376, -0.008860301849644, -0.023081173523662, -0.018424362372461, -0.270789085525523,
        -0.124387836962662, 0.072040606367864,  0.039249080295220,  -0.269221198288162, -0.124093938445293, 0.045150547186829,  0.001974045671700,
        0.019787914651026,  0.036292392255393,  0.023693747993953,  0.035386262794937,  -0.252527308668081, -0.112259982739097, -0.038808778317585,
        -0.014912234239941, 0.050251191517008,  0.030197408175478,  -0.025230960314048, -0.014191096919368, 0.051598507216269,  0.029074837633946,
        -0.004627933260267, -0.007420169988944, -0.005006086936072, 0.007718276322370,  0.019166611283681,  0.006228610036471,  -0.070661444280709,
        0.039859193137262,  0.038164269064665,  0.033866665963993,  -0.070388527787652, 0.025146099011514,  0.023793154036005,  0.019115478594093,
        0.021658836740260,  0.058836775066119,  0.062992788587543,  0.056468607832131,  -0.063705913070726, 0.017702908807371,  -0.007950627816421,
        -0.004962124871150, 0.017307678576384,  0.002785846006290,  0.006650875238922,  0.010930376002955,  0.016600598560059,  -0.007759660324717,
        0.000000000000000,  -0.000000000000000, -0.095427202071149, -0.027138535052635, 0.000000000000000,  0.000000000000000,  -0.043687609981882,
        -0.014852330312023, 0.512909370391382,  0.376332160118174,  -0.090656081667063, -0.054157992229403, 0.000000000000000,  0.000000000000000,
        0.026421464059262,  0.008271366203572,  0.000000000000000,  0.000000000000000,  -0.006115341313006, -0.004885314007162, 0.000000000000000,
        0.000000000000000,  -0.024778947398579, 0.023276787571049,  0.000000000000000,  0.000000000000000,  -0.085042555594577, -0.044475883651826,
        -0.000000000000000, -0.000000000000000, -0.060956249038864, -0.025373519126399, 0.000000000000000,  0.000000000000000,  -0.022535627984613,
        -0.018978964254773, 0.285210243274089,  0.284765476970799,  -0.055602983990882, -0.039511719984516, 0.000000000000000,  0.000000000000000,
        0.004774045294185,  0.010375459391074,  0.000000000000000,  0.000000000000000,  -0.001415943590237, -0.009178161551128, 0.000000000000000,
        0.000000000000000,  0.012164416420586,  0.034411747839220,  0.000000000000000,  0.000000000000000,  -0.066958433385923, -0.043105461556264,
        0.028527057170750,  0.013994802608057,  -0.006307762797230, -0.003841318915161, 0.071566464832006,  0.030981559811141,  -0.036688239912572,
        0.000141302482206,  0.105602420750903,  0.041602657570937,  -0.207574272689072, -0.024856062345631, -0.075885202354510, -0.011838316817097,
        -0.152177965195922, -0.031201462184231, 0.025396257231672,  0.004963730725213,  -0.095641883361470, -0.022076374344680, 0.030235808996222,
        0.006784281761754,  0.002489429070943,  -0.013889678644159, 0.012153900331121,  0.006698135434004,  -0.003780619864307, -0.005976428937689,
        -0.001673688642345, -0.002797515156815, -0.002218672739718, -0.002495615113054, -0.015300020109184, -0.014512033477159, 0.000967020889994,
        0.067584235064244,  0.067592594257324,  0.034999585412125,  -0.011578228070461, 0.192430304639706,  0.070657787484412,  0.067900990173820,
        -0.016632198041934, 0.061510218803496,  -0.026380806921520, -0.020526647256081, -0.011624470302985, 0.061960600008985,  0.073045797514312,
        0.053712440319208,  -0.008611905913522, -0.056472618191506, -0.003875312960781, -0.005857770905140, -0.003650323622113, -0.019371963935103,
        0.000000000000000,  0.000000000000000,  -0.030378365393214, -0.006904504110029, 0.000000000000000,  0.000000000000000,  -0.070174302253201,
        0.011235989556862,  0.000000000000000,  0.000000000000000,  0.063924784600885,  -0.007709894023523, 0.529730519903882,  0.388674183674654,
        -0.000618696062595, -0.052240142437596, 0.000000000000000,  0.000000000000000,  0.042616523067257,  -0.005139929349015, 0.000000000000000,
        0.000000000000000,  0.029239292605501,  -0.004681662315359, 0.000000000000000,  0.000000000000000,  0.155267200898648,  0.035289687673483,
        0.000000000000000,  0.000000000000000,  -0.018510129737846, -0.006177258109770, 0.000000000000000,  0.000000000000000,  -0.004603957006603,
        0.021615536716291,  0.000000000000000,  0.000000000000000,  0.025487278619721,  -0.018925595170255, 0.294563872631550,  0.294104519968722,
        -0.032978752798884, -0.039988705939754, 0.000000000000000,  0.000000000000000,  0.016991519079814,  -0.012617063446837, -0.000000000000000,
        0.000000000000000,  0.001918315419418,  -0.009006473631788, 0.000000000000000,  0.000000000000000,  0.094607329771210,  0.031572652561047,
        0.008742463984280,  0.004115282650596,  0.006894653443070,  0.004757946816679,  0.108084025750608,  0.037378485780683,  0.129915556912884,
        0.084936641659240,  -0.044593190014475, -0.029131884651757, 0.181922876113216,  0.123887253131674,  -0.024732068226964, 0.009033033698551,
        -0.084155764890325, 0.011584575420938,  -0.029728793342983, -0.019421256434505, 0.121281917408810,  0.082591502087783,  -0.045035010729420,
        -0.015574369075285, -0.054131482047035, -0.035390267358017, -0.044683704808543, -0.021033666880825, -0.035239339820135, -0.024318394840805,
        -0.000472810308748, -0.000714431511997, 0.002753632671849,  0.002018959279896,  0.076863193679308,  0.050816439061928,  0.049138675969954,
        0.039947683759035,  -0.099120248088490, -0.080099723118746, 0.071945240320285,  0.089576674967063,  0.067419830331080,  0.040433028558449,
        0.008144967263216,  0.128490755072244,  -0.066080165392327, -0.053399815412497, 0.047963493546856,  0.059717783311375,  -0.032026330699711,
        -0.021173516275804, -0.020474448320814, -0.016644868232931, 0.002416586022490,  0.003651538839094,  -0.014074122545008, -0.010319125208359,
        0.000000000000000,  0.000000000000000,  0.170239436882258,  0.056698724169281,  0.000000000000000,  0.000000000000000,  0.003938094543640,
        -0.023046412470354, 0.000000000000000,  0.000000000000000,  -0.006115341313006, -0.004885314007162, 0.000000000000000,  0.000000000000000,
        0.017614309372841,  0.005514244135714,  0.512909370391383,  0.376332160118174,  -0.085559963906225, -0.050086897223434, 0.000000000000000,
        0.000000000000000,  0.062832304610029,  -0.016029803048912, -0.000000000000000, 0.000000000000000,  -0.010940294794199, -0.015017551539493,
        0.000000000000000,  0.000000000000000,  0.113903145993823,  0.053632671229101,  0.000000000000000,  0.000000000000000,  -0.017158037702817,
        -0.033040216733744, 0.000000000000000,  0.000000000000000,  -0.001415943590237, -0.009178161551128, 0.000000000000000,  0.000000000000000,
        0.003182696862790,  0.006916972927383,  0.285210243274089,  0.284765476970799,  -0.054423030999018, -0.031863252025243, 0.000000000000000,
        0.000000000000000,  0.002987325235677,  -0.025989012127203, 0.000000000000000,  -0.000000000000000, -0.014402742369363, -0.014934036200836,
        -0.045474040496020, -0.022609017579171, 0.010501336343031,  0.007895207907333,  0.001514692444754,  0.005505707810199,  -0.014614720793539,
        0.010733280585501,  0.025396257231672,  0.004963730725213,  -0.095641883361470, -0.022076374344680, -0.050590134903007, -0.007892211211398,
        -0.101451976797281, -0.020800974789487, 0.084438873057844,  0.037466215299926,  -0.127872703221179, -0.006459083725065, -0.090713875866318,
        -0.031833942445510, 0.025285473336252,  0.016274003670901,  -0.004515415159442, -0.001783488852568, 0.000356947710838,  -0.001938529770264,
        0.003959064310395,  0.006364436864439,  0.004641146671350,  0.011453332181391,  -0.061485235818035, -0.046340657987638, 0.006959281010784,
        0.066835018438781,  -0.026380806921521, -0.020526647256081, -0.011624470302985, 0.061960600008985,  0.047105191656275,  0.045267326782547,
        -0.011088132027956, 0.041006812535664,  0.089576600025258,  0.052105124792193,  -0.001891169484640, 0.140796471298885,  -0.074387335445714,
        -0.052190032060738, 0.009413770392878,  0.014620856022614,  -0.001590635220645, -0.002295071413843, -0.001236106549225, -0.010348258268818,
        0.000000000000000,  0.000000000000000,  -0.039978558085485, -0.063553608955842, 0.000000000000000,  0.000000000000000,  0.026318524507193,
        0.000828799404815,  0.000000000000000,  0.000000000000000,  -0.006038928591169, 0.006734907180048,  0.000000000000001,  0.000000000000000,
        0.027124794720926,  -0.001046654522461, 0.000000000000000,  0.000000000000000,  0.043643706427670,  -0.000852652564897, 0.458760087396699,
        0.336601716857430,  0.061003071646796,  -0.003274102339921, 0.000000000000000,  0.000000000000000,  -0.046988236924650, -0.044272491989045,
        0.000000000000000,  0.000000000000000,  -0.051023603607681, -0.066588641700975, 0.000000000000000,  0.000000000000000,  0.008766923478390,
        -0.000068248639545, 0.000000000000000,  0.000000000000000,  0.012787041669855,  0.007025510518234,  -0.000000000000000, -0.000000000000000,
        0.008164085019896,  -0.003787473634663, 0.000000000000000,  0.000000000000000,  0.006337631071685,  -0.001560176444467, 0.255099796736046,
        0.254701985660740,  0.023513333127718,  0.006545194025933,  0.000000000000000,  0.000000000000000,  -0.044500695570629, -0.045969432968496,
        -0.000388644081156, 0.002109925206639,  -0.015768194632599, -0.004912586964433, -0.038808778317585, -0.014912234239941, 0.050251191517008,
        0.030197408175478,  0.001616400473400,  -0.028340055500569, 0.207135962038832,  0.090095705260444,  -0.018812727994512, -0.000822519029875,
        -0.008244964437927, -0.015121830106414, -0.057322374687495, 0.003235131901784,  -0.037220982183113, -0.010809853554400, -0.100051917186872,
        -0.048000293615011, -0.171124222350124, -0.064496310747964, 0.010898520600424,  0.006668098622365,  -0.026116620997535, -0.013797981215943,
        -0.007096366820800, -0.011236344596122, -0.002683658844411, 0.013603760921708,  -0.007950627816421, -0.004962124871150, 0.017307678576384,
        0.002785846006290,  -0.064716704084707, -0.058169190497974, 0.051142849487500,  -0.011698036894401, -0.009913814181669, -0.007964782747539,
        -0.009024515308442, -0.024515322944216, 0.046975392716835,  0.042558532922744,  -0.006177313917832, -0.005545468543665, 0.003397866114446,
        -0.003612937624643, -0.036334548437547, 0.045384454383070,  -0.004536894779548, -0.007357643743774, -0.007850084666908, 0.006524004508580,
        0.000000000000000,  0.000000000000000,  0.002543502174088,  0.000182003197913,  0.000000000000000,  0.000000000000000,  0.057682551111344,
        0.036250141800009,  0.000000000000000,  0.000000000000000,  -0.034204619902685, -0.022900464996518, 0.000000000000000,  0.000000000000000,
        0.074408471133706,  0.016501576804035,  -0.000000000000000, 0.000000000000000,  -0.001511918633801, -0.007576455033305, 0.000000000000000,
        0.000000000000000,  -0.031509259059135, -0.023651557988638, 0.350383804386655,  0.257083807758544,  -0.046639928621393, 0.014731680273793,
        0.000000000000000,  0.000000000000000,  0.001297703204075,  0.000151096724911,  0.000000000000000,  0.000000000000000,  0.038482049433143,
        0.029101961183648,  0.000000000000000,  0.000000000000000,  -0.018207800579963, -0.019896318783728, 0.000000000000000,  0.000000000000000,
        0.034031601019435,  0.011934526922907,  0.000000000000000,  -0.000000000000000, -0.001810702941391, -0.006712649787782, 0.000000000000000,
        0.000000000000000,  -0.022798307031129, -0.019073378210753, 0.194835688051797,  0.194531854824317,  -0.025581788794199, 0.023966472334395,
        -0.002231597162138, -0.001060339623905, 0.003990931400685,  0.002926962626918,  -0.094778614976006, -0.057419627622772, 0.242825477514219,
        0.135259118018618,  0.088125259066021,  0.038840309943256,  0.121046154315676,  0.065680489497885,  -0.160045935119199, -0.064590403916769,
        -0.043899001583103, -0.034464482093566, 0.009459390916373,  0.005609169057389,  0.070537793446074,  0.039268252180976,  0.049983445717402,
        0.032822904153343,  -0.145134795008025, -0.078770602450118, 0.037743963351298,  0.019910594535113,  -0.139011105098108, -0.070118124578984,
        -0.000044015072444, -0.000032109718550, 0.001694084915403,  0.001276557172024,  -0.100104223644032, -0.069203513947952, 0.077901876754593,
        0.058633981602301,  0.021231751816271,  0.003509432723176,  0.037516912795347,  -0.002277058860505, -0.028134526039424, -0.013358512762005,
        -0.020155184149006, -0.032619313144149, 0.007278515212522,  0.001051604569972,  0.022444168709352,  -0.000532240679454, 0.065203171268132,
        0.045265577115601,  -0.045356293961940, -0.035325129047081, -0.003037446546853, -0.003983134188851, -0.040248512150681, -0.013920408286978,
        0.000000000000000,  0.000000000000000,  -0.011172495016510, -0.010901835696634, 0.000000000000000,  0.000000000000000,  0.031740660602899,
        0.003201311111037,  0.000000000000000,  0.000000000000000,  0.002387930367435,  -0.000062896449401, -0.000000000000000, 0.000000000000001,
        0.014353051361644,  0.000275532673405,  0.000000000000000,  0.000000000000000,  -0.024604771397595, -0.001359999390211, 0.000000000000000,
        -0.000000000000000, 0.010020021490870,  0.001292181327646,  0.000000000000000,  0.000000000000000,  0.006128297194329,  0.007230647833298,
        0.000000000000000,  0.000000000000000,  -0.017805500166742, -0.016581364914718, 0.000000000000000,  0.000000000000000,  0.026177556418585,
        0.003246062271369,  0.000000000000000,  0.000000000000000,  0.000740618707259,  -0.000076868431068, 0.000000000000000,  0.000000000000000,
        0.008150757266840,  0.000177976859222,  0.000000000000000,  0.000000000000000,  -0.016086626023593, -0.001479806172187, 0.000000000000000,
        -0.000000000000000, 0.009330654378625,  0.001318419562605,  0.000000000000000,  0.000000000000000,  0.011157704131271,  0.011015265174740,
        0.014008363127110,  0.019705227467327,  0.132789277653934,  0.072086236413348,  -0.101156934776608, -0.075914746471205, 0.059760990684086,
        0.035626747621670,  -0.008995396921282, -0.002059831198103, 0.013043098972243,  0.008551972018418,  -0.073704492102127, -0.039367911634988,
        -0.010083275332550, -0.007480701446960, 0.123176613136825,  0.072853373196407,  0.012145944936099,  0.007221629606214,  -0.030844422533938,
        -0.026209878755205, 0.014965786955260,  0.007558389892851,  -0.007097812889304, -0.011997369818648, -0.091885818125601, -0.050650843679437,
        0.024533013855323,  0.031409806601562,  0.041683743772027,  0.057222826152703,  -0.088545855268081, -0.077415170281508, 0.020566480326861,
        0.017085067287216,  0.004590157033335,  0.003919769845446,  0.004913338507546,  0.000873248687373,  -0.018537489704472, -0.013886244758001,
        -0.004360607026458, -0.006118171247094, 0.047302592946113,  0.037234003645057,  0.004124075666656,  -0.001774849452500, -0.035638799953965,
        -0.031374178014094, 0.004352281098126,  0.003941044173965,  -0.016262606331298, -0.020856782655438, -0.029293738617557, -0.039507309650397};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 36, 28));
}

TEST_F(CElectricFieldIntegralsDriverTest, ComputeGGForLiH)
{
    CElectricFieldIntegralsDriver efdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix efxmat(36, 36);

    CDenseMatrix efymat(36, 36);

    CDenseMatrix efzmat(36, 36);

    // set up point dipoles data

    auto dipoles = CMemBlock2D<double>({1.0, 1.0, 1.0}, 1, 3);

    auto coords = CMemBlock2D<double>({0.0, 0.0, 0.0}, 1, 3);

    efdrv.compute(efxmat.values(), efymat.values(), efzmat.values(), &dipoles, &coords, bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.009200504946910, -0.026582589964473, 0.000000000000000,  0.000000000000000,  0.040653889625951,
        -0.021373412961327, 0.000000000000000,  0.000000000000000,  -0.016053647316943, 0.032133409967155,  0.000000000000000,  0.000000000000000,
        0.074871120921115,  0.028389377128536,  0.000000000000000,  0.000000000000000,  -0.005156828525852, 0.004816771858517,  0.000000000000000,
        0.000000000000000,  -0.086829409245215, -0.051711061340082, 0.000000000000000,  0.000000000000000,  0.049295716857109,  0.062638589374293,
        0.000000000000000,  0.000000000000000,  -0.039367851328221, -0.018489054147461, 0.000000000000000,  0.000000000000000,  0.020203937873004,
        0.071269235666504,  0.000000000000000,  0.000000000000000,  -0.004195640637643, -0.019868227826089, 0.000000000000000,  0.000000000000000,
        0.019929468845557,  -0.027895585262099, 0.000000000000000,  0.000000000000000,  -0.011986909263267, 0.025111654062729,  0.000000000000000,
        0.000000000000000,  0.037346808426347,  0.022565499355184,  0.000000000000000,  0.000000000000000,  -0.006031422504852, 0.002862562328938,
        0.000000000000000,  0.000000000000000,  -0.036398683162733, -0.039188955665842, 0.000000000000000,  0.000000000000000,  0.042052164267522,
        0.056544655976342,  0.000000000000000,  0.000000000000000,  -0.039365060215501, -0.024529107367114, 0.000000000000000,  0.000000000000000,
        0.026964903993707,  0.079080753074899,  -0.009200504946910, -0.004195640637643, 0.058233044978300,  0.011719357687303,  -0.047698157884713,
        -0.031106445507615, -0.053063891203945, -0.028131516669772, 0.009931806758402,  -0.008115461964188, -0.018424738507440, -0.009309649078552,
        -0.010927456271837, -0.010672600510712, -0.011716593644894, -0.006936747688676, -0.010393733351583, -0.009682899099367, 0.007775438310305,
        0.003423570646675,  0.015618801473801,  0.025720366092043,  0.003256887546066,  0.001065715983517,  -0.011982200225467, -0.013373713195211,
        0.006333343402898,  0.001026886330486,  0.039034551599697,  0.018944514738998,  0.022858925282315,  0.005782533778582,  -0.019194874739954,
        -0.026731884481776, -0.000699375100736, -0.000591023819759, -0.026582589964473, -0.019868227826089, 0.011719357687303,  -0.002121855101584,
        -0.016656042578759, -0.008794577590652, -0.028131516669772, -0.051042713938318, 0.012323208131064,  0.003939444722205,  -0.009309649078552,
        -0.007702920102007, 0.002525000838695,  -0.000021505217218, -0.006936747688676, -0.006431129880203, 0.002390511406758,  0.000770719457323,
        0.003423570646675,  0.002832510484999,  -0.010845221684056, -0.002446685289704, 0.001065715983517,  0.004134581356708,  -0.006763077008276,
        -0.010652798342162, 0.001026886330486,  -0.002911800424142, 0.040131911141760,  0.031222593654908,  0.005782533778582,  -0.000656625547777,
        -0.071108284302225, -0.078988835242539, -0.000591023819759, -0.000750656885378, 0.000000000000000,  0.000000000000000,  -0.047698157884713,
        -0.016656042578759, 0.000000000000000,  0.000000000000000,  0.018161488494284,  0.012535641459957,  0.000000000000000,  0.000000000000000,
        -0.026862519793974, -0.033723287116809, 0.000000000000000,  0.000000000000000,  0.055506609876292,  0.017536019034869,  0.000000000000000,
        0.000000000000000,  0.010999262410781,  -0.025503637184933, 0.000000000000000,  0.000000000000000,  -0.015470714488813, 0.031876455902148,
        0.000000000000000,  0.000000000000000,  0.020347120700789,  -0.000315540806457, 0.000000000000000,  0.000000000000000,  -0.071488876803345,
        -0.034394298861068, 0.000000000000000,  0.000000000000000,  -0.038728771763216, -0.040408374263992, 0.000000000000000,  0.000000000000000,
        -0.031106445507615, -0.008794577590652, 0.000000000000000,  0.000000000000000,  0.004369116734401,  0.006416442801730,  0.000000000000000,
        0.000000000000000,  -0.014915509058920, -0.039401180234531, 0.000000000000000,  0.000000000000000,  0.025928082937429,  0.016296632678218,
        0.000000000000000,  0.000000000000000,  -0.009190106595855, -0.024879853448368, 0.000000000000000,  0.000000000000000,  0.000984174358246,
        0.032046974062891,  0.000000000000000,  0.000000000000000,  0.018500359628808,  -0.001599680763026, 0.000000000000000,  0.000000000000000,
        -0.050941838160975, -0.025531621758902, 0.000000000000000,  0.000000000000000,  -0.018261700715910, -0.031349505121270, 0.040653889625951,
        0.019929468845557,  -0.053063891203945, -0.028131516669772, 0.018161488494284,  0.004369116734401,  0.075897575146838,  0.007772935825109,
        0.040688665053409,  0.019933113288318,  -0.131731396706300, -0.085506857393820, -0.017779063552869, -0.013365270354291, -0.036532057389768,
        -0.029337983084799, 0.035966540185756,  0.017481422576897,  0.076916753006715,  0.046107595759429,  -0.021160116995705, -0.018590697798442,
        -0.005752704244776, -0.011751147019270, -0.051138051894004, -0.018953065524316, 0.072002434286108,  0.030912694422493,  0.058083628484308,
        0.048798763713657,  0.029317846441460,  0.020571204829397,  0.037796804242195,  0.039227606740563,  -0.013339703151078, 0.000114242445987,
        -0.021373412961327, -0.027895585262099, -0.028131516669772, -0.051042713938318, 0.012535641459957,  0.006416442801730,  0.007772935825109,
        -0.017389812476720, 0.016224106130433,  0.020987538353527,  -0.085506857393820, -0.120993248515415, -0.011648801486115, -0.011836203467237,
        -0.029337983084799, -0.026042143963817, 0.013600103865345,  0.013504186035457,  0.046107595759429,  0.059933847283273,  -0.015859061106523,
        -0.016595876648619, -0.011751147019270, -0.008239412106954, -0.009527665226125, -0.007098401414933, 0.030912694422493,  0.023817454937811,
        0.033019861342507,  0.024897800941838,  0.020571204829397,  0.022523772618860,  0.018029463662737,  0.024265339036455,  0.000114242445987,
        0.006066603272072,  0.000000000000000,  0.000000000000000,  0.009931806758402,  0.012323208131064,  0.000000000000000,  0.000000000000000,
        0.040688665053409,  0.016224106130433,  0.000000000000000,  0.000000000000000,  0.002919854228679,  0.003319040273213,  0.000000000000000,
        0.000000000000000,  0.052008891529176,  -0.001750583164584, 0.000000000000000,  0.000000000000000,  -0.035065654056133, 0.005681709234057,
        0.000000000000000,  0.000000000000000,  0.017554110765869,  0.021052879666674,  0.000000000000000,  0.000000000000000,  -0.042172973555331,
        -0.045511814517120, 0.000000000000000,  0.000000000000000,  0.029007742981761,  0.006292549820286,  0.000000000000000,  0.000000000000000,
        0.010537555993855,  0.004063380016421,  0.000000000000000,  0.000000000000000,  -0.008115461964188, 0.003939444722205,  0.000000000000000,
        0.000000000000000,  0.019933113288318,  0.020987538353527,  0.000000000000000,  0.000000000000000,  -0.008628256832805, -0.001632630691313,
        0.000000000000000,  0.000000000000000,  0.025556187881480,  -0.012918532490687, 0.000000000000000,  0.000000000000000,  -0.008911441083798,
        0.011561147191046,  0.000000000000000,  0.000000000000000,  0.014399174249552,  0.020068106407862,  0.000000000000000,  0.000000000000000,
        -0.040505270802844, -0.041389733235825, 0.000000000000000,  0.000000000000000,  0.012844610661006,  0.004868381674882,  0.000000000000000,
        0.000000000000000,  0.016513995695816,  0.009256813586714,  -0.016053647316943, -0.011986909263267, -0.018424738507440, -0.009309649078552,
        -0.026862519793974, -0.014915509058920, -0.131731396706300, -0.085506857393820, 0.002919854228679,  -0.008628256832805, 0.076840510003414,
        -0.030063468862912, -0.006508737494489, -0.008477697116928, 0.004720178293812,  -0.015733063498998, 0.002820971274955,  -0.001965464386698,
        0.102834877170092,  0.070544821879081,  0.035476750287020,  0.009110589821758,  0.023374984567491,  -0.013531574162260, 0.038241561040489,
        0.037322079327920,  -0.078675895750934, -0.043054881646308, -0.050581265833494, -0.025236593798486, -0.033527799131505, 0.004881009900800,
        -0.073265247860719, -0.048756387029603, 0.019646496241271,  0.017681586974035,  0.032133409967155,  0.025111654062729,  -0.009309649078552,
        -0.007702920102007, -0.033723287116809, -0.039401180234531, -0.085506857393820, -0.120993248515415, 0.003319040273213,  -0.001632630691313,
        -0.030063468862912, -0.087951853574087, 0.012532026059038,  0.017343594277167,  -0.015733063498998, -0.064564739799143, -0.023707795989162,
        -0.020375475307588, 0.070544821879081,  0.106351398329052,  -0.012818143843314, -0.014953990115594, -0.013531574162260, -0.038652908573307,
        0.046837070601394,  0.042122815944263,  -0.043054881646308, -0.034768150689820, 0.000385395968329,  0.002435381851068,  0.004881009900800,
        0.025912810447689,  -0.067536103892916, -0.059583139214364, 0.017681586974035,  0.022823286387335,  0.000000000000000,  0.000000000000000,
        -0.010927456271837, 0.002525000838695,  0.000000000000000,  0.000000000000000,  -0.017779063552869, -0.011648801486115, 0.000000000000000,
        0.000000000000000,  -0.006508737494489, 0.012532026059038,  0.000000000000000,  0.000000000000000,  0.002548487966404,  -0.010216298570502,
        0.000000000000000,  0.000000000000000,  -0.023638546891849, 0.011221119481902,  0.000000000000000,  0.000000000000000,  0.011644251481126,
        -0.017241778521254, 0.000000000000000,  0.000000000000000,  0.000662619093442,  -0.000325188117215, 0.000000000000000,  0.000000000000000,
        0.021627550290156,  0.017939829934248,  0.000000000000000,  0.000000000000000,  -0.018206310664629, 0.006122870418265,  0.000000000000000,
        0.000000000000000,  -0.010672600510712, -0.000021505217218, 0.000000000000000,  0.000000000000000,  -0.013365270354291, -0.011836203467237,
        0.000000000000000,  0.000000000000000,  -0.008477697116928, 0.017343594277167,  0.000000000000000,  0.000000000000000,  -0.000733391662263,
        -0.011492851339168, 0.000000000000000,  0.000000000000000,  -0.005114724462992, 0.012074490469497,  0.000000000000000,  0.000000000000000,
        -0.002400302175122, -0.018999377721343, 0.000000000000000,  0.000000000000000,  -0.000925524626827, -0.000555196003451, 0.000000000000000,
        0.000000000000000,  0.017464623384106,  0.018112049873669,  0.000000000000000,  0.000000000000000,  -0.021003014219671, 0.000159403546729,
        0.074871120921115,  0.037346808426347,  -0.011716593644894, -0.006936747688676, 0.055506609876292,  0.025928082937429,  -0.036532057389768,
        -0.029337983084799, 0.052008891529176,  0.025556187881480,  0.004720178293812,  -0.015733063498998, 0.002548487966404,  -0.000733391662263,
        0.450424942876274,  0.196670750540976,  0.004768700270444,  0.002976291040797,  0.075946020008391,  0.042872047208265,  -0.026353834199465,
        0.002593148071993,  -0.006103570320081, -0.016264844734698, -0.029657459011064, -0.018282287145882, -0.203864837820302, -0.108829498950656,
        0.000401476557554,  -0.010424083198347, -0.049986597840350, -0.021047218549364, 0.032390787363180,  0.016511829130521,  -0.004264942648725,
        0.000511397837226,  0.028389377128536,  0.022565499355184,  -0.006936747688676, -0.006431129880203, 0.017536019034869,  0.016296632678218,
        -0.029337983084799, -0.026042143963817, -0.001750583164584, -0.012918532490687, -0.015733063498998, -0.064564739799143, -0.010216298570502,
        -0.011492851339168, 0.196670750540976,  0.173965261566007,  -0.008546097881216, -0.010315753752856, 0.042872047208265,  0.045881569161196,
        0.030184558345288,  0.027229809365945,  -0.016264844734698, -0.058878267649371, -0.001692188814728, 0.000595062425388,  -0.108829498950656,
        -0.102087869409193, -0.033452993366672, -0.033575530002848, -0.021047218549364, -0.016754767010682, 0.039198992264276,  0.030682963740305,
        0.000511397837226,  -0.001965940823315, 0.000000000000000,  0.000000000000000,  -0.010393733351583, 0.002390511406758,  0.000000000000000,
        0.000000000000000,  0.035966540185756,  0.013600103865345,  0.000000000000000,  0.000000000000000,  0.002820971274955,  -0.023707795989162,
        0.000000000000000,  0.000000000000000,  0.004768700270444,  -0.008546097881216, 0.000000000000000,  0.000000000000000,  0.017564806993548,
        -0.006577436975877, 0.000000000000000,  0.000000000000000,  -0.069459664720687, -0.001023875874101, 0.000000000000000,  0.000000000000000,
        0.017877889866522,  -0.014674155420835, 0.000000000000000,  0.000000000000000,  -0.011355609817321, -0.003005782311995, 0.000000000000000,
        0.000000000000000,  0.014216157963759,  -0.008855541937689, 0.000000000000000,  0.000000000000000,  -0.009682899099367, 0.000770719457323,
        0.000000000000000,  0.000000000000000,  0.017481422576897,  0.013504186035457,  0.000000000000000,  0.000000000000000,  -0.001965464386698,
        -0.020375475307588, 0.000000000000000,  0.000000000000000,  0.002976291040797,  -0.010315753752856, 0.000000000000000,  0.000000000000000,
        0.001309976180236,  -0.010416338397348, 0.000000000000000,  0.000000000000000,  -0.045069187058020, 0.011896574940691,  0.000000000000000,
        0.000000000000000,  0.002562191450078,  -0.013362680984769, 0.000000000000000,  0.000000000000000,  -0.006837942520471, -0.003407337947232,
        0.000000000000000,  0.000000000000000,  0.019133404319660,  -0.003601305902122, -0.005156828525852, -0.006031422504852, 0.007775438310305,
        0.003423570646675,  0.010999262410781,  -0.009190106595855, 0.076916753006715,  0.046107595759429,  -0.035065654056133, -0.008911441083798,
        0.102834877170092,  0.070544821879081,  -0.023638546891849, -0.005114724462992, 0.075946020008391,  0.042872047208265,  0.017564806993548,
        0.001309976180236,  0.226627655938590,  0.076348132495578,  0.050020460519289,  0.041776712575439,  0.011902671413684,  0.010009140872234,
        -0.009218125022050, 0.004072587508289,  0.086753973297372,  0.040217265953286,  -0.036479841927779, -0.010640230283887, -0.015415108100669,
        -0.016987010881862, -0.087965962474853, -0.035216763655921, -0.018273006416650, -0.012605806497799, 0.004816771858517,  0.002862562328938,
        0.003423570646675,  0.002832510484999,  -0.025503637184933, -0.024879853448368, 0.046107595759429,  0.059933847283273,  0.005681709234057,
        0.011561147191046,  0.070544821879081,  0.106351398329052,  0.011221119481902,  0.012074490469497,  0.042872047208265,  0.045881569161196,
        -0.006577436975877, -0.010416338397348, 0.076348132495578,  0.063650406990667,  0.006900033816737,  -0.008875385820237, 0.010009140872234,
        0.000987144607989,  0.011443161952696,  0.012973702486330,  0.040217265953286,  0.052338757424769,  0.010680802519307,  0.010763072854001,
        -0.016987010881862, -0.028298950309597, -0.032447261382515, -0.023213707414864, -0.012605806497799, -0.016026805564575, 0.000000000000000,
        0.000000000000000,  0.015618801473801,  -0.010845221684056, 0.000000000000000,  0.000000000000000,  -0.021160116995705, -0.015859061106523,
        0.000000000000000,  0.000000000000000,  0.035476750287020,  -0.012818143843314, 0.000000000000000,  0.000000000000000,  -0.026353834199465,
        0.030184558345288,  0.000000000000000,  0.000000000000000,  0.050020460519289,  0.006900033816737,  0.000000000000000,  0.000000000000000,
        0.006299400008813,  -0.004911151841347, 0.000000000000000,  0.000000000000000,  -0.019700430956486, 0.017092467845769,  0.000000000000000,
        0.000000000000000,  -0.058032016462997, -0.018778949620809, 0.000000000000000,  0.000000000000000,  -0.002199154873286, -0.002069457828947,
        0.000000000000000,  0.000000000000000,  0.025720366092043,  -0.002446685289704, 0.000000000000000,  0.000000000000000,  -0.018590697798442,
        -0.016595876648619, 0.000000000000000,  0.000000000000000,  0.009110589821758,  -0.014953990115594, 0.000000000000000,  0.000000000000000,
        0.002593148071993,  0.027229809365945,  0.000000000000000,  0.000000000000000,  0.041776712575439,  -0.008875385820237, 0.000000000000000,
        0.000000000000000,  -0.002858533179344, -0.009056738144591, 0.000000000000000,  0.000000000000000,  -0.014495035313714, 0.022241953083715,
        0.000000000000000,  0.000000000000000,  -0.027013098143194, -0.016898473297249, 0.000000000000000,  0.000000000000000,  0.000499584796227,
        -0.001992545316495, -0.086829409245215, -0.036398683162733, 0.003256887546066,  0.001065715983517,  -0.015470714488813, 0.000984174358246,
        -0.005752704244776, -0.011751147019270, 0.017554110765869,  0.014399174249552,  0.023374984567491,  -0.013531574162260, 0.011644251481126,
        -0.002400302175122, -0.006103570320081, -0.016264844734698, -0.069459664720687, -0.045069187058020, 0.011902671413684,  0.010009140872234,
        0.006299400008813,  -0.002858533179344, 0.115072552575562,  0.013392247630558,  0.050615228281406,  0.024557674487625,  -0.087583900836635,
        -0.051081386797797, 0.009587716936175,  0.020639332794906,  -0.004712789925038, 0.001279819968393,  0.039521136988073,  0.027328092142377,
        -0.000550366983650, 0.001528773798585,  -0.051711061340082, -0.039188955665842, 0.001065715983517,  0.004134581356708,  0.031876455902148,
        0.032046974062891,  -0.011751147019270, -0.008239412106954, 0.021052879666674,  0.020068106407862,  -0.013531574162260, -0.038652908573307,
        -0.017241778521254, -0.018999377721343, -0.016264844734698, -0.058878267649371, -0.001023875874101, 0.011896574940691,  0.010009140872234,
        0.000987144607989,  -0.004911151841347, -0.009056738144591, 0.013392247630558,  -0.026686745551452, -0.006456664620709, -0.019155767641260,
        -0.051081386797797, -0.066482146579379, 0.025082349223138,  0.024418014893574,  0.001279819968393,  0.008805970892527,  0.016786371418867,
        0.014962852737134,  0.001528773798585,  0.000315543199280,  0.000000000000000,  0.000000000000000,  -0.011982200225467, -0.006763077008276,
        0.000000000000000,  0.000000000000000,  -0.051138051894004, -0.009527665226125, 0.000000000000000,  0.000000000000000,  0.038241561040489,
        0.046837070601394,  0.000000000000000,  0.000000000000000,  -0.029657459011064, -0.001692188814728, 0.000000000000000,  0.000000000000000,
        -0.009218125022050, 0.011443161952696,  0.000000000000000,  0.000000000000000,  0.050615228281406,  -0.006456664620709, 0.000000000000000,
        0.000000000000000,  -0.026908696023645, -0.000633929128941, 0.000000000000000,  0.000000000000000,  0.029352508610938,  0.012746449436484,
        0.000000000000000,  0.000000000000000,  0.014197308215079,  0.012940669203404,  0.000000000000000,  0.000000000000000,  -0.013373713195211,
        -0.010652798342162, 0.000000000000000,  0.000000000000000,  -0.018953065524316, -0.007098401414933, 0.000000000000000,  0.000000000000000,
        0.037322079327920,  0.042122815944263,  0.000000000000000,  0.000000000000000,  -0.018282287145882, 0.000595062425388,  0.000000000000000,
        0.000000000000000,  0.004072587508289,  0.012973702486330,  0.000000000000000,  0.000000000000000,  0.024557674487625,  -0.019155767641260,
        0.000000000000000,  0.000000000000000,  -0.015119222052367, -0.004605084272078, 0.000000000000000,  0.000000000000000,  0.018334114116526,
        0.018596517684964,  0.000000000000000,  0.000000000000000,  -0.006816190559191, 0.004310763179683,  0.049295716857109,  0.042052164267522,
        0.006333343402898,  0.001026886330486,  0.020347120700789,  0.018500359628808,  0.072002434286108,  0.030912694422493,  -0.042172973555331,
        -0.040505270802844, -0.078675895750934, -0.043054881646308, 0.000662619093442,  -0.000925524626827, -0.203864837820302, -0.108829498950656,
        0.017877889866522,  0.002562191450078,  0.086753973297372,  0.040217265953286,  -0.019700430956486, -0.014495035313714, -0.087583900836635,
        -0.051081386797797, -0.026908696023645, -0.015119222052367, 0.250502253009014,  0.100837026906071,  -0.041341157319166, -0.014998209866545,
        -0.028368502085455, -0.018007129240518, -0.006363034134319, -0.008316591935715, -0.013966641905431, -0.008277914076732, 0.062638589374293,
        0.056544655976342,  0.001026886330486,  -0.002911800424142, -0.000315540806457, -0.001599680763026, 0.030912694422493,  0.023817454937811,
        -0.045511814517120, -0.041389733235825, -0.043054881646308, -0.034768150689820, -0.000325188117215, -0.000555196003451, -0.108829498950656,
        -0.102087869409193, -0.014674155420835, -0.013362680984769, 0.040217265953286,  0.052338757424769,  0.017092467845769,  0.022241953083715,
        -0.051081386797797, -0.066482146579379, -0.000633929128941, -0.004605084272078, 0.100837026906071,  0.076850377741479,  -0.033446010362510,
        -0.038395173695946, -0.018007129240518, -0.052948870513741, 0.033280214683113,  0.025878567750845,  -0.008277914076732, -0.008997420074428,
        0.000000000000000,  0.000000000000000,  0.039034551599697,  0.040131911141760,  0.000000000000000,  0.000000000000000,  0.058083628484308,
        0.033019861342507,  0.000000000000000,  0.000000000000000,  -0.050581265833494, 0.000385395968329,  0.000000000000000,  0.000000000000000,
        0.000401476557554,  -0.033452993366672, 0.000000000000000,  0.000000000000000,  -0.036479841927779, 0.010680802519307,  0.000000000000000,
        0.000000000000000,  0.009587716936175,  0.025082349223138,  0.000000000000000,  0.000000000000000,  -0.041341157319166, -0.033446010362510,
        0.000000000000000,  0.000000000000000,  0.025382398076431,  0.012859235729934,  0.000000000000000,  0.000000000000000,  -0.044752825755637,
        -0.015900257851009, 0.000000000000000,  0.000000000000000,  0.018944514738998,  0.031222593654908,  0.000000000000000,  0.000000000000000,
        0.048798763713657,  0.024897800941838,  0.000000000000000,  0.000000000000000,  -0.025236593798486, 0.002435381851068,  0.000000000000000,
        0.000000000000000,  -0.010424083198347, -0.033575530002848, 0.000000000000000,  0.000000000000000,  -0.010640230283887, 0.010763072854001,
        0.000000000000000,  0.000000000000000,  0.020639332794906,  0.024418014893574,  0.000000000000000,  0.000000000000000,  -0.014998209866545,
        -0.038395173695946, 0.000000000000000,  0.000000000000000,  0.006658510698181,  0.006577777313910,  0.000000000000000,  0.000000000000000,
        -0.031126104619325, -0.008410567937295, -0.039367851328221, -0.039365060215501, 0.022858925282315,  0.005782533778582,  -0.071488876803345,
        -0.050941838160975, 0.029317846441460,  0.020571204829397,  0.029007742981761,  0.012844610661006,  -0.033527799131505, 0.004881009900800,
        0.021627550290156,  0.017464623384106,  -0.049986597840350, -0.021047218549364, -0.011355609817321, -0.006837942520471, -0.015415108100669,
        -0.016987010881862, -0.058032016462997, -0.027013098143194, -0.004712789925038, 0.001279819968393,  0.029352508610938,  0.018334114116526,
        -0.028368502085455, -0.018007129240518, 0.025382398076431,  0.006658510698181,  0.083872140564465,  0.009016330138985,  0.048211954589936,
        0.021925805335879,  -0.064975083590935, -0.037046429384736, -0.018489054147461, -0.024529107367114, 0.005782533778582,  -0.000656625547777,
        -0.034394298861068, -0.025531621758902, 0.020571204829397,  0.022523772618860,  0.006292549820286,  0.004868381674882,  0.004881009900800,
        0.025912810447689,  0.017939829934248,  0.018112049873669,  -0.021047218549364, -0.016754767010682, -0.003005782311995, -0.003407337947232,
        -0.016987010881862, -0.028298950309597, -0.018778949620809, -0.016898473297249, 0.001279819968393,  0.008805970892527,  0.012746449436484,
        0.018596517684964,  -0.018007129240518, -0.052948870513741, 0.012859235729934,  0.006577777313910,  0.009016330138985,  -0.021189948317626,
        -0.020167550718272, -0.027175218460377, -0.037046429384736, -0.061251116199889, 0.000000000000000,  0.000000000000000,  -0.019194874739954,
        -0.071108284302225, 0.000000000000000,  0.000000000000000,  0.037796804242195,  0.018029463662737,  0.000000000000000,  0.000000000000000,
        -0.073265247860719, -0.067536103892916, 0.000000000000000,  0.000000000000000,  0.032390787363180,  0.039198992264276,  0.000000000000000,
        0.000000000000000,  -0.087965962474853, -0.032447261382515, 0.000000000000000,  0.000000000000000,  0.039521136988073,  0.016786371418867,
        0.000000000000000,  0.000000000000000,  -0.006363034134319, 0.033280214683113,  0.000000000000000,  0.000000000000000,  0.048211954589936,
        -0.020167550718272, 0.000000000000000,  0.000000000000000,  -0.008288971707116, -0.026357354764314, 0.000000000000000,  0.000000000000000,
        -0.026731884481776, -0.078988835242539, 0.000000000000000,  0.000000000000000,  0.039227606740563,  0.024265339036455,  0.000000000000000,
        0.000000000000000,  -0.048756387029603, -0.059583139214364, 0.000000000000000,  0.000000000000000,  0.016511829130521,  0.030682963740305,
        0.000000000000000,  0.000000000000000,  -0.035216763655921, -0.023213707414864, 0.000000000000000,  0.000000000000000,  0.027328092142377,
        0.014962852737134,  0.000000000000000,  0.000000000000000,  -0.008316591935715, 0.025878567750845,  0.000000000000000,  0.000000000000000,
        0.021925805335879,  -0.027175218460377, 0.000000000000000,  0.000000000000000,  -0.004110312519810, -0.019744032743757, 0.020203937873004,
        0.026964903993707,  -0.000699375100736, -0.000591023819759, -0.038728771763216, -0.018261700715910, -0.013339703151078, 0.000114242445987,
        0.010537555993855,  0.016513995695816,  0.019646496241271,  0.017681586974035,  -0.018206310664629, -0.021003014219671, -0.004264942648725,
        0.000511397837226,  0.014216157963759,  0.019133404319660,  -0.018273006416650, -0.012605806497799, -0.002199154873286, 0.000499584796227,
        -0.000550366983650, 0.001528773798585,  0.014197308215079,  -0.006816190559191, -0.013966641905431, -0.008277914076732, -0.044752825755637,
        -0.031126104619325, -0.064975083590935, -0.037046429384736, -0.008288971707116, -0.004110312519810, 0.054386352310510,  0.009110546852977,
        0.071269235666504,  0.079080753074899,  -0.000591023819759, -0.000750656885378, -0.040408374263992, -0.031349505121270, 0.000114242445987,
        0.006066603272072,  0.004063380016421,  0.009256813586714,  0.017681586974035,  0.022823286387335,  0.006122870418265,  0.000159403546729,
        0.000511397837226,  -0.001965940823315, -0.008855541937689, -0.003601305902122, -0.012605806497799, -0.016026805564575, -0.002069457828947,
        -0.001992545316495, 0.001528773798585,  0.000315543199280,  0.012940669203404,  0.004310763179683,  -0.008277914076732, -0.008997420074428,
        -0.015900257851009, -0.008410567937295, -0.037046429384736, -0.061251116199889, -0.026357354764314, -0.019744032743757, 0.009110546852977,
        -0.004813743601761};

    ASSERT_EQ(efxmat, CDenseMatrix(intxvals, 36, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.012804184993112, -0.039628438196655, 0.000000000000000,  0.000000000000000,  -0.040877165823341,
        -0.018520210502723, 0.000000000000000,  0.000000000000000,  -0.058100617013444, -0.063924554056655, 0.000000000000000,  0.000000000000000,
        0.083746201612163,  0.044613296367419,  0.000000000000000,  0.000000000000000,  -0.097488549979364, -0.033099314889418, 0.000000000000000,
        0.000000000000000,  -0.019326558317290, 0.011075131961515,  0.000000000000000,  0.000000000000000,  0.081538141017913,  0.052055816865136,
        0.000000000000000,  0.000000000000000,  0.016072645236868,  -0.035383339078651, 0.000000000000000,  0.000000000000000,  -0.012384479852085,
        -0.047340513783358, 0.000000000000000,  0.000000000000000,  -0.006198916295806, -0.029666973245982, 0.000000000000000,  0.000000000000000,
        -0.040042180881789, -0.024558541819205, 0.000000000000000,  0.000000000000000,  -0.036135665677148, -0.055096033989294, 0.000000000000000,
        0.000000000000000,  0.049593623965539,  0.036899484420722,  0.000000000000000,  0.000000000000000,  -0.040717928091623, -0.023928617971041,
        0.000000000000000,  0.000000000000000,  -0.009601742336366, 0.008444323268692,  0.000000000000000,  0.000000000000000,  0.061177906607203,
        0.049129255774800,  0.000000000000000,  0.000000000000000,  -0.010815472848222, -0.047505991477479, 0.000000000000000,  0.000000000000000,
        -0.017724956040439, -0.052622057208778, -0.012804184993112, -0.006198916295806, 0.083169929111077,  0.014742307347095,  0.037525237104578,
        0.018267394072711,  0.018170159602396,  0.003505299958922,  0.001396138234148,  0.014492653547077,  0.017894067190832,  0.015909751277113,
        -0.014245283491472, -0.012520281715150, -0.007222857259483, -0.001163784608154, 0.010975353068835,  0.016604808370437,  -0.016484810486447,
        -0.012198288447840, -0.010927456271837, -0.010672600510712, -0.002787846143579, 0.000256698576121,  -0.023915175099142, -0.012938053731025,
        -0.001741427666622, -0.006805162721151, -0.012338810553152, -0.015617848465521, -0.049853084523888, -0.034665584645913, 0.013881395223221,
        0.018072902943216,  -0.001014085985587, -0.000862796994521, -0.039628438196655, -0.029666973245982, 0.014742307347095,  -0.006112400510020,
        0.040100754786498,  0.031193159202817,  0.003505299958922,  -0.001917305073180, -0.001597624526724, 0.005480338216482,  0.015909751277113,
        0.021090334373147,  0.001451855483509,  -0.001955569217600, -0.001163784608154, -0.003171043578453, -0.008575450527650, -0.003573158146549,
        -0.012198288447840, -0.016155874269482, 0.002525000838695,  -0.000021505217218, 0.000256698576121,  -0.000442833532897, -0.015850731692561,
        -0.014804623753713, -0.006805162721151, -0.011837662945198, 0.017658455128591,  0.017661386203831,  -0.034665584645913, -0.064041911737341,
        0.047577832862462,  0.052757668336180,  -0.000862796994521, -0.001101469268265, 0.000000000000000,  0.000000000000000,  0.037525237104578,
        0.040100754786498,  0.000000000000000,  0.000000000000000,  0.023283760762502,  0.018333472030314,  0.000000000000000,  0.000000000000000,
        0.024841691863425,  -0.000255239318712, 0.000000000000000,  0.000000000000000,  0.012358880799215,  -0.033186986309182, 0.000000000000000,
        0.000000000000000,  0.008439934342886,  0.010604350968483,  0.000000000000000,  0.000000000000000,  -0.062476394125414, 0.025887804958769,
        0.000000000000000,  0.000000000000000,  -0.022834102925008, -0.033886272095434, 0.000000000000000,  0.000000000000000,  0.042865752089830,
        0.022595667260858,  0.000000000000000,  0.000000000000000,  0.015309403618105,  -0.016902148946435, 0.000000000000000,  0.000000000000000,
        0.018267394072711,  0.031193159202817,  0.000000000000000,  0.000000000000000,  0.006095486709735,  0.009409791886989,  0.000000000000000,
        0.000000000000000,  0.020412983699397,  -0.001548289267435, 0.000000000000000,  0.000000000000000,  -0.006256580824536, -0.033113394625899,
        0.000000000000000,  0.000000000000000,  0.009736852822547,  0.010204734359194,  0.000000000000000,  0.000000000000000,  -0.016056673019338,
        0.027114521655909,  0.000000000000000,  0.000000000000000,  -0.001475191812478, -0.040202756178301, 0.000000000000000,  0.000000000000000,
        0.032765664568917,  0.016862539976165,  0.000000000000000,  0.000000000000000,  0.015609522115662,  -0.017276883915036, -0.040877165823341,
        -0.040042180881789, 0.018170159602396,  0.003505299958922,  0.023283760762502,  0.006095486709735,  0.137248187391325,  0.027409900127792,
        -0.048062228528758, -0.017660505398963, 0.090906868241717,  0.040190928479801,  0.037528336858306,  0.024247366620829,  0.013831773134803,
        0.012806039959805,  -0.016468312570172, -0.007466014033312, -0.038839855310965, -0.020119720879457, -0.017779063552869, -0.013365270354291,
        0.047319887175342,  0.025876304588783,  -0.011601114312266, 0.001908319262626,  -0.030859555914668, -0.029963983282352, -0.043515918101939,
        -0.033728070014171, -0.013538584450883, -0.007853651878986, -0.008489319337006, 0.012823142100395,  0.038020366576499,  0.025788785298099,
        -0.018520210502723, -0.024558541819205, 0.003505299958922,  -0.001917305073180, 0.018333472030314,  0.009409791886989,  0.027409900127792,
        -0.009633447875900, -0.009605795012496, -0.007150463984526, 0.040190928479801,  0.029246965136107,  0.018592000095665,  0.018532974023490,
        0.012806039959805,  0.006144018953012,  -0.006753124184136, -0.006532892288899, -0.020119720879457, -0.023614273871178, -0.011648801486115,
        -0.011836203467237, 0.025876304588783,  0.025206162946687,  0.006346715045487,  0.013738313775707,  -0.029963983282352, -0.067166202523933,
        -0.022347106208192, -0.016757075157661, -0.007853651878986, -0.006647114209068, 0.036589722776111,  0.048226850914638,  0.025788785298099,
        0.053854609084073,  0.000000000000000,  0.000000000000000,  0.001396138234148,  -0.001597624526724, 0.000000000000000,  0.000000000000000,
        -0.048062228528758, -0.009605795012496, 0.000000000000000,  0.000000000000000,  -0.009783113245113, 0.002101629129497,  0.000000000000000,
        0.000000000000000,  0.022124566398958,  0.018666460921926,  0.000000000000000,  0.000000000000000,  -0.034268623997966, -0.002100929072160,
        0.000000000000000,  0.000000000000000,  0.074819084191275,  0.000653915324667,  0.000000000000000,  0.000000000000000,  0.009811415012577,
        0.028923946916389,  0.000000000000000,  0.000000000000000,  -0.014854125580142, -0.009440327982754, 0.000000000000000,  0.000000000000000,
        0.021207446318634,  0.016352687363083,  0.000000000000000,  0.000000000000000,  0.014492653547077,  0.005480338216482,  0.000000000000000,
        0.000000000000000,  -0.017660505398963, -0.007150463984526, 0.000000000000000,  0.000000000000000,  -0.014763577970334, -0.004469570852609,
        0.000000000000000,  0.000000000000000,  0.016257027812149,  0.018383548871804,  0.000000000000000,  0.000000000000000,  -0.013643690130855,
        0.003656453748672,  0.000000000000000,  0.000000000000000,  0.040017321518632,  -0.012712518871820, 0.000000000000000,  0.000000000000000,
        0.021749040322278,  0.026383542149182,  0.000000000000000,  0.000000000000000,  -0.009860844654449, -0.015873423021271, 0.000000000000000,
        0.000000000000000,  0.010828229173741,  0.015024822035644,  -0.058100617013444, -0.036135665677148, 0.017894067190832,  0.015909751277113,
        0.024841691863425,  0.020412983699397,  0.090906868241717,  0.040190928479801,  -0.009783113245113, -0.014763577970334, 0.295343934551749,
        0.073043719437081,  0.034151512100136,  0.010961639075413,  0.142315707397634,  0.047769327917632,  -0.010424923521737, -0.004289156545909,
        0.054558593612899,  0.052270354559978,  -0.006508737494489, -0.008477697116928, 0.125048908631503,  0.049416143093261,  -0.043798274717970,
        -0.030135859764898, 0.060568632840673,  0.052572109239225,  -0.013737414590436, -0.008008934076424, 0.041298481695743,  0.051856932917242,
        -0.080264546688702, -0.061547693280931, -0.010955181046647, -0.000690051568723, -0.063924554056655, -0.055096033989294, 0.015909751277113,
        0.021090334373147,  -0.000255239318712, -0.001548289267435, 0.040190928479801,  0.029246965136107,  0.002101629129497,  -0.004469570852609,
        0.073043719437081,  -0.004248728827016, -0.012167767608884, -0.013843598108692, 0.047769327917632,  0.004347847123458,  -0.016675229560934,
        -0.013753626528358, 0.052270354559978,  0.085179528215213,  0.012532026059038,  0.017343594277167,  0.049416143093261,  0.002591503168199,
        -0.032641976495954, -0.029291490637543, 0.052572109239225,  0.074462833403267,  0.033867139362873,  0.040956149930588,  0.051856932917242,
        0.108522046096787,  -0.051165392129315, -0.048618742285847, -0.000690051568723, 0.005670126491594,  0.000000000000000,  0.000000000000000,
        -0.014245283491472, 0.001451855483509,  0.000000000000000,  0.000000000000000,  0.037528336858306,  0.018592000095665,  0.000000000000000,
        0.000000000000000,  0.034151512100136,  -0.012167767608884, 0.000000000000000,  0.000000000000000,  0.001627580481699,  -0.005449397096519,
        0.000000000000000,  0.000000000000000,  0.030321671442748,  0.016250966718322,  0.000000000000000,  0.000000000000000,  -0.022783569153990,
        0.021401259340525,  0.000000000000000,  0.000000000000000,  -0.009311345038162, -0.006681671407353, 0.000000000000000,  0.000000000000000,
        -0.025627773945854, 0.004810594787416,  0.000000000000000,  0.000000000000000,  0.003561226872429,  -0.007245630319929, 0.000000000000000,
        0.000000000000000,  -0.012520281715150, -0.001955569217600, 0.000000000000000,  0.000000000000000,  0.024247366620829,  0.018532974023490,
        0.000000000000000,  0.000000000000000,  0.010961639075413,  -0.013843598108692, 0.000000000000000,  0.000000000000000,  -0.002987585087288,
        -0.011825006504296, 0.000000000000000,  0.000000000000000,  0.037514442189612,  0.001186689571010,  0.000000000000000,  0.000000000000000,
        0.002595575169147,  0.019326606719024,  0.000000000000000,  0.000000000000000,  0.006131606606559,  -0.010242957990262, 0.000000000000000,
        0.000000000000000,  -0.001898764726788, 0.006997753381242,  0.000000000000000,  0.000000000000000,  0.012590498877526,  -0.002373023736582,
        0.083746201612163,  0.049593623965539,  -0.007222857259483, -0.001163784608154, 0.012358880799215,  -0.006256580824536, 0.013831773134803,
        0.012806039959805,  0.022124566398958,  0.016257027812149,  0.142315707397634,  0.047769327917632,  0.001627580481699,  -0.002987585087288,
        0.361386307636768,  0.113314550252079,  -0.065485747828650, -0.042588944524023, 0.075191021420677,  0.045735846879121,  0.002548487966404,
        -0.000733391662263, 0.121782605635562,  0.051307556047696,  -0.067148010433417, -0.037331092013334, 0.018546112517833,  0.036815656066392,
        0.006317210810660,  0.006308522477246,  -0.036580228846211, -0.006671494997794, -0.042578651224183, -0.014243109179595, -0.003382552982155,
        -0.001626025184682, 0.044613296367419,  0.036899484420722,  -0.001163784608154, -0.003171043578453, -0.033186986309182, -0.033113394625899,
        0.012806039959805,  0.006144018953012,  0.018666460921926,  0.018383548871804,  0.047769327917632,  0.004347847123458,  -0.005449397096519,
        -0.011825006504296, 0.113314550252079,  0.030439679894916,  -0.008145624108448, 0.003300113479978,  0.045735846879121,  0.039221785575652,
        -0.010216298570502, -0.011492851339168, 0.051307556047696,  0.007727687048483,  -0.010093060624541, 0.003134244608066,  0.036815656066392,
        0.080775922183483,  -0.018384082698295, -0.018967420904866, -0.006671494997794, 0.001903816338733,  -0.023824988350091, -0.017233245055211,
        -0.001626025184682, 0.000639965097489,  0.000000000000000,  0.000000000000000,  0.010975353068835,  -0.008575450527650, 0.000000000000000,
        0.000000000000000,  -0.016468312570172, -0.006753124184136, 0.000000000000000,  0.000000000000000,  -0.010424923521737, -0.016675229560934,
        0.000000000000000,  0.000000000000000,  -0.065485747828650, -0.008145624108448, 0.000000000000000,  0.000000000000000,  0.026347210490323,
        -0.009866155463816, 0.000000000000000,  0.000000000000000,  0.004768700270444,  -0.008546097881216, 0.000000000000000,  0.000000000000000,
        -0.008358478242223, 0.023316281483491,  0.000000000000000,  0.000000000000000,  -0.030810873544226, -0.009821271725370, 0.000000000000000,
        0.000000000000000,  -0.005464959453902, -0.001019900162548, 0.000000000000000,  0.000000000000000,  0.016604808370437,  -0.003573158146549,
        0.000000000000000,  0.000000000000000,  -0.007466014033312, -0.006532892288899, 0.000000000000000,  0.000000000000000,  -0.004289156545909,
        -0.013753626528358, 0.000000000000000,  0.000000000000000,  -0.042588944524023, 0.003300113479978,  0.000000000000000,  0.000000000000000,
        0.001964964270355,  -0.015624507596022, 0.000000000000000,  0.000000000000000,  0.002976291040797,  -0.010315753752856, 0.000000000000000,
        0.000000000000000,  0.000624983257048,  0.020298985962103,  0.000000000000000,  0.000000000000000,  -0.016848073152183, -0.010352366531256,
        0.000000000000000,  0.000000000000000,  -0.002690640094783, -0.000632980030461, -0.097488549979364, -0.040717928091623, -0.016484810486447,
        -0.012198288447840, 0.008439934342886,  0.009736852822547,  -0.038839855310965, -0.020119720879457, -0.034268623997966, -0.013643690130855,
        0.054558593612899,  0.052270354559978,  0.030321671442748,  0.037514442189612,  0.075191021420677,  0.045735846879121,  0.026347210490323,
        0.001964964270355,  0.339941483907885,  0.114522198743367,  -0.023638546891849, -0.005114724462992, 0.075946020008391,  0.042872047208265,
        0.030164469473889,  0.005445212850052,  -0.109133973195315, -0.068186608890815, -0.056296515792963, -0.011358212503070, -0.053295159181207,
        -0.042948560467737, -0.041441407049503, -0.020888210020676, 0.000974995872742,  -0.001429404451385, -0.033099314889418, -0.023928617971041,
        -0.012198288447840, -0.016155874269482, 0.010604350968483,  0.010204734359194,  -0.020119720879457, -0.023614273871178, -0.002100929072160,
        0.003656453748672,  0.052270354559978,  0.085179528215213,  0.016250966718322,  0.001186689571010,  0.045735846879121,  0.039221785575652,
        -0.009866155463816, -0.015624507596022, 0.114522198743367,  0.095475610486000,  0.011221119481902,  0.012074490469497,  0.042872047208265,
        0.045881569161196,  -0.008331640086747, -0.013384087161457, -0.068186608890815, -0.099926030130921, 0.025580731185764,  0.025442883863299,
        -0.042948560467737, -0.064657890750586, -0.008007558281644, -0.006360936116131, -0.001429404451385, -0.003464100786882, 0.000000000000000,
        0.000000000000000,  -0.010927456271837, 0.002525000838695,  0.000000000000000,  0.000000000000000,  -0.017779063552869, -0.011648801486115,
        0.000000000000000,  0.000000000000000,  -0.006508737494489, 0.012532026059038,  0.000000000000000,  0.000000000000000,  0.002548487966404,
        -0.010216298570502, 0.000000000000000,  0.000000000000000,  -0.023638546891849, 0.011221119481902,  0.000000000000000,  0.000000000000000,
        0.011644251481126,  -0.017241778521254, 0.000000000000000,  0.000000000000000,  0.000662619093442,  -0.000325188117215, 0.000000000000000,
        0.000000000000000,  0.021627550290156,  0.017939829934248,  0.000000000000000,  0.000000000000000,  -0.018206310664629, 0.006122870418265,
        0.000000000000000,  0.000000000000000,  -0.010672600510712, -0.000021505217218, 0.000000000000000,  0.000000000000000,  -0.013365270354291,
        -0.011836203467237, 0.000000000000000,  0.000000000000000,  -0.008477697116928, 0.017343594277167,  0.000000000000000,  0.000000000000000,
        -0.000733391662263, -0.011492851339168, 0.000000000000000,  0.000000000000000,  -0.005114724462992, 0.012074490469497,  0.000000000000000,
        0.000000000000000,  -0.002400302175122, -0.018999377721343, 0.000000000000000,  0.000000000000000,  -0.000925524626827, -0.000555196003451,
        0.000000000000000,  0.000000000000000,  0.017464623384106,  0.018112049873669,  0.000000000000000,  0.000000000000000,  -0.021003014219671,
        0.000159403546729,  -0.019326558317290, -0.009601742336366, -0.002787846143579, 0.000256698576121,  -0.062476394125414, -0.016056673019338,
        0.047319887175342,  0.025876304588783,  0.074819084191275,  0.040017321518632,  0.125048908631503,  0.049416143093261,  -0.022783569153990,
        0.002595575169147,  0.121782605635562,  0.051307556047696,  0.004768700270444,  0.002976291040797,  0.075946020008391,  0.042872047208265,
        0.011644251481126,  -0.002400302175122, 0.486859935540985,  0.201779947005221,  0.025087003377974,  0.016424433583284,  0.084924114990159,
        0.047528596870764,  -0.022682154660171, -0.018638491972497, -0.033580782599350, -0.010244423134967, 0.127380043738041,  0.063854905529895,
        -0.013268721641648, -0.006742497555846, 0.011075131961515,  0.008444323268692,  0.000256698576121,  -0.000442833532897, 0.025887804958769,
        0.027114521655909,  0.025876304588783,  0.025206162946687,  0.000653915324667,  -0.012712518871820, 0.049416143093261,  0.002591503168199,
        0.021401259340525,  0.019326606719024,  0.051307556047696,  0.007727687048483,  -0.008546097881216, -0.010315753752856, 0.042872047208265,
        0.045881569161196,  -0.017241778521254, -0.018999377721343, 0.201779947005221,  0.190478094126916,  0.004078607559476,  0.001089495110669,
        0.047528596870764,  0.059087113712428,  -0.031818948294605, -0.031458986507213, -0.010244423134967, -0.006727924354279, 0.056658735289843,
        0.044922805172062,  -0.006742497555846, -0.008004558988666, 0.000000000000000,  0.000000000000000,  -0.023915175099142, -0.015850731692561,
        0.000000000000000,  0.000000000000000,  -0.011601114312266, 0.006346715045487,  0.000000000000000,  0.000000000000000,  -0.043798274717970,
        -0.032641976495954, 0.000000000000000,  0.000000000000000,  -0.067148010433417, -0.010093060624541, 0.000000000000000,  0.000000000000000,
        0.030164469473889,  -0.008331640086747, 0.000000000000000,  0.000000000000000,  0.025087003377974,  0.004078607559476,  0.000000000000000,
        0.000000000000000,  -0.026200149447336, 0.001926037586912,  0.000000000000000,  0.000000000000000,  -0.032083566347006, -0.006214420033915,
        0.000000000000000,  0.000000000000000,  0.007574365212972,  0.001180480083790,  0.000000000000000,  0.000000000000000,  -0.012938053731025,
        -0.014804623753713, 0.000000000000000,  0.000000000000000,  0.001908319262626,  0.013738313775707,  0.000000000000000,  0.000000000000000,
        -0.030135859764898, -0.029291490637543, 0.000000000000000,  0.000000000000000,  -0.037331092013334, 0.003134244608066,  0.000000000000000,
        0.000000000000000,  0.005445212850052,  -0.013384087161457, 0.000000000000000,  0.000000000000000,  0.016424433583284,  0.001089495110669,
        0.000000000000000,  0.000000000000000,  -0.020857640357424, -0.004887001592478, 0.000000000000000,  0.000000000000000,  -0.014137170786359,
        -0.004816319105290, 0.000000000000000,  0.000000000000000,  0.013666540704114,  0.006978906685846,  0.081538141017913,  0.061177906607203,
        -0.001741427666622, -0.006805162721151, -0.022834102925008, -0.001475191812478, -0.030859555914668, -0.029963983282352, 0.009811415012577,
        0.021749040322278,  0.060568632840673,  0.052572109239225,  -0.009311345038162, 0.006131606606559,  0.018546112517833,  0.036815656066392,
        -0.008358478242223, 0.000624983257048,  -0.109133973195315, -0.068186608890815, 0.000662619093442,  -0.000925524626827, 0.084924114990159,
        0.047528596870764,  -0.026200149447336, -0.020857640357424, 0.195670209966892,  0.033116617627658,  0.046086694670858,  0.023323969727897,
        0.014623365175896,  -0.014159243958108, -0.028417427651757, -0.026688931059454, 0.003559220520064,  0.002989559540908,  0.052055816865136,
        0.049129255774800,  -0.006805162721151, -0.011837662945198, -0.033886272095434, -0.040202756178301, -0.029963983282352, -0.067166202523933,
        0.028923946916389,  0.026383542149182,  0.052572109239225,  0.074462833403267,  -0.006681671407353, -0.010242957990262, 0.036815656066392,
        0.080775922183483,  0.023316281483491,  0.020298985962103,  -0.068186608890815, -0.099926030130921, -0.000325188117215, -0.000555196003451,
        0.047528596870764,  0.059087113712428,  0.001926037586912,  -0.004887001592478, 0.033116617627658,  -0.012403484921897, -0.000445697456073,
        -0.002486773346659, -0.014159243958108, -0.031342320645984, -0.058853003143214, -0.051883500631333, 0.002989559540908,  0.004486773235217,
        0.000000000000000,  0.000000000000000,  -0.012338810553152, 0.017658455128591,  0.000000000000000,  0.000000000000000,  -0.043515918101939,
        -0.022347106208192, 0.000000000000000,  0.000000000000000,  -0.013737414590436, 0.033867139362873,  0.000000000000000,  0.000000000000000,
        0.006317210810660,  -0.018384082698295, 0.000000000000000,  0.000000000000000,  -0.056296515792963, 0.025580731185764,  0.000000000000000,
        0.000000000000000,  -0.022682154660171, -0.031818948294605, 0.000000000000000,  0.000000000000000,  0.046086694670858,  -0.000445697456073,
        0.000000000000000,  0.000000000000000,  0.042032069093569,  0.019758843754523,  0.000000000000000,  0.000000000000000,  0.040238086258335,
        0.040439530619255,  0.000000000000000,  0.000000000000000,  -0.015617848465521, 0.017661386203831,  0.000000000000000,  0.000000000000000,
        -0.033728070014171, -0.016757075157661, 0.000000000000000,  0.000000000000000,  -0.008008934076424, 0.040956149930588,  0.000000000000000,
        0.000000000000000,  0.006308522477246,  -0.018967420904866, 0.000000000000000,  0.000000000000000,  -0.011358212503070, 0.025442883863299,
        0.000000000000000,  0.000000000000000,  -0.018638491972497, -0.031458986507213, 0.000000000000000,  0.000000000000000,  0.023323969727897,
        -0.002486773346659, 0.000000000000000,  0.000000000000000,  0.010445954439138,  0.010081538286471,  0.000000000000000,  0.000000000000000,
        0.018938821382197,  0.031378939573361,  0.016072645236868,  -0.010815472848222, -0.049853084523888, -0.034665584645913, 0.042865752089830,
        0.032765664568917,  -0.013538584450883, -0.007853651878986, -0.014854125580142, -0.009860844654449, 0.041298481695743,  0.051856932917242,
        -0.025627773945854, -0.001898764726788, -0.036580228846211, -0.006671494997794, -0.030810873544226, -0.016848073152183, -0.053295159181207,
        -0.042948560467737, 0.021627550290156,  0.017464623384106,  -0.033580782599350, -0.010244423134967, -0.032083566347006, -0.014137170786359,
        0.014623365175896,  -0.014159243958108, 0.042032069093569,  0.010445954439138,  0.102406386175630,  -0.002226001181651, -0.036287489747075,
        -0.038550486074276, 0.018028468830996,  0.002162991373673,  -0.035383339078651, -0.047505991477479, -0.034665584645913, -0.064041911737341,
        0.022595667260858,  0.016862539976165,  -0.007853651878986, -0.006647114209068, -0.009440327982754, -0.015873423021271, 0.051856932917242,
        0.108522046096787,  0.004810594787416,  0.006997753381242,  -0.006671494997794, 0.001903816338733,  -0.009821271725370, -0.010352366531256,
        -0.042948560467737, -0.064657890750586, 0.017939829934248,  0.018112049873669,  -0.010244423134967, -0.006727924354279, -0.006214420033915,
        -0.004816319105290, -0.014159243958108, -0.031342320645984, 0.019758843754523,  0.010081538286471,  -0.002226001181651, -0.048236193315619,
        -0.017998307307474, -0.024235904584364, 0.002162991373673,  -0.004805923746669, 0.000000000000000,  0.000000000000000,  0.013881395223221,
        0.047577832862462,  0.000000000000000,  0.000000000000000,  -0.008489319337006, 0.036589722776111,  0.000000000000000,  0.000000000000000,
        -0.080264546688702, -0.051165392129315, 0.000000000000000,  0.000000000000000,  -0.042578651224183, -0.023824988350091, 0.000000000000000,
        0.000000000000000,  -0.041441407049503, -0.008007558281644, 0.000000000000000,  0.000000000000000,  0.127380043738041,  0.056658735289843,
        0.000000000000000,  0.000000000000000,  -0.028417427651757, -0.058853003143214, 0.000000000000000,  0.000000000000000,  -0.036287489747075,
        -0.017998307307474, 0.000000000000000,  0.000000000000000,  -0.013430029987927, -0.039781478896525, 0.000000000000000,  0.000000000000000,
        0.018072902943216,  0.052757668336180,  0.000000000000000,  0.000000000000000,  0.012823142100395,  0.048226850914638,  0.000000000000000,
        0.000000000000000,  -0.061547693280931, -0.048618742285847, 0.000000000000000,  0.000000000000000,  -0.014243109179595, -0.017233245055211,
        0.000000000000000,  0.000000000000000,  -0.020888210020676, -0.006360936116131, 0.000000000000000,  0.000000000000000,  0.063854905529895,
        0.044922805172062,  0.000000000000000,  0.000000000000000,  -0.026688931059454, -0.051883500631333, 0.000000000000000,  0.000000000000000,
        -0.038550486074276, -0.024235904584364, 0.000000000000000,  0.000000000000000,  -0.006260013440374, -0.029751417608787, -0.012384479852085,
        -0.017724956040439, -0.001014085985587, -0.000862796994521, 0.015309403618105,  0.015609522115662,  0.038020366576499,  0.025788785298099,
        0.021207446318634,  0.010828229173741,  -0.010955181046647, -0.000690051568723, 0.003561226872429,  0.012590498877526,  -0.003382552982155,
        -0.001626025184682, -0.005464959453902, -0.002690640094783, 0.000974995872742,  -0.001429404451385, -0.018206310664629, -0.021003014219671,
        -0.013268721641648, -0.006742497555846, 0.007574365212972,  0.013666540704114,  0.003559220520064,  0.002989559540908,  0.040238086258335,
        0.018938821382197,  0.018028468830996,  0.002162991373673,  -0.013430029987927, -0.006260013440374, 0.085759166822139,  0.016502549463325,
        -0.047340513783358, -0.052622057208778, -0.000862796994521, -0.001101469268265, -0.016902148946435, -0.017276883915036, 0.025788785298099,
        0.053854609084073,  0.016352687363083,  0.015024822035644,  -0.000690051568723, 0.005670126491594,  -0.007245630319929, -0.002373023736582,
        -0.001626025184682, 0.000639965097489,  -0.001019900162548, -0.000632980030461, -0.001429404451385, -0.003464100786882, 0.006122870418265,
        0.000159403546729,  -0.006742497555846, -0.008004558988666, 0.001180480083790,  0.006978906685846,  0.002989559540908,  0.004486773235217,
        0.040439530619255,  0.031378939573361,  0.002162991373673,  -0.004805923746669, -0.039781478896525, -0.029751417608787, 0.016502549463325,
        -0.004290997544997};

    ASSERT_EQ(efymat, CDenseMatrix(intyvals, 36, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.021226273752149, 0.000354406355766,  0.000000000000000,  0.000000000000000,  -0.008964144554345,
        -0.003468876628425, 0.000000000000000,  0.000000000000000,  -0.014354244459473, 0.000050859449340,  0.000000000000000,  0.000000000000000,
        0.021858021423302,  -0.000299835783643, 0.000000000000000,  0.000000000000000,  -0.016014997517833, 0.000027256845388,  0.000000000000000,
        0.000000000000000,  -0.013489076248485, 0.000020332009631,  0.000000000000000,  0.000000000000000,  0.023487900674693,  -0.000269138368767,
        0.000000000000000,  0.000000000000000,  -0.010414554241845, -0.005174414775795, 0.000000000000000,  0.000000000000000,  0.000533623257221,
        0.000011015435042,  0.000000000000000,  0.000000000000000,  -0.016519532557279, 0.003134890248931,  0.000000000000000,  0.000000000000000,
        -0.010379957476332, -0.003655965630318, 0.000000000000000,  0.000000000000000,  -0.008105014597963, 0.000549764808311,  0.000000000000000,
        0.000000000000000,  0.011397361145576,  -0.000944266233088, 0.000000000000000,  0.000000000000000,  -0.007264927888417, 0.000199061312206,
        0.000000000000000,  0.000000000000000,  -0.006241743851129, 0.000207884993937,  0.000000000000000,  0.000000000000000,  0.014787133453353,
        -0.001444779705983, 0.000000000000000,  0.000000000000000,  -0.014317456994926, -0.005462429396627, 0.000000000000000,  0.000000000000000,
        0.000239398307407,  0.000010406650337,  -0.021226273752149, -0.016519532557279, 0.355926256947619,  0.126167507894576,  -0.019601074329332,
        -0.023626665868542, 0.049781291901908,  0.016900759063405,  -0.056256276076466, -0.037128260465387, -0.021107537789990, -0.007930473855576,
        0.106507405004541,  0.062739276584882,  0.002863685993414,  0.002730006308161,  -0.073272797425676, -0.037204065378808, 0.015469606879828,
        0.006851595476060,  -0.055324299443828, -0.028246384575950, -0.003959686570864, -0.001114601359535, 0.103290770223115,  0.075368885442471,
        0.021707446682292,  0.006852369150002,  -0.023427361239260, -0.032901461187127, 0.086088318160289,  0.030610596378026,  0.000533623257221,
        0.000239398307407,  0.001657729003833,  0.000805123738115,  0.000354406355766,  0.003134890248931,  0.126167507894576,  0.142936018334221,
        -0.037159356016207, -0.041011805341038, 0.016900759063405,  0.008507190744445,  -0.026741937808407, -0.024792907543740, -0.007930473855576,
        0.000691110629591,  0.032647996076614,  0.028462855595962,  0.002730006308161,  0.007569048667469,  -0.012467119914937, -0.010143246638748,
        0.006851595476060,  0.003103745245466,  -0.010176265434658, -0.008535215968708, -0.001114601359535, 0.000797915579389,  0.062007766801820,
        0.057863683425389,  0.006852369150002,  -0.004811748696202, -0.055423017175825, -0.061281617594440, 0.030610596378026,  0.015191878484812,
        0.000011015435042,  0.000010406650337,  0.000805123738115,  0.000445717520658,  0.000000000000000,  0.000000000000000,  -0.019601074329332,
        -0.037159356016207, 0.000000000000000,  0.000000000000000,  0.041305605720276,  -0.013248704262780, 0.000000000000000,  0.000000000000000,
        0.004777134250671,  0.020981368398134,  0.000000000000000,  0.000000000000000,  0.045925454208953,  0.017228278391876,  0.000000000000000,
        0.000000000000000,  0.014048288768363,  0.004392924979288,  0.000000000000000,  0.000000000000000,  -0.074387897913051, -0.035413776245161,
        0.000000000000000,  0.000000000000000,  -0.006003805810256, 0.030091178582656,  0.000000000000000,  0.000000000000000,  -0.003370209244187,
        -0.000182617796883, 0.000000000000000,  0.000000000000000,  0.027149971797149,  0.055619930195280,  0.000000000000000,  0.000000000000000,
        -0.023626665868542, -0.041011805341038, 0.000000000000000,  0.000000000000000,  0.016970480794215,  -0.014229087025446, 0.000000000000000,
        0.000000000000000,  -0.000810496228386, 0.015472264325166,  0.000000000000000,  0.000000000000000,  0.016976777549426,  0.012659732531812,
        0.000000000000000,  0.000000000000000,  0.004841983720218,  0.003211196063525,  0.000000000000000,  0.000000000000000,  -0.028038098279438,
        -0.026456581642643, 0.000000000000000,  0.000000000000000,  -0.005861635201531, 0.022254908754879,  0.000000000000000,  0.000000000000000,
        -0.001190046789506, -0.000105750400948, 0.000000000000000,  0.000000000000000,  0.034483247440934,  0.061428727715694,  -0.008964144554345,
        -0.010379957476332, 0.049781291901908,  0.016900759063405,  0.041305605720276,  0.016970480794215,  0.426383811614235,  0.141662875465317,
        0.019978841792813,  0.007284635153542,  0.085559211814170,  0.025355784889289,  0.058845995787326,  0.014626752867125,  0.011682681278021,
        0.004686015361927,  0.018555595166404,  0.004526627760595,  -0.018015664898171, -0.007628827627072, -0.096699386404660, -0.022388000767032,
        -0.007377405523788, -0.008135689260782, 0.013863717708173,  0.005912240631367,  0.095900156966035,  0.025750785675303,  -0.003370209244187,
        -0.001190046789506, -0.009511886816828, -0.004079726846588, 0.012303611225242,  0.015097888374181,  -0.078974666061165, -0.027333379616652,
        -0.003468876628425, -0.003655965630318, 0.016900759063405,  0.008507190744445,  -0.013248704262780, -0.014229087025446, 0.141662875465317,
        0.113772333155081,  0.007918983050292,  -0.003431538042988, 0.025355784889289,  -0.005277752768535, -0.000402143094047, -0.005280891769508,
        0.004686015361926,  0.004405141045984,  -0.000358903501203, -0.001617021940725, -0.007628827627072, -0.003594048095348, 0.002419106182474,
        0.012477577774167,  -0.008135689260782, -0.022318349921285, 0.011495776294760,  -0.005167958255704, 0.025750785675303,  -0.009132790318789,
        -0.000182617796883, -0.000105750400948, -0.004079726846588, -0.001429896560935, 0.005192422736899,  0.005475838114881,  -0.027333379616652,
        -0.013677042357938, 0.000000000000000,  0.000000000000000,  -0.056256276076466, -0.026741937808407, 0.000000000000000,  0.000000000000000,
        0.019978841792813,  0.007918983050292,  0.000000000000000,  0.000000000000000,  -0.026084528967200, -0.036640612803170, 0.000000000000000,
        0.000000000000000,  0.051418628959673,  0.011928136502405,  0.000000000000000,  0.000000000000000,  0.012804505989818,  -0.023981462031253,
        0.000000000000000,  0.000000000000000,  0.031446872149047,  0.023006259367798,  0.000000000000000,  0.000000000000000,  -0.022671539406430,
        -0.000568077771163, 0.000000000000000,  0.000000000000000,  -0.060310159030322, -0.012599500321642, 0.000000000000000,  0.000000000000000,
        -0.112488149100711, -0.062637720548654, 0.000000000000000,  0.000000000000000,  -0.037128260465387, -0.024792907543740, 0.000000000000000,
        0.000000000000000,  0.007284635153542,  -0.003431538042988, 0.000000000000000,  0.000000000000000,  -0.024444420685819, -0.038376080127839,
        0.000000000000000,  0.000000000000000,  0.016796659677319,  0.008606482292901,  0.000000000000000,  0.000000000000000,  -0.008821891684287,
        -0.021458748175160, 0.000000000000000,  0.000000000000000,  0.013263513771379,  0.019100620142567,  0.000000000000000,  0.000000000000000,
        -0.006475408308898, -0.000347949447208, 0.000000000000000,  0.000000000000000,  -0.020374961032677, 0.005108399023047,  0.000000000000000,
        0.000000000000000,  -0.079352023415318, -0.058338941126614, -0.014354244459473, -0.008105014597963, -0.021107537789990, -0.007930473855576,
        0.004777134250671,  -0.000810496228386, 0.085559211814170,  0.025355784889289,  -0.026084528967200, -0.024444420685819, 0.587982090351868,
        0.170363961553155,  0.066137614585818,  0.032061011714960,  0.139279363275440,  0.014144518231294,  -0.013978103481248, -0.016450174256840,
        -0.173707498960807, -0.072974104592064, 0.069290178697227,  0.041638463728154,  0.117337444565653,  0.010205662823992,  -0.022671539406430,
        -0.006475408308898, -0.072482483063026, -0.022858487535817, -0.031977816364615, -0.007537383362694, -0.189455135086164, -0.061175357270483,
        -0.026666042422319, -0.016139562903527, -0.030100700619033, -0.010383768306024, 0.000050859449340,  0.000549764808311,  -0.007930473855576,
        0.000691110629591,  0.020981368398134,  0.015472264325166,  0.025355784889289,  -0.005277752768535, -0.036640612803170, -0.038376080127839,
        0.170363961553155,  0.023697782866825,  0.023553130528803,  0.015180516366679,  0.014144518231294,  -0.080298054983776, -0.005344750774388,
        -0.000349023479095, -0.072974104592064, -0.040965618959326, 0.028844025698136,  0.015441684433467,  0.010205662823992,  -0.072806705745292,
        -0.000568077771163, -0.000347949447208, -0.022858487535817, 0.005988056517482,  -0.034073699291272, -0.025004822651125, -0.061175357270483,
        0.005625311013986,  0.000226498777867,  0.001408440430955,  -0.010383768306024, 0.003897619537473,  0.000000000000000,  0.000000000000000,
        0.106507405004541,  0.032647996076614,  0.000000000000000,  0.000000000000000,  0.058845995787326,  -0.000402143094047, 0.000000000000000,
        0.000000000000000,  0.066137614585818,  0.023553130528803,  0.000000000000000,  0.000000000000000,  0.045685842790830,  -0.008061657994780,
        0.000000000000000,  0.000000000000000,  -0.055056792915845, -0.001472720019342, 0.000000000000000,  0.000000000000000,  -0.000899724010645,
        0.008982734326734,  0.000000000000000,  0.000000000000000,  -0.060315305742777, -0.026898324669617, 0.000000000000000,  0.000000000000000,
        0.032161700194630,  -0.004526298583578, 0.000000000000000,  0.000000000000000,  -0.010995842309464, 0.002890346775910,  0.000000000000000,
        0.000000000000000,  0.062739276584882,  0.028462855595962,  0.000000000000000,  0.000000000000000,  0.014626752867125,  -0.005280891769508,
        0.000000000000000,  0.000000000000000,  0.032061011714960,  0.015180516366679,  0.000000000000000,  0.000000000000000,  -0.001274001646471,
        -0.023617207496458, 0.000000000000000,  0.000000000000000,  -0.024241299440149, 0.003507801784797,  0.000000000000000,  0.000000000000000,
        0.005115634842842,  0.007638436596790,  0.000000000000000,  0.000000000000000,  -0.039702547574869, -0.013242957398502, 0.000000000000000,
        0.000000000000000,  0.003958716543744,  -0.012192704625397, 0.000000000000000,  0.000000000000000,  -0.002468186862017, 0.002830511639887,
        0.021858021423302,  0.011397361145576,  0.002863685993414,  0.002730006308161,  0.045925454208953,  0.016976777549426,  0.011682681278021,
        0.004686015361926,  0.051418628959673,  0.016796659677319,  0.139279363275440,  0.014144518231294,  0.045685842790830,  -0.001274001646471,
        0.448547041849548,  0.073579486860760,  -0.013128108645007, 0.016509269493183,  -0.034244287055258, -0.033073376772384, -0.000899724010645,
        0.005115634842842,  0.109596979957227,  0.006045134138795,  -0.017742550761908, -0.009684071047998, -0.089862964461401, -0.006902328467107,
        0.022455735321114,  0.009623362280617,  -0.022566115553692, 0.003627359394346,  -0.004227580812334, -0.001473434594566, -0.002577731339952,
        -0.000001705268042, -0.000299835783643, -0.000944266233088, 0.002730006308161,  0.007569048667469,  0.017228278391876,  0.012659732531812,
        0.004686015361927,  0.004405141045984,  0.011928136502405,  0.008606482292901,  0.014144518231294,  -0.080298054983776, -0.008061657994780,
        -0.023617207496458, 0.073579486860760,  -0.097526348218686, 0.019022590381848,  0.010496932097124,  -0.033073376772384, -0.049033156725889,
        0.008982734326734,  0.007638436596790,  0.006045134138795,  -0.062247636482780, -0.024540475752055, -0.020957889153532, -0.006902328467107,
        0.058514592726180,  0.026813643063508,  0.020765601303940,  0.003627359394346,  0.039341554864651,  -0.000094047697097, -0.000163389529434,
        -0.000001705268042, 0.003584497314973,  0.000000000000000,  0.000000000000000,  -0.073272797425676, -0.012467119914937, 0.000000000000000,
        0.000000000000000,  0.018555595166404,  -0.000358903501203, 0.000000000000000,  0.000000000000000,  -0.013978103481248, -0.005344750774388,
        0.000000000000000,  0.000000000000000,  -0.013128108645007, 0.019022590381848,  0.000000000000000,  0.000000000000000,  0.026612187669172,
        -0.005145349392919, 0.000000000000000,  0.000000000000000,  -0.008752072430004, 0.012681726921232,  0.000000000000000,  0.000000000000000,
        0.005824209783854,  0.002226979489328,  0.000000000000000,  0.000000000000000,  -0.094839708628285, 0.001834395672814,  0.000000000000000,
        0.000000000000000,  -0.072662190780462, -0.012363227248979, 0.000000000000000,  0.000000000000000,  -0.037204065378808, -0.010143246638748,
        0.000000000000000,  0.000000000000000,  0.004526627760595,  -0.001617021940725, 0.000000000000000,  0.000000000000000,  -0.016450174256840,
        -0.000349023479095, 0.000000000000000,  0.000000000000000,  0.016509269493183,  0.010496932097124,  0.000000000000000,  0.000000000000000,
        -0.002301070514782, -0.022798834282716, 0.000000000000000,  0.000000000000000,  0.011006179662122,  0.006997954731416,  0.000000000000000,
        0.000000000000000,  0.006854239273684,  0.000145426449623,  0.000000000000000,  0.000000000000000,  -0.023136097443042, 0.008264778808148,
        0.000000000000000,  0.000000000000000,  -0.036894031500652, -0.010058719583425, -0.016014997517833, -0.007264927888417, 0.015469606879828,
        0.006851595476060,  0.014048288768363,  0.004841983720218,  -0.018015664898171, -0.007628827627072, 0.012804505989818,  -0.008821891684287,
        -0.173707498960807, -0.072974104592064, -0.055056792915845, -0.024241299440149, -0.034244287055258, -0.033073376772384, 0.026612187669172,
        -0.002301070514782, 0.378288621045111,  0.092496306675152,  -0.036704528610563, -0.016160866293433, -0.022829524703505, -0.022048917848256,
        -0.005335210829091, 0.003675788201786,  0.072378124567003,  0.030405876913360,  -0.071802364816080, -0.024747916792225, 0.092080065035095,
        0.038991785649478,  -0.015881539205185, -0.007204386822681, 0.015340693489163,  0.006794498847092,  0.000027256845388,  0.000199061312206,
        0.006851595476060,  0.003103745245466,  0.004392924979288,  0.003211196063525,  -0.007628827627072, -0.003594048095348, -0.023981462031253,
        -0.021458748175160, -0.072974104592064, -0.040965618959326, -0.001472720019342, 0.003507801784797,  -0.033073376772384, -0.049033156725889,
        -0.005145349392919, -0.022798834282716, 0.092496306675152,  -0.012171811655833, -0.000981813346228, 0.002338534523197,  -0.022048917848256,
        -0.032688771150593, 0.009992275846356,  0.008941145072983,  0.030405876913360,  0.017069007899719,  -0.022452727671915, -0.016412779880239,
        0.038991785649478,  0.018369579153999,  0.000027029705010,  0.000197402467938,  0.006794498847092,  0.003077880701753,  0.000000000000000,
        0.000000000000000,  -0.055324299443828, -0.010176265434658, 0.000000000000000,  0.000000000000000,  -0.096699386404660, 0.002419106182474,
        0.000000000000000,  0.000000000000000,  0.069290178697227,  0.028844025698136,  0.000000000000000,  0.000000000000000,  -0.000899724010645,
        0.008982734326734,  0.000000000000000,  0.000000000000000,  -0.036704528610563, -0.000981813346228, 0.000000000000000,  0.000000000000000,
        0.046435612799701,  -0.015547269933725, 0.000000000000000,  0.000000000000000,  0.020266041707518,  0.013608436383033,  0.000000000000000,
        0.000000000000000,  -0.005153876370955, -0.002491775558475, 0.000000000000000,  0.000000000000000,  0.120060264793321,  0.034136910777397,
        0.000000000000000,  0.000000000000000,  -0.028246384575950, -0.008535215968708, 0.000000000000000,  0.000000000000000,  -0.022388000767032,
        0.012477577774167,  0.000000000000000,  0.000000000000000,  0.041638463728154,  0.015441684433467,  0.000000000000000,  0.000000000000000,
        0.005115634842842,  0.007638436596790,  0.000000000000000,  0.000000000000000,  -0.016160866293433, 0.002338534523197,  0.000000000000000,
        0.000000000000000,  -0.005537030682172, -0.029982571327116, 0.000000000000000,  0.000000000000000,  0.022166329153722,  0.003942578187967,
        0.000000000000000,  0.000000000000000,  -0.003648953987635, -0.004998392563644, 0.000000000000000,  0.000000000000000,  0.069015956175220,
        0.029628641070193,  -0.013489076248485, -0.006241743851129, -0.003959686570864, -0.001114601359535, -0.074387897913051, -0.028038098279438,
        -0.007377405523788, -0.008135689260782, 0.031446872149047,  0.013263513771379,  0.117337444565653,  0.010205662823992,  -0.000899724010645,
        0.005115634842842,  0.109596979957227,  0.006045134138795,  -0.008752072430004, 0.011006179662122,  -0.022829524703505, -0.022048917848256,
        0.046435612799701,  -0.005537030682172, 0.357216225218525,  0.068541875078431,  -0.018625680352369, -0.001498269797735, -0.001145757257403,
        -0.002739190703894, -0.005573940361385, -0.001284502316070, -0.018011310457147, 0.000215254911044,  0.025478510805915,  0.012973997276857,
        0.004199640742358,  0.002958129270580,  0.000020332009631,  0.000207884993937,  -0.001114601359535, 0.000797915579389,  -0.035413776245161,
        -0.026456581642643, -0.008135689260782, -0.022318349921285, 0.023006259367798,  0.019100620142567,  0.010205662823992,  -0.072806705745292,
        0.008982734326734,  0.007638436596790,  0.006045134138795,  -0.062247636482780, 0.012681726921232,  0.006997954731416,  -0.022048917848256,
        -0.032688771150593, -0.015547269933725, -0.029982571327116, 0.068541875078431,  -0.045653317816369, 0.019769686910830,  0.018099190571164,
        -0.002739190703894, -0.007249477330539, 0.008699812986736,  0.007016177029265,  0.000215254911044,  0.021286485948156,  -0.000284771606305,
        -0.000953359108581, 0.002958129270580,  0.006673480203294,  0.000000000000000,  0.000000000000000,  0.103290770223115,  0.062007766801820,
        0.000000000000000,  0.000000000000000,  0.013863717708173,  0.011495776294760,  0.000000000000000,  0.000000000000000,  -0.022671539406430,
        -0.000568077771163, 0.000000000000000,  0.000000000000000,  -0.017742550761908, -0.024540475752055, 0.000000000000000,  0.000000000000000,
        -0.005335210829091, 0.009992275846356,  0.000000000000000,  0.000000000000000,  -0.018625680352369, 0.019769686910830,  0.000000000000000,
        0.000000000000000,  -0.071049748789954, -0.037767300382644, 0.000000000000000,  0.000000000000000,  0.029470409366184,  0.008144534693976,
        0.000000000000000,  0.000000000000000,  -0.033651606975128, -0.025193681920957, 0.000000000000000,  0.000000000000000,  0.075368885442471,
        0.057863683425389,  0.000000000000000,  0.000000000000000,  0.005912240631367,  -0.005167958255704, 0.000000000000000,  0.000000000000000,
        -0.006475408308898, -0.000347949447208, 0.000000000000000,  0.000000000000000,  -0.009684071047998, -0.020957889153532, 0.000000000000000,
        0.000000000000000,  0.003675788201786,  0.008941145072983,  0.000000000000000,  0.000000000000000,  -0.001498269797735, 0.018099190571164,
        0.000000000000000,  0.000000000000000,  -0.037287313831799, -0.039066179864802, 0.000000000000000,  0.000000000000000,  0.010240165955820,
        -0.003419366809513, 0.000000000000000,  0.000000000000000,  -0.027338784892025, -0.023624852686261, 0.023487900674693,  0.014787133453353,
        0.021707446682292,  0.006852369150002,  -0.006003805810256, -0.005861635201531, 0.095900156966035,  0.025750785675303,  -0.022671539406430,
        -0.006475408308898, -0.072482483063026, -0.022858487535817, -0.060315305742777, -0.039702547574869, -0.089862964461401, -0.006902328467107,
        0.005824209783854,  0.006854239273684,  0.072378124567003,  0.030405876913360,  0.020266041707518,  0.022166329153722,  -0.001145757257403,
        -0.002739190703894, -0.071049748789954, -0.037287313831799, 0.444225165610200,  0.125027961273783,  0.012538872785569,  0.001927661669161,
        0.104677649553962,  0.032594977074568,  -0.006543231830949, -0.004781108884070, -0.000479190252229, 0.000748749915565,  -0.000269138368767,
        -0.001444779705983, 0.006852369150002,  -0.004811748696202, 0.030091178582656,  0.022254908754879,  0.025750785675303,  -0.009132790318789,
        -0.000568077771163, -0.000347949447208, -0.022858487535817, 0.005988056517482,  -0.026898324669617, -0.013242957398502, -0.006902328467107,
        0.058514592726180,  0.002226979489328,  0.000145426449623,  0.030405876913360,  0.017069007899719,  0.013608436383033,  0.003942578187967,
        -0.002739190703894, -0.007249477330539, -0.037767300382644, -0.039066179864802, 0.125027961273783,  0.035574094959830,  0.021795216851151,
        0.016034223278837,  0.032594977074568,  -0.004560981453315, 0.000155656028424,  0.000639076915414,  0.000748749915565,  0.002937792801106,
        0.000000000000000,  0.000000000000000,  -0.023427361239260, -0.055423017175825, 0.000000000000000,  0.000000000000000,  -0.003370209244187,
        -0.000182617796883, 0.000000000000000,  0.000000000000000,  -0.031977816364615, -0.034073699291272, 0.000000000000000,  0.000000000000000,
        0.022455735321114,  0.026813643063508,  0.000000000000000,  0.000000000000000,  -0.071802364816080, -0.022452727671915, 0.000000000000000,
        0.000000000000000,  -0.005573940361385, 0.008699812986736,  0.000000000000000,  0.000000000000000,  0.012538872785569,  0.021795216851151,
        0.000000000000000,  0.000000000000000,  0.057871730869843,  -0.012351053981000, 0.000000000000000,  0.000000000000000,  -0.014117147694941,
        -0.036869275564530, 0.000000000000000,  0.000000000000000,  -0.032901461187127, -0.061281617594440, 0.000000000000000,  0.000000000000000,
        -0.001190046789506, -0.000105750400948, 0.000000000000000,  0.000000000000000,  -0.007537383362694, -0.025004822651125, 0.000000000000000,
        0.000000000000000,  0.009623362280617,  0.020765601303940,  0.000000000000000,  0.000000000000000,  -0.024747916792225, -0.016412779880239,
        0.000000000000000,  0.000000000000000,  -0.001284502316070, 0.007016177029265,  0.000000000000000,  0.000000000000000,  0.001927661669161,
        0.016034223278837,  0.000000000000000,  0.000000000000000,  0.022820106921374,  -0.013709275271992, 0.000000000000000,  0.000000000000000,
        -0.021296473216832, -0.040795091532385, -0.010414554241845, -0.014317456994926, 0.086088318160289,  0.030610596378026,  -0.003370209244187,
        -0.001190046789506, -0.009511886816828, -0.004079726846588, -0.060310159030322, -0.020374961032677, -0.189455135086164, -0.061175357270483,
        0.032161700194630,  0.003958716543744,  -0.022566115553692, 0.003627359394346,  -0.094839708628285, -0.023136097443042, 0.092080065035095,
        0.038991785649478,  -0.005153876370955, -0.003648953987635, -0.018011310457147, 0.000215254911044,  0.029470409366184,  0.010240165955820,
        0.104677649553962,  0.032594977074568,  0.057871730869843,  0.022820106921374,  0.473139100677631,  0.161716605254707,  -0.006181299090380,
        -0.009230272769739, 0.060260697579062,  0.021728558266381,  -0.005174414775795, -0.005462429396627, 0.030610596378026,  0.015191878484812,
        -0.000182617796883, -0.000105750400948, -0.004079726846588, -0.001429896560935, -0.012599500321642, 0.005108399023047,  -0.061175357270483,
        0.005625311013986,  -0.004526298583578, -0.012192704625397, 0.003627359394346,  0.039341554864651,  0.001834395672814,  0.008264778808148,
        0.038991785649478,  0.018369579153999,  -0.002491775558475, -0.004998392563644, 0.000215254911044,  0.021286485948156,  0.008144534693976,
        -0.003419366809513, 0.032594977074568,  -0.004560981453315, -0.012351053981000, -0.013709275271992, 0.161716605254707,  0.120800930984800,
        -0.003442348380037, -0.003636212710687, 0.021728558266381,  0.010738756484056,  0.000000000000000,  0.000000000000000,  0.000533623257221,
        0.000011015435042,  0.000000000000000,  0.000000000000000,  0.012303611225242,  0.005192422736899,  0.000000000000000,  0.000000000000000,
        -0.026666042422319, 0.000226498777867,  0.000000000000000,  0.000000000000000,  -0.004227580812334, -0.000094047697097, 0.000000000000000,
        0.000000000000000,  -0.015881539205185, 0.000027029705010,  0.000000000000000,  0.000000000000000,  0.025478510805915,  -0.000284771606305,
        0.000000000000000,  0.000000000000000,  -0.006543231830949, 0.000155656028424,  0.000000000000000,  0.000000000000000,  -0.006181299090380,
        -0.003442348380037, 0.000000000000000,  0.000000000000000,  -0.021235204841678, 0.000354221993793,  0.000000000000000,  0.000000000000000,
        0.000239398307407,  0.000010406650337,  0.000000000000000,  0.000000000000000,  0.015097888374181,  0.005475838114881,  0.000000000000000,
        0.000000000000000,  -0.016139562903527, 0.001408440430955,  0.000000000000000,  0.000000000000000,  -0.001473434594566, -0.000163389529434,
        0.000000000000000,  0.000000000000000,  -0.007204386822681, 0.000197402467938,  0.000000000000000,  0.000000000000000,  0.012973997276857,
        -0.000953359108581, 0.000000000000000,  0.000000000000000,  -0.004781108884070, 0.000639076915414,  0.000000000000000,  0.000000000000000,
        -0.009230272769739, -0.003636212710687, 0.000000000000000,  0.000000000000000,  -0.016523539293656, 0.003134716076001,  0.000533623257221,
        0.000239398307407,  0.001657729003833,  0.000805123738115,  0.027149971797149,  0.034483247440934,  -0.078974666061165, -0.027333379616652,
        -0.112488149100711, -0.079352023415318, -0.030100700619033, -0.010383768306024, -0.010995842309464, -0.002468186862017, -0.002577731339952,
        -0.000001705268042, -0.072662190780462, -0.036894031500652, 0.015340693489163,  0.006794498847092,  0.120060264793321,  0.069015956175220,
        0.004199640742358,  0.002958129270580,  -0.033651606975128, -0.027338784892025, -0.000479190252229, 0.000748749915565,  -0.014117147694941,
        -0.021296473216832, 0.060260697579062,  0.021728558266381,  -0.021235204841678, -0.016523539293656, 0.355898512043423,  0.126154032784393,
        0.000011015435042,  0.000010406650337,  0.000805123738115,  0.000445717520658,  0.055619930195280,  0.061428727715694,  -0.027333379616652,
        -0.013677042357938, -0.062637720548654, -0.058338941126614, -0.010383768306024, 0.003897619537473,  0.002890346775910,  0.002830511639887,
        -0.000001705268042, 0.003584497314973,  -0.012363227248979, -0.010058719583425, 0.006794498847092,  0.003077880701753,  0.034136910777397,
        0.029628641070193,  0.002958129270580,  0.006673480203294,  -0.025193681920957, -0.023624852686261, 0.000748749915565,  0.002937792801106,
        -0.036869275564530, -0.040795091532385, 0.021728558266381,  0.010738756484056,  0.000354221993793,  0.003134716076001,  0.126154032784393,
        0.142928558496166};

    ASSERT_EQ(efzmat, CDenseMatrix(intzvals, 36, 36));
}
