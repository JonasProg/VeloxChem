//
//                           VELOXCHEM 1.0-RC
//      ---------------------------------------------------
//                     An Electronic Structure Code
//
//  Copyright Â© 2018-2020 by VeloxChem developers. All rights reserved.
//  Contact: https://veloxchem.org/contact

#include "ElectricDipoleIntegralsDriverTest.hpp"

#include <mpi.h>

#include "ElectricDipoleIntegralsDriver.hpp"
#include "MolecularBasisSetter.hpp"
#include "MoleculeSetter.hpp"

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeSSForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix dipxmat(4, 4);

    CDenseMatrix dipymat(4, 4);

    CDenseMatrix dipzmat(4, 4);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{0.000000000000000,
                                 0.000000000000000,
                                 0.034080416572876,
                                 0.038381743586952,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.060847045273318,
                                 0.067637145335229,
                                 0.034080416572876,
                                 0.060847045273318,
                                 0.400000000000000,
                                 0.321445559231693,
                                 0.038381743586952,
                                 0.067637145335229,
                                 0.321445559231693,
                                 0.400000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 4, 4));

    std::vector<double> intyvals{0.000000000000000,
                                 0.000000000000000,
                                 0.051120624859315,
                                 0.057572615380427,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.091270567909978,
                                 0.101455718002844,
                                 0.051120624859315,
                                 0.091270567909978,
                                 0.600000000000000,
                                 0.482168338847539,
                                 0.057572615380427,
                                 0.101455718002844,
                                 0.482168338847539,
                                 0.600000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 4, 4));

    std::vector<double> intzvals{0.000000000000000,
                                 0.000000000000000,
                                 0.093721145575410,
                                 0.105549794864117,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.167329374501625,
                                 0.186002149671880,
                                 0.093721145575410,
                                 0.167329374501625,
                                 1.100000000000001,
                                 0.883975287887155,
                                 0.105549794864117,
                                 0.186002149671880,
                                 0.883975287887155,
                                 1.100000000000001};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 4, 4));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeSPForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix dipxmat(4, 12);

    CDenseMatrix dipymat(4, 12);

    CDenseMatrix dipzmat(4, 12);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.027194505513681, -0.028442480254544, 0.000000000000000,  0.000000000000000,  -0.049856593441748,
        -0.052144547133331, 0.349517718067261,  0.326843075568070,  0.037390368731802,  0.088318581191208,  0.000000000000000,  0.000000000000000,
        -0.037716888864784, -0.043557481374798, 0.000000000000000,  0.000000000000000,  -0.069147629585438, -0.079855382520464, 0.420263492740569,
        0.456435464587639,  0.073809484079972,  0.160013247550474,  0.031373065382746,  0.053284434463371,  0.000000000000000,  0.000000000000000,
        0.057517286535034,  0.097688129849513,  0.000000000000000,  0.000000000000000,  0.070516892226549,  0.106033204954704,  0.319513141859236,
        0.225523320976437,  0.019077536949595,  0.035564534616346,  0.000000000000000,  0.000000000000000,  0.034975484407590,  0.065201646796634,
        0.000000000000000,  0.000000000000000,  0.177876402042841,  0.255249628652732,  0.389551476557429,  0.559016994374947};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 4, 12));

    std::vector<double> intyvals{0.349517718067261,  0.326843075568070,  0.014728280803735, 0.064616514312421, 0.000000000000000,  0.000000000000000,
                                 -0.074784890162622, -0.078216820699997, 0.000000000000000, 0.000000000000000, -0.027194505513681, -0.028442480254544,
                                 0.420263492740569,  0.456435464587639,  0.042378743359319, 0.123715346404809, 0.000000000000000,  0.000000000000000,
                                 -0.103721444378157, -0.119783073780695, 0.000000000000000, 0.000000000000000, -0.037716888864784, -0.043557481374798,
                                 0.096661113378837,  0.150436900340846,  0.319513141859236, 0.225523320976437, 0.086275929802551,  0.146532194774270,
                                 0.000000000000000,  0.000000000000000,  0.031373065382746, 0.053284434463371, 0.000000000000000,  0.000000000000000,
                                 0.193774349500837,  0.284886740833021,  0.389551476557429, 0.559016994374947, 0.052463226611385,  0.097802470194951,
                                 0.000000000000000,  0.000000000000000,  0.019077536949595, 0.035564534616346, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 4, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.074784890162622, -0.078216820699997, 0.349517718067261,  0.326843075568070,  -0.081585592890552,
        -0.036117269922424, 0.000000000000000,  0.000000000000000,  -0.049856593441748, -0.052144547133331, 0.000000000000000,  0.000000000000000,
        -0.103721444378157, -0.119783073780695, 0.420263492740569,  0.456435464587639,  -0.091201904703459, -0.030550733464268, 0.000000000000000,
        0.000000000000000,  -0.069147629585438, -0.079855382520464, 0.086275929802551,  0.146532194774270,  0.000000000000000,  0.000000000000000,
        0.207774053276063,  0.339152605731952,  0.319513141859236,  0.225523320976437,  0.057517286535034,  0.097688129849513,  0.000000000000000,
        0.000000000000000,  0.052463226611385,  0.097802470194951,  0.000000000000000,  0.000000000000000,  0.261340626197318,  0.410844467599246,
        0.389551476557429,  0.559016994374947,  0.034975484407590,  0.065201646796634,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 4, 12));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputePSForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix dipxmat(12, 4);

    CDenseMatrix dipymat(12, 4);

    CDenseMatrix dipzmat(12, 4);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.031373065382746,  0.019077536949595,  0.000000000000000,  0.000000000000000,  0.053284434463371,
        0.035564534616346,  -0.027194505513681, -0.037716888864784, 0.000000000000000,  0.000000000000000,  -0.028442480254544, -0.043557481374798,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.057517286535034,  0.034975484407590,  0.000000000000000,
        0.000000000000000,  0.097688129849513,  0.065201646796634,  -0.049856593441748, -0.069147629585438, 0.000000000000000,  0.000000000000000,
        -0.052144547133331, -0.079855382520464, 0.000000000000000,  0.000000000000000,  0.349517718067261,  0.420263492740569,  0.070516892226549,
        0.177876402042841,  0.326843075568070,  0.456435464587639,  0.106033204954704,  0.255249628652732,  0.037390368731802,  0.073809484079972,
        0.319513141859236,  0.389551476557429,  0.088318581191208,  0.160013247550474,  0.225523320976437,  0.559016994374947};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 12, 4));

    std::vector<double> intyvals{
        0.349517718067261,  0.420263492740569,  0.096661113378837,  0.193774349500837,  0.326843075568070,  0.456435464587639,  0.150436900340846,
        0.284886740833021,  0.014728280803735,  0.042378743359319,  0.319513141859236,  0.389551476557429,  0.064616514312421,  0.123715346404809,
        0.225523320976437,  0.559016994374947,  0.000000000000000,  0.000000000000000,  0.086275929802551,  0.052463226611385,  0.000000000000000,
        0.000000000000000,  0.146532194774270,  0.097802470194951,  -0.074784890162622, -0.103721444378157, 0.000000000000000,  0.000000000000000,
        -0.078216820699997, -0.119783073780695, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.031373065382746,
        0.019077536949595,  0.000000000000000,  0.000000000000000,  0.053284434463371,  0.035564534616346,  -0.027194505513681, -0.037716888864784,
        0.000000000000000,  0.000000000000000,  -0.028442480254544, -0.043557481374798, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 12, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.086275929802551,  0.052463226611385,  0.000000000000000,  0.000000000000000,  0.146532194774270,
        0.097802470194951,  -0.074784890162622, -0.103721444378157, 0.000000000000000,  0.000000000000000,  -0.078216820699997, -0.119783073780695,
        0.000000000000000,  0.000000000000000,  0.349517718067261,  0.420263492740569,  0.207774053276063,  0.261340626197318,  0.326843075568070,
        0.456435464587639,  0.339152605731952,  0.410844467599246,  -0.081585592890552, -0.091201904703459, 0.319513141859236,  0.389551476557429,
        -0.036117269922424, -0.030550733464268, 0.225523320976437,  0.559016994374947,  0.000000000000000,  0.000000000000000,  0.057517286535034,
        0.034975484407590,  0.000000000000000,  0.000000000000000,  0.097688129849513,  0.065201646796634,  -0.049856593441748, -0.069147629585438,
        0.000000000000000,  0.000000000000000,  -0.052144547133331, -0.079855382520464, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 12, 4));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputePPForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix dipxmat(12, 12);

    CDenseMatrix dipymat(12, 12);

    CDenseMatrix dipzmat(12, 12);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.008726772440593,  0.021483664255229,  0.000000000000000,  0.000000000000000,  -0.045932436716337,
        -0.025786249433209, 0.000000000000000,  0.000000000000000,  0.033968538986498,  0.043946518852484,  0.000000000000000,  0.000000000000000,
        0.024431208639843,  0.043367478998707,  0.000000000000000,  0.000000000000000,  -0.060414218943499, -0.041989050570875, 0.000000000000000,
        0.000000000000000,  0.064107821570446,  0.084137150575731,  0.008726772440593,  0.024431208639843,  0.400000000000000,  0.278740346341705,
        -0.045932436716337, -0.060414218943499, 0.000000000000000,  0.000000000000000,  -0.057359833768515, -0.065970690290013, 0.000000000000000,
        0.000000000000000,  0.021483664255229,  0.043367478998707,  0.278740346341705,  0.400000000000000,  -0.025786249433209, -0.041989050570875,
        0.000000000000000,  0.000000000000000,  -0.133319695668718, -0.164377590018937, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.045932436716337, -0.025786249433209, 0.000000000000000,  0.000000000000000,  -0.050428638481962, -0.011725899408752,
        0.000000000000000,  0.000000000000000,  0.062275654808579,  0.080568617896221,  0.000000000000000,  0.000000000000000,  -0.060414218943499,
        -0.041989050570875, 0.000000000000000,  0.000000000000000,  -0.053374982423755, -0.010709328554693, 0.000000000000000,  0.000000000000000,
        0.117531006212484,  0.154251442722173,  -0.045932436716337, -0.060414218943499, 0.000000000000000,  0.000000000000000,  -0.050428638481962,
        -0.053374982423755, 0.400000000000000,  0.278740346341705,  -0.105159695242277, -0.120946265531691, 0.000000000000000,  0.000000000000000,
        -0.025786249433209, -0.041989050570875, 0.000000000000000,  0.000000000000000,  -0.011725899408752, -0.010709328554693, 0.278740346341705,
        0.400000000000000,  -0.244419442059316, -0.301358915034719, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.057359833768515, -0.133319695668718, 0.000000000000000,  0.000000000000000,  -0.105159695242277, -0.244419442059316, 0.000000000000000,
        0.000000000000000,  0.029321768483636,  -0.017782014674883, 0.000000000000000,  0.000000000000000,  -0.065970690290013, -0.164377590018937,
        0.000000000000000,  0.000000000000000,  -0.120946265531691, -0.301358915034719, 0.000000000000000,  0.000000000000000,  0.070788377751979,
        0.022956134971198,  0.033968538986498,  0.064107821570446,  0.000000000000000,  0.000000000000000,  0.062275654808579,  0.117531006212484,
        0.000000000000000,  0.000000000000000,  0.029321768483636,  0.070788377751979,  0.400000000000000,  0.278740346341705,  0.043946518852484,
        0.084137150575731,  0.000000000000000,  0.000000000000000,  0.080568617896221,  0.154251442722173,  0.000000000000000,  0.000000000000000,
        -0.017782014674883, 0.022956134971198,  0.278740346341705,  0.400000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 12, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.023104272399846,  -0.038394044481965, 0.000000000000000,  0.000000000000000,  -0.143436725839225,
        -0.265907983253657, 0.000000000000000,  0.000000000000000,  -0.052158809396082, -0.096693812092239, 0.000000000000000,  0.000000000000000,
        0.078721558017287,  0.015348270379127,  0.000000000000000,  0.000000000000000,  -0.171291447984607, -0.336349790510448, 0.000000000000000,
        0.000000000000000,  -0.062287799267130, -0.122309014731072, 0.023104272399846,  0.078721558017287,  0.600000000000000,  0.418110519512557,
        0.023998624211632,  0.067185823759568,  0.000000000000000,  0.000000000000000,  0.008726772440593,  0.024431208639843,  0.000000000000000,
        0.000000000000000,  -0.038394044481965, 0.015348270379127,  0.418110519512557,  0.600000000000000,  0.059080076701880,  0.119260567246444,
        0.000000000000000,  0.000000000000000,  0.021483664255229,  0.043367478998707,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.023998624211632,  0.059080076701880,  0.000000000000000,  0.000000000000000,  -0.075642957722943, -0.017588849113129,
        0.000000000000000,  0.000000000000000,  -0.045932436716337, -0.025786249433209, 0.000000000000000,  0.000000000000000,  0.067185823759568,
        0.119260567246444,  0.000000000000000,  0.000000000000000,  -0.080062473635632, -0.016063992832039, 0.000000000000000,  0.000000000000000,
        -0.060414218943499, -0.041989050570875, -0.143436725839225, -0.171291447984607, 0.000000000000000,  0.000000000000000,  -0.075642957722943,
        -0.080062473635632, 0.600000000000000,  0.418110519512557,  -0.045932436716337, -0.060414218943499, 0.000000000000000,  0.000000000000000,
        -0.265907983253657, -0.336349790510448, 0.000000000000000,  0.000000000000000,  -0.017588849113129, -0.016063992832039, 0.418110519512557,
        0.600000000000000,  -0.025786249433209, -0.041989050570875, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.008726772440593,  0.021483664255229,  0.000000000000000,  0.000000000000000,  -0.045932436716337, -0.025786249433209, 0.000000000000000,
        0.000000000000000,  0.033968538986498,  0.043946518852484,  0.000000000000000,  0.000000000000000,  0.024431208639843,  0.043367478998707,
        0.000000000000000,  0.000000000000000,  -0.060414218943499, -0.041989050570875, 0.000000000000000,  0.000000000000000,  0.064107821570446,
        0.084137150575731,  -0.052158809396082, -0.062287799267130, 0.000000000000000,  0.000000000000000,  -0.045932436716337, -0.060414218943499,
        0.000000000000000,  0.000000000000000,  0.033968538986498,  0.064107821570446,  0.600000000000000,  0.418110519512557,  -0.096693812092239,
        -0.122309014731072, 0.000000000000000,  0.000000000000000,  -0.025786249433209, -0.041989050570875, 0.000000000000000,  0.000000000000000,
        0.043946518852484,  0.084137150575731,  0.418110519512557,  0.600000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 12, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.023998624211632,  0.059080076701880,  0.000000000000000,  0.000000000000000,  -0.075642957722943,
        -0.017588849113129, 0.000000000000000,  0.000000000000000,  -0.045932436716337, -0.025786249433209, 0.000000000000000,  0.000000000000000,
        0.067185823759568,  0.119260567246444,  0.000000000000000,  0.000000000000000,  -0.080062473635632, -0.016063992832039, 0.000000000000000,
        0.000000000000000,  -0.060414218943499, -0.041989050570875, 0.023998624211632,  0.067185823759568,  1.100000000000001,  0.766535952439688,
        -0.166971330477956, -0.210140985496091, 0.000000000000000,  0.000000000000000,  -0.045932436716337, -0.060414218943499, 0.000000000000000,
        0.000000000000000,  0.059080076701880,  0.119260567246444,  0.766535952439688,  1.100000000000001,  -0.194855063634331, -0.264578733426708,
        0.000000000000000,  0.000000000000000,  -0.025786249433209, -0.041989050570875, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.166971330477956, -0.194855063634331, 0.000000000000000,  0.000000000000000,  -0.120319547303977, -0.161715381626219,
        0.000000000000000,  0.000000000000000,  -0.111314220318637, -0.129903375756221, 0.000000000000000,  0.000000000000000,  -0.210140985496091,
        -0.264578733426708, 0.000000000000000,  0.000000000000000,  -0.069644169059867, -0.120572725076784, 0.000000000000000,  0.000000000000000,
        -0.140093990330727, -0.176385822284472, -0.075642957722943, -0.080062473635632, 0.000000000000000,  0.000000000000000,  -0.120319547303977,
        -0.069644169059867, 1.100000000000001,  0.766535952439688,  -0.050428638481962, -0.053374982423755, 0.000000000000000,  0.000000000000000,
        -0.017588849113129, -0.016063992832039, 0.000000000000000,  0.000000000000000,  -0.161715381626219, -0.120572725076784, 0.766535952439688,
        1.100000000000001,  -0.011725899408752, -0.010709328554693, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.045932436716337, -0.025786249433209, 0.000000000000000,  0.000000000000000,  -0.050428638481962, -0.011725899408752, 0.000000000000000,
        0.000000000000000,  0.062275654808579,  0.080568617896221,  0.000000000000000,  0.000000000000000,  -0.060414218943499, -0.041989050570875,
        0.000000000000000,  0.000000000000000,  -0.053374982423755, -0.010709328554693, 0.000000000000000,  0.000000000000000,  0.117531006212484,
        0.154251442722173,  -0.045932436716337, -0.060414218943499, 0.000000000000000,  0.000000000000000,  -0.111314220318637, -0.140093990330727,
        0.000000000000000,  0.000000000000000,  0.062275654808579,  0.117531006212484,  1.100000000000001,  0.766535952439688,  -0.025786249433209,
        -0.041989050570875, 0.000000000000000,  0.000000000000000,  -0.129903375756221, -0.176385822284472, 0.000000000000000,  0.000000000000000,
        0.080568617896221,  0.154251442722173,  0.766535952439688,  1.100000000000001};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 12, 12));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeSDForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix dipxmat(4, 20);

    CDenseMatrix dipymat(4, 20);

    CDenseMatrix dipzmat(4, 20);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.029517842927713, -0.065349276073813, 0.000000000000000,  0.000000000000000,  0.040845776957765,
        0.038912150883398,  0.000000000000000,  0.000000000000000,  0.051022598126848,  0.062936575776069,  0.000000000000000,  0.000000000000000,
        -0.054116045367473, -0.119807006135323, 0.000000000000000,  0.000000000000000,  -0.035769322571534, -0.058895213185093, 0.000000000000000,
        0.000000000000000,  -0.045941809743883, -0.103046543661128, 0.000000000000000,  0.000000000000000,  0.042910580259079,  0.051425874341281,
        0.000000000000000,  0.000000000000000,  0.059349106149468,  0.089597063538206,  0.000000000000000,  0.000000000000000,  -0.084226651197120,
        -0.188918663378735, 0.000000000000000,  0.000000000000000,  -0.047532041143438, -0.088956373544893, 0.064331122509494,  0.092183313223273,
        0.000000000000000,  0.000000000000000,  0.053345535222451,  0.085928439853325,  0.000000000000000,  0.000000000000000,  0.027037357013414,
        0.047954984905049,  0.000000000000000,  0.000000000000000,  0.117940391267406,  0.169002740909333,  0.000000000000000,  0.000000000000000,
        0.021872507191424,  0.027604944630872,  0.000000000000000,  0.000000000000000,  0.087653751694619,  0.134213740231602,  0.000000000000000,
        0.000000000000000,  0.017443852943995,  0.034283916227521,  0.000000000000000,  0.000000000000000,  -0.016799995296760, -0.018369272440887,
        0.000000000000000,  0.000000000000000,  0.160698544773467,  0.246058523757937,  0.000000000000000,  0.000000000000000,  0.051564013606354,
        0.075970041640529,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 4, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.007301053782789, -0.031774623175452, 0.000000000000000, 0.000000000000000,  -0.020077897902669,
        -0.087380213732492, 0.000000000000000,  0.000000000000000,  0.076533897190271,  0.094404863664103, 0.000000000000000,  0.000000000000000,
        0.040845776957765,  0.038912150883398,  0.000000000000000,  0.000000000000000,  0.035087721603772, 0.070655478467003,  0.000000000000000,
        0.000000000000000,  -0.017624667023474, -0.053114097488849, 0.000000000000000,  0.000000000000000, -0.048467834314554, -0.146063768094334,
        0.000000000000000,  0.000000000000000,  0.089023659224202,  0.134395595307309,  0.000000000000000, 0.000000000000000,  0.042910580259079,
        0.051425874341281,  0.000000000000000,  0.000000000000000,  0.051793252506485,  0.110059162889485, 0.059052728710102,  0.087494463316523,
        0.000000000000000,  0.000000000000000,  0.162395003952781,  0.240609774120437,  0.000000000000000, 0.000000000000000,  0.040556035520120,
        0.071932477357573,  0.000000000000000,  0.000000000000000,  0.053345535222451,  0.085928439853325, 0.000000000000000,  0.000000000000000,
        -0.057056731342796, -0.080465798697819, 0.000000000000000,  0.000000000000000,  0.063721850506714, 0.099864892344559,  0.000000000000000,
        0.000000000000000,  0.175235088893463,  0.274628453947538,  0.000000000000000,  0.000000000000000, -0.025199992945140, -0.027553908661331,
        0.000000000000000,  0.000000000000000,  0.017443852943995,  0.034283916227521,  0.000000000000000, 0.000000000000000,  -0.085275044474983,
        -0.129538660746031, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 4, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.040845776957765,  0.038912150883398,  0.000000000000000,  0.000000000000000,  0.067955033903319,
        0.027509265807023,  0.000000000000000,  0.000000000000000,  -0.000584235875986, -0.079368119919462, 0.000000000000000,  0.000000000000000,
        0.045303355935546,  0.018339510538016,  0.000000000000000,  0.000000000000000,  -0.017019073732402, -0.016213396201416, 0.000000000000000,
        0.000000000000000,  0.042910580259079,  0.051425874341281,  0.000000000000000,  0.000000000000000,  0.056458438601647,  0.019674292835111,
        0.000000000000000,  0.000000000000000,  -0.032223667441081, -0.140206283528406, 0.000000000000000,  0.000000000000000,  0.037638959067764,
        0.013116195223408,  0.000000000000000,  0.000000000000000,  -0.017879408441283, -0.021427447642201, 0.053345535222451,  0.085928439853325,
        0.000000000000000,  0.000000000000000,  0.191632967926707,  0.297239817418706,  0.000000000000000,  0.000000000000000,  0.217033363485093,
        0.325375926601526,  0.000000000000000,  0.000000000000000,  0.127755311951138,  0.198159878279138,  0.000000000000000,  0.000000000000000,
        -0.022227306342688, -0.035803516605552, 0.000000000000000,  0.000000000000000,  0.017443852943995,  0.034283916227521,  0.000000000000000,
        0.000000000000000,  0.129281128038242,  0.216027631229095,  0.000000000000000,  0.000000000000000,  0.211995630798099,  0.336082709046033,
        0.000000000000000,  0.000000000000000,  0.086187418692161,  0.144018420819397,  0.000000000000000,  0.000000000000000,  -0.007268272059998,
        -0.014284965094800, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 4, 20));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeDSForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix dipxmat(20, 4);

    CDenseMatrix dipymat(20, 4);

    CDenseMatrix dipzmat(20, 4);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.064331122509494,  0.087653751694619,  0.000000000000000,  0.000000000000000,  0.092183313223273,
        0.134213740231602,  -0.029517842927713, -0.045941809743883, 0.000000000000000,  0.000000000000000,  -0.065349276073813, -0.103046543661128,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.053345535222451,  0.017443852943995,  0.000000000000000,
        0.000000000000000,  0.085928439853325,  0.034283916227521,  0.040845776957765,  0.042910580259079,  0.000000000000000,  0.000000000000000,
        0.038912150883398,  0.051425874341281,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.027037357013414,
        -0.016799995296760, 0.000000000000000,  0.000000000000000,  0.047954984905049,  -0.018369272440887, 0.051022598126848,  0.059349106149468,
        0.000000000000000,  0.000000000000000,  0.062936575776069,  0.089597063538206,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.117940391267406,  0.160698544773467,  0.000000000000000,  0.000000000000000,  0.169002740909333,  0.246058523757937,
        -0.054116045367473, -0.084226651197120, 0.000000000000000,  0.000000000000000,  -0.119807006135323, -0.188918663378735, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.021872507191424,  0.051564013606354,  0.000000000000000,  0.000000000000000,
        0.027604944630872,  0.075970041640529,  -0.035769322571534, -0.047532041143438, 0.000000000000000,  0.000000000000000,  -0.058895213185093,
        -0.088956373544893, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 20, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.059052728710102,  0.063721850506714,  0.000000000000000,  0.000000000000000,  0.087494463316523,
        0.099864892344559,  -0.007301053782789, -0.017624667023474, 0.000000000000000,  0.000000000000000,  -0.031774623175452, -0.053114097488849,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.162395003952781,  0.175235088893463,  0.000000000000000,
        0.000000000000000,  0.240609774120437,  0.274628453947538,  -0.020077897902669, -0.048467834314554, 0.000000000000000,  0.000000000000000,
        -0.087380213732492, -0.146063768094334, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.040556035520120,
        -0.025199992945140, 0.000000000000000,  0.000000000000000,  0.071932477357573,  -0.027553908661331, 0.076533897190271,  0.089023659224202,
        0.000000000000000,  0.000000000000000,  0.094404863664103,  0.134395595307309,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.053345535222451,  0.017443852943995,  0.000000000000000,  0.000000000000000,  0.085928439853325,  0.034283916227521,
        0.040845776957765,  0.042910580259079,  0.000000000000000,  0.000000000000000,  0.038912150883398,  0.051425874341281,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.057056731342796, -0.085275044474983, 0.000000000000000,  0.000000000000000,
        -0.080465798697819, -0.129538660746031, 0.035087721603772,  0.051793252506485,  0.000000000000000,  0.000000000000000,  0.070655478467003,
        0.110059162889485,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 20, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.053345535222451,  0.017443852943995,  0.000000000000000,  0.000000000000000,  0.085928439853325,
        0.034283916227521,  0.040845776957765,  0.042910580259079,  0.000000000000000,  0.000000000000000,  0.038912150883398,  0.051425874341281,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.191632967926707,  0.129281128038242,  0.000000000000000,
        0.000000000000000,  0.297239817418706,  0.216027631229095,  0.067955033903319,  0.056458438601647,  0.000000000000000,  0.000000000000000,
        0.027509265807023,  0.019674292835111,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.217033363485093,
        0.211995630798099,  0.000000000000000,  0.000000000000000,  0.325375926601526,  0.336082709046033,  -0.000584235875986, -0.032223667441081,
        0.000000000000000,  0.000000000000000,  -0.079368119919462, -0.140206283528406, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.127755311951138,  0.086187418692161,  0.000000000000000,  0.000000000000000,  0.198159878279138,  0.144018420819397,
        0.045303355935546,  0.037638959067764,  0.000000000000000,  0.000000000000000,  0.018339510538016,  0.013116195223408,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.022227306342688, -0.007268272059998, 0.000000000000000,  0.000000000000000,
        -0.035803516605552, -0.014284965094800, -0.017019073732402, -0.017879408441283, 0.000000000000000,  0.000000000000000,  -0.016213396201416,
        -0.021427447642201, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 20, 4));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputePDForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix dipxmat(12, 20);

    CDenseMatrix dipymat(12, 20);

    CDenseMatrix dipzmat(12, 20);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.349617712834821,  0.318985662246011,  0.010288257151929,  0.049535455135299,  0.000000000000000,  0.000000000000000,  -0.011840597315487,
        -0.028911332904561, 0.000000000000000,  0.000000000000000,  0.062507069502574,  0.046168308187163,  0.000000000000000,  0.000000000000000,
        -0.049163065270590, -0.059315754309583, 0.000000000000000,  0.000000000000000,  -0.005709485326793, -0.002899773627771, 0.407565378180889,
        0.456435464587638,  0.030084030652843,  0.102597043655030,  0.000000000000000,  0.000000000000000,  -0.027881108069280, -0.051201549196461,
        0.000000000000000,  0.000000000000000,  0.072204809613961,  0.071751191835876,  0.000000000000000,  0.000000000000000,  -0.072992712702514,
        -0.099336012927608, 0.000000000000000,  0.000000000000000,  -0.005667463745199, -0.004097034387803, 0.017698891391615,  0.043145975978101,
        0.319529770176054,  0.197048956002809,  0.014284877922122,  0.038898308870532,  0.000000000000000,  0.000000000000000,  -0.039193750512918,
        -0.058401792922264, -0.000000000000000, 0.000000000000000,  -0.096004486317210, -0.104912927033805, 0.000000000000000,  0.000000000000000,
        -0.049165367627843, -0.067400596199258, -0.000000000000000, 0.000000000000000,  0.098002152888245,  0.163660557451994,  0.338656629153741,
        0.559016994374948,  0.019705915663839,  0.041805889857113,  0.000000000000000,  0.000000000000000,  0.002481978879344,  -0.008288755617559,
        0.000000000000000,  0.000000000000000,  -0.119773444703856, -0.158458632643006, 0.000000000000000,  0.000000000000000,  -0.056241871034162,
        -0.083769748180012, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.049163065270590, -0.059315754309583,
        0.000000000000000,  0.000000000000000,  0.042072117651109,  0.008878257888114,  0.000000000000000,  0.000000000000000,  0.028819594716577,
        0.001417136163158,  0.349617712834821,  0.318985662246011,  -0.053027811757164, -0.026856046627043, 0.000000000000000,  0.000000000000000,
        -0.059990590238105, -0.053366090498765, 0.000000000000000,  0.000000000000000,  -0.072992712702514, -0.099336012927608, 0.000000000000000,
        0.000000000000000,  0.032965564705493,  0.006896674552802,  0.000000000000000,  0.000000000000000,  0.019296176510472,  -0.003975226287610,
        0.407565378180889,  0.456435464587638,  -0.063921735706456, -0.025335700266890, 0.000000000000000,  0.000000000000000,  -0.075676718987125,
        -0.085753205866933, -0.096004486317210, -0.104912927033805, 0.000000000000000,  0.000000000000000,  -0.047142845168843, -0.047064783623717,
        0.000000000000000,  0.000000000000000,  0.026767723153226,  0.052135492077139,  0.000000000000000,  0.000000000000000,  -0.105943250077520,
        -0.091969157323012, 0.319529770176054,  0.197048956002809,  -0.033196530732767, -0.031650452728054, 0.000000000000000,  0.000000000000000,
        -0.119773444703856, -0.158458632643006, 0.000000000000000,  0.000000000000000,  -0.005734602629476, -0.005631111192134, 0.000000000000000,
        0.000000000000000,  0.060850087900282,  0.095454811861108,  0.000000000000000,  0.000000000000000,  -0.056251525897024, -0.040414954285211,
        0.338656629153741,  0.559016994374948,  -0.070605396085730, -0.089693565646985, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.022065826898684, 0.014698932732199,  0.000000000000000,  0.000000000000000,  0.087888577445576,  0.184571581557099,
        -0.201851880618645, -0.184166457965365, 0.062013335411919,  0.116194271397584,  0.000000000000000,  0.000000000000000,  -0.040454015980920,
        0.026948043342364,  0.349617712834821,  0.318985662246011,  0.005779586908745,  0.036451443123565,  0.000000000000000,  0.000000000000000,
        -0.043828386296205, -0.014783465749323, 0.000000000000000,  0.000000000000000,  0.075331044048216,  0.194071397657246,  -0.235307980805108,
        -0.263523138347365, 0.035953511374232,  0.087189415689757,  0.000000000000000,  0.000000000000000,  -0.080352041543043, -0.027103020540425,
        0.407565378180890,  0.456435464587638,  0.034743945287785,  0.098923938519853,  0.027205615795501,  0.062123270501072,  0.000000000000000,
        0.000000000000000,  0.056973232435536,  0.102529961722508,  0.000000000000000,  0.000000000000000,  0.016351721358171,  0.036993433573112,
        -0.184480598825244, -0.113766267791757, 0.049876962291751,  0.113892662585299,  0.000000000000000,  0.000000000000000,  0.045052605347054,
        0.067971656329388,  0.319529770176054,  0.197048956002809,  -0.008094306281146, 0.012070649238584,  0.000000000000000,  0.000000000000000,
        0.040224527784422,  0.081107514918384,  0.000000000000000,  0.000000000000000,  -0.045302761795311, -0.056869514422170, -0.195523496004763,
        -0.322748612183952, -0.014839561515435, 0.022129523604071,  0.000000000000000,  0.000000000000000,  0.130271001238666,  0.202957536381918,
        0.338656629153741,  0.559016994374948};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 12, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.010646856245098, 0.020498479987741,  0.000000000000000,  0.000000000000000,  -0.029278854674020,
        0.056370819966288,  -0.201851880618645, -0.184166457965365, 0.114102559997397,  0.154667861553554,  0.000000000000000,  0.000000000000000,
        0.079527164495291,  0.133680224339894,  -0.349617712834821, -0.318985662246011, 0.007850697734497,  -0.051117031756873, 0.000000000000000,
        0.000000000000000,  -0.032493458805807, -0.006589396973717, 0.000000000000000,  0.000000000000000,  -0.089357011715970, -0.018120841677721,
        -0.235307980805108, -0.263523138347365, 0.096124186052533,  0.146982075552988,  0.000000000000000,  0.000000000000000,  0.071001396431206,
        0.144403391193442,  -0.407565378180890, -0.456435464587638, -0.002943176495280, -0.090018579051920, 0.014279828321918,  0.046056907440450,
        0.000000000000000,  0.000000000000000,  0.039269527885273,  0.126656495461237,  0.000000000000000,  0.000000000000000,  -0.016309737402594,
        -0.011674727195441, -0.184480598825244, -0.113766267791757, 0.014284877922122,  0.038898308870532,  0.000000000000000,  0.000000000000000,
        -0.062338207062645, -0.113046730471689, -0.319529770176054, -0.197048956002809, -0.011972726022478, 0.005380220099415,  0.000000000000000,
        0.000000000000000,  -0.032924996561815, 0.014795605273391,  0.000000000000000,  0.000000000000000,  -0.043234446062524, -0.063776810770135,
        -0.195523496004763, -0.322748612183952, 0.019705915663839,  0.041805889857113,  0.000000000000000,  0.000000000000000,  -0.121909737778823,
        -0.210228731939418, -0.338656629153741, -0.559016994374948, 0.000000000000000,  0.000000000000000,  -0.011840597315487, -0.028911332904561,
        0.349617712834821,  0.318985662246011,  -0.017967713714573, -0.019457498386948, 0.000000000000000,  0.000000000000000,  0.043229392074865,
        0.002125704244736,  0.000000000000000,  0.000000000000000,  0.042072117651109,  0.008878257888114,  0.000000000000000,  0.000000000000000,
        0.058583716059798,  0.064100380795406,  0.000000000000000,  0.000000000000000,  -0.027881108069280, -0.051201549196461, 0.407565378180889,
        0.456435464587638,  -0.036450431785212, -0.019588471472888, 0.000000000000000,  0.000000000000000,  0.028944264765708,  -0.005962839431416,
        0.000000000000000,  0.000000000000000,  0.032965564705493,  0.006896674552802,  0.000000000000000,  0.000000000000000,  0.082344027882093,
        0.106096119667483,  -0.087700267913042, -0.099396950300344, 0.000000000000000,  0.000000000000000,  -0.145228954384888, -0.131189810342777,
        0.319529770176054,  0.197048956002809,  0.040151584729839,  0.078203238115709,  0.000000000000000,  0.000000000000000,  -0.047142845168843,
        -0.047064783623717, 0.000000000000000,  0.000000000000000,  0.085340711651504,  0.091658177508792,  0.000000000000000,  0.000000000000000,
        -0.086959399328346, -0.117904875183814, 0.000000000000000,  0.000000000000000,  -0.061030361421587, -0.045107546945323, 0.338656629153741,
        0.559016994374948,  0.091275131850423,  0.143182217791662,  0.000000000000000,  0.000000000000000,  -0.005734602629476, -0.005631111192134,
        0.000000000000000,  0.000000000000000,  0.116573748417257,  0.152939028603192,  0.000000000000000,  0.000000000000000,  0.349617712834821,
        0.318985662246011,  0.010288257151929,  0.049535455135299,  0.000000000000000,  0.000000000000000,  -0.011840597315487, -0.028911332904561,
        0.000000000000000,  0.000000000000000,  0.062507069502574,  0.046168308187163,  0.000000000000000,  0.000000000000000,  -0.049163065270590,
        -0.059315754309583, 0.000000000000000,  0.000000000000000,  -0.005709485326793, -0.002899773627771, 0.407565378180889,  0.456435464587638,
        0.030084030652843,  0.102597043655030,  0.000000000000000,  0.000000000000000,  -0.027881108069280, -0.051201549196461, 0.000000000000000,
        0.000000000000000,  0.072204809613961,  0.071751191835876,  0.000000000000000,  0.000000000000000,  -0.072992712702514, -0.099336012927608,
        0.000000000000000,  0.000000000000000,  -0.005667463745199, -0.004097034387803, 0.064055775862144,  0.106007457419408,  0.319529770176054,
        0.197048956002809,  -0.087700267913042, -0.099396950300344, 0.000000000000000,  0.000000000000000,  -0.039193750512918, -0.058401792922264,
        -0.000000000000000, -0.000000000000000, 0.056973232435536,  0.102529961722508,  0.000000000000000,  0.000000000000000,  0.062091155101426,
        0.083466959259880,  0.000000000000000,  0.000000000000000,  0.146486386975602,  0.236256359743324,  0.338656629153741,  0.559016994374948,
        -0.086959399328346, -0.117904875183814, 0.000000000000000,  0.000000000000000,  0.002481978879344,  -0.008288755617559, -0.000000000000000,
        0.000000000000000,  0.040224527784422,  0.081107514918384,  0.000000000000000,  0.000000000000000,  0.060120290775494,  0.090460177319181,
        0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 12, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.011840597315487, -0.028911332904561, 0.349617712834821,  0.318985662246011,  -0.017967713714573,
        -0.019457498386948, 0.000000000000000,  0.000000000000000,  0.043229392074865,  0.002125704244736,  0.000000000000000,  0.000000000000000,
        0.042072117651109,  0.008878257888114,  0.000000000000000,  0.000000000000000,  0.058583716059798,  0.064100380795406,  0.000000000000000,
        0.000000000000000,  -0.027881108069280, -0.051201549196461, 0.407565378180889,  0.456435464587638,  -0.036450431785212, -0.019588471472888,
        0.000000000000000,  0.000000000000000,  0.028944264765708,  -0.005962839431416, 0.000000000000000,  0.000000000000000,  0.032965564705493,
        0.006896674552802,  0.000000000000000,  0.000000000000000,  0.082344027882093,  0.106096119667483,  0.014284877922122,  0.038898308870532,
        0.000000000000000,  0.000000000000000,  0.051787804614860,  0.135971485782779,  0.319529770176054,  0.197048956002809,  -0.224813596575900,
        -0.281098384879085, -0.000000000000000, 0.000000000000000,  -0.102771106533478, -0.122498561353286, 0.000000000000000,  0.000000000000000,
        -0.067637007101242, -0.115784711247521, -0.000000000000000, 0.000000000000000,  0.019705915663839,  0.041805889857113,  0.000000000000000,
        0.000000000000000,  0.145027633449680,  0.263424612792832,  0.338656629153741,  0.559016994374948,  -0.185849485607282, -0.271758521558209,
        0.000000000000000,  0.000000000000000,  -0.063915683534304, -0.092746073941731, 0.000000000000000,  0.000000000000000,  -0.043424224071021,
        -0.086627118958199, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.091909078638806,  0.097564561839635,
        0.000000000000000,  0.000000000000000,  0.104180364839760,  0.124153028515442,  0.403703761237291,  0.368332915930731,  -0.040831719865974,
        0.032544757309740,  0.000000000000000,  0.000000000000000,  0.069453576559840,  0.082768685676961,  0.000000000000000,  0.000000000000000,
        -0.038295449432836, -0.040651900766514, 0.000000000000000,  0.000000000000000,  0.086901476251213,  0.113590278401840,  0.000000000000000,
        0.000000000000000,  0.043119953328055,  0.077647337137176,  0.470615961610217,  0.527046276694730,  -0.107899592229590, -0.023422898418492,
        0.000000000000000,  0.000000000000000,  0.028746635552037,  0.051764891424784,  0.000000000000000,  0.000000000000000,  -0.036208948438005,
        -0.047329282667433, -0.047142845168843, -0.047064783623717, 0.000000000000000,  0.000000000000000,  -0.111800613212227, -0.061119122809783,
        0.000000000000000,  0.000000000000000,  -0.012971096117893, 0.114351043176345,  0.368961197650488,  0.227532535583514,  -0.074533742141485,
        -0.040746081873189, 0.000000000000000,  0.000000000000000,  0.019642852153684,  0.019610326509882,  0.000000000000000,  0.000000000000000,
        -0.005734602629476, -0.005631111192134, 0.000000000000000,  0.000000000000000,  -0.078254027288632, -0.063398785290646, 0.000000000000000,
        0.000000000000000,  0.029571575230960,  0.147658548191922,  0.391046992009527,  0.645497224367903,  -0.052169351525755, -0.042265856860431,
        0.000000000000000,  0.000000000000000,  0.002389417762282,  0.002346296330056,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.049163065270590, -0.059315754309583, 0.000000000000000,  0.000000000000000,  0.042072117651109,  0.008878257888114,
        0.000000000000000,  0.000000000000000,  0.028819594716577,  0.001417136163158,  0.349617712834821,  0.318985662246011,  -0.053027811757164,
        -0.026856046627043, 0.000000000000000,  0.000000000000000,  -0.059990590238105, -0.053366090498765, 0.000000000000000,  0.000000000000000,
        -0.072992712702514, -0.099336012927608, 0.000000000000000,  0.000000000000000,  0.032965564705493,  0.006896674552802,  0.000000000000000,
        0.000000000000000,  0.019296176510472,  -0.003975226287610, 0.407565378180889,  0.456435464587638,  -0.063921735706456, -0.025335700266890,
        0.000000000000000,  0.000000000000000,  -0.075676718987125, -0.085753205866933, 0.056973232435536,  0.102529961722508,  0.000000000000000,
        0.000000000000000,  -0.102771106533478, -0.122498561353286, 0.000000000000000,  0.000000000000000,  -0.149875731050600, -0.187398923252723,
        -0.000000000000000, -0.000000000000000, 0.137430393392758,  0.238053620243851,  0.319529770176054,  0.197048956002809,  0.068788615102397,
        0.106644806442821,  0.000000000000000,  0.000000000000000,  0.040224527784422,  0.081107514918384,  0.000000000000000,  0.000000000000000,
        -0.063915683534304, -0.092746073941730, 0.000000000000000,  0.000000000000000,  -0.123899657071521, -0.181172347705473, -0.000000000000000,
        0.000000000000000,  0.198290703061600,  0.340713007744274,  0.338656629153741,  0.559016994374948,  0.036059918906456,  0.070017199393942,
        0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 12, 20));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeDPForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix dipxmat(20, 12);

    CDenseMatrix dipymat(20, 12);

    CDenseMatrix dipzmat(20, 12);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.349617712834821,  0.407565378180889,  0.017698891391615,  0.098002152888245,  0.000000000000000,  0.000000000000000,  -0.096004486317210,
        -0.119773444703856, 0.000000000000000,  0.000000000000000,  0.027205615795501,  -0.008094306281146, 0.318985662246011,  0.456435464587638,
        0.043145975978101,  0.163660557451994,  0.000000000000000,  0.000000000000000,  -0.104912927033805, -0.158458632643006, 0.000000000000000,
        0.000000000000000,  0.062123270501072,  0.012070649238584,  0.010288257151929,  0.030084030652843,  0.319529770176054,  0.338656629153741,
        -0.049163065270590, -0.072992712702514, 0.000000000000000,  0.000000000000000,  -0.022065826898684, -0.043828386296205, 0.000000000000000,
        0.000000000000000,  0.049535455135299,  0.102597043655030,  0.197048956002809,  0.559016994374948,  -0.059315754309583, -0.099336012927608,
        0.000000000000000,  0.000000000000000,  0.014698932732199,  -0.014783465749323, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.014284877922122,  0.019705915663839,  0.000000000000000,  0.000000000000000,  -0.047142845168843, -0.005734602629476,
        0.000000000000000,  0.000000000000000,  0.056973232435536,  0.040224527784422,  0.000000000000000,  0.000000000000000,  0.038898308870532,
        0.041805889857113,  0.000000000000000,  0.000000000000000,  -0.047064783623717, -0.005631111192134, 0.000000000000000,  0.000000000000000,
        0.102529961722508,  0.081107514918384,  -0.011840597315487, -0.027881108069280, 0.000000000000000,  0.000000000000000,  0.042072117651109,
        0.032965564705493,  0.000000000000000,  0.000000000000000,  0.087888577445576,  0.075331044048216,  0.000000000000000,  0.000000000000000,
        -0.028911332904561, -0.051201549196461, 0.000000000000000,  0.000000000000000,  0.008878257888114,  0.006896674552802,  0.000000000000000,
        0.000000000000000,  0.184571581557099,  0.194071397657246,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.039193750512918, 0.002481978879344,  0.000000000000000,  0.000000000000000,  0.026767723153226,  0.060850087900282,  -0.201851880618645,
        -0.235307980805108, 0.016351721358171,  -0.045302761795311, 0.000000000000000,  0.000000000000000,  -0.058401792922264, -0.008288755617559,
        0.000000000000000,  0.000000000000000,  0.052135492077139,  0.095454811861108,  -0.184166457965365, -0.263523138347365, 0.036993433573112,
        -0.056869514422170, 0.062507069502574,  0.072204809613961,  -0.000000000000000, 0.000000000000000,  0.028819594716577,  0.019296176510472,
        0.000000000000000,  0.000000000000000,  0.062013335411919,  0.035953511374232,  -0.184480598825244, -0.195523496004763, 0.046168308187163,
        0.071751191835876,  0.000000000000000,  0.000000000000000,  0.001417136163158,  -0.003975226287610, 0.000000000000000,  0.000000000000000,
        0.116194271397584,  0.087189415689757,  -0.113766267791757, -0.322748612183952, 0.000000000000000,  0.000000000000000,  -0.096004486317210,
        -0.119773444703856, 0.349617712834821,  0.407565378180889,  -0.105943250077520, -0.056251525897024, 0.000000000000000,  0.000000000000000,
        0.049876962291751,  -0.014839561515435, 0.000000000000000,  0.000000000000000,  -0.104912927033805, -0.158458632643006, 0.318985662246011,
        0.456435464587638,  -0.091969157323012, -0.040414954285211, 0.000000000000000,  0.000000000000000,  0.113892662585299,  0.022129523604071,
        -0.049163065270590, -0.072992712702514, 0.000000000000000,  0.000000000000000,  -0.053027811757164, -0.063921735706456, 0.319529770176054,
        0.338656629153741,  -0.040454015980920, -0.080352041543043, 0.000000000000000,  0.000000000000000,  -0.059315754309583, -0.099336012927608,
        0.000000000000000,  0.000000000000000,  -0.026856046627043, -0.025335700266890, 0.197048956002809,  0.559016994374948,  0.026948043342364,
        -0.027103020540425, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.049165367627843, -0.056241871034162,
        0.000000000000000,  0.000000000000000,  -0.033196530732767, -0.070605396085730, 0.349617712834821,  0.407565378180890,  0.045052605347054,
        0.130271001238666,  0.000000000000000,  0.000000000000000,  -0.067400596199258, -0.083769748180012, 0.000000000000000,  0.000000000000000,
        -0.031650452728054, -0.089693565646985, 0.318985662246011,  0.456435464587638,  0.067971656329388,  0.202957536381918,  -0.005709485326793,
        -0.005667463745199, -0.000000000000000, 0.000000000000000,  -0.059990590238105, -0.075676718987125, 0.000000000000000,  0.000000000000000,
        0.005779586908745,  0.034743945287785,  0.319529770176054,  0.338656629153741,  -0.002899773627771, -0.004097034387803, 0.000000000000000,
        0.000000000000000,  -0.053366090498765, -0.085753205866933, 0.000000000000000,  0.000000000000000,  0.036451443123565,  0.098923938519853,
        0.197048956002809,  0.559016994374948};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 20, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.014279828321918,  -0.011972726022478, 0.000000000000000,  0.000000000000000,  -0.087700267913042,
        -0.086959399328346, 0.349617712834821,  0.407565378180889,  0.064055775862144,  0.146486386975602,  0.000000000000000,  0.000000000000000,
        0.046056907440450,  0.005380220099415,  0.000000000000000,  0.000000000000000,  -0.099396950300344, -0.117904875183814, 0.318985662246011,
        0.456435464587638,  0.106007457419408,  0.236256359743324,  -0.010646856245098, -0.032493458805807, 0.000000000000000,  0.000000000000000,
        -0.011840597315487, -0.027881108069280, 0.000000000000000,  0.000000000000000,  0.010288257151929,  0.030084030652843,  0.319529770176054,
        0.338656629153741,  0.020498479987741,  -0.006589396973717, 0.000000000000000,  0.000000000000000,  -0.028911332904561, -0.051201549196461,
        0.000000000000000,  0.000000000000000,  0.049535455135299,  0.102597043655030,  0.197048956002809,  0.559016994374948,  0.000000000000000,
        0.000000000000000,  0.039269527885273,  -0.032924996561815, 0.349617712834821,  0.407565378180889,  -0.145228954384888, -0.061030361421587,
        0.000000000000000,  0.000000000000000,  -0.087700267913042, -0.086959399328346, 0.000000000000000,  0.000000000000000,  0.126656495461237,
        0.014795605273391,  0.318985662246011,  0.456435464587638,  -0.131189810342777, -0.045107546945323, 0.000000000000000,  0.000000000000000,
        -0.099396950300344, -0.117904875183814, -0.029278854674020, -0.089357011715970, 0.000000000000000,  0.000000000000000,  -0.017967713714573,
        -0.036450431785212, 0.319529770176054,  0.338656629153741,  -0.011840597315487, -0.027881108069280, 0.000000000000000,  0.000000000000000,
        0.056370819966288,  -0.018120841677721, 0.000000000000000,  0.000000000000000,  -0.019457498386948, -0.019588471472888, 0.197048956002809,
        0.559016994374948,  -0.028911332904561, -0.051201549196461, 0.000000000000000,  0.000000000000000,  -0.201851880618645, -0.235307980805108,
        -0.016309737402594, -0.043234446062524, 0.000000000000000,  0.000000000000000,  0.040151584729839,  0.091275131850423,  0.000000000000000,
        0.000000000000000,  -0.039193750512918, 0.002481978879344,  -0.184166457965365, -0.263523138347365, -0.011674727195441, -0.063776810770135,
        0.000000000000000,  0.000000000000000,  0.078203238115709,  0.143182217791662,  0.000000000000000,  0.000000000000000,  -0.058401792922264,
        -0.008288755617559, 0.114102559997397,  0.096124186052533,  -0.184480598825244, -0.195523496004763, 0.043229392074865,  0.028944264765708,
        0.000000000000000,  0.000000000000000,  0.062507069502574,  0.072204809613961,  -0.000000000000000, -0.000000000000000, 0.154667861553554,
        0.146982075552988,  -0.113766267791757, -0.322748612183952, 0.002125704244736,  -0.005962839431416, 0.000000000000000,  0.000000000000000,
        0.046168308187163,  0.071751191835876,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.014284877922122,
        0.019705915663839,  0.000000000000000,  0.000000000000000,  -0.047142845168843, -0.005734602629476, 0.000000000000000,  0.000000000000000,
        0.056973232435536,  0.040224527784422,  0.000000000000000,  0.000000000000000,  0.038898308870532,  0.041805889857113,  0.000000000000000,
        0.000000000000000,  -0.047064783623717, -0.005631111192134, 0.000000000000000,  0.000000000000000,  0.102529961722508,  0.081107514918384,
        0.079527164495291,  0.071001396431206,  0.000000000000000,  0.000000000000000,  0.042072117651109,  0.032965564705493,  0.000000000000000,
        0.000000000000000,  -0.049163065270590, -0.072992712702514, 0.000000000000000,  0.000000000000000,  0.133680224339894,  0.144403391193442,
        0.000000000000000,  0.000000000000000,  0.008878257888114,  0.006896674552802,  0.000000000000000,  0.000000000000000,  -0.059315754309583,
        -0.099336012927608, 0.000000000000000,  0.000000000000000,  -0.349617712834821, -0.407565378180890, -0.062338207062645, -0.121909737778823,
        0.000000000000000,  0.000000000000000,  0.085340711651504,  0.116573748417257,  0.000000000000000,  0.000000000000000,  0.062091155101426,
        0.060120290775494,  -0.318985662246011, -0.456435464587638, -0.113046730471689, -0.210228731939418, 0.000000000000000,  0.000000000000000,
        0.091658177508792,  0.152939028603192,  0.000000000000000,  0.000000000000000,  0.083466959259880,  0.090460177319181,  0.007850697734497,
        -0.002943176495280, -0.319529770176054, -0.338656629153741, 0.058583716059798,  0.082344027882093,  0.000000000000000,  0.000000000000000,
        -0.005709485326793, -0.005667463745199, 0.000000000000000,  0.000000000000000,  -0.051117031756873, -0.090018579051920, -0.197048956002809,
        -0.559016994374948, 0.064100380795406,  0.106096119667483,  0.000000000000000,  0.000000000000000,  -0.002899773627771, -0.004097034387803,
        0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 20, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.014284877922122,  0.019705915663839,  0.000000000000000,  0.000000000000000,  -0.047142845168843,
        -0.005734602629476, 0.000000000000000,  0.000000000000000,  0.056973232435536,  0.040224527784422,  0.000000000000000,  0.000000000000000,
        0.038898308870532,  0.041805889857113,  0.000000000000000,  0.000000000000000,  -0.047064783623717, -0.005631111192134, 0.000000000000000,
        0.000000000000000,  0.102529961722508,  0.081107514918384,  -0.011840597315487, -0.027881108069280, 0.000000000000000,  0.000000000000000,
        0.091909078638806,  0.086901476251213,  0.000000000000000,  0.000000000000000,  -0.049163065270590, -0.072992712702514, 0.000000000000000,
        0.000000000000000,  -0.028911332904561, -0.051201549196461, 0.000000000000000,  0.000000000000000,  0.097564561839635,  0.113590278401840,
        0.000000000000000,  0.000000000000000,  -0.059315754309583, -0.099336012927608, 0.000000000000000,  0.000000000000000,  0.349617712834821,
        0.407565378180889,  0.051787804614860,  0.145027633449680,  0.000000000000000,  0.000000000000000,  -0.111800613212227, -0.078254027288632,
        0.000000000000000,  0.000000000000000,  -0.102771106533478, -0.063915683534304, 0.318985662246011,  0.456435464587638,  0.135971485782779,
        0.263424612792832,  0.000000000000000,  0.000000000000000,  -0.061119122809783, -0.063398785290646, 0.000000000000000,  0.000000000000000,
        -0.122498561353286, -0.092746073941730, -0.017967713714573, -0.036450431785212, 0.319529770176054,  0.338656629153741,  0.104180364839760,
        0.043119953328055,  0.000000000000000,  0.000000000000000,  0.042072117651109,  0.032965564705493,  0.000000000000000,  0.000000000000000,
        -0.019457498386948, -0.019588471472888, 0.197048956002809,  0.559016994374948,  0.124153028515442,  0.077647337137176,  0.000000000000000,
        0.000000000000000,  0.008878257888114,  0.006896674552802,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.224813596575900, -0.185849485607282, 0.403703761237291,  0.470615961610217,  -0.012971096117893, 0.029571575230960,  0.000000000000000,
        0.000000000000000,  -0.149875731050600, -0.123899657071521, 0.000000000000000,  0.000000000000000,  -0.281098384879085, -0.271758521558209,
        0.368332915930731,  0.527046276694730,  0.114351043176345,  0.147658548191922,  0.000000000000000,  0.000000000000000,  -0.187398923252723,
        -0.181172347705473, 0.043229392074865,  0.028944264765708,  -0.000000000000000, 0.000000000000000,  -0.040831719865974, -0.107899592229590,
        0.368961197650488,  0.391046992009527,  0.028819594716577,  0.019296176510472,  -0.000000000000000, -0.000000000000000, 0.002125704244736,
        -0.005962839431416, 0.000000000000000,  0.000000000000000,  0.032544757309740,  -0.023422898418492, 0.227532535583514,  0.645497224367903,
        0.001417136163158,  -0.003975226287610, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.102771106533478,
        -0.063915683534304, 0.000000000000000,  0.000000000000000,  -0.074533742141485, -0.052169351525755, 0.349617712834821,  0.407565378180889,
        0.137430393392758,  0.198290703061600,  0.000000000000000,  0.000000000000000,  -0.122498561353286, -0.092746073941731, 0.000000000000000,
        0.000000000000000,  -0.040746081873189, -0.042265856860431, 0.318985662246011,  0.456435464587638,  0.238053620243851,  0.340713007744274,
        0.042072117651109,  0.032965564705493,  0.000000000000000,  0.000000000000000,  0.069453576559840,  0.028746635552037,  0.000000000000000,
        0.000000000000000,  -0.053027811757164, -0.063921735706456, 0.319529770176054,  0.338656629153741,  0.008878257888114,  0.006896674552802,
        0.000000000000000,  0.000000000000000,  0.082768685676961,  0.051764891424784,  0.000000000000000,  0.000000000000000,  -0.026856046627043,
        -0.025335700266890, 0.197048956002809,  0.559016994374948,  0.000000000000000,  0.000000000000000,  -0.067637007101242, -0.043424224071021,
        0.000000000000000,  0.000000000000000,  0.019642852153684,  0.002389417762282,  0.000000000000000,  0.000000000000000,  0.068788615102397,
        0.036059918906456,  0.000000000000000,  0.000000000000000,  -0.115784711247521, -0.086627118958199, 0.000000000000000,  0.000000000000000,
        0.019610326509882,  0.002346296330056,  0.000000000000000,  0.000000000000000,  0.106644806442821,  0.070017199393942,  0.058583716059798,
        0.082344027882093,  -0.000000000000000, 0.000000000000000,  -0.038295449432836, -0.036208948438005, 0.000000000000000,  0.000000000000000,
        -0.059990590238105, -0.075676718987125, 0.000000000000000,  0.000000000000000,  0.064100380795406,  0.106096119667483,  0.000000000000000,
        0.000000000000000,  -0.040651900766514, -0.047329282667433, 0.000000000000000,  0.000000000000000,  -0.053366090498765, -0.085753205866933,
        0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 20, 12));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeSFForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix dipxmat(4, 28);

    CDenseMatrix dipymat(4, 28);

    CDenseMatrix dipzmat(4, 28);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.028435554111359,  0.047353163720076,  0.000000000000000,  0.000000000000000,  0.043774679254897,
        0.089261940915617,  0.000000000000000,  0.000000000000000,  -0.043285468448763, -0.042779744786085, 0.000000000000000,  0.000000000000000,
        -0.045064660559828, -0.065186058366081, -0.000000000000000, -0.000000000000000, 0.040189084510415,  0.084041720979811,  0.000000000000000,
        0.000000000000000,  0.054036068457811,  0.080633856789127,  -0.000000000000000, -0.000000000000000, -0.005852681136953, -0.014634123838219,
        0.000000000000000,  0.000000000000000,  0.030299463911526,  0.062787051993082,  0.000000000000000,  0.000000000000000,  0.052482512536987,
        0.121661272377577,  0.000000000000000,  0.000000000000000,  -0.035668479727796, -0.050803233292216, 0.000000000000000,  0.000000000000000,
        -0.044501118526870, -0.084440471369249, -0.000000000000000, -0.000000000000000, 0.048929749267715,  0.114891296112692,  0.000000000000000,
        0.000000000000000,  0.054241789082238,  0.105025799090914,  -0.000000000000000, 0.000000000000000,  -0.007980120685376, -0.020391281567628,
        0.035333567451981,  0.046000162860396,  0.000000000000000,  0.000000000000000,  0.108416290266377,  0.147574296309128,  0.000000000000000,
        0.000000000000000,  0.042946351303390,  0.067422799610670,  -0.000000000000000, 0.000000000000000,  -0.023449973153367, -0.026655877338049,
        0.000000000000000,  0.000000000000000,  0.106439380358320,  0.145295546237467,  -0.000000000000000, -0.000000000000000, 0.036274319689750,
        0.043551200317673,  0.000000000000000,  0.000000000000000,  -0.023407648000592, -0.032394194961280, -0.000000000000000, 0.000000000000000,
        0.033135896012704,  0.052938020563675,  0.000000000000000,  0.000000000000000,  0.079493392874166,  0.129380931771497,  0.000000000000000,
        0.000000000000000,  0.000560577584610,  0.005160790859801,  0.000000000000000,  0.000000000000000,  -0.035353871122424, -0.055046386098853,
        0.000000000000000,  0.000000000000000,  0.076621866273050,  0.124902655216347,  -0.000000000000000, 0.000000000000000,  0.046692214773095,
        0.073234489681980,  0.000000000000000,  0.000000000000000,  -0.015327235881671, -0.025198293358530, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 4, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.014296000695819, -0.021811247676945, 0.000000000000000,  0.000000000000000,  0.010065466461306,
        0.043257271242169,  -0.000000000000000, 0.000000000000000,  0.004117860803113,  0.048391933658074,  0.000000000000000,  0.000000000000000,
        -0.067596990839743, -0.097779087549122, 0.000000000000000,  0.000000000000000,  -0.043285468448763, -0.042779744786085, 0.000000000000000,
        0.000000000000000,  -0.052377623123778, -0.096574751131326, 0.000000000000000,  0.000000000000000,  -0.019921282287293, -0.040115727916319,
        0.000000000000000,  -0.000000000000000, -0.014521115447350, -0.028517066436771, 0.000000000000000,  0.000000000000000,  0.020177997544468,
        0.062708834785670,  -0.000000000000000, -0.000000000000000, 0.019206016161219,  0.072555268369179,  0.000000000000000,  0.000000000000000,
        -0.066751677790305, -0.126660707053874, 0.000000000000000,  0.000000000000000,  -0.035668479727796, -0.050803233292216, 0.000000000000000,
        0.000000000000000,  -0.059147167403072, -0.129940678437298, 0.000000000000000,  0.000000000000000,  -0.023703502807014, -0.054592983217476,
        -0.011176239015467, -0.013766173755390, 0.000000000000000,  0.000000000000000,  0.099972301578482,  0.140561067197172,  0.000000000000000,
        0.000000000000000,  0.142228006444479,  0.201481212579692,  0.000000000000000,  -0.000000000000000, -0.035174959730050, -0.039983816007074,
        0.000000000000000,  0.000000000000000,  0.042946351303390,  0.067422799610670,  -0.000000000000000, 0.000000000000000,  -0.095953641635972,
        -0.128594104963139, 0.000000000000000,  0.000000000000000,  -0.047667761386561, -0.064784722059613, -0.000000000000000, -0.000000000000000,
        -0.013185781531112, -0.020775176316524, -0.000000000000000, 0.000000000000000,  0.057844349462020,  0.096268927462294,  0.000000000000000,
        0.000000000000000,  0.077089014260225,  0.129203314266181,  -0.000000000000000, 0.000000000000000,  -0.053030806683635, -0.082569579148280,
        0.000000000000000,  0.000000000000000,  0.000560577584610,  0.005160790859801,  -0.000000000000000, 0.000000000000000,  -0.077311453478506,
        -0.124874193944914, 0.000000000000000,  0.000000000000000,  -0.035295345777973, -0.057398306656454, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 4, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.003512137127427, -0.002985442269050, 0.000000000000000,  0.000000000000000,  -0.038827941254737,
        -0.014077177403380, 0.000000000000000,  0.000000000000000,  -0.013547996812039, 0.054324737839546,  -0.000000000000000, -0.000000000000000,
        0.045199807725120,  0.096456703700769,  0.000000000000000,  0.000000000000000,  -0.009031997874692, 0.036216491893031,  0.000000000000000,
        0.000000000000000,  0.016178308856141,  0.005865490584742,  0.000000000000000,  0.000000000000000,  0.017950923095740,  0.015258927152922,
        0.000000000000000,  0.000000000000000,  -0.002720833955611, -0.003380053369938, 0.000000000000000,  0.000000000000000,  -0.023326890043457,
        -0.008446666788201, 0.000000000000000,  0.000000000000000,  0.012994471482178,  0.087563511416203,  -0.000000000000000, 0.000000000000000,
        0.055721226488598,  0.132175087664006,  0.000000000000000,  0.000000000000000,  0.008662980988118,  0.058375674277469,  0.000000000000000,
        0.000000000000000,  0.009719537518107,  0.003519444495084,  0.000000000000000,  0.000000000000000,  0.013906484662012,  0.017275828335236,
        0.005087854998014,  0.007748630669677,  0.000000000000000,  0.000000000000000,  0.118731869563072,  0.174446416314159,  0.000000000000000,
        0.000000000000000,  0.236976531970896,  0.338720635707197,  -0.000000000000000, 0.000000000000000,  0.126103646239066,  0.172495316783746,
        -0.000000000000000, -0.000000000000000, 0.157984354647264,  0.225813757138131,  -0.000000000000000, -0.000000000000000, -0.049471612317947,
        -0.072686006797566, 0.000000000000000,  0.000000000000000,  -0.026004592212073, -0.039604112311683, 0.000000000000000,  -0.000000000000000,
        0.000890773028174,  0.001839868013271,  0.000000000000000,  0.000000000000000,  0.042791757199347,  0.075726852267893,  0.000000000000000,
        0.000000000000000,  0.118031814290513,  0.199759314828519,  0.000000000000000,  0.000000000000000,  0.089545910559719,  0.146142674843159,
        0.000000000000000,  -0.000000000000000, 0.078687876193675,  0.133172876552346,  0.000000000000000,  0.000000000000000,  -0.017829898833061,
        -0.031552855111622, 0.000000000000000,  0.000000000000000,  -0.004552839921776, -0.009403769845610, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 4, 28));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeFSForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix dipxmat(28, 4);

    CDenseMatrix dipymat(28, 4);

    CDenseMatrix dipzmat(28, 4);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.035333567451981,  0.033135896012704,  0.000000000000000,  0.000000000000000,  0.046000162860396,
        0.052938020563675,  0.028435554111359,  0.030299463911526,  0.000000000000000,  0.000000000000000,  0.047353163720076,  0.062787051993082,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.108416290266377,  0.079493392874166,  0.000000000000000,
        0.000000000000000,  0.147574296309128,  0.129380931771497,  0.043774679254897,  0.052482512536987,  0.000000000000000,  0.000000000000000,
        0.089261940915617,  0.121661272377577,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.042946351303390,
        0.000560577584610,  0.000000000000000,  0.000000000000000,  0.067422799610670,  0.005160790859801,  -0.043285468448763, -0.035668479727796,
        -0.000000000000000, 0.000000000000000,  -0.042779744786085, -0.050803233292216, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.023449973153367, -0.035353871122424, 0.000000000000000,  0.000000000000000,  -0.026655877338049, -0.055046386098853,
        -0.045064660559828, -0.044501118526870, 0.000000000000000,  0.000000000000000,  -0.065186058366081, -0.084440471369249, 0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.106439380358320,  0.076621866273050,  -0.000000000000000, -0.000000000000000,
        0.145295546237467,  0.124902655216347,  0.040189084510415,  0.048929749267715,  -0.000000000000000, -0.000000000000000, 0.084041720979811,
        0.114891296112692,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.036274319689750,  0.046692214773095,
        0.000000000000000,  0.000000000000000,  0.043551200317673,  0.073234489681980,  0.054036068457811,  0.054241789082238,  0.000000000000000,
        0.000000000000000,  0.080633856789127,  0.105025799090914,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000,
        -0.023407648000592, -0.015327235881671, -0.000000000000000, 0.000000000000000,  -0.032394194961280, -0.025198293358530, -0.005852681136953,
        -0.007980120685376, -0.000000000000000, 0.000000000000000,  -0.014634123838219, -0.020391281567628, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 28, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.011176239015467, -0.013185781531112, 0.000000000000000,  -0.000000000000000, -0.013766173755390,
        -0.020775176316524, -0.014296000695819, -0.014521115447350, 0.000000000000000,  -0.000000000000000, -0.021811247676945, -0.028517066436771,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.099972301578482,  0.057844349462020,  0.000000000000000,
        0.000000000000000,  0.140561067197172,  0.096268927462294,  0.010065466461306,  0.020177997544468,  0.000000000000000,  0.000000000000000,
        0.043257271242169,  0.062708834785670,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.142228006444479,
        0.077089014260225,  0.000000000000000,  -0.000000000000000, 0.201481212579692,  0.129203314266181,  0.004117860803113,  0.019206016161219,
        0.000000000000000,  -0.000000000000000, 0.048391933658074,  0.072555268369179,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.035174959730050, -0.053030806683635, 0.000000000000000,  0.000000000000000,  -0.039983816007074, -0.082569579148280,
        -0.067596990839743, -0.066751677790305, 0.000000000000000,  0.000000000000000,  -0.097779087549122, -0.126660707053874, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.042946351303390,  0.000560577584610,  0.000000000000000,  0.000000000000000,
        0.067422799610670,  0.005160790859801,  -0.043285468448763, -0.035668479727796, -0.000000000000000, -0.000000000000000, -0.042779744786085,
        -0.050803233292216, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.095953641635972, -0.077311453478506,
        0.000000000000000,  0.000000000000000,  -0.128594104963139, -0.124874193944914, -0.052377623123778, -0.059147167403072, 0.000000000000000,
        0.000000000000000,  -0.096574751131326, -0.129940678437298, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.047667761386561, -0.035295345777973, 0.000000000000000,  0.000000000000000,  -0.064784722059613, -0.057398306656454, -0.019921282287293,
        -0.023703502807014, -0.000000000000000, -0.000000000000000, -0.040115727916319, -0.054592983217476, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 28, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.005087854998014,  0.000890773028174,  0.000000000000000,  0.000000000000000,  0.007748630669677,
        0.001839868013271,  -0.003512137127427, -0.002720833955611, 0.000000000000000,  0.000000000000000,  -0.002985442269050, -0.003380053369938,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.118731869563072,  0.042791757199347,  0.000000000000000,
        0.000000000000000,  0.174446416314159,  0.075726852267893,  -0.038827941254737, -0.023326890043457, 0.000000000000000,  0.000000000000000,
        -0.014077177403380, -0.008446666788201, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.236976531970896,
        0.118031814290513,  0.000000000000000,  0.000000000000000,  0.338720635707197,  0.199759314828519,  -0.013547996812039, 0.012994471482178,
        -0.000000000000000, 0.000000000000000,  0.054324737839546,  0.087563511416203,  0.000000000000000,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, 0.126103646239066,  0.089545910559719,  -0.000000000000000, 0.000000000000000,  0.172495316783746,  0.146142674843159,
        0.045199807725120,  0.055721226488598,  -0.000000000000000, 0.000000000000000,  0.096456703700769,  0.132175087664006,  -0.000000000000000,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.157984354647264,  0.078687876193675,  0.000000000000000,  0.000000000000000,
        0.225813757138131,  0.133172876552346,  -0.009031997874692, 0.008662980988118,  -0.000000000000000, 0.000000000000000,  0.036216491893031,
        0.058375674277469,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.049471612317947, -0.017829898833061,
        0.000000000000000,  0.000000000000000,  -0.072686006797566, -0.031552855111622, 0.016178308856141,  0.009719537518107,  0.000000000000000,
        0.000000000000000,  0.005865490584742,  0.003519444495084,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.026004592212073, -0.004552839921776, 0.000000000000000,  0.000000000000000,  -0.039604112311683, -0.009403769845610, 0.017950923095740,
        0.013906484662012,  0.000000000000000,  0.000000000000000,  0.015258927152922,  0.017275828335236,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 28, 4));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeDDForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix dipxmat(20, 20);

    CDenseMatrix dipymat(20, 20);

    CDenseMatrix dipzmat(20, 20);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.008405097839584,  -0.008400928496589, 0.000000000000000,  0.000000000000000,  -0.024350565867290,
        -0.133261970823675, 0.000000000000000,  0.000000000000000,  0.089863084681497,  0.126416404303615,  0.000000000000000,  0.000000000000000,
        -0.037599346108220, 0.012250188010256,  0.000000000000000,  0.000000000000000,  0.062017772396335,  0.140324008325305,  0.000000000000000,
        0.000000000000000,  0.028307985908599,  0.014718978696110,  0.000000000000000,  0.000000000000000,  -0.049412303899554, -0.193224837536633,
        0.000000000000000,  0.000000000000000,  0.067252073225472,  0.138831392221010,  0.000000000000000,  0.000000000000000,  -0.070353763875115,
        -0.014251138297456, 0.000000000000000,  0.000000000000000,  0.092517839955119,  0.213072045978317,  0.008405097839584,  0.028307985908599,
        0.400000000000000,  0.242322958021984,  0.016720177324574,  0.047523364729553,  0.000000000000000,  0.000000000000000,  -0.031831473028437,
        -0.057746212777552, -0.000000000000000, 0.000000000000000,  -0.037599346108220, -0.070353763875115, 0.000000000000000,  0.000000000000000,
        -0.070137424452500, -0.102952284545618, 0.000000000000000,  0.000000000000000,  -0.008400928496589, 0.014718978696110,  0.242322958021984,
        0.400000000000000,  0.045480362445204,  0.098902698652035,  0.000000000000000,  0.000000000000000,  0.010482828203600,  -0.010971898949982,
        0.000000000000000,  0.000000000000000,  0.012250188010256,  -0.014251138297456, 0.000000000000000,  0.000000000000000,  -0.137883221021941,
        -0.213139367122909, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.016720177324574,  0.045480362445204,
        0.000000000000000,  0.000000000000000,  -0.010653392098847, -0.006369217288141, 0.000000000000000,  0.000000000000000,  0.053416091132087,
        0.014397837778944,  0.000000000000000,  0.000000000000000,  -0.048826601135240, -0.013150979097272, 0.000000000000000,  0.000000000000000,
        -0.009738882503422, -0.002625030163396, 0.000000000000000,  0.000000000000000,  0.047523364729553,  0.098902698652035,  0.000000000000000,
        0.000000000000000,  -0.021154188363742, -0.006866590523358, 0.000000000000000,  0.000000000000000,  0.049898051232169,  0.021662365650845,
        0.000000000000000,  0.000000000000000,  -0.055899050136232, -0.013321857164511, 0.000000000000000,  0.000000000000000,  -0.009097469466610,
        -0.003949507149410, -0.024350565867290, -0.049412303899554, 0.000000000000000,  0.000000000000000,  -0.010653392098847, -0.021154188363742,
        0.400000000000000,  0.242322958021984,  0.005176806994816,  0.000349181104845,  0.000000000000000,  0.000000000000000,  0.090180169372674,
        0.057017827067061,  0.000000000000000,  0.000000000000000,  0.073814008543084,  0.076723691051549,  0.000000000000000,  0.000000000000000,
        -0.133261970823675, -0.193224837536633, 0.000000000000000,  0.000000000000000,  -0.006369217288141, -0.006866590523358, 0.242322958021984,
        0.400000000000000,  -0.031557814008450, -0.037719119137656, 0.000000000000000,  0.000000000000000,  0.043121146442663,  0.026026728505712,
        0.000000000000000,  0.000000000000000,  0.076972493627312,  0.098902241533152,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.031831473028437, 0.010482828203600,  0.000000000000000,  0.000000000000000,  0.005176806994816,  -0.031557814008450,
        0.000000000000000,  0.000000000000000,  -0.039696378092532, -0.048976727754571, 0.000000000000000,  0.000000000000000,  0.048534228299105,
        0.149042623555036,  0.000000000000000,  0.000000000000000,  -0.054359352150000, 0.003147608603512,  0.000000000000000,  0.000000000000000,
        -0.057746212777552, -0.010971898949982, 0.000000000000000,  0.000000000000000,  0.000349181104845,  -0.037719119137656, 0.000000000000000,
        0.000000000000000,  -0.036212699085901, -0.049128505651853, 0.000000000000000,  0.000000000000000,  0.086484630519696,  0.241658230701010,
        0.000000000000000,  0.000000000000000,  -0.077466235025575, -0.020526799721536, 0.089863084681497,  0.067252073225472,  -0.000000000000000,
        0.000000000000000,  0.053416091132087,  0.049898051232169,  0.000000000000000,  0.000000000000000,  -0.039696378092532, -0.036212699085901,
        0.400000000000000,  0.242322958021984,  -0.016572475096658, -0.075219263845662, 0.000000000000000,  0.000000000000000,  0.007766998632849,
        -0.013653296225233, -0.000000000000000, 0.000000000000000,  0.126416404303615,  0.138831392221010,  0.000000000000000,  0.000000000000000,
        0.014397837778944,  0.021662365650845,  0.000000000000000,  0.000000000000000,  -0.048976727754571, -0.049128505651853, 0.242322958021984,
        0.400000000000000,  -0.154803722656647, -0.256898818669117, 0.000000000000000,  0.000000000000000,  0.062332917723640,  0.055949354930322,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.037599346108220, 0.012250188010256,  0.000000000000000,
        0.000000000000000,  0.090180169372674,  0.043121146442663,  0.000000000000000,  0.000000000000000,  -0.016572475096658, -0.154803722656647,
        0.000000000000000,  0.000000000000000,  -0.040018302451306, 0.007375828789347,  0.000000000000000,  0.000000000000000,  0.009013253528120,
        0.034076045048780,  0.000000000000000,  0.000000000000000,  -0.070353763875115, -0.014251138297456, 0.000000000000000,  0.000000000000000,
        0.057017827067061,  0.026026728505712,  0.000000000000000,  0.000000000000000,  -0.075219263845662, -0.256898818669117, 0.000000000000000,
        0.000000000000000,  -0.062299134233595, -0.003634760020311, 0.000000000000000,  0.000000000000000,  0.055003506290987,  0.095361855784057,
        -0.037599346108220, -0.070353763875115, 0.000000000000000,  0.000000000000000,  -0.048826601135240, -0.055899050136232, 0.000000000000000,
        0.000000000000000,  0.048534228299105,  0.086484630519696,  0.000000000000000,  0.000000000000000,  -0.040018302451306, -0.062299134233595,
        0.400000000000000,  0.242322958021984,  -0.066871194266454, -0.077690979220686, 0.000000000000000,  0.000000000000000,  0.012250188010256,
        -0.014251138297456, 0.000000000000000,  0.000000000000000,  -0.013150979097272, -0.013321857164511, 0.000000000000000,  0.000000000000000,
        0.149042623555036,  0.241658230701010,  0.000000000000000,  0.000000000000000,  0.007375828789347,  -0.003634760020311, 0.242322958021984,
        0.400000000000000,  -0.177831923132895, -0.239620575689012, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.070137424452500, -0.137883221021941, 0.000000000000000,  0.000000000000000,  0.073814008543084,  0.076972493627312,  0.000000000000000,
        0.000000000000000,  0.007766998632849,  0.062332917723640,  0.000000000000000,  0.000000000000000,  -0.066871194266454, -0.177831923132895,
        0.000000000000000,  0.000000000000000,  0.006680642975099,  -0.032526955055160, 0.000000000000000,  0.000000000000000,  -0.102952284545618,
        -0.213139367122909, 0.000000000000000,  0.000000000000000,  0.076723691051549,  0.098902241533152,  0.000000000000000,  0.000000000000000,
        -0.013653296225233, 0.055949354930322,  0.000000000000000,  0.000000000000000,  -0.077690979220686, -0.239620575689012, 0.000000000000000,
        0.000000000000000,  0.041261530142581,  -0.002466364155277, 0.062017772396335,  0.092517839955119,  0.000000000000000,  0.000000000000000,
        -0.009738882503422, -0.009097469466610, 0.000000000000000,  0.000000000000000,  -0.054359352150000, -0.077466235025575, -0.000000000000000,
        -0.000000000000000, 0.009013253528120,  0.055003506290987,  0.000000000000000,  0.000000000000000,  0.006680642975099,  0.041261530142581,
        0.400000000000000,  0.242322958021984,  0.140324008325305,  0.213072045978317,  0.000000000000000,  0.000000000000000,  -0.002625030163396,
        -0.003949507149410, 0.000000000000000,  0.000000000000000,  0.003147608603512,  -0.020526799721536, 0.000000000000000,  0.000000000000000,
        0.034076045048780,  0.095361855784057,  0.000000000000000,  0.000000000000000,  -0.032526955055160, -0.002466364155277, 0.242322958021984,
        0.400000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 20, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.016063741483752,  -0.027101059909785, 0.000000000000000,  0.000000000000000,  -0.018121581101377,
        0.017500248337049,  0.000000000000000,  0.000000000000000,  0.100017741958035,  0.101158129904028,  0.000000000000000,  0.000000000000000,
        -0.093977975072711, -0.199593240649265, 0.000000000000000,  0.000000000000000,  -0.046714177390062, -0.105283989243420, 0.000000000000000,
        0.000000000000000,  0.055188989397023,  0.012728309073023,  0.000000000000000,  0.000000000000000,  -0.052158824941896, -0.006352123998635,
        0.000000000000000,  0.000000000000000,  0.089825493721248,  0.120711881904021,  0.000000000000000,  0.000000000000000,  -0.120929937664686,
        -0.278934628105435, 0.000000000000000,  0.000000000000000,  -0.060361589496780, -0.151393202871902, 0.016063741483752,  0.055188989397023,
        0.600000000000000,  0.363484437032976,  -0.018121581101377, -0.052158824941896, 0.000000000000000,  0.000000000000000,  0.004270071927997,
        -0.008521506076927, -0.000000000000000, -0.000000000000000, 0.016720177324574,  0.047523364729553,  0.000000000000000,  0.000000000000000,
        0.041389287175828,  0.069951826837045,  -0.000000000000000, -0.000000000000000, -0.027101059909785, 0.012728309073023,  0.363484437032976,
        0.600000000000000,  0.017500248337049,  -0.006352123998635, 0.000000000000000,  0.000000000000000,  0.009943124083596,  0.002848631793511,
        -0.000000000000000, 0.000000000000000,  0.045480362445204,  0.098902698652036,  0.000000000000000,  0.000000000000000,  0.080187496988077,
        0.132747739195582,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.018121581101377, 0.017500248337049,
        0.000000000000000,  0.000000000000000,  -0.027180940689989, 0.014660896349081,  0.000000000000000,  0.000000000000000,  0.027940934180081,
        -0.142805524507528, 0.000000000000000,  0.000000000000000,  0.082017788239762,  0.031145533071815,  0.000000000000000,  0.000000000000000,
        0.014203799475878,  -0.046472060193490, 0.000000000000000,  0.000000000000000,  -0.052158824941896, -0.006352123998635, 0.000000000000000,
        0.000000000000000,  -0.069280933759774, -0.002430168650993, 0.000000000000000,  0.000000000000000,  -0.033637554485521, -0.238846847293412,
        0.000000000000000,  0.000000000000000,  0.054123729771787,  0.019365799923457,  0.000000000000000,  0.000000000000000,  -0.003956594283900,
        -0.086777163160686, -0.018121581101377, -0.052158824941896, 0.000000000000000,  0.000000000000000,  -0.027180940689989, -0.069280933759774,
        0.600000000000000,  0.363484437032976,  0.052848234128118,  0.086775614773733,  0.000000000000000,  0.000000000000000,  -0.010653392098847,
        -0.021154188363742, 0.000000000000000,  0.000000000000000,  0.090088247270453,  0.128737891227773,  0.000000000000000,  0.000000000000000,
        0.017500248337049,  -0.006352123998635, 0.000000000000000,  0.000000000000000,  0.014660896349081,  -0.002430168650993, 0.363484437032976,
        0.600000000000000,  0.122744445214661,  0.210225631419630,  0.000000000000000,  0.000000000000000,  -0.006369217288141, -0.006866590523358,
        0.000000000000000,  0.000000000000000,  0.165435907988184,  0.248205268312383,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.004270071927997,  0.009943124083596,  0.000000000000000,  0.000000000000000,  0.052848234128118,  0.122744445214661,
        0.000000000000000,  0.000000000000000,  -0.059544567138798, -0.073465091631857, 0.000000000000000,  0.000000000000000,  0.005176806994816,
        -0.031557814008450, 0.000000000000000,  0.000000000000000,  0.043302447304567,  -0.009153270827062, 0.000000000000000,  0.000000000000000,
        -0.008521506076927, 0.002848631793511,  0.000000000000000,  0.000000000000000,  0.086775614773733,  0.210225631419630,  0.000000000000000,
        0.000000000000000,  -0.054319048628851, -0.073692758477780, 0.000000000000000,  0.000000000000000,  0.000349181104845,  -0.037719119137656,
        0.000000000000000,  0.000000000000000,  0.071235398876201,  0.015545352942057,  0.100017741958035,  0.089825493721248,  -0.000000000000000,
        -0.000000000000000, 0.027940934180081,  -0.033637554485521, 0.000000000000000,  0.000000000000000,  -0.059544567138798, -0.054319048628851,
        0.600000000000001,  0.363484437032977,  0.053416091132087,  0.049898051232169,  0.000000000000000,  0.000000000000000,  -0.071814026204830,
        -0.047006223018552, 0.000000000000000,  0.000000000000000,  0.101158129904028,  0.120711881904021,  -0.000000000000000, 0.000000000000000,
        -0.142805524507528, -0.238846847293412, 0.000000000000000,  0.000000000000000,  -0.073465091631857, -0.073692758477780, 0.363484437032977,
        0.600000000000000,  0.014397837778944,  0.021662365650845,  0.000000000000000,  0.000000000000000,  -0.118820167137887, -0.126160463030504,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.016720177324574,  0.045480362445204,  0.000000000000000,
        0.000000000000000,  -0.010653392098847, -0.006369217288141, 0.000000000000000,  0.000000000000000,  0.053416091132087,  0.014397837778944,
        0.000000000000000,  0.000000000000000,  -0.048826601135240, -0.013150979097272, 0.000000000000000,  0.000000000000000,  -0.009738882503422,
        -0.002625030163396, 0.000000000000000,  0.000000000000000,  0.047523364729553,  0.098902698652036,  0.000000000000000,  0.000000000000000,
        -0.021154188363742, -0.006866590523358, 0.000000000000000,  0.000000000000000,  0.049898051232169,  0.021662365650845,  0.000000000000000,
        0.000000000000000,  -0.055899050136232, -0.013321857164511, 0.000000000000000,  0.000000000000000,  -0.009097469466610, -0.003949507149410,
        -0.093977975072711, -0.120929937664686, 0.000000000000000,  0.000000000000000,  0.082017788239762,  0.054123729771787,  0.000000000000000,
        0.000000000000000,  0.005176806994816,  0.000349181104845,  0.000000000000000,  0.000000000000000,  -0.048826601135240, -0.055899050136232,
        0.600000000000000,  0.363484437032976,  -0.093291773549927, -0.094918629984768, 0.000000000000000,  0.000000000000000,  -0.199593240649265,
        -0.278934628105435, 0.000000000000000,  0.000000000000000,  0.031145533071815,  0.019365799923457,  0.000000000000000,  0.000000000000000,
        -0.031557814008450, -0.037719119137656, 0.000000000000000,  0.000000000000000,  -0.013150979097272, -0.013321857164511, 0.363484437032976,
        0.600000000000000,  -0.082222553954105, -0.106801255831973, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.041389287175828,  0.080187496988077,  0.000000000000000,  0.000000000000000,  0.090088247270453,  0.165435907988184,  0.000000000000000,
        0.000000000000000,  -0.071814026204830, -0.118820167137887, 0.000000000000000,  0.000000000000000,  -0.093291773549927, -0.082222553954105,
        0.000000000000000,  0.000000000000000,  0.006564869738273,  -0.034290765417839, 0.000000000000000,  0.000000000000000,  0.069951826837045,
        0.132747739195582,  0.000000000000000,  0.000000000000000,  0.128737891227773,  0.248205268312383,  0.000000000000000,  0.000000000000000,
        -0.047006223018552, -0.126160463030504, 0.000000000000000,  0.000000000000000,  -0.094918629984768, -0.106801255831973, 0.000000000000000,
        0.000000000000000,  0.049165284679746,  0.005650612738227,  -0.046714177390062, -0.060361589496780, -0.000000000000000, -0.000000000000000,
        0.014203799475878,  -0.003956594283900, 0.000000000000000,  0.000000000000000,  0.043302447304567,  0.071235398876201,  0.000000000000000,
        0.000000000000000,  -0.009738882503422, -0.009097469466610, 0.000000000000000,  0.000000000000000,  0.006564869738273,  0.049165284679746,
        0.600000000000000,  0.363484437032977,  -0.105283989243420, -0.151393202871902, -0.000000000000000, 0.000000000000000,  -0.046472060193490,
        -0.086777163160686, 0.000000000000000,  0.000000000000000,  -0.009153270827062, 0.015545352942057,  0.000000000000000,  0.000000000000000,
        -0.002625030163396, -0.003949507149410, 0.000000000000000,  0.000000000000000,  -0.034290765417839, 0.005650612738227,  0.363484437032977,
        0.600000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 20, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.016720177324574,  0.045480362445204,  0.000000000000000,  0.000000000000000,  -0.010653392098847,
        -0.006369217288141, 0.000000000000000,  0.000000000000000,  0.053416091132087,  0.014397837778944,  0.000000000000000,  0.000000000000000,
        -0.048826601135240, -0.013150979097272, 0.000000000000000,  0.000000000000000,  -0.009738882503421, -0.002625030163396, 0.000000000000000,
        0.000000000000000,  0.047523364729553,  0.098902698652035,  0.000000000000000,  0.000000000000000,  -0.021154188363742, -0.006866590523358,
        0.000000000000000,  0.000000000000000,  0.049898051232169,  0.021662365650845,  0.000000000000000,  0.000000000000000,  -0.055899050136232,
        -0.013321857164511, 0.000000000000000,  0.000000000000000,  -0.009097469466610, -0.003949507149410, 0.016720177324574,  0.047523364729553,
        1.100000000000000,  0.666388134560457,  -0.025588207804979, -0.056403522410690, 0.000000000000000,  0.000000000000000,  0.149894659406630,
        0.148995791486819,  -0.000000000000000, 0.000000000000000,  -0.109207411533759, -0.147782669623999, 0.000000000000000,  0.000000000000000,
        -0.009738882503422, -0.009097469466610, 0.000000000000000,  0.000000000000000,  0.045480362445204,  0.098902698652035,  0.666388134560457,
        1.100000000000001,  -0.071366429385916, -0.113094785501056, 0.000000000000000,  0.000000000000000,  0.106309141353730,  0.140425335227848,
        0.000000000000000,  0.000000000000000,  -0.146827489876074, -0.219414944486767, 0.000000000000000,  0.000000000000000,  -0.002625030163396,
        -0.003949507149410, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.025588207804979, -0.071366429385916,
        0.000000000000000,  0.000000000000000,  -0.022902986537547, -0.086098263353212, 0.000000000000000,  0.000000000000000,  0.058542895287233,
        0.117991300152422,  0.000000000000000,  0.000000000000000,  0.064658920177706,  0.039813004725917,  0.000000000000000,  0.000000000000000,
        0.130454941481646,  0.158760843615234,  0.000000000000000,  0.000000000000000,  -0.056403522410690, -0.113094785501056, 0.000000000000000,
        0.000000000000000,  -0.027850421481197, -0.077308631176969, 0.000000000000000,  0.000000000000000,  0.020174944200049,  0.137352253418097,
        0.000000000000000,  0.000000000000000,  0.025169665524287,  0.027218686771353,  0.000000000000000,  0.000000000000000,  0.166735885426388,
        0.234346774357322,  -0.010653392098847, -0.021154188363742, 0.000000000000000,  0.000000000000000,  -0.022902986537547, -0.027850421481197,
        1.100000000000000,  0.666388134560457,  0.062498653183675,  -0.027487195349608, 0.000000000000000,  0.000000000000000,  0.064658920177706,
        0.025169665524287,  0.000000000000000,  0.000000000000000,  0.058680555031331,  0.063149380413417,  -0.000000000000000, 0.000000000000000,
        -0.006369217288141, -0.006866590523358, 0.000000000000000,  0.000000000000000,  -0.086098263353212, -0.077308631176969, 0.666388134560457,
        1.100000000000001,  -0.010142991773356, -0.086003104138653, 0.000000000000000,  0.000000000000000,  0.039813004725917,  0.027218686771353,
        0.000000000000000,  0.000000000000000,  0.014230125046791,  0.014228448578353,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.149894659406630,  0.106309141353730,  0.000000000000000,  0.000000000000000,  0.062498653183675,  -0.010142991773356,
        0.000000000000000,  0.000000000000000,  -0.121462910321182, -0.124849883885716, 0.000000000000000,  0.000000000000000,  0.041665768789117,
        -0.006761994515571, 0.000000000000000,  0.000000000000000,  -0.062456108086096, -0.044295475564054, 0.000000000000000,  0.000000000000000,
        0.148995791486819,  0.140425335227848,  0.000000000000000,  0.000000000000000,  -0.027487195349608, -0.086003104138653, 0.000000000000000,
        0.000000000000000,  -0.138093241272524, -0.142960121344737, 0.000000000000000,  0.000000000000000,  -0.018324796899739, -0.057335402759102,
        0.000000000000000,  0.000000000000000,  -0.062081579786175, -0.058510556344937, 0.053416091132087,  0.049898051232169,  -0.000000000000000,
        0.000000000000000,  0.058542895287233,  0.020174944200049,  0.000000000000000,  0.000000000000000,  -0.121462910321182, -0.138093241272524,
        1.100000000000001,  0.666388134560457,  0.039028596858156,  0.013449962800033,  0.000000000000000,  0.000000000000000,  -0.022256704638370,
        -0.020790854680071, 0.000000000000000,  0.000000000000000,  0.014397837778944,  0.021662365650845,  0.000000000000000,  0.000000000000000,
        0.117991300152422,  0.137352253418097,  0.000000000000000,  0.000000000000000,  -0.124849883885716, -0.142960121344737, 0.666388134560457,
        1.100000000000001,  0.078660866768281,  0.091568168945398,  0.000000000000000,  0.000000000000000,  -0.005999099074560, -0.009025985687852,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.109207411533759, -0.146827489876074, 0.000000000000000,
        0.000000000000000,  0.064658920177706,  0.039813004725917,  0.000000000000000,  0.000000000000000,  0.039028596858156,  0.078660866768281,
        0.000000000000000,  0.000000000000000,  -0.076785420018968, -0.119275767291476, 0.000000000000000,  0.000000000000000,  -0.134186694205291,
        -0.132359126274957, 0.000000000000000,  0.000000000000000,  -0.147782669623999, -0.219414944486767, 0.000000000000000,  0.000000000000000,
        0.025169665524287,  0.027218686771353,  0.000000000000000,  0.000000000000000,  0.013449962800033,  0.091568168945398,  0.000000000000000,
        0.000000000000000,  -0.048825142751436, -0.099990870153097, 0.000000000000000,  0.000000000000000,  -0.153275514289567, -0.189413027061671,
        -0.048826601135240, -0.055899050136232, 0.000000000000000,  0.000000000000000,  0.064658920177706,  0.025169665524287,  0.000000000000000,
        0.000000000000000,  0.041665768789117,  -0.018324796899739, 0.000000000000000,  0.000000000000000,  -0.076785420018968, -0.048825142751436,
        1.100000000000000,  0.666388134560457,  -0.061018045345534, -0.058211432002691, 0.000000000000000,  0.000000000000000,  -0.013150979097272,
        -0.013321857164511, 0.000000000000000,  0.000000000000000,  0.039813004725917,  0.027218686771353,  0.000000000000000,  0.000000000000000,
        -0.006761994515571, -0.057335402759102, 0.000000000000000,  0.000000000000000,  -0.119275767291476, -0.099990870153097, 0.666388134560457,
        1.100000000000001,  -0.011884852141234, -0.011500279971884, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.009738882503422, -0.002625030163396, 0.000000000000000,  0.000000000000000,  0.058680555031331,  0.014230125046791,  0.000000000000000,
        0.000000000000000,  -0.022256704638370, -0.005999099074560, 0.000000000000000,  0.000000000000000,  -0.061018045345534, -0.011884852141234,
        0.000000000000000,  0.000000000000000,  -0.002595272973879, 0.040274052621135,  0.000000000000000,  0.000000000000000,  -0.009097469466610,
        -0.003949507149410, 0.000000000000000,  0.000000000000000,  0.063149380413417,  0.014228448578353,  0.000000000000000,  0.000000000000000,
        -0.020790854680071, -0.009025985687852, 0.000000000000000,  0.000000000000000,  -0.058211432002691, -0.011500279971884, 0.000000000000000,
        0.000000000000000,  0.029480050287444,  0.091069509472371,  -0.009738882503421, -0.009097469466610, 0.000000000000000,  0.000000000000000,
        0.130454941481646,  0.166735885426388,  -0.000000000000000, 0.000000000000000,  -0.062456108086096, -0.062081579786175, 0.000000000000000,
        0.000000000000000,  -0.134186694205291, -0.153275514289567, 0.000000000000000,  0.000000000000000,  -0.002595272973879, 0.029480050287444,
        1.100000000000000,  0.666388134560457,  -0.002625030163396, -0.003949507149410, 0.000000000000000,  0.000000000000000,  0.158760843615234,
        0.234346774357322,  0.000000000000000,  0.000000000000000,  -0.044295475564054, -0.058510556344937, 0.000000000000000,  0.000000000000000,
        -0.132359126274957, -0.189413027061671, 0.000000000000000,  0.000000000000000,  0.040274052621135,  0.091069509472371,  0.666388134560457,
        1.100000000000001};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 20, 20));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputePFForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix dipxmat(12, 28);

    CDenseMatrix dipymat(12, 28);

    CDenseMatrix dipzmat(12, 28);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.017592359632384, -0.043138240118730, 0.000000000000000,  0.000000000000000,  -0.014004933535433,
        -0.066571536659897, 0.000000000000000,  0.000000000000000,  0.004440006978558,  0.025244194683093,  0.000000000000000,  0.000000000000000,
        -0.072802233857498, -0.059659940406675, 0.000000000000000,  0.000000000000000,  0.045780767570074,  0.060456043004605,  0.000000000000000,
        0.000000000000000,  0.008835186046989,  0.003973710289738,  0.000000000000000,  0.000000000000000,  0.030651298066301,  0.066624577052966,
        0.000000000000000,  0.000000000000000,  -0.028895884721136, -0.073733358945846, 0.000000000000000,  0.000000000000000,  -0.034467033308184,
        -0.121130572940868, 0.000000000000000,  0.000000000000000,  0.016280209832254,  0.041890501778902,  0.000000000000000,  0.000000000000000,
        -0.069985535130371, -0.083429447358069, 0.000000000000000,  0.000000000000000,  0.056076692987312,  0.092339216158953,  0.000000000000000,
        0.000000000000000,  0.006440470889746,  0.004837138625765,  0.000000000000000,  0.000000000000000,  0.046451194899592,  0.112933838097966,
        -0.002295600272256, 0.003604456939768,  0.000000000000000,  0.000000000000000,  0.028694803432151,  0.068218272147725,  0.000000000000000,
        0.000000000000000,  0.001847882767261,  0.015956874541061,  0.000000000000000,  -0.000000000000000, -0.021292119532710, -0.045787449552135,
        0.000000000000000,  0.000000000000000,  -0.106900310692432, -0.117508199075875, -0.000000000000000, 0.000000000000000,  -0.082812352298900,
        -0.107846037271567, 0.000000000000000,  0.000000000000000,  -0.059164775720101, -0.086588094990248, -0.000000000000000, 0.000000000000000,
        0.033534013314473,  0.057072622347134,  0.000000000000000,  -0.000000000000000, 0.089196032539743,  0.157767419198976,  0.000000000000000,
        0.000000000000000,  -0.002070062336231, 0.000498999182848,  0.000000000000000,  -0.000000000000000, 0.013673919204114,  0.009429525861578,
        0.000000000000000,  0.000000000000000,  -0.082347662754683, -0.122020364818520, 0.000000000000000,  0.000000000000000,  -0.050946710107469,
        -0.080753342057907, 0.000000000000000,  0.000000000000000,  -0.087598981303010, -0.144829100380326, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.047636108035543,  0.042704107999145,  0.000000000000000,  0.000000000000000,  0.043603309078056,
        0.020299341826765,  0.000000000000000,  0.000000000000000,  -0.021773783445676, 0.006689911736907,  0.000000000000000,  0.000000000000000,
        -0.007603938618005, 0.018858874509764,  0.000000000000000,  0.000000000000000,  -0.001122986530898, -0.063924638256145, 0.000000000000000,
        0.000000000000000,  0.055164991811215,  0.018425383204968,  0.000000000000000,  0.000000000000000,  -0.009688803642564, -0.013224011447865,
        0.000000000000000,  0.000000000000000,  0.048097817685493,  0.060526197064715,  0.000000000000000,  0.000000000000000,  0.039647044963602,
        0.016315876239646,  0.000000000000000,  0.000000000000000,  -0.005513360775808, 0.014761002275855,  0.000000000000000,  0.000000000000000,
        0.004621761136694,  0.036378485040498,  0.000000000000000,  0.000000000000000,  -0.023446032610667, -0.123382971863362, 0.000000000000000,
        0.000000000000000,  0.041152839026337,  0.014084908915132,  0.000000000000000,  0.000000000000000,  -0.012634864069655, -0.019657026208211,
        -0.053124354163962, -0.052368965459236, 0.000000000000000,  0.000000000000000,  -0.098141397957325, -0.080504296532885, 0.000000000000000,
        0.000000000000000,  0.003971084308273,  0.026059095293672,  0.000000000000000,  0.000000000000000,  0.071614878503323,  0.090734882516127,
        -0.000000000000000, -0.000000000000000, -0.010908747887282, 0.036949579462725,  0.000000000000000,  0.000000000000000,  -0.033334768496704,
        -0.023564205602207, 0.000000000000000,  0.000000000000000,  0.034889843173334,  0.036748856322931,  0.000000000000000,  0.000000000000000,
        -0.045080889303050, -0.062500950639420, 0.000000000000000,  0.000000000000000,  -0.027243808644843, -0.021250734837648, 0.000000000000000,
        0.000000000000000,  0.020004234563116,  0.036396875502295,  0.000000000000000,  0.000000000000000,  0.027627526776899,  0.040843143816888,
        -0.000000000000000, 0.000000000000000,  0.083238939786619,  0.157488223715462,  0.000000000000000,  0.000000000000000,  -0.016128693860517,
        -0.012028717832631, 0.000000000000000,  0.000000000000000,  0.020819886151986,  0.029750211145594,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.020629559166266, -0.063167613788488, 0.000000000000000,  0.000000000000000,  0.030979703304711,
        -0.022309508696460, 0.000000000000000,  0.000000000000000,  -0.073550381859689, -0.130393449078794, 0.000000000000000,  0.000000000000000,
        -0.002619033580207, 0.023882962898084,  0.000000000000000,  0.000000000000000,  0.053736243096027,  0.017774825665575,  0.000000000000000,
        0.000000000000000,  -0.005708696732954, -0.047739003341001, 0.000000000000000,  0.000000000000000,  -0.036796527059427, -0.046406734499249,
        0.000000000000000,  0.000000000000000,  -0.037022373160725, -0.105853897725017, 0.000000000000000,  0.000000000000000,  0.049806308214032,
        0.017454008541301,  0.000000000000000,  0.000000000000000,  -0.039501422291614, -0.103211037731023, 0.000000000000000,  0.000000000000000,
        0.026420519161661,  0.078815293790777,  0.000000000000000,  0.000000000000000,  0.082201445910199,  0.085781957447896,  0.000000000000000,
        0.000000000000000,  -0.039762531595308, -0.116793943797908, 0.000000000000000,  0.000000000000000,  -0.053747855332091, -0.092390292150504,
        0.061814084531092,  0.092080350539195,  0.000000000000000,  0.000000000000000,  0.046589154415567,  0.100397231425999,  0.000000000000000,
        0.000000000000000,  0.038875962917055,  0.070064762483464,  -0.000000000000000, 0.000000000000000,  -0.053223241489536, -0.075193849771534,
        0.000000000000000,  0.000000000000000,  0.019078824778360,  0.064285631310698,  -0.000000000000000, -0.000000000000000, 0.075030298607017,
        0.107889036316842,  0.000000000000000,  0.000000000000000,  0.024360104479296,  0.022580177700241,  -0.000000000000000, 0.000000000000000,
        0.083467609022766,  0.140198901657816,  0.000000000000000,  0.000000000000000,  -0.006761007468496, 0.011636005694201,  0.000000000000000,
        0.000000000000000,  -0.000509562678424, 0.008346471108131,  0.000000000000000,  0.000000000000000,  -0.089701127735806, -0.147572975966534,
        0.000000000000000,  0.000000000000000,  -0.052809292526704, -0.062113777912057, -0.000000000000000, -0.000000000000000, 0.118228522461863,
        0.195649380770012,  0.000000000000000,  0.000000000000000,  0.061066975373328,  0.092424368285421,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 12, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.027622437505916,  0.064211907115914,  0.000000000000000,  0.000000000000000,  0.013309331210732,
        -0.030256929275936, 0.000000000000000,  0.000000000000000,  0.041483607541802,  0.004072487518396,  0.000000000000000,  0.000000000000000,
        -0.063287561794789, -0.025833654107478, 0.000000000000000,  0.000000000000000,  -0.075114092641285, -0.101988800039174, 0.000000000000000,
        0.000000000000000,  -0.012745067648481, 0.069641685829500,  0.000000000000000,  0.000000000000000,  0.001055148878994,  0.041069235270182,
        0.000000000000000,  0.000000000000000,  0.046366690549846,  0.112868760991527,  0.000000000000000,  0.000000000000000,  0.036925366434541,
        0.007779731289772,  0.000000000000000,  0.000000000000000,  0.091645790626368,  0.099169472681243,  0.000000000000000,  0.000000000000000,
        -0.031900760113648, 0.009290754325720,  0.000000000000000,  0.000000000000000,  -0.047438533687029, -0.088476334147749, 0.000000000000000,
        0.000000000000000,  0.003624333825070,  0.106279885534961,  0.000000000000000,  0.000000000000000,  0.005988010898808,  0.056536546566121,
        -0.057216629005267, -0.080092720467907, 0.000000000000000,  0.000000000000000,  0.024405133546825,  0.074432430195137,  0.000000000000000,
        0.000000000000000,  -0.007485901598624, 0.050298996294175,  -0.000000000000000, -0.000000000000000, -0.070966674433461, -0.113350057731647,
        0.000000000000000,  0.000000000000000,  0.001847882767261,  0.015956874541061,  -0.000000000000000, -0.000000000000000, -0.104611251924681,
        -0.180734728658983, 0.000000000000000,  0.000000000000000,  -0.047858210500179, -0.083850286953492, -0.000000000000000, -0.000000000000000,
        -0.085541577388338, -0.140197405632381, 0.000000000000000,  -0.000000000000000, -0.010302503988355, 0.005186487526514,  0.000000000000000,
        0.000000000000000,  -0.081809469615978, -0.100768639201944, -0.000000000000000, -0.000000000000000, -0.078306195065711, -0.139715037748552,
        0.000000000000000,  0.000000000000000,  -0.002070062336231, 0.000498999182848,  -0.000000000000000, 0.000000000000000,  -0.111118726021508,
        -0.202658752945310, 0.000000000000000,  0.000000000000000,  -0.050466692615959, -0.092432014637646, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.023996370387698, -0.019658977830449, 0.000000000000000,  0.000000000000000,  0.008994934955234,
        0.009769441740568,  0.000000000000000,  0.000000000000000,  -0.019267806068961, -0.058349711808723, 0.000000000000000,  0.000000000000000,
        -0.011405907927008, 0.028288311764647,  0.000000000000000,  0.000000000000000,  -0.021773783445676, 0.006689911736907,  0.000000000000000,
        0.000000000000000,  -0.052636581071617, -0.021992895591539, 0.000000000000000,  0.000000000000000,  -0.033208309637088, -0.036215066268809,
        0.000000000000000,  0.000000000000000,  -0.023064465284054, -0.027490215387875, 0.000000000000000,  0.000000000000000,  0.015107151218862,
        0.008409821527429,  0.000000000000000,  0.000000000000000,  -0.028040499923840, -0.111082136633483, 0.000000000000000,  0.000000000000000,
        0.006932641705041,  0.054567727560747,  0.000000000000000,  0.000000000000000,  -0.005513360775808, 0.014761002275855,  0.000000000000000,
        0.000000000000000,  -0.044742940404195, -0.017426219424196, 0.000000000000000,  0.000000000000000,  -0.037580572763409, -0.052627182765894,
        0.016927609126032,  0.015725352988710,  0.000000000000000,  0.000000000000000,  -0.090114391054764, -0.076827473652474, 0.000000000000000,
        0.000000000000000,  -0.007599510963721, 0.058665492207452,  0.000000000000000,  0.000000000000000,  0.107422317754985,  0.136102323774190,
        -0.000000000000000, -0.000000000000000, 0.003971084308273,  0.026059095293672,  0.000000000000000,  0.000000000000000,  0.087032341369878,
        0.070083222349137,  -0.000000000000000, -0.000000000000000, 0.071237531354518,  0.073569136888703,  0.000000000000000,  0.000000000000000,
        0.017952363183819,  0.024528085025818,  0.000000000000000,  0.000000000000000,  -0.019727035431982, -0.015812109424433, 0.000000000000000,
        0.000000000000000,  0.099909135255883,  0.187818953300708,  0.000000000000000,  0.000000000000000,  0.041441290165348,  0.061264715725331,
        -0.000000000000000, 0.000000000000000,  0.020004234563116,  0.036396875502295,  0.000000000000000,  0.000000000000000,  0.026539785293905,
        0.020510506047948,  0.000000000000000,  0.000000000000000,  0.047972509102882,  0.067766960171967,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.017592359632384, -0.043138240118730, 0.000000000000000,  0.000000000000000,  -0.014004933535433,
        -0.066571536659897, 0.000000000000000,  0.000000000000000,  0.004440006978558,  0.025244194683093,  0.000000000000000,  0.000000000000000,
        -0.072802233857498, -0.059659940406675, 0.000000000000000,  0.000000000000000,  0.045780767570074,  0.060456043004605,  0.000000000000000,
        0.000000000000000,  0.008835186046989,  0.003973710289738,  0.000000000000000,  0.000000000000000,  0.030651298066301,  0.066624577052966,
        0.000000000000000,  0.000000000000000,  -0.028895884721136, -0.073733358945846, 0.000000000000000,  0.000000000000000,  -0.034467033308184,
        -0.121130572940868, 0.000000000000000,  0.000000000000000,  0.016280209832254,  0.041890501778902,  0.000000000000000,  0.000000000000000,
        -0.069985535130371, -0.083429447358069, 0.000000000000000,  0.000000000000000,  0.056076692987312,  0.092339216158953,  0.000000000000000,
        0.000000000000000,  0.006440470889745,  0.004837138625765,  0.000000000000000,  0.000000000000000,  0.046451194899592,  0.112933838097966,
        0.077862108611198,  0.106744827281230,  0.000000000000000,  0.000000000000000,  0.106948439043210,  0.168908637053557,  0.000000000000000,
        0.000000000000000,  -0.095336299639064, -0.109091766498498, -0.000000000000000, -0.000000000000000, -0.021292119532710, -0.045787449552135,
        0.000000000000000,  0.000000000000000,  0.038875962917055,  0.070064762483464,  0.000000000000000,  -0.000000000000000, 0.104996373167642,
        0.133810838502429,  0.000000000000000,  0.000000000000000,  -0.043481745721164, -0.066408457314745, -0.000000000000000, -0.000000000000000,
        0.078534166213571,  0.128757174459223,  0.000000000000000,  0.000000000000000,  0.133127247845908,  0.227749170150434,  0.000000000000000,
        0.000000000000000,  -0.056628795720404, -0.086412224768252, -0.000000000000000, 0.000000000000000,  0.013673919204114,  0.009429525861578,
        0.000000000000000,  0.000000000000000,  -0.000509562678424, 0.008346471108131,  -0.000000000000000, -0.000000000000000, 0.054488206627328,
        0.087202860225594,  0.000000000000000,  0.000000000000000,  -0.078794603561882, -0.130803861923613, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 12, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.023996370387698, -0.019658977830449, 0.000000000000000,  0.000000000000000,  0.008994934955234,
        0.009769441740568,  0.000000000000000,  0.000000000000000,  -0.019267806068961, -0.058349711808723, 0.000000000000000,  0.000000000000000,
        -0.011405907927008, 0.028288311764647,  0.000000000000000,  0.000000000000000,  -0.021773783445676, 0.006689911736907,  0.000000000000000,
        0.000000000000000,  -0.052636581071617, -0.021992895591539, 0.000000000000000,  0.000000000000000,  -0.033208309637088, -0.036215066268809,
        0.000000000000000,  0.000000000000000,  -0.023064465284054, -0.027490215387875, 0.000000000000000,  0.000000000000000,  0.015107151218862,
        0.008409821527429,  0.000000000000000,  0.000000000000000,  -0.028040499923840, -0.111082136633483, 0.000000000000000,  0.000000000000000,
        0.006932641705041,  0.054567727560747,  0.000000000000000,  0.000000000000000,  -0.005513360775808, 0.014761002275855,  0.000000000000000,
        0.000000000000000,  -0.044742940404195, -0.017426219424196, 0.000000000000000,  0.000000000000000,  -0.037580572763409, -0.052627182765894,
        -0.030992760315163, -0.045934651019772, 0.000000000000000,  0.000000000000000,  0.030823045798691,  0.078784908474721,  0.000000000000000,
        0.000000000000000,  0.036943239305844,  0.115979452683916,  -0.000000000000000, -0.000000000000000, -0.249655169192609, -0.323355721588873,
        -0.000000000000000, 0.000000000000000,  -0.144504749923613, -0.164987439627877, -0.000000000000000, 0.000000000000000,  -0.149862755525419,
        -0.234733973229427, -0.000000000000000, 0.000000000000000,  -0.043771355304351, -0.074414872731655, -0.000000000000000, 0.000000000000000,
        -0.008949902136294, -0.018326810258584, 0.000000000000000,  -0.000000000000000, 0.048166660950274,  0.092341505682367,  0.000000000000000,
        0.000000000000000,  0.124915221390295,  0.227653264278296,  0.000000000000000,  -0.000000000000000, -0.159020296540310, -0.258067511676097,
        0.000000000000000,  0.000000000000000,  -0.063349385884925, -0.096384161089664, 0.000000000000000,  0.000000000000000,  -0.106451984678397,
        -0.191343340014195, 0.000000000000000,  0.000000000000000,  -0.016592927665389, -0.035084788510596, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.007967147056308, -0.007535435841047, 0.000000000000000,  0.000000000000000,  -0.061789750188678,
        -0.064033466738706, 0.000000000000000,  0.000000000000000,  0.004898823414587,  -0.054687663782026, 0.000000000000000,  0.000000000000000,
        0.057810653277737,  -0.051989164434953, 0.000000000000000,  0.000000000000000,  0.003265882276391,  -0.036458442521350, 0.000000000000000,
        0.000000000000000,  0.025745729245283,  0.026680611141127,  0.000000000000000,  0.000000000000000,  0.040720973843351,  0.038514449854243,
        0.000000000000000,  0.000000000000000,  -0.005507913275497, -0.007465914935278, 0.000000000000000,  0.000000000000000,  -0.017818636128296,
        -0.033335947029229, 0.000000000000000,  0.000000000000000,  0.054835602203225,  -0.008536227280424, 0.000000000000000,  0.000000000000000,
        0.037359849764765,  -0.091854180567823, 0.000000000000000,  0.000000000000000,  0.036557068135484,  -0.005690818186949, 0.000000000000000,
        0.000000000000000,  0.007424431720123,  0.013889977928846,  0.000000000000000,  0.000000000000000,  0.028151556741429,  0.038159120780307,
        -0.004535253360491, -0.004254385720312, 0.000000000000000,  0.000000000000000,  -0.069876955145325, -0.035917975036026, 0.000000000000000,
        0.000000000000000,  -0.029655524075297, 0.095281472623434,  0.000000000000000,  0.000000000000000,  0.124706801172677,  0.252805334991297,
        -0.000000000000000, -0.000000000000000, -0.019770349383531, 0.063520981748956,  0.000000000000000,  0.000000000000000,  0.029115397977219,
        0.014965822931677,  0.000000000000000,  0.000000000000000,  0.023180183842511,  0.021744638126040,  -0.000000000000000, 0.000000000000000,
        -0.000287416329467, -0.000302197137947, 0.000000000000000,  0.000000000000000,  -0.025353864197756, -0.022223964686153, 0.000000000000000,
        0.000000000000000,  0.016470686389686,  0.084036973207011,  0.000000000000000,  0.000000000000000,  0.148384775722337,  0.284789258747536,
        -0.000000000000000, -0.000000000000000, 0.010980457593124,  0.056024648804674,  0.000000000000000,  0.000000000000000,  0.010564110082398,
        0.009259985285897,  0.000000000000000,  0.000000000000000,  0.001469016795055,  0.001544563149508,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.047636108035543,  0.042704107999145,  0.000000000000000,  0.000000000000000,  0.043603309078056,
        0.020299341826765,  0.000000000000000,  0.000000000000000,  -0.021773783445676, 0.006689911736907,  0.000000000000000,  0.000000000000000,
        -0.007603938618005, 0.018858874509764,  0.000000000000000,  0.000000000000000,  -0.001122986530898, -0.063924638256145, 0.000000000000000,
        0.000000000000000,  0.055164991811215,  0.018425383204968,  0.000000000000000,  0.000000000000000,  -0.009688803642564, -0.013224011447865,
        0.000000000000000,  0.000000000000000,  0.048097817685493,  0.060526197064715,  0.000000000000000,  0.000000000000000,  0.039647044963602,
        0.016315876239646,  0.000000000000000,  0.000000000000000,  -0.005513360775808, 0.014761002275855,  0.000000000000000,  0.000000000000000,
        0.004621761136694,  0.036378485040498,  0.000000000000000,  0.000000000000000,  -0.023446032610667, -0.123382971863362, 0.000000000000000,
        0.000000000000000,  0.041152839026337,  0.014084908915132,  0.000000000000000,  0.000000000000000,  -0.012634864069655, -0.019657026208211,
        0.061884532494907,  0.095615044161122,  0.000000000000000,  0.000000000000000,  0.125948558565254,  0.207836293879270,  0.000000000000000,
        0.000000000000000,  -0.144504749923613, -0.164987439627877, -0.000000000000000, 0.000000000000000,  -0.166436779461739, -0.215570481059249,
        -0.000000000000000, -0.000000000000000, 0.157363864242188,  0.253468985707147,  0.000000000000000,  -0.000000000000000, 0.153051163595091,
        0.216261936264411,  0.000000000000000,  0.000000000000000,  -0.013030526267861, -0.024911147685551, -0.000000000000000, -0.000000000000000,
        0.019484547465222,  0.040350798043143,  0.000000000000000,  0.000000000000000,  0.098559217004631,  0.179151551977892,  0.000000000000000,
        0.000000000000000,  -0.063349385884925, -0.096384161089664, 0.000000000000000,  0.000000000000000,  -0.106013531026874, -0.172045007784064,
        -0.000000000000000, 0.000000000000000,  0.177706376294399,  0.307973398519682,  0.000000000000000,  -0.000000000000000, 0.088507473505078,
        0.154655088979025,  0.000000000000000,  0.000000000000000,  -0.006082379168127, -0.013104684138808, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 12, 28));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeFPForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix dipxmat(28, 12);

    CDenseMatrix dipymat(28, 12);

    CDenseMatrix dipzmat(28, 12);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.002295600272256, 0.033534013314473,  0.000000000000000,  0.000000000000000,  -0.053124354163962,
        -0.045080889303050, 0.000000000000000,  0.000000000000000,  0.061814084531092,  0.083467609022766,  0.000000000000000,  0.000000000000000,
        0.003604456939768,  0.057072622347134,  0.000000000000000,  0.000000000000000,  -0.052368965459236, -0.062500950639420, 0.000000000000000,
        0.000000000000000,  0.092080350539195,  0.140198901657816,  -0.017592359632384, -0.028895884721136, 0.000000000000000,  0.000000000000000,
        0.047636108035543,  0.048097817685493,  0.000000000000000,  0.000000000000000,  -0.020629559166266, -0.037022373160725, 0.000000000000000,
        0.000000000000000,  -0.043138240118730, -0.073733358945846, 0.000000000000000,  -0.000000000000000, 0.042704107999145,  0.060526197064715,
        0.000000000000000,  0.000000000000000,  -0.063167613788488, -0.105853897725017, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.028694803432151,  0.089196032539743,  0.000000000000000,  0.000000000000000,  -0.098141397957325, -0.027243808644843,
        0.000000000000000,  0.000000000000000,  0.046589154415567,  -0.006761007468496, 0.000000000000000,  0.000000000000000,  0.068218272147725,
        0.157767419198976,  0.000000000000000,  0.000000000000000,  -0.080504296532885, -0.021250734837648, 0.000000000000000,  0.000000000000000,
        0.100397231425999,  0.011636005694201,  -0.014004933535433, -0.034467033308184, 0.000000000000000,  0.000000000000000,  0.043603309078056,
        0.039647044963602,  0.000000000000000,  0.000000000000000,  0.030979703304711,  0.049806308214032,  0.000000000000000,  0.000000000000000,
        -0.066571536659897, -0.121130572940868, 0.000000000000000,  0.000000000000000,  0.020299341826765,  0.016315876239646,  0.000000000000000,
        0.000000000000000,  -0.022309508696460, 0.017454008541301,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.001847882767261,  -0.002070062336231, 0.000000000000000,  0.000000000000000,  0.003971084308273,  0.020004234563116,  0.000000000000000,
        0.000000000000000,  0.038875962917055,  -0.000509562678424, 0.000000000000000,  0.000000000000000,  0.015956874541061,  0.000498999182848,
        0.000000000000000,  0.000000000000000,  0.026059095293672,  0.036396875502295,  0.000000000000000,  0.000000000000000,  0.070064762483464,
        0.008346471108131,  0.004440006978558,  0.016280209832254,  0.000000000000000,  0.000000000000000,  -0.021773783445676, -0.005513360775808,
        0.000000000000000,  0.000000000000000,  -0.073550381859689, -0.039501422291614, -0.000000000000000, 0.000000000000000,  0.025244194683093,
        0.041890501778902,  -0.000000000000000, -0.000000000000000, 0.006689911736907,  0.014761002275855,  0.000000000000000,  0.000000000000000,
        -0.130393449078794, -0.103211037731023, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.021292119532710,
        0.013673919204114,  0.000000000000000,  0.000000000000000,  0.071614878503323,  0.027627526776899,  0.000000000000000,  0.000000000000000,
        -0.053223241489536, -0.089701127735806, 0.000000000000000,  0.000000000000000,  -0.045787449552135, 0.009429525861578,  0.000000000000000,
        0.000000000000000,  0.090734882516127,  0.040843143816888,  0.000000000000000,  0.000000000000000,  -0.075193849771534, -0.147572975966534,
        -0.072802233857498, -0.069985535130371, 0.000000000000000,  0.000000000000000,  -0.007603938618005, 0.004621761136694,  -0.000000000000000,
        -0.000000000000000, -0.002619033580207, 0.026420519161661,  0.000000000000000,  0.000000000000000,  -0.059659940406675, -0.083429447358069,
        0.000000000000000,  0.000000000000000,  0.018858874509764,  0.036378485040498,  -0.000000000000000, 0.000000000000000,  0.023882962898084,
        0.078815293790777,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.106900310692432, -0.082347662754683,
        0.000000000000000,  0.000000000000000,  -0.010908747887282, 0.083238939786619,  0.000000000000000,  0.000000000000000,  0.019078824778360,
        -0.052809292526704, 0.000000000000000,  0.000000000000000,  -0.117508199075875, -0.122020364818520, 0.000000000000000,  0.000000000000000,
        0.036949579462725,  0.157488223715462,  0.000000000000000,  0.000000000000000,  0.064285631310698,  -0.062113777912057, 0.045780767570074,
        0.056076692987312,  -0.000000000000000, 0.000000000000000,  -0.001122986530898, -0.023446032610667, 0.000000000000000,  0.000000000000000,
        0.053736243096027,  0.082201445910199,  -0.000000000000000, -0.000000000000000, 0.060456043004605,  0.092339216158953,  0.000000000000000,
        0.000000000000000,  -0.063924638256145, -0.123382971863362, 0.000000000000000,  0.000000000000000,  0.017774825665575,  0.085781957447896,
        -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  -0.082812352298900, -0.050946710107469, 0.000000000000000,
        0.000000000000000,  -0.033334768496704, -0.016128693860517, 0.000000000000000,  0.000000000000000,  0.075030298607017,  0.118228522461863,
        0.000000000000000,  0.000000000000000,  -0.107846037271567, -0.080753342057907, 0.000000000000000,  0.000000000000000,  -0.023564205602207,
        -0.012028717832631, 0.000000000000000,  0.000000000000000,  0.107889036316842,  0.195649380770012,  0.008835186046989,  0.006440470889746,
        0.000000000000000,  0.000000000000000,  0.055164991811215,  0.041152839026337,  0.000000000000000,  0.000000000000000,  -0.005708696732954,
        -0.039762531595308, 0.000000000000000,  0.000000000000000,  0.003973710289738,  0.004837138625765,  0.000000000000000,  0.000000000000000,
        0.018425383204968,  0.014084908915132,  0.000000000000000,  0.000000000000000,  -0.047739003341001, -0.116793943797908, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.059164775720101, -0.087598981303010, 0.000000000000000,  0.000000000000000,
        0.034889843173334,  0.020819886151986,  0.000000000000000,  0.000000000000000,  0.024360104479296,  0.061066975373328,  0.000000000000000,
        0.000000000000000,  -0.086588094990248, -0.144829100380326, 0.000000000000000,  0.000000000000000,  0.036748856322931,  0.029750211145594,
        0.000000000000000,  0.000000000000000,  0.022580177700241,  0.092424368285421,  0.030651298066301,  0.046451194899592,  -0.000000000000000,
        0.000000000000000,  -0.009688803642564, -0.012634864069655, 0.000000000000000,  0.000000000000000,  -0.036796527059427, -0.053747855332091,
        -0.000000000000000, 0.000000000000000,  0.066624577052966,  0.112933838097966,  0.000000000000000,  0.000000000000000,  -0.013224011447865,
        -0.019657026208211, 0.000000000000000,  0.000000000000000,  -0.046406734499249, -0.092390292150504, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 28, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.057216629005267, -0.085541577388338, 0.000000000000000,  0.000000000000000,  0.016927609126032,
        0.017952363183819,  0.000000000000000,  0.000000000000000,  0.077862108611198,  0.078534166213571,  0.000000000000000,  0.000000000000000,
        -0.080092720467907, -0.140197405632381, 0.000000000000000,  0.000000000000000,  0.015725352988710,  0.024528085025818,  0.000000000000000,
        0.000000000000000,  0.106744827281230,  0.128757174459223,  0.027622437505916,  0.046366690549846,  0.000000000000000,  0.000000000000000,
        -0.023996370387698, -0.023064465284054, 0.000000000000000,  0.000000000000000,  -0.017592359632384, -0.028895884721136, 0.000000000000000,
        0.000000000000000,  0.064211907115914,  0.112868760991527,  0.000000000000000,  -0.000000000000000, -0.019658977830449, -0.027490215387875,
        0.000000000000000,  0.000000000000000,  -0.043138240118730, -0.073733358945846, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.024405133546825,  -0.010302503988355, 0.000000000000000,  0.000000000000000,  -0.090114391054764, -0.019727035431982,
        0.000000000000000,  0.000000000000000,  0.106948439043210,  0.133127247845908,  0.000000000000000,  0.000000000000000,  0.074432430195137,
        0.005186487526514,  0.000000000000000,  0.000000000000000,  -0.076827473652474, -0.015812109424433, 0.000000000000000,  0.000000000000000,
        0.168908637053557,  0.227749170150434,  0.013309331210732,  0.036925366434541,  0.000000000000000,  0.000000000000000,  0.008994934955234,
        0.015107151218862,  0.000000000000000,  0.000000000000000,  -0.014004933535433, -0.034467033308184, 0.000000000000000,  0.000000000000000,
        -0.030256929275936, 0.007779731289772,  0.000000000000000,  0.000000000000000,  0.009769441740568,  0.008409821527429,  0.000000000000000,
        0.000000000000000,  -0.066571536659897, -0.121130572940868, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.007485901598624, -0.081809469615978, 0.000000000000000,  0.000000000000000,  -0.007599510963721, 0.099909135255883,  0.000000000000000,
        0.000000000000000,  -0.095336299639064, -0.056628795720404, 0.000000000000000,  0.000000000000000,  0.050298996294175,  -0.100768639201944,
        0.000000000000000,  0.000000000000000,  0.058665492207452,  0.187818953300708,  0.000000000000000,  0.000000000000000,  -0.109091766498498,
        -0.086412224768252, 0.041483607541802,  0.091645790626368,  -0.000000000000000, -0.000000000000000, -0.019267806068961, -0.028040499923840,
        0.000000000000000,  0.000000000000000,  0.004440006978558,  0.016280209832254,  -0.000000000000000, -0.000000000000000, 0.004072487518396,
        0.099169472681243,  -0.000000000000000, -0.000000000000000, -0.058349711808723, -0.111082136633483, 0.000000000000000,  0.000000000000000,
        0.025244194683093,  0.041890501778902,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.070966674433461,
        -0.078306195065711, 0.000000000000000,  0.000000000000000,  0.107422317754985,  0.041441290165348,  0.000000000000000,  0.000000000000000,
        -0.021292119532710, 0.013673919204114,  0.000000000000000,  0.000000000000000,  -0.113350057731647, -0.139715037748552, 0.000000000000000,
        0.000000000000000,  0.136102323774190,  0.061264715725331,  0.000000000000000,  0.000000000000000,  -0.045787449552135, 0.009429525861578,
        -0.063287561794789, -0.031900760113648, 0.000000000000000,  0.000000000000000,  -0.011405907927008, 0.006932641705041,  -0.000000000000000,
        -0.000000000000000, -0.072802233857498, -0.069985535130371, 0.000000000000000,  0.000000000000000,  -0.025833654107478, 0.009290754325720,
        0.000000000000000,  0.000000000000000,  0.028288311764647,  0.054567727560747,  -0.000000000000000, 0.000000000000000,  -0.059659940406675,
        -0.083429447358069, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.001847882767261,  -0.002070062336231,
        0.000000000000000,  0.000000000000000,  0.003971084308273,  0.020004234563116,  0.000000000000000,  0.000000000000000,  0.038875962917055,
        -0.000509562678424, 0.000000000000000,  0.000000000000000,  0.015956874541061,  0.000498999182848,  0.000000000000000,  0.000000000000000,
        0.026059095293672,  0.036396875502295,  0.000000000000000,  0.000000000000000,  0.070064762483464,  0.008346471108131,  -0.075114092641285,
        -0.047438533687029, -0.000000000000000, -0.000000000000000, -0.021773783445676, -0.005513360775808, 0.000000000000000,  0.000000000000000,
        0.045780767570074,  0.056076692987312,  0.000000000000000,  -0.000000000000000, -0.101988800039174, -0.088476334147749, -0.000000000000000,
        0.000000000000000,  0.006689911736907,  0.014761002275855,  0.000000000000000,  0.000000000000000,  0.060456043004605,  0.092339216158953,
        -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  -0.104611251924681, -0.111118726021508, 0.000000000000000,
        0.000000000000000,  0.087032341369878,  0.026539785293905,  0.000000000000000,  0.000000000000000,  0.104996373167642,  0.054488206627328,
        0.000000000000000,  0.000000000000000,  -0.180734728658983, -0.202658752945310, 0.000000000000000,  0.000000000000000,  0.070083222349137,
        0.020510506047948,  0.000000000000000,  0.000000000000000,  0.133810838502429,  0.087202860225594,  -0.012745067648481, 0.003624333825070,
        0.000000000000000,  0.000000000000000,  -0.052636581071617, -0.044742940404195, -0.000000000000000, 0.000000000000000,  0.008835186046989,
        0.006440470889745,  0.000000000000000,  0.000000000000000,  0.069641685829500,  0.106279885534961,  0.000000000000000,  0.000000000000000,
        -0.021992895591539, -0.017426219424196, -0.000000000000000, 0.000000000000000,  0.003973710289738,  0.004837138625765,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.047858210500179, -0.050466692615959, 0.000000000000000,  0.000000000000000,
        0.071237531354518,  0.047972509102882,  0.000000000000000,  0.000000000000000,  -0.043481745721164, -0.078794603561882, 0.000000000000000,
        0.000000000000000,  -0.083850286953492, -0.092432014637646, 0.000000000000000,  0.000000000000000,  0.073569136888703,  0.067766960171967,
        0.000000000000000,  0.000000000000000,  -0.066408457314745, -0.130803861923613, 0.001055148878994,  0.005988010898808,  -0.000000000000000,
        -0.000000000000000, -0.033208309637088, -0.037580572763409, 0.000000000000000,  0.000000000000000,  0.030651298066301,  0.046451194899592,
        -0.000000000000000, -0.000000000000000, 0.041069235270182,  0.056536546566121,  -0.000000000000000, 0.000000000000000,  -0.036215066268809,
        -0.052627182765894, 0.000000000000000,  0.000000000000000,  0.066624577052966,  0.112933838097966,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 28, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.030992760315163, -0.008949902136294, 0.000000000000000,  0.000000000000000,  -0.004535253360491,
        -0.000287416329467, 0.000000000000000,  0.000000000000000,  0.061884532494907,  0.019484547465222,  0.000000000000000,  0.000000000000000,
        -0.045934651019772, -0.018326810258584, 0.000000000000000,  0.000000000000000,  -0.004254385720312, -0.000302197137947, 0.000000000000000,
        0.000000000000000,  0.095615044161122,  0.040350798043143,  -0.023996370387698, -0.023064465284054, 0.000000000000000,  0.000000000000000,
        -0.007967147056308, -0.005507913275497, 0.000000000000000,  0.000000000000000,  0.047636108035543,  0.048097817685493,  0.000000000000000,
        0.000000000000000,  -0.019658977830449, -0.027490215387875, 0.000000000000000,  -0.000000000000000, -0.007535435841047, -0.007465914935278,
        0.000000000000000,  0.000000000000000,  0.042704107999145,  0.060526197064715,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.030823045798691,  0.048166660950274,  0.000000000000000,  0.000000000000000,  -0.069876955145325, -0.025353864197756,
        0.000000000000000,  0.000000000000000,  0.125948558565254,  0.098559217004631,  0.000000000000000,  0.000000000000000,  0.078784908474721,
        0.092341505682367,  0.000000000000000,  0.000000000000000,  -0.035917975036026, -0.022223964686153, 0.000000000000000,  0.000000000000000,
        0.207836293879270,  0.179151551977892,  0.008994934955234,  0.015107151218862,  0.000000000000000,  0.000000000000000,  -0.061789750188678,
        -0.017818636128296, 0.000000000000000,  0.000000000000000,  0.043603309078056,  0.039647044963602,  0.000000000000000,  0.000000000000000,
        0.009769441740568,  0.008409821527429,  0.000000000000000,  0.000000000000000,  -0.064033466738706, -0.033335947029229, 0.000000000000000,
        0.000000000000000,  0.020299341826765,  0.016315876239646,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.036943239305844,  0.124915221390295,  0.000000000000000,  0.000000000000000,  -0.029655524075297, 0.016470686389686,  0.000000000000000,
        0.000000000000000,  -0.144504749923613, -0.063349385884925, 0.000000000000000,  0.000000000000000,  0.115979452683916,  0.227653264278296,
        0.000000000000000,  0.000000000000000,  0.095281472623434,  0.084036973207011,  0.000000000000000,  0.000000000000000,  -0.164987439627877,
        -0.096384161089664, -0.019267806068961, -0.028040499923840, -0.000000000000000, 0.000000000000000,  0.004898823414587,  0.054835602203225,
        0.000000000000000,  0.000000000000000,  -0.021773783445676, -0.005513360775808, -0.000000000000000, 0.000000000000000,  -0.058349711808723,
        -0.111082136633483, -0.000000000000000, -0.000000000000000, -0.054687663782026, -0.008536227280424, 0.000000000000000,  0.000000000000000,
        0.006689911736907,  0.014761002275855,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.249655169192609,
        -0.159020296540310, 0.000000000000000,  0.000000000000000,  0.124706801172677,  0.148384775722337,  0.000000000000000,  0.000000000000000,
        -0.166436779461739, -0.106013531026874, 0.000000000000000,  0.000000000000000,  -0.323355721588873, -0.258067511676097, 0.000000000000000,
        0.000000000000000,  0.252805334991297,  0.284789258747536,  0.000000000000000,  0.000000000000000,  -0.215570481059249, -0.172045007784064,
        -0.011405907927008, 0.006932641705041,  -0.000000000000000, 0.000000000000000,  0.057810653277737,  0.037359849764765,  -0.000000000000000,
        -0.000000000000000, -0.007603938618005, 0.004621761136694,  -0.000000000000000, -0.000000000000000, 0.028288311764647,  0.054567727560747,
        0.000000000000000,  0.000000000000000,  -0.051989164434953, -0.091854180567823, -0.000000000000000, -0.000000000000000, 0.018858874509764,
        0.036378485040498,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.144504749923613, -0.063349385884925,
        0.000000000000000,  0.000000000000000,  -0.019770349383531, 0.010980457593124,  0.000000000000000,  0.000000000000000,  0.157363864242188,
        0.177706376294399,  0.000000000000000,  0.000000000000000,  -0.164987439627877, -0.096384161089664, 0.000000000000000,  0.000000000000000,
        0.063520981748956,  0.056024648804674,  0.000000000000000,  0.000000000000000,  0.253468985707147,  0.307973398519682,  -0.021773783445676,
        -0.005513360775808, -0.000000000000000, 0.000000000000000,  0.003265882276391,  0.036557068135484,  0.000000000000000,  0.000000000000000,
        -0.001122986530898, -0.023446032610667, 0.000000000000000,  0.000000000000000,  0.006689911736907,  0.014761002275855,  0.000000000000000,
        0.000000000000000,  -0.036458442521350, -0.005690818186949, 0.000000000000000,  0.000000000000000,  -0.063924638256145, -0.123382971863362,
        -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  -0.149862755525419, -0.106451984678397, 0.000000000000000,
        0.000000000000000,  0.029115397977219,  0.010564110082398,  0.000000000000000,  0.000000000000000,  0.153051163595091,  0.088507473505078,
        0.000000000000000,  0.000000000000000,  -0.234733973229427, -0.191343340014195, 0.000000000000000,  0.000000000000000,  0.014965822931677,
        0.009259985285897,  0.000000000000000,  0.000000000000000,  0.216261936264411,  0.154655088979025,  -0.052636581071617, -0.044742940404195,
        -0.000000000000000, 0.000000000000000,  0.025745729245283,  0.007424431720123,  0.000000000000000,  0.000000000000000,  0.055164991811215,
        0.041152839026337,  0.000000000000000,  0.000000000000000,  -0.021992895591539, -0.017426219424196, 0.000000000000000,  0.000000000000000,
        0.026680611141127,  0.013889977928846,  0.000000000000000,  0.000000000000000,  0.018425383204968,  0.014084908915132,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.043771355304351, -0.016592927665389, 0.000000000000000,  0.000000000000000,
        0.023180183842511,  0.001469016795055,  0.000000000000000,  0.000000000000000,  -0.013030526267861, -0.006082379168127, 0.000000000000000,
        0.000000000000000,  -0.074414872731655, -0.035084788510596, 0.000000000000000,  0.000000000000000,  0.021744638126040,  0.001544563149508,
        0.000000000000000,  0.000000000000000,  -0.024911147685551, -0.013104684138808, -0.033208309637088, -0.037580572763409, -0.000000000000000,
        0.000000000000000,  0.040720973843351,  0.028151556741429,  -0.000000000000000, 0.000000000000000,  -0.009688803642564, -0.012634864069655,
        -0.000000000000000, 0.000000000000000,  -0.036215066268809, -0.052627182765894, 0.000000000000000,  0.000000000000000,  0.038514449854243,
        0.038159120780307,  0.000000000000000,  0.000000000000000,  -0.013224011447865, -0.019657026208211, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 28, 12));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeSGForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix dipxmat(4, 36);

    CDenseMatrix dipymat(4, 36);

    CDenseMatrix dipzmat(4, 36);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.004690571855120, -0.005583378006416, 0.000000000000000,  0.000000000000000,  -0.043889459755011,
        -0.065248984114405, 0.000000000000000,  0.000000000000000,  -0.037539033422693, -0.070316147590080, 0.000000000000000,  0.000000000000000,
        0.038314499923697,  0.040805974379459,  0.000000000000000,  0.000000000000000,  0.031978643835602,  0.049294535610885,  0.000000000000000,
        0.000000000000000,  -0.013988860661498, -0.030267977454411, 0.000000000000000,  0.000000000000000,  -0.052242978778737, -0.069392646940462,
        0.000000000000000,  0.000000000000000,  0.008763432552822,  0.020110039988076,  0.000000000000000,  0.000000000000000,  0.013362293857414,
        0.020651826750615,  0.000000000000000,  0.000000000000000,  -0.003265343267182, -0.006102257309538, 0.000000000000000,  0.000000000000000,
        -0.034626755746458, -0.074129149439846, 0.000000000000000,  0.000000000000000,  -0.034160224588352, -0.082401482761732, 0.000000000000000,
        0.000000000000000,  0.025168970386943,  0.043558450590912,  0.000000000000000,  0.000000000000000,  0.025778665415360,  0.056307298331375,
        0.000000000000000,  0.000000000000000,  -0.014002761731149, -0.036029547361225, 0.000000000000000,  0.000000000000000,  -0.038625655354256,
        -0.077401918530772, 0.000000000000000,  0.000000000000000,  0.009131805452841,  0.024074842035317,  0.000000000000000,  0.000000000000000,
        0.010788565653123,  0.023598849852966,  0.000892506450397,  0.000507074277771,  0.000000000000000,  0.000000000000000,  0.059657599163695,
        0.073595034492835,  0.000000000000000,  0.000000000000000,  0.108259611422850,  0.139751193644915,  0.000000000000000,  0.000000000000000,
        0.011650685400539,  0.021275816760566,  0.000000000000000,  0.000000000000000,  -0.050382948612805, -0.062902673607408, -0.000000000000000,
        -0.000000000000000, 0.056378146331668,  0.073596625209000,  0.000000000000000,  0.000000000000000,  0.038366838711237,  0.043794103641986,
        -0.000000000000000, -0.000000000000000, -0.039849027290705, -0.052184851356526, 0.000000000000000,  0.000000000000000,  -0.021265878201021,
        -0.026570200825555, 0.000000000000000,  -0.000000000000000, 0.001662811007742,  0.002686202439160,  0.000000000000000,  0.000000000000000,
        0.030138587142980,  0.051031812501819,  0.000000000000000,  0.000000000000000,  0.042041950842822,  0.072537018849440,  0.000000000000000,
        0.000000000000000,  -0.008200046273425, -0.012381427368619, 0.000000000000000,  0.000000000000000,  -0.023924647766717, -0.040673243993474,
        -0.000000000000000, -0.000000000000000, 0.020223634129277,  0.035124724702142,  0.000000000000000,  0.000000000000000,  0.026598043546645,
        0.044266821933730,  0.000000000000000,  0.000000000000000,  -0.013956684221303, -0.024290945682255, 0.000000000000000,  0.000000000000000,
        -0.010057550679239, -0.017103019260006, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 4, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.012478384693744,  0.019995005964708,  0.000000000000000,  0.000000000000000,  0.022175707571364,
        0.030076517744583,  0.000000000000000,  0.000000000000000,  -0.004089901899533, -0.029558035408458, 0.000000000000000,  0.000000000000000,
        0.017939889274916,  0.003737001195138,  0.000000000000000,  0.000000000000000,  0.047967965753403,  0.073941803416328,  0.000000000000000,
        0.000000000000000,  0.038314499923697,  0.040805974379459,  0.000000000000000,  0.000000000000000,  0.046960287594711,  0.078109875933299,
        0.000000000000000,  0.000000000000000,  0.030364476543036,  0.055198754443977,  0.000000000000000,  0.000000000000000,  0.000365213078802,
        0.002369263177016,  0.000000000000000,  0.000000000000000,  0.010297042263024,  0.022966598989473,  0.000000000000000,  0.000000000000000,
        0.016590090938527,  0.033668500309751,  0.000000000000000,  0.000000000000000,  -0.010579504370167, -0.037651555156834, 0.000000000000000,
        0.000000000000000,  0.006971380257970,  0.000269161464535,  0.000000000000000,  0.000000000000000,  0.038667998123040,  0.084460947497063,
        0.000000000000000,  0.000000000000000,  0.025168970386943,  0.043558450590912,  0.000000000000000,  0.000000000000000,  0.039647514998283,
        0.090178727769677,  0.000000000000000,  0.000000000000000,  0.027105795592824,  0.064454872188316,  0.000000000000000,  0.000000000000000,
        0.000860101759891,  0.003008373985721,  -0.022657259483459, -0.028567498630107, 0.000000000000000,  -0.000000000000000, -0.018736463712078,
        -0.021878221954275, 0.000000000000000,  0.000000000000000,  0.098177870874717,  0.131146969189910,  -0.000000000000000, 0.000000000000000,
        0.066087050832117,  0.091326472509472,  0.000000000000000,  0.000000000000000,  -0.075574422919207, -0.094354010411112, -0.000000000000000,
        -0.000000000000000, 0.011650685400539,  0.021275816760566,  0.000000000000000,  0.000000000000000,  -0.096557452956082, -0.122660415602929,
        -0.000000000000000, 0.000000000000000,  -0.080947579242983, -0.104156341453088, 0.000000000000000,  0.000000000000000,  -0.007701150922653,
        -0.010280736485294, -0.000000000000000, -0.000000000000000, -0.010187386460634, -0.017384019643780, 0.000000000000000,  0.000000000000000,
        -0.011986579962972, -0.020027097560285, 0.000000000000000,  0.000000000000000,  0.029127908522319,  0.051505082283650,  0.000000000000000,
        0.000000000000000,  0.013390262234756,  0.024806868561627,  0.000000000000000,  0.000000000000000,  -0.035886971650076, -0.061009865990210,
        -0.000000000000000, -0.000000000000000, -0.008200046273425, -0.012381427368619, 0.000000000000000,  0.000000000000000,  -0.041546977260625,
        -0.071120837476629, 0.000000000000000,  0.000000000000000,  -0.032125246899280, -0.055331491280276, 0.000000000000000,  0.000000000000000,
        -0.002298154954407, -0.004061261694190, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 4, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.004781803672311, -0.003553292776221, 0.000000000000000,  0.000000000000000,  0.003491864336903,
        0.001111332531553,  0.000000000000000,  0.000000000000000,  0.011819130829794,  -0.026105999084376, 0.000000000000000,  0.000000000000000,
        -0.027562102185486, -0.081034630117790, 0.000000000000000,  0.000000000000000,  -0.037069449125977, -0.046182323447007, 0.000000000000000,
        0.000000000000000,  -0.018374734790324, -0.054023086745193, 0.000000000000000,  0.000000000000000,  -0.004924637845748, 0.010877499618490,
        0.000000000000000,  0.000000000000000,  -0.017847306610837, -0.005680144050159, 0.000000000000000,  0.000000000000000,  -0.004741955308375,
        -0.003523682003086, 0.000000000000000,  0.000000000000000,  -0.002659060962834, -0.003420373523818, 0.000000000000000,  0.000000000000000,
        0.001477173346578,  0.000555171592275,  0.000000000000000,  0.000000000000000,  -0.004354065272484, -0.037232054681025, 0.000000000000000,
        0.000000000000000,  -0.034290912869358, -0.099008944069469, 0.000000000000000,  0.000000000000000,  -0.026450139233545, -0.050919639125223,
        0.000000000000000,  0.000000000000000,  -0.022860608579572, -0.066005962712979, 0.000000000000000,  0.000000000000000,  0.001814193863535,
        0.015513356117094,  0.000000000000000,  0.000000000000000,  -0.007549997104733, -0.002837543693851, 0.000000000000000,  0.000000000000000,
        -0.002636902121477, -0.003391870411119, -0.007527144642695, -0.010805053696759, 0.000000000000000,  0.000000000000000,  0.011348666880515,
        0.015743395414231,  -0.000000000000000, 0.000000000000000,  0.156238937057580,  0.211404010124360,  -0.000000000000000, 0.000000000000000,
        0.195495296097666,  0.258285505813323,  0.000000000000000,  0.000000000000000,  0.015168442535940,  0.014897251312652,  -0.000000000000000,
        -0.000000000000000, 0.130330197398444,  0.172190337208882,  0.000000000000000,  0.000000000000000,  -0.065099557107325, -0.088085004218483,
        0.000000000000000,  0.000000000000000,  -0.058004297389301, -0.080466243228293, 0.000000000000000,  0.000000000000000,  -0.007464418437340,
        -0.010715011582619, 0.000000000000000,  0.000000000000000,  -0.000702390292795, -0.001520166010586, 0.000000000000000,  0.000000000000000,
        0.002175887521271,  0.004063929345434,  0.000000000000000,  0.000000000000000,  0.040847558665325,  0.073228786560132,  0.000000000000000,
        0.000000000000000,  0.063834324942054,  0.111814196865949,  0.000000000000000,  0.000000000000000,  0.015447180484493,  0.025325052042284,
        -0.000000000000001, -0.000000000000000, 0.042556216628036,  0.074542797910633,  0.000000000000000,  0.000000000000000,  -0.017019816110552,
        -0.030511994400055, 0.000000000000000,  0.000000000000000,  -0.011121202886495, -0.020771194432219, 0.000000000000000,  0.000000000000000,
        -0.000696537040355, -0.001507497960497, 0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 4, 36));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeGSForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix dipxmat(36, 4);

    CDenseMatrix dipymat(36, 4);

    CDenseMatrix dipzmat(36, 4);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.000892506450397,  0.001662811007742,  0.000000000000000,  0.000000000000000,  0.000507074277771,
        0.002686202439160,  -0.004690571855120, -0.003265343267182, 0.000000000000000,  0.000000000000000,  -0.005583378006416, -0.006102257309538,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.059657599163695,  0.030138587142980,  0.000000000000000,
        0.000000000000000,  0.073595034492835,  0.051031812501819,  -0.043889459755011, -0.034626755746458, 0.000000000000000,  0.000000000000000,
        -0.065248984114405, -0.074129149439846, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.108259611422850,
        0.042041950842822,  0.000000000000000,  0.000000000000000,  0.139751193644915,  0.072537018849440,  -0.037539033422693, -0.034160224588352,
        0.000000000000000,  0.000000000000000,  -0.070316147590080, -0.082401482761732, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.011650685400539,  -0.008200046273425, 0.000000000000000,  0.000000000000000,  0.021275816760566,  -0.012381427368619,
        0.038314499923697,  0.025168970386943,  0.000000000000000,  0.000000000000000,  0.040805974379459,  0.043558450590912,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.050382948612805, -0.023924647766717, 0.000000000000000,  0.000000000000000,
        -0.062902673607408, -0.040673243993474, 0.031978643835602,  0.025778665415360,  -0.000000000000000, -0.000000000000000, 0.049294535610885,
        0.056307298331375,  -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.056378146331668,  0.020223634129277,
        0.000000000000000,  0.000000000000000,  0.073596625209000,  0.035124724702142,  -0.013988860661498, -0.014002761731149, 0.000000000000000,
        0.000000000000000,  -0.030267977454411, -0.036029547361225, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.038366838711237,  0.026598043546645,  0.000000000000000,  0.000000000000000,  0.043794103641986,  0.044266821933730,  -0.052242978778737,
        -0.038625655354256, -0.000000000000000, 0.000000000000000,  -0.069392646940462, -0.077401918530772, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.039849027290705, -0.013956684221303, 0.000000000000000,  0.000000000000000,  -0.052184851356526,
        -0.024290945682255, 0.008763432552822,  0.009131805452841,  0.000000000000000,  0.000000000000000,  0.020110039988076,  0.024074842035317,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.021265878201021, -0.010057550679239, 0.000000000000000,
        0.000000000000000,  -0.026570200825555, -0.017103019260006, 0.013362293857414,  0.010788565653123,  0.000000000000000,  -0.000000000000000,
        0.020651826750615,  0.023598849852966,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 36, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.022657259483459, -0.010187386460634, 0.000000000000000,  0.000000000000000,  -0.028567498630107,
        -0.017384019643780, 0.012478384693744,  0.010297042263024,  0.000000000000000,  0.000000000000000,  0.019995005964708,  0.022966598989473,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.018736463712078, -0.011986579962972, 0.000000000000000,
        0.000000000000000,  -0.021878221954275, -0.020027097560285, 0.022175707571364,  0.016590090938527,  0.000000000000000,  0.000000000000000,
        0.030076517744583,  0.033668500309751,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.098177870874717,
        0.029127908522319,  0.000000000000000,  0.000000000000000,  0.131146969189910,  0.051505082283650,  -0.004089901899533, -0.010579504370167,
        -0.000000000000000, 0.000000000000000,  -0.029558035408458, -0.037651555156834, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.066087050832117,  0.013390262234756,  0.000000000000000,  0.000000000000000,  0.091326472509472,  0.024806868561627,
        0.017939889274916,  0.006971380257970,  0.000000000000000,  0.000000000000000,  0.003737001195138,  0.000269161464535,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.075574422919207, -0.035886971650076, 0.000000000000000,  0.000000000000000,
        -0.094354010411112, -0.061009865990210, 0.047967965753403,  0.038667998123040,  -0.000000000000000, -0.000000000000000, 0.073941803416328,
        0.084460947497063,  -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.011650685400539,  -0.008200046273425,
        0.000000000000000,  0.000000000000000,  0.021275816760566,  -0.012381427368619, 0.038314499923697,  0.025168970386943,  0.000000000000000,
        0.000000000000000,  0.040805974379459,  0.043558450590912,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.096557452956082, -0.041546977260625, 0.000000000000000,  0.000000000000000,  -0.122660415602929, -0.071120837476629, 0.046960287594711,
        0.039647514998283,  -0.000000000000000, 0.000000000000000,  0.078109875933299,  0.090178727769677,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.080947579242983, -0.032125246899280, 0.000000000000000,  0.000000000000000,  -0.104156341453088,
        -0.055331491280276, 0.030364476543036,  0.027105795592824,  0.000000000000000,  0.000000000000000,  0.055198754443977,  0.064454872188316,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.007701150922653, -0.002298154954407, 0.000000000000000,
        0.000000000000000,  -0.010280736485294, -0.004061261694190, 0.000365213078802,  0.000860101759891,  -0.000000000000000, -0.000000000000000,
        0.002369263177016,  0.003008373985721,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 36, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.007527144642695, -0.000702390292795, 0.000000000000000,  0.000000000000000,  -0.010805053696759,
        -0.001520166010586, -0.004781803672311, -0.002659060962834, 0.000000000000000,  0.000000000000000,  -0.003553292776221, -0.003420373523818,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.011348666880515,  0.002175887521271,  0.000000000000000,
        0.000000000000000,  0.015743395414231,  0.004063929345434,  0.003491864336903,  0.001477173346578,  -0.000000000000000, 0.000000000000000,
        0.001111332531553,  0.000555171592275,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.156238937057580,
        0.040847558665325,  0.000000000000000,  0.000000000000000,  0.211404010124360,  0.073228786560132,  0.011819130829794,  -0.004354065272484,
        -0.000000000000000, 0.000000000000000,  -0.026105999084376, -0.037232054681025, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.195495296097666,  0.063834324942054,  0.000000000000000,  0.000000000000000,  0.258285505813323,  0.111814196865949,
        -0.027562102185486, -0.034290912869358, 0.000000000000000,  0.000000000000000,  -0.081034630117790, -0.099008944069469, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.015168442535940,  0.015447180484493,  0.000000000000000,  0.000000000000000,
        0.014897251312652,  0.025325052042284,  -0.037069449125977, -0.026450139233545, -0.000000000000000, -0.000000000000001, -0.046182323447007,
        -0.050919639125223, -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.130330197398444,  0.042556216628036,
        0.000000000000000,  0.000000000000000,  0.172190337208882,  0.074542797910633,  -0.018374734790324, -0.022860608579572, 0.000000000000000,
        0.000000000000000,  -0.054023086745193, -0.066005962712979, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.065099557107325, -0.017019816110552, 0.000000000000000,  0.000000000000000,  -0.088085004218483, -0.030511994400055, -0.004924637845748,
        0.001814193863535,  0.000000000000000,  0.000000000000000,  0.010877499618490,  0.015513356117094,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.058004297389301, -0.011121202886495, 0.000000000000000,  0.000000000000000,  -0.080466243228293,
        -0.020771194432219, -0.017847306610837, -0.007549997104733, 0.000000000000000,  0.000000000000000,  -0.005680144050159, -0.002837543693851,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.007464418437340, -0.000696537040355, 0.000000000000000,
        0.000000000000000,  -0.010715011582619, -0.001507497960497, -0.004741955308375, -0.002636902121477, 0.000000000000000,  0.000000000000000,
        -0.003523682003086, -0.003391870411119, 0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 36, 4));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeDFForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix dipxmat(20, 28);

    CDenseMatrix dipymat(20, 28);

    CDenseMatrix dipzmat(20, 28);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.428314583328408,  0.381747766502117,  -0.011556672641293, 0.011047134448751,  0.000000000000000,  0.000000000000000,  -0.011087866215844,
        0.012696935753929,  -0.110590349877913, -0.098566849474305, 0.002168637789625,  0.062580134275417,  0.000000000000000,  0.000000000000000,
        -0.070770349769937, -0.117322519783211, 0.000000000000000,  0.000000000000000,  0.056486806243685,  0.005875194661370,  0.000000000000000,
        0.000000000000000,  -0.092277999487497, -0.191847176942978, 0.000000000000000,  0.000000000000000,  -0.006968506749474, -0.038569407433126,
        0.484721399046776,  0.559016994374947,  0.008492872825596,  0.063049301343341,  0.000000000000000,  0.000000000000000,  -0.032269187506635,
        -0.017377872295805, -0.125154527070568, -0.144337567297406, 0.013644978132426,  0.069962189299821,  0.000000000000000,  0.000000000000000,
        -0.032597451580515, -0.105847677155217, 0.000000000000000,  0.000000000000000,  0.084623068345147,  0.049685813928023,  0.000000000000000,
        0.000000000000000,  -0.105724607074444, -0.251562209665788, 0.000000000000000,  0.000000000000000,  0.004000745377203,  -0.030839918321923,
        0.004979913642053,  0.021760075991924,  0.391362801066761,  0.211367263895789,  0.013911830530738,  0.045165313861866,  0.000000000000000,
        0.000000000000000,  0.001298167061973,  0.015100738198167,  -0.101049440723777, -0.054574792866788, -0.000454472416808, -0.028062901950447,
        0.000000000000000,  0.000000000000000,  -0.021101610105558, -0.057832481049140, -0.000000000000000, 0.000000000000000,  -0.117173022302696,
        -0.163776659645268, 0.000000000000000,  0.000000000000000,  -0.053507291486891, -0.085745572347305, -0.000000000000000, 0.000000000000000,
        0.085404718607463,  0.153262692608729,  0.361480434750525,  0.684653196881458,  -0.007025554228180, 0.014188973313323,  0.000000000000000,
        0.000000000000000,  -0.006825093170774, -0.003529699083989, -0.093333846917907, -0.176776695296637, 0.037379919883604,  0.033478887500533,
        0.000000000000000,  0.000000000000000,  0.041912802888925,  0.036260547489881,  0.000000000000000,  0.000000000000000,  -0.125102237459386,
        -0.205464581107443, 0.000000000000000,  0.000000000000000,  -0.037027398528475, -0.074004924122240, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.029121301295625, -0.039329886854620, 0.349717392849129,  0.311695746125774,  -0.012464921167539,
        -0.014622868447166, 0.000000000000000,  0.000000000000000,  -0.008134137620150, -0.010940356492174, 0.000000000000000,  0.000000000000000,
        -0.039864218272068, 0.003200552912402,  0.000000000000000,  0.000000000000000,  0.014946609253483,  -0.014584005187887, 0.000000000000000,
        0.000000000000000,  0.009427484142442,  0.000909451773964,  0.000000000000000,  0.000000000000000,  0.050970569730267,  0.060720894223727,
        0.000000000000000,  0.000000000000000,  -0.045753951230965, -0.071078346126067, 0.395773365024196,  0.456435464587639,  -0.025729454021895,
        -0.016244704648551, 0.000000000000000,  0.000000000000000,  -0.007730598581017, -0.023074783073786, 0.000000000000000,  0.000000000000000,
        -0.020165489994974, 0.013894096221697,  0.000000000000000,  0.000000000000000,  0.001836527021392,  -0.034098313525743, 0.000000000000000,
        0.000000000000000,  0.004969726717475,  0.000648704009334,  0.000000000000000,  0.000000000000000,  0.073607447677931,  0.108867282712130,
        0.004241703155548,  -0.004364126735480, 0.000000000000000,  0.000000000000000,  -0.021730965946702, -0.036954448316316, 0.319546388973308,
        0.172580648290961,  0.016593470106859,  0.028369359688199,  0.000000000000000,  0.000000000000000,  -0.022714152091196, -0.021984162289296,
        -0.000000000000000, 0.000000000000000,  0.042613365357436,  0.008158015672070,  0.000000000000000,  0.000000000000000,  0.075664339105405,
        0.058812430982958,  -0.000000000000000, 0.000000000000000,  0.087768724118339,  0.098728106420083,  0.000000000000000,  0.000000000000000,
        -0.045463031005957, -0.067382442981408, 0.000000000000000,  0.000000000000000,  -0.030005867723471, -0.025913197142055, 0.295147539046072,
        0.559016994374948,  0.026276832362628,  0.051223184523391,  0.000000000000000,  0.000000000000000,  -0.016525884844302, -0.022028764334982,
        0.000000000000000,  0.000000000000000,  -0.026446576786821, -0.052323848055306, 0.000000000000000,  0.000000000000000,  0.017565268803562,
        0.013263684499948,  0.000000000000000,  0.000000000000000,  0.118957436531986,  0.170991592765250,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.056606696065425,  0.011512755882424,  0.000000000000000,  0.000000000000000,  -0.010594173033287,
        -0.079089190291333, 0.000000000000000,  0.000000000000000,  0.011368119570698,  0.023630979197563,  0.000000000000000,  0.000000000000000,
        0.035048451640787,  0.043082920285921,  0.383096209630728,  0.341445582462981,  -0.089510795382403, -0.122635321888482, 0.000000000000000,
        0.000000000000000,  0.011856017648765,  -0.062603506698867, 0.000000000000000,  0.000000000000000,  -0.007710956405556, -0.001865832028674,
        0.000000000000000,  0.000000000000000,  0.068151818140532,  0.040380435361756,  0.000000000000000,  0.000000000000000,  -0.014133883644120,
        -0.099431963891181, 0.000000000000000,  0.000000000000000,  0.002049843970351,  0.011647585510911,  0.000000000000000,  0.000000000000000,
        0.017213280100083,  0.034013374987786,  0.433547999366957,  0.500000000000000,  -0.107856340973209, -0.158285096859403, 0.000000000000000,
        0.000000000000000,  0.005341192016081,  -0.072783836687191, 0.000000000000000,  -0.000000000000000, -0.014189788231099, -0.010397094625858,
        0.053717726951663,  0.031860808112699,  0.000000000000000,  0.000000000000000,  0.041434832387579,  -0.007552390559814, 0.000000000000000,
        0.000000000000000,  0.004332016320252,  0.009400222540491,  0.000000000000000,  0.000000000000000,  -0.024223950067503, 0.017686961138348,
        0.000000000000000,  0.000000000000000,  -0.101517080271369, -0.128718785198571, 0.350045530820002,  0.189052628115649,  -0.026210621062691,
        -0.057506481336980, 0.000000000000000,  0.000000000000000,  -0.048129544433572, -0.040970330640463, 0.000000000000000,  -0.000000000000000,
        0.069727293249627,  0.083587120711840,  0.000000000000000,  0.000000000000000,  -0.013471399137098, -0.045443167918710, 0.000000000000000,
        0.000000000000000,  -0.011500781591872, -0.006991904262828, 0.000000000000000,  0.000000000000000,  0.021038040328758,  0.057997829582768,
        0.000000000000000,  0.000000000000000,  -0.105028633393975, -0.137904151566984, 0.323317929855341,  0.612372435695795,  -0.019087747867637,
        -0.047541971755622, 0.000000000000000,  0.000000000000000,  -0.035075773868266, -0.045516476669352, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.033881936396646, -0.057514497443035, 0.000000000000000,  0.000000000000000,  0.031137128970346,
        -0.006120535914353, 0.000000000000000,  0.000000000000000,  -0.012766764951765, 0.096541042244333,  -0.270889927676751, -0.241438486765764,
        0.077808648814072,  0.163189738255909,  0.000000000000000,  0.000000000000000,  0.040375305766090,  0.046863652766105,  0.349717392849129,
        0.311695746125775,  -0.002812762963322, -0.009889960892006, 0.000000000000000,  0.000000000000000,  -0.061717586957503, -0.042753479015328,
        0.000000000000000,  0.000000000000000,  -0.058522836156902, -0.102042278947553, 0.000000000000000,  0.000000000000000,  0.038432553281809,
        0.002340740300346,  0.000000000000000,  0.000000000000000,  0.027825469985747,  0.141028709306663,  -0.306564730322236, -0.353553390593274,
        0.087451114522346,  0.190590752540205,  0.000000000000000,  0.000000000000000,  0.035326935904799,  0.049102839994048,  0.395773365024196,
        0.456435464587639,  -0.029815673767375, -0.015663123484627, 0.000000000000000,  0.000000000000000,  -0.085473875870862, -0.089063474905369,
        -0.091392758437752, -0.104875119661453, 0.000000000000000,  0.000000000000000,  -0.037738283907373, -0.055051267843412, 0.000000000000000,
        0.000000000000000,  0.015457773885510,  0.042987889692563,  0.000000000000000,  0.000000000000000,  0.100803903989325,  0.132302972015531,
        -0.247519568566868, -0.133680395341714, 0.038958015392539,  0.063218636875747,  0.000000000000000,  0.000000000000000,  -0.066680298833538,
        -0.058572600196737, 0.319546388973308,  0.172580648290960,  -0.037953684439753, -0.026103717221953, 0.000000000000000,  0.000000000000000,
        -0.113243135439937, -0.165524976924218, 0.000000000000000,  0.000000000000000,  0.003345021101304,  -0.001911206452072, 0.000000000000000,
        0.000000000000000,  0.048580963464654,  0.090666767315406,  0.000000000000000,  0.000000000000000,  0.066204028341309,  0.099474214596713,
        -0.228620300679908, -0.433012701892220, 0.056920329343752,  0.100760580949344,  0.000000000000000,  0.000000000000000,  -0.040367530936219,
        -0.032135284967932, 0.295147539046072,  0.559016994374948,  -0.083313381893689, -0.109120265899222, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.005256828518733,  0.043442555033119,  0.000000000000000,  0.000000000000000,  0.104408254095658,
        0.188294762800175,  0.000000000000000,  0.000000000000000,  -0.074627826130798, -0.082958277853468, 0.000000000000000,  0.000000000000000,
        0.022334399939023,  -0.047096845908146, -0.110590349877913, -0.098566849474305, 0.048923071313720,  0.107515832949486,  0.000000000000000,
        0.000000000000000,  -0.006037530394533, 0.046732117608665,  0.428314583328408,  0.381747766502117,  -0.018106539395162, 0.014730532339919,
        0.000000000000000,  0.000000000000000,  -0.009858873963561, 0.032092234241037,  0.000000000000000,  0.000000000000000,  0.117534752805674,
        0.251641691963961,  0.000000000000000,  0.000000000000000,  -0.060443774016191, -0.095165938915141, 0.000000000000000,  0.000000000000000,
        0.041982987588465,  -0.024060807574047, -0.125154527070568, -0.144337567297407, 0.034252744483005,  0.107053060979621,  0.000000000000000,
        0.000000000000000,  -0.046852169963641, 0.002911897775671,  0.484721399046776,  0.559016994374948,  -0.000629594467018, 0.062793384187341,
        0.046571709586829,  0.084863366519402,  0.000000000000000,  0.000000000000000,  0.103104706481339,  0.146896821523946,  0.000000000000000,
        0.000000000000000,  -0.011845097700562, -0.011858450983342, 0.000000000000000,  0.000000000000000,  -0.035500336417782, -0.066900375666997,
        0.000000000000000,  0.000000000000000,  -0.018337729875392, 0.010737322941956,  -0.101049440723777, -0.054574792866788, 0.011452215448774,
        0.066335472825249,  0.000000000000000,  0.000000000000000,  0.003483971342415,  0.025596923398387,  0.391362801066761,  0.211367263895789,
        0.029213052675264,  0.066291983316873,  0.000000000000000,  0.000000000000000,  0.127209948580489,  0.205399684082740,  0.000000000000000,
        0.000000000000000,  -0.001179206610712, -0.002667476757848, 0.000000000000000,  0.000000000000000,  0.025829779962051,  0.014603150071346,
        0.000000000000000,  0.000000000000000,  -0.027118856906869, -0.025040204756941, -0.093333846917907, -0.176776695296637, -0.028384900424000,
        -0.002377554577846, 0.000000000000000,  0.000000000000000,  0.078421658212740,  0.146836972528594,  0.361480434750525,  0.684653196881458};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 20, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.003850074316519,  0.043109412621976,  0.000000000000000,  0.000000000000000,  -0.020443633642445,
        0.039559555226533,  0.000000000000000,  0.000000000000000,  0.028655557554124,  -0.003226164399478, 0.000000000000000,  0.000000000000000,
        -0.100653027886866, -0.102152064943163, -0.110590349877913, -0.098566849474305, 0.075954846519273,  0.135504265428660,  0.000000000000000,
        0.000000000000000,  0.070879706451149,  0.144392869639624,  -0.428314583328408, -0.381747766502117, 0.009920204204062,  -0.044400011555245,
        0.000000000000000,  0.000000000000000,  -0.010819377284882, 0.031658014148480,  0.000000000000000,  0.000000000000000,  -0.062765935273867,
        -0.015027600364078, 0.000000000000000,  0.000000000000000,  0.062836697466347,  0.036804758589442,  0.000000000000000,  0.000000000000000,
        -0.070742882060452, -0.106337664664579, -0.125154527070568, -0.144337567297406, 0.073092444345419,  0.154634244786847,  0.000000000000000,
        0.000000000000000,  0.069034926527997,  0.178741460279178,  -0.484721399046776, -0.559016994374947, -0.000357374116112, -0.088203836060573,
        0.048131937195820,  0.086229316191277,  0.000000000000000,  0.000000000000000,  0.027144376533048,  0.088454023646888,  0.000000000000000,
        0.000000000000000,  0.002588585295565,  -0.034115579082457, -0.000000000000000, -0.000000000000000, 0.026771906701546,  0.018361994366393,
        0.000000000000000,  0.000000000000000,  0.001298167061973,  0.015100738198167,  -0.101049440723777, -0.054574792866788, 0.069098998209460,
        0.111431450879051,  0.000000000000000,  0.000000000000000,  -0.050514114795110, -0.096204268614242, -0.391362801066761, -0.211367263895789,
        0.029435168628221,  0.066646522537816,  0.000000000000000,  0.000000000000000,  -0.023346429507539, 0.012269984316818,  0.000000000000000,
        0.000000000000000,  0.044271216110350,  0.041595501005576,  -0.000000000000000, 0.000000000000000,  0.024220074763698,  0.028254726227799,
        0.000000000000000,  0.000000000000000,  -0.006825093170774, -0.003529699083989, -0.093333846917907, -0.176776695296637, 0.072983481340227,
        0.127967718938810,  0.000000000000000,  0.000000000000000,  -0.113550807532050, -0.212591098866112, -0.361480434750525, -0.684653196881458,
        0.000000000000000,  0.000000000000000,  0.045744819378056,  0.058642879859534,  0.000000000000000,  0.000000000000000,  0.012282160685461,
        -0.007939439462281, 0.000000000000000,  0.000000000000000,  0.033415142965426,  0.068468949598783,  -0.270889927676751, -0.241438486765764,
        0.044588466920682,  0.165856865682910,  0.000000000000000,  0.000000000000000,  -0.026609720423649, 0.063143008462639,  -0.349717392849129,
        -0.311695746125775, -0.015278607726598, 0.015748283965603,  0.000000000000000,  0.000000000000000,  0.001085073941404,  0.036986191108780,
        0.000000000000000,  0.000000000000000,  0.073456249268727,  0.108804548921584,  0.000000000000000,  0.000000000000000,  0.028493099846858,
        0.001043332281679,  0.000000000000000,  0.000000000000000,  0.039557978964281,  0.073140398906137,  -0.306564730322236, -0.353553390593274,
        0.070646539526535,  0.202169166058286,  0.000000000000000,  0.000000000000000,  0.009595363395219,  0.093676565481151,  -0.395773365024196,
        -0.456435464587639, 0.001929984963764,  0.014253093242117,  0.000000000000000,  0.000000000000000,  0.009147542188201,  0.054500761704762,
        0.085305425252213,  0.091342271780274,  0.000000000000000,  0.000000000000000,  -0.017042324223830, -0.040813870987357, 0.000000000000000,
        0.000000000000000,  0.067869454363588,  0.094394105153355,  0.000000000000000,  0.000000000000000,  0.081875443913329,  0.113982836774451,
        -0.247519568566868, -0.133680395341714, 0.016593470106859,  0.028369359688199,  0.000000000000000,  0.000000000000000,  0.089505552221540,
        0.098516408042891,  -0.319546388973308, -0.172580648290960, 0.069066720721394,  0.095271606392427,  0.000000000000000,  0.000000000000000,
        0.116214925185165,  0.165523210650925,  0.000000000000000,  0.000000000000000,  0.004515938795307,  -0.000851877240762, 0.000000000000000,
        0.000000000000000,  0.076214779094915,  0.137308880893697,  0.000000000000000,  0.000000000000000,  0.052432457637724,  0.081116910984228,
        -0.228620300679908, -0.433012701892220, 0.026276832362628,  0.051223184523391,  0.000000000000000,  0.000000000000000,  0.037092130979298,
        0.033286569839946,  -0.295147539046072, -0.559016994374948, 0.068124234306965,  0.109129293518273,  0.000000000000000,  0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.030067700401408, -0.005993723165850, 0.000000000000000,  0.000000000000000,  -0.021615704846003,
        -0.045128142370136, 0.383096209630728,  0.341445582462981,  -0.080037362406821, -0.102942839223846, 0.000000000000000,  0.000000000000000,
        0.052572677461181,  0.064624380428881,  0.000000000000000,  0.000000000000000,  0.011368119570698,  0.023630979197563,  0.000000000000000,
        0.000000000000000,  0.004045357762571,  0.082508283312172,  0.000000000000000,  0.000000000000000,  -0.034062080271289, -0.007350176584432,
        -0.000000000000000, 0.000000000000000,  -0.034197001445702, -0.019449666533668, 0.000000000000000,  0.000000000000000,  -0.020779343797742,
        -0.061291159958425, 0.433547999366957,  0.500000000000000,  -0.106148137664583, -0.148578775600311, 0.000000000000000,  0.000000000000000,
        0.025819920150124,  0.051020062481679,  0.000000000000000,  0.000000000000000,  0.002049843970351,  0.011647585510911,  0.000000000000000,
        0.000000000000000,  0.009023344028372,  0.101680531077244,  0.000000000000000,  0.000000000000000,  -0.047976477083789, -0.031251791421107,
        -0.011870232880415, -0.001967913157696, -0.000000000000000, 0.000000000000000,  0.069033869787419,  0.035327807034820,  0.000000000000000,
        0.000000000000000,  -0.097907066671158, -0.120885266414828, 0.350045530820002,  0.189052628115649,  -0.036335925101255, 0.026530441707522,
        0.000000000000000,  0.000000000000000,  0.004332016320252,  0.009400222540491,  0.000000000000000,  0.000000000000000,  -0.022800040699514,
        0.025715620893427,  0.000000000000000,  0.000000000000000,  -0.090281738601905, -0.071190977002884, 0.000000000000000,  0.000000000000000,
        -0.026594052368902, -0.030464019213445, 0.000000000000000,  0.000000000000000,  -0.001206459596857, -0.017028886451077, 0.000000000000000,
        0.000000000000000,  -0.114612618053868, -0.143730738452674, 0.323317929855341,  0.612372435695795,  0.031557060493137,  0.086996744374151,
        0.000000000000000,  0.000000000000000,  -0.011500781591872, -0.006991904262828, 0.000000000000000,  0.000000000000000,  0.016969912059642,
        0.051413119391338,  0.000000000000000,  0.000000000000000,  -0.078280289719574, -0.098766069406873, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.029121301295625, -0.039329886854620, 0.349717392849129,  0.311695746125774,  -0.012464921167539,
        -0.014622868447166, 0.000000000000000,  0.000000000000000,  -0.008134137620150, -0.010940356492174, 0.000000000000000,  0.000000000000000,
        -0.039864218272068, 0.003200552912402,  0.000000000000000,  0.000000000000000,  0.014946609253483,  -0.014584005187887, 0.000000000000000,
        0.000000000000000,  0.009427484142442,  0.000909451773964,  0.000000000000000,  0.000000000000000,  0.050970569730267,  0.060720894223727,
        0.000000000000000,  0.000000000000000,  -0.045753951230965, -0.071078346126067, 0.395773365024196,  0.456435464587639,  -0.025729454021895,
        -0.016244704648551, 0.000000000000000,  0.000000000000000,  -0.007730598581017, -0.023074783073786, 0.000000000000000,  0.000000000000000,
        -0.020165489994974, 0.013894096221697,  0.000000000000000,  0.000000000000000,  0.001836527021392,  -0.034098313525743, 0.000000000000000,
        0.000000000000000,  0.004969726717475,  0.000648704009334,  0.000000000000000,  0.000000000000000,  0.073607447677931,  0.108867282712130,
        -0.116319657715889, -0.121438985428795, 0.000000000000000,  0.000000000000000,  -0.093407898402682, -0.091897056158804, 0.319546388973308,
        0.172580648290961,  0.034697197754810,  0.005149443674536,  0.000000000000000,  0.000000000000000,  -0.022714152091196, -0.021984162289296,
        -0.000000000000000, -0.000000000000000, 0.015457773885510,  0.042987889692563,  0.000000000000000,  0.000000000000000,  -0.096360298788948,
        -0.073049827839013, 0.000000000000000,  0.000000000000000,  0.064180631773928,  0.075822155806173,  0.000000000000000,  0.000000000000000,
        -0.106694584249934, -0.152016371591896, 0.000000000000000,  0.000000000000000,  -0.045131474098941, -0.037407654730058, 0.295147539046072,
        0.559016994374948,  -0.023741527805022, -0.044103892390416, 0.000000000000000,  0.000000000000000,  -0.016525884844302, -0.022028764334982,
        -0.000000000000000, 0.000000000000000,  0.048580963464654,  0.090666767315406,  0.000000000000000,  0.000000000000000,  -0.018736186497565,
        -0.014323013711259, 0.000000000000000,  0.000000000000000,  0.106977350027730,  0.154432780645807,  0.000000000000000,  0.000000000000000,
        0.428314583328408,  0.381747766502117,  -0.009555228442221, 0.049720957288629,  0.000000000000000,  0.000000000000000,  -0.060244462604288,
        -0.109035090189145, 0.110590349877913,  0.098566849474305,  -0.084399056229474, -0.108619595558608, 0.000000000000000,  0.000000000000000,
        0.046707592151828,  0.106550846493751,  0.000000000000000,  0.000000000000000,  0.102459074820359,  0.092059636914316,  0.000000000000000,
        0.000000000000000,  -0.005244461273120, 0.049584024817359,  0.000000000000000,  0.000000000000000,  0.008375260951688,  0.038902549844270,
        0.484721399046776,  0.559016994374948,  -0.004043778541504, 0.090082309939243,  0.000000000000000,  0.000000000000000,  -0.079804646725415,
        -0.156727807473988, 0.125154527070568,  0.144337567297407,  -0.095694313571127, -0.143090799528565, 0.000000000000000,  0.000000000000000,
        0.010542390127466,  0.089750031202722,  0.000000000000000,  0.000000000000000,  0.082230144894991,  0.108046994253721,  0.000000000000000,
        0.000000000000000,  -0.055916100931547, -0.006671361416122, 0.000000000000000,  0.000000000000000,  -0.003040242055882, 0.031274138414480,
        0.041348937750791,  0.093326846498324,  0.391362801066761,  0.211367263895790,  -0.077752820979897, -0.095684203233759, 0.000000000000000,
        0.000000000000000,  0.026051490212889,  0.027574368779543,  0.101049440723777,  0.054574792866788,  0.012638172157546,  0.044744670000459,
        0.000000000000000,  0.000000000000000,  -0.011845097700562, -0.011858450983342, -0.000000000000000, -0.000000000000000, 0.010901692436221,
        0.078797156383784,  0.000000000000000,  0.000000000000000,  0.051947063877900,  0.084379622675429,  0.000000000000000,  0.000000000000000,
        0.105475945291270,  0.204422655803806,  0.361480434750525,  0.684653196881458,  -0.095224642686356, -0.145941791187978, 0.000000000000000,
        0.000000000000000,  -0.008791151009495, -0.007399815449500, 0.093333846917907,  0.176776695296637,  -0.037694862205021, -0.030807926948184,
        0.000000000000000,  0.000000000000000,  -0.001179206610712, -0.002667476757848, -0.000000000000000, 0.000000000000000,  -0.029769252470731,
        0.005447143786397,  0.000000000000000,  0.000000000000000,  0.036805282575518,  0.073650384901297,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 20, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.029121301295625, -0.039329886854620, 0.349717392849129,  0.311695746125774,  -0.012464921167539,
        -0.014622868447166, 0.000000000000000,  0.000000000000000,  -0.008134137620150, -0.010940356492174, 0.000000000000000,  0.000000000000000,
        -0.039864218272068, 0.003200552912402,  0.000000000000000,  0.000000000000000,  0.014946609253483,  -0.014584005187887, 0.000000000000000,
        0.000000000000000,  0.009427484142442,  0.000909451773964,  0.000000000000000,  0.000000000000000,  0.050970569730267,  0.060720894223727,
        0.000000000000000,  0.000000000000000,  -0.045753951230965, -0.071078346126067, 0.395773365024196,  0.456435464587639,  -0.025729454021895,
        -0.016244704648551, 0.000000000000000,  0.000000000000000,  -0.007730598581017, -0.023074783073786, 0.000000000000000,  0.000000000000000,
        -0.020165489994974, 0.013894096221697,  0.000000000000000,  0.000000000000000,  0.001836527021392,  -0.034098313525743, 0.000000000000000,
        0.000000000000000,  0.004969726717475,  0.000648704009334,  0.000000000000000,  0.000000000000000,  0.073607447677931,  0.108867282712130,
        0.033889028923174,  0.063930361497651,  0.000000000000000,  0.000000000000000,  0.036035595710260,  0.096114476559794,  0.319546388973308,
        0.172580648290961,  -0.021681062879008, -0.059798445500027, -0.000000000000000, -0.000000000000000, 0.215358408457195,  0.222831706070880,
        -0.000000000000000, 0.000000000000000,  -0.143461013169635, -0.187835335041687, -0.000000000000000, 0.000000000000000,  -0.022020462720450,
        -0.018453625918425, 0.000000000000000,  0.000000000000000,  -0.058917331358884, -0.102972745256555, -0.000000000000000, 0.000000000000000,
        0.026927210986033,  0.058035226589931,  0.000000000000000,  0.000000000000000,  0.111043460305939,  0.218457833113781,  0.295147539046072,
        0.559016994374948,  -0.067178568191674, -0.110690330666589, -0.000000000000000, 0.000000000000000,  0.124166492189048,  0.181184168833881,
        0.000000000000000,  0.000000000000000,  -0.143156221274697, -0.223461287215767, 0.000000000000000,  0.000000000000000,  -0.006513761677270,
        -0.008723733381261, 0.000000000000000,  0.000000000000000,  -0.041541634641111, -0.088889764109347, 0.000000000000000,  0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.054080228961070, -0.049055255889632, 0.000000000000000,  0.000000000000000,  0.011717097353754,
        0.043567790506796,  0.442361399511652,  0.394267397897221,  -0.052061084173319, -0.007102497977072, 0.000000000000000,  0.000000000000000,
        -0.026419393469068, -0.111940655966480, 0.000000000000000,  0.000000000000000,  -0.026282107893707, -0.045254385650164, 0.000000000000000,
        0.000000000000000,  -0.080026773034810, -0.098522663018369, 0.000000000000000,  0.000000000000000,  -0.074341021342523, -0.090202836566234,
        0.000000000000000,  0.000000000000000,  -0.046694292603362, -0.060720819222487, 0.000000000000000,  0.000000000000000,  0.011544580013150,
        0.033190532075359,  0.500618108282272,  0.577350269189626,  -0.074514675860320, -0.044292999437727, 0.000000000000000,  0.000000000000000,
        0.001581571839406,  -0.107228367934332, 0.000000000000000,  0.000000000000000,  0.005943357354391,  -0.038186970435298, 0.000000000000000,
        0.000000000000000,  -0.034179615831584, -0.068775002283293, 0.000000000000000,  0.000000000000000,  -0.076056708444203, -0.116243747305306,
        0.027668858983598,  0.025132564815980,  0.000000000000000,  0.000000000000000,  -0.013460473989023, -0.016158280390237, 0.000000000000000,
        0.000000000000000,  0.024672681852346,  0.065001558198047,  0.404197762895107,  0.218299171467152,  -0.009510970220050, -0.112170918121862,
        -0.000000000000000, 0.000000000000000,  0.037051461463630,  -0.025391757936668, 0.000000000000000,  0.000000000000000,  0.086019146894179,
        0.048218245635436,  -0.000000000000000, 0.000000000000000,  0.037847336818769,  0.040672267464618,  -0.000000000000000, 0.000000000000000,
        0.002892954859968,  0.003010166798867,  -0.000000000000000, 0.000000000000000,  -0.028010390343535, -0.027099955958703, 0.000000000000000,
        0.000000000000000,  0.022341516002631,  0.105091991114946,  0.373335387671627,  0.707106781186548,  -0.054045976071978, -0.135284449866983,
        0.000000000000000,  0.000000000000000,  -0.005566530666812, -0.034334441875705, 0.000000000000000,  0.000000000000000,  0.062852143886212,
        0.056154554217606,  0.000000000000000,  0.000000000000000,  0.005327366667569,  0.005762653949582,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.015117153222680, -0.009181675512608, 0.000000000000000,  0.000000000000000,  -0.064070963355430,
        -0.000960876690783, 0.000000000000000,  0.000000000000000,  0.057628131423609,  0.095262944782364,  0.469195117994791,  0.418183725980849,
        0.039363172647581,  0.058452078042002,  0.000000000000000,  0.000000000000000,  0.038418754282406,  0.063508629854909,  0.000000000000000,
        0.000000000000000,  0.026696234731429,  0.000400365287826,  0.000000000000000,  0.000000000000000,  0.077265449804808,  0.046928563731105,
        0.000000000000000,  0.000000000000000,  -0.011511614361631, -0.010790874628349, 0.000000000000000,  0.000000000000000,  -0.006451862578827,
        0.033021938853826,  0.000000000000000,  0.000000000000000,  0.071645007346407,  0.110315246039345,  0.530985688726764,  0.612372435695795,
        -0.045448986134118, 0.000867978997355,  0.000000000000000,  0.000000000000000,  0.047763338230938,  0.073543497359563,  0.000000000000000,
        0.000000000000000,  0.002688276074511,  -0.013759141189094, 0.000000000000000,  0.000000000000000,  0.058837140070557,  0.055153359211562,
        0.007607621849803,  0.007415107732999,  0.000000000000000,  0.000000000000000,  0.095030822676441,  0.077969129524232,  0.000000000000000,
        0.000000000000000,  0.012559776253471,  0.012384700125678,  0.000000000000000,  0.000000000000000,  -0.121529535596327, -0.027466106490964,
        0.428716468625343,  0.231541236707742,  0.008373184168980,  0.008256466750452,  0.000000000000000,  0.000000000000000,  -0.039596176115184,
        -0.032487137301763, 0.000000000000000,  0.000000000000000,  -0.038883400565658, -0.037899439524217, 0.000000000000000,  0.000000000000000,
        0.001428261919794,  0.002437222482853,  0.000000000000000,  0.000000000000000,  0.072451431733071,  0.100612895863706,  0.000000000000000,
        0.000000000000000,  0.029166756818484,  0.059954396196306,  0.000000000000000,  0.000000000000000,  -0.046880062717687, 0.030847978213563,
        0.395981976419274,  0.750000000000001,  0.019444504545656,  0.039969597464204,  0.000000000000000,  0.000000000000000,  -0.030188096555446,
        -0.041922039943211, 0.000000000000000,  0.000000000000000,  -0.007300005367837, -0.012456914912358, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.107152576469177,  0.106492645778591,  0.000000000000000,  0.000000000000000,  0.065614974495384,
        0.090867822112636,  0.000000000000000,  0.000000000000000,  -0.026282107893707, -0.045254385650164, 0.000000000000000,  0.000000000000000,
        -0.017612928979378, -0.074627103977653, 0.442361399511652,  0.394267397897221,  -0.030159327595230, 0.030609490064732,  0.000000000000000,
        0.000000000000000,  0.085377400999709,  0.082692532913874,  0.000000000000000,  0.000000000000000,  -0.021542103460472, -0.032901195087378,
        0.000000000000000,  0.000000000000000,  0.097364160399153,  0.133691214067829,  0.000000000000000,  0.000000000000000,  0.030288212951924,
        0.064392878244004,  0.000000000000000,  0.000000000000000,  0.005943357354391,  -0.038186970435298, 0.000000000000000,  0.000000000000000,
        0.001054381226271,  -0.071485578622888, 0.500618108282272,  0.577350269189626,  -0.079467473655646, -0.012470524074979, 0.000000000000000,
        0.000000000000000,  0.031433972509189,  0.055588054942839,  0.000000000000000,  -0.000000000000000, -0.025564402748036, -0.043418748016319,
        -0.054745517139400, -0.052297053318898, 0.000000000000000,  0.000000000000000,  -0.070827969376338, -0.042684209085417, 0.000000000000000,
        0.000000000000000,  0.037051461463630,  -0.025391757936668, 0.000000000000000,  0.000000000000000,  -0.006340646813367, -0.074780612081241,
        -0.000000000000000, -0.000000000000000, -0.006203536034012, 0.086161356478603,  0.404197762895107,  0.218299171467152,  -0.091104270191321,
        -0.044443356090332, 0.000000000000000,  0.000000000000000,  0.010911496832306,  0.013604652177152,  0.000000000000000,  -0.000000000000000,
        -0.006283416961270, -0.006627592628694, 0.000000000000000,  0.000000000000000,  -0.058043707339079, -0.052576564922324, 0.000000000000000,
        0.000000000000000,  -0.005566530666812, -0.034334441875705, 0.000000000000000,  0.000000000000000,  -0.036030650714652, -0.090189633244656,
        -0.000000000000000, 0.000000000000000,  0.026980291558307,  0.133704026011367,  0.373335387671627,  0.707106781186548,  -0.052586843806660,
        -0.045387456801250, 0.000000000000000,  0.000000000000000,  0.001944871652048,  0.002152435942081,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.039813377887351, -0.058078688651285, 0.000000000000000,  0.000000000000000,  0.009427484142442,
        0.000909451773964,  0.000000000000000,  0.000000000000000,  -0.023090953958596, 0.014036046322775,  0.000000000000000,  0.000000000000000,
        0.016610090946695,  -0.001333563713501, 0.000000000000000,  0.000000000000000,  0.033492513094869,  -0.008139677848267, 0.349717392849129,
        0.311695746125774,  0.006232922381638,  -0.012819122428804, 0.000000000000000,  0.000000000000000,  -0.031401330449454, -0.039869835062054,
        0.000000000000000,  0.000000000000000,  -0.065989542712814, -0.105423413934568, 0.000000000000000,  0.000000000000000,  0.004969726717475,
        0.000648704009334,  0.000000000000000,  0.000000000000000,  -0.005866254489267, 0.033944155200263,  0.000000000000000,  0.000000000000000,
        0.008402287497906,  -0.005789206759040, 0.000000000000000,  0.000000000000000,  0.012865786254790,  -0.022286862743552, 0.395773365024196,
        0.456435464587638,  -0.015872829365569, -0.014958108363372, 0.000000000000000,  0.000000000000000,  -0.047310709029532, -0.071782118305066,
        0.046542917460035,  0.092139180648820,  0.000000000000000,  0.000000000000000,  -0.022020462720450, -0.018453625918425, 0.000000000000000,
        0.000000000000000,  0.176742838824972,  0.217276635079181,  0.000000000000000,  0.000000000000000,  -0.089732670190498, -0.092846544196200,
        0.000000000000000,  0.000000000000000,  -0.191788171784063, -0.210276201247219, -0.000000000000000, -0.000000000000000, -0.007638322018633,
        0.059514785154917,  0.319546388973308,  0.172580648290960,  0.036417803622772,  0.066144255772599,  0.000000000000000,  0.000000000000000,
        0.039779997608418,  0.086077857027304,  0.000000000000000,  0.000000000000000,  -0.006513761677270, -0.008723733381261, 0.000000000000000,
        0.000000000000000,  0.155872731970853,  0.240689024580532,  0.000000000000000,  0.000000000000000,  -0.051736038412103, -0.075493403680784,
        0.000000000000000,  0.000000000000000,  -0.132174067305360, -0.198743210530943, -0.000000000000000, 0.000000000000000,  0.098124499646020,
        0.201155761907613,  0.295147539046072,  0.559016994374948,  0.027287210513652,  0.058609854167836,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 20, 28));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeFDForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix dipxmat(28, 20);

    CDenseMatrix dipymat(28, 20);

    CDenseMatrix dipzmat(28, 20);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.428314583328408,  0.484721399046776,  0.004979913642053,  0.085404718607463,  0.000000000000000,  0.000000000000000,  0.004241703155548,
        -0.045463031005957, 0.000000000000000,  0.000000000000000,  0.053717726951663,  0.069727293249627,  0.000000000000000,  0.000000000000000,
        -0.091392758437752, -0.113243135439937, 0.000000000000000,  0.000000000000000,  0.046571709586829,  0.029213052675264,  0.381747766502117,
        0.559016994374947,  0.021760075991924,  0.153262692608729,  0.000000000000000,  0.000000000000000,  -0.004364126735480, -0.067382442981408,
        0.000000000000000,  0.000000000000000,  0.031860808112699,  0.083587120711840,  0.000000000000000,  0.000000000000000,  -0.104875119661453,
        -0.165524976924218, 0.000000000000000,  0.000000000000000,  0.084863366519402,  0.066291983316873,  -0.011556672641293, 0.008492872825596,
        0.391362801066761,  0.361480434750525,  -0.029121301295625, -0.045753951230965, 0.000000000000000,  0.000000000000000,  0.056606696065425,
        0.068151818140532,  0.000000000000000,  0.000000000000000,  -0.033881936396646, -0.058522836156902, 0.000000000000000,  0.000000000000000,
        0.005256828518733,  -0.009858873963561, 0.000000000000000,  0.000000000000000,  0.011047134448751,  0.063049301343341,  0.211367263895789,
        0.684653196881458,  -0.039329886854620, -0.071078346126067, 0.000000000000000,  0.000000000000000,  0.011512755882424,  0.040380435361756,
        0.000000000000000,  0.000000000000000,  -0.057514497443035, -0.102042278947553, 0.000000000000000,  0.000000000000000,  0.043442555033119,
        0.032092234241037,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.013911830530738,  -0.007025554228180,
        0.349717392849129,  0.395773365024196,  -0.021730965946702, -0.030005867723471, 0.000000000000000,  0.000000000000000,  0.041434832387579,
        -0.013471399137098, 0.000000000000000,  0.000000000000000,  -0.037738283907373, 0.003345021101304,  0.000000000000000,  0.000000000000000,
        0.103104706481339,  0.127209948580489,  0.000000000000000,  0.000000000000000,  0.045165313861866,  0.014188973313323,  0.311695746125774,
        0.456435464587639,  -0.036954448316316, -0.025913197142055, 0.000000000000000,  0.000000000000000,  -0.007552390559814, -0.045443167918710,
        0.000000000000000,  0.000000000000000,  -0.055051267843412, -0.001911206452072, 0.000000000000000,  0.000000000000000,  0.146896821523946,
        0.205399684082740,  -0.011087866215844, -0.032269187506635, 0.000000000000000,  0.000000000000000,  -0.012464921167539, -0.025729454021895,
        0.319546388973308,  0.295147539046072,  -0.010594173033287, -0.014133883644120, 0.000000000000000,  0.000000000000000,  0.031137128970346,
        0.038432553281809,  0.000000000000000,  0.000000000000000,  0.104408254095658,  0.117534752805674,  0.000000000000000,  0.000000000000000,
        0.012696935753929,  -0.017377872295805, 0.000000000000000,  0.000000000000000,  -0.014622868447166, -0.016244704648551, 0.172580648290961,
        0.559016994374948,  -0.079089190291333, -0.099431963891181, 0.000000000000000,  0.000000000000000,  -0.006120535914353, 0.002340740300346,
        0.000000000000000,  0.000000000000000,  0.188294762800175,  0.251641691963961,  0.000000000000000,  0.000000000000000,  -0.110590349877913,
        -0.125154527070568, 0.001298167061973,  -0.006825093170774, 0.000000000000000,  0.000000000000000,  0.016593470106859,  0.026276832362628,
        0.000000000000000,  0.000000000000000,  0.004332016320252,  -0.011500781591872, 0.000000000000000,  0.000000000000000,  0.015457773885510,
        0.048580963464654,  0.000000000000000,  0.000000000000000,  -0.011845097700562, -0.001179206610712, -0.098566849474305, -0.144337567297406,
        0.015100738198167,  -0.003529699083989, 0.000000000000000,  0.000000000000000,  0.028369359688199,  0.051223184523391,  0.000000000000000,
        0.000000000000000,  0.009400222540491,  -0.006991904262828, 0.000000000000000,  0.000000000000000,  0.042987889692563,  0.090666767315406,
        0.000000000000000,  0.000000000000000,  -0.011858450983342, -0.002667476757848, 0.002168637789625,  0.013644978132426,  -0.101049440723777,
        -0.093333846917907, -0.008134137620150, -0.007730598581017, 0.000000000000000,  0.000000000000000,  0.011368119570698,  0.002049843970351,
        0.000000000000000,  0.000000000000000,  -0.012766764951765, 0.027825469985747,  0.000000000000000,  0.000000000000000,  -0.074627826130798,
        -0.060443774016191, 0.000000000000000,  0.000000000000000,  0.062580134275417,  0.069962189299821,  -0.054574792866788, -0.176776695296637,
        -0.010940356492174, -0.023074783073786, 0.000000000000000,  0.000000000000000,  0.023630979197563,  0.011647585510911,  0.000000000000000,
        0.000000000000000,  0.096541042244333,  0.141028709306663,  0.000000000000000,  0.000000000000000,  -0.082958277853468, -0.095165938915141,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.000454472416808, 0.037379919883604,  0.000000000000000,
        0.000000000000000,  -0.022714152091196, -0.016525884844302, 0.000000000000000,  0.000000000000000,  -0.024223950067503, 0.021038040328758,
        -0.270889927676751, -0.306564730322236, 0.100803903989325,  0.066204028341309,  0.000000000000000,  0.000000000000000,  -0.035500336417782,
        0.025829779962051,  0.000000000000000,  0.000000000000000,  -0.028062901950447, 0.033478887500533,  0.000000000000000,  0.000000000000000,
        -0.021984162289296, -0.022028764334982, 0.000000000000000,  0.000000000000000,  0.017686961138348,  0.057997829582768,  -0.241438486765764,
        -0.353553390593274, 0.132302972015531,  0.099474214596713,  0.000000000000000,  0.000000000000000,  -0.066900375666997, 0.014603150071346,
        -0.070770349769937, -0.032597451580515, 0.000000000000000,  0.000000000000000,  -0.039864218272068, -0.020165489994974, -0.000000000000000,
        0.000000000000000,  0.035048451640787,  0.017213280100083,  0.000000000000000,  0.000000000000000,  0.077808648814072,  0.087451114522346,
        -0.247519568566868, -0.228620300679908, 0.022334399939023,  0.041982987588465,  0.000000000000000,  0.000000000000000,  -0.117322519783211,
        -0.105847677155217, 0.000000000000000,  0.000000000000000,  0.003200552912402,  0.013894096221697,  0.000000000000000,  0.000000000000000,
        0.043082920285921,  0.034013374987786,  0.000000000000000,  0.000000000000000,  0.163189738255909,  0.190590752540205,  -0.133680395341714,
        -0.433012701892220, -0.047096845908146, -0.024060807574047, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.021101610105558, 0.041912802888925,  0.000000000000000,  0.000000000000000,  0.042613365357436,  -0.026446576786821, 0.383096209630728,
        0.433547999366957,  -0.101517080271369, -0.105028633393975, 0.000000000000000,  0.000000000000000,  0.038958015392539,  0.056920329343752,
        -0.110590349877913, -0.125154527070568, -0.018337729875392, -0.027118856906869, 0.000000000000000,  0.000000000000000,  -0.057832481049140,
        0.036260547489881,  0.000000000000000,  0.000000000000000,  0.008158015672070,  -0.052323848055306, 0.341445582462981,  0.500000000000000,
        -0.128718785198571, -0.137904151566984, 0.000000000000000,  0.000000000000000,  0.063218636875747,  0.100760580949344,  -0.098566849474305,
        -0.144337567297407, 0.010737322941956,  -0.025040204756941, 0.056486806243685,  0.084623068345147,  -0.000000000000000, 0.000000000000000,
        0.014946609253483,  0.001836527021392,  0.000000000000000,  0.000000000000000,  -0.089510795382403, -0.107856340973209, 0.350045530820002,
        0.323317929855341,  0.040375305766090,  0.035326935904799,  0.000000000000000,  0.000000000000000,  0.048923071313720,  0.034252744483005,
        -0.101049440723777, -0.093333846917907, 0.005875194661370,  0.049685813928023,  0.000000000000000,  0.000000000000000,  -0.014584005187887,
        -0.034098313525743, 0.000000000000000,  0.000000000000000,  -0.122635321888482, -0.158285096859403, 0.189052628115649,  0.612372435695795,
        0.046863652766105,  0.049102839994048,  0.000000000000000,  0.000000000000000,  0.107515832949486,  0.107053060979621,  -0.054574792866788,
        -0.176776695296637, 0.000000000000000,  0.000000000000000,  -0.117173022302696, -0.125102237459386, 0.000000000000000,  0.000000000000000,
        0.075664339105405,  0.017565268803562,  0.000000000000000,  0.000000000000000,  -0.026210621062691, -0.019087747867637, 0.349717392849129,
        0.395773365024196,  -0.066680298833538, -0.040367530936219, 0.000000000000000,  0.000000000000000,  0.011452215448774,  -0.028384900424000,
        0.000000000000000,  0.000000000000000,  -0.163776659645268, -0.205464581107443, 0.000000000000000,  0.000000000000000,  0.058812430982958,
        0.013263684499948,  0.000000000000000,  0.000000000000000,  -0.057506481336980, -0.047541971755622, 0.311695746125775,  0.456435464587639,
        -0.058572600196737, -0.032135284967932, 0.000000000000000,  0.000000000000000,  0.066335472825249,  -0.002377554577846, -0.092277999487497,
        -0.105724607074444, 0.000000000000000,  0.000000000000000,  0.009427484142442,  0.004969726717475,  -0.000000000000000, 0.000000000000000,
        0.011856017648765,  0.005341192016081,  0.000000000000000,  0.000000000000000,  -0.002812762963322, -0.029815673767375, 0.319546388973308,
        0.295147539046072,  -0.006037530394533, -0.046852169963641, 0.000000000000000,  0.000000000000000,  -0.191847176942978, -0.251562209665788,
        0.000000000000000,  0.000000000000000,  0.000909451773964,  0.000648704009334,  0.000000000000000,  0.000000000000000,  -0.062603506698867,
        -0.072783836687191, 0.000000000000000,  0.000000000000000,  -0.009889960892006, -0.015663123484627, 0.172580648290960,  0.559016994374948,
        0.046732117608665,  0.002911897775671,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.053507291486891,
        -0.037027398528475, 0.000000000000000,  0.000000000000000,  0.087768724118339,  0.118957436531986,  0.000000000000000,  0.000000000000000,
        -0.048129544433572, -0.035075773868266, 0.000000000000000,  0.000000000000000,  -0.037953684439753, -0.083313381893689, 0.428314583328408,
        0.484721399046776,  0.003483971342415,  0.078421658212740,  0.000000000000000,  0.000000000000000,  -0.085745572347305, -0.074004924122240,
        0.000000000000000,  0.000000000000000,  0.098728106420083,  0.170991592765250,  0.000000000000000,  -0.000000000000000, -0.040970330640463,
        -0.045516476669352, 0.000000000000000,  0.000000000000000,  -0.026103717221953, -0.109120265899222, 0.381747766502117,  0.559016994374948,
        0.025596923398387,  0.146836972528594,  -0.006968506749474, 0.004000745377203,  -0.000000000000000, 0.000000000000000,  0.050970569730267,
        0.073607447677931,  0.000000000000000,  0.000000000000000,  -0.007710956405556, -0.014189788231099, 0.000000000000000,  -0.000000000000000,
        -0.061717586957503, -0.085473875870862, 0.000000000000000,  0.000000000000000,  -0.018106539395162, -0.000629594467018, 0.391362801066761,
        0.361480434750525,  -0.038569407433126, -0.030839918321923, 0.000000000000000,  0.000000000000000,  0.060720894223727,  0.108867282712130,
        0.000000000000000,  0.000000000000000,  -0.001865832028674, -0.010397094625858, -0.000000000000000, 0.000000000000000,  -0.042753479015328,
        -0.089063474905369, 0.000000000000000,  0.000000000000000,  0.014730532339919,  0.062793384187341,  0.211367263895789,  0.684653196881458};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 28, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.048131937195820,  0.029435168628221,  0.000000000000000,  0.000000000000000,  0.085305425252213,
        0.116214925185165,  -0.000000000000000, -0.000000000000000, -0.011870232880415, -0.026594052368902, 0.000000000000000,  0.000000000000000,
        -0.116319657715889, -0.106694584249934, 0.428314583328408,  0.484721399046776,  0.041348937750791,  0.105475945291270,  0.000000000000000,
        0.000000000000000,  0.086229316191277,  0.066646522537816,  0.000000000000000,  0.000000000000000,  0.091342271780274,  0.165523210650925,
        0.000000000000000,  0.000000000000000,  -0.001967913157696, -0.030464019213445, 0.000000000000000,  0.000000000000000,  -0.121438985428795,
        -0.152016371591896, 0.381747766502117,  0.559016994374948,  0.093326846498324,  0.204422655803806,  0.003850074316519,  -0.010819377284882,
        0.000000000000000,  0.000000000000000,  0.045744819378056,  0.073456249268727,  0.000000000000000,  0.000000000000000,  -0.030067700401408,
        -0.034197001445702, -0.000000000000000, 0.000000000000000,  -0.029121301295625, -0.045753951230965, 0.000000000000000,  0.000000000000000,
        -0.009555228442221, -0.004043778541504, 0.391362801066761,  0.361480434750525,  0.043109412621976,  0.031658014148480,  0.000000000000000,
        0.000000000000000,  0.058642879859534,  0.108804548921584,  0.000000000000000,  0.000000000000000,  -0.005993723165850, -0.019449666533668,
        0.000000000000000,  0.000000000000000,  -0.039329886854620, -0.071078346126067, 0.000000000000000,  0.000000000000000,  0.049720957288629,
        0.090082309939243,  0.211367263895790,  0.684653196881458,  0.000000000000000,  0.000000000000000,  0.027144376533048,  -0.023346429507539,
        0.000000000000000,  0.000000000000000,  -0.017042324223830, 0.004515938795307,  0.000000000000000,  0.000000000000000,  0.069033869787419,
        -0.001206459596857, 0.349717392849129,  0.395773365024196,  -0.093407898402682, -0.045131474098941, 0.000000000000000,  0.000000000000000,
        -0.077752820979897, -0.095224642686356, 0.000000000000000,  0.000000000000000,  0.088454023646888,  0.012269984316818,  0.000000000000000,
        0.000000000000000,  -0.040813870987357, -0.000851877240762, 0.000000000000000,  0.000000000000000,  0.035327807034820,  -0.017028886451077,
        0.311695746125774,  0.456435464587639,  -0.091897056158804, -0.037407654730058, 0.000000000000000,  0.000000000000000,  -0.095684203233759,
        -0.145941791187978, -0.020443633642445, -0.062765935273867, 0.000000000000000,  0.000000000000000,  0.012282160685461,  0.028493099846858,
        0.000000000000000,  0.000000000000000,  -0.021615704846003, -0.020779343797742, 0.000000000000000,  0.000000000000000,  -0.012464921167539,
        -0.025729454021895, 0.319546388973308,  0.295147539046072,  -0.060244462604288, -0.079804646725415, 0.000000000000000,  0.000000000000000,
        0.039559555226533,  -0.015027600364078, 0.000000000000000,  0.000000000000000,  -0.007939439462281, 0.001043332281679,  0.000000000000000,
        0.000000000000000,  -0.045128142370136, -0.061291159958425, 0.000000000000000,  0.000000000000000,  -0.014622868447166, -0.016244704648551,
        0.172580648290961,  0.559016994374948,  -0.109035090189145, -0.156727807473988, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.002588585295565,  0.044271216110350,  0.000000000000000,  0.000000000000000,  0.067869454363588,  0.076214779094915,
        0.383096209630728,  0.433547999366957,  -0.097907066671158, -0.114612618053868, 0.000000000000000,  0.000000000000000,  0.034697197754810,
        -0.023741527805022, 0.110590349877913,  0.125154527070568,  0.026051490212889,  -0.008791151009495, 0.000000000000000,  0.000000000000000,
        -0.034115579082457, 0.041595501005576,  0.000000000000000,  0.000000000000000,  0.094394105153355,  0.137308880893697,  0.341445582462981,
        0.500000000000000,  -0.120885266414828, -0.143730738452674, 0.000000000000000,  0.000000000000000,  0.005149443674536,  -0.044103892390416,
        0.098566849474305,  0.144337567297407,  0.027574368779543,  -0.007399815449500, 0.028655557554124,  0.062836697466347,  -0.000000000000000,
        -0.000000000000000, 0.033415142965426,  0.039557978964281,  0.000000000000000,  0.000000000000000,  -0.080037362406821, -0.106148137664583,
        0.350045530820002,  0.323317929855341,  -0.008134137620150, -0.007730598581017, 0.000000000000000,  0.000000000000000,  -0.084399056229474,
        -0.095694313571127, 0.101049440723777,  0.093333846917907,  -0.003226164399478, 0.036804758589442,  -0.000000000000000, 0.000000000000000,
        0.068468949598783,  0.073140398906137,  0.000000000000000,  0.000000000000000,  -0.102942839223846, -0.148578775600311, 0.189052628115649,
        0.612372435695795,  -0.010940356492174, -0.023074783073786, 0.000000000000000,  0.000000000000000,  -0.108619595558608, -0.143090799528565,
        0.054574792866788,  0.176776695296637,  0.000000000000000,  0.000000000000000,  0.026771906701546,  0.024220074763698,  -0.270889927676751,
        -0.306564730322236, 0.081875443913329,  0.052432457637724,  0.000000000000000,  0.000000000000000,  -0.036335925101255, 0.031557060493137,
        0.000000000000000,  0.000000000000000,  -0.022714152091196, -0.016525884844302, 0.000000000000000,  0.000000000000000,  0.012638172157546,
        -0.037694862205021, 0.000000000000000,  0.000000000000000,  0.018361994366393,  0.028254726227799,  -0.241438486765764, -0.353553390593274,
        0.113982836774451,  0.081116910984228,  0.000000000000000,  0.000000000000000,  0.026530441707522,  0.086996744374151,  0.000000000000000,
        0.000000000000000,  -0.021984162289296, -0.022028764334982, 0.000000000000000,  0.000000000000000,  0.044744670000459,  -0.030807926948184,
        -0.100653027886866, -0.070742882060452, 0.000000000000000,  0.000000000000000,  0.044588466920682,  0.070646539526535,  -0.247519568566868,
        -0.228620300679908, 0.052572677461181,  0.025819920150124,  0.000000000000000,  0.000000000000000,  -0.039864218272068, -0.020165489994974,
        -0.000000000000000, -0.000000000000000, 0.046707592151828,  0.010542390127466,  0.000000000000000,  0.000000000000000,  -0.102152064943163,
        -0.106337664664579, 0.000000000000000,  0.000000000000000,  0.165856865682910,  0.202169166058286,  -0.133680395341714, -0.433012701892220,
        0.064624380428881,  0.051020062481679,  0.000000000000000,  0.000000000000000,  0.003200552912402,  0.013894096221697,  -0.000000000000000,
        0.000000000000000,  0.106550846493751,  0.089750031202722,  0.000000000000000,  0.000000000000000,  -0.110590349877913, -0.125154527070568,
        0.001298167061973,  -0.006825093170774, 0.000000000000000,  0.000000000000000,  0.016593470106859,  0.026276832362628,  0.000000000000000,
        0.000000000000000,  0.004332016320252,  -0.011500781591872, 0.000000000000000,  0.000000000000000,  0.015457773885510,  0.048580963464654,
        0.000000000000000,  0.000000000000000,  -0.011845097700562, -0.001179206610712, -0.098566849474305, -0.144337567297406, 0.015100738198167,
        -0.003529699083989, 0.000000000000000,  0.000000000000000,  0.028369359688199,  0.051223184523391,  0.000000000000000,  0.000000000000000,
        0.009400222540491,  -0.006991904262828, 0.000000000000000,  0.000000000000000,  0.042987889692563,  0.090666767315406,  0.000000000000000,
        0.000000000000000,  -0.011858450983342, -0.002667476757848, 0.075954846519273,  0.073092444345419,  -0.101049440723777, -0.093333846917907,
        -0.026609720423649, 0.009595363395219,  0.000000000000000,  0.000000000000000,  0.011368119570698,  0.002049843970351,  0.000000000000000,
        0.000000000000000,  0.014946609253483,  0.001836527021392,  0.000000000000000,  0.000000000000000,  0.102459074820359,  0.082230144894991,
        -0.000000000000000, -0.000000000000000, 0.135504265428660,  0.154634244786847,  -0.054574792866788, -0.176776695296637, 0.063143008462639,
        0.093676565481151,  0.000000000000000,  0.000000000000000,  0.023630979197563,  0.011647585510911,  0.000000000000000,  0.000000000000000,
        -0.014584005187887, -0.034098313525743, 0.000000000000000,  0.000000000000000,  0.092059636914316,  0.108046994253721,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.069098998209460,  0.072983481340227,  -0.349717392849129, -0.395773365024196,
        0.089505552221540,  0.037092130979298,  0.000000000000000,  0.000000000000000,  -0.022800040699514, 0.016969912059642,  0.000000000000000,
        0.000000000000000,  -0.096360298788948, -0.018736186497565, 0.000000000000000,  0.000000000000000,  0.010901692436221,  -0.029769252470731,
        0.000000000000000,  0.000000000000000,  0.111431450879051,  0.127967718938810,  -0.311695746125775, -0.456435464587639, 0.098516408042891,
        0.033286569839946,  0.000000000000000,  0.000000000000000,  0.025715620893427,  0.051413119391338,  0.000000000000000,  0.000000000000000,
        -0.073049827839013, -0.014323013711259, 0.000000000000000,  0.000000000000000,  0.078797156383784,  0.005447143786397,  0.070879706451149,
        0.069034926527997,  0.000000000000000,  0.000000000000000,  -0.015278607726598, 0.001929984963764,  -0.319546388973308, -0.295147539046072,
        0.004045357762571,  0.009023344028372,  0.000000000000000,  0.000000000000000,  0.009427484142442,  0.004969726717475,  0.000000000000000,
        0.000000000000000,  -0.005244461273120, -0.055916100931547, 0.000000000000000,  0.000000000000000,  0.144392869639624,  0.178741460279178,
        0.000000000000000,  0.000000000000000,  0.015748283965603,  0.014253093242117,  -0.172580648290960, -0.559016994374948, 0.082508283312172,
        0.101680531077244,  0.000000000000000,  0.000000000000000,  0.000909451773964,  0.000648704009334,  0.000000000000000,  0.000000000000000,
        0.049584024817359,  -0.006671361416122, 0.000000000000000,  0.000000000000000,  -0.428314583328408, -0.484721399046776, -0.050514114795110,
        -0.113550807532050, 0.000000000000000,  0.000000000000000,  0.069066720721394,  0.068124234306965,  0.000000000000000,  0.000000000000000,
        -0.090281738601905, -0.078280289719574, 0.000000000000000,  0.000000000000000,  0.064180631773928,  0.106977350027730,  0.000000000000000,
        0.000000000000000,  0.051947063877900,  0.036805282575518,  -0.381747766502117, -0.559016994374947, -0.096204268614242, -0.212591098866112,
        0.000000000000000,  0.000000000000000,  0.095271606392427,  0.109129293518273,  0.000000000000000,  0.000000000000000,  -0.071190977002884,
        -0.098766069406873, 0.000000000000000,  0.000000000000000,  0.075822155806173,  0.154432780645807,  0.000000000000000,  0.000000000000000,
        0.084379622675429,  0.073650384901297,  0.009920204204062,  -0.000357374116112, -0.391362801066761, -0.361480434750525, 0.001085073941404,
        0.009147542188201,  0.000000000000000,  0.000000000000000,  -0.034062080271289, -0.047976477083789, 0.000000000000000,  0.000000000000000,
        0.050970569730267,  0.073607447677931,  0.000000000000000,  0.000000000000000,  0.008375260951688,  -0.003040242055882, 0.000000000000000,
        0.000000000000000,  -0.044400011555245, -0.088203836060573, -0.211367263895789, -0.684653196881458, 0.036986191108780,  0.054500761704762,
        0.000000000000000,  0.000000000000000,  -0.007350176584432, -0.031251791421107, 0.000000000000000,  0.000000000000000,  0.060720894223727,
        0.108867282712130,  0.000000000000000,  0.000000000000000,  0.038902549844270,  0.031274138414480,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 28, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.033889028923174,  0.026927210986033,  -0.000000000000000, 0.000000000000000,  0.027668858983598,
        0.002892954859968,  0.000000000000000,  0.000000000000000,  0.007607621849803,  0.001428261919794,  0.000000000000000,  0.000000000000000,
        -0.054745517139400, -0.006283416961270, 0.000000000000000,  0.000000000000000,  0.046542917460035,  0.039779997608418,  0.000000000000000,
        0.000000000000000,  0.063930361497651,  0.058035226589931,  0.000000000000000,  0.000000000000000,  0.025132564815980,  0.003010166798867,
        0.000000000000000,  0.000000000000000,  0.007415107732999,  0.002437222482853,  0.000000000000000,  0.000000000000000,  -0.052297053318898,
        -0.006627592628694, 0.000000000000000,  0.000000000000000,  0.092139180648820,  0.086077857027304,  -0.029121301295625, -0.045753951230965,
        0.000000000000000,  0.000000000000000,  -0.054080228961070, -0.046694292603362, 0.000000000000000,  -0.000000000000000, -0.015117153222680,
        -0.011511614361631, 0.000000000000000,  0.000000000000000,  0.107152576469177,  0.097364160399153,  0.000000000000000,  0.000000000000000,
        -0.039813377887351, -0.065989542712814, 0.000000000000000,  0.000000000000000,  -0.039329886854620, -0.071078346126067, 0.000000000000000,
        0.000000000000000,  -0.049055255889632, -0.060720819222487, 0.000000000000000,  0.000000000000000,  -0.009181675512608, -0.010790874628349,
        0.000000000000000,  0.000000000000000,  0.106492645778591,  0.133691214067829,  0.000000000000000,  0.000000000000000,  -0.058078688651285,
        -0.105423413934568, 0.000000000000000,  0.000000000000000,  0.349717392849129,  0.395773365024196,  0.036035595710260,  0.111043460305939,
        0.000000000000000,  0.000000000000000,  -0.013460473989023, -0.028010390343535, 0.000000000000000,  0.000000000000000,  0.095030822676441,
        0.072451431733071,  0.000000000000000,  0.000000000000000,  -0.070827969376338, -0.058043707339079, 0.000000000000000,  0.000000000000000,
        -0.022020462720450, -0.006513761677270, 0.311695746125774,  0.456435464587639,  0.096114476559794,  0.218457833113781,  0.000000000000000,
        0.000000000000000,  -0.016158280390237, -0.027099955958703, 0.000000000000000,  0.000000000000000,  0.077969129524232,  0.100612895863706,
        0.000000000000000,  0.000000000000000,  -0.042684209085417, -0.052576564922324, 0.000000000000000,  0.000000000000000,  -0.018453625918425,
        -0.008723733381261, -0.012464921167539, -0.025729454021895, 0.319546388973308,  0.295147539046072,  0.011717097353754,  0.011544580013150,
        0.000000000000000,  0.000000000000000,  -0.064070963355430, -0.006451862578827, 0.000000000000000,  0.000000000000000,  0.065614974495384,
        0.030288212951924,  0.000000000000000,  0.000000000000000,  0.009427484142442,  0.004969726717475,  0.000000000000000,  0.000000000000000,
        -0.014622868447166, -0.016244704648551, 0.172580648290961,  0.559016994374948,  0.043567790506796,  0.033190532075359,  0.000000000000000,
        0.000000000000000,  -0.000960876690783, 0.033021938853826,  0.000000000000000,  0.000000000000000,  0.090867822112636,  0.064392878244004,
        0.000000000000000,  0.000000000000000,  0.000909451773964,  0.000648704009334,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.021681062879008, -0.067178568191674, 0.442361399511652,  0.500618108282272,  0.024672681852346,  0.022341516002631,
        0.000000000000000,  0.000000000000000,  0.012559776253471,  0.029166756818484,  0.000000000000000,  0.000000000000000,  0.037051461463630,
        -0.005566530666812, 0.000000000000000,  0.000000000000000,  0.176742838824972,  0.155872731970853,  0.000000000000000,  0.000000000000000,
        -0.059798445500027, -0.110690330666589, 0.394267397897221,  0.577350269189626,  0.065001558198047,  0.105091991114946,  0.000000000000000,
        0.000000000000000,  0.012384700125678,  0.059954396196306,  0.000000000000000,  0.000000000000000,  -0.025391757936668, -0.034334441875705,
        0.000000000000000,  0.000000000000000,  0.217276635079181,  0.240689024580532,  -0.008134137620150, -0.007730598581017, -0.000000000000000,
        -0.000000000000000, -0.052061084173319, -0.074514675860320, 0.404197762895107,  0.373335387671627,  0.057628131423609,  0.071645007346407,
        0.000000000000000,  0.000000000000000,  -0.026282107893707, 0.005943357354391,  0.000000000000000,  0.000000000000000,  -0.023090953958596,
        -0.005866254489267, 0.000000000000000,  0.000000000000000,  -0.010940356492174, -0.023074783073786, -0.000000000000000, 0.000000000000000,
        -0.007102497977072, -0.044292999437727, 0.218299171467152,  0.707106781186548,  0.095262944782364,  0.110315246039345,  0.000000000000000,
        0.000000000000000,  -0.045254385650164, -0.038186970435298, 0.000000000000000,  0.000000000000000,  0.014036046322775,  0.033944155200263,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.215358408457195,  0.124166492189048,  0.000000000000000,
        0.000000000000000,  -0.009510970220050, -0.054045976071978, 0.469195117994791,  0.530985688726764,  -0.121529535596327, -0.046880062717687,
        0.000000000000000,  0.000000000000000,  -0.006340646813367, -0.036030650714652, 0.000000000000000,  0.000000000000000,  -0.089732670190498,
        -0.051736038412103, 0.000000000000000,  0.000000000000000,  0.222831706070880,  0.181184168833881,  0.000000000000000,  0.000000000000000,
        -0.112170918121862, -0.135284449866983, 0.418183725980849,  0.612372435695795,  -0.027466106490964, 0.030847978213563,  0.000000000000000,
        0.000000000000000,  -0.074780612081241, -0.090189633244656, 0.000000000000000,  0.000000000000000,  -0.092846544196200, -0.075493403680784,
        -0.039864218272068, -0.020165489994974, -0.000000000000000, 0.000000000000000,  -0.026419393469068, 0.001581571839406,  -0.000000000000000,
        0.000000000000000,  0.039363172647581,  -0.045448986134118, 0.428716468625343,  0.395981976419274,  -0.017612928979378, 0.001054381226271,
        -0.000000000000000, -0.000000000000000, 0.016610090946695,  0.008402287497906,  0.000000000000000,  0.000000000000000,  0.003200552912402,
        0.013894096221697,  0.000000000000000,  0.000000000000000,  -0.111940655966480, -0.107228367934332, 0.000000000000000,  0.000000000000000,
        0.058452078042002,  0.000867978997355,  0.231541236707742,  0.750000000000001,  -0.074627103977653, -0.071485578622888, -0.000000000000000,
        0.000000000000000,  -0.001333563713501, -0.005789206759040, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.143461013169635, -0.143156221274697, 0.000000000000000,  0.000000000000000,  0.037051461463630,  -0.005566530666812, 0.000000000000000,
        0.000000000000000,  0.008373184168980,  0.019444504545656,  0.442361399511652,  0.500618108282272,  -0.006203536034012, 0.026980291558307,
        0.000000000000000,  0.000000000000000,  -0.191788171784063, -0.132174067305360, 0.000000000000000,  0.000000000000000,  -0.187835335041687,
        -0.223461287215767, 0.000000000000000,  0.000000000000000,  -0.025391757936668, -0.034334441875705, 0.000000000000000,  0.000000000000000,
        0.008256466750452,  0.039969597464204,  0.394267397897221,  0.577350269189626,  0.086161356478603,  0.133704026011367,  0.000000000000000,
        0.000000000000000,  -0.210276201247219, -0.198743210530943, 0.014946609253483,  0.001836527021392,  -0.000000000000000, 0.000000000000000,
        -0.026282107893707, 0.005943357354391,  0.000000000000000,  0.000000000000000,  0.038418754282406,  0.047763338230938,  0.000000000000000,
        0.000000000000000,  -0.030159327595230, -0.079467473655646, 0.404197762895107,  0.373335387671627,  0.033492513094869,  0.012865786254790,
        -0.000000000000000, -0.000000000000000, -0.014584005187887, -0.034098313525743, 0.000000000000000,  0.000000000000000,  -0.045254385650164,
        -0.038186970435298, 0.000000000000000,  0.000000000000000,  0.063508629854909,  0.073543497359563,  0.000000000000000,  0.000000000000000,
        0.030609490064732,  -0.012470524074979, 0.218299171467152,  0.707106781186548,  -0.008139677848267, -0.022286862743552, -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.022020462720450, -0.006513761677270, 0.000000000000000,  0.000000000000000,
        0.086019146894179,  0.062852143886212,  0.000000000000000,  0.000000000000000,  -0.039596176115184, -0.030188096555446, 0.000000000000000,
        0.000000000000000,  -0.091104270191321, -0.052586843806660, 0.349717392849129,  0.395773365024196,  -0.007638322018633, 0.098124499646020,
        0.000000000000000,  0.000000000000000,  -0.018453625918425, -0.008723733381261, 0.000000000000000,  0.000000000000000,  0.048218245635436,
        0.056154554217606,  0.000000000000000,  0.000000000000000,  -0.032487137301763, -0.041922039943211, 0.000000000000000,  0.000000000000000,
        -0.044443356090332, -0.045387456801250, 0.311695746125774,  0.456435464587638,  0.059514785154917,  0.201155761907613,  0.009427484142442,
        0.004969726717475,  0.000000000000000,  0.000000000000000,  -0.080026773034810, -0.034179615831584, -0.000000000000000, 0.000000000000000,
        0.026696234731429,  0.002688276074511,  0.000000000000000,  0.000000000000000,  0.085377400999709,  0.031433972509189,  0.000000000000000,
        0.000000000000000,  0.006232922381638,  -0.015872829365569, 0.319546388973308,  0.295147539046072,  0.000909451773964,  0.000648704009334,
        0.000000000000000,  0.000000000000000,  -0.098522663018369, -0.068775002283293, 0.000000000000000,  0.000000000000000,  0.000400365287826,
        -0.013759141189094, 0.000000000000000,  0.000000000000000,  0.082692532913874,  0.055588054942839,  0.000000000000000,  0.000000000000000,
        -0.012819122428804, -0.014958108363372, 0.172580648290960,  0.559016994374948,  0.000000000000000,  0.000000000000000,  -0.058917331358884,
        -0.041541634641111, 0.000000000000000,  0.000000000000000,  0.037847336818769,  0.005327366667569,  0.000000000000000,  0.000000000000000,
        -0.038883400565658, -0.007300005367837, 0.000000000000000,  0.000000000000000,  0.010911496832306,  0.001944871652048,  0.000000000000000,
        0.000000000000000,  0.036417803622772,  0.027287210513652,  0.000000000000000,  0.000000000000000,  -0.102972745256555, -0.088889764109347,
        0.000000000000000,  0.000000000000000,  0.040672267464618,  0.005762653949582,  0.000000000000000,  0.000000000000000,  -0.037899439524217,
        -0.012456914912358, 0.000000000000000,  -0.000000000000000, 0.013604652177152,  0.002152435942081,  0.000000000000000,  0.000000000000000,
        0.066144255772599,  0.058609854167836,  0.050970569730267,  0.073607447677931,  -0.000000000000000, 0.000000000000000,  -0.074341021342523,
        -0.076056708444203, -0.000000000000000, 0.000000000000000,  0.077265449804808,  0.058837140070557,  0.000000000000000,  0.000000000000000,
        -0.021542103460472, -0.025564402748036, 0.000000000000000,  0.000000000000000,  -0.031401330449454, -0.047310709029532, 0.000000000000000,
        0.000000000000000,  0.060720894223727,  0.108867282712130,  0.000000000000000,  0.000000000000000,  -0.090202836566234, -0.116243747305306,
        0.000000000000000,  0.000000000000000,  0.046928563731105,  0.055153359211562,  0.000000000000000,  0.000000000000000,  -0.032901195087378,
        -0.043418748016319, -0.000000000000000, 0.000000000000000,  -0.039869835062054, -0.071782118305066, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 28, 20));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeFFForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix dipxmat(28, 28);

    CDenseMatrix dipymat(28, 28);

    CDenseMatrix dipzmat(28, 28);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.000161527803857, -0.032614612769394, 0.000000000000000,  0.000000000000000,  -0.005809487540165,
        -0.115452340276530, 0.000000000000000,  0.000000000000000,  -0.022939299048370, 0.028760849242849,  0.000000000000000,  0.000000000000000,
        -0.048313528266056, -0.085001362897224, 0.000000000000000,  0.000000000000000,  0.090826107961006,  0.108611220148788,  0.000000000000000,
        0.000000000000000,  -0.066814459366973, -0.038858190700924, 0.000000000000000,  0.000000000000000,  0.068351012804658,  0.164671107211796,
        0.000000000000000,  0.000000000000000,  0.023117148570796,  -0.014207408978516, 0.000000000000000,  0.000000000000000,  -0.025125392518843,
        -0.180948661918344, 0.000000000000000,  0.000000000000000,  -0.017741624810560, 0.032447669563607,  0.000000000000000,  0.000000000000000,
        -0.013909547198090, -0.087412740371411, 0.000000000000000,  0.000000000000000,  0.077535858688125,  0.136168911607355,  0.000000000000000,
        0.000000000000000,  -0.096483202861164, -0.078267225199580, 0.000000000000000,  0.000000000000000,  0.106268307524813,  0.273192089149776,
        -0.000161527803857, 0.023117148570796,  0.400000000000000,  0.211190387423613,  -0.019801169703594, 0.013172321465613,  0.000000000000000,
        0.000000000000000,  -0.022683101119741, -0.039344469660135, -0.000000000000000, 0.000000000000000,  0.058537940377572,  0.083006484493012,
        0.000000000000000,  0.000000000000000,  -0.023027981824802, -0.046330373933994, -0.000000000000000, 0.000000000000000,  0.008450728039317,
        -0.016063434873304, 0.000000000000000,  0.000000000000000,  -0.068804259673652, -0.109643746031427, -0.000000000000000, 0.000000000000000,
        -0.032614612769394, -0.014207408978516, 0.211190387423613,  0.400000000000000,  0.011043333470351,  0.060779003262012,  0.000000000000000,
        0.000000000000000,  -0.006558624386132, -0.023529614103129, -0.000000000000000, -0.000000000000000, -0.003246248140532, 0.023180053881886,
        0.000000000000000,  0.000000000000000,  -0.012006083101545, -0.034729180971825, 0.000000000000000,  0.000000000000000,  0.038496513413023,
        0.030936647481618,  0.000000000000000,  0.000000000000000,  -0.161619156131161, -0.271317643404548, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.019801169703594, 0.011043333470351,  0.000000000000000,  0.000000000000000,  -0.010003455614860,
        0.003459674717484,  0.000000000000000,  0.000000000000000,  -0.028187241449673, -0.098921492175630, 0.000000000000000,  0.000000000000000,
        0.000756493173888,  0.050036361838060,  0.000000000000000,  0.000000000000000,  0.049374930351889,  0.019664400445828,  0.000000000000000,
        0.000000000000000,  -0.091848158411465, -0.043686175037626, 0.000000000000000,  0.000000000000000,  -0.011473558059783, -0.034259186449975,
        0.000000000000000,  0.000000000000000,  0.013172321465613,  0.060779003262012,  0.000000000000000,  0.000000000000000,  -0.024589850566350,
        -0.002330529741681, 0.000000000000000,  0.000000000000000,  -0.038072347580497, -0.172031135029517, 0.000000000000000,  0.000000000000000,
        0.033923264162173,  0.080462322132418,  0.000000000000000,  0.000000000000000,  0.051890118652665,  0.030234497481458,  0.000000000000000,
        0.000000000000000,  -0.079759818002528, -0.033736766016556, 0.000000000000000,  0.000000000000000,  0.006608591311588,  -0.029729425328300,
        -0.005809487540165, -0.025125392518843, 0.000000000000000,  0.000000000000000,  -0.010003455614860, -0.024589850566350, 0.400000000000000,
        0.211190387423613,  0.020258041388754,  0.039807518155734,  0.000000000000000,  0.000000000000000,  -0.044974877038687, -0.041362957196056,
        -0.000000000000000, 0.000000000000000,  -0.020349069633184, -0.018549388658147, 0.000000000000000,  0.000000000000000,  0.104904859718981,
        0.089020152733068,  0.000000000000000,  0.000000000000000,  0.078539738864601,  0.097545604221531,  0.000000000000000,  0.000000000000000,
        -0.115452340276530, -0.180948661918344, 0.000000000000000,  0.000000000000000,  0.003459674717484,  -0.002330529741681, 0.211190387423613,
        0.400000000000000,  0.063407047837391,  0.126742839192310,  0.000000000000000,  0.000000000000000,  -0.039942090086067, -0.053949579771047,
        0.000000000000000,  0.000000000000000,  -0.045392276558024, -0.060473008731826, 0.000000000000000,  0.000000000000000,  0.042776157188644,
        0.033747425311128,  0.000000000000000,  0.000000000000000,  0.049728622415196,  0.087373461651718,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.022683101119741, -0.006558624386132, 0.000000000000000,  0.000000000000000,  0.020258041388754,
        0.063407047837391,  0.000000000000000,  0.000000000000000,  -0.036186415950184, -0.025658825410663, 0.000000000000000,  0.000000000000000,
        0.016250771929515,  0.030270309134736,  0.000000000000000,  0.000000000000000,  -0.050445173144933, -0.043713373390231, 0.000000000000000,
        0.000000000000000,  0.005941093316439,  -0.001510212364806, 0.000000000000000,  0.000000000000000,  0.044275749839369,  0.010958731319875,
        0.000000000000000,  0.000000000000000,  -0.039344469660135, -0.023529614103129, 0.000000000000000,  0.000000000000000,  0.039807518155734,
        0.126742839192310,  0.000000000000000,  0.000000000000000,  -0.044121707507338, -0.038735835261735, 0.000000000000000,  0.000000000000000,
        0.017711539481129,  0.038715761062594,  0.000000000000000,  0.000000000000000,  -0.061822565896318, -0.059339757316493, 0.000000000000000,
        0.000000000000000,  0.002586426653234,  -0.001745499991401, 0.000000000000000,  0.000000000000000,  0.066794581437186,  0.037404309641370,
        -0.022939299048370, -0.017741624810560, -0.000000000000000, -0.000000000000000, -0.028187241449673, -0.038072347580497, 0.000000000000000,
        0.000000000000000,  -0.036186415950184, -0.044121707507338, 0.400000000000000,  0.211190387423613,  0.003665049975127,  -0.018009937587876,
        0.000000000000000,  0.000000000000000,  0.043401693351597,  0.051499004675988,  0.000000000000000,  0.000000000000000,  -0.032861353546572,
        -0.004366983455261, 0.000000000000000,  0.000000000000000,  -0.079923411411115, -0.064448979797591, 0.000000000000000,  0.000000000000000,
        0.028760849242849,  0.032447669563607,  0.000000000000000,  -0.000000000000000, -0.098921492175630, -0.172031135029517, 0.000000000000000,
        0.000000000000000,  -0.025658825410663, -0.038735835261735, 0.211190387423613,  0.400000000000000,  -0.018893699786511, -0.036917300848616,
        0.000000000000000,  0.000000000000000,  0.049792441475650,  0.054817569301314,  0.000000000000000,  0.000000000000000,  0.014735646592282,
        0.030835779643387,  0.000000000000000,  0.000000000000000,  -0.114311367775234, -0.139034551896811, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.058537940377572,  -0.003246248140532, 0.000000000000000,  0.000000000000000,  -0.044974877038687,
        -0.039942090086067, 0.000000000000000,  0.000000000000000,  0.003665049975127,  -0.018893699786511, 0.000000000000000,  0.000000000000000,
        -0.007544354739931, -0.030562493766225, 0.000000000000000,  0.000000000000000,  -0.043160982505046, 0.096058019726738,  0.000000000000000,
        0.000000000000000,  -0.022155066666998, -0.033397985870648, 0.000000000000000,  0.000000000000000,  -0.003240115867985, 0.003095327845932,
        0.000000000000000,  0.000000000000000,  0.083006484493012,  0.023180053881886,  0.000000000000000,  0.000000000000000,  -0.041362957196056,
        -0.053949579771047, 0.000000000000000,  0.000000000000000,  -0.018009937587876, -0.036917300848616, 0.000000000000000,  0.000000000000000,
        -0.033248667233991, -0.046683960408973, 0.000000000000000,  0.000000000000000,  -0.003655896279764, 0.190851195632242,  0.000000000000000,
        0.000000000000000,  -0.022254870089128, -0.044224298915548, 0.000000000000000,  0.000000000000000,  -0.013811090177162, -0.004013903517103,
        -0.048313528266056, -0.013909547198090, 0.000000000000000,  0.000000000000000,  0.000756493173888,  0.033923264162173,  -0.000000000000000,
        0.000000000000000,  0.016250771929515,  0.017711539481129,  0.000000000000000,  0.000000000000000,  -0.007544354739931, -0.033248667233991,
        0.400000000000000,  0.211190387423613,  0.052806852312775,  -0.007698245644233, 0.000000000000000,  0.000000000000000,  0.049657986680490,
        0.050742356263523,  0.000000000000000,  -0.000000000000000, 0.057369899152234,  0.038043750258923,  0.000000000000000,  0.000000000000000,
        -0.085001362897224, -0.087412740371411, 0.000000000000000,  0.000000000000000,  0.050036361838060,  0.080462322132418,  0.000000000000000,
        0.000000000000000,  0.030270309134736,  0.038715761062594,  0.000000000000000,  0.000000000000000,  -0.030562493766225, -0.046683960408973,
        0.211190387423613,  0.400000000000000,  -0.087203542318617, -0.194188999077078, 0.000000000000000,  0.000000000000000,  0.034335329849092,
        0.050352918229910,  -0.000000000000000, 0.000000000000000,  0.044395948687451,  0.050683385572442,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.023027981824802, -0.012006083101545, 0.000000000000000,  0.000000000000000,  -0.020349069633184,
        -0.045392276558024, 0.000000000000000,  0.000000000000000,  0.043401693351597,  0.049792441475650,  0.000000000000000,  0.000000000000000,
        0.052806852312775,  -0.087203542318617, 0.000000000000000,  0.000000000000000,  -0.034235687793147, -0.030663014495729, 0.000000000000000,
        0.000000000000000,  0.042995444362035,  0.078695986727699,  0.000000000000000,  0.000000000000000,  -0.054285667016465, 0.007212920772372,
        0.000000000000000,  0.000000000000000,  -0.046330373933994, -0.034729180971825, 0.000000000000000,  0.000000000000000,  -0.018549388658147,
        -0.060473008731826, 0.000000000000000,  0.000000000000000,  0.051499004675988,  0.054817569301314,  0.000000000000000,  0.000000000000000,
        -0.007698245644233, -0.194188999077078, 0.000000000000000,  0.000000000000000,  -0.043446756355431, -0.043893034939930, 0.000000000000000,
        0.000000000000000,  0.053743854064389,  0.147750726184541,  0.000000000000000,  0.000000000000000,  -0.085518810052440, -0.021354887114210,
        0.090826107961006,  0.077535858688125,  -0.000000000000000, 0.000000000000000,  0.049374930351889,  0.051890118652665,  0.000000000000000,
        0.000000000000000,  -0.050445173144933, -0.061822565896318, 0.000000000000000,  0.000000000000000,  -0.043160982505046, -0.003655896279764,
        0.000000000000000,  0.000000000000000,  -0.034235687793147, -0.043446756355431, 0.400000000000000,  0.211190387423613,  -0.002245249191877,
        -0.039115391608016, 0.000000000000000,  0.000000000000000,  0.019032509433466,  -0.011448242856554, -0.000000000000000, 0.000000000000000,
        0.108611220148788,  0.136168911607355,  0.000000000000000,  0.000000000000000,  0.019664400445828,  0.030234497481458,  0.000000000000000,
        0.000000000000000,  -0.043713373390231, -0.059339757316493, 0.000000000000000,  0.000000000000000,  0.096058019726738,  0.190851195632242,
        0.000000000000000,  0.000000000000000,  -0.030663014495729, -0.043893034939930, 0.211190387423613,  0.400000000000000,  -0.110272620242816,
        -0.193776617323311, 0.000000000000000,  0.000000000000000,  0.075623180149856,  0.074028466498643,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.008450728039317,  0.038496513413023,  0.000000000000000,  0.000000000000000,  0.104904859718981,
        0.042776157188644,  0.000000000000000,  0.000000000000000,  -0.032861353546572, 0.014735646592282,  0.000000000000000,  0.000000000000000,
        0.049657986680490,  0.034335329849092,  0.000000000000000,  0.000000000000000,  -0.002245249191877, -0.110272620242816, 0.000000000000000,
        0.000000000000000,  -0.004013252706399, 0.011702960360045,  0.000000000000000,  0.000000000000000,  -0.031171375262579, 0.014206658836923,
        0.000000000000000,  0.000000000000000,  -0.016063434873304, 0.030936647481618,  0.000000000000000,  0.000000000000000,  0.089020152733068,
        0.033747425311128,  0.000000000000000,  0.000000000000000,  -0.004366983455261, 0.030835779643387,  0.000000000000000,  0.000000000000000,
        0.050742356263523,  0.050352918229910,  0.000000000000000,  0.000000000000000,  -0.039115391608016, -0.193776617323311, 0.000000000000000,
        0.000000000000000,  -0.036268214926309, 0.000390511810389,  0.000000000000000,  0.000000000000000,  -0.001533461014709, 0.060532301247431,
        -0.066814459366973, -0.096483202861164, 0.000000000000000,  0.000000000000000,  -0.091848158411465, -0.079759818002528, 0.000000000000000,
        0.000000000000000,  0.005941093316439,  0.002586426653234,  0.000000000000000,  0.000000000000000,  -0.022155066666998, -0.022254870089128,
        0.000000000000000,  -0.000000000000000, 0.042995444362035,  0.053743854064389,  0.000000000000000,  0.000000000000000,  -0.004013252706399,
        -0.036268214926309, 0.400000000000000,  0.211190387423613,  -0.002554484493706, -0.029401573784764, 0.000000000000000,  0.000000000000000,
        -0.038858190700924, -0.078267225199580, 0.000000000000000,  0.000000000000000,  -0.043686175037626, -0.033736766016556, 0.000000000000000,
        0.000000000000000,  -0.001510212364806, -0.001745499991401, 0.000000000000000,  0.000000000000000,  -0.033397985870648, -0.044224298915548,
        -0.000000000000000, 0.000000000000000,  0.078695986727699,  0.147750726184541,  0.000000000000000,  0.000000000000000,  0.011702960360045,
        0.000390511810389,  0.211190387423613,  0.400000000000000,  -0.105711186031661, -0.173362174753260, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.068804259673652, -0.161619156131161, 0.000000000000000,  0.000000000000000,  0.078539738864601,
        0.049728622415196,  0.000000000000000,  0.000000000000000,  -0.079923411411115, -0.114311367775234, 0.000000000000000,  0.000000000000000,
        0.057369899152234,  0.044395948687451,  0.000000000000000,  0.000000000000000,  0.019032509433466,  0.075623180149856,  0.000000000000000,
        0.000000000000000,  -0.002554484493706, -0.105711186031661, 0.000000000000000,  0.000000000000000,  -0.001692846517471, -0.033439758878202,
        0.000000000000000,  0.000000000000000,  -0.109643746031427, -0.271317643404548, 0.000000000000000,  0.000000000000000,  0.097545604221531,
        0.087373461651718,  0.000000000000000,  0.000000000000000,  -0.064448979797591, -0.139034551896811, 0.000000000000000,  0.000000000000000,
        0.038043750258923,  0.050683385572442,  0.000000000000000,  0.000000000000000,  -0.011448242856554, 0.074028466498643,  0.000000000000000,
        0.000000000000000,  -0.029401573784764, -0.173362174753260, 0.000000000000000,  0.000000000000000,  0.022773182913443,  -0.014870513257328,
        0.068351012804658,  0.106268307524813,  -0.000000000000000, 0.000000000000000,  -0.011473558059783, 0.006608591311588,  0.000000000000000,
        0.000000000000000,  0.044275749839369,  0.066794581437186,  0.000000000000000,  0.000000000000000,  -0.003240115867985, -0.013811090177162,
        0.000000000000000,  0.000000000000000,  -0.054285667016465, -0.085518810052440, -0.000000000000000, 0.000000000000000,  -0.031171375262579,
        -0.001533461014709, 0.000000000000000,  0.000000000000000,  -0.001692846517471, 0.022773182913443,  0.400000000000000,  0.211190387423613,
        0.164671107211796,  0.273192089149776,  0.000000000000000,  0.000000000000000,  -0.034259186449975, -0.029729425328300, 0.000000000000000,
        0.000000000000000,  0.010958731319875,  0.037404309641370,  0.000000000000000,  0.000000000000000,  0.003095327845932,  -0.004013903517103,
        0.000000000000000,  0.000000000000000,  0.007212920772372,  -0.021354887114210, 0.000000000000000,  -0.000000000000000, 0.014206658836923,
        0.060532301247431,  0.000000000000000,  0.000000000000000,  -0.033439758878202, -0.014870513257328, 0.211190387423613,  0.400000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 28, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.000649328627720, -0.047894704896082, 0.000000000000000,  0.000000000000000,  -0.069241714880798,
        -0.039159313128653, 0.000000000000000,  0.000000000000000,  -0.079456018780376, -0.110269024560999, 0.000000000000000,  0.000000000000000,
        0.004926440896724,  0.031751369001226,  0.000000000000000,  0.000000000000000,  0.127255793204804,  0.115488969650778,  0.000000000000000,
        0.000000000000000,  -0.057153196352715, -0.141882280699091, 0.000000000000000,  0.000000000000000,  -0.045057972673335, -0.108999072556317,
        0.000000000000000,  0.000000000000000,  0.033346277798403,  -0.020704272440179, 0.000000000000000,  0.000000000000000,  -0.098028322375600,
        -0.078685809765303, 0.000000000000000,  0.000000000000000,  -0.057928533905167, -0.131198073410059, 0.000000000000000,  0.000000000000000,
        -0.007370741641352, 0.030599269126231,  0.000000000000000,  0.000000000000000,  0.101156068333991,  0.143259264065372,  0.000000000000000,
        0.000000000000000,  -0.106449424306084, -0.241350359985690, 0.000000000000000,  0.000000000000000,  -0.071234847103293, -0.181588860952131,
        -0.000649328627720, 0.033346277798403,  0.600000000000000,  0.316785581135419,  0.006023472525492,  -0.017608554387740, 0.000000000000000,
        0.000000000000000,  0.034139386564834,  0.063446519518075,  0.000000000000000,  -0.000000000000000, -0.033026298378017, -0.043068113353054,
        0.000000000000000,  0.000000000000000,  -0.022683101119741, -0.039344469660135, -0.000000000000000, -0.000000000000000, -0.016904051983807,
        -0.007182652828610, 0.000000000000000,  0.000000000000000,  0.046378875645538,  0.072706521934201,  -0.000000000000000, -0.000000000000000,
        -0.047894704896082, -0.020704272440179, 0.316785581135419,  0.600000000000000,  0.038195390985294,  0.030518062915895,  0.000000000000000,
        0.000000000000000,  0.006480023332134,  0.033619933559398,  0.000000000000000,  0.000000000000000,  0.000641076839646,  -0.011962895467102,
        0.000000000000000,  0.000000000000000,  -0.006558624386132, -0.023529614103129, -0.000000000000000, 0.000000000000000,  0.045261611244125,
        0.086838599207175,  0.000000000000000,  0.000000000000000,  0.108527769672322,  0.181417627417418,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.006023472525492,  0.038195390985294,  0.000000000000000,  0.000000000000000,  -0.018805470662067,
        0.010184898517447,  0.000000000000000,  0.000000000000000,  0.026068907208686,  0.017546844328413,  0.000000000000000,  0.000000000000000,
        -0.037306177292714, 0.032605455104564,  0.000000000000000,  0.000000000000000,  0.008908062815472,  -0.110318882620275, 0.000000000000000,
        0.000000000000000,  0.071608247178007,  0.033092022242897,  0.000000000000000,  0.000000000000000,  0.017464921233115,  -0.040618130948980,
        0.000000000000000,  0.000000000000000,  -0.017608554387740, 0.030518062915895,  0.000000000000000,  0.000000000000000,  -0.048279330042194,
        -0.002015337033121, 0.000000000000000,  0.000000000000000,  0.038570642459955,  0.027606947298104,  0.000000000000000,  0.000000000000000,
        0.000979473424469,  0.056171263363947,  0.000000000000000,  0.000000000000000,  -0.028883412954150, -0.196632805489275, 0.000000000000000,
        0.000000000000000,  0.051905641718707,  0.023970845346396,  0.000000000000000,  0.000000000000000,  0.000071841874562,  -0.085027765977199,
        -0.069241714880798, -0.098028322375600, 0.000000000000000,  0.000000000000000,  -0.018805470662067, -0.048279330042194, 0.600000000000000,
        0.316785581135419,  -0.032231256266062, -0.023722241964614, 0.000000000000000,  0.000000000000000,  -0.036004931891529, -0.031667946880635,
        -0.000000000000000, -0.000000000000000, 0.020258041388754,  0.039807518155734,  0.000000000000000,  0.000000000000000,  -0.059560431575624,
        -0.060614338771690, -0.000000000000000, -0.000000000000000, 0.072339274207467,  0.109768214566436,  0.000000000000000,  0.000000000000000,
        -0.039159313128653, -0.078685809765303, 0.000000000000000,  0.000000000000000,  0.010184898517447,  -0.002015337033121, 0.316785581135419,
        0.600000000000000,  -0.042371851828411, -0.056982008749023, 0.000000000000000,  0.000000000000000,  -0.021420424816401, -0.029614146205173,
        -0.000000000000000, 0.000000000000000,  0.063407047837391,  0.126742839192310,  0.000000000000000,  0.000000000000000,  -0.024549532574615,
        -0.021018615538727, -0.000000000000000, 0.000000000000000,  0.153103589872533,  0.250994382395330,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.034139386564834,  0.006480023332134,  0.000000000000000,  0.000000000000000,  -0.032231256266062,
        -0.042371851828411, 0.000000000000000,  0.000000000000000,  -0.055187982470063, -0.040769386469355, 0.000000000000000,  0.000000000000000,
        0.066349162254037,  -0.061978284706337, 0.000000000000000,  0.000000000000000,  0.026378161714169,  0.036678384499925,  0.000000000000000,
        0.000000000000000,  -0.021086975237349, -0.042127599900018, 0.000000000000000,  0.000000000000000,  -0.002505957210365, 0.021031384715726,
        0.000000000000000,  0.000000000000000,  0.063446519518075,  0.033619933559398,  0.000000000000000,  0.000000000000000,  -0.023722241964614,
        -0.056982008749023, 0.000000000000000,  0.000000000000000,  -0.069530129897835, -0.064603547986005, 0.000000000000000,  0.000000000000000,
        0.007061370590042,  -0.161925864858249, 0.000000000000000,  0.000000000000000,  0.031426006207533,  0.037369049150136,  0.000000000000000,
        0.000000000000000,  -0.036130674638238, -0.098811135567521, 0.000000000000000,  0.000000000000000,  -0.001963711821750, 0.027024373888840,
        -0.079456018780376, -0.057928533905167, 0.000000000000000,  0.000000000000000,  0.026068907208686,  0.038570642459955,  0.000000000000000,
        0.000000000000000,  -0.055187982470063, -0.069530129897835, 0.600000000000000,  0.316785581135419,  -0.040106774192440, -0.018664177602995,
        0.000000000000000,  0.000000000000000,  -0.036186415950184, -0.044121707507338, 0.000000000000000,  0.000000000000000,  -0.029189683125029,
        0.001423407811090,  0.000000000000000,  0.000000000000000,  -0.077146298578905, -0.088766972700788, 0.000000000000000,  0.000000000000000,
        -0.110269024560999, -0.131198073410059, -0.000000000000000, 0.000000000000000,  0.017546844328413,  0.027606947298104,  0.000000000000000,
        0.000000000000000,  -0.040769386469355, -0.064603547986005, 0.316785581135419,  0.600000000000000,  0.080313269904646,  0.160086778258396,
        0.000000000000000,  0.000000000000000,  -0.025658825410663, -0.038735835261735, 0.000000000000000,  0.000000000000000,  0.094767934920216,
        0.169676015331827,  0.000000000000000,  0.000000000000000,  -0.067149957598551, -0.099434972840376, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.033026298378017, 0.000641076839646,  0.000000000000000,  0.000000000000000,  -0.036004931891529,
        -0.021420424816401, 0.000000000000000,  0.000000000000000,  -0.040106774192440, 0.080313269904646,  0.000000000000000,  0.000000000000000,
        -0.011316532109897, -0.045843740649337, 0.000000000000000,  0.000000000000000,  0.003665049975127,  -0.018893699786511, 0.000000000000000,
        0.000000000000000,  0.042265120799104,  0.042285525944507,  0.000000000000000,  0.000000000000000,  -0.028501453812833, 0.005721123104854,
        0.000000000000000,  0.000000000000000,  -0.043068113353054, -0.011962895467102, 0.000000000000000,  0.000000000000000,  -0.031667946880635,
        -0.029614146205173, 0.000000000000000,  0.000000000000000,  -0.018664177602995, 0.160086778258396,  0.000000000000000,  0.000000000000000,
        -0.049873000850987, -0.070025940613459, 0.000000000000000,  0.000000000000000,  -0.018009937587876, -0.036917300848616, 0.000000000000000,
        0.000000000000000,  0.039521268258588,  0.056808087910034,  0.000000000000000,  0.000000000000000,  -0.053503603979506, -0.015164263680206,
        0.004926440896724,  -0.007370741641352, 0.000000000000000,  0.000000000000000,  -0.037306177292714, 0.000979473424469,  -0.000000000000000,
        -0.000000000000000, 0.066349162254037,  0.007061370590042,  0.000000000000000,  0.000000000000000,  -0.011316532109897, -0.049873000850987,
        0.600000000000000,  0.316785581135419,  0.016250771929515,  0.017711539481129,  0.000000000000000,  0.000000000000000,  -0.017771220907775,
        -0.043659480369814, 0.000000000000000,  0.000000000000000,  0.101197687851444,  0.059705673484081,  0.000000000000000,  0.000000000000000,
        0.031751369001226,  0.030599269126231,  0.000000000000000,  0.000000000000000,  0.032605455104564,  0.056171263363947,  -0.000000000000000,
        0.000000000000000,  -0.061978284706337, -0.161925864858249, 0.000000000000000,  0.000000000000000,  -0.045843740649337, -0.070025940613459,
        0.316785581135419,  0.600000000000000,  0.030270309134736,  0.038715761062594,  0.000000000000000,  0.000000000000000,  -0.050374815592424,
        -0.079323950258367, 0.000000000000000,  0.000000000000000,  0.097752199555602,  0.107665630905405,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.022683101119741, -0.006558624386132, 0.000000000000000,  0.000000000000000,  0.020258041388754,
        0.063407047837391,  0.000000000000000,  0.000000000000000,  -0.036186415950184, -0.025658825410663, 0.000000000000000,  0.000000000000000,
        0.016250771929515,  0.030270309134736,  0.000000000000000,  0.000000000000000,  -0.050445173144933, -0.043713373390231, 0.000000000000000,
        0.000000000000000,  0.005941093316439,  -0.001510212364806, 0.000000000000000,  0.000000000000000,  0.044275749839369,  0.010958731319875,
        0.000000000000000,  0.000000000000000,  -0.039344469660135, -0.023529614103129, 0.000000000000000,  0.000000000000000,  0.039807518155734,
        0.126742839192310,  0.000000000000000,  0.000000000000000,  -0.044121707507338, -0.038735835261735, 0.000000000000000,  0.000000000000000,
        0.017711539481129,  0.038715761062594,  0.000000000000000,  0.000000000000000,  -0.061822565896318, -0.059339757316493, 0.000000000000000,
        0.000000000000000,  0.002586426653234,  -0.001745499991401, 0.000000000000000,  0.000000000000000,  0.066794581437186,  0.037404309641370,
        0.127255793204804,  0.101156068333991,  -0.000000000000000, -0.000000000000000, 0.008908062815472,  -0.028883412954150, 0.000000000000000,
        0.000000000000000,  0.026378161714169,  0.031426006207533,  0.000000000000000,  0.000000000000000,  0.003665049975127,  -0.018009937587876,
        0.000000000000000,  0.000000000000000,  -0.050445173144933, -0.061822565896318, 0.600000000000000,  0.316785581135419,  0.056167376689776,
        0.017686459647971,  0.000000000000000,  0.000000000000000,  -0.050537415100711, -0.041186387660614, 0.000000000000000,  -0.000000000000000,
        0.115488969650778,  0.143259264065372,  -0.000000000000000, 0.000000000000000,  -0.110318882620275, -0.196632805489275, 0.000000000000000,
        0.000000000000000,  0.036678384499925,  0.037369049150136,  0.000000000000000,  0.000000000000000,  -0.018893699786511, -0.036917300848616,
        0.000000000000000,  0.000000000000000,  -0.043713373390231, -0.059339757316493, 0.316785581135419,  0.600000000000000,  -0.012618090474867,
        -0.028208229460032, 0.000000000000000,  0.000000000000000,  -0.097342822478030, -0.117354022537770, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.016904051983807, 0.045261611244125,  0.000000000000000,  0.000000000000000,  -0.059560431575624,
        -0.024549532574615, 0.000000000000000,  0.000000000000000,  -0.029189683125029, 0.094767934920216,  0.000000000000000,  0.000000000000000,
        -0.017771220907775, -0.050374815592424, 0.000000000000000,  0.000000000000000,  0.056167376689776,  -0.012618090474867, 0.000000000000000,
        0.000000000000000,  -0.002219591819821, 0.012559054098847,  0.000000000000000,  0.000000000000000,  0.013900813573608,  0.034560308877704,
        0.000000000000000,  0.000000000000000,  -0.007182652828610, 0.086838599207175,  0.000000000000000,  0.000000000000000,  -0.060614338771690,
        -0.021018615538727, 0.000000000000000,  0.000000000000000,  0.001423407811090,  0.169676015331827,  0.000000000000000,  0.000000000000000,
        -0.043659480369814, -0.079323950258367, 0.000000000000000,  0.000000000000000,  0.017686459647971,  -0.028208229460032, 0.000000000000000,
        0.000000000000000,  -0.043007768196795, -0.000894689863818, 0.000000000000000,  0.000000000000000,  -0.005063471797152, 0.030148009894023,
        -0.057153196352715, -0.106449424306084, 0.000000000000000,  0.000000000000000,  0.071608247178007,  0.051905641718707,  -0.000000000000000,
        -0.000000000000000, -0.021086975237349, -0.036130674638238, 0.000000000000000,  0.000000000000000,  0.042265120799104,  0.039521268258588,
        0.000000000000000,  0.000000000000000,  0.005941093316439,  0.002586426653234,  0.000000000000000,  0.000000000000000,  -0.002219591819821,
        -0.043007768196795, 0.600000000000000,  0.316785581135419,  -0.076112483350776, -0.096000484707095, 0.000000000000000,  0.000000000000000,
        -0.141882280699091, -0.241350359985690, 0.000000000000000,  0.000000000000000,  0.033092022242897,  0.023970845346396,  -0.000000000000000,
        0.000000000000000,  -0.042127599900018, -0.098811135567521, 0.000000000000000,  0.000000000000000,  0.042285525944507,  0.056808087910034,
        0.000000000000000,  0.000000000000000,  -0.001510212364806, -0.001745499991401, 0.000000000000000,  0.000000000000000,  0.012559054098847,
        -0.000894689863818, 0.316785581135419,  0.600000000000000,  -0.049427499987467, -0.086954877085995, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.046378875645538,  0.108527769672322,  0.000000000000000,  0.000000000000000,  0.072339274207467,
        0.153103589872533,  0.000000000000000,  0.000000000000000,  -0.077146298578905, -0.067149957598551, 0.000000000000000,  0.000000000000000,
        0.101197687851444,  0.097752199555602,  0.000000000000000,  0.000000000000000,  -0.050537415100711, -0.097342822478030, 0.000000000000000,
        0.000000000000000,  -0.076112483350776, -0.049427499987467, 0.000000000000000,  0.000000000000000,  -0.002132232854272, -0.051186852575311,
        0.000000000000000,  0.000000000000000,  0.072706521934201,  0.181417627417418,  0.000000000000000,  0.000000000000000,  0.109768214566436,
        0.250994382395330,  0.000000000000000,  0.000000000000000,  -0.088766972700788, -0.099434972840376, 0.000000000000000,  0.000000000000000,
        0.059705673484081,  0.107665630905405,  0.000000000000000,  0.000000000000000,  -0.041186387660614, -0.117354022537770, 0.000000000000000,
        0.000000000000000,  -0.096000484707095, -0.086954877085995, 0.000000000000000,  0.000000000000000,  0.035489219427955,  -0.022912610913588,
        -0.045057972673335, -0.071234847103293, -0.000000000000000, -0.000000000000000, 0.017464921233115,  0.000071841874562,  0.000000000000000,
        0.000000000000000,  -0.002505957210365, -0.001963711821750, 0.000000000000000,  0.000000000000000,  -0.028501453812833, -0.053503603979506,
        0.000000000000000,  0.000000000000000,  0.044275749839369,  0.066794581437186,  0.000000000000000,  0.000000000000000,  0.013900813573608,
        -0.005063471797152, 0.000000000000000,  0.000000000000000,  -0.002132232854272, 0.035489219427955,  0.600000000000000,  0.316785581135419,
        -0.108999072556317, -0.181588860952131, -0.000000000000000, 0.000000000000000,  -0.040618130948980, -0.085027765977199, 0.000000000000000,
        0.000000000000000,  0.021031384715726,  0.027024373888840,  0.000000000000000,  0.000000000000000,  0.005721123104854,  -0.015164263680206,
        0.000000000000000,  0.000000000000000,  0.010958731319875,  0.037404309641370,  -0.000000000000000, 0.000000000000000,  0.034560308877704,
        0.030148009894023,  0.000000000000000,  0.000000000000000,  -0.051186852575311, -0.022912610913588, 0.316785581135419,  0.600000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 28, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.014984844004978, 0.022986397424347,  0.000000000000000,  0.000000000000000,  -0.028399338023536,
        -0.008609898416300, 0.000000000000000,  0.000000000000000,  -0.023424031369696, -0.001695682648866, 0.000000000000000,  0.000000000000000,
        -0.006946233510068, -0.000138173166620, 0.000000000000000,  0.000000000000000,  0.043087466421372,  0.002876643999723,  0.000000000000000,
        0.000000000000000,  -0.038402998219704, -0.012707593910318, 0.000000000000000,  0.000000000000000,  0.000990922914038,  0.000122932716341,
        0.000000000000000,  0.000000000000000,  0.002445271981501,  0.060264633850420,  0.000000000000000,  0.000000000000000,  -0.034784464637614,
        -0.009532248644519, 0.000000000000000,  0.000000000000000,  -0.014961867008173, -0.000961473590420, 0.000000000000000,  0.000000000000000,
        -0.003974793622356, 0.000464738371493,  0.000000000000000,  0.000000000000000,  0.028404519147560,  0.000827220455769,  0.000000000000000,
        0.000000000000000,  -0.050119657190248, -0.014138232659437, 0.000000000000000,  0.000000000000000,  0.000630792400331,  0.000170886433371,
        -0.014984844004978, 0.002445271981501,  1.100000000000000,  0.580773565414936,  -0.064365192185720, -0.092576234079885, 0.000000000000000,
        0.000000000000000,  -0.085478324441130, -0.073310861657368, -0.000000000000000, -0.000000000000000, -0.025099818866983, -0.019745693303646,
        -0.000000000000000, 0.000000000000000,  0.166273805065963,  0.150083442643308,  -0.000000000000000, 0.000000000000000,  -0.087726236023214,
        -0.133508720900819, 0.000000000000000,  0.000000000000000,  0.000990922914038,  0.000630792400331,  -0.000000000000000, 0.000000000000000,
        0.022986397424347,  0.060264633850420,  0.580773565414936,  1.100000000000000,  -0.096801800204591, -0.156998966536211, 0.000000000000000,
        0.000000000000000,  -0.052533536543673, -0.070506828785856, -0.000000000000000, 0.000000000000000,  -0.012898055535464, -0.016535097033342,
        0.000000000000000,  0.000000000000000,  0.113308896474522,  0.153947733121926,  0.000000000000000,  0.000000000000000,  -0.142915063738963,
        -0.232860891375981, 0.000000000000000,  0.000000000000000,  0.000122932716341,  0.000170886433371,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.064365192185720, -0.096801800204591, 0.000000000000000,  0.000000000000000,  -0.015825371716796,
        -0.064200903629227, 0.000000000000000,  0.000000000000000,  -0.024020875046139, 0.018162969203867,  0.000000000000000,  0.000000000000000,
        -0.065861821061116, -0.064051682999737, 0.000000000000000,  0.000000000000000,  0.006806302886069,  0.057003666663516,  0.000000000000000,
        0.000000000000000,  0.015087546929896,  0.004084498259754,  0.000000000000000,  0.000000000000000,  0.113168104122024,  0.149512740217469,
        0.000000000000000,  0.000000000000000,  -0.092576234079885, -0.156998966536211, 0.000000000000000,  0.000000000000000,  -0.019663914045291,
        -0.064111989646143, 0.000000000000000,  0.000000000000000,  -0.026268579705789, 0.019514561706851,  0.000000000000000,  0.000000000000000,
        -0.017075529179242, -0.058245624218023, 0.000000000000000,  0.000000000000000,  -0.025047828346254, 0.061426062226316,  0.000000000000000,
        0.000000000000000,  0.003793896320831,  0.002560200731845,  0.000000000000000,  0.000000000000000,  0.148954668923756,  0.240467762785237,
        -0.028399338023536, -0.034784464637614, 0.000000000000000,  0.000000000000000,  -0.015825371716796, -0.019663914045291, 1.100000000000000,
        0.580773565414935,  -0.009837252364795, -0.020610593923744, 0.000000000000000,  0.000000000000000,  -0.049942002111736, 0.028108962390171,
        -0.000000000000000, 0.000000000000000,  0.025969587295214,  -0.036901242656804, 0.000000000000000,  0.000000000000000,  0.015087546929896,
        0.003793896320831,  0.000000000000000,  0.000000000000000,  0.050504530890783,  0.056052279124573,  -0.000000000000000, 0.000000000000000,
        -0.008609898416300, -0.009532248644519, 0.000000000000000,  0.000000000000000,  -0.064200903629227, -0.064111989646143, 0.580773565414935,
        1.100000000000000,  -0.008182665624418, -0.042991089257199, 0.000000000000000,  0.000000000000000,  -0.001863584161346, 0.037423472602756,
        0.000000000000000,  0.000000000000000,  -0.014098958311992, -0.081976105340627, 0.000000000000000,  0.000000000000000,  0.004084498259754,
        0.002560200731845,  0.000000000000000,  0.000000000000000,  0.013305325636582,  0.014600086589305,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.085478324441130, -0.052533536543673, 0.000000000000000,  0.000000000000000,  -0.009837252364795,
        -0.008182665624418, 0.000000000000000,  0.000000000000000,  -0.096656132542703, -0.109523343317195, 0.000000000000000,  0.000000000000000,
        0.001575158840146,  0.046470239118448,  0.000000000000000,  0.000000000000000,  -0.001762298335235, 0.004763176096267,  0.000000000000000,
        0.000000000000000,  -0.038187227047937, 0.014646446274602,  0.000000000000000,  0.000000000000000,  -0.109934423047485, -0.094799343966849,
        0.000000000000000,  0.000000000000000,  -0.073310861657368, -0.070506828785856, 0.000000000000000,  0.000000000000000,  -0.020610593923744,
        -0.042991089257199, 0.000000000000000,  0.000000000000000,  -0.108165984069164, -0.148155522654592, 0.000000000000000,  0.000000000000000,
        0.000505685897719,  0.081116456530068,  0.000000000000000,  0.000000000000000,  0.009965575993613,  0.001977515143274,  0.000000000000000,
        0.000000000000000,  0.038696848188161,  0.087222946777076,  0.000000000000000,  0.000000000000000,  -0.112601376941313, -0.131819246217391,
        -0.023424031369696, -0.014961867008173, -0.000000000000000, -0.000000000000000, -0.024020875046139, -0.026268579705789, 0.000000000000000,
        0.000000000000000,  -0.096656132542703, -0.108165984069164, 1.100000000000000,  0.580773565414936,  0.064218659430729,  0.027527431119013,
        0.000000000000000,  0.000000000000000,  -0.001762298335235, 0.009965575993613,  0.000000000000000,  0.000000000000000,  -0.019657587522652,
        0.020741315982525,  -0.000000000000000, 0.000000000000000,  -0.024058178209924, -0.017529212376464, 0.000000000000000,  0.000000000000000,
        -0.001695682648866, -0.000961473590420, -0.000000000000000, 0.000000000000000,  0.018162969203867,  0.019514561706851,  0.000000000000000,
        0.000000000000000,  -0.109523343317195, -0.148155522654592, 0.580773565414936,  1.100000000000000,  -0.013265514697998, -0.067023871747662,
        0.000000000000000,  0.000000000000000,  0.004763176096267,  0.001977515143274,  0.000000000000000,  0.000000000000000,  -0.065931430520830,
        -0.071072328126128, 0.000000000000000,  0.000000000000000,  -0.001147666669931, 0.001318165285156,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.025099818866983, -0.012898055535464, 0.000000000000000,  0.000000000000000,  -0.049942002111736,
        -0.001863584161346, 0.000000000000000,  0.000000000000000,  0.064218659430729,  -0.013265514697998, 0.000000000000000,  0.000000000000000,
        -0.029641917363568, -0.080935831538971, 0.000000000000000,  0.000000000000000,  0.042812439620486,  -0.008843676465332, 0.000000000000000,
        0.000000000000000,  0.020809167546556,  0.000776493400561,  0.000000000000000,  0.000000000000000,  0.128287963097911,  0.065923394959039,
        0.000000000000000,  0.000000000000000,  -0.019745693303646, -0.016535097033342, 0.000000000000000,  0.000000000000000,  0.028108962390171,
        0.037423472602756,  0.000000000000000,  0.000000000000000,  0.027527431119013,  -0.067023871747662, 0.000000000000000,  0.000000000000000,
        -0.118758407006583, -0.139493679657522, 0.000000000000000,  0.000000000000000,  0.018351620746009,  -0.044682581165108, 0.000000000000000,
        0.000000000000000,  -0.011712067662571, -0.015593113584482, 0.000000000000000,  0.000000000000000,  0.100922432440857,  0.084512718170414,
        -0.006946233510068, -0.003974793622356, -0.000000000000000, 0.000000000000000,  -0.065861821061116, -0.017075529179242, -0.000000000000000,
        0.000000000000000,  0.001575158840146,  0.000505685897719,  0.000000000000000,  0.000000000000000,  -0.029641917363568, -0.118758407006583,
        1.100000000000000,  0.580773565414935,  0.001050105893430,  0.000337123931813,  0.000000000000000,  0.000000000000000,  0.027442425442132,
        0.007114803824684,  0.000000000000000,  0.000000000000000,  0.035502971273680,  0.020315611847597,  0.000000000000000,  -0.000000000000000,
        -0.000138173166620, 0.000464738371493,  0.000000000000000,  0.000000000000000,  -0.064051682999737, -0.058245624218023, 0.000000000000000,
        0.000000000000000,  0.046470239118448,  0.081116456530068,  0.000000000000000,  0.000000000000000,  -0.080935831538971, -0.139493679657522,
        0.580773565414935,  1.100000000000000,  0.030980159412299,  0.054077637686712,  0.000000000000000,  0.000000000000000,  0.026688201249891,
        0.024269010090843,  0.000000000000000,  0.000000000000000,  0.000706218407170,  -0.002375329454299, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.166273805065963,  0.113308896474522,  0.000000000000000,  0.000000000000000,  0.025969587295214,
        -0.014098958311992, 0.000000000000000,  0.000000000000000,  -0.001762298335235, 0.004763176096267,  0.000000000000000,  0.000000000000000,
        0.001050105893430,  0.030980159412299,  0.000000000000000,  0.000000000000000,  -0.095187550596675, -0.113492656730752, 0.000000000000000,
        0.000000000000000,  0.052608461926896,  -0.010980937433312, 0.000000000000000,  0.000000000000000,  -0.029608437272806, -0.034178230306898,
        0.000000000000000,  0.000000000000000,  0.150083442643308,  0.153947733121926,  0.000000000000000,  0.000000000000000,  -0.036901242656804,
        -0.081976105340627, 0.000000000000000,  0.000000000000000,  0.009965575993613,  0.001977515143274,  0.000000000000000,  0.000000000000000,
        0.000337123931813,  0.054077637686712,  0.000000000000000,  0.000000000000000,  -0.116470630730509, -0.149803451940654, 0.000000000000000,
        0.000000000000000,  -0.029788133306232, -0.069808278821270, 0.000000000000000,  0.000000000000000,  -0.036141146502890, -0.048562745938859,
        0.043087466421372,  0.028404519147560,  -0.000000000000000, 0.000000000000000,  0.006806302886069,  -0.025047828346254, 0.000000000000000,
        0.000000000000000,  -0.001762298335235, 0.009965575993613,  0.000000000000000,  0.000000000000000,  0.042812439620486,  0.018351620746009,
        0.000000000000000,  0.000000000000000,  -0.095187550596675, -0.116470630730509, 1.100000000000000,  0.580773565414936,  0.041663468651953,
        -0.004257516513397, 0.000000000000000,  0.000000000000000,  -0.004553320560010, -0.004177187793503, 0.000000000000000,  0.000000000000000,
        0.002876643999723,  0.000827220455769,  0.000000000000000,  0.000000000000000,  0.057003666663516,  0.061426062226316,  0.000000000000000,
        0.000000000000000,  0.004763176096267,  0.001977515143274,  0.000000000000000,  0.000000000000000,  -0.008843676465332, -0.044682581165108,
        0.000000000000000,  0.000000000000000,  -0.113492656730752, -0.149803451940654, 0.580773565414936,  1.100000000000000,  0.063793762252364,
        0.068817698528112,  0.000000000000000,  0.000000000000000,  0.000018886536511,  0.001166033935998,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.087726236023214, -0.142915063738963, 0.000000000000000,  0.000000000000000,  0.015087546929896,
        0.004084498259754,  0.000000000000000,  0.000000000000000,  -0.019657587522652, -0.065931430520830, 0.000000000000000,  0.000000000000000,
        0.027442425442132,  0.026688201249891,  0.000000000000000,  0.000000000000000,  0.041663468651953,  0.063793762252364,  0.000000000000000,
        0.000000000000000,  0.014098263027497,  -0.056099982080714, 0.000000000000000,  0.000000000000000,  -0.069564367911105, -0.098150069099697,
        0.000000000000000,  0.000000000000000,  -0.133508720900819, -0.232860891375981, 0.000000000000000,  0.000000000000000,  0.003793896320831,
        0.002560200731845,  0.000000000000000,  0.000000000000000,  0.020741315982525,  -0.071072328126128, 0.000000000000000,  0.000000000000000,
        0.007114803824684,  0.024269010090843,  0.000000000000000,  0.000000000000000,  -0.004257516513397, 0.068817698528112,  0.000000000000000,
        0.000000000000000,  -0.012139353008978, -0.059034258194651, 0.000000000000000,  0.000000000000000,  -0.095732692469832, -0.158553469571268,
        -0.038402998219704, -0.050119657190248, 0.000000000000000,  0.000000000000000,  0.015087546929896,  0.003793896320831,  0.000000000000000,
        0.000000000000000,  -0.038187227047937, 0.038696848188161,  -0.000000000000000, 0.000000000000000,  0.020809167546556,  -0.011712067662571,
        0.000000000000000,  0.000000000000000,  0.052608461926896,  -0.029788133306232, 0.000000000000000,  0.000000000000000,  0.014098263027497,
        -0.012139353008978, 1.100000000000000,  0.580773565414935,  -0.030872348050122, -0.035996826238933, 0.000000000000000,  0.000000000000000,
        -0.012707593910318, -0.014138232659437, 0.000000000000000,  0.000000000000000,  0.004084498259754,  0.002560200731845,  0.000000000000000,
        0.000000000000000,  0.014646446274602,  0.087222946777076,  0.000000000000000,  0.000000000000000,  0.000776493400561,  -0.015593113584482,
        0.000000000000000,  0.000000000000000,  -0.010980937433312, -0.069808278821270, 0.000000000000000,  0.000000000000000,  -0.056099982080714,
        -0.059034258194651, 0.580773565414935,  1.100000000000000,  -0.008732047948300, -0.009626630854643, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000990922914038,  0.000122932716341,  0.000000000000000,  0.000000000000000,  0.050504530890783,
        0.013305325636582,  0.000000000000000,  0.000000000000000,  -0.024058178209924, -0.001147666669931, 0.000000000000000,  0.000000000000000,
        0.035502971273680,  0.000706218407170,  0.000000000000000,  0.000000000000000,  -0.004553320560010, 0.000018886536511,  0.000000000000000,
        0.000000000000000,  -0.030872348050122, -0.008732047948300, 0.000000000000000,  0.000000000000000,  -0.019855684898861, 0.022382126705136,
        0.000000000000000,  0.000000000000000,  0.000630792400331,  0.000170886433371,  0.000000000000000,  0.000000000000000,  0.056052279124573,
        0.014600086589305,  0.000000000000000,  0.000000000000000,  -0.017529212376464, 0.001318165285156,  0.000000000000000,  0.000000000000000,
        0.020315611847597,  -0.002375329454299, 0.000000000000000,  0.000000000000000,  -0.004177187793503, 0.001166033935998,  0.000000000000000,
        0.000000000000000,  -0.035996826238933, -0.009626630854643, 0.000000000000000,  0.000000000000000,  -0.000655362160222, 0.059424648604260,
        0.000990922914038,  0.000630792400331,  -0.000000000000000, 0.000000000000000,  0.113168104122024,  0.148954668923756,  -0.000000000000000,
        0.000000000000000,  -0.109934423047485, -0.112601376941313, 0.000000000000000,  0.000000000000000,  0.128287963097911,  0.100922432440857,
        0.000000000000000,  0.000000000000000,  -0.029608437272806, -0.036141146502890, 0.000000000000000,  0.000000000000000,  -0.069564367911105,
        -0.095732692469832, 0.000000000000000,  0.000000000000000,  -0.019855684898861, -0.000655362160222, 1.100000000000000,  0.580773565414936,
        0.000122932716341,  0.000170886433371,  0.000000000000000,  0.000000000000000,  0.149512740217469,  0.240467762785237,  0.000000000000000,
        0.000000000000000,  -0.094799343966849, -0.131819246217391, 0.000000000000000,  0.000000000000000,  0.065923394959039,  0.084512718170414,
        -0.000000000000000, 0.000000000000000,  -0.034178230306898, -0.048562745938859, 0.000000000000000,  -0.000000000000000, -0.098150069099697,
        -0.158553469571268, 0.000000000000000,  0.000000000000000,  0.022382126705136,  0.059424648604260,  0.580773565414936,  1.100000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 28, 28));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputePGForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix dipxmat(12, 36);

    CDenseMatrix dipymat(12, 36);

    CDenseMatrix dipzmat(12, 36);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.012549849316162, -0.021735041801415, 0.000000000000000,  0.000000000000000,  0.025791255340496,
        0.058542448357313,  -0.000000000000000, 0.000000000000000,  0.005727552422318,  0.041807589078880,  0.000000000000000,  0.000000000000000,
        0.006552384822864,  -0.017248450513036, 0.000000000000000,  0.000000000000000,  0.069212231030992,  0.060269084162198,  0.000000000000000,
        0.000000000000000,  -0.032838526042972, -0.052748677971717, 0.000000000000000,  0.000000000000000,  -0.010819281574071, -0.005096769772686,
        0.000000000000000,  0.000000000000000,  -0.045473599018814, -0.090460432742581, 0.000000000000000,  0.000000000000000,  -0.027851051891632,
        -0.051279371335269, 0.000000000000000,  0.000000000000000,  -0.013542488351674, -0.031463638786189, 0.000000000000000,  0.000000000000000,
        0.033064907497730,  0.087052839884896,  0.000000000000000,  0.000000000000000,  0.016572394742929,  0.067853525512369,  0.000000000000000,
        0.000000000000000,  -0.004824760225012, -0.028347701515674, 0.000000000000000,  0.000000000000000,  0.053530613612242,  0.075691507866634,
        0.000000000000000,  0.000000000000000,  -0.035127647627111, -0.074125194433173, 0.000000000000000,  0.000000000000000,  -0.006121311288860,
        -0.005616612801565, 0.000000000000000,  0.000000000000000,  -0.053132545116054, -0.133334646164020, 0.000000000000000,  0.000000000000000,
        -0.031320270868423, -0.074591693787768, -0.033588697289634, -0.043466391180414, 0.000000000000000,  0.000000000000000,  -0.004796767614797,
        0.005050777570060,  0.000000000000000,  0.000000000000000,  0.014660751924133,  0.047199533070540,  -0.000000000000000, 0.000000000000000,
        -0.020156787510554, -0.024137309742574, 0.000000000000000,  0.000000000000000,  0.002088985368466,  -0.019430597126578, -0.000000000000000,
        0.000000000000000,  -0.095692442415097, -0.109817142094990, 0.000000000000000,  0.000000000000000,  -0.085073607526038, -0.104147110267610,
        0.000000000000000,  0.000000000000000,  -0.099183629952830, -0.138100546712491, 0.000000000000000,  0.000000000000000,  -0.032169139456332,
        -0.045012825913713, -0.000000000000000, 0.000000000000000,  -0.021291897791894, -0.036645660490322, 0.000000000000000,  -0.000000000000000,
        0.030578382512432,  0.055017534308877,  0.000000000000000,  0.000000000000000,  0.038580829716037,  0.073363011433118,  0.000000000000000,
        -0.000000000000000, -0.012969111942629, -0.023274198875454, 0.000000000000000,  0.000000000000000,  0.017089257502024,  0.021511634434910,
        0.000000000000000,  0.000000000000000,  -0.048953068757623, -0.081301561205336, 0.000000000000000,  0.000000000000000,  -0.028477375898469,
        -0.047603708437928, 0.000000000000000,  0.000000000000000,  -0.079782212061918, -0.139614050860213, 0.000000000000000,  0.000000000000000,
        -0.035897880279136, -0.062338941073201, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.007908454370385,
        -0.004999246653099, 0.000000000000000,  0.000000000000000,  -0.045307684667727, -0.015105534174407, 0.000000000000000,  0.000000000000000,
        -0.005511523030441, 0.044112366126972,  0.000000000000000,  0.000000000000000,  0.001530784077619,  -0.020658427782136, 0.000000000000000,
        0.000000000000000,  -0.014300722651710, -0.046038326396107, 0.000000000000000,  0.000000000000000,  0.035368484704848,  0.085711313181164,
        0.000000000000000,  0.000000000000000,  -0.017371772765119, 0.034521384727216,  0.000000000000000,  0.000000000000000,  0.008684602905926,
        0.004630140278386,  0.000000000000000,  0.000000000000000,  0.022398329848444,  0.018523024821268,  0.000000000000000,  0.000000000000000,
        -0.005179378400482, -0.005882525405037, 0.000000000000000,  0.000000000000000,  -0.026110813618039, -0.009941388943041, 0.000000000000000,
        0.000000000000000,  0.011181549229433,  0.076639299642095,  0.000000000000000,  0.000000000000000,  -0.009481498541111, -0.030875788565890,
        0.000000000000000,  0.000000000000000,  -0.022954806945284, -0.070802928695721, 0.000000000000000,  0.000000000000000,  0.045850963461458,
        0.130053452238339,  0.000000000000000,  0.000000000000000,  0.006105832600814,  0.060117955268509,  0.000000000000000,  0.000000000000000,
        0.006849050536638,  0.003228653913122,  0.000000000000000,  0.000000000000000,  0.017084419151904,  0.022749095416339,  -0.001444262789026,
        -0.000617434646936, 0.000000000000000,  0.000000000000000,  -0.054763858134156, -0.040133552349784, 0.000000000000000,  0.000000000000000,
        -0.021259904157613, 0.023771549237847,  0.000000000000000,  0.000000000000000,  0.045643955883113,  0.068613112673571,  0.000000000000000,
        0.000000000000000,  0.040417647678394,  0.032991786451751,  0.000000000000000,  0.000000000000000,  0.070235317298284,  0.117078923607353,
        0.000000000000000,  0.000000000000000,  -0.011115142715380, 0.004153394349170,  0.000000000000000,  0.000000000000000,  0.036306105587421,
        0.028566155182817,  0.000000000000000,  0.000000000000000,  0.031968502294682,  0.030156558648046,  0.000000000000000,  0.000000000000000,
        -0.002256053682597, -0.003171448502792, 0.000000000000000,  0.000000000000000,  -0.010158658117612, -0.008381942384493, 0.000000000000000,
        0.000000000000000,  0.039444753923539,  0.080336452567001,  0.000000000000000,  0.000000000000000,  0.012062635076716,  0.022020046457396,
        0.000000000000000,  0.000000000000000,  -0.016988930629477, -0.033520263978658, 0.000000000000000,  0.000000000000000,  0.076438109702882,
        0.137674880593713,  0.000000000000000,  0.000000000000000,  0.020443578252413,  0.041685802243880,  0.000000000000000,  0.000000000000000,
        0.004676251754286,  0.003989772206626,  0.000000000000000,  0.000000000000000,  0.013609370180988,  0.020192575226134,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.034379661325479,  0.053702325449564,  0.000000000000000,  0.000000000000000,
        0.029890850765058,  0.085881097426965,  0.000000000000000,  0.000000000000000,  -0.039191785939121, -0.000303190277443, 0.000000000000000,
        0.000000000000000,  0.037265135761050,  0.046022875432719,  -0.000000000000000, -0.000000000000000, -0.023935839661652, -0.068628900670067,
        0.000000000000000,  0.000000000000000,  -0.064452854379016, -0.068317389356117, -0.000000000000000, -0.000000000000000, -0.003908812547484,
        0.029701670906701,  0.000000000000000,  0.000000000000000,  0.054460635065744,  0.062067829974130,  -0.000000000000000, -0.000000000000000,
        -0.002880719019685, -0.018086285646460, 0.000000000000000,  0.000000000000000,  0.037605297607898,  0.080603428108284,  0.000000000000000,
        0.000000000000000,  0.042399803787825,  0.124975757806125,  0.000000000000000,  0.000000000000000,  -0.047629617907177, -0.042617766200583,
        0.000000000000000,  0.000000000000000,  0.005336441223111,  0.011409589084078,  -0.000000000000000, -0.000000000000000, -0.030759984937542,
        -0.094140374029222, 0.000000000000000,  0.000000000000000,  -0.073029110462971, -0.124937751491818, 0.000000000000000,  -0.000000000000000,
        0.021726921777654,  0.072131057372188,  0.000000000000000,  0.000000000000000,  0.061367982111413,  0.109080034118665,  -0.000000000000000,
        0.000000000000000,  -0.005645607679398, -0.024204871905464, 0.044774261978662,  0.055017039934741,  0.000000000000000,  0.000000000000000,
        0.103993814507278,  0.147176635477567,  0.000000000000000,  0.000000000000000,  0.030439655457776,  0.075313961818343,  0.000000000000000,
        0.000000000000000,  -0.003796115610017, 0.001989981157460,  0.000000000000000,  0.000000000000000,  -0.079911979644462, -0.114887563106855,
        -0.000000000000000, -0.000000000000000, -0.040654779057220, -0.029815777697303, 0.000000000000000,  0.000000000000000,  0.071329013415392,
        0.098657962686821,  0.000000000000000,  0.000000000000000,  0.040159575446238,  0.035031622401589,  0.000000000000000,  0.000000000000000,
        -0.025447171425658, -0.038332047795855, -0.000000000000000, 0.000000000000000,  0.041786884292628,  0.070654730587916,  0.000000000000000,
        0.000000000000000,  0.076070151977499,  0.135150577716764,  0.000000000000000,  0.000000000000000,  -0.019127849672053, -0.020089976386618,
        0.000000000000000,  0.000000000000000,  -0.021379311354824, -0.034742322343850, 0.000000000000000,  0.000000000000000,  -0.055478585095465,
        -0.099344083420279, -0.000000000000000, -0.000000000000000, -0.063195147315120, -0.100343896228070, 0.000000000000000,  0.000000000000000,
        0.060277961541116,  0.106067846750218,  -0.000000000000000, -0.000000000000000, 0.055429819401854,  0.089096324016639,  0.000000000000000,
        0.000000000000000,  -0.015820417613337, -0.029105237550030, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 12, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.019469987236083, -0.048133975798716, 0.000000000000000,  0.000000000000000,  -0.040278555186325,
        -0.086936609887185, 0.000000000000000,  0.000000000000000,  -0.017553222790980, 0.009890349267929,  0.000000000000000,  0.000000000000000,
        -0.054012178291256, -0.075600081832013, -0.000000000000000, -0.000000000000000, 0.033741019530841,  -0.018404663868235, 0.000000000000000,
        0.000000000000000,  0.053288159358880,  0.048599251756588,  0.000000000000000,  0.000000000000000,  0.027552566185026,  -0.033696320486070,
        0.000000000000000,  0.000000000000000,  -0.001367923579271, -0.056672988510786, -0.000000000000000, 0.000000000000000,  0.017666145825002,
        0.023608232383551,  0.000000000000000,  0.000000000000000,  -0.024070304707456, -0.067827868205276, 0.000000000000000,  0.000000000000000,
        -0.053042185059325, -0.133257813275786, 0.000000000000000,  0.000000000000000,  -0.035386995329456, -0.031384540597452, 0.000000000000000,
        0.000000000000000,  -0.081653158404865, -0.155802985078065, -0.000000000000000, -0.000000000000000, 0.013848859739326,  -0.031064117473694,
        0.000000000000000,  0.000000000000000,  0.022151299008469,  0.028675487495826,  0.000000000000000,  0.000000000000000,  0.012863333737609,
        -0.041296762873007, 0.000000000000000,  0.000000000000000,  -0.006973588945966, -0.066749528384843, -0.000000000000000, 0.000000000000000,
        0.019067808972337,  0.036873968809280,  -0.052587349683479, -0.074887557685073, -0.000000000000000, 0.000000000000000,  -0.096033213687787,
        -0.127685489505496, 0.000000000000000,  0.000000000000000,  0.006365727791871,  0.047305949205975,  -0.000000000000000, 0.000000000000000,
        -0.087421234241644, -0.082919612317277, 0.000000000000000,  0.000000000000000,  -0.078171158504074, -0.131079727379003, -0.000000000000000,
        -0.000000000000000, -0.020156787510554, -0.024137309742574, 0.000000000000000,  0.000000000000000,  -0.086664589769412, -0.149749592280286,
        0.000000000000000,  0.000000000000000,  -0.080847090745858, -0.134653035147726, 0.000000000000000,  0.000000000000000,  0.017699192785047,
        0.018627117693442,  -0.000000000000000, 0.000000000000000,  -0.039372977504828, -0.069883422445758, 0.000000000000000,  0.000000000000000,
        -0.077883361746925, -0.135149135560660, 0.000000000000000,  0.000000000000000,  -0.020449710858345, -0.023284627255403, 0.000000000000000,
        0.000000000000000,  -0.092867077531799, -0.150684820311436, 0.000000000000000,  0.000000000000000,  -0.041237537177112, -0.081417721391188,
        -0.000000000000000, -0.000000000000000, -0.012969111942629, -0.023274198875454, 0.000000000000000,  0.000000000000000,  -0.043787311320116,
        -0.087995095232709, 0.000000000000000,  0.000000000000000,  -0.046162302802564, -0.089103695036728, 0.000000000000000,  0.000000000000000,
        0.018214208511238,  0.029870118124337,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.020897125194142,
        0.017937568064824,  -0.000000000000000, -0.000000000000000, 0.023040085576178,  0.006973288716489,  0.000000000000000,  0.000000000000000,
        0.006862131373161,  0.025475058974981,  0.000000000000000,  0.000000000000000,  0.036644138102864,  0.068495956696050,  0.000000000000000,
        0.000000000000000,  -0.021451083977565, -0.069057489594161, 0.000000000000000,  0.000000000000000,  0.001530784077619,  -0.020658427782136,
        0.000000000000000,  0.000000000000000,  0.010252939057496,  -0.045882299426322, 0.000000000000000,  0.000000000000000,  0.030831567689322,
        0.012742695413294,  0.000000000000000,  0.000000000000000,  0.000562395529251,  0.002134347607224,  0.000000000000000,  0.000000000000000,
        0.016302445297047,  0.022139610830849,  -0.000000000000000, 0.000000000000000,  0.012525076114955,  0.004515250198301,  0.000000000000000,
        0.000000000000000,  0.008491699654602,  0.044150490396951,  0.000000000000000,  0.000000000000000,  0.037949714677198,  0.104323628433431,
        0.000000000000000,  0.000000000000000,  -0.034432210417926, -0.106204393043581, 0.000000000000000,  0.000000000000000,  -0.009481498541111,
        -0.030875788565890, 0.000000000000000,  0.000000000000000,  -0.010714749153692, -0.079763368856095, 0.000000000000000,  0.000000000000000,
        0.020387090345786,  0.008643980924373,  0.000000000000000,  0.000000000000000,  0.001352834209095,  0.002900047556369,  0.034016462600216,
        0.032405599624905,  0.000000000000000,  0.000000000000000,  0.017311408162357,  0.011886662132579,  -0.000000000000000, 0.000000000000000,
        -0.016525674609969, 0.024843318832458,  0.000000000000000,  0.000000000000000,  0.108271947200879,  0.174256517501996,  0.000000000000000,
        0.000000000000000,  0.060626471517591,  0.049487679677626,  0.000000000000000,  0.000000000000000,  0.045643955883113,  0.068613112673571,
        0.000000000000000,  0.000000000000000,  0.020201321830411,  -0.019723520534595, 0.000000000000000,  0.000000000000000,  0.073918174865313,
        0.056953209207167,  -0.000000000000000, 0.000000000000000,  0.011465839038237,  0.011622987623859,  0.000000000000000,  0.000000000000000,
        0.013782493773158,  0.020524336612922,  0.000000000000000,  0.000000000000000,  0.004051709421800,  0.003289437894704,  -0.000000000000000,
        0.000000000000000,  0.030798752125908,  0.062689814122196,  0.000000000000000,  0.000000000000000,  0.086490305600145,  0.156024919308209,
        0.000000000000000,  0.000000000000000,  -0.025483395944215, -0.050280395967986, 0.000000000000000,  0.000000000000000,  0.012062635076716,
        0.022020046457396,  0.000000000000000,  0.000000000000000,  -0.037418741643942, -0.076226971982113, 0.000000000000000,  0.000000000000000,
        0.010788448704994,  0.009088161858700,  0.000000000000000,  0.000000000000000,  0.003103224047562,  0.004794903813545,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.012549849316162, -0.021735041801415, 0.000000000000000,  0.000000000000000,
        0.025791255340496,  0.058542448357313,  -0.000000000000000, 0.000000000000000,  0.005727552422318,  0.041807589078880,  0.000000000000000,
        0.000000000000000,  0.006552384822864,  -0.017248450513036, 0.000000000000000,  0.000000000000000,  0.069212231030992,  0.060269084162198,
        0.000000000000000,  0.000000000000000,  -0.032838526042972, -0.052748677971717, 0.000000000000000,  0.000000000000000,  -0.010819281574071,
        -0.005096769772686, 0.000000000000000,  0.000000000000000,  -0.045473599018814, -0.090460432742581, 0.000000000000000,  0.000000000000000,
        -0.027851051891632, -0.051279371335269, -0.000000000000000, 0.000000000000000,  -0.013542488351674, -0.031463638786189, 0.000000000000000,
        0.000000000000000,  0.033064907497730,  0.087052839884896,  0.000000000000000,  0.000000000000000,  0.016572394742929,  0.067853525512369,
        0.000000000000000,  0.000000000000000,  -0.004824760225012, -0.028347701515674, 0.000000000000000,  0.000000000000000,  0.053530613612242,
        0.075691507866634,  0.000000000000000,  0.000000000000000,  -0.035127647627111, -0.074125194433173, 0.000000000000000,  0.000000000000000,
        -0.006121311288860, -0.005616612801565, 0.000000000000000,  0.000000000000000,  -0.053132545116054, -0.133334646164020, 0.000000000000000,
        0.000000000000000,  -0.031320270868423, -0.074591693787768, -0.003346639764944, -0.006671912329885, 0.000000000000000,  0.000000000000000,
        0.131595940285468,  0.170995128482869,  0.000000000000000,  0.000000000000000,  0.095586228056625,  0.145658796882036,  -0.000000000000000,
        0.000000000000000,  -0.081421005380607, -0.098675391910874, 0.000000000000000,  0.000000000000000,  0.002088985368467,  -0.019430597126578,
        -0.000000000000000, -0.000000000000000, -0.003796115610017, 0.001989981157460,  0.000000000000000,  0.000000000000000,  0.109147535191943,
        0.132155122879978,  0.000000000000000,  0.000000000000000,  -0.072498100146256, -0.105633173707811, 0.000000000000000,  0.000000000000000,
        -0.062665331918205, -0.082116502065506, -0.000000000000000, -0.000000000000000, -0.012217681372819, -0.021323533601165, 0.000000000000000,
        0.000000000000000,  0.071503407156015,  0.124120847649822,  0.000000000000000,  0.000000000000000,  0.062862751792382,  0.114363872993385,
        0.000000000000000,  -0.000000000000000, -0.031351616877828, -0.054313691449778, 0.000000000000000,  0.000000000000000,  0.017089257502024,
        0.021511634434910,  -0.000000000000000, 0.000000000000000,  -0.021379311354824, -0.034742322343850, 0.000000000000000,  0.000000000000000,
        0.029799237084760,  0.050798359306713,  0.000000000000000,  0.000000000000000,  -0.071775142022956, -0.126093837380463, 0.000000000000000,
        0.000000000000000,  -0.045048350617698, -0.077789825331174, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 12, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.020897125194142,  0.017937568064824,  -0.000000000000000, -0.000000000000000, 0.023040085576178,
        0.006973288716489,  0.000000000000000,  0.000000000000000,  0.006862131373161,  0.025475058974981,  0.000000000000000,  0.000000000000000,
        0.036644138102864,  0.068495956696050,  0.000000000000000,  0.000000000000000,  -0.021451083977565, -0.069057489594161, 0.000000000000000,
        0.000000000000000,  0.001530784077619,  -0.020658427782136, 0.000000000000000,  0.000000000000000,  0.010252939057496,  -0.045882299426322,
        0.000000000000000,  0.000000000000000,  0.030831567689322,  0.012742695413294,  0.000000000000000,  0.000000000000000,  0.000562395529251,
        0.002134347607224,  0.000000000000000,  0.000000000000000,  0.016302445297047,  0.022139610830849,  0.000000000000000,  0.000000000000000,
        0.012525076114955,  0.004515250198301,  0.000000000000000,  0.000000000000000,  0.008491699654602,  0.044150490396951,  0.000000000000000,
        0.000000000000000,  0.037949714677198,  0.104323628433431,  0.000000000000000,  0.000000000000000,  -0.034432210417926, -0.106204393043581,
        0.000000000000000,  0.000000000000000,  -0.009481498541111, -0.030875788565890, 0.000000000000000,  0.000000000000000,  -0.010714749153692,
        -0.079763368856095, 0.000000000000000,  0.000000000000000,  0.020387090345786,  0.008643980924373,  0.000000000000000,  0.000000000000000,
        0.001352834209095,  0.002900047556369,  -0.030279676506899, -0.045821317595127, -0.000000000000000, 0.000000000000000,  -0.069079625201348,
        -0.093222358554289, -0.000000000000000, -0.000000000000000, 0.028379559920523,  0.079477984508273,  0.000000000000000,  0.000000000000000,
        -0.032255399554265, 0.003281692661406,  0.000000000000000,  -0.000000000000000, -0.229975229789644, -0.304077488431288, -0.000000000000000,
        0.000000000000000,  -0.160358674715413, -0.182023254528705, -0.000000000000000, 0.000000000000000,  -0.191381577339733, -0.277149209983582,
        0.000000000000000,  0.000000000000000,  -0.096977036219208, -0.150969159327855, -0.000000000000000, 0.000000000000000,  -0.001113840352286,
        -0.003682278788756, 0.000000000000000,  0.000000000000000,  -0.005509747857312, -0.012051277697639, 0.000000000000000,  0.000000000000000,
        -0.021870168835648, -0.040480546148325, -0.000000000000000, -0.000000000000000, 0.044272697016936,  0.085441034038428,  0.000000000000000,
        0.000000000000000,  0.044324670665636,  0.084826792771318,  0.000000000000000,  0.000000000000000,  -0.112679272985989, -0.197513636894106,
        0.000000000000000,  0.000000000000000,  -0.049749047260822, -0.082351107620125, 0.000000000000000,  0.000000000000000,  -0.100904799630494,
        -0.183425366999180, 0.000000000000000,  0.000000000000000,  -0.040489151342500, -0.077495831536871, 0.000000000000000,  0.000000000000000,
        -0.000671344967095, -0.001578585942869, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.010934130883997,
        -0.009029831172021, 0.000000000000000,  0.000000000000000,  0.005749334048195,  0.005094113603565,  0.000000000000000,  0.000000000000000,
        0.006106913811034,  0.034503125223178,  0.000000000000000,  0.000000000000000,  -0.031172095977040, 0.071300111643560,  -0.000000000000000,
        -0.000000000000000, -0.000786521445830, 0.079181072975429,  0.000000000000000,  0.000000000000000,  -0.020781397318027, 0.047533407762373,
        0.000000000000000,  0.000000000000000,  -0.002544547421264, -0.014376302176324, 0.000000000000000,  0.000000000000000,  -0.029385485135217,
        -0.026036580640443, 0.000000000000000,  -0.000000000000000, -0.010843013126630, -0.008954582578921, 0.000000000000000,  0.000000000000000,
        -0.005380687378270, -0.007554974724015, 0.000000000000000,  0.000000000000000,  0.001128539466019,  0.002191062019645,  0.000000000000000,
        0.000000000000000,  -0.020848060267626, 0.007505610832581,  0.000000000000000,  0.000000000000000,  -0.021971057735829, 0.081467166456017,
        -0.000000000000001, -0.000000000000000, 0.035409451687115,  0.137047571068861,  0.000000000000000,  0.000000000000000,  -0.014647371823886,
        0.054311444304011,  0.000000000000000,  0.000000000000000,  0.008686691778177,  -0.003127337846909, 0.000000000000000,  0.000000000000000,
        -0.005768090604100, -0.011198761433740, -0.000000000000000, 0.000000000000000,  -0.005335848316785, -0.007492016601314, 0.006772073624798,
        0.005946646710543,  0.000000000000000,  0.000000000000000,  -0.006746022429258, -0.003245800978278, 0.000000000000000,  0.000000000000000,
        -0.023545567654001, 0.054734042115015,  0.000000000000000,  0.000000000000000,  0.103765194337593,  0.248760760250955,  0.000000000000000,
        0.000000000000000,  0.155721561398759,  0.214380503385105,  -0.000000000000000, -0.000000000000000, 0.069176796225062,  0.165840506833970,
        0.000000000000000,  0.000000000000000,  0.009810653189167,  -0.022805850881256, 0.000000000000000,  0.000000000000000,  0.034479670193987,
        0.016589649444531,  -0.000000000000000, 0.000000000000000,  0.006715639677925,  0.005897091321289,  0.000000000000000,  0.000000000000000,
        0.000222664597533,  0.000249686289609,  0.000000000000000,  0.000000000000000,  -0.001262947114897, -0.001192663098427, 0.000000000000000,
        0.000000000000000,  0.005994488941586,  0.030369786368889,  0.000000000000000,  0.000000000000000,  0.082466523124787,  0.173120604639418,
        0.000000000000000,  0.000000000000000,  0.102697276420474,  0.183077966290923,  -0.000000000000000, -0.000000000000000, 0.054977682083191,
        0.115413736426279,  0.000000000000000,  0.000000000000000,  -0.002497703725661, -0.012654077653704, 0.000000000000000,  0.000000000000000,
        0.006455063031695,  0.006095833614183,  0.000000000000000,  0.000000000000000,  0.000220809059220,  0.000247605570529,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.007908454370385, -0.004999246653099, 0.000000000000000,  0.000000000000000,
        -0.045307684667727, -0.015105534174407, 0.000000000000000,  0.000000000000000,  -0.005511523030441, 0.044112366126972,  0.000000000000000,
        0.000000000000000,  0.001530784077619,  -0.020658427782136, 0.000000000000000,  0.000000000000000,  -0.014300722651710, -0.046038326396107,
        0.000000000000000,  0.000000000000000,  0.035368484704848,  0.085711313181164,  0.000000000000000,  0.000000000000000,  -0.017371772765119,
        0.034521384727216,  0.000000000000000,  0.000000000000000,  0.008684602905926,  0.004630140278386,  0.000000000000000,  0.000000000000000,
        0.022398329848444,  0.018523024821268,  0.000000000000000,  0.000000000000000,  -0.005179378400482, -0.005882525405037, 0.000000000000000,
        0.000000000000000,  -0.026110813618039, -0.009941388943041, 0.000000000000000,  0.000000000000000,  0.011181549229433,  0.076639299642095,
        0.000000000000000,  0.000000000000000,  -0.009481498541111, -0.030875788565890, 0.000000000000000,  0.000000000000000,  -0.022954806945284,
        -0.070802928695721, 0.000000000000000,  0.000000000000000,  0.045850963461458,  0.130053452238339,  0.000000000000000,  0.000000000000000,
        0.006105832600814,  0.060117955268509,  0.000000000000000,  0.000000000000000,  0.006849050536638,  0.003228653913122,  0.000000000000000,
        0.000000000000000,  0.017084419151904,  0.022749095416339,  0.011135416601496,  0.014687831765679,  0.000000000000000,  0.000000000000000,
        0.137695417440526,  0.194025077199120,  0.000000000000000,  0.000000000000000,  0.157040291772283,  0.240703310009465,  0.000000000000000,
        0.000000000000000,  -0.160358674715413, -0.182023254528705, -0.000000000000000, 0.000000000000000,  -0.153316819859763, -0.202718325620859,
        -0.000000000000000, -0.000000000000000, 0.101376829375246,  0.154967738101993,  0.000000000000000,  -0.000000000000000, 0.203901686154154,
        0.265757028820425,  -0.000000000000000, 0.000000000000000,  -0.028700563823541, -0.050525239998617, 0.000000000000000,  0.000000000000000,
        -0.032327636812433, -0.048070358571986, 0.000000000000000,  -0.000000000000000, 0.001518515332061,  0.003202041253622,  0.000000000000000,
        0.000000000000000,  0.047589301557326,  0.089127476045219,  0.000000000000000,  0.000000000000000,  0.092944240990858,  0.170672178704979,
        0.000000000000000,  0.000000000000000,  -0.049749047260822, -0.082351107620125, 0.000000000000000,  0.000000000000000,  -0.075119515323992,
        -0.131675757929404, -0.000000000000000, 0.000000000000000,  0.085782210049655,  0.153452715788089,  0.000000000000000,  0.000000000000000,
        0.084959996730632,  0.150623996431012,  -0.000000000000000, 0.000000000000000,  -0.014829186539279, -0.028945832010879, 0.000000000000000,
        0.000000000000000,  -0.005682871449482, -0.012383039084426, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 12, 36));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeGPForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix dipxmat(36, 12);

    CDenseMatrix dipymat(36, 12);

    CDenseMatrix dipzmat(36, 12);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.033588697289634, -0.021291897791894, 0.000000000000000,  0.000000000000000,  -0.001444262789026,
        -0.002256053682597, 0.000000000000000,  0.000000000000000,  0.044774261978662,  0.041786884292628,  0.000000000000000,  0.000000000000000,
        -0.043466391180414, -0.036645660490322, 0.000000000000000,  0.000000000000000,  -0.000617434646936, -0.003171448502792, 0.000000000000000,
        0.000000000000000,  0.055017039934741,  0.070654730587916,  -0.012549849316162, -0.013542488351674, 0.000000000000000,  0.000000000000000,
        -0.007908454370385, -0.005179378400482, 0.000000000000000,  0.000000000000000,  0.034379661325479,  0.037605297607898,  0.000000000000000,
        0.000000000000000,  -0.021735041801415, -0.031463638786189, 0.000000000000000,  -0.000000000000000, -0.004999246653099, -0.005882525405037,
        0.000000000000000,  0.000000000000000,  0.053702325449564,  0.080603428108284,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.004796767614797, 0.030578382512432,  0.000000000000000,  0.000000000000000,  -0.054763858134156, -0.010158658117612,
        0.000000000000000,  0.000000000000000,  0.103993814507278,  0.076070151977499,  0.000000000000000,  0.000000000000000,  0.005050777570060,
        0.055017534308877,  0.000000000000000,  0.000000000000000,  -0.040133552349784, -0.008381942384493, 0.000000000000000,  0.000000000000000,
        0.147176635477567,  0.135150577716764,  0.025791255340496,  0.033064907497730,  0.000000000000000,  0.000000000000000,  -0.045307684667727,
        -0.026110813618039, 0.000000000000000,  0.000000000000000,  0.029890850765058,  0.042399803787825,  0.000000000000000,  0.000000000000000,
        0.058542448357313,  0.087052839884896,  0.000000000000000,  0.000000000000000,  -0.015105534174407, -0.009941388943041, 0.000000000000000,
        0.000000000000000,  0.085881097426965,  0.124975757806125,  0.000000000000000,  0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.014660751924133,  0.038580829716037,  0.000000000000000,  0.000000000000000,  -0.021259904157613, 0.039444753923539,  0.000000000000000,
        0.000000000000000,  0.030439655457776,  -0.019127849672053, 0.000000000000000,  0.000000000000000,  0.047199533070540,  0.073363011433118,
        0.000000000000000,  0.000000000000000,  0.023771549237847,  0.080336452567001,  0.000000000000000,  0.000000000000000,  0.075313961818343,
        -0.020089976386618, 0.005727552422318,  0.016572394742929,  -0.000000000000000, 0.000000000000000,  -0.005511523030441, 0.011181549229433,
        0.000000000000000,  0.000000000000000,  -0.039191785939121, -0.047629617907177, 0.000000000000000,  0.000000000000000,  0.041807589078880,
        0.067853525512369,  0.000000000000000,  -0.000000000000000, 0.044112366126972,  0.076639299642095,  0.000000000000000,  0.000000000000000,
        -0.000303190277443, -0.042617766200583, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.020156787510554,
        -0.012969111942629, 0.000000000000000,  0.000000000000000,  0.045643955883113,  0.012062635076716,  0.000000000000000,  0.000000000000000,
        -0.003796115610017, -0.021379311354824, 0.000000000000000,  0.000000000000000,  -0.024137309742574, -0.023274198875454, 0.000000000000000,
        0.000000000000000,  0.068613112673571,  0.022020046457396,  0.000000000000000,  0.000000000000000,  0.001989981157460,  -0.034742322343850,
        0.006552384822864,  -0.004824760225012, 0.000000000000000,  0.000000000000000,  0.001530784077619,  -0.009481498541111, 0.000000000000000,
        0.000000000000000,  0.037265135761050,  0.005336441223111,  0.000000000000000,  0.000000000000000,  -0.017248450513036, -0.028347701515674,
        0.000000000000000,  0.000000000000000,  -0.020658427782136, -0.030875788565890, 0.000000000000000,  0.000000000000000,  0.046022875432719,
        0.011409589084078,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.002088985368466,  0.017089257502024,
        0.000000000000000,  0.000000000000000,  0.040417647678394,  -0.016988930629477, -0.000000000000000, -0.000000000000000, -0.079911979644462,
        -0.055478585095465, 0.000000000000000,  0.000000000000000,  -0.019430597126578, 0.021511634434910,  0.000000000000000,  0.000000000000000,
        0.032991786451751,  -0.033520263978658, -0.000000000000000, -0.000000000000000, -0.114887563106855, -0.099344083420279, 0.069212231030992,
        0.053530613612242,  -0.000000000000000, 0.000000000000000,  -0.014300722651710, -0.022954806945284, 0.000000000000000,  0.000000000000000,
        -0.023935839661652, -0.030759984937542, -0.000000000000000, -0.000000000000000, 0.060269084162198,  0.075691507866634,  0.000000000000000,
        0.000000000000000,  -0.046038326396107, -0.070802928695721, 0.000000000000000,  0.000000000000000,  -0.068628900670067, -0.094140374029222,
        -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  -0.095692442415097, -0.048953068757623, 0.000000000000000,
        0.000000000000000,  0.070235317298284,  0.076438109702882,  0.000000000000000,  0.000000000000000,  -0.040654779057220, -0.063195147315120,
        0.000000000000000,  0.000000000000000,  -0.109817142094990, -0.081301561205336, 0.000000000000000,  0.000000000000000,  0.117078923607353,
        0.137674880593713,  0.000000000000000,  0.000000000000000,  -0.029815777697303, -0.100343896228070, -0.032838526042972, -0.035127647627111,
        0.000000000000000,  0.000000000000000,  0.035368484704848,  0.045850963461458,  0.000000000000000,  0.000000000000000,  -0.064452854379016,
        -0.073029110462971, 0.000000000000000,  0.000000000000000,  -0.052748677971717, -0.074125194433173, 0.000000000000000,  0.000000000000000,
        0.085711313181164,  0.130053452238339,  0.000000000000000,  0.000000000000000,  -0.068317389356117, -0.124937751491818, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.085073607526038, -0.028477375898469, 0.000000000000000,  0.000000000000000,
        -0.011115142715380, 0.020443578252413,  -0.000000000000000, 0.000000000000000,  0.071329013415392,  0.060277961541116,  0.000000000000000,
        0.000000000000000,  -0.104147110267610, -0.047603708437928, 0.000000000000000,  0.000000000000000,  0.004153394349170,  0.041685802243880,
        -0.000000000000000, -0.000000000000000, 0.098657962686821,  0.106067846750218,  -0.010819281574071, -0.006121311288860, 0.000000000000000,
        0.000000000000000,  -0.017371772765119, 0.006105832600814,  0.000000000000000,  0.000000000000000,  -0.003908812547484, 0.021726921777654,
        0.000000000000000,  -0.000000000000000, -0.005096769772686, -0.005616612801565, 0.000000000000000,  0.000000000000000,  0.034521384727216,
        0.060117955268509,  0.000000000000000,  0.000000000000000,  0.029701670906701,  0.072131057372188,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.099183629952830, -0.079782212061918, 0.000000000000000,  0.000000000000000,  0.036306105587421,
        0.004676251754286,  0.000000000000000,  0.000000000000000,  0.040159575446238,  0.055429819401854,  0.000000000000000,  0.000000000000000,
        -0.138100546712491, -0.139614050860213, 0.000000000000000,  0.000000000000000,  0.028566155182817,  0.003989772206626,  0.000000000000000,
        0.000000000000000,  0.035031622401589,  0.089096324016639,  -0.045473599018814, -0.053132545116054, 0.000000000000000,  0.000000000000000,
        0.008684602905926,  0.006849050536638,  0.000000000000000,  0.000000000000000,  0.054460635065744,  0.061367982111413,  0.000000000000000,
        0.000000000000000,  -0.090460432742581, -0.133334646164020, 0.000000000000000,  0.000000000000000,  0.004630140278386,  0.003228653913122,
        0.000000000000000,  0.000000000000000,  0.062067829974130,  0.109080034118665,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.032169139456332, -0.035897880279136, 0.000000000000000,  0.000000000000000,  0.031968502294682,  0.013609370180988,
        -0.000000000000000, -0.000000000000000, -0.025447171425658, -0.015820417613337, 0.000000000000000,  0.000000000000000,  -0.045012825913713,
        -0.062338941073201, 0.000000000000000,  0.000000000000000,  0.030156558648046,  0.020192575226134,  -0.000000000000000, 0.000000000000000,
        -0.038332047795855, -0.029105237550030, -0.027851051891632, -0.031320270868423, -0.000000000000000, 0.000000000000000,  0.022398329848444,
        0.017084419151904,  0.000000000000000,  0.000000000000000,  -0.002880719019685, -0.005645607679398, -0.000000000000000, -0.000000000000000,
        -0.051279371335269, -0.074591693787768, 0.000000000000000,  0.000000000000000,  0.018523024821268,  0.022749095416339,  0.000000000000000,
        0.000000000000000,  -0.018086285646460, -0.024204871905464, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 36, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.052587349683479, -0.039372977504828, 0.000000000000000,  0.000000000000000,  0.034016462600216,
        0.013782493773158,  0.000000000000000,  -0.000000000000000, -0.003346639764944, -0.012217681372819, 0.000000000000000,  0.000000000000000,
        -0.074887557685073, -0.069883422445758, 0.000000000000000,  0.000000000000000,  0.032405599624905,  0.020524336612922,  0.000000000000000,
        0.000000000000000,  -0.006671912329885, -0.021323533601165, -0.019469987236083, -0.024070304707456, -0.000000000000000, 0.000000000000000,
        0.020897125194142,  0.016302445297047,  0.000000000000000,  0.000000000000000,  -0.012549849316162, -0.013542488351674, 0.000000000000000,
        0.000000000000000,  -0.048133975798716, -0.067827868205276, 0.000000000000000,  0.000000000000000,  0.017937568064824,  0.022139610830849,
        0.000000000000000,  0.000000000000000,  -0.021735041801415, -0.031463638786189, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.096033213687787, -0.077883361746925, -0.000000000000000, -0.000000000000000, 0.017311408162357,  0.004051709421800,
        0.000000000000000,  0.000000000000000,  0.131595940285468,  0.071503407156015,  0.000000000000000,  0.000000000000000,  -0.127685489505496,
        -0.135149135560660, -0.000000000000000, 0.000000000000000,  0.011886662132579,  0.003289437894704,  0.000000000000000,  0.000000000000000,
        0.170995128482869,  0.124120847649822,  -0.040278555186325, -0.053042185059325, 0.000000000000000,  0.000000000000000,  0.023040085576178,
        0.012525076114955,  -0.000000000000000, -0.000000000000000, 0.025791255340496,  0.033064907497730,  0.000000000000000,  0.000000000000000,
        -0.086936609887185, -0.133257813275786, 0.000000000000000,  0.000000000000000,  0.006973288716489,  0.004515250198301,  0.000000000000000,
        0.000000000000000,  0.058542448357313,  0.087052839884896,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.006365727791871,  -0.020449710858345, 0.000000000000000,  0.000000000000000,  -0.016525674609969, 0.030798752125908,  -0.000000000000000,
        0.000000000000000,  0.095586228056625,  0.062862751792382,  0.000000000000000,  0.000000000000000,  0.047305949205975,  -0.023284627255403,
        0.000000000000000,  0.000000000000000,  0.024843318832458,  0.062689814122196,  0.000000000000000,  0.000000000000000,  0.145658796882036,
        0.114363872993385,  -0.017553222790980, -0.035386995329456, -0.000000000000000, 0.000000000000000,  0.006862131373161,  0.008491699654602,
        0.000000000000000,  0.000000000000000,  0.005727552422318,  0.016572394742929,  -0.000000000000000, 0.000000000000000,  0.009890349267929,
        -0.031384540597452, 0.000000000000000,  0.000000000000000,  0.025475058974981,  0.044150490396951,  0.000000000000000,  0.000000000000000,
        0.041807589078880,  0.067853525512369,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  -0.087421234241644,
        -0.092867077531799, 0.000000000000000,  0.000000000000000,  0.108271947200879,  0.086490305600145,  0.000000000000000,  0.000000000000000,
        -0.081421005380607, -0.031351616877828, 0.000000000000000,  0.000000000000000,  -0.082919612317277, -0.150684820311436, 0.000000000000000,
        0.000000000000000,  0.174256517501996,  0.156024919308209,  0.000000000000000,  0.000000000000000,  -0.098675391910874, -0.054313691449778,
        -0.054012178291256, -0.081653158404865, 0.000000000000000,  0.000000000000000,  0.036644138102864,  0.037949714677198,  0.000000000000000,
        0.000000000000000,  0.006552384822864,  -0.004824760225012, 0.000000000000000,  0.000000000000000,  -0.075600081832013, -0.155802985078065,
        0.000000000000000,  0.000000000000000,  0.068495956696050,  0.104323628433431,  0.000000000000000,  0.000000000000000,  -0.017248450513036,
        -0.028347701515674, 0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.078171158504074, -0.041237537177112,
        0.000000000000000,  0.000000000000000,  0.060626471517591,  -0.025483395944215, 0.000000000000000,  0.000000000000000,  0.002088985368467,
        0.017089257502024,  -0.000000000000000, -0.000000000000000, -0.131079727379003, -0.081417721391188, 0.000000000000000,  0.000000000000000,
        0.049487679677626,  -0.050280395967986, 0.000000000000000,  0.000000000000000,  -0.019430597126578, 0.021511634434910,  0.033741019530841,
        0.013848859739326,  -0.000000000000000, -0.000000000000000, -0.021451083977565, -0.034432210417926, 0.000000000000000,  0.000000000000000,
        0.069212231030992,  0.053530613612242,  -0.000000000000000, -0.000000000000000, -0.018404663868235, -0.031064117473694, -0.000000000000000,
        -0.000000000000000, -0.069057489594161, -0.106204393043581, 0.000000000000000,  0.000000000000000,  0.060269084162198,  0.075691507866634,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.020156787510554, -0.012969111942629, 0.000000000000000,
        0.000000000000000,  0.045643955883113,  0.012062635076716,  0.000000000000000,  0.000000000000000,  -0.003796115610017, -0.021379311354824,
        0.000000000000000,  0.000000000000000,  -0.024137309742574, -0.023274198875454, 0.000000000000000,  0.000000000000000,  0.068613112673571,
        0.022020046457396,  0.000000000000000,  0.000000000000000,  0.001989981157460,  -0.034742322343850, 0.053288159358880,  0.022151299008469,
        0.000000000000000,  0.000000000000000,  0.001530784077619,  -0.009481498541111, 0.000000000000000,  0.000000000000000,  -0.032838526042972,
        -0.035127647627111, 0.000000000000000,  0.000000000000000,  0.048599251756588,  0.028675487495826,  0.000000000000000,  0.000000000000000,
        -0.020658427782136, -0.030875788565890, 0.000000000000000,  0.000000000000000,  -0.052748677971717, -0.074125194433173, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.086664589769412, -0.043787311320116, 0.000000000000000,  0.000000000000000,
        0.020201321830411,  -0.037418741643942, 0.000000000000000,  0.000000000000000,  0.109147535191943,  0.029799237084760,  0.000000000000000,
        0.000000000000000,  -0.149749592280286, -0.087995095232709, 0.000000000000000,  0.000000000000000,  -0.019723520534595, -0.076226971982113,
        0.000000000000000,  0.000000000000000,  0.132155122879978,  0.050798359306713,  0.027552566185026,  0.012863333737609,  0.000000000000000,
        0.000000000000000,  0.010252939057496,  -0.010714749153692, 0.000000000000000,  0.000000000000000,  -0.010819281574071, -0.006121311288860,
        0.000000000000000,  0.000000000000000,  -0.033696320486070, -0.041296762873007, 0.000000000000000,  0.000000000000000,  -0.045882299426322,
        -0.079763368856095, 0.000000000000000,  0.000000000000000,  -0.005096769772686, -0.005616612801565, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.080847090745858, -0.046162302802564, 0.000000000000000,  0.000000000000000,  0.073918174865313,
        0.010788448704994,  0.000000000000000,  0.000000000000000,  -0.072498100146256, -0.071775142022956, 0.000000000000000,  0.000000000000000,
        -0.134653035147726, -0.089103695036728, 0.000000000000000,  0.000000000000000,  0.056953209207167,  0.009088161858700,  0.000000000000000,
        0.000000000000000,  -0.105633173707811, -0.126093837380463, -0.001367923579271, -0.006973588945966, 0.000000000000000,  0.000000000000000,
        0.030831567689322,  0.020387090345786,  -0.000000000000000, 0.000000000000000,  -0.045473599018814, -0.053132545116054, 0.000000000000000,
        0.000000000000000,  -0.056672988510786, -0.066749528384843, 0.000000000000000,  0.000000000000000,  0.012742695413294,  0.008643980924373,
        0.000000000000000,  0.000000000000000,  -0.090460432742581, -0.133334646164020, 0.000000000000000,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, 0.017699192785047,  0.018214208511238,  0.000000000000000,  0.000000000000000,  0.011465839038237,  0.003103224047562,
        0.000000000000000,  0.000000000000000,  -0.062665331918205, -0.045048350617698, 0.000000000000000,  0.000000000000000,  0.018627117693442,
        0.029870118124337,  0.000000000000000,  0.000000000000000,  0.011622987623859,  0.004794903813545,  0.000000000000000,  0.000000000000000,
        -0.082116502065506, -0.077789825331174, 0.017666145825002,  0.019067808972337,  -0.000000000000000, 0.000000000000000,  0.000562395529251,
        0.001352834209095,  0.000000000000000,  0.000000000000000,  -0.027851051891632, -0.031320270868423, -0.000000000000000, -0.000000000000000,
        0.023608232383551,  0.036873968809280,  0.000000000000000,  0.000000000000000,  0.002134347607224,  0.002900047556369,  0.000000000000000,
        0.000000000000000,  -0.051279371335269, -0.074591693787768, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 36, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.030279676506899, -0.005509747857312, 0.000000000000000,  0.000000000000000,  0.006772073624798,
        0.000222664597533,  0.000000000000000,  0.000000000000000,  0.011135416601496,  0.001518515332061,  0.000000000000000,  0.000000000000000,
        -0.045821317595127, -0.012051277697639, 0.000000000000000,  0.000000000000000,  0.005946646710543,  0.000249686289609,  0.000000000000000,
        0.000000000000000,  0.014687831765679,  0.003202041253622,  0.020897125194142,  0.016302445297047,  -0.000000000000000, 0.000000000000000,
        -0.010934130883997, -0.005380687378270, 0.000000000000000,  0.000000000000000,  -0.007908454370385, -0.005179378400482, 0.000000000000000,
        0.000000000000000,  0.017937568064824,  0.022139610830849,  0.000000000000000,  0.000000000000000,  -0.009029831172021, -0.007554974724015,
        0.000000000000000,  0.000000000000000,  -0.004999246653099, -0.005882525405037, 0.000000000000000,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.069079625201348, -0.021870168835648, 0.000000000000000,  0.000000000000000,  -0.006746022429258, -0.001262947114897,
        0.000000000000000,  0.000000000000000,  0.137695417440526,  0.047589301557326,  -0.000000000000000, 0.000000000000000,  -0.093222358554289,
        -0.040480546148325, 0.000000000000000,  0.000000000000000,  -0.003245800978278, -0.001192663098427, 0.000000000000000,  0.000000000000000,
        0.194025077199120,  0.089127476045219,  0.023040085576178,  0.012525076114955,  -0.000000000000000, -0.000000000000000, 0.005749334048195,
        0.001128539466019,  0.000000000000000,  0.000000000000000,  -0.045307684667727, -0.026110813618039, 0.000000000000000,  0.000000000000000,
        0.006973288716489,  0.004515250198301,  -0.000000000000000, -0.000000000000000, 0.005094113603565,  0.002191062019645,  0.000000000000000,
        0.000000000000000,  -0.015105534174407, -0.009941388943041, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.028379559920523,  0.044272697016936,  0.000000000000000,  0.000000000000000,  -0.023545567654001, 0.005994488941586,  0.000000000000000,
        0.000000000000000,  0.157040291772283,  0.092944240990858,  0.000000000000000,  0.000000000000000,  0.079477984508273,  0.085441034038428,
        0.000000000000000,  0.000000000000000,  0.054734042115015,  0.030369786368889,  0.000000000000000,  0.000000000000000,  0.240703310009465,
        0.170672178704979,  0.006862131373161,  0.008491699654602,  0.000000000000000,  0.000000000000000,  0.006106913811034,  -0.020848060267626,
        0.000000000000000,  0.000000000000000,  -0.005511523030441, 0.011181549229433,  0.000000000000000,  0.000000000000000,  0.025475058974981,
        0.044150490396951,  0.000000000000000,  0.000000000000000,  0.034503125223178,  0.007505610832581,  0.000000000000000,  0.000000000000000,
        0.044112366126972,  0.076639299642095,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.032255399554265,
        0.044324670665636,  0.000000000000000,  0.000000000000000,  0.103765194337593,  0.082466523124787,  0.000000000000000,  0.000000000000000,
        -0.160358674715413, -0.049749047260822, 0.000000000000000,  0.000000000000000,  0.003281692661406,  0.084826792771318,  0.000000000000000,
        0.000000000000000,  0.248760760250955,  0.173120604639418,  0.000000000000000,  0.000000000000000,  -0.182023254528705, -0.082351107620125,
        0.036644138102864,  0.037949714677198,  0.000000000000000,  0.000000000000000,  -0.031172095977040, -0.021971057735829, 0.000000000000000,
        0.000000000000000,  0.001530784077619,  -0.009481498541111, -0.000000000000000, 0.000000000000000,  0.068495956696050,  0.104323628433431,
        -0.000000000000000, 0.000000000000000,  0.071300111643560,  0.081467166456017,  0.000000000000000,  0.000000000000000,  -0.020658427782136,
        -0.030875788565890, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.229975229789644, -0.112679272985989,
        -0.000000000000000, -0.000000000000001, 0.155721561398759,  0.102697276420474,  0.000000000000000,  0.000000000000000,  -0.153316819859763,
        -0.075119515323992, 0.000000000000000,  0.000000000000000,  -0.304077488431288, -0.197513636894106, -0.000000000000000, -0.000000000000000,
        0.214380503385105,  0.183077966290923,  0.000000000000000,  0.000000000000000,  -0.202718325620859, -0.131675757929404, -0.021451083977565,
        -0.034432210417926, -0.000000000000000, 0.000000000000000,  -0.000786521445830, 0.035409451687115,  -0.000000000000000, -0.000000000000000,
        -0.014300722651710, -0.022954806945284, -0.000000000000000, -0.000000000000000, -0.069057489594161, -0.106204393043581, 0.000000000000000,
        0.000000000000000,  0.079181072975429,  0.137047571068861,  -0.000000000000000, -0.000000000000000, -0.046038326396107, -0.070802928695721,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.160358674715413, -0.049749047260822, 0.000000000000000,
        0.000000000000000,  0.069176796225062,  0.054977682083191,  0.000000000000000,  0.000000000000000,  0.101376829375246,  0.085782210049655,
        0.000000000000000,  0.000000000000000,  -0.182023254528705, -0.082351107620125, 0.000000000000000,  0.000000000000000,  0.165840506833970,
        0.115413736426279,  0.000000000000000,  0.000000000000000,  0.154967738101993,  0.153452715788089,  0.001530784077619,  -0.009481498541111,
        -0.000000000000000, 0.000000000000000,  -0.020781397318027, -0.014647371823886, 0.000000000000000,  0.000000000000000,  0.035368484704848,
        0.045850963461458,  0.000000000000000,  0.000000000000000,  -0.020658427782136, -0.030875788565890, 0.000000000000000,  0.000000000000000,
        0.047533407762373,  0.054311444304011,  0.000000000000000,  0.000000000000000,  0.085711313181164,  0.130053452238339,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.191381577339733, -0.100904799630494, 0.000000000000000,  0.000000000000000,
        0.009810653189167,  -0.002497703725661, 0.000000000000000,  0.000000000000000,  0.203901686154154,  0.084959996730632,  0.000000000000000,
        0.000000000000000,  -0.277149209983582, -0.183425366999180, 0.000000000000000,  0.000000000000000,  -0.022805850881256, -0.012654077653704,
        0.000000000000000,  0.000000000000000,  0.265757028820425,  0.150623996431012,  0.010252939057496,  -0.010714749153692, 0.000000000000000,
        0.000000000000000,  -0.002544547421264, 0.008686691778177,  0.000000000000000,  0.000000000000000,  -0.017371772765119, 0.006105832600814,
        -0.000000000000000, -0.000000000000000, -0.045882299426322, -0.079763368856095, 0.000000000000000,  0.000000000000000,  -0.014376302176324,
        -0.003127337846909, 0.000000000000000,  0.000000000000000,  0.034521384727216,  0.060117955268509,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.096977036219208, -0.040489151342500, 0.000000000000000,  0.000000000000000,  0.034479670193987,
        0.006455063031695,  0.000000000000000,  0.000000000000000,  -0.028700563823541, -0.014829186539279, 0.000000000000000,  0.000000000000000,
        -0.150969159327855, -0.077495831536871, 0.000000000000000,  0.000000000000000,  0.016589649444531,  0.006095833614183,  0.000000000000000,
        0.000000000000000,  -0.050525239998617, -0.028945832010879, 0.030831567689322,  0.020387090345786,  -0.000000000000000, 0.000000000000000,
        -0.029385485135217, -0.005768090604100, -0.000000000000000, 0.000000000000000,  0.008684602905926,  0.006849050536638,  0.000000000000000,
        0.000000000000000,  0.012742695413294,  0.008643980924373,  0.000000000000000,  0.000000000000000,  -0.026036580640443, -0.011198761433740,
        0.000000000000000,  0.000000000000000,  0.004630140278386,  0.003228653913122,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.001113840352286, -0.000671344967095, 0.000000000000000,  -0.000000000000000, 0.006715639677925,  0.000220809059220,
        0.000000000000000,  0.000000000000000,  -0.032327636812433, -0.005682871449482, 0.000000000000000,  0.000000000000000,  -0.003682278788756,
        -0.001578585942869, -0.000000000000000, 0.000000000000000,  0.005897091321289,  0.000247605570529,  0.000000000000000,  0.000000000000000,
        -0.048070358571986, -0.012383039084426, 0.000562395529251,  0.001352834209095,  0.000000000000000,  0.000000000000000,  -0.010843013126630,
        -0.005335848316785, 0.000000000000000,  0.000000000000000,  0.022398329848444,  0.017084419151904,  0.000000000000000,  -0.000000000000000,
        0.002134347607224,  0.002900047556369,  0.000000000000000,  0.000000000000000,  -0.008954582578921, -0.007492016601314, 0.000000000000000,
        0.000000000000000,  0.018523024821268,  0.022749095416339,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 36, 12));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeDGForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix dipxmat(20, 36);

    CDenseMatrix dipymat(20, 36);

    CDenseMatrix dipzmat(20, 36);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.020335313111331, -0.034851824638179, 0.000000000000000,  0.000000000000000,  0.019971724704654,
        -0.012992276859365, 0.000000000000000,  0.000000000000000,  0.009028183574898,  0.006327939865357,  0.000000000000000,  0.000000000000000,
        0.028590230371335,  0.028568799888118,  0.000000000000000,  0.000000000000000,  0.046621921521757,  0.074796110717735,  0.000000000000000,
        0.000000000000000,  -0.073301609715550, -0.025547141842077, 0.000000000000000,  0.000000000000000,  0.077389703924233,  0.152229114371108,
        0.000000000000000,  0.000000000000000,  0.012344791280355,  0.054179372009367,  0.000000000000000,  0.000000000000000,  0.026530203336763,
        0.073778983198199,  0.000000000000000,  0.000000000000000,  -0.039534781315108, -0.085637360948977, 0.000000000000000,  0.000000000000000,
        -0.009818511786802, -0.074438772533442, 0.000000000000000,  0.000000000000000,  0.025465166631528,  0.040396322598993,  0.000000000000000,
        0.000000000000000,  0.017149707090124,  0.045325585190646,  0.000000000000000,  0.000000000000000,  0.008270827903686,  0.044123958992712,
        0.000000000000000,  0.000000000000000,  -0.084995837316362, -0.073610369953256, 0.000000000000000,  0.000000000000000,  0.066878039452447,
        0.170321649220424,  0.000000000000000,  0.000000000000000,  -0.004478225665574, 0.036410961200255,  0.000000000000000,  0.000000000000000,
        0.044937174870843,  0.133948211060763,  -0.002423744661024, -0.003590453815938, 0.000000000000000,  0.000000000000000,  0.007245522400306,
        0.033838731270765,  0.000000000000000,  0.000000000000000,  0.003664268046428,  0.021630893303017,  0.000000000000000,  -0.000000000000000,
        -0.025057856014389, -0.038910518904814, 0.000000000000000,  0.000000000000000,  0.028854940296764,  0.010266912889174,  0.000000000000000,
        0.000000000000000,  0.013893469104083,  -0.024660751188482, 0.000000000000000,  0.000000000000000,  -0.113857258172334, -0.152582709686649,
        0.000000000000000,  0.000000000000000,  -0.090307294497661, -0.137351808254408, 0.000000000000000,  0.000000000000000,  -0.066341911168548,
        -0.099361549848699, -0.000000000000000, 0.000000000000000,  0.048823453100397,  0.082566192590609,  0.000000000000000,  0.000000000000000,
        0.078039648756206,  0.147743963779775,  0.000000000000000,  0.000000000000000,  -0.020554680045397, -0.025854792405547, 0.000000000000000,
        0.000000000000000,  -0.032750989443363, -0.061707931492751, 0.000000000000000,  0.000000000000000,  0.041082333192871,  0.056405148693473,
        0.000000000000000,  0.000000000000000,  0.049466676612759,  0.059342626538658,  0.000000000000000,  0.000000000000000,  -0.064790229134001,
        -0.113483932604041, 0.000000000000000,  0.000000000000000,  -0.033993048500089, -0.071340132702448, 0.000000000000000,  0.000000000000000,
        -0.097717332414101, -0.175521885246366, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.020958418001282,
        -0.019694418813302, 0.000000000000000,  0.000000000000000,  0.025211652289942,  0.013130543160126,  0.000000000000000,  0.000000000000000,
        -0.009247703477899, -0.042912367795758, 0.000000000000000,  0.000000000000000,  0.018278335453583,  0.018498067711900,  0.000000000000000,
        0.000000000000000,  0.007400170659329,  -0.028636508872788, 0.000000000000000,  0.000000000000000,  0.011893287941969,  0.033917910054030,
        0.000000000000000,  0.000000000000000,  -0.006968174792307, 0.000189416676426,  0.000000000000000,  0.000000000000000,  -0.045203202986829,
        -0.020310701529192, 0.000000000000000,  0.000000000000000,  -0.046410622804144, -0.046474639547624, 0.000000000000000,  0.000000000000000,
        -0.021432780028986, -0.030330686679727, 0.000000000000000,  0.000000000000000,  0.024803110730905,  0.011674572640204,  0.000000000000000,
        0.000000000000000,  -0.016934423014528, -0.089982599825449, 0.000000000000000,  0.000000000000000,  0.015196320269609,  0.032755522413158,
        0.000000000000000,  0.000000000000000,  -0.014997662567128, -0.050619069407789, 0.000000000000000,  0.000000000000000,  0.022152247378626,
        0.060983695215943,  0.000000000000000,  0.000000000000000,  -0.001807935235597, 0.000790974317224,  0.000000000000000,  0.000000000000000,
        -0.039919624596286, -0.017881381172124, 0.000000000000000,  0.000000000000000,  -0.049550473210964, -0.071905773790538, 0.050312451060217,
        0.049391750774510,  0.000000000000000,  0.000000000000000,  0.006377374726420,  -0.002537694622131, -0.000000000000000, 0.000000000000000,
        0.018975573876342,  0.030836451933118,  0.000000000000000,  0.000000000000000,  0.032836243773091,  0.049384772731707,  0.000000000000000,
        0.000000000000000,  -0.038001321429209, -0.043103568011262, 0.000000000000000,  0.000000000000000,  -0.010324766627555, -0.037663265647977,
        -0.000000000000000, 0.000000000000000,  0.020666246342592,  -0.015063833711913, 0.000000000000000,  0.000000000000000,  0.088563769320864,
        0.075176196533866,  -0.000000000000000, 0.000000000000000,  0.047775402734614,  0.051358750921935,  0.000000000000000,  0.000000000000000,
        0.028793039581950,  0.043265475230598,  0.000000000000000,  0.000000000000000,  -0.010169589174957, -0.009036594628056, 0.000000000000000,
        0.000000000000000,  0.056524243620879,  0.115776967308462,  0.000000000000000,  0.000000000000000,  0.014799738023280,  0.028194242465538,
        0.000000000000000,  0.000000000000000,  -0.004763527134777, -0.011429508486733, 0.000000000000000,  0.000000000000000,  -0.044813016310051,
        -0.079022485486127, 0.000000000000000,  0.000000000000000,  -0.023070821968756, -0.047391717127984, 0.000000000000000,  0.000000000000000,
        0.026702666966211,  0.022931518066976,  0.000000000000000,  0.000000000000000,  0.048520685692467,  0.073600090019296,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.013259435939966, -0.003613180091084, 0.000000000000000,  0.000000000000000,
        -0.030800814832007, 0.031005198055533,  0.000000000000000,  0.000000000000000,  0.047304407932629,  0.069734132840080,  0.000000000000000,
        0.000000000000000,  -0.007692596372364, -0.008350309837537, 0.000000000000000,  0.000000000000000,  -0.027934629925597, -0.020251809047970,
        0.000000000000000,  0.000000000000000,  0.055128839184977,  -0.001028002227801, 0.000000000000000,  0.000000000000000,  0.023290138693669,
        0.052642974140011,  0.000000000000000,  0.000000000000000,  -0.000186722678500, -0.011948452488010, 0.000000000000000,  0.000000000000000,
        0.033712777371128,  0.011479231646871,  0.000000000000000,  0.000000000000000,  -0.010632957636088, -0.007372724518857, 0.000000000000000,
        0.000000000000000,  -0.024982748404054, 0.020802660643230,  0.000000000000000,  0.000000000000000,  0.038185533136565,  0.063940917919153,
        0.000000000000000,  0.000000000000000,  0.010720532349444,  0.012954471874963,  0.000000000000000,  0.000000000000000,  -0.005494765046547,
        0.003670299912458,  0.000000000000000,  0.000000000000000,  0.028472006104569,  -0.051208982819734, 0.000000000000000,  0.000000000000000,
        0.015634985091575,  0.038849707892864,  0.000000000000000,  0.000000000000000,  0.002348299154177,  -0.009964120181849, 0.000000000000000,
        0.000000000000000,  0.031869986414237,  0.025720732061569,  -0.002362314638000, -0.005301233999473, -0.000000000000000, 0.000000000000000,
        0.029317838745428,  -0.007075114084893, 0.000000000000000,  0.000000000000000,  -0.030330435782329, -0.054683118835256, 0.000000000000000,
        0.000000000000000,  -0.001690829040712, 0.031898720072493,  0.000000000000000,  0.000000000000000,  0.032552042970007,  0.075456110339199,
        -0.000000000000000, -0.000000000000000, -0.071548155345546, -0.033942487942542, 0.000000000000000,  0.000000000000000,  -0.047106998217742,
        -0.066994699267784, 0.000000000000000,  0.000000000000000,  -0.041956310312168, -0.025598234027734, 0.000000000000000,  0.000000000000000,
        -0.045444023527468, -0.031726378754648, -0.000000000000000, 0.000000000000000,  0.004277841420075,  0.005018459211704,  0.000000000000000,
        0.000000000000000,  0.014908842486646,  0.009865537049793,  0.000000000000000,  0.000000000000000,  -0.014495694557430, -0.017212012815776,
        0.000000000000000,  0.000000000000000,  0.005003360969551,  0.022112171953995,  0.000000000000000,  0.000000000000000,  0.021791066493876,
        0.042000814117580,  -0.000000000000000, -0.000000000000000, 0.038376347098074,  0.099631628250516,  0.000000000000000,  0.000000000000000,
        -0.009290488367119, -0.015312928726773, 0.000000000000000,  0.000000000000000,  -0.009534971110249, -0.010218984109084, 0.000000000000000,
        0.000000000000000,  -0.029226017712531, -0.039467766968718, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.057479908351940,  0.048770297817213,  0.000000000000000,  0.000000000000000,  0.028534226424955,  0.019336589883634,  0.000000000000000,
        0.000000000000000,  -0.026513642764410, -0.026519916063309, 0.000000000000000,  0.000000000000000,  -0.044486918102289, -0.131844088505244,
        0.000000000000000,  0.000000000000000,  -0.043479768793277, -0.026843432128750, 0.000000000000000,  0.000000000000000,  -0.030359391066534,
        -0.036089983212865, 0.000000000000000,  0.000000000000000,  -0.014923971827598, -0.031407802745956, 0.000000000000000,  0.000000000000000,
        0.054933645860682,  0.013490853022247,  0.000000000000000,  0.000000000000000,  -0.004503550771221, -0.016302539469904, 0.000000000000000,
        0.000000000000000,  0.059562441315555,  0.077701035785389,  0.000000000000000,  0.000000000000000,  0.031694953032090,  0.016760378693002,
        0.000000000000000,  0.000000000000000,  -0.014337998545630, -0.018692228945759, 0.000000000000000,  0.000000000000000,  -0.046429578360090,
        -0.137034192922995, 0.000000000000000,  0.000000000000000,  -0.010511780315558, 0.025999513744679,  0.000000000000000,  0.000000000000000,
        -0.002101770962732, 0.002595904041880,  0.000000000000000,  0.000000000000000,  -0.015299301519281, -0.080295832736712, 0.000000000000000,
        0.000000000000000,  0.046447965992886,  0.014628618475837,  0.000000000000000,  0.000000000000000,  -0.008845031599402, -0.023333295645697,
        -0.067536539157996, -0.062748755370739, 0.000000000000000,  0.000000000000000,  -0.092628655876374, -0.080212823702070, 0.000000000000000,
        0.000000000000000,  0.019737089399448,  0.038630748997540,  0.000000000000000,  0.000000000000000,  0.062825636565503,  0.094370258290055,
        -0.000000000000000, 0.000000000000000,  0.038124481119370,  0.022821150941719,  0.000000000000000,  0.000000000000000,  0.091360359968556,
        0.122364139760083,  -0.000000000000000, -0.000000000000000, -0.008384855438572, 0.021461233403977,  0.000000000000000,  0.000000000000000,
        -0.038387137315593, -0.018771933676316, 0.000000000000000,  0.000000000000000,  0.037319058724044,  0.043492487433117,  0.000000000000000,
        0.000000000000000,  -0.056560735650648, -0.083418076118000, 0.000000000000000,  0.000000000000000,  -0.025370853379339, -0.022198395473657,
        0.000000000000000,  0.000000000000000,  0.018884197434113,  0.038646403910807,  0.000000000000000,  0.000000000000000,  0.028597653140041,
        0.052989439939831,  0.000000000000000,  0.000000000000000,  -0.050661189447191, -0.101311658424509, 0.000000000000000,  0.000000000000000,
        0.015079442492149,  0.029382210919983,  0.000000000000000,  0.000000000000000,  0.061895662278507,  0.125761227707200,  0.000000000000000,
        0.000000000000000,  -0.018883760070316, -0.014634013921238, -0.000000000000000, -0.000000000000000, 0.021314009077531,  0.034362920942141,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.022153491864302, -0.074774405154896, 0.000000000000000,
        0.000000000000000,  -0.010523606671952, -0.061212044497504, 0.000000000000000,  0.000000000000000,  -0.095459561980808, -0.151386688671101,
        0.000000000000000,  0.000000000000000,  0.061097074765486,  0.077394815763830,  0.000000000000000,  0.000000000000000,  -0.046296835050685,
        0.011837981280078,  0.000000000000000,  0.000000000000000,  -0.014990666162748, -0.010150312901367, 0.000000000000000,  0.000000000000000,
        0.010731649151238,  -0.021789385642034, 0.000000000000000,  0.000000000000000,  0.029524548212210,  -0.018388998441333, 0.000000000000000,
        0.000000000000000,  -0.019928451326587, -0.034383451758853, 0.000000000000000,  0.000000000000000,  -0.040501244900358, -0.132842477683072,
        0.000000000000000,  0.000000000000000,  0.011116326591500,  -0.037889500341161, 0.000000000000000,  0.000000000000000,  -0.080737439720822,
        -0.174838771842395, 0.000000000000000,  0.000000000000000,  0.039444927187967,  0.079383772452698,  0.000000000000000,  0.000000000000000,
        -0.052012397534509, -0.022522826361576, 0.000000000000000,  0.000000000000000,  0.005447264709950,  0.021138354895508,  0.000000000000000,
        0.000000000000000,  0.047052198180019,  0.034862512282916,  0.000000000000000,  0.000000000000000,  0.000524967276368,  -0.074136625506322,
        0.000000000000000,  0.000000000000000,  -0.039809586420643, -0.085566283514199, 0.062074017423720,  0.098860402621402,  0.000000000000000,
        0.000000000000000,  0.078608184884069,  0.136100014916583,  0.000000000000000,  0.000000000000000,  0.098959502618370,  0.134142369813771,
        0.000000000000000,  0.000000000000000,  -0.012125364796319, -0.013451000889652, 0.000000000000000,  0.000000000000000,  -0.006891199090201,
        -0.036350822069841, 0.000000000000000,  -0.000000000000000, -0.059947676985589, -0.060917608044777, 0.000000000000000,  0.000000000000000,
        -0.011260665950665, 0.034050780050513,  0.000000000000000,  0.000000000000000,  0.004982053615478,  0.040228217595942,  0.000000000000000,
        0.000000000000000,  0.000016989221738,  -0.002206256214483, 0.000000000000000,  0.000000000000000,  0.094646299221541,  0.172133863066404,
        0.000000000000000,  0.000000000000000,  0.027002033195740,  0.063904921774158,  0.000000000000000,  0.000000000000000,  0.068506905359365,
        0.116623014771171,  0.000000000000000,  0.000000000000000,  -0.000261750287451, -0.001498886049631, 0.000000000000000,  0.000000000000000,
        0.034628781896075,  0.041635271351321,  0.000000000000000,  0.000000000000000,  -0.053990305388562, -0.090031352402973, 0.000000000000000,
        0.000000000000000,  -0.045014085982837, -0.053329404211732, -0.000000000000000, -0.000000000000000, 0.071805540335549,  0.141549622948232,
        0.000000000000000,  0.000000000000000,  0.049568389333506,  0.083456578698453,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 20, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.027105863183115,  0.068463290423165,  0.000000000000000,  0.000000000000000,  -0.008277759824048,
        -0.060754762921180, 0.000000000000000,  0.000000000000000,  0.024260204255808,  -0.006322053420843, 0.000000000000000,  0.000000000000000,
        -0.038745785268253, -0.013393829187340, 0.000000000000000,  0.000000000000000,  0.090602908756958,  0.079114914220859,  0.000000000000000,
        0.000000000000000,  -0.036722258786277, -0.040990760187880, 0.000000000000000,  0.000000000000000,  -0.060540202691430, -0.116255628597786,
        0.000000000000000,  0.000000000000000,  -0.015962909537912, 0.059948159331649,  0.000000000000000,  0.000000000000000,  0.012285521857643,
        0.060980966209979,  0.000000000000000,  0.000000000000000,  0.048435001418035,  0.132618996695887,  0.000000000000000,  0.000000000000000,
        0.012206574129761,  -0.037376841041048, 0.000000000000000,  0.000000000000000,  0.057495485121419,  0.060018609315355,  0.000000000000000,
        0.000000000000000,  -0.063209810144524, -0.058144112495005, 0.000000000000000,  0.000000000000000,  0.049764872041149,  0.069368894987488,
        0.000000000000000,  0.000000000000000,  -0.024798576888114, -0.027271832460873, 0.000000000000000,  0.000000000000000,  -0.040462789211362,
        -0.119012391282360, 0.000000000000000,  0.000000000000000,  0.000641248176836,  0.104137320306459,  0.000000000000000,  0.000000000000000,
        0.019177548138371,  0.091265227790619,  -0.052043200407844, -0.076250616262421, 0.000000000000000,  -0.000000000000000, 0.081315368368500,
        0.138312242144948,  0.000000000000000,  0.000000000000000,  0.005413747683072,  0.049218241887033,  -0.000000000000000, 0.000000000000000,
        0.038144198696720,  0.002241250590822,  0.000000000000000,  0.000000000000000,  0.039334954521979,  0.040071862948647,  0.000000000000000,
        0.000000000000000,  -0.025057856014389, -0.038910518904814, 0.000000000000000,  0.000000000000000,  0.059683637998080,  0.098376907678552,
        0.000000000000000,  -0.000000000000000, -0.084280496769284, -0.153214046975736, 0.000000000000000,  0.000000000000000,  -0.076815261496179,
        -0.119563167330096, -0.000000000000000, -0.000000000000000, -0.092620844528819, -0.164260519762604, 0.000000000000000,  -0.000000000000000,
        0.027204575436592,  0.064246694640900,  0.000000000000000,  0.000000000000000,  -0.046204861139151, -0.055489080709507, 0.000000000000000,
        0.000000000000000,  0.049990177187661,  0.062340398637919,  0.000000000000000,  0.000000000000000,  0.021818560768969,  0.034502017932311,
        0.000000000000000,  0.000000000000000,  -0.032750989443363, -0.061707931492751, 0.000000000000000,  0.000000000000000,  0.031975151271347,
        0.062488959416741,  0.000000000000000,  0.000000000000000,  -0.103952060163446, -0.204936055057853, 0.000000000000000,  0.000000000000000,
        -0.075332792769637, -0.140901546486100, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.032165230185030,
        -0.043532287470974, 0.000000000000000,  0.000000000000000,  -0.039260499766683, -0.019402313620727, 0.000000000000000,  0.000000000000000,
        -0.012577293179796, -0.026898749416162, 0.000000000000000,  0.000000000000000,  -0.030014871361395, -0.060305783305477, 0.000000000000000,
        0.000000000000000,  -0.037312959910503, -0.050707189522740, 0.000000000000000,  0.000000000000000,  -0.019308468575922, -0.092009931327616,
        0.000000000000000,  0.000000000000000,  0.031211861804351,  0.053665580029069,  0.000000000000000,  0.000000000000000,  -0.000110471002965,
        -0.013154931699330, 0.000000000000000,  0.000000000000000,  0.029607273286739,  0.021496899729925,  0.000000000000000,  0.000000000000000,
        -0.037996662251420, -0.065385502060590, 0.000000000000000,  0.000000000000000,  -0.039832346291469, -0.017871077187372, 0.000000000000000,
        0.000000000000000,  -0.010722128074436, -0.020274177580207, 0.000000000000000,  0.000000000000000,  -0.002510423418311, -0.007956555533386,
        0.000000000000000,  0.000000000000000,  -0.023009832454831, -0.016183044095145, 0.000000000000000,  0.000000000000000,  -0.030524896889535,
        -0.099256403012801, 0.000000000000000,  0.000000000000000,  0.025741020944309,  0.096531835455865,  0.000000000000000,  0.000000000000000,
        -0.004856844889392, -0.008951715060170, 0.000000000000000,  0.000000000000000,  0.030231095838002,  0.035546199922789,  0.077797268637808,
        0.085116719786470,  0.000000000000000,  0.000000000000000,  0.086554318062844,  0.069489838473611,  -0.000000000000000, -0.000000000000000,
        0.027210963545529,  0.038315248756212,  0.000000000000000,  0.000000000000000,  0.123469269046969,  0.163253110447631,  0.000000000000000,
        0.000000000000000,  0.006456713261696,  -0.013098489067666, 0.000000000000000,  0.000000000000000,  0.032836243773091,  0.049384772731707,
        -0.000000000000000, -0.000000000000000, -0.011176833288502, -0.053522065801374, 0.000000000000000,  0.000000000000000,  0.069433752806970,
        0.073578302621771,  -0.000000000000000, -0.000000000000000, -0.027143835323230, -0.021310922720850, 0.000000000000000,  0.000000000000000,
        0.053153696234639,  0.082507435871018,  0.000000000000000,  0.000000000000000,  0.026111321161822,  0.022198158600444,  0.000000000000000,
        0.000000000000000,  0.016308818663798,  0.034144359017378,  0.000000000000000,  0.000000000000000,  0.016221117633103,  0.033375240138450,
        0.000000000000000,  0.000000000000000,  -0.054630795392839, -0.110836248830120, 0.000000000000000,  0.000000000000000,  0.014799738023280,
        0.028194242465538,  -0.000000000000000, 0.000000000000000,  -0.076559418985970, -0.156090712260610, 0.000000000000000,  0.000000000000000,
        0.015099146959845,  0.014635224606547,  -0.000000000000000, 0.000000000000000,  -0.024692656498406, -0.035265972520398, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.030875929780353,  0.010897152271746,  0.000000000000000,  0.000000000000000,
        0.018149692321443,  -0.013315023188369, 0.000000000000000,  0.000000000000000,  0.037879451386945,  0.041755920165214,  0.000000000000000,
        0.000000000000000,  0.048718342208006,  -0.007986593759082, 0.000000000000000,  0.000000000000000,  -0.041901944888395, -0.030377713571956,
        0.000000000000000,  0.000000000000000,  -0.007692596372364, -0.008350309837537, 0.000000000000000,  0.000000000000000,  -0.044449977188293,
        -0.071864208617757, 0.000000000000000,  0.000000000000000,  0.012310312311057,  -0.029627143567776, 0.000000000000000,  0.000000000000000,
        -0.000622514975546, 0.000764808066906,  0.000000000000000,  0.000000000000000,  0.029997818824274,  0.024724345610635,  0.000000000000000,
        0.000000000000000,  0.013700729241206,  -0.008138498350529, 0.000000000000000,  0.000000000000000,  0.033012435167558,  0.045533102243464,
        0.000000000000000,  0.000000000000000,  0.037405783062439,  -0.040413589590598, 0.000000000000000,  0.000000000000000,  -0.008242147569820,
        0.005505449868686,  0.000000000000000,  0.000000000000000,  0.010720532349445,  0.012954471874963,  0.000000000000000,  0.000000000000000,
        -0.034785597252134, -0.062633297285340, 0.000000000000000,  0.000000000000000,  0.013534919744865,  -0.022643623834477, 0.000000000000000,
        0.000000000000000,  0.001471612954056,  0.002496964590922,  -0.050235014847573, -0.036625945518238, 0.000000000000000,  0.000000000000000,
        -0.000073177104824, 0.014602920875733,  0.000000000000000,  0.000000000000000,  0.000461792321670,  -0.012963653548417, 0.000000000000000,
        0.000000000000000,  -0.072957179546139, -0.007360221215465, 0.000000000000000,  0.000000000000000,  0.048828064455010,  0.113184165508799,
        -0.000000000000000, -0.000000000000000, -0.001690829040712, 0.031898720072493,  0.000000000000000,  0.000000000000000,  0.039637373061780,
        0.065254410389045,  -0.000000000000000, 0.000000000000000,  -0.071552931055355, -0.033463865649696, 0.000000000000000,  0.000000000000000,
        -0.021082126493986, -0.018674514835473, 0.000000000000000,  0.000000000000000,  -0.029839196395500, -0.040618731544319, 0.000000000000000,
        0.000000000000000,  -0.004855308915100, -0.001616701305194, 0.000000000000000,  0.000000000000000,  -0.009950956375082, -0.008522172505706,
        0.000000000000000,  0.000000000000000,  0.042545814572700,  0.118058438212179,  0.000000000000000,  0.000000000000000,  0.032686599740813,
        0.063001221176370,  -0.000000000000000, -0.000000000000000, 0.005003360969551,  0.022112171953995,  0.000000000000000,  0.000000000000000,
        0.014366472555872,  0.018540639032942,  0.000000000000000,  0.000000000000000,  -0.019627829574190, -0.018540107944472, 0.000000000000000,
        0.000000000000000,  -0.007278396122801, -0.010650638323456, 0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        -0.020958418001282, -0.019694418813302, 0.000000000000000,  0.000000000000000,  0.025211652289942,  0.013130543160126,  0.000000000000000,
        0.000000000000000,  -0.009247703477899, -0.042912367795758, 0.000000000000000,  0.000000000000000,  0.018278335453583,  0.018498067711900,
        0.000000000000000,  0.000000000000000,  0.007400170659329,  -0.028636508872788, 0.000000000000000,  0.000000000000000,  0.011893287941969,
        0.033917910054030,  0.000000000000000,  0.000000000000000,  -0.006968174792307, 0.000189416676426,  0.000000000000000,  0.000000000000000,
        -0.045203202986829, -0.020310701529192, 0.000000000000000,  0.000000000000000,  -0.046410622804144, -0.046474639547624, 0.000000000000000,
        0.000000000000000,  -0.021432780028986, -0.030330686679727, 0.000000000000000,  0.000000000000000,  0.024803110730905,  0.011674572640204,
        0.000000000000000,  0.000000000000000,  -0.016934423014528, -0.089982599825449, 0.000000000000000,  0.000000000000000,  0.015196320269609,
        0.032755522413158,  0.000000000000000,  0.000000000000000,  -0.014997662567128, -0.050619069407789, 0.000000000000000,  0.000000000000000,
        0.022152247378626,  0.060983695215943,  0.000000000000000,  0.000000000000000,  -0.001807935235597, 0.000790974317224,  0.000000000000000,
        0.000000000000000,  -0.039919624596286, -0.017881381172124, 0.000000000000000,  0.000000000000000,  -0.049550473210964, -0.071905773790538,
        0.004740938222549,  0.007722500973611,  0.000000000000000,  0.000000000000000,  -0.119657495433998, -0.093309032811553, 0.000000000000000,
        0.000000000000000,  -0.001360412303352, 0.043521105126932,  0.000000000000000,  0.000000000000000,  -0.015930691688947, -0.038637576560314,
        -0.000000000000000, -0.000000000000000, -0.038001321429209, -0.043103568011262, 0.000000000000000,  0.000000000000000,  0.062825636565503,
        0.094370258290055,  0.000000000000000,  0.000000000000000,  -0.028140120488673, 0.015379333953242,  0.000000000000000,  0.000000000000000,
        0.063904772985130,  0.057416586888110,  0.000000000000000,  0.000000000000000,  0.093729869461675,  0.093378162485867,  0.000000000000000,
        0.000000000000000,  0.016509638919866,  0.025175499704629,  0.000000000000000,  0.000000000000000,  -0.023972172489825, -0.020386769403462,
        0.000000000000000,  0.000000000000000,  0.076823003082473,  0.157145916954045,  0.000000000000000,  0.000000000000000,  -0.034140708276781,
        -0.059813707818434, -0.000000000000000, 0.000000000000000,  -0.004763527134777, -0.011429508486733, 0.000000000000000,  0.000000000000000,
        0.028597653140041,  0.052989439939831,  0.000000000000000,  0.000000000000000,  0.025646200739070,  0.051893762021414,  0.000000000000000,
        0.000000000000000,  0.024002161535041,  0.020710831697875,  -0.000000000000000, -0.000000000000000, 0.060907308208854,  0.091842082146324,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.014164145991368, -0.060977945901083, 0.000000000000000,
        0.000000000000000,  0.014476365085364,  -0.067592629724776, 0.000000000000000,  0.000000000000000,  0.054692641245263,  0.086154906763686,
        0.000000000000000,  0.000000000000000,  0.061677080739333,  0.026375717496957,  0.000000000000000,  0.000000000000000,  -0.019837189037652,
        -0.061633232533669, 0.000000000000000,  0.000000000000000,  -0.095652899212783, -0.089548128418567, 0.000000000000000,  0.000000000000000,
        0.005379544833397,  -0.016870115244171, 0.000000000000000,  0.000000000000000,  -0.014590638128258, -0.054636653585691, 0.000000000000000,
        0.000000000000000,  0.024280590046215,  0.069774603985881,  0.000000000000000,  0.000000000000000,  -0.020561843589904, -0.091715858063770,
        0.000000000000000,  0.000000000000000,  0.004343163880630,  -0.106355129017818, 0.000000000000000,  0.000000000000000,  0.057947530237484,
        0.111094556092853,  0.000000000000000,  0.000000000000000,  0.056305088398752,  0.033759346124600,  0.000000000000000,  0.000000000000000,
        0.011642116143725,  -0.026145143946156, 0.000000000000000,  0.000000000000000,  -0.061230954359805, -0.094850029910949, 0.000000000000000,
        0.000000000000000,  0.051280562095903,  0.052869643007508,  0.000000000000000,  0.000000000000000,  0.003387978127313,  -0.036923620500368,
        0.000000000000000,  0.000000000000000,  0.044752218006803,  0.131867410036624,  0.076501030258254,  0.118696092017014,  0.000000000000000,
        0.000000000000000,  0.068709978731274,  0.148729421200130,  0.000000000000000,  0.000000000000000,  -0.082194202529056, -0.092773145321728,
        0.000000000000000,  -0.000000000000000, 0.038265315401921,  0.070259066627135,  0.000000000000000,  0.000000000000000,  -0.019810692850903,
        0.004685351570965,  -0.000000000000000, 0.000000000000000,  -0.012125364796319, -0.013451000889652, 0.000000000000000,  0.000000000000000,
        -0.016808344539428, 0.034304268143262,  0.000000000000000,  0.000000000000000,  0.087600111013230,  0.135139581026042,  0.000000000000000,
        0.000000000000000,  -0.045905175472608, -0.074221255242512, -0.000000000000000, 0.000000000000000,  0.075871611902733,  0.141444127455324,
        0.000000000000000,  0.000000000000000,  0.096722363674833,  0.197061743733992,  0.000000000000000,  0.000000000000000,  -0.056889605057564,
        -0.090915672166734, 0.000000000000000,  0.000000000000000,  0.012549949638387,  0.039330091912732,  0.000000000000000,  0.000000000000000,
        -0.043588680804696, -0.057800785231975, 0.000000000000000,  0.000000000000000,  -0.000261750287451, -0.001498886049631, 0.000000000000000,
        0.000000000000000,  -0.052148287903199, -0.063287214216412, -0.000000000000000, 0.000000000000000,  0.033790506259237,  0.070998359835706,
        0.000000000000000,  0.000000000000000,  -0.089409894494948, -0.160636399770356, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 20, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.020958418001282, -0.019694418813302, 0.000000000000000,  0.000000000000000,  0.025211652289942,
        0.013130543160126,  0.000000000000000,  0.000000000000000,  -0.009247703477899, -0.042912367795758, 0.000000000000000,  0.000000000000000,
        0.018278335453583,  0.018498067711900,  0.000000000000000,  0.000000000000000,  0.007400170659329,  -0.028636508872788, 0.000000000000000,
        0.000000000000000,  0.011893287941969,  0.033917910054030,  0.000000000000000,  0.000000000000000,  -0.006968174792307, 0.000189416676426,
        0.000000000000000,  0.000000000000000,  -0.045203202986829, -0.020310701529192, 0.000000000000000,  0.000000000000000,  -0.046410622804144,
        -0.046474639547624, 0.000000000000000,  0.000000000000000,  -0.021432780028986, -0.030330686679727, 0.000000000000000,  0.000000000000000,
        0.024803110730905,  0.011674572640204,  0.000000000000000,  0.000000000000000,  -0.016934423014528, -0.089982599825449, 0.000000000000000,
        0.000000000000000,  0.015196320269609,  0.032755522413158,  0.000000000000000,  0.000000000000000,  -0.014997662567128, -0.050619069407789,
        0.000000000000000,  0.000000000000000,  0.022152247378626,  0.060983695215943,  0.000000000000000,  0.000000000000000,  -0.001807935235597,
        0.000790974317224,  0.000000000000000,  0.000000000000000,  -0.039919624596286, -0.017881381172124, 0.000000000000000,  0.000000000000000,
        -0.049550473210964, -0.071905773790538, -0.027235976382418, -0.042205547620635, 0.000000000000000,  0.000000000000000,  0.074572857442609,
        0.129508073941175,  0.000000000000000,  0.000000000000000,  0.032459011697665,  0.092430177029408,  0.000000000000000,  -0.000000000000000,
        0.005553018836758,  -0.036084524578110, -0.000000000000000, -0.000000000000000, 0.257561061290579,  0.269115532186872,  0.000000000000000,
        0.000000000000000,  -0.138796091841948, -0.186802319076212, -0.000000000000000, 0.000000000000000,  -0.034132959721139, -0.027635478188195,
        0.000000000000000,  0.000000000000000,  -0.130185816805935, -0.208629372529634, -0.000000000000000, 0.000000000000000,  -0.060677774358978,
        -0.097461959683367, -0.000000000000000, 0.000000000000000,  -0.009161420911478, -0.020220457786485, 0.000000000000000,  0.000000000000000,
        0.065649730674747,  0.128189119386003,  0.000000000000000,  0.000000000000000,  0.100762315324794,  0.198999658978287,  0.000000000000000,
        0.000000000000000,  -0.042436252519229, -0.078300437428929, -0.000000000000000, 0.000000000000000,  0.109490409846220,  0.172229045133518,
        0.000000000000000,  0.000000000000000,  -0.105542398548269, -0.180077149022758, 0.000000000000000,  0.000000000000000,  -0.006905291305441,
        -0.009814921199913, 0.000000000000000,  0.000000000000000,  -0.101316290330657, -0.196341106137485, 0.000000000000000,  0.000000000000000,
        -0.021636627439066, -0.047937182527025, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.047307511990538,
        0.045000542655383,  0.000000000000000,  0.000000000000000,  0.036931548861773,  0.031538056199198,  0.000000000000000,  0.000000000000000,
        0.019944676694659,  -0.007503591655389, 0.000000000000000,  0.000000000000000,  0.051295793596797,  -0.011640103778981, 0.000000000000000,
        0.000000000000000,  -0.006117186923242, 0.083813599927003,  0.000000000000000,  0.000000000000000,  0.009027321738178,  0.049537825678935,
        0.000000000000000,  0.000000000000000,  -0.004979459794564, 0.044626769043594,  0.000000000000000,  0.000000000000000,  0.048257515788403,
        0.057500307652532,  0.000000000000000,  0.000000000000000,  0.001171385724430,  0.005329065642238,  0.000000000000000,  0.000000000000000,
        0.032984808594685,  0.048902319896305,  0.000000000000000,  0.000000000000000,  0.009568683479081,  0.017820063843945,  0.000000000000000,
        0.000000000000000,  0.024696851385828,  0.008167413018048,  0.000000000000000,  0.000000000000000,  0.025633335452416,  -0.058432151421107,
        0.000000000000000,  0.000000000000000,  -0.017647106594449, 0.079804821829957,  0.000000000000000,  0.000000000000000,  -0.005196376243133,
        0.043677463430352,  0.000000000000000,  0.000000000000000,  -0.044652944455780, 0.008967953069141,  0.000000000000000,  0.000000000000000,
        0.015576964881586,  0.034114674751832,  0.000000000000000,  0.000000000000000,  0.002733865269542,  0.006405670560317,  0.026803281184129,
        0.025116647828080,  0.000000000000000,  -0.000000000000000, 0.041376612786179,  0.019182594133781,  0.000000000000000,  0.000000000000000,
        0.010672351214868,  0.033560927223012,  0.000000000000000,  0.000000000000000,  0.084380834831651,  0.137530380462073,  0.000000000000000,
        0.000000000000000,  -0.098083564230725, -0.215904376550813, -0.000000000000000, 0.000000000000000,  -0.018607830483919, -0.086981750445543,
        -0.000000000000000, 0.000000000000000,  0.021897966442587,  -0.077781313357689, -0.000000000000000, 0.000000000000000,  0.055114176728314,
        0.031047447499681,  -0.000000000000000, 0.000000000000000,  0.000710448305505,  0.002010431172330,  -0.000000000000000, 0.000000000000000,
        0.001742861868972,  0.001979414611573,  0.000000000000000,  0.000000000000000,  0.012719271946585,  0.011880042562630,  0.000000000000000,
        0.000000000000000,  0.007758247044832,  0.037666060789017,  0.000000000000000,  0.000000000000000,  0.109555337055332,  0.226223445813877,
        0.000000000000000,  0.000000000000000,  -0.090859054544708, -0.194131112708517, 0.000000000000000,  0.000000000000000,  -0.029407970615935,
        -0.064245169612751, 0.000000000000000,  0.000000000000000,  -0.015333512791516, -0.077000843952282, 0.000000000000000,  0.000000000000000,
        0.023372242745522,  0.022743116501221,  0.000000000000000,  0.000000000000000,  0.000209072314155,  0.000259281725916,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.023479458323327, -0.012102210485198, 0.000000000000000,  0.000000000000000,
        0.008194732101098,  0.000545346530285,  0.000000000000000,  0.000000000000000,  -0.014769681542122, -0.053491682944675, 0.000000000000000,
        0.000000000000000,  -0.035518521880216, -0.082795526115596, 0.000000000000000,  0.000000000000000,  0.029875731699226,  -0.054766900608825,
        0.000000000000000,  0.000000000000000,  -0.023679014586811, -0.055197017410398, 0.000000000000000,  0.000000000000000,  0.006154033975884,
        0.022288201226948,  0.000000000000000,  0.000000000000000,  -0.041884186294498, -0.002787326710346, 0.000000000000000,  0.000000000000000,
        -0.023283796170633, -0.012001358731154, 0.000000000000000,  0.000000000000000,  -0.013258676013490, -0.012499400226454, 0.000000000000000,
        0.000000000000000,  0.001531161813382,  -0.001914000521738, 0.000000000000000,  0.000000000000000,  -0.028371220563840, -0.060854758216030,
        0.000000000000000,  0.000000000000000,  0.009943977598945,  -0.057062824251821, 0.000000000000000,  0.000000000000000,  0.051435789786955,
        -0.075671776809219, 0.000000000000000,  0.000000000000000,  0.006629318399297,  -0.038041882834547, 0.000000000000000,  0.000000000000000,
        0.011821341901600,  0.025356149256679,  0.000000000000000,  0.000000000000000,  -0.007825938157288, 0.009782669333329,  0.000000000000000,
        0.000000000000000,  -0.013148187046711, -0.012395238557900, -0.014932360088195, -0.014332693736356, 0.000000000000000,  0.000000000000000,
        0.014628499040586,  0.012896583565561,  -0.000000000000000, 0.000000000000000,  0.090769175192124,  0.092351820628340,  0.000000000000000,
        0.000000000000000,  0.005983761120039,  0.103493837373484,  0.000000000000000,  0.000000000000000,  -0.023258749881839, 0.122219431606349,
        -0.000000000000000, -0.000000000000000, 0.003989174080026,  0.068995891582323,  0.000000000000000,  0.000000000000000,  -0.037820489663385,
        -0.038479925261808, 0.000000000000000,  0.000000000000000,  -0.074767883985215, -0.065915871557311, 0.000000000000000,  -0.000000000000000,
        -0.014807923754126, -0.014213254621886, 0.000000000000000,  0.000000000000000,  -0.001668413884967, -0.003066923951755, 0.000000000000000,
        0.000000000000000,  0.005367078544936,  0.008215027431409,  0.000000000000000,  0.000000000000000,  0.042919829943634,  0.073478048061017,
        0.000000000000000,  0.000000000000000,  0.042138201890574,  0.123384526586473,  0.000000000000000,  0.000000000000000,  0.088486780138123,
        0.221669279306935,  -0.000000000000000, -0.000000000000000, 0.028092134593716,  0.082256351057648,  0.000000000000000,  0.000000000000000,
        -0.017883262476514, -0.030615853358757, 0.000000000000000,  0.000000000000000,  -0.027431734785229, -0.041987917982759, 0.000000000000000,
        0.000000000000000,  -0.001654510435926, -0.003041366252157, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.018013645408913, -0.012569326226386, 0.000000000000000,  0.000000000000000,  -0.072149942699558, -0.068264229087765, 0.000000000000000,
        0.000000000000000,  0.010734280236278,  -0.036925680991169, 0.000000000000000,  0.000000000000000,  0.009027321738178,  0.049537825678935,
        0.000000000000000,  0.000000000000000,  -0.004078124615495, 0.055875733284669,  0.000000000000000,  0.000000000000000,  0.043773025481648,
        -0.052921625178093, 0.000000000000000,  0.000000000000000,  -0.009468850007431, -0.046864708367786, 0.000000000000000,  0.000000000000000,
        0.013238225508211,  0.020863834109259,  0.000000000000000,  0.000000000000000,  0.050749313802107,  0.046480126895360,  0.000000000000000,
        0.000000000000000,  -0.010483066342754, -0.012993414444054, 0.000000000000000,  0.000000000000000,  -0.019948488827271, -0.039235076215522,
        0.000000000000000,  0.000000000000000,  0.042897328907233,  -0.004071244008476, 0.000000000000000,  0.000000000000000,  -0.005196376243133,
        0.043677463430352,  0.000000000000000,  0.000000000000000,  -0.011764737729632, 0.053203214553305,  0.000000000000000,  0.000000000000000,
        0.029963648988360,  -0.094830037613067, 0.000000000000000,  0.000000000000000,  0.033669997522847,  -0.016860211069793, 0.000000000000000,
        0.000000000000000,  0.005233588899610,  0.012742332392453,  0.000000000000000,  0.000000000000000,  0.034568397423717,  0.050248559014924,
        -0.010155426187204, -0.008059686818343, 0.000000000000000,  0.000000000000000,  -0.081261924632761, -0.039917730589263, 0.000000000000000,
        0.000000000000000,  -0.013150314150690, 0.071449023544650,  0.000000000000000,  0.000000000000000,  -0.018607830483919, -0.086981750445543,
        -0.000000000000000, 0.000000000000000,  -0.065389042820483, -0.143936251033875, -0.000000000000000, -0.000000000000000, 0.099887360234917,
        0.210015172500025,  0.000000000000000,  0.000000000000000,  -0.034037871610386, 0.065925964045214,  0.000000000000000,  0.000000000000000,
        0.015446762780936,  0.010386230069945,  -0.000000000000000, 0.000000000000000,  0.028733410667492,  0.026352844124250,  -0.000000000000000,
        -0.000000000000000, -0.000483905642229, -0.000525933216651, 0.000000000000000,  0.000000000000000,  -0.027605384713736, -0.026156717477014,
        0.000000000000000,  0.000000000000000,  0.014480556893608,  0.072269670236415,  0.000000000000000,  0.000000000000000,  -0.029407970615935,
        -0.064245169612751, 0.000000000000000,  0.000000000000000,  -0.060572703029805, -0.129420741805678, -0.000000000000000, 0.000000000000000,
        0.134061979235278,  0.279761087157837,  0.000000000000000,  0.000000000000000,  0.012117799411918,  0.061847615336781,  0.000000000000000,
        0.000000000000000,  0.008521406161439,  0.008494888261635,  0.000000000000000,  -0.000000000000000, 0.001799025463654,  0.002033906205994,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.044822569268485,  0.046151292644094,  0.000000000000000,
        0.000000000000000,  0.033897363095819,  0.019369451752180,  0.000000000000000,  0.000000000000000,  -0.006968174792307, 0.000189416676426,
        0.000000000000000,  0.000000000000000,  -0.007236023370447, -0.035769152599884, 0.000000000000000,  0.000000000000000,  -0.003083404441387,
        0.011931878696995,  0.000000000000000,  0.000000000000000,  -0.005525461245306, 0.027959974057375,  0.000000000000000,  0.000000000000000,
        -0.023067916815975, -0.042536691387513, 0.000000000000000,  0.000000000000000,  0.027522058431824,  0.013322892360788,  0.000000000000000,
        0.000000000000000,  -0.017055412028980, -0.018899719599914, 0.000000000000000,  0.000000000000000,  0.048779551783487,  0.071543268922990,
        0.000000000000000,  0.000000000000000,  0.035763649661779,  0.017315727940187,  0.000000000000000,  0.000000000000000,  -0.001807935235597,
        0.000790974317224,  0.000000000000000,  0.000000000000000,  -0.021959577470890, -0.064538818694805, 0.000000000000000,  0.000000000000000,
        0.006249026069637,  0.021091278919912,  0.000000000000000,  0.000000000000000,  0.014211562963402,  0.050926153527341,  0.000000000000000,
        0.000000000000000,  -0.020520161231795, -0.088413834096289, 0.000000000000000,  0.000000000000000,  0.025652405441139,  0.011790166768004,
        0.000000000000000,  0.000000000000000,  -0.019538063718702, -0.029439747784243, 0.058763506559220,  0.095897678808665,  0.000000000000000,
        0.000000000000000,  0.102132127592380,  0.186636410514584,  0.000000000000000,  0.000000000000000,  -0.034132959721139, -0.027635478188195,
        0.000000000000000,  0.000000000000000,  0.182933777871074,  0.226604978738926,  0.000000000000000,  0.000000000000000,  -0.107317108871074,
        -0.112131471744530, 0.000000000000000,  0.000000000000000,  -0.220039598645440, -0.239520340631982, -0.000000000000000, -0.000000000000000,
        -0.035238025082594, 0.037619811956155,  0.000000000000000,  -0.000000000000000, 0.080305772156267,  0.134002448088304,  0.000000000000000,
        0.000000000000000,  -0.022531224000164, -0.038360968417712, 0.000000000000000,  0.000000000000000,  0.021493408447082,  0.047695512615326,
        0.000000000000000,  0.000000000000000,  0.096966312104589,  0.190130121640271,  0.000000000000000,  0.000000000000000,  -0.006905291305441,
        -0.009814921199913, 0.000000000000000,  0.000000000000000,  0.118108804479097,  0.198865096886568,  0.000000000000000,  0.000000000000000,
        -0.045621004102592, -0.071762102138966, 0.000000000000000,  0.000000000000000,  -0.106664549499015, -0.174327726510622, -0.000000000000000,
        0.000000000000000,  0.087066820902337,  0.179533398598459,  0.000000000000000,  0.000000000000000,  0.066538670948750,  0.129458365799169,
        0.000000000000000,  0.000000000000000,  -0.008809427374417, -0.019626498522829, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 20, 36));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeGDForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix dipxmat(36, 20);

    CDenseMatrix dipymat(36, 20);

    CDenseMatrix dipzmat(36, 20);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.002423744661024, 0.048823453100397,  0.000000000000000,  0.000000000000000,  0.050312451060217,
        0.028793039581950,  0.000000000000000,  0.000000000000000,  -0.002362314638000, 0.004277841420075,  0.000000000000000,  0.000000000000000,
        -0.067536539157996, -0.056560735650648, 0.000000000000000,  0.000000000000000,  0.062074017423720,  0.094646299221541,  0.000000000000000,
        0.000000000000000,  -0.003590453815938, 0.082566192590609,  0.000000000000000,  0.000000000000000,  0.049391750774510,  0.043265475230598,
        0.000000000000000,  0.000000000000000,  -0.005301233999473, 0.005018459211704,  0.000000000000000,  0.000000000000000,  -0.062748755370739,
        -0.083418076118000, 0.000000000000000,  0.000000000000000,  0.098860402621402,  0.172133863066404,  -0.020335313111331, -0.039534781315108,
        0.000000000000000,  0.000000000000000,  -0.020958418001282, -0.021432780028986, 0.000000000000000,  0.000000000000000,  -0.013259435939966,
        -0.010632957636088, -0.000000000000000, 0.000000000000000,  0.057479908351940,  0.059562441315555,  0.000000000000000,  0.000000000000000,
        -0.022153491864302, -0.040501244900358, 0.000000000000000,  0.000000000000000,  -0.034851824638179, -0.085637360948977, 0.000000000000000,
        0.000000000000000,  -0.019694418813302, -0.030330686679727, 0.000000000000000,  0.000000000000000,  -0.003613180091084, -0.007372724518857,
        0.000000000000000,  0.000000000000000,  0.048770297817213,  0.077701035785389,  0.000000000000000,  0.000000000000000,  -0.074774405154896,
        -0.132842477683072, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.007245522400306,  0.078039648756206,
        0.000000000000000,  0.000000000000000,  0.006377374726420,  -0.010169589174957, 0.000000000000000,  0.000000000000000,  0.029317838745428,
        0.014908842486646,  0.000000000000000,  0.000000000000000,  -0.092628655876374, -0.025370853379339, 0.000000000000000,  0.000000000000000,
        0.078608184884069,  0.027002033195740,  0.000000000000000,  0.000000000000000,  0.033838731270765,  0.147743963779775,  0.000000000000000,
        0.000000000000000,  -0.002537694622131, -0.009036594628056, 0.000000000000000,  0.000000000000000,  -0.007075114084893, 0.009865537049793,
        0.000000000000000,  0.000000000000000,  -0.080212823702070, -0.022198395473657, 0.000000000000000,  0.000000000000000,  0.136100014916583,
        0.063904921774158,  0.019971724704654,  -0.009818511786802, 0.000000000000000,  0.000000000000000,  0.025211652289942,  0.024803110730905,
        -0.000000000000000, 0.000000000000000,  -0.030800814832007, -0.024982748404054, 0.000000000000000,  0.000000000000000,  0.028534226424955,
        0.031694953032090,  0.000000000000000,  0.000000000000000,  -0.010523606671952, 0.011116326591500,  0.000000000000000,  0.000000000000000,
        -0.012992276859365, -0.074438772533442, 0.000000000000000,  0.000000000000000,  0.013130543160126,  0.011674572640204,  0.000000000000000,
        0.000000000000000,  0.031005198055533,  0.020802660643230,  0.000000000000000,  0.000000000000000,  0.019336589883634,  0.016760378693002,
        0.000000000000000,  0.000000000000000,  -0.061212044497504, -0.037889500341161, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.003664268046428,  -0.020554680045397, 0.000000000000000,  0.000000000000000,  0.018975573876342,  0.056524243620879,
        0.000000000000000,  0.000000000000000,  -0.030330435782329, -0.014495694557430, 0.000000000000000,  0.000000000000000,  0.019737089399448,
        0.018884197434113,  0.000000000000000,  0.000000000000000,  0.098959502618370,  0.068506905359365,  0.000000000000000,  0.000000000000000,
        0.021630893303017,  -0.025854792405547, 0.000000000000000,  0.000000000000000,  0.030836451933118,  0.115776967308462,  0.000000000000000,
        0.000000000000000,  -0.054683118835256, -0.017212012815776, 0.000000000000000,  0.000000000000000,  0.038630748997540,  0.038646403910807,
        0.000000000000000,  0.000000000000000,  0.134142369813771,  0.116623014771171,  0.009028183574898,  0.025465166631528,  0.000000000000000,
        0.000000000000000,  -0.009247703477899, -0.016934423014528, 0.000000000000000,  0.000000000000000,  0.047304407932629,  0.038185533136565,
        0.000000000000000,  0.000000000000000,  -0.026513642764410, -0.014337998545630, 0.000000000000000,  0.000000000000000,  -0.095459561980808,
        -0.080737439720822, 0.000000000000000,  0.000000000000000,  0.006327939865357,  0.040396322598993,  -0.000000000000000, 0.000000000000000,
        -0.042912367795758, -0.089982599825449, 0.000000000000000,  0.000000000000000,  0.069734132840080,  0.063940917919153,  0.000000000000000,
        0.000000000000000,  -0.026519916063309, -0.018692228945759, 0.000000000000000,  0.000000000000000,  -0.151386688671101, -0.174838771842395,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.025057856014389, -0.032750989443363, 0.000000000000000,
        0.000000000000000,  0.032836243773091,  0.014799738023280,  0.000000000000000,  0.000000000000000,  -0.001690829040712, 0.005003360969551,
        0.000000000000000,  0.000000000000000,  0.062825636565503,  0.028597653140041,  0.000000000000000,  0.000000000000000,  -0.012125364796319,
        -0.000261750287451, 0.000000000000000,  0.000000000000000,  -0.038910518904814, -0.061707931492751, 0.000000000000000,  0.000000000000000,
        0.049384772731707,  0.028194242465538,  0.000000000000000,  0.000000000000000,  0.031898720072493,  0.022112171953995,  0.000000000000000,
        0.000000000000000,  0.094370258290055,  0.052989439939831,  0.000000000000000,  0.000000000000000,  -0.013451000889652, -0.001498886049631,
        0.028590230371335,  0.017149707090124,  0.000000000000000,  0.000000000000000,  0.018278335453583,  0.015196320269609,  0.000000000000000,
        0.000000000000000,  -0.007692596372364, 0.010720532349444,  0.000000000000000,  0.000000000000000,  -0.044486918102289, -0.046429578360090,
        -0.000000000000000, 0.000000000000000,  0.061097074765486,  0.039444927187967,  0.000000000000000,  0.000000000000000,  0.028568799888118,
        0.045325585190646,  0.000000000000000,  0.000000000000000,  0.018498067711900,  0.032755522413158,  0.000000000000000,  0.000000000000000,
        -0.008350309837537, 0.012954471874963,  0.000000000000000,  0.000000000000000,  -0.131844088505244, -0.137034192922995, 0.000000000000000,
        0.000000000000000,  0.077394815763830,  0.079383772452698,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.028854940296764,  0.041082333192871,  0.000000000000000,  0.000000000000000,  -0.038001321429209, -0.004763527134777, 0.000000000000000,
        0.000000000000000,  0.032552042970007,  0.021791066493876,  0.000000000000000,  0.000000000000000,  0.038124481119370,  -0.050661189447191,
        0.000000000000000,  0.000000000000000,  -0.006891199090201, 0.034628781896075,  0.000000000000000,  0.000000000000000,  0.010266912889174,
        0.056405148693473,  0.000000000000000,  0.000000000000000,  -0.043103568011262, -0.011429508486733, 0.000000000000000,  0.000000000000000,
        0.075456110339199,  0.042000814117580,  0.000000000000000,  0.000000000000000,  0.022821150941719,  -0.101311658424509, 0.000000000000000,
        0.000000000000000,  -0.036350822069841, 0.041635271351321,  0.046621921521757,  0.008270827903686,  0.000000000000000,  0.000000000000000,
        0.007400170659329,  -0.014997662567128, 0.000000000000000,  0.000000000000000,  -0.027934629925597, -0.005494765046547, -0.000000000000000,
        -0.000000000000000, -0.043479768793277, -0.010511780315558, 0.000000000000000,  0.000000000000000,  -0.046296835050685, -0.052012397534509,
        0.000000000000000,  0.000000000000000,  0.074796110717735,  0.044123958992712,  0.000000000000000,  0.000000000000000,  -0.028636508872788,
        -0.050619069407789, 0.000000000000000,  0.000000000000000,  -0.020251809047970, 0.003670299912458,  -0.000000000000000, -0.000000000000000,
        -0.026843432128750, 0.025999513744679,  0.000000000000000,  0.000000000000000,  0.011837981280078,  -0.022522826361576, -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.013893469104083,  0.049466676612759,  0.000000000000000,  0.000000000000000,
        -0.010324766627555, -0.044813016310051, 0.000000000000000,  0.000000000000000,  -0.071548155345546, 0.038376347098074,  0.000000000000000,
        0.000000000000000,  0.091360359968556,  0.015079442492149,  0.000000000000000,  0.000000000000000,  -0.059947676985589, -0.053990305388562,
        0.000000000000000,  0.000000000000000,  -0.024660751188482, 0.059342626538658,  0.000000000000000,  0.000000000000000,  -0.037663265647977,
        -0.079022485486127, 0.000000000000000,  0.000000000000000,  -0.033942487942542, 0.099631628250516,  0.000000000000000,  0.000000000000000,
        0.122364139760083,  0.029382210919983,  0.000000000000000,  0.000000000000000,  -0.060917608044777, -0.090031352402973, -0.073301609715550,
        -0.084995837316362, 0.000000000000000,  0.000000000000000,  0.011893287941969,  0.022152247378626,  -0.000000000000000, 0.000000000000000,
        0.055128839184977,  0.028472006104569,  0.000000000000000,  0.000000000000000,  -0.030359391066534, -0.002101770962732, -0.000000000000000,
        0.000000000000000,  -0.014990666162748, 0.005447264709950,  0.000000000000000,  0.000000000000000,  -0.025547141842077, -0.073610369953256,
        0.000000000000000,  0.000000000000000,  0.033917910054030,  0.060983695215943,  0.000000000000000,  0.000000000000000,  -0.001028002227801,
        -0.051208982819734, 0.000000000000000,  0.000000000000000,  -0.036089983212865, 0.002595904041880,  -0.000000000000000, 0.000000000000000,
        -0.010150312901367, 0.021138354895508,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.113857258172334,
        -0.064790229134001, 0.000000000000000,  0.000000000000000,  0.020666246342592,  -0.023070821968756, 0.000000000000000,  0.000000000000000,
        -0.047106998217742, -0.009290488367119, 0.000000000000000,  0.000000000000000,  -0.008384855438572, 0.061895662278507,  0.000000000000000,
        0.000000000000000,  -0.011260665950665, -0.045014085982837, 0.000000000000000,  0.000000000000000,  -0.152582709686649, -0.113483932604041,
        0.000000000000000,  0.000000000000000,  -0.015063833711913, -0.047391717127984, 0.000000000000000,  0.000000000000000,  -0.066994699267784,
        -0.015312928726773, 0.000000000000000,  0.000000000000000,  0.021461233403977,  0.125761227707200,  0.000000000000000,  0.000000000000000,
        0.034050780050513,  -0.053329404211732, 0.077389703924233,  0.066878039452447,  0.000000000000000,  0.000000000000000,  -0.006968174792307,
        -0.001807935235597, 0.000000000000000,  0.000000000000000,  0.023290138693669,  0.015634985091575,  0.000000000000000,  0.000000000000000,
        -0.014923971827598, -0.015299301519281, 0.000000000000000,  0.000000000000000,  0.010731649151238,  0.047052198180019,  0.000000000000000,
        -0.000000000000000, 0.152229114371108,  0.170321649220424,  0.000000000000000,  0.000000000000000,  0.000189416676426,  0.000790974317224,
        0.000000000000000,  0.000000000000000,  0.052642974140011,  0.038849707892864,  0.000000000000000,  0.000000000000000,  -0.031407802745956,
        -0.080295832736712, 0.000000000000000,  0.000000000000000,  -0.021789385642034, 0.034862512282916,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.090307294497661, -0.033993048500089, 0.000000000000000,  0.000000000000000,  0.088563769320864,
        0.026702666966211,  0.000000000000000,  0.000000000000000,  -0.041956310312168, -0.009534971110249, 0.000000000000000,  0.000000000000000,
        -0.038387137315593, -0.018883760070316, 0.000000000000000,  0.000000000000000,  0.004982053615478,  0.071805540335549,  0.000000000000000,
        0.000000000000000,  -0.137351808254408, -0.071340132702448, 0.000000000000000,  0.000000000000000,  0.075176196533866,  0.022931518066976,
        0.000000000000000,  0.000000000000000,  -0.025598234027734, -0.010218984109084, 0.000000000000000,  0.000000000000000,  -0.018771933676316,
        -0.014634013921238, 0.000000000000000,  0.000000000000000,  0.040228217595942,  0.141549622948232,  0.012344791280355,  -0.004478225665574,
        0.000000000000000,  0.000000000000000,  -0.045203202986829, -0.039919624596286, -0.000000000000000, 0.000000000000000,  -0.000186722678500,
        0.002348299154177,  0.000000000000000,  0.000000000000000,  0.054933645860682,  0.046447965992886,  0.000000000000000,  -0.000000000000000,
        0.029524548212210,  0.000524967276368,  0.000000000000000,  0.000000000000000,  0.054179372009367,  0.036410961200255,  0.000000000000000,
        0.000000000000000,  -0.020310701529192, -0.017881381172124, 0.000000000000000,  0.000000000000000,  -0.011948452488010, -0.009964120181849,
        0.000000000000000,  0.000000000000000,  0.013490853022247,  0.014628618475837,  0.000000000000000,  -0.000000000000000, -0.018388998441333,
        -0.074136625506322, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.066341911168548, -0.097717332414101,
        0.000000000000000,  0.000000000000000,  0.047775402734614,  0.048520685692467,  0.000000000000000,  0.000000000000000,  -0.045444023527468,
        -0.029226017712531, 0.000000000000000,  0.000000000000000,  0.037319058724044,  0.021314009077531,  0.000000000000000,  0.000000000000000,
        0.000016989221738,  0.049568389333506,  0.000000000000000,  0.000000000000000,  -0.099361549848699, -0.175521885246366, 0.000000000000000,
        0.000000000000000,  0.051358750921935,  0.073600090019296,  0.000000000000000,  0.000000000000000,  -0.031726378754648, -0.039467766968718,
        0.000000000000000,  0.000000000000000,  0.043492487433117,  0.034362920942141,  0.000000000000000,  0.000000000000000,  -0.002206256214483,
        0.083456578698453,  0.026530203336763,  0.044937174870843,  -0.000000000000000, 0.000000000000000,  -0.046410622804144, -0.049550473210964,
        0.000000000000000,  0.000000000000000,  0.033712777371128,  0.031869986414237,  -0.000000000000000, -0.000000000000000, -0.004503550771221,
        -0.008845031599402, 0.000000000000000,  0.000000000000000,  -0.019928451326587, -0.039809586420643, 0.000000000000000,  0.000000000000000,
        0.073778983198199,  0.133948211060763,  0.000000000000000,  0.000000000000000,  -0.046474639547624, -0.071905773790538, 0.000000000000000,
        0.000000000000000,  0.011479231646871,  0.025720732061569,  0.000000000000000,  0.000000000000000,  -0.016302539469904, -0.023333295645697,
        0.000000000000000,  0.000000000000000,  -0.034383451758853, -0.085566283514199, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 36, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.052043200407844, -0.092620844528819, 0.000000000000000,  0.000000000000000,  0.077797268637808,
        0.053153696234639,  0.000000000000000,  0.000000000000000,  -0.050235014847573, -0.029839196395500, 0.000000000000000,  0.000000000000000,
        0.004740938222549,  0.016509638919866,  0.000000000000000,  0.000000000000000,  0.076501030258254,  0.075871611902733,  0.000000000000000,
        0.000000000000000,  -0.076250616262421, -0.164260519762604, 0.000000000000000,  0.000000000000000,  0.085116719786470,  0.082507435871018,
        0.000000000000000,  0.000000000000000,  -0.036625945518238, -0.040618731544319, 0.000000000000000,  0.000000000000000,  0.007722500973611,
        0.025175499704629,  0.000000000000000,  0.000000000000000,  0.118696092017014,  0.141444127455324,  0.027105863183115,  0.048435001418035,
        0.000000000000000,  0.000000000000000,  -0.032165230185030, -0.037996662251420, 0.000000000000000,  0.000000000000000,  0.030875929780353,
        0.029997818824274,  0.000000000000000,  0.000000000000000,  -0.020958418001282, -0.021432780028986, 0.000000000000000,  0.000000000000000,
        -0.014164145991368, -0.020561843589904, 0.000000000000000,  0.000000000000000,  0.068463290423165,  0.132618996695887,  -0.000000000000000,
        -0.000000000000000, -0.043532287470974, -0.065385502060590, 0.000000000000000,  0.000000000000000,  0.010897152271746,  0.024724345610635,
        0.000000000000000,  0.000000000000000,  -0.019694418813302, -0.030330686679727, 0.000000000000000,  0.000000000000000,  -0.060977945901083,
        -0.091715858063770, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.081315368368500,  0.027204575436592,
        0.000000000000000,  0.000000000000000,  0.086554318062844,  0.026111321161822,  0.000000000000000,  0.000000000000000,  -0.000073177104824,
        -0.004855308915100, 0.000000000000000,  0.000000000000000,  -0.119657495433998, -0.023972172489825, 0.000000000000000,  0.000000000000000,
        0.068709978731274,  0.096722363674833,  0.000000000000000,  0.000000000000000,  0.138312242144948,  0.064246694640900,  0.000000000000000,
        0.000000000000000,  0.069489838473611,  0.022198158600444,  0.000000000000000,  0.000000000000000,  0.014602920875733,  -0.001616701305194,
        0.000000000000000,  0.000000000000000,  -0.093309032811553, -0.020386769403462, 0.000000000000000,  0.000000000000000,  0.148729421200130,
        0.197061743733992,  -0.008277759824048, 0.012206574129761,  0.000000000000000,  0.000000000000000,  -0.039260499766683, -0.039832346291469,
        -0.000000000000000, 0.000000000000000,  0.018149692321443,  0.013700729241206,  0.000000000000000,  0.000000000000000,  0.025211652289942,
        0.024803110730905,  0.000000000000000,  0.000000000000000,  0.014476365085364,  0.004343163880630,  0.000000000000000,  0.000000000000000,
        -0.060754762921180, -0.037376841041048, 0.000000000000000,  0.000000000000000,  -0.019402313620727, -0.017871077187372, -0.000000000000000,
        0.000000000000000,  -0.013315023188369, -0.008138498350529, 0.000000000000000,  0.000000000000000,  0.013130543160126,  0.011674572640204,
        0.000000000000000,  0.000000000000000,  -0.067592629724776, -0.106355129017818, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.005413747683072,  -0.046204861139151, 0.000000000000000,  0.000000000000000,  0.027210963545529,  0.016308818663798,
        0.000000000000000,  0.000000000000000,  0.000461792321670,  -0.009950956375082, 0.000000000000000,  0.000000000000000,  -0.001360412303352,
        0.076823003082473,  0.000000000000000,  0.000000000000000,  -0.082194202529056, -0.056889605057564, 0.000000000000000,  0.000000000000000,
        0.049218241887033,  -0.055489080709507, 0.000000000000000,  0.000000000000000,  0.038315248756212,  0.034144359017378,  0.000000000000000,
        0.000000000000000,  -0.012963653548417, -0.008522172505706, 0.000000000000000,  0.000000000000000,  0.043521105126932,  0.157145916954045,
        0.000000000000000,  0.000000000000000,  -0.092773145321728, -0.090915672166734, 0.024260204255808,  0.057495485121419,  -0.000000000000000,
        0.000000000000000,  -0.012577293179796, -0.010722128074436, 0.000000000000000,  0.000000000000000,  0.037879451386945,  0.033012435167558,
        0.000000000000000,  0.000000000000000,  -0.009247703477899, -0.016934423014528, 0.000000000000000,  0.000000000000000,  0.054692641245263,
        0.057947530237484,  0.000000000000000,  0.000000000000000,  -0.006322053420843, 0.060018609315355,  0.000000000000000,  0.000000000000000,
        -0.026898749416162, -0.020274177580207, 0.000000000000000,  0.000000000000000,  0.041755920165214,  0.045533102243464,  0.000000000000000,
        0.000000000000000,  -0.042912367795758, -0.089982599825449, 0.000000000000000,  0.000000000000000,  0.086154906763686,  0.111094556092853,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.038144198696720,  0.049990177187661,  0.000000000000000,
        0.000000000000000,  0.123469269046969,  0.016221117633103,  0.000000000000000,  0.000000000000000,  -0.072957179546139, 0.042545814572700,
        0.000000000000000,  0.000000000000000,  -0.015930691688947, -0.034140708276781, 0.000000000000000,  0.000000000000000,  0.038265315401921,
        0.012549949638387,  0.000000000000000,  0.000000000000000,  0.002241250590822,  0.062340398637919,  0.000000000000000,  0.000000000000000,
        0.163253110447631,  0.033375240138450,  0.000000000000000,  0.000000000000000,  -0.007360221215465, 0.118058438212179,  0.000000000000000,
        0.000000000000000,  -0.038637576560314, -0.059813707818434, 0.000000000000000,  0.000000000000000,  0.070259066627135,  0.039330091912732,
        -0.038745785268253, -0.063209810144524, 0.000000000000000,  0.000000000000000,  -0.030014871361395, -0.002510423418311, 0.000000000000000,
        0.000000000000000,  0.048718342208006,  0.037405783062439,  0.000000000000000,  0.000000000000000,  0.018278335453583,  0.015196320269609,
        -0.000000000000000, -0.000000000000000, 0.061677080739333,  0.056305088398752,  0.000000000000000,  0.000000000000000,  -0.013393829187340,
        -0.058144112495005, 0.000000000000000,  0.000000000000000,  -0.060305783305477, -0.007956555533386, 0.000000000000000,  0.000000000000000,
        -0.007986593759082, -0.040413589590598, 0.000000000000000,  0.000000000000000,  0.018498067711900,  0.032755522413158,  -0.000000000000000,
        0.000000000000000,  0.026375717496957,  0.033759346124600,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.039334954521979,  0.021818560768969,  0.000000000000000,  0.000000000000000,  0.006456713261696,  -0.054630795392839, 0.000000000000000,
        0.000000000000000,  0.048828064455010,  0.032686599740813,  0.000000000000000,  0.000000000000000,  -0.038001321429209, -0.004763527134777,
        0.000000000000000,  0.000000000000000,  -0.019810692850903, -0.043588680804696, 0.000000000000000,  0.000000000000000,  0.040071862948647,
        0.034502017932311,  0.000000000000000,  0.000000000000000,  -0.013098489067666, -0.110836248830120, 0.000000000000000,  0.000000000000000,
        0.113184165508799,  0.063001221176370,  0.000000000000000,  0.000000000000000,  -0.043103568011262, -0.011429508486733, 0.000000000000000,
        0.000000000000000,  0.004685351570965,  -0.057800785231975, 0.090602908756958,  0.049764872041149,  0.000000000000000,  0.000000000000000,
        -0.037312959910503, -0.023009832454831, 0.000000000000000,  0.000000000000000,  -0.041901944888395, -0.008242147569820, -0.000000000000000,
        -0.000000000000000, 0.007400170659329,  -0.014997662567128, 0.000000000000000,  0.000000000000000,  -0.019837189037652, 0.011642116143725,
        -0.000000000000000, 0.000000000000000,  0.079114914220859,  0.069368894987488,  0.000000000000000,  0.000000000000000,  -0.050707189522740,
        -0.016183044095145, 0.000000000000000,  0.000000000000000,  -0.030377713571956, 0.005505449868686,  -0.000000000000000, -0.000000000000000,
        -0.028636508872788, -0.050619069407789, 0.000000000000000,  0.000000000000000,  -0.061633232533669, -0.026145143946156, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.025057856014389, -0.032750989443363, 0.000000000000000,  0.000000000000000,
        0.032836243773091,  0.014799738023280,  0.000000000000000,  0.000000000000000,  -0.001690829040712, 0.005003360969551,  0.000000000000000,
        0.000000000000000,  0.062825636565503,  0.028597653140041,  0.000000000000000,  0.000000000000000,  -0.012125364796319, -0.000261750287451,
        0.000000000000000,  0.000000000000000,  -0.038910518904814, -0.061707931492751, 0.000000000000000,  0.000000000000000,  0.049384772731707,
        0.028194242465538,  0.000000000000000,  0.000000000000000,  0.031898720072493,  0.022112171953995,  0.000000000000000,  0.000000000000000,
        0.094370258290055,  0.052989439939831,  0.000000000000000,  0.000000000000000,  -0.013451000889652, -0.001498886049631, -0.036722258786277,
        -0.024798576888114, 0.000000000000000,  0.000000000000000,  -0.019308468575922, -0.030524896889535, -0.000000000000000, -0.000000000000000,
        -0.007692596372364, 0.010720532349445,  0.000000000000000,  0.000000000000000,  0.011893287941969,  0.022152247378626,  0.000000000000000,
        0.000000000000000,  -0.095652899212783, -0.061230954359805, 0.000000000000000,  0.000000000000000,  -0.040990760187880, -0.027271832460873,
        0.000000000000000,  0.000000000000000,  -0.092009931327616, -0.099256403012801, -0.000000000000000, 0.000000000000000,  -0.008350309837537,
        0.012954471874963,  0.000000000000000,  0.000000000000000,  0.033917910054030,  0.060983695215943,  0.000000000000000,  0.000000000000000,
        -0.089548128418567, -0.094850029910949, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.059683637998080,
        0.031975151271347,  0.000000000000000,  0.000000000000000,  -0.011176833288502, -0.076559418985970, 0.000000000000000,  0.000000000000000,
        0.039637373061780,  0.014366472555872,  0.000000000000000,  0.000000000000000,  -0.028140120488673, 0.025646200739070,  0.000000000000000,
        0.000000000000000,  -0.016808344539428, -0.052148287903199, 0.000000000000000,  0.000000000000000,  0.098376907678552,  0.062488959416741,
        0.000000000000000,  0.000000000000000,  -0.053522065801374, -0.156090712260610, 0.000000000000000,  0.000000000000000,  0.065254410389045,
        0.018540639032942,  0.000000000000000,  0.000000000000000,  0.015379333953242,  0.051893762021414,  0.000000000000000,  0.000000000000000,
        0.034304268143262,  -0.063287214216412, -0.060540202691430, -0.040462789211362, 0.000000000000000,  0.000000000000000,  0.031211861804351,
        0.025741020944309,  0.000000000000000,  0.000000000000000,  -0.044449977188293, -0.034785597252134, -0.000000000000000, 0.000000000000000,
        -0.006968174792307, -0.001807935235597, 0.000000000000000,  0.000000000000000,  0.005379544833397,  0.051280562095903,  0.000000000000000,
        -0.000000000000000, -0.116255628597786, -0.119012391282360, -0.000000000000000, 0.000000000000000,  0.053665580029069,  0.096531835455865,
        0.000000000000000,  0.000000000000000,  -0.071864208617757, -0.062633297285340, 0.000000000000000,  0.000000000000000,  0.000189416676426,
        0.000790974317224,  0.000000000000000,  0.000000000000000,  -0.016870115244171, 0.052869643007508,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.084280496769284, -0.103952060163446, 0.000000000000000,  0.000000000000000,  0.069433752806970,
        0.015099146959845,  0.000000000000000,  0.000000000000000,  -0.071552931055355, -0.019627829574190, 0.000000000000000,  0.000000000000000,
        0.063904772985130,  0.024002161535041,  0.000000000000000,  0.000000000000000,  0.087600111013230,  0.033790506259237,  0.000000000000000,
        0.000000000000000,  -0.153214046975736, -0.204936055057853, 0.000000000000000,  0.000000000000000,  0.073578302621771,  0.014635224606547,
        0.000000000000000,  0.000000000000000,  -0.033463865649696, -0.018540107944472, 0.000000000000000,  0.000000000000000,  0.057416586888110,
        0.020710831697875,  0.000000000000000,  0.000000000000000,  0.135139581026042,  0.070998359835706,  -0.015962909537912, 0.000641248176836,
        0.000000000000000,  0.000000000000000,  -0.000110471002965, -0.004856844889392, -0.000000000000000, -0.000000000000000, 0.012310312311057,
        0.013534919744865,  0.000000000000000,  0.000000000000000,  -0.045203202986829, -0.039919624596286, 0.000000000000000,  -0.000000000000000,
        -0.014590638128258, 0.003387978127313,  0.000000000000000,  0.000000000000000,  0.059948159331649,  0.104137320306459,  0.000000000000000,
        0.000000000000000,  -0.013154931699330, -0.008951715060170, -0.000000000000000, 0.000000000000000,  -0.029627143567776, -0.022643623834477,
        0.000000000000000,  0.000000000000000,  -0.020310701529192, -0.017881381172124, 0.000000000000000,  -0.000000000000000, -0.054636653585691,
        -0.036923620500368, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.076815261496179, -0.075332792769637,
        0.000000000000000,  0.000000000000000,  -0.027143835323230, -0.024692656498406, 0.000000000000000,  0.000000000000000,  -0.021082126493986,
        -0.007278396122801, 0.000000000000000,  0.000000000000000,  0.093729869461675,  0.060907308208854,  0.000000000000000,  0.000000000000000,
        -0.045905175472608, -0.089409894494948, 0.000000000000000,  0.000000000000000,  -0.119563167330096, -0.140901546486100, 0.000000000000000,
        0.000000000000000,  -0.021310922720850, -0.035265972520398, 0.000000000000000,  0.000000000000000,  -0.018674514835473, -0.010650638323456,
        0.000000000000000,  0.000000000000000,  0.093378162485867,  0.091842082146324,  0.000000000000000,  0.000000000000000,  -0.074221255242512,
        -0.160636399770356, 0.012285521857643,  0.019177548138371,  -0.000000000000000, -0.000000000000000, 0.029607273286739,  0.030231095838002,
        0.000000000000000,  0.000000000000000,  -0.000622514975546, 0.001471612954056,  0.000000000000000,  0.000000000000000,  -0.046410622804144,
        -0.049550473210964, 0.000000000000000,  0.000000000000000,  0.024280590046215,  0.044752218006803,  -0.000000000000000, 0.000000000000000,
        0.060980966209979,  0.091265227790619,  -0.000000000000000, 0.000000000000000,  0.021496899729925,  0.035546199922789,  0.000000000000000,
        0.000000000000000,  0.000764808066906,  0.002496964590922,  0.000000000000000,  -0.000000000000000, -0.046474639547624, -0.071905773790538,
        0.000000000000000,  0.000000000000000,  0.069774603985881,  0.131867410036624,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 36, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.027235976382418, -0.009161420911478, 0.000000000000000,  0.000000000000000,  0.026803281184129,
        0.001742861868972,  0.000000000000000,  0.000000000000000,  -0.014932360088195, -0.001668413884967, 0.000000000000000,  0.000000000000000,
        -0.010155426187204, -0.000483905642229, 0.000000000000000,  0.000000000000000,  0.058763506559220,  0.021493408447082,  0.000000000000000,
        0.000000000000000,  -0.042205547620635, -0.020220457786485, 0.000000000000000,  0.000000000000000,  0.025116647828080,  0.001979414611573,
        0.000000000000000,  0.000000000000000,  -0.014332693736356, -0.003066923951755, 0.000000000000000,  0.000000000000000,  -0.008059686818343,
        -0.000525933216651, 0.000000000000000,  0.000000000000000,  0.095897678808665,  0.047695512615326,  -0.020958418001282, -0.021432780028986,
        0.000000000000000,  0.000000000000000,  0.047307511990538,  0.032984808594685,  0.000000000000000,  0.000000000000000,  -0.023479458323327,
        -0.013258676013490, 0.000000000000000,  0.000000000000000,  -0.018013645408913, -0.010483066342754, 0.000000000000000,  0.000000000000000,
        0.044822569268485,  0.048779551783487,  0.000000000000000,  0.000000000000000,  -0.019694418813302, -0.030330686679727, 0.000000000000000,
        0.000000000000000,  0.045000542655383,  0.048902319896305,  -0.000000000000000, 0.000000000000000,  -0.012102210485198, -0.012499400226454,
        0.000000000000000,  0.000000000000000,  -0.012569326226386, -0.012993414444054, 0.000000000000000,  0.000000000000000,  0.046151292644094,
        0.071543268922990,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.074572857442609,  0.065649730674747,
        0.000000000000000,  0.000000000000000,  0.041376612786179,  0.012719271946585,  0.000000000000000,  0.000000000000000,  0.014628499040586,
        0.005367078544936,  0.000000000000000,  0.000000000000000,  -0.081261924632761, -0.027605384713736, 0.000000000000000,  0.000000000000000,
        0.102132127592380,  0.096966312104589,  0.000000000000000,  0.000000000000000,  0.129508073941175,  0.128189119386003,  0.000000000000000,
        0.000000000000000,  0.019182594133781,  0.011880042562630,  0.000000000000000,  0.000000000000000,  0.012896583565561,  0.008215027431409,
        0.000000000000000,  0.000000000000000,  -0.039917730589263, -0.026156717477014, 0.000000000000000,  0.000000000000000,  0.186636410514584,
        0.190130121640271,  0.025211652289942,  0.024803110730905,  0.000000000000000,  0.000000000000000,  0.036931548861773,  0.009568683479081,
        0.000000000000000,  0.000000000000000,  0.008194732101098,  0.001531161813382,  -0.000000000000000, 0.000000000000000,  -0.072149942699558,
        -0.019948488827271, 0.000000000000000,  0.000000000000000,  0.033897363095819,  0.035763649661779,  0.000000000000000,  0.000000000000000,
        0.013130543160126,  0.011674572640204,  0.000000000000000,  0.000000000000000,  0.031538056199198,  0.017820063843945,  0.000000000000000,
        0.000000000000000,  0.000545346530285,  -0.001914000521738, 0.000000000000000,  0.000000000000000,  -0.068264229087765, -0.039235076215522,
        0.000000000000000,  0.000000000000000,  0.019369451752180,  0.017315727940187,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.032459011697665,  0.100762315324794,  0.000000000000000,  0.000000000000000,  0.010672351214868,  0.007758247044832,
        0.000000000000000,  0.000000000000000,  0.090769175192124,  0.042919829943634,  0.000000000000000,  0.000000000000000,  -0.013150314150690,
        0.014480556893608,  0.000000000000000,  0.000000000000000,  -0.034132959721139, -0.006905291305441, 0.000000000000000,  0.000000000000000,
        0.092430177029408,  0.198999658978287,  0.000000000000000,  0.000000000000000,  0.033560927223012,  0.037666060789017,  0.000000000000000,
        0.000000000000000,  0.092351820628340,  0.073478048061017,  0.000000000000000,  0.000000000000000,  0.071449023544650,  0.072269670236415,
        0.000000000000000,  0.000000000000000,  -0.027635478188195, -0.009814921199913, -0.009247703477899, -0.016934423014528, 0.000000000000000,
        0.000000000000000,  0.019944676694659,  0.024696851385828,  0.000000000000000,  0.000000000000000,  -0.014769681542122, -0.028371220563840,
        0.000000000000000,  0.000000000000000,  0.010734280236278,  0.042897328907233,  0.000000000000000,  0.000000000000000,  -0.006968174792307,
        -0.001807935235597, 0.000000000000000,  0.000000000000000,  -0.042912367795758, -0.089982599825449, -0.000000000000000, 0.000000000000000,
        -0.007503591655389, 0.008167413018048,  0.000000000000000,  0.000000000000000,  -0.053491682944675, -0.060854758216030, 0.000000000000000,
        0.000000000000000,  -0.036925680991169, -0.004071244008476, 0.000000000000000,  0.000000000000000,  0.000189416676426,  0.000790974317224,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.005553018836758,  -0.042436252519229, 0.000000000000000,
        0.000000000000000,  0.084380834831651,  0.109555337055332,  0.000000000000000,  0.000000000000000,  0.005983761120039,  0.042138201890574,
        0.000000000000000,  0.000000000000000,  -0.018607830483919, -0.029407970615935, 0.000000000000000,  0.000000000000000,  0.182933777871074,
        0.118108804479097,  0.000000000000000,  0.000000000000000,  -0.036084524578110, -0.078300437428929, 0.000000000000000,  0.000000000000000,
        0.137530380462073,  0.226223445813877,  0.000000000000000,  0.000000000000000,  0.103493837373484,  0.123384526586473,  0.000000000000000,
        0.000000000000000,  -0.086981750445543, -0.064245169612751, 0.000000000000000,  0.000000000000000,  0.226604978738926,  0.198865096886568,
        0.018278335453583,  0.015196320269609,  -0.000000000000000, -0.000000000000000, 0.051295793596797,  0.025633335452416,  0.000000000000000,
        0.000000000000000,  -0.035518521880216, 0.009943977598945,  0.000000000000000,  0.000000000000000,  0.009027321738178,  -0.005196376243133,
        -0.000000000000000, 0.000000000000000,  -0.007236023370447, -0.021959577470890, 0.000000000000000,  0.000000000000000,  0.018498067711900,
        0.032755522413158,  -0.000000000000000, 0.000000000000000,  -0.011640103778981, -0.058432151421107, 0.000000000000000,  0.000000000000000,
        -0.082795526115596, -0.057062824251821, 0.000000000000000,  0.000000000000000,  0.049537825678935,  0.043677463430352,  0.000000000000000,
        0.000000000000000,  -0.035769152599884, -0.064538818694805, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.257561061290579,  0.109490409846220,  0.000000000000000,  0.000000000000000,  -0.098083564230725, -0.090859054544708, 0.000000000000000,
        0.000000000000000,  -0.023258749881839, 0.088486780138123,  0.000000000000000,  0.000000000000000,  -0.065389042820483, -0.060572703029805,
        0.000000000000000,  0.000000000000000,  -0.107317108871074, -0.045621004102592, 0.000000000000000,  0.000000000000000,  0.269115532186872,
        0.172229045133518,  0.000000000000000,  0.000000000000000,  -0.215904376550813, -0.194131112708517, 0.000000000000000,  0.000000000000000,
        0.122219431606349,  0.221669279306935,  0.000000000000000,  0.000000000000000,  -0.143936251033875, -0.129420741805678, 0.000000000000000,
        0.000000000000000,  -0.112131471744530, -0.071762102138966, 0.007400170659329,  -0.014997662567128, 0.000000000000000,  0.000000000000000,
        -0.006117186923242, -0.017647106594449, -0.000000000000000, 0.000000000000000,  0.029875731699226,  0.051435789786955,  -0.000000000000000,
        -0.000000000000000, -0.004078124615495, -0.011764737729632, -0.000000000000000, -0.000000000000000, -0.003083404441387, 0.006249026069637,
        0.000000000000000,  0.000000000000000,  -0.028636508872788, -0.050619069407789, 0.000000000000000,  0.000000000000000,  0.083813599927003,
        0.079804821829957,  0.000000000000000,  0.000000000000000,  -0.054766900608825, -0.075671776809219, -0.000000000000000, -0.000000000000000,
        0.055875733284669,  0.053203214553305,  -0.000000000000000, 0.000000000000000,  0.011931878696995,  0.021091278919912,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.138796091841948, -0.105542398548269, 0.000000000000000,  0.000000000000000,
        -0.018607830483919, -0.029407970615935, 0.000000000000000,  0.000000000000000,  0.003989174080026,  0.028092134593716,  0.000000000000000,
        0.000000000000000,  0.099887360234917,  0.134061979235278,  0.000000000000000,  0.000000000000000,  -0.220039598645440, -0.106664549499015,
        0.000000000000000,  0.000000000000000,  -0.186802319076212, -0.180077149022758, 0.000000000000000,  0.000000000000000,  -0.086981750445543,
        -0.064245169612751, 0.000000000000000,  0.000000000000000,  0.068995891582323,  0.082256351057648,  0.000000000000000,  0.000000000000000,
        0.210015172500025,  0.279761087157837,  0.000000000000000,  0.000000000000000,  -0.239520340631982, -0.174327726510622, 0.011893287941969,
        0.022152247378626,  -0.000000000000000, 0.000000000000000,  0.009027321738178,  -0.005196376243133, -0.000000000000000, 0.000000000000000,
        -0.023679014586811, 0.006629318399297,  0.000000000000000,  0.000000000000000,  0.043773025481648,  0.029963648988360,  0.000000000000000,
        0.000000000000000,  -0.005525461245306, 0.014211562963402,  -0.000000000000000, -0.000000000000000, 0.033917910054030,  0.060983695215943,
        0.000000000000000,  0.000000000000000,  0.049537825678935,  0.043677463430352,  0.000000000000000,  0.000000000000000,  -0.055197017410398,
        -0.038041882834547, 0.000000000000000,  0.000000000000000,  -0.052921625178093, -0.094830037613067, 0.000000000000000,  0.000000000000000,
        0.027959974057375,  0.050926153527341,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.034132959721139,
        -0.006905291305441, 0.000000000000000,  0.000000000000000,  0.021897966442587,  -0.015333512791516, 0.000000000000000,  0.000000000000000,
        -0.037820489663385, -0.017883262476514, 0.000000000000000,  0.000000000000000,  -0.034037871610386, 0.012117799411918,  0.000000000000000,
        0.000000000000000,  -0.035238025082594, 0.087066820902337,  0.000000000000000,  0.000000000000000,  -0.027635478188195, -0.009814921199913,
        0.000000000000000,  0.000000000000000,  -0.077781313357689, -0.077000843952282, 0.000000000000000,  0.000000000000000,  -0.038479925261808,
        -0.030615853358757, 0.000000000000000,  0.000000000000000,  0.065925964045214,  0.061847615336781,  0.000000000000000,  0.000000000000000,
        0.037619811956155,  0.179533398598459,  -0.006968174792307, -0.001807935235597, 0.000000000000000,  0.000000000000000,  -0.004979459794564,
        -0.044652944455780, -0.000000000000000, 0.000000000000000,  0.006154033975884,  0.011821341901600,  0.000000000000000,  0.000000000000000,
        -0.009468850007431, 0.033669997522847,  0.000000000000000,  0.000000000000000,  -0.023067916815975, -0.020520161231795, 0.000000000000000,
        0.000000000000000,  0.000189416676426,  0.000790974317224,  0.000000000000000,  0.000000000000000,  0.044626769043594,  0.008967953069141,
        0.000000000000000,  0.000000000000000,  0.022288201226948,  0.025356149256679,  0.000000000000000,  0.000000000000000,  -0.046864708367786,
        -0.016860211069793, 0.000000000000000,  0.000000000000000,  -0.042536691387513, -0.088413834096289, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.130185816805935, -0.101316290330657, 0.000000000000000,  0.000000000000000,  0.055114176728314,
        0.023372242745522,  0.000000000000000,  0.000000000000000,  -0.074767883985215, -0.027431734785229, 0.000000000000000,  0.000000000000000,
        0.015446762780936,  0.008521406161439,  0.000000000000000,  0.000000000000000,  0.080305772156267,  0.066538670948750,  0.000000000000000,
        0.000000000000000,  -0.208629372529634, -0.196341106137485, 0.000000000000000,  0.000000000000000,  0.031047447499681,  0.022743116501221,
        0.000000000000000,  0.000000000000000,  -0.065915871557311, -0.041987917982759, 0.000000000000000,  0.000000000000000,  0.010386230069945,
        0.008494888261635,  0.000000000000000,  0.000000000000000,  0.134002448088304,  0.129458365799169,  -0.045203202986829, -0.039919624596286,
        -0.000000000000000, 0.000000000000000,  0.048257515788403,  0.015576964881586,  -0.000000000000000, 0.000000000000000,  -0.041884186294498,
        -0.007825938157288, 0.000000000000000,  0.000000000000000,  0.013238225508211,  0.005233588899610,  -0.000000000000000, 0.000000000000000,
        0.027522058431824,  0.025652405441139,  0.000000000000000,  0.000000000000000,  -0.020310701529192, -0.017881381172124, 0.000000000000000,
        0.000000000000000,  0.057500307652532,  0.034114674751832,  0.000000000000000,  0.000000000000000,  -0.002787326710346, 0.009782669333329,
        -0.000000000000000, 0.000000000000000,  0.020863834109259,  0.012742332392453,  0.000000000000000,  -0.000000000000000, 0.013322892360788,
        0.011790166768004,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.060677774358978, -0.021636627439066,
        0.000000000000000,  0.000000000000000,  0.000710448305505,  0.000209072314155,  0.000000000000000,  0.000000000000000,  -0.014807923754126,
        -0.001654510435926, 0.000000000000000,  0.000000000000000,  0.028733410667492,  0.001799025463654,  0.000000000000000,  0.000000000000000,
        -0.022531224000164, -0.008809427374417, 0.000000000000000,  0.000000000000000,  -0.097461959683367, -0.047937182527025, 0.000000000000000,
        0.000000000000000,  0.002010431172330,  0.000259281725916,  0.000000000000000,  0.000000000000000,  -0.014213254621886, -0.003041366252157,
        0.000000000000000,  0.000000000000000,  0.026352844124250,  0.002033906205994,  0.000000000000000,  0.000000000000000,  -0.038360968417712,
        -0.019626498522829, -0.046410622804144, -0.049550473210964, -0.000000000000000, 0.000000000000000,  0.001171385724430,  0.002733865269542,
        -0.000000000000000, 0.000000000000000,  -0.023283796170633, -0.013148187046711, 0.000000000000000,  -0.000000000000000, 0.050749313802107,
        0.034568397423717,  -0.000000000000000, -0.000000000000000, -0.017055412028980, -0.019538063718702, 0.000000000000000,  0.000000000000000,
        -0.046474639547624, -0.071905773790538, 0.000000000000000,  0.000000000000000,  0.005329065642238,  0.006405670560317,  0.000000000000000,
        0.000000000000000,  -0.012001358731154, -0.012395238557900, 0.000000000000000,  0.000000000000000,  0.046480126895360,  0.050248559014924,
        -0.000000000000000, 0.000000000000000,  -0.018899719599914, -0.029439747784243, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 36, 20));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeFGForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix dipxmat(28, 36);

    CDenseMatrix dipymat(28, 36);

    CDenseMatrix dipzmat(28, 36);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.494715444803513,  0.431238792133616,  -0.034947830800002, -0.017836433007569, 0.000000000000000,  0.000000000000000,  0.002673928607742,
        0.045962693893636,  -0.093492431192342, -0.081496471404959, -0.010720532789559, 0.060603926063488,  0.000000000000000,  0.000000000000000,
        0.044646339185393,  -0.005473008693396, 0.000000000000000,  0.000000000000000,  0.028044363580442,  0.073217665860932,  0.000000000000000,
        0.000000000000000,  -0.073564861778994, -0.087356247842029, 0.000000000000000,  0.000000000000000,  0.074088219827478,  0.047603326766092,
        0.000000000000000,  0.000000000000000,  -0.100818893643309, -0.223589305142768, 0.000000000000000,  0.000000000000000,  -0.018639352488908,
        -0.069585973499676, 0.544221966806461,  0.645497224367903,  -0.022841637094774, 0.015001677675688,  0.000000000000000,  0.000000000000000,
        -0.026315794462331, 0.016773890633335,  -0.102848284442025, -0.121987509118567, 0.000529222002081,  0.074754939591178,  0.000000000000000,
        0.000000000000000,  0.033221388341741,  0.001893379181288,  0.000000000000000,  0.000000000000000,  -0.010251773703136, 0.055403380164112,
        0.000000000000000,  0.000000000000000,  -0.045283598322451, -0.092930012712170, 0.000000000000000,  0.000000000000000,  0.089252878681758,
        0.088947003444385,  0.000000000000000,  0.000000000000000,  -0.121618698443083, -0.322542571430155, 0.000000000000000,  0.000000000000000,
        -0.004826470462147, -0.071340886232071, -0.021335746729385, -0.008587183934558, 0.451930321280195,  0.214253823347632,  -0.000302784616183,
        0.036978931189672,  0.000000000000000,  0.000000000000000,  -0.037337396690661, -0.014769246148921, -0.085406802859780, -0.040490166715900,
        -0.005432625748072, -0.020345806137225, 0.000000000000000,  0.000000000000000,  0.041311544515829,  0.072491204461080,  0.000000000000000,
        0.000000000000000,  0.001839217727911,  -0.016684125717344, 0.000000000000000,  0.000000000000000,  0.022246949469677,  -0.005495416738670,
        -0.000000000000000, 0.000000000000000,  -0.114058043657802, -0.173725566769075, 0.000000000000000,  0.000000000000000,  -0.057312747240216,
        -0.099098298208326, -0.000000000000000, 0.000000000000000,  0.045906156150225,  0.101645057888124,  0.364666511110126,  0.790569415042095,
        -0.028889461647259, -0.013695824350973, 0.000000000000000,  0.000000000000000,  -0.022709424873412, -0.020551114778647, -0.068915492847926,
        -0.149403576166799, 0.011203092881310,  0.007564420842833,  0.000000000000000,  0.000000000000000,  -0.022608781135932, -0.013088450183926,
        0.000000000000000,  0.000000000000000,  0.013239250674527,  0.009520070526636,  0.000000000000000,  0.000000000000000,  0.043230116224645,
        0.049355649553344,  0.000000000000000,  0.000000000000000,  -0.147297952687079, -0.261547956633592, 0.000000000000000,  0.000000000000000,
        -0.040142203665874, -0.090432403712045, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.033751354408634,
        -0.032519828329727, 0.428436142844360,  0.373463749085028,  0.022643405181961,  -0.001967974749312, 0.000000000000000,  0.000000000000000,
        0.000177480621022,  0.020688417301306,  -0.161933640948275, -0.141156029110973, 0.051640244964337,  0.109515602361902,  0.000000000000000,
        0.000000000000000,  -0.028023904936137, -0.094689312753705, 0.000000000000000,  0.000000000000000,  -0.042541151817797, -0.014638314426807,
        0.000000000000000,  0.000000000000000,  0.008358551303107,  -0.093742018826603, 0.000000000000000,  0.000000000000000,  0.013392313194043,
        0.013016943367158,  0.000000000000000,  0.000000000000000,  0.043704556808705,  0.067485394190462,  0.000000000000000,  0.000000000000000,
        -0.062606512422929, -0.082553705268262, 0.471310048551927,  0.559016994374947,  -0.007056560202653, -0.009982912198365, 0.000000000000000,
        0.000000000000000,  0.000257113166796,  0.016648447433247,  -0.178138454124882, -0.211288563682129, 0.046163568726528,  0.144038460243607,
        0.000000000000000,  0.000000000000000,  -0.033818619625147, -0.114258320945793, 0.000000000000000,  0.000000000000000,  -0.018662960216962,
        0.000303301783936,  0.000000000000000,  0.000000000000000,  -0.025744928001985, -0.158528920768124, 0.000000000000000,  0.000000000000000,
        -0.003666146435778, 0.004883038990963,  0.000000000000000,  0.000000000000000,  0.070907091480131,  0.129124963854380,  0.003450359072648,
        0.003637116771848,  0.000000000000000,  0.000000000000000,  -0.003047679219017, -0.018156543757536, 0.391383138969112,  0.185549253876993,
        0.013864023082145,  0.031355360771125,  0.000000000000000,  0.000000000000000,  0.038323933967631,  0.065217608471486,  -0.147928921865157,
        -0.070131025958873, -0.046913266595172, -0.051674752429148, 0.000000000000000,  0.000000000000000,  -0.057626824502913, -0.051905692416079,
        -0.000000000000000, 0.000000000000000,  0.017385430481581,  -0.029317942531814, 0.000000000000000,  0.000000000000000,  0.079711709734739,
        0.074945208632177,  -0.000000000000000, 0.000000000000000,  0.097776207566491,  0.113395341373300,  0.000000000000000,  0.000000000000000,
        -0.066082381155986, -0.097481270977697, 0.000000000000000,  0.000000000000000,  -0.025667775336285, -0.024266851035608, 0.315810462530809,
        0.684653196881458,  0.020309491376316,  0.048727683355705,  0.000000000000000,  0.000000000000000,  0.035022278454231,  0.067792535619239,
        -0.119365135041258, -0.258774584753383, -0.004745923376747, -0.017001711143435, 0.000000000000000,  0.000000000000000,  -0.012387337685470,
        -0.018054937065177, 0.000000000000000,  0.000000000000000,  -0.064077378535726, -0.129596939873091, 0.000000000000000,  0.000000000000000,
        0.010901194352771,  0.011717570917018,  0.000000000000000,  0.000000000000000,  0.131839879725760,  0.207228841749490,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.023848718085704, -0.008158498489910, 0.000000000000000,  0.000000000000000,
        -0.003923592718304, -0.037953433668130, 0.362094629004386,  0.315634476526075,  -0.037946766255821, -0.063532004871916, 0.000000000000000,
        0.000000000000000,  0.028096326369311,  0.009570055746818,  0.000000000000000,  0.000000000000000,  -0.034530235739213, -0.022707004663820,
        0.000000000000000,  0.000000000000000,  0.043761923376858,  0.021186737486302,  0.000000000000000,  0.000000000000000,  -0.003305013930871,
        0.000705731145842,  0.000000000000000,  0.000000000000000,  -0.001097312821695, 0.057439060231139,  0.000000000000000,  0.000000000000000,
        -0.051063707024740, -0.018912404695314, 0.000000000000000,  0.000000000000000,  -0.026245635737862, -0.019260219780235, 0.000000000000000,
        0.000000000000000,  -0.010035767028742, -0.060311185088314, 0.398329692829965,  0.472455591261534,  -0.060299904217735, -0.105022794240049,
        0.000000000000000,  0.000000000000000,  0.021195920847612,  0.006986247930522,  0.000000000000000,  0.000000000000000,  -0.020111563228597,
        -0.013652348945120, 0.000000000000000,  0.000000000000000,  0.028951600377292,  0.013077845289997,  0.000000000000000,  0.000000000000000,
        -0.002200758227945, -0.000568803853190, 0.000000000000000,  0.000000000000000,  0.012171714020184,  0.090764005608055,  0.000000000000000,
        0.000000000000000,  -0.059548566257628, -0.045158848669880, -0.060691847966162, -0.045967567298759, 0.000000000000000,  -0.000000000000000,
        -0.034835307959815, -0.034391018442251, 0.000000000000000,  0.000000000000000,  -0.069576893933128, -0.081814841056401, 0.330779125128747,
        0.156817741375842,  -0.028020101994232, -0.018784119825133, 0.000000000000000,  0.000000000000000,  -0.007625753378509, -0.024598381498307,
        -0.000000000000000, 0.000000000000000,  0.047083000292833,  0.030356422328503,  0.000000000000000,  0.000000000000000,  0.029908527135931,
        0.041708632637708,  -0.000000000000000, 0.000000000000000,  -0.023703688013482, 0.016115376726370,  0.000000000000000,  0.000000000000000,
        -0.043065437750142, -0.031244628572789, 0.000000000000000,  0.000000000000000,  -0.039090657392685, -0.052467988799579, 0.000000000000000,
        0.000000000000000,  -0.027159495113294, -0.052231461255113, 0.000000000000000,  0.000000000000000,  -0.088716187847725, -0.130799756977924,
        0.266908556095694,  0.578637562357845,  0.011673721137343,  0.030297540535280,  0.000000000000000,  0.000000000000000,  -0.008711983305891,
        -0.017392637755723, 0.000000000000000,  0.000000000000000,  -0.004105314264059, -0.018082196098626, 0.000000000000000,  0.000000000000000,
        0.016641835556382,  0.020371080152478,  0.000000000000000,  0.000000000000000,  0.035596316642496,  0.077891074948963,  0.000000000000000,
        0.000000000000000,  -0.058358874544614, -0.076995604880514, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.018514974994149, -0.002401056658398, 0.000000000000000,  0.000000000000000,  -0.010647832316476, 0.021065185958547,  0.000000000000000,
        0.000000000000000,  0.030876667232323,  -0.050470165294267, 0.000000000000000,  0.000000000000000,  0.018243987923074,  0.025359363004115,
        0.000000000000000,  0.000000000000000,  0.018208848579997,  0.048927999667206,  0.418110863055600,  0.364463299975712,  -0.048321177636366,
        -0.156123940807940, 0.000000000000000,  0.000000000000000,  0.013505567031196,  -0.041817547674362, 0.000000000000000,  0.000000000000000,
        -0.006806772184552, -0.007240393411728, 0.000000000000000,  0.000000000000000,  0.043555992115393,  0.006574292386472,  0.000000000000000,
        0.000000000000000,  -0.015982366342235, -0.006712474826651, 0.000000000000000,  0.000000000000000,  -0.007892094963960, 0.025714071756173,
        0.000000000000000,  0.000000000000000,  0.006799732122469,  -0.081578091549480, 0.000000000000000,  0.000000000000000,  0.023704824990072,
        0.026575247004303,  0.000000000000000,  0.000000000000000,  0.022241051252752,  0.056667642324281,  0.459951510763202,  0.545544725589981,
        -0.091012708246802, -0.233780898992203, 0.000000000000000,  0.000000000000000,  -0.004138108516256, -0.066203096243102, 0.000000000000000,
        -0.000000000000000, -0.002293589012980, -0.008928345150810, 0.000000000000000,  0.000000000000000,  0.045808294138989,  0.022348616088863,
        0.006226822401972,  0.008416963152032,  0.000000000000000,  0.000000000000000,  -0.008648122343253, 0.019563681343772,  -0.000000000000000,
        0.000000000000000,  0.023587389400676,  0.001436490189583,  0.000000000000000,  0.000000000000000,  0.014910799545433,  0.005544191282592,
        0.000000000000000,  0.000000000000000,  -0.020573072252485, 0.000087582439716,  0.000000000000000,  0.000000000000000,  -0.056750235231834,
        -0.126644270559264, 0.381950833870782,  0.181077530394103,  0.015899880954760,  -0.011358553086329, 0.000000000000000,  0.000000000000000,
        0.033415822459001,  0.008798361956615,  0.000000000000000,  -0.000000000000000, 0.056097230904225,  0.028461803337001,  0.000000000000000,
        0.000000000000000,  -0.005713304459682, -0.005666376232972, 0.000000000000000,  0.000000000000000,  0.009489774663486,  0.025612967375892,
        0.000000000000000,  0.000000000000000,  -0.010973888390781, -0.039167002479258, 0.000000000000000,  0.000000000000000,  0.002259371228639,
        0.004493094702254,  0.000000000000000,  0.000000000000000,  0.016746705167386,  0.050652282197960,  0.000000000000000,  0.000000000000000,
        -0.128411827154588, -0.209753758067023, 0.308199453421727,  0.668153104781061,  -0.021224533981068, -0.048174301599050, 0.000000000000000,
        0.000000000000000,  -0.003284769792770, -0.010974599342894, 0.000000000000000,  0.000000000000000,  0.040516342731176,  0.047981980063917,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.064054757343477,  0.016763935225230,  0.000000000000000,
        0.000000000000000,  -0.010116448298825, -0.051929916315396, 0.000000000000000,  0.000000000000000,  0.022843316399902,  0.026476839569296,
        0.000000000000000,  0.000000000000000,  -0.036451717965233, 0.059082608654843,  -0.323867281896550, -0.282312058221946, 0.046755017804910,
        0.172485844652492,  0.000000000000000,  0.000000000000000,  0.035773348603405,  0.074924486542112,  0.362094629004386,  0.315634476526075,
        -0.055396848189871, -0.072870266609103, 0.000000000000000,  0.000000000000000,  0.000943336521847,  -0.062288802828973, -0.000000000000000,
        -0.000000000000000, -0.002271980116452, -0.009348309097747, 0.000000000000000,  0.000000000000000,  0.073815179106429,  0.047626586126612,
        0.000000000000000,  0.000000000000000,  -0.017368420762658, -0.085463779638624, 0.000000000000000,  0.000000000000000,  0.015857068299858,
        0.025095685764046,  0.000000000000000,  0.000000000000000,  -0.000298105499920, 0.107690819524404,  -0.356276908249765, -0.422577127364258,
        0.094113601275742,  0.252314514194002,  0.000000000000000,  0.000000000000000,  0.035371630549376,  0.092002711690094,  0.398329692829965,
        0.472455591261534,  -0.072188835756411, -0.116844459222724, 0.000000000000000,  0.000000000000000,  -0.005121366894981, -0.085168716582132,
        -0.000000000000000, -0.000000000000000, -0.007251893348320, -0.015312215821863, 0.068272269615827,  0.040188660465564,  -0.000000000000000,
        0.000000000000000,  0.038437167541434,  -0.002107187689134, 0.000000000000000,  0.000000000000000,  -0.008843833739368, -0.010304794142671,
        0.000000000000000,  0.000000000000000,  -0.038813298807546, -0.011776734559167, 0.000000000000000,  0.000000000000000,  0.071232793077729,
        0.121045363827472,  -0.295857843730315, -0.140262051917746, -0.016931087085450, 0.022028043663880,  0.000000000000000,  0.000000000000000,
        -0.064025079793012, -0.084091358882565, 0.330779125128747,  0.156817741375842,  -0.017301619999180, -0.051140702203822, 0.000000000000000,
        0.000000000000000,  -0.047490739059142, -0.045480790942453, 0.000000000000000,  0.000000000000000,  0.071088577411739,  0.090522402773056,
        0.000000000000000,  0.000000000000000,  -0.034049395064280, -0.073878452530671, 0.000000000000000,  0.000000000000000,  -0.014085880235692,
        -0.017835987232742, 0.000000000000000,  0.000000000000000,  0.022970697615580,  0.059168973875171,  0.000000000000000,  0.000000000000000,
        0.110806126928741,  0.184302104316819,  -0.238730270082516, -0.517549169506766, 0.033714844281603,  0.081474675044878,  0.000000000000000,
        0.000000000000000,  -0.090542159247788, -0.130295736124472, 0.266908556095694,  0.578637562357845,  -0.029063815711483, -0.063875883861724,
        0.000000000000000,  0.000000000000000,  -0.027637142134690, -0.040949172817393, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.036134966639071, -0.068298788384426, 0.000000000000000,  0.000000000000000,  -0.011758940667403, -0.014792097626373,
        0.000000000000000,  0.000000000000000,  -0.023870345573030, 0.090243250023072,  0.000000000000000,  0.000000000000000,  -0.006221819165921,
        -0.041583681242273, 0.000000000000000,  0.000000000000000,  -0.046009121957752, -0.054116025883241, -0.161933640948275, -0.141156029110973,
        0.045618493698025,  0.134773530762473,  0.000000000000000,  0.000000000000000,  0.010592025520659,  0.036213940439666,  0.428436142844360,
        0.373463749085029,  0.032836923051625,  -0.003366210434615, 0.000000000000000,  0.000000000000000,  -0.033045753846530, -0.032115445688012,
        0.000000000000000,  0.000000000000000,  -0.063787646997150, -0.128059046054536, 0.000000000000000,  0.000000000000000,  0.008846294678315,
        -0.005081324453272, 0.000000000000000,  0.000000000000000,  0.018047668764264,  0.154276416228255,  0.000000000000000,  0.000000000000000,
        -0.021349054594251, -0.059968765535583, 0.000000000000000,  0.000000000000000,  -0.023432428536602, -0.057353384530432, -0.178138454124882,
        -0.211288563682129, 0.056114512905654,  0.173920656136078,  0.000000000000000,  0.000000000000000,  0.017142727714449,  0.037342712120101,
        0.471310048551927,  0.559016994374948,  0.000995211375356,  -0.009942391551126, 0.000000000000000,  0.000000000000000,  -0.063047560795088,
        -0.082485187210992, -0.090525253476168, -0.112780241716181, 0.000000000000000,  0.000000000000000,  -0.066820495791649, -0.074310910832008,
        0.000000000000000,  0.000000000000000,  -0.013487073868796, 0.029353514811387,  0.000000000000000,  0.000000000000000,  0.001111636141510,
        -0.001115109076354, 0.000000000000000,  0.000000000000000,  -0.046837417856322, -0.054164890728044, 0.000000000000000,  0.000000000000000,
        0.065003037583470,  0.084168718528269,  -0.147928921865158, -0.070131025958873, 0.038101189817858,  0.043505709051846,  0.000000000000000,
        0.000000000000000,  0.000505038990444,  -0.021716445392459, 0.391383138969112,  0.185549253876993,  -0.000479980639270, 0.002064830317401,
        0.000000000000000,  0.000000000000000,  -0.127598316774956, -0.203228794056351, 0.000000000000000,  0.000000000000000,  -0.008338896468671,
        -0.010496342303684, 0.000000000000000,  0.000000000000000,  0.061326623245851,  0.125807548280398,  0.000000000000000,  0.000000000000000,
        -0.001330582136318, -0.002056242783377, 0.000000000000000,  0.000000000000000,  -0.012446533626182, -0.027524605048016, 0.000000000000000,
        0.000000000000000,  0.036990272029348,  0.070380443382959,  -0.119365135041258, -0.258774584753383, 0.028780204955442,  0.059912980044863,
        0.000000000000000,  0.000000000000000,  -0.023359163042055, -0.023249434537653, 0.315810462530809,  0.684653196881458,  -0.067107471072626,
        -0.098532499897552, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.019551874176466,  0.069342138573417,
        0.000000000000000,  0.000000000000000,  0.100888685702720,  0.219268534919049,  0.000000000000000,  0.000000000000000,  -0.086156407940066,
        -0.059877178940155, 0.000000000000000,  0.000000000000000,  0.054250803479376,  0.092310142214205,  0.000000000000000,  0.000000000000000,
        -0.058258664672375, -0.043276508384589, 0.000000000000000,  0.000000000000000,  0.010697821398850,  -0.056192627734522, -0.093492431192343,
        -0.081496471404959, -0.010317052292961, 0.050215578398480,  0.000000000000000,  0.000000000000000,  0.005260611869152,  0.047120670439903,
        0.494715444803513,  0.431238792133616,  -0.035623410908244, -0.017071453537842, 0.000000000000000,  0.000000000000000,  0.005652418794906,
        0.071330159590407,  0.000000000000000,  0.000000000000000,  0.125421012182617,  0.320329518509941,  0.000000000000000,  0.000000000000000,
        -0.086991573021610, -0.096552233696956, 0.000000000000000,  0.000000000000000,  0.028404530521267,  0.093179476187347,  0.000000000000000,
        -0.000000000000000, -0.028814210476925, -0.041881219170279, 0.000000000000000,  0.000000000000000,  0.040053526893175,  -0.034061143901628,
        -0.102848284442025, -0.121987509118567, 0.009164156879303,  0.069530104738486,  0.000000000000000,  0.000000000000000,  -0.025922127623913,
        0.017556780649952,  0.544221966806461,  0.645497224367903,  -0.024166217757147, 0.015227262642676,  0.057066569694361,  0.098469335167907,
        0.000000000000000,  0.000000000000000,  0.113123964219704,  0.168215829316457,  0.000000000000000,  0.000000000000000,  -0.021778187585813,
        -0.003644975473788, 0.000000000000000,  0.000000000000000,  0.020702837478400,  0.040918294528214,  0.000000000000000,  0.000000000000000,
        0.004237459390818,  -0.006610002666216, 0.000000000000000,  -0.000000000000000, -0.026353845393074, -0.066096894749160, 0.000000000000000,
        0.000000000000000,  -0.048234747202092, -0.031482283250341, -0.085406802859780, -0.040490166715900, -0.002939266038326, 0.036434498594098,
        0.000000000000000,  0.000000000000000,  -0.022434285228010, -0.008047816631665, 0.451930321280195,  0.214253823347632,  0.040484184919198,
        0.090691859065614,  0.000000000000000,  0.000000000000000,  0.149991694665926,  0.263354906776359,  0.000000000000000,  0.000000000000000,
        -0.036628763443571, -0.044029007996616, 0.000000000000000,  0.000000000000000,  -0.016166185357781, -0.009659668099973, 0.000000000000000,
        0.000000000000000,  0.008148423978629,  0.007087609827797,  -0.000000000000000, 0.000000000000000,  0.030958479926698,  0.020948887318230,
        0.000000000000000,  0.000000000000000,  -0.016843321171865, -0.016507007319021, -0.068915492847926, -0.149403576166799, -0.029622736287414,
        -0.014335051372784, 0.000000000000000,  0.000000000000000,  0.044955519202105,  0.100844722914658,  0.364666511110126,  0.790569415042096};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 28, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.018912053726797,  0.069274488611740,  0.000000000000000,  0.000000000000000,  0.004435307700239,
        0.067488200210757,  0.000000000000000,  0.000000000000000,  0.077674673771818,  0.048120293312605,  0.000000000000000,  0.000000000000000,
        0.056961219069929,  0.087428781507514,  -0.000000000000000, -0.000000000000000, 0.007330069865878,  -0.025293921810685, 0.000000000000000,
        0.000000000000000,  -0.119164128392150, -0.108657198600586, -0.093492431192343, -0.081496471404959, 0.047637009063405,  0.093728558527104,
        0.000000000000000,  0.000000000000000,  0.066245107093654,  0.147956764770007,  -0.494715444803513, -0.431238792133616, 0.019040173929188,
        -0.040049714237843, 0.000000000000000,  0.000000000000000,  0.005364434761655,  0.071248823366875,  0.000000000000000,  0.000000000000000,
        -0.037975163960550, 0.024444372797283,  0.000000000000000,  0.000000000000000,  0.091106093905592,  0.089618720576963,  0.000000000000000,
        0.000000000000000,  0.023409505235262,  0.084340503791496,  -0.000000000000000, 0.000000000000000,  0.017779968925851,  -0.015410440296993,
        0.000000000000000,  0.000000000000000,  -0.071532129332801, -0.116806243352556, -0.102848284442025, -0.121987509118567, 0.078044643421767,
        0.145170554556078,  0.000000000000000,  0.000000000000000,  0.081515329744440,  0.214391779560141,  -0.544221966806461, -0.645497224367903,
        0.018477843188087,  -0.074447266118618, 0.057762088330953,  0.098880239745215,  0.000000000000000,  0.000000000000000,  -0.001213109144678,
        0.053300959457492,  0.000000000000000,  0.000000000000000,  0.018952979858562,  -0.007712852638788, -0.000000000000000, -0.000000000000000,
        0.004810648493911,  0.033313732890579,  0.000000000000000,  0.000000000000000,  -0.025971082026348, -0.039837993639575, 0.000000000000000,
        0.000000000000000,  -0.005432625748072, -0.020345806137225, 0.000000000000000,  0.000000000000000,  -0.021795253913731, -0.026803442887593,
        -0.085406802859780, -0.040490166715900, 0.076892026463351,  0.115175136862328,  0.000000000000000,  0.000000000000000,  -0.026328122334887,
        -0.073736101897765, -0.451930321280195, -0.214253823347632, 0.040529151560973,  0.090758269814034,  0.000000000000000,  0.000000000000000,
        -0.042428308618464, -0.019958746811904, 0.000000000000000,  0.000000000000000,  0.043032911328578,  0.048996703996235,  -0.000000000000000,
        0.000000000000000,  -0.021047771408305, -0.014963968283940, 0.000000000000000,  0.000000000000000,  0.009939622533261,  0.004786348511566,
        -0.000000000000000, -0.000000000000000, 0.011203092881310,  0.007564420842833,  0.000000000000000,  0.000000000000000,  0.016915888307643,
        0.023285457733459,  -0.068915492847926, -0.149403576166799, 0.098890438162571,  0.174885087283434,  0.000000000000000,  0.000000000000000,
        -0.079500861023815, -0.177114056460358, -0.364666511110126, -0.790569415042096, 0.000000000000000,  0.000000000000000,  0.044710575148964,
        0.062862888448076,  0.000000000000000,  0.000000000000000,  -0.009273358714930, -0.014687115302641, 0.000000000000000,  0.000000000000000,
        0.014356566430291,  0.041407756876963,  0.000000000000000,  0.000000000000000,  -0.023838437609848, -0.015939211613876, 0.000000000000000,
        0.000000000000000,  0.002337795683853,  -0.070057118209569, -0.161933640948275, -0.141156029110973, 0.049032296682626,  0.144710710558408,
        0.000000000000000,  0.000000000000000,  -0.008403885374886, 0.068993017847872,  -0.428436142844360, -0.373463749085028, -0.018272604084236,
        0.013297057012566,  0.000000000000000,  0.000000000000000,  0.019768368254860,  0.055211173620262,  0.000000000000000,  0.000000000000000,
        0.076508830078443,  0.127843612237511,  0.000000000000000,  0.000000000000000,  0.009691309609390,  -0.005012572207547, 0.000000000000000,
        0.000000000000000,  0.013777784429334,  0.038579224644030,  0.000000000000000,  0.000000000000000,  -0.013890845192905, -0.003262321408456,
        0.000000000000000,  0.000000000000000,  -0.021863683247659, -0.090648236604962, -0.178138454124882, -0.211288563682129, 0.061966066295047,
        0.195498107853423,  0.000000000000000,  0.000000000000000,  0.022105101550607,  0.114572232808933,  -0.471310048551927, -0.559016994374947,
        -0.000233775025729, 0.013965755879779,  0.000000000000000,  0.000000000000000,  0.029996006603913,  0.087978922199114,  0.076994670542889,
        0.087173633109954,  0.000000000000000,  0.000000000000000,  -0.069496636364891, -0.075525301251613, 0.000000000000000,  0.000000000000000,
        0.031922823750957,  0.053650286001555,  0.000000000000000,  0.000000000000000,  -0.059850096785934, -0.049675474263371, -0.000000000000000,
        -0.000000000000000, -0.019304813530469, -0.019284407433320, 0.000000000000000,  0.000000000000000,  0.038323933967631,  0.065217608471486,
        -0.147928921865158, -0.070131025958873, 0.003666998561137,  0.026145932795240,  0.000000000000000,  0.000000000000000,  0.070679994403983,
        0.083331236654928,  -0.391383138969112, -0.185549253876993, 0.112377144485169,  0.136062875726909,  0.000000000000000,  0.000000000000000,
        0.125051162801606,  0.193933179374156,  0.000000000000000,  0.000000000000000,  -0.008406251187698, -0.010552478277250, 0.000000000000000,
        0.000000000000000,  0.036580875703482,  0.081253442203469,  0.000000000000000,  0.000000000000000,  -0.009726173412835, -0.013942451498423,
        -0.000000000000000, 0.000000000000000,  0.003976500857823,  0.001119472790833,  0.000000000000000,  0.000000000000000,  0.035022278454231,
        0.067792535619239,  -0.119365135041258, -0.258774584753383, 0.045803934110137,  0.090386686883472,  0.000000000000000,  0.000000000000000,
        0.033850019523020,  0.033660615247382,  -0.315810462530809, -0.684653196881458, 0.101401622030891,  0.166354550249061,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.033031805460020, -0.020515413503238, 0.000000000000000,  0.000000000000000,
        0.009066736487492,  0.061390157438270,  0.000000000000000,  0.000000000000000,  0.029453344261644,  0.025065377277612,  0.000000000000000,
        0.000000000000000,  0.052042589082216,  0.105555075947093,  -0.323867281896550, -0.282312058221946, 0.017979821355566,  0.153563340765975,
        0.000000000000000,  0.000000000000000,  -0.025379434525416, 0.034833969859178,  -0.362094629004386, -0.315634476526075, 0.033606572914227,
        0.051394342922891,  0.000000000000000,  0.000000000000000,  0.004421857180524,  0.013936459312063,  -0.000000000000000, -0.000000000000000,
        0.033036407400880,  0.005628093138722,  0.000000000000000,  0.000000000000000,  -0.042472175818134, -0.041820911954152, 0.000000000000000,
        0.000000000000000,  0.015798166786368,  0.095154256698391,  0.000000000000000,  0.000000000000000,  0.020258584755748,  0.026233293470426,
        0.000000000000000,  0.000000000000000,  0.055899726718189,  0.135405594140927,  -0.356276908249765, -0.422577127364258, 0.077353965251912,
        0.240937556739735,  0.000000000000000,  0.000000000000000,  0.001696116929470,  0.070061564086794,  -0.398329692829965, -0.472455591261534,
        0.057140646983243,  0.095457384541693,  0.000000000000000,  0.000000000000000,  0.013147109440466,  0.035639611609990,  -0.000000000000000,
        -0.000000000000000, 0.038333704942547,  0.021069509376219,  -0.090360957946555, -0.077474464726953, 0.000000000000000,  0.000000000000000,
        -0.026430362089273, 0.017638338487348,  0.000000000000000,  0.000000000000000,  -0.019018108098196, -0.017979408258720, 0.000000000000000,
        0.000000000000000,  -0.028613484811977, 0.016642620317288,  0.000000000000000,  0.000000000000000,  0.064877998595637,  0.100546712578883,
        -0.295857843730315, -0.140262051917746, -0.028020101994232, -0.018784119825133, 0.000000000000000,  0.000000000000000,  0.075634222225331,
        0.095876443216478,  -0.330779125128747, -0.156817741375842, -0.044066496756308, -0.028240735209270, 0.000000000000000,  0.000000000000000,
        0.025586123131171,  0.008505701716576,  0.000000000000000,  0.000000000000000,  -0.067780718642850, -0.094315223034034, 0.000000000000000,
        0.000000000000000,  0.036067985071966,  0.078668110261862,  0.000000000000000,  0.000000000000000,  -0.013545532295023, -0.018943899353458,
        0.000000000000000,  0.000000000000000,  0.045112150512839,  0.108489349495066,  0.000000000000000,  0.000000000000000,  0.103546140840498,
        0.169808239520384,  -0.238730270082515, -0.517549169506767, 0.011673721137343,  0.030297540535280,  0.000000000000000,  0.000000000000000,
        0.102055247802253,  0.145620688868722,  -0.266908556095694, -0.578637562357845, 0.018746577894421,  0.039395411013415,  0.000000000000000,
        0.000000000000000,  0.030917435413837,  0.037187959391923,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.039301587599806,  0.006099693924434,  -0.000000000000000, 0.000000000000000,  0.009027084726536,  -0.009404598395345, 0.000000000000000,
        0.000000000000000,  0.026029735429513,  -0.027361568546293, 0.418110863055600,  0.364463299975712,  -0.033117854367137, -0.134991138304511,
        0.000000000000000,  0.000000000000000,  0.027313272869996,  0.073391999500809,  0.000000000000000,  0.000000000000000,  0.018243987923074,
        0.025359363004115,  0.000000000000000,  0.000000000000000,  -0.028426286458739, 0.053298509036715,  0.000000000000000,  0.000000000000000,
        -0.005319082215714, -0.018882794378429, 0.000000000000000,  0.000000000000000,  -0.002303709397697, 0.000078636315475,  0.000000000000000,
        0.000000000000000,  0.042819708723421,  0.021352437340449,  0.000000000000000,  0.000000000000000,  0.005567398772120,  -0.011443331166162,
        0.000000000000000,  0.000000000000000,  0.011203357259520,  -0.045294854461103, 0.459951510763202,  0.545544725589981,  -0.071258687421742,
        -0.211634859821950, 0.000000000000000,  0.000000000000000,  0.033361576879127,  0.085001463486422,  0.000000000000000,  0.000000000000000,
        0.023704824990072,  0.026575247004303,  0.000000000000000,  0.000000000000000,  -0.003798140992426, 0.085668834506828,  0.000000000000000,
        0.000000000000000,  -0.000034951542023, -0.023177951404558, 0.000000000000000,  0.000000000000000,  0.001357895087367,  0.001837731279084,
        0.063420830270991,  0.034415911763129,  0.000000000000000,  0.000000000000000,  -0.008568557893285, -0.015071905571581, 0.000000000000000,
        0.000000000000000,  0.015590345738161,  0.010431670290018,  0.000000000000000,  0.000000000000000,  -0.044324568943974, -0.122024111157103,
        0.381950833870782,  0.181077530394103,  -0.030859608378728, 0.000131373659574,  0.000000000000000,  0.000000000000000,  0.014910799545433,
        0.005544191282592,  0.000000000000000,  0.000000000000000,  -0.023647950638706, 0.002826814384050,  0.000000000000000,  0.000000000000000,
        0.050985312614466,  0.004507176667854,  0.000000000000000,  0.000000000000000,  0.029610790892776,  0.020719124802057,  0.000000000000000,
        0.000000000000000,  0.041458830949283,  0.049566300401555,  0.000000000000000,  0.000000000000000,  -0.004227338491684, -0.010548551736388,
        0.000000000000000,  -0.000000000000000, 0.003383003934773,  -0.009139822207035, 0.000000000000000,  0.000000000000000,  -0.126529017797389,
        -0.206009512481811, 0.308199453421727,  0.668153104781061,  0.025120057751079,  0.075978423296940,  0.000000000000000,  0.000000000000000,
        0.002259371228639,  0.004493094702254,  0.000000000000000,  0.000000000000000,  0.015788406678663,  0.046804183229870,  0.000000000000000,
        0.000000000000000,  -0.008539285219204, -0.026042595214385, 0.000000000000000,  0.000000000000000,  0.010325316477799,  0.013419156901577,
        0.000000000000000,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.023848718085704, -0.008158498489910, 0.000000000000000,
        0.000000000000000,  -0.003923592718304, -0.037953433668130, 0.362094629004386,  0.315634476526075,  -0.037946766255821, -0.063532004871916,
        0.000000000000000,  0.000000000000000,  0.028096326369311,  0.009570055746818,  0.000000000000000,  0.000000000000000,  -0.034530235739213,
        -0.022707004663820, 0.000000000000000,  0.000000000000000,  0.043761923376858,  0.021186737486302,  0.000000000000000,  0.000000000000000,
        -0.003305013930871, 0.000705731145842,  0.000000000000000,  0.000000000000000,  -0.001097312821695, 0.057439060231139,  0.000000000000000,
        0.000000000000000,  -0.051063707024740, -0.018912404695314, 0.000000000000000,  0.000000000000000,  -0.026245635737862, -0.019260219780235,
        0.000000000000000,  0.000000000000000,  -0.010035767028742, -0.060311185088314, 0.398329692829965,  0.472455591261534,  -0.060299904217735,
        -0.105022794240049, 0.000000000000000,  0.000000000000000,  0.021195920847612,  0.006986247930522,  0.000000000000000,  0.000000000000000,
        -0.020111563228597, -0.013652348945120, 0.000000000000000,  0.000000000000000,  0.028951600377292,  0.013077845289997,  0.000000000000000,
        0.000000000000000,  -0.002200758227945, -0.000568803853190, 0.000000000000000,  0.000000000000000,  0.012171714020184,  0.090764005608055,
        0.000000000000000,  0.000000000000000,  -0.059548566257628, -0.045158848669880, 0.004424047338000,  0.003926622164349,  0.000000000000000,
        0.000000000000000,  0.069333174892307,  0.016059614951473,  0.000000000000000,  0.000000000000000,  -0.090261385563558, -0.113374279039471,
        0.330779125128747,  0.156817741375842,  0.029244097406021,  0.009304651433314,  0.000000000000000,  0.000000000000000,  -0.007625753378509,
        -0.024598381498307, -0.000000000000000, -0.000000000000000, -0.038813298807546, -0.011776734559167, 0.000000000000000,  0.000000000000000,
        -0.019734252777103, -0.034034018521660, 0.000000000000000,  0.000000000000000,  -0.003322897890241, 0.025986152825142,  0.000000000000000,
        0.000000000000000,  -0.108728525451818, -0.081558096938949, 0.000000000000000,  -0.000000000000000, -0.017796494477382, -0.022968361756448,
        0.000000000000000,  0.000000000000000,  -0.020150945535537, -0.050301458488074, 0.000000000000000,  0.000000000000000,  -0.102809529119988,
        -0.147314027054690, 0.266908556095694,  0.578637562357845,  -0.006376953449083, -0.021203239447251, 0.000000000000000,  0.000000000000000,
        -0.008711983305891, -0.017392637755722, -0.000000000000000, 0.000000000000000,  0.022970697615580,  0.059168973875171,  0.000000000000000,
        0.000000000000000,  -0.017182183497051, -0.019263168031762, 0.000000000000000,  0.000000000000000,  0.036967554603362,  0.078268684185992,
        0.000000000000000,  0.000000000000000,  -0.079831980005423, -0.106743127949218, -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.023018935102647, -0.055225087351858, 0.428436142844360,  0.373463749085029,  0.016248345931479,  -0.015211328999304,
        0.000000000000000,  0.000000000000000,  0.013082045875872,  -0.053663828051912, 0.161933640948275,  0.141156029110973,  -0.017960331436506,
        -0.122032894912189, 0.000000000000000,  0.000000000000000,  0.037483084474712,  0.091570403385510,  0.000000000000000,  0.000000000000000,
        -0.012480895042028, 0.042884578429342,  0.000000000000000,  0.000000000000000,  0.001797692782229,  0.043945779734494,  0.000000000000000,
        0.000000000000000,  -0.015877895146516, -0.013121925690890, 0.000000000000000,  0.000000000000000,  0.039826518822267,  0.063960231461824,
        0.000000000000000,  0.000000000000000,  -0.032217731175944, -0.088413326042745, 0.471310048551927,  0.559016994374948,  0.004131910408718,
        -0.014263184073243, 0.000000000000000,  0.000000000000000,  -0.007089962960226, -0.093964658521987, 0.178138454124882,  0.211288563682129,
        -0.042550427318209, -0.172687731292528, 0.000000000000000,  0.000000000000000,  0.034125548051245,  0.107744110757298,  0.000000000000000,
        0.000000000000000,  0.016576939570195,  0.063534388727975,  0.000000000000000,  0.000000000000000,  0.012321976892532,  0.042407514685992,
        0.000000000000000,  0.000000000000000,  0.002821131504703,  -0.004951791236688, 0.000000000000000,  0.000000000000000,  0.070598147941087,
        0.127119088935242,  -0.112006921180567, -0.135094437985747, 0.000000000000000,  0.000000000000000,  -0.053972817096580, -0.080921852048555,
        0.391383138969112,  0.185549253876993,  0.024248668128055,  -0.012968372100227, 0.000000000000000,  0.000000000000000,  -0.016054320379784,
        -0.041843232411832, 0.147928921865158,  0.070131025958873,  0.052300080485013,  0.058499194812898,  0.000000000000000,  0.000000000000000,
        0.001111636141510,  -0.001115109076354, -0.000000000000000, -0.000000000000000, 0.046024995599049,  0.058641318732901,  0.000000000000000,
        0.000000000000000,  -0.077035569161497, -0.073730818212572, 0.000000000000000,  0.000000000000000,  0.066824399262988,  0.084833833735676,
        0.000000000000000,  0.000000000000000,  -0.102148672127431, -0.166995145156356, 0.000000000000000,  0.000000000000000,  -0.031210327873189,
        -0.032367264676465, 0.315810462530809,  0.684653196881458,  -0.037798733744248, -0.079882971885521, 0.000000000000000,  0.000000000000000,
        -0.027776309071721, -0.057048198148126, 0.119365135041258,  0.258774584753383,  0.007959125775792,  0.022605987242340,  0.000000000000000,
        0.000000000000000,  -0.001330582136318, -0.002056242783377, -0.000000000000000, 0.000000000000000,  0.037053668794154,  0.081707552897384,
        0.000000000000000,  0.000000000000000,  -0.010833839633744, -0.011661434943452, 0.000000000000000,  0.000000000000000,  0.120620860278080,
        0.189654384241000,  0.000000000000000,  0.000000000000000,  0.494715444803513,  0.431238792133616,  -0.019705045557914, 0.040815825944324,
        0.000000000000000,  0.000000000000000,  -0.068226612470365, -0.147281795271204, 0.093492431192342,  0.081496471404959,  -0.064862595660362,
        -0.106658034023403, 0.000000000000000,  0.000000000000000,  0.074165241336371,  0.055821900110932,  0.000000000000000,  0.000000000000000,
        -0.094184263955151, -0.091351366607725, 0.000000000000000,  0.000000000000000,  0.022200929388118,  0.072121931145407,  0.000000000000000,
        0.000000000000000,  0.082569953995726,  0.059360212393642,  0.000000000000000,  0.000000000000000,  0.007466503015103,  0.072136846289552,
        0.000000000000000,  0.000000000000000,  0.019279172938576,  0.069653623461353,  0.544221966806461,  0.645497224367903,  -0.019797603949623,
        0.074674212385146,  0.000000000000000,  0.000000000000000,  -0.083177810672693, -0.214189613733257, 0.102848284442025,  0.121987509118567,
        -0.078519111879092, -0.153697187391371, 0.000000000000000,  0.000000000000000,  0.071747393330238,  0.077963078385074,  0.000000000000000,
        0.000000000000000,  -0.036733953425713, -0.082096602557342, 0.000000000000000,  0.000000000000000,  0.007909277063204,  0.069955636995943,
        0.000000000000000,  0.000000000000000,  0.085138357797776,  0.095880516564378,  0.000000000000000,  0.000000000000000,  -0.040381719168816,
        0.027051634127647,  0.000000000000000,  0.000000000000000,  0.005114454495398,  0.071422222455604,  0.025217943153199,  0.074268592016206,
        0.451930321280196,  0.214253823347632,  -0.074562645454986, -0.112785793861359, 0.000000000000000,  0.000000000000000,  0.027089275766114,
        0.020990120899071,  0.085406802859780,  0.040490166715900,  -0.007634359740686, -0.018898875247376, 0.000000000000000,  0.000000000000000,
        -0.010849149809444, -0.038983986672818, -0.000000000000000, 0.000000000000000,  0.020702837478400,  0.040918294528214,  0.000000000000000,
        0.000000000000000,  0.025072157196928,  0.005862411373906,  -0.000000000000000, -0.000000000000000, -0.003649966837086, 0.056819185218163,
        0.000000000000000,  0.000000000000000,  0.056617228603624,  0.098687393631019,  0.000000000000000,  0.000000000000000,  0.078549471482741,
        0.176312609990473,  0.364666511110126,  0.790569415042095,  -0.099302660072766, -0.175050154989866, 0.000000000000000,  0.000000000000000,
        -0.010080432037261, -0.017476968127174, 0.068915492847926,  0.149403576166799,  0.008951737157055,  0.006875478996881,  0.000000000000000,
        0.000000000000000,  0.020802530492604,  0.015409049830545,  0.000000000000000,  0.000000000000000,  -0.016166185357781, -0.009659668099974,
        0.000000000000000,  0.000000000000000,  0.036825968339639,  0.044387953553725,  -0.000000000000000, 0.000000000000000,  -0.045339988283546,
        -0.022087566773732, 0.000000000000000,  0.000000000000000,  0.040097237024099,  0.090365992963625,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 28, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.023176373642119, -0.035821711823903, 0.349816645778283,  0.304931874228376,  0.015877490905208,
        -0.007013421386732, 0.000000000000000,  0.000000000000000,  0.005413179024717,  -0.013462155066278, 0.000000000000000,  -0.000000000000000,
        0.013749767120708,  -0.005110163284891, 0.000000000000000,  0.000000000000000,  0.003861693875814,  -0.001273289417677, 0.000000000000000,
        0.000000000000000,  -0.022462656568346, 0.011531488991026,  0.000000000000000,  0.000000000000000,  0.004146269285372,  -0.020329229480883,
        0.000000000000000,  0.000000000000000,  -0.001014734582905, -0.000042858854192, 0.000000000000000,  0.000000000000000,  0.034101418826952,
        0.053662451961499,  0.000000000000000,  0.000000000000000,  -0.038711835343769, -0.069796998258400, 0.384823043199529,  0.456435464587639,
        -0.001193983278579, -0.009898427353306, 0.000000000000000,  0.000000000000000,  -0.002789499247164, -0.031564211002121, 0.000000000000000,
        0.000000000000000,  0.001475058803150,  -0.011696015928758, 0.000000000000000,  0.000000000000000,  0.000125303005249,  -0.002659415173175,
        0.000000000000000,  0.000000000000000,  -0.000851614362915, 0.026061628018649,  0.000000000000000,  0.000000000000000,  -0.005479896843414,
        -0.047406365519291, 0.000000000000000,  0.000000000000000,  -0.000344975901028, -0.000028067986783, 0.000000000000000,  0.000000000000000,
        0.057769272085392,  0.104611196492895,  0.027078386138035,  0.053794586652344,  0.000000000000000,  0.000000000000000,  -0.034522258058987,
        0.004786367948912,  0.319562994801041,  0.151500331384255,  -0.083733473292421, -0.116305825108214, -0.000000000000000, -0.000000000000000,
        -0.115097636157530, -0.100450410952214, 0.000000000000000,  -0.000000000000000, -0.034436388081692, -0.027485479627600, 0.000000000000000,
        0.000000000000000,  0.218036822566669,  0.201218345892354,  -0.000000000000000, 0.000000000000000,  -0.110977968358034, -0.165677642673887,
        -0.000000000000000, 0.000000000000000,  0.002265972376090,  0.001280020490588,  -0.000000000000000, 0.000000000000000,  -0.039896709208391,
        -0.080265998102016, -0.000000000000000, 0.000000000000000,  0.024749082591828,  0.056989010437002,  0.000000000000000,  0.000000000000000,
        0.055504530020285,  0.133113469134719,  0.257858162877610,  0.559016994374948,  -0.095761802661260, -0.160354730434213, -0.000000000000000,
        0.000000000000000,  -0.052626136683455, -0.077855650089951, 0.000000000000000,  -0.000000000000000, -0.012695704322782, -0.017699962179625,
        0.000000000000000,  0.000000000000000,  0.111496271735905,  0.167247534798838,  0.000000000000000,  0.000000000000000,  -0.141105788037527,
        -0.237356164282616, 0.000000000000000,  0.000000000000000,  0.000305387846407,  0.000377456636185,  0.000000000000000,  0.000000000000000,
        -0.037077018230769, -0.085414684263207, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.047042395738523,
        -0.048816745431011, 0.000000000000000,  0.000000000000000,  0.037213792231805,  0.058327950806957,  0.458017502467011,  0.399249541558939,
        -0.026843998689420, 0.001973694041578,  0.000000000000000,  0.000000000000000,  0.026347630595976,  -0.022403725852894, 0.000000000000000,
        0.000000000000000,  0.020252345816494,  0.064874612464063,  0.000000000000000,  0.000000000000000,  0.010549345536979,  -0.064160867584473,
        0.000000000000000,  0.000000000000000,  -0.010419666071604, -0.006083733769649, 0.000000000000000,  0.000000000000000,  -0.068045996013128,
        -0.090275415156554, 0.000000000000000,  0.000000000000000,  -0.103959069758880, -0.115169628570354, 0.000000000000000,  0.000000000000000,
        -0.043362075776814, -0.066994896794657, 0.000000000000000,  0.000000000000000,  0.018952790426491,  0.046075327094278,  0.503851635607172,
        0.597614304667197,  -0.046935499252511, -0.026157832576695, 0.000000000000000,  0.000000000000000,  0.009921429979116,  -0.035536759104525,
        0.000000000000000,  0.000000000000000,  -0.015582216655179, 0.062614940288278,  0.000000000000000,  0.000000000000000,  0.013202648888040,
        -0.079068793049801, 0.000000000000000,  0.000000000000000,  -0.000960085114387, -0.005145250176199, 0.000000000000000,  0.000000000000000,
        -0.030502117200758, -0.070571361521692, 0.000000000000000,  0.000000000000000,  -0.100242098815098, -0.158826601748418, 0.023911634347318,
        0.023042733654748,  0.000000000000000,  0.000000000000000,  -0.040416066307150, -0.026567744803658, 0.000000000000000,  0.000000000000000,
        0.012331417115483,  0.043414313796975,  0.418406175137871,  0.198360496108355,  -0.039416025000925, -0.049931785272418, -0.000000000000000,
        -0.000000000000000, 0.014518378986800,  0.111491509017682,  -0.000000000000000, 0.000000000000000,  -0.043754172110543, -0.111793219992584,
        -0.000000000000000, 0.000000000000000,  0.011913462544304,  -0.002908130527590, 0.000000000000000,  0.000000000000000,  0.073322124558248,
        0.042809340441922,  -0.000000000000000, 0.000000000000000,  0.052753116668339,  0.053199358953713,  -0.000000000000000, 0.000000000000000,
        0.002892860174882,  0.003321197187506,  0.000000000000000,  0.000000000000000,  -0.037723751789755, -0.037620347037605, 0.000000000000000,
        0.000000000000000,  0.018619672567818,  0.089623501921872,  0.337615585699685,  0.731925054711400,  -0.041507080190634, -0.084832007878256,
        -0.000000000000000, 0.000000000000000,  0.049459834392304,  0.114490628147353,  0.000000000000000,  0.000000000000000,  -0.073336818305941,
        -0.156316176418918, 0.000000000000000,  0.000000000000000,  -0.000488785323754, -0.003272105277209, 0.000000000000000,  0.000000000000000,
        0.058328148712471,  0.057621275393876,  0.000000000000000,  0.000000000000000,  0.006826212834528,  0.007873651401312,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.079299390795379,  0.050841304389029,  0.000000000000000,  -0.000000000000000,
        0.032223227946512,  -0.002096885659169, 0.000000000000000,  0.000000000000000,  0.043355660732153,  0.050539340731316,  0.512079135200457,
        0.446374557455708,  0.028926329368324,  0.035450911444182,  0.000000000000000,  0.000000000000000,  -0.036672062862514, -0.114729519688592,
        0.000000000000000,  0.000000000000000,  -0.002840977945441, -0.028834179951535, 0.000000000000000,  0.000000000000000,  -0.059256268940051,
        -0.087149373542692, 0.000000000000000,  0.000000000000000,  0.033251225643502,  -0.004924030302881, 0.000000000000000,  0.000000000000000,
        0.000488803904888,  0.005766390520781,  0.000000000000000,  0.000000000000000,  0.056837555278441,  0.061567450184954,  0.000000000000000,
        0.000000000000000,  -0.004053239146602, -0.021262618250099, 0.000000000000000,  0.000000000000000,  0.039059256043948,  0.063945395538710,
        0.563323253896045,  0.668153104781062,  -0.034278280005480, -0.017609338406758, 0.000000000000000,  0.000000000000000,  -0.025710321422400,
        -0.142806452207322, 0.000000000000000,  0.000000000000000,  0.002345551745904,  -0.034881331886679, 0.000000000000000,  0.000000000000000,
        -0.069492568872436, -0.107863469074544, 0.000000000000000,  0.000000000000000,  -0.010342900496924, -0.041223922263965, 0.000000000000000,
        0.000000000000000,  0.003814632714166,  0.007673070641049,  -0.027896000581314, -0.022143668862298, 0.000000000000000,  -0.000000000000000,
        -0.036894417761855, -0.016909995677407, 0.000000000000000,  -0.000000000000000, -0.050804625951705, -0.045600198693274, 0.000000000000000,
        0.000000000000000,  -0.102877049222521, -0.058983513209724, 0.467792324906982,  0.221773776674433,  0.039167578015169,  -0.040641766838198,
        -0.000000000000000, 0.000000000000000,  -0.001012682096178, -0.027449625876354, 0.000000000000000,  0.000000000000000,  0.033392137170430,
        0.046119393062087,  -0.000000000000000, 0.000000000000000,  -0.032386688435315, -0.014028638890770, -0.000000000000000, 0.000000000000000,
        0.000964024864539,  -0.000538448294338, 0.000000000000000,  0.000000000000000,  -0.002974415407513, -0.004538229084778, 0.000000000000000,
        0.000000000000000,  -0.024683766072372, -0.033021744411934, 0.000000000000000,  -0.000000000000000, -0.018177497158087, -0.021438301765320,
        0.000000000000000,  0.000000000000000,  -0.077245679437821, -0.049395512802486, 0.377465699943951,  0.818317088384972,  -0.044178990247252,
        -0.120806550379327, 0.000000000000000,  0.000000000000000,  -0.020981459085829, -0.051972842163423, 0.000000000000000,  0.000000000000000,
        0.014832811324647,  0.012198310661006,  0.000000000000000,  0.000000000000000,  -0.040637643161234, -0.056239501492831, 0.000000000000000,
        0.000000000000000,  -0.000166759972475, -0.000274723469486, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.042870611092035, -0.019259825727761, 0.000000000000000,  0.000000000000000,  0.009574267056180,  0.002424383752500,  0.000000000000000,
        0.000000000000000,  -0.019325565990851, 0.027561278948903,  0.000000000000000,  0.000000000000000,  0.015690223022157,  0.104784828295144,
        0.528873056685777,  0.461013660585776,  0.029721224790970,  0.046965208041552,  0.000000000000000,  0.000000000000000,  0.010460148681438,
        0.069856552196763,  0.000000000000000,  0.000000000000000,  0.008052319162855,  -0.011483866228710, 0.000000000000000,  0.000000000000000,
        -0.048935142731587, -0.012391294734998, -0.000000000000000, 0.000000000000000,  -0.042513355999601, -0.019099327180029, 0.000000000000000,
        0.000000000000000,  -0.024757531980476, -0.021413988352261, 0.000000000000000,  0.000000000000000,  -0.000630059661704, -0.001101970140950,
        0.000000000000000,  0.000000000000000,  -0.023598689375346, 0.042657539732409,  0.000000000000000,  0.000000000000000,  0.056333198584289,
        0.145767432345059,  0.581797754898868,  0.690065559342354,  -0.013246375930252, 0.000866369135377,  0.000000000000000,  0.000000000000000,
        0.037555465722860,  0.097178288230039,  0.000000000000000,  0.000000000000000,  0.009832787239727,  -0.017773974888504, 0.000000000000000,
        0.000000000000000,  0.003220304937597,  0.005632291831523,  0.000000000000000,  0.000000000000000,  -0.024551219213972, -0.021235538449326,
        0.014968457168580,  0.008510333464500,  0.000000000000000,  0.000000000000000,  -0.011061075027871, -0.003140657108991, 0.000000000000000,
        0.000000000000000,  -0.024151388187597, 0.025845076241260,  -0.000000000000000, 0.000000000000000,  0.002614637582901,  -0.002533883009062,
        0.000000000000000,  0.000000000000000,  -0.080533876194316, -0.075263311473459, 0.483133835692903,  0.229046971649493,  0.001743091721934,
        -0.001689255339375, 0.000000000000000,  0.000000000000000,  0.010063078411499,  -0.010768781767192, 0.000000000000000,  0.000000000000000,
        0.056534383475785,  0.016052247445952,  -0.000000000000000, 0.000000000000000,  0.014843720025508,  0.008439414018962,  0.000000000000000,
        0.000000000000000,  0.000336048765749,  -0.000151896378992, 0.000000000000000,  0.000000000000000,  -0.004558298764580, -0.004234387639724,
        0.000000000000000,  0.000000000000000,  0.021657491422629,  0.057850647530900,  0.000000000000000,  0.000000000000000,  0.022665196477222,
        0.057892445442013,  0.000000000000000,  0.000000000000000,  -0.079138505362744, -0.053629949942830, 0.389844898572652,  0.845154254728517,
        0.015110130984815,  0.038594963628008,  0.000000000000000,  0.000000000000000,  -0.009023954759429, -0.024104436471208, 0.000000000000000,
        0.000000000000000,  0.023297971463410,  0.021642425714147,  0.000000000000000,  0.000000000000000,  0.000333248359368,  -0.000150630575834,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.031793013729463, -0.014476276122401, 0.000000000000000,
        0.000000000000000,  -0.059336741281446, 0.004988228692895,  0.000000000000000,  0.000000000000000,  0.060589474053477,  0.084532366824449,
        0.000000000000000,  0.000000000000000,  -0.002840977945441, -0.028834179951535, 0.000000000000000,  0.000000000000000,  -0.024448041908342,
        -0.076486346459061, 0.512079135200457,  0.446374557455707,  0.031293810989525,  0.059479394737128,  0.000000000000000,  0.000000000000000,
        0.036541501263532,  0.063915152846778,  -0.000000000000000, 0.000000000000000,  0.006355091605550,  -0.002033222255738, 0.000000000000000,
        0.000000000000000,  0.085696566002411,  0.052621214009461,  0.000000000000000,  0.000000000000000,  -0.019034685886267, -0.016782769009982,
        0.000000000000000,  0.000000000000000,  0.009978920292736,  0.047026503054659,  0.000000000000000,  0.000000000000000,  0.066976333917086,
        0.105106843897664,  0.000000000000000,  0.000000000000000,  0.002345551745904,  -0.034881331886679, 0.000000000000000,  0.000000000000000,
        -0.017140214281600, -0.095204301471548, 0.563323253896045,  0.668153104781062,  -0.036232906460400, 0.011458438165475,  0.000000000000000,
        0.000000000000000,  0.051920012482400,  0.078034813109429,  -0.000000000000000, -0.000000000000000, -0.004414186182422, -0.015508392299328,
        0.000000000000000,  0.000000000000000,  0.059947850901550,  0.063429063586981,  0.012414769093386,  0.008442489087694,  -0.000000000000000,
        0.000000000000000,  0.065617406892792,  0.029741864177756,  0.000000000000000,  0.000000000000000,  -0.043272476037459, -0.051261140364662,
        0.000000000000000,  0.000000000000000,  -0.001012682096178, -0.027449625876354, 0.000000000000000,  0.000000000000000,  0.026111718676779,
        -0.027094511225466, -0.000000000000000, -0.000000000000000, -0.102033147475706, -0.036108824979429, 0.467792324906982,  0.221773776674433,
        -0.000305116186887, -0.019320156924559, 0.000000000000000,  0.000000000000000,  -0.003940621958190, -0.001327713934479, -0.000000000000000,
        0.000000000000000,  -0.030630025477238, -0.023758899979198, -0.000000000000000, 0.000000000000000,  0.001031725199334,  0.001552181287229,
        0.000000000000000,  0.000000000000000,  0.051645569440796,  0.069856474922304,  0.000000000000000,  0.000000000000000,  -0.017702065419835,
        -0.016804266504154, 0.000000000000000,  0.000000000000000,  -0.020981459085829, -0.051972842163423, 0.000000000000000,  0.000000000000000,
        -0.029452660164834, -0.080537700252885, -0.000000000000000, 0.000000000000000,  -0.059761130199630, -0.006084810999633, 0.377465699943951,
        0.818317088384972,  -0.003512420671567, 0.002103250321881,  0.000000000000000,  0.000000000000000,  -0.013767572511807, -0.019518245761039,
        -0.000000000000000, 0.000000000000000,  -0.003151175470623, -0.004799284116210, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.100307916380557,  0.114356914534726,  0.000000000000000,  0.000000000000000,  0.049331871202215,  0.086014535923650,
        0.000000000000000,  0.000000000000000,  -0.010419666071604, -0.006083733769649, 0.000000000000000,  0.000000000000000,  -0.001857715429884,
        0.073327451226013,  0.000000000000000,  0.000000000000000,  -0.008438477423539, -0.027031088526693, 0.000000000000000,  0.000000000000000,
        -0.018076256618067, -0.069255153354097, 0.458017502467010,  0.399249541558939,  -0.047509669731434, -0.010092377934893, 0.000000000000000,
        0.000000000000000,  0.041038119245090,  0.059198683246512,  0.000000000000000,  0.000000000000000,  -0.038068848486242, -0.046819314196105,
        0.000000000000000,  0.000000000000000,  0.098679643605639,  0.158025895307268,  0.000000000000000,  0.000000000000000,  0.027328937349656,
        0.068338932251117,  0.000000000000000,  0.000000000000000,  -0.000960085114387, -0.005145250176199, 0.000000000000000,  0.000000000000000,
        -0.012698800063850, 0.086797889367705,  0.000000000000000,  0.000000000000000,  0.006492590272991,  -0.026089558453449, 0.000000000000000,
        0.000000000000000,  0.007346202655478,  -0.075041029173812, 0.503851635607172,  0.597614304667197,  -0.048839668062711, -0.036362578759488,
        0.000000000000000,  0.000000000000000,  0.019601245940452,  0.046531535420928,  0.000000000000000,  0.000000000000000,  -0.039521983565160,
        -0.065026976978546, -0.050860799521591, -0.052340655253002, 0.000000000000000,  0.000000000000000,  -0.053884378447425, -0.038281748718457,
        0.000000000000000,  0.000000000000000,  0.011913462544304,  -0.002908130527590, 0.000000000000000,  0.000000000000000,  0.039143212493290,
        0.122861882617771,  0.000000000000000,  0.000000000000000,  -0.006049324577833, -0.046454795424034, 0.000000000000000,  0.000000000000000,
        -0.015848898068297, -0.106504949801152, -0.000000000000000, -0.000000000000000, 0.035959784495020,  0.037646521583921,  0.418406175137871,
        0.198360496108355,  -0.044388269029965, -0.027492981303261, 0.000000000000000,  0.000000000000000,  0.019260830731820,  0.020932272264716,
        0.000000000000000,  0.000000000000000,  -0.006778585855959, -0.007833957273736, 0.000000000000000,  0.000000000000000,  -0.055660751139087,
        -0.055798504527288, 0.000000000000000,  0.000000000000000,  -0.000488785323754, -0.003272105277209, 0.000000000000000,  0.000000000000000,
        0.076659677711938,  0.165036625799378,  0.000000000000000,  0.000000000000000,  -0.020608264330127, -0.047704428394730, 0.000000000000000,
        0.000000000000000,  -0.058490583821285, -0.129403193600608, -0.000000000000000, 0.000000000000000,  0.017650248342373,  0.083133826455408,
        0.337615585699685,  0.731925054711401,  -0.038268848111284, -0.037992839576505, 0.000000000000000,  0.000000000000000,  0.002775805946154,
        0.003223639760430,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.033005054226590, -0.053546530341243,
        0.000000000000000,  0.000000000000000,  -0.001014734582905, -0.000042858854192, 0.000000000000000,  0.000000000000000,  -0.015606071475068,
        0.019937006590859,  0.000000000000000,  0.000000000000000,  0.007191954363487,  -0.010469310885646, 0.000000000000000,  0.000000000000000,
        -0.019737546476383, 0.006507923690350,  -0.000000000000000, 0.000000000000000,  -0.001393679232444, -0.004056836663722, 0.000000000000000,
        0.000000000000000,  0.007755048148910,  -0.013382002314883, 0.349816645778283,  0.304931874228376,  0.020865377079632,  -0.006802750448854,
        0.000000000000000,  0.000000000000000,  -0.021561275060242, -0.035650943044591, 0.000000000000000,  0.000000000000000,  -0.057275796924213,
        -0.104471822772886, 0.000000000000000,  0.000000000000000,  -0.000344975901028, -0.000028067986783, 0.000000000000000,  0.000000000000000,
        0.001743172980213,  0.047233180675730,  0.000000000000000,  0.000000000000000,  -0.003044801238021, -0.023150308873184, 0.000000000000000,
        0.000000000000000,  -0.000640437582384, 0.013592566440674,  -0.000000000000000, -0.000000000000000, -0.002388886667778, -0.008808957776172,
        0.000000000000000,  0.000000000000000,  -0.002025880635254, -0.031528819794559, 0.384823043199529,  0.456435464587639,  0.000501731597246,
        -0.009760460316825, 0.000000000000000,  0.000000000000000,  -0.037984877329301, -0.069591681252121, 0.038704902956424,  0.079561892390922,
        0.000000000000000,  0.000000000000000,  0.002265972376090,  0.001280020490588,  -0.000000000000000, 0.000000000000000,  0.153149360742655,
        0.191002829669516,  0.000000000000000,  0.000000000000000,  -0.133692613564635, -0.143446403293859, 0.000000000000000,  0.000000000000000,
        0.176008205750868,  0.140481340318842,  -0.000000000000000, 0.000000000000000,  -0.031456295563847, -0.043159901208708, -0.000000000000000,
        0.000000000000000,  -0.092351412774705, -0.121481156454055, -0.000000000000000, -0.000000000000000, -0.045660552226483, -0.001505520211346,
        0.319562994801041,  0.151500331384255,  0.025322688638509,  0.052757340342947,  0.000000000000000,  0.000000000000000,  0.036999965622862,
        0.085300886097349,  0.000000000000000,  0.000000000000000,  0.000305387846407,  0.000377456636185,  0.000000000000000,  0.000000000000000,
        0.148422400717502,  0.246515734461922,  0.000000000000000,  0.000000000000000,  -0.090037639410707, -0.138833005208917, 0.000000000000000,
        0.000000000000000,  0.064889155427551,  0.090466473362529,  -0.000000000000000, 0.000000000000000,  -0.031346326294300, -0.049677908246614,
        -0.000000000000000, 0.000000000000000,  -0.097256989842093, -0.162226535395479, -0.000000000000000, 0.000000000000000,  0.054003408601353,
        0.131258096538981,  0.257858162877610,  0.559016994374948,  0.024635573310592,  0.056821369803369,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 28, 36));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeGFForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix dipxmat(36, 28);

    CDenseMatrix dipymat(36, 28);

    CDenseMatrix dipzmat(36, 28);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.494715444803513,  0.544221966806461,  -0.021335746729385, 0.045906156150225,  0.000000000000000,  0.000000000000000,  0.003450359072648,
        -0.066082381155986, 0.000000000000000,  0.000000000000000,  -0.060691847966162, -0.039090657392685, 0.000000000000000,  0.000000000000000,
        0.006226822401972,  -0.005713304459682, 0.000000000000000,  0.000000000000000,  0.068272269615827,  0.071088577411739,  0.000000000000000,
        0.000000000000000,  -0.090525253476168, -0.127598316774956, 0.000000000000000,  0.000000000000000,  0.057066569694361,  0.040484184919198,
        0.431238792133616,  0.645497224367903,  -0.008587183934558, 0.101645057888124,  0.000000000000000,  0.000000000000000,  0.003637116771848,
        -0.097481270977697, -0.000000000000000, 0.000000000000000,  -0.045967567298759, -0.052467988799579, 0.000000000000000,  0.000000000000000,
        0.008416963152032,  -0.005666376232972, 0.000000000000000,  0.000000000000000,  0.040188660465564,  0.090522402773056,  0.000000000000000,
        0.000000000000000,  -0.112780241716181, -0.203228794056351, 0.000000000000000,  0.000000000000000,  0.098469335167907,  0.090691859065614,
        -0.034947830800002, -0.022841637094774, 0.451930321280195,  0.364666511110126,  -0.033751354408634, -0.062606512422929, 0.000000000000000,
        0.000000000000000,  -0.023848718085704, -0.026245635737862, 0.000000000000000,  0.000000000000000,  -0.018514974994149, -0.015982366342235,
        0.000000000000000,  0.000000000000000,  0.064054757343477,  0.073815179106429,  -0.000000000000000, 0.000000000000000,  -0.036134966639071,
        -0.063787646997150, 0.000000000000000,  0.000000000000000,  0.019551874176466,  0.005652418794906,  0.000000000000000,  0.000000000000000,
        -0.017836433007569, 0.015001677675688,  0.214253823347632,  0.790569415042095,  -0.032519828329727, -0.082553705268262, 0.000000000000000,
        0.000000000000000,  -0.008158498489910, -0.019260219780235, -0.000000000000000, 0.000000000000000,  -0.002401056658398, -0.006712474826651,
        0.000000000000000,  0.000000000000000,  0.016763935225230,  0.047626586126612,  0.000000000000000,  0.000000000000000,  -0.068298788384426,
        -0.128059046054536, 0.000000000000000,  0.000000000000000,  0.069342138573417,  0.071330159590407,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.000302784616183, -0.028889461647259, 0.428436142844360,  0.471310048551927,  -0.003047679219017,
        -0.025667775336285, 0.000000000000000,  0.000000000000000,  -0.034835307959815, -0.027159495113294, 0.000000000000000,  0.000000000000000,
        -0.008648122343253, 0.009489774663486,  0.000000000000000,  0.000000000000000,  0.038437167541434,  -0.034049395064280, 0.000000000000000,
        0.000000000000000,  -0.066820495791649, -0.008338896468671, 0.000000000000000,  0.000000000000000,  0.113123964219704,  0.149991694665926,
        0.000000000000000,  0.000000000000000,  0.036978931189672,  -0.013695824350973, 0.373463749085028,  0.559016994374947,  -0.018156543757536,
        -0.024266851035608, 0.000000000000000,  0.000000000000000,  -0.034391018442251, -0.052231461255113, 0.000000000000000,  0.000000000000000,
        0.019563681343772,  0.025612967375892,  0.000000000000000,  0.000000000000000,  -0.002107187689134, -0.073878452530671, 0.000000000000000,
        0.000000000000000,  -0.074310910832008, -0.010496342303684, 0.000000000000000,  0.000000000000000,  0.168215829316457,  0.263354906776359,
        0.002673928607742,  -0.026315794462331, 0.000000000000000,  0.000000000000000,  0.022643405181961,  -0.007056560202653, 0.391383138969112,
        0.315810462530809,  -0.003923592718304, -0.010035767028742, 0.000000000000000,  0.000000000000000,  -0.010647832316476, -0.007892094963960,
        -0.000000000000000, 0.000000000000000,  -0.010116448298825, -0.017368420762658, 0.000000000000000,  0.000000000000000,  -0.011758940667403,
        0.008846294678315,  0.000000000000000,  0.000000000000000,  0.100888685702720,  0.125421012182617,  0.000000000000000,  0.000000000000000,
        0.045962693893636,  0.016773890633335,  0.000000000000000,  0.000000000000000,  -0.001967974749312, -0.009982912198365, 0.185549253876993,
        0.684653196881458,  -0.037953433668130, -0.060311185088314, 0.000000000000000,  0.000000000000000,  0.021065185958547,  0.025714071756173,
        0.000000000000000,  0.000000000000000,  -0.051929916315396, -0.085463779638624, 0.000000000000000,  0.000000000000000,  -0.014792097626373,
        -0.005081324453272, 0.000000000000000,  0.000000000000000,  0.219268534919049,  0.320329518509941,  0.000000000000000,  0.000000000000000,
        -0.093492431192342, -0.102848284442025, -0.037337396690661, -0.022709424873412, 0.000000000000000,  0.000000000000000,  0.013864023082145,
        0.020309491376316,  0.362094629004386,  0.398329692829965,  -0.069576893933128, -0.088716187847725, 0.000000000000000,  0.000000000000000,
        0.023587389400676,  -0.010973888390781, 0.000000000000000,  0.000000000000000,  -0.008843833739368, -0.014085880235692, 0.000000000000000,
        0.000000000000000,  -0.013487073868796, 0.061326623245851,  0.000000000000000,  0.000000000000000,  -0.021778187585813, -0.036628763443571,
        -0.081496471404959, -0.121987509118567, -0.014769246148921, -0.020551114778647, 0.000000000000000,  0.000000000000000,  0.031355360771125,
        0.048727683355705,  0.315634476526075,  0.472455591261534,  -0.081814841056401, -0.130799756977924, 0.000000000000000,  0.000000000000000,
        0.001436490189583,  -0.039167002479258, 0.000000000000000,  0.000000000000000,  -0.010304794142671, -0.017835987232742, 0.000000000000000,
        0.000000000000000,  0.029353514811387,  0.125807548280398,  0.000000000000000,  0.000000000000000,  -0.003644975473788, -0.044029007996616,
        -0.010720532789559, 0.000529222002081,  -0.085406802859780, -0.068915492847926, 0.000177480621022,  0.000257113166796,  0.000000000000000,
        0.000000000000000,  -0.037946766255821, -0.060299904217735, 0.330779125128747,  0.266908556095694,  0.030876667232323,  0.006799732122469,
        0.000000000000000,  0.000000000000000,  0.022843316399902,  0.015857068299858,  0.000000000000000,  0.000000000000000,  -0.023870345573030,
        0.018047668764264,  0.000000000000000,  0.000000000000000,  -0.086156407940066, -0.086991573021610, 0.000000000000000,  0.000000000000000,
        0.060603926063488,  0.074754939591178,  -0.040490166715900, -0.149403576166799, 0.020688417301306,  0.016648447433247,  0.000000000000000,
        0.000000000000000,  -0.063532004871916, -0.105022794240049, 0.156817741375842,  0.578637562357845,  -0.050470165294267, -0.081578091549480,
        0.000000000000000,  0.000000000000000,  0.026476839569296,  0.025095685764046,  0.000000000000000,  0.000000000000000,  0.090243250023072,
        0.154276416228255,  0.000000000000000,  0.000000000000000,  -0.059877178940155, -0.096552233696956, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.005432625748072, 0.011203092881310,  -0.161933640948275, -0.178138454124882, 0.038323933967631,
        0.035022278454231,  0.000000000000000,  0.000000000000000,  -0.028020101994232, 0.011673721137343,  0.000000000000000,  0.000000000000000,
        0.014910799545433,  0.002259371228639,  0.000000000000000,  0.000000000000000,  -0.038813298807546, 0.022970697615580,  0.000000000000000,
        0.000000000000000,  0.001111636141510,  -0.001330582136318, 0.000000000000000,  0.000000000000000,  0.020702837478400,  -0.016166185357781,
        0.000000000000000,  0.000000000000000,  -0.020345806137225, 0.007564420842833,  -0.141156029110973, -0.211288563682129, 0.065217608471486,
        0.067792535619239,  0.000000000000000,  0.000000000000000,  -0.018784119825133, 0.030297540535280,  0.000000000000000,  0.000000000000000,
        0.005544191282592,  0.004493094702254,  0.000000000000000,  0.000000000000000,  -0.011776734559167, 0.059168973875171,  0.000000000000000,
        0.000000000000000,  -0.001115109076354, -0.002056242783377, 0.000000000000000,  0.000000000000000,  0.040918294528214,  -0.009659668099973,
        0.044646339185393,  0.033221388341741,  0.000000000000000,  0.000000000000000,  0.051640244964337,  0.046163568726528,  -0.147928921865157,
        -0.119365135041258, 0.028096326369311,  0.021195920847612,  0.000000000000000,  0.000000000000000,  0.018243987923074,  0.023704824990072,
        0.000000000000000,  0.000000000000000,  -0.036451717965233, -0.000298105499920, 0.000000000000000,  0.000000000000000,  -0.006221819165921,
        -0.021349054594251, 0.000000000000000,  0.000000000000000,  0.054250803479376,  0.028404530521267,  0.000000000000000,  0.000000000000000,
        -0.005473008693396, 0.001893379181288,  0.000000000000000,  0.000000000000000,  0.109515602361902,  0.144038460243607,  -0.070131025958873,
        -0.258774584753383, 0.009570055746818,  0.006986247930522,  0.000000000000000,  0.000000000000000,  0.025359363004115,  0.026575247004303,
        0.000000000000000,  0.000000000000000,  0.059082608654843,  0.107690819524404,  0.000000000000000,  0.000000000000000,  -0.041583681242273,
        -0.059968765535583, 0.000000000000000,  0.000000000000000,  0.092310142214205,  0.093179476187347,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.041311544515829,  -0.022608781135932, 0.000000000000000,  0.000000000000000,  -0.046913266595172,
        -0.004745923376747, 0.000000000000000,  0.000000000000000,  -0.007625753378509, -0.008711983305891, 0.000000000000000,  0.000000000000000,
        -0.020573072252485, 0.016746705167386,  -0.323867281896550, -0.356276908249765, 0.071232793077729,  0.110806126928741,  0.000000000000000,
        0.000000000000000,  -0.046837417856322, -0.012446533626182, 0.000000000000000,  0.000000000000000,  0.004237459390818,  0.008148423978629,
        0.000000000000000,  0.000000000000000,  0.072491204461080,  -0.013088450183926, 0.000000000000000,  0.000000000000000,  -0.051674752429148,
        -0.017001711143435, 0.000000000000000,  0.000000000000000,  -0.024598381498307, -0.017392637755723, 0.000000000000000,  0.000000000000000,
        0.000087582439716,  0.050652282197960,  -0.282312058221946, -0.422577127364258, 0.121045363827472,  0.184302104316819,  0.000000000000000,
        0.000000000000000,  -0.054164890728044, -0.027524605048016, 0.000000000000000,  -0.000000000000000, -0.006610002666216, 0.007087609827797,
        0.028044363580442,  -0.010251773703136, 0.000000000000000,  0.000000000000000,  -0.028023904936137, -0.033818619625147, 0.000000000000000,
        0.000000000000000,  -0.034530235739213, -0.020111563228597, -0.000000000000000, 0.000000000000000,  0.018208848579997,  0.022241051252752,
        0.000000000000000,  0.000000000000000,  0.046755017804910,  0.094113601275742,  -0.295857843730315, -0.238730270082516, -0.046009121957752,
        -0.023432428536602, 0.000000000000000,  0.000000000000000,  -0.058258664672375, -0.028814210476925, 0.000000000000000,  -0.000000000000000,
        0.073217665860932,  0.055403380164112,  0.000000000000000,  0.000000000000000,  -0.094689312753705, -0.114258320945793, 0.000000000000000,
        0.000000000000000,  -0.022707004663820, -0.013652348945120, 0.000000000000000,  0.000000000000000,  0.048927999667206,  0.056667642324281,
        0.000000000000000,  0.000000000000000,  0.172485844652492,  0.252314514194002,  -0.140262051917746, -0.517549169506766, -0.054116025883241,
        -0.057353384530432, 0.000000000000000,  0.000000000000000,  -0.043276508384589, -0.041881219170279, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.001839217727911,  0.013239250674527,  0.000000000000000,  0.000000000000000,  -0.057626824502913,
        -0.012387337685470, 0.000000000000000,  0.000000000000000,  0.047083000292833,  -0.004105314264059, 0.418110863055600,  0.459951510763202,
        -0.056750235231834, -0.128411827154588, 0.000000000000000,  0.000000000000000,  -0.016931087085450, 0.033714844281603,  -0.161933640948275,
        -0.178138454124882, 0.065003037583470,  0.036990272029348,  0.000000000000000,  0.000000000000000,  -0.026353845393074, 0.030958479926698,
        0.000000000000000,  0.000000000000000,  -0.016684125717344, 0.009520070526636,  0.000000000000000,  0.000000000000000,  -0.051905692416079,
        -0.018054937065177, 0.000000000000000,  0.000000000000000,  0.030356422328503,  -0.018082196098626, 0.364463299975712,  0.545544725589981,
        -0.126644270559264, -0.209753758067023, 0.000000000000000,  0.000000000000000,  0.022028043663880,  0.081474675044878,  -0.141156029110973,
        -0.211288563682129, 0.084168718528269,  0.070380443382959,  0.000000000000000,  0.000000000000000,  -0.066096894749160, 0.020948887318230,
        -0.073564861778994, -0.045283598322451, 0.000000000000000,  0.000000000000000,  -0.042541151817797, -0.018662960216962, -0.000000000000000,
        0.000000000000000,  0.043761923376858,  0.028951600377292,  0.000000000000000,  0.000000000000000,  -0.048321177636366, -0.091012708246802,
        0.381950833870782,  0.308199453421727,  0.035773348603405,  0.035371630549376,  0.000000000000000,  0.000000000000000,  0.045618493698025,
        0.056114512905654,  -0.147928921865158, -0.119365135041258, 0.010697821398850,  0.040053526893175,  0.000000000000000,  0.000000000000000,
        -0.087356247842029, -0.092930012712170, 0.000000000000000,  0.000000000000000,  -0.014638314426807, 0.000303301783936,  0.000000000000000,
        0.000000000000000,  0.021186737486302,  0.013077845289997,  0.000000000000000,  0.000000000000000,  -0.156123940807940, -0.233780898992203,
        0.181077530394103,  0.668153104781061,  0.074924486542112,  0.092002711690094,  0.000000000000000,  0.000000000000000,  0.134773530762473,
        0.173920656136078,  -0.070131025958873, -0.258774584753383, -0.056192627734522, -0.034061143901628, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.022246949469677,  0.043230116224645,  0.000000000000000,  0.000000000000000,  0.017385430481581,
        -0.064077378535726, 0.000000000000000,  0.000000000000000,  0.029908527135931,  0.016641835556382,  0.000000000000000,  0.000000000000000,
        0.015899880954760,  -0.021224533981068, 0.362094629004386,  0.398329692829965,  -0.064025079793012, -0.090542159247788, 0.000000000000000,
        0.000000000000000,  0.038101189817858,  0.028780204955442,  -0.093492431192343, -0.102848284442025, -0.048234747202092, -0.016843321171865,
        0.000000000000000,  0.000000000000000,  -0.005495416738670, 0.049355649553344,  0.000000000000000,  0.000000000000000,  -0.029317942531814,
        -0.129596939873091, 0.000000000000000,  0.000000000000000,  0.041708632637708,  0.020371080152478,  0.000000000000000,  0.000000000000000,
        -0.011358553086329, -0.048174301599050, 0.315634476526075,  0.472455591261534,  -0.084091358882565, -0.130295736124472, 0.000000000000000,
        0.000000000000000,  0.043505709051846,  0.059912980044863,  -0.081496471404959, -0.121987509118567, -0.031482283250341, -0.016507007319021,
        0.074088219827478,  0.089252878681758,  -0.000000000000000, 0.000000000000000,  0.008358551303107,  -0.025744928001985, 0.000000000000000,
        0.000000000000000,  -0.003305013930871, -0.002200758227945, -0.000000000000000, 0.000000000000000,  0.013505567031196,  -0.004138108516256,
        0.000000000000000,  0.000000000000000,  -0.055396848189871, -0.072188835756411, 0.330779125128747,  0.266908556095694,  0.010592025520659,
        0.017142727714449,  0.000000000000000,  0.000000000000000,  -0.010317052292961, 0.009164156879303,  -0.085406802859780, -0.068915492847926,
        0.047603326766092,  0.088947003444385,  0.000000000000000,  0.000000000000000,  -0.093742018826603, -0.158528920768124, 0.000000000000000,
        0.000000000000000,  0.000705731145842,  -0.000568803853190, 0.000000000000000,  0.000000000000000,  -0.041817547674362, -0.066203096243102,
        0.000000000000000,  0.000000000000000,  -0.072870266609103, -0.116844459222724, 0.156817741375842,  0.578637562357845,  0.036213940439666,
        0.037342712120101,  0.000000000000000,  0.000000000000000,  0.050215578398480,  0.069530104738486,  -0.040490166715900, -0.149403576166799,
        0.000000000000000,  0.000000000000000,  -0.114058043657802, -0.147297952687079, 0.000000000000000,  0.000000000000000,  0.079711709734739,
        0.010901194352771,  0.000000000000000,  0.000000000000000,  -0.023703688013482, 0.035596316642496,  0.000000000000000,  0.000000000000000,
        0.033415822459001,  -0.003284769792770, 0.000000000000000,  0.000000000000000,  -0.017301619999180, -0.029063815711483, 0.428436142844360,
        0.471310048551927,  0.000505038990444,  -0.023359163042055, 0.000000000000000,  0.000000000000000,  -0.002939266038326, -0.029622736287414,
        0.000000000000000,  0.000000000000000,  -0.173725566769075, -0.261547956633592, 0.000000000000000,  0.000000000000000,  0.074945208632177,
        0.011717570917018,  0.000000000000000,  0.000000000000000,  0.016115376726370,  0.077891074948963,  0.000000000000000,  -0.000000000000000,
        0.008798361956615,  -0.010974599342894, 0.000000000000000,  0.000000000000000,  -0.051140702203822, -0.063875883861724, 0.373463749085029,
        0.559016994374948,  -0.021716445392459, -0.023249434537653, 0.000000000000000,  0.000000000000000,  0.036434498594098,  -0.014335051372784,
        -0.100818893643309, -0.121618698443083, 0.000000000000000,  0.000000000000000,  0.013392313194043,  -0.003666146435778, -0.000000000000000,
        0.000000000000000,  -0.001097312821695, 0.012171714020184,  0.000000000000000,  0.000000000000000,  -0.006806772184552, -0.002293589012980,
        0.000000000000000,  0.000000000000000,  0.000943336521847,  -0.005121366894981, 0.000000000000000,  0.000000000000000,  0.032836923051625,
        0.000995211375356,  0.391383138969112,  0.315810462530809,  0.005260611869152,  -0.025922127623913, 0.000000000000000,  0.000000000000000,
        -0.223589305142768, -0.322542571430155, 0.000000000000000,  0.000000000000000,  0.013016943367158,  0.004883038990963,  0.000000000000000,
        0.000000000000000,  0.057439060231139,  0.090764005608055,  0.000000000000000,  0.000000000000000,  -0.007240393411728, -0.008928345150810,
        -0.000000000000000, 0.000000000000000,  -0.062288802828973, -0.085168716582132, 0.000000000000000,  0.000000000000000,  -0.003366210434615,
        -0.009942391551126, 0.185549253876993,  0.684653196881458,  0.047120670439903,  0.017556780649952,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.057312747240216, -0.040142203665874, 0.000000000000000,  0.000000000000000,  0.097776207566491,
        0.131839879725760,  0.000000000000000,  0.000000000000000,  -0.043065437750142, -0.058358874544614, 0.000000000000000,  0.000000000000000,
        0.056097230904225,  0.040516342731176,  -0.000000000000000, -0.000000000000000, -0.047490739059142, -0.027637142134690, 0.000000000000000,
        0.000000000000000,  -0.000479980639270, -0.067107471072626, 0.494715444803513,  0.544221966806461,  -0.022434285228010, 0.044955519202105,
        0.000000000000000,  0.000000000000000,  -0.099098298208326, -0.090432403712045, 0.000000000000000,  0.000000000000000,  0.113395341373300,
        0.207228841749490,  0.000000000000000,  0.000000000000000,  -0.031244628572789, -0.076995604880514, 0.000000000000000,  0.000000000000000,
        0.028461803337001,  0.047981980063917,  -0.000000000000000, -0.000000000000000, -0.045480790942453, -0.040949172817393, 0.000000000000000,
        0.000000000000000,  0.002064830317401,  -0.098532499897552, 0.431238792133616,  0.645497224367903,  -0.008047816631665, 0.100844722914658,
        -0.018639352488908, -0.004826470462147, -0.000000000000000, 0.000000000000000,  0.043704556808705,  0.070907091480131,  0.000000000000000,
        0.000000000000000,  -0.051063707024740, -0.059548566257628, 0.000000000000000,  0.000000000000000,  0.043555992115393,  0.045808294138989,
        0.000000000000000,  0.000000000000000,  -0.002271980116452, -0.007251893348320, 0.000000000000000,  0.000000000000000,  -0.033045753846530,
        -0.063047560795088, 0.000000000000000,  0.000000000000000,  -0.035623410908244, -0.024166217757147, 0.451930321280195,  0.364666511110126,
        -0.069585973499676, -0.071340886232071, 0.000000000000000,  0.000000000000000,  0.067485394190462,  0.129124963854380,  0.000000000000000,
        0.000000000000000,  -0.018912404695314, -0.045158848669880, 0.000000000000000,  0.000000000000000,  0.006574292386472,  0.022348616088863,
        0.000000000000000,  0.000000000000000,  -0.009348309097747, -0.015312215821863, 0.000000000000000,  0.000000000000000,  -0.032115445688012,
        -0.082485187210992, 0.000000000000000,  0.000000000000000,  -0.017071453537842, 0.015227262642676,  0.214253823347632,  0.790569415042096};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 36, 28));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.057762088330953,  0.040529151560973,  0.000000000000000,  0.000000000000000,  0.076994670542889,
        0.125051162801606,  0.000000000000000,  0.000000000000000,  -0.090360957946555, -0.067780718642850, 0.000000000000000,  0.000000000000000,
        0.063420830270991,  0.041458830949283,  -0.000000000000000, 0.000000000000000,  0.004424047338000,  -0.017796494477382, 0.000000000000000,
        0.000000000000000,  -0.112006921180567, -0.102148672127431, 0.494715444803513,  0.544221966806461,  0.025217943153199,  0.078549471482741,
        0.000000000000000,  0.000000000000000,  0.098880239745215,  0.090758269814034,  0.000000000000000,  0.000000000000000,  0.087173633109954,
        0.193933179374156,  0.000000000000000,  0.000000000000000,  -0.077474464726953, -0.094315223034034, 0.000000000000000,  0.000000000000000,
        0.034415911763129,  0.049566300401555,  0.000000000000000,  0.000000000000000,  0.003926622164349,  -0.022968361756448, 0.000000000000000,
        0.000000000000000,  -0.135094437985747, -0.166995145156356, 0.431238792133616,  0.645497224367903,  0.074268592016206,  0.176312609990473,
        0.018912053726797,  0.005364434761655,  0.000000000000000,  0.000000000000000,  0.044710575148964,  0.076508830078443,  0.000000000000000,
        0.000000000000000,  -0.033031805460020, -0.042472175818134, 0.000000000000000,  0.000000000000000,  0.039301587599806,  0.042819708723421,
        0.000000000000000,  0.000000000000000,  -0.023848718085704, -0.026245635737862, 0.000000000000000,  0.000000000000000,  -0.023018935102647,
        -0.032217731175944, 0.000000000000000,  0.000000000000000,  -0.019705045557914, -0.019797603949623, 0.451930321280196,  0.364666511110126,
        0.069274488611740,  0.071248823366875,  0.000000000000000,  0.000000000000000,  0.062862888448076,  0.127843612237511,  0.000000000000000,
        0.000000000000000,  -0.020515413503238, -0.041820911954152, 0.000000000000000,  0.000000000000000,  0.006099693924434,  0.021352437340449,
        0.000000000000000,  0.000000000000000,  -0.008158498489910, -0.019260219780235, 0.000000000000000,  0.000000000000000,  -0.055225087351858,
        -0.088413326042745, 0.000000000000000,  0.000000000000000,  0.040815825944324,  0.074674212385146,  0.214253823347632,  0.790569415042095,
        0.000000000000000,  0.000000000000000,  -0.001213109144678, -0.042428308618464, 0.000000000000000,  0.000000000000000,  -0.069496636364891,
        -0.008406251187698, 0.000000000000000,  0.000000000000000,  -0.026430362089273, 0.036067985071966,  -0.000000000000000, 0.000000000000000,
        -0.008568557893285, -0.004227338491684, 0.000000000000000,  0.000000000000000,  0.069333174892307,  -0.020150945535537, 0.428436142844360,
        0.471310048551927,  -0.053972817096580, -0.031210327873189, 0.000000000000000,  0.000000000000000,  -0.074562645454986, -0.099302660072766,
        0.000000000000000,  0.000000000000000,  0.053300959457492,  -0.019958746811904, 0.000000000000000,  0.000000000000000,  -0.075525301251613,
        -0.010552478277250, 0.000000000000000,  0.000000000000000,  0.017638338487348,  0.078668110261862,  0.000000000000000,  0.000000000000000,
        -0.015071905571581, -0.010548551736388, 0.000000000000000,  0.000000000000000,  0.016059614951473,  -0.050301458488074, 0.373463749085029,
        0.559016994374948,  -0.080921852048555, -0.032367264676465, 0.000000000000000,  0.000000000000000,  -0.112785793861359, -0.175050154989866,
        0.004435307700239,  -0.037975163960550, 0.000000000000000,  0.000000000000000,  -0.009273358714930, 0.009691309609390,  0.000000000000000,
        0.000000000000000,  0.009066736487492,  0.015798166786368,  0.000000000000000,  0.000000000000000,  0.009027084726536,  0.005567398772120,
        0.000000000000000,  0.000000000000000,  -0.003923592718304, -0.010035767028742, 0.000000000000000,  0.000000000000000,  0.016248345931479,
        0.004131910408718,  0.391383138969112,  0.315810462530809,  -0.068226612470365, -0.083177810672693, 0.000000000000000,  0.000000000000000,
        0.067488200210757,  0.024444372797283,  0.000000000000000,  0.000000000000000,  -0.014687115302641, -0.005012572207547, 0.000000000000000,
        0.000000000000000,  0.061390157438270,  0.095154256698391,  0.000000000000000,  0.000000000000000,  -0.009404598395345, -0.011443331166162,
        0.000000000000000,  -0.000000000000000, -0.037953433668130, -0.060311185088314, 0.000000000000000,  0.000000000000000,  -0.015211328999304,
        -0.014263184073243, 0.185549253876993,  0.684653196881458,  -0.147281795271204, -0.214189613733257, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.018952979858562,  0.043032911328578,  0.000000000000000,  0.000000000000000,  0.031922823750957,
        0.036580875703482,  0.000000000000000,  0.000000000000000,  -0.019018108098196, -0.013545532295023, 0.000000000000000,  0.000000000000000,
        0.015590345738161,  0.003383003934773,  0.362094629004386,  0.398329692829965,  -0.090261385563558, -0.102809529119988, 0.000000000000000,
        0.000000000000000,  0.024248668128055,  -0.037798733744248, 0.093492431192342,  0.102848284442025,  0.027089275766114,  -0.010080432037261,
        0.000000000000000,  0.000000000000000,  -0.007712852638788, 0.048996703996235,  0.000000000000000,  0.000000000000000,  0.053650286001555,
        0.081253442203469,  0.000000000000000,  0.000000000000000,  -0.017979408258720, -0.018943899353458, 0.000000000000000,  0.000000000000000,
        0.010431670290018,  -0.009139822207035, 0.315634476526075,  0.472455591261534,  -0.113374279039471, -0.147314027054690, 0.000000000000000,
        0.000000000000000,  -0.012968372100227, -0.079882971885521, 0.081496471404959,  0.121987509118567,  0.020990120899071,  -0.017476968127174,
        0.077674673771818,  0.091106093905592,  -0.000000000000000, -0.000000000000000, 0.014356566430291,  0.013777784429334,  0.000000000000000,
        0.000000000000000,  0.029453344261644,  0.020258584755748,  0.000000000000000,  0.000000000000000,  0.026029735429513,  0.011203357259520,
        0.000000000000000,  0.000000000000000,  -0.037946766255821, -0.060299904217735, 0.330779125128747,  0.266908556095694,  0.013082045875872,
        -0.007089962960226, 0.000000000000000,  0.000000000000000,  -0.064862595660362, -0.078519111879092, 0.085406802859780,  0.068915492847926,
        0.048120293312605,  0.089618720576963,  -0.000000000000000, 0.000000000000000,  0.041407756876963,  0.038579224644030,  0.000000000000000,
        0.000000000000000,  0.025065377277612,  0.026233293470426,  0.000000000000000,  0.000000000000000,  -0.027361568546293, -0.045294854461103,
        0.000000000000000,  0.000000000000000,  -0.063532004871916, -0.105022794240049, 0.156817741375842,  0.578637562357845,  -0.053663828051912,
        -0.093964658521987, 0.000000000000000,  0.000000000000000,  -0.106658034023403, -0.153697187391371, 0.040490166715900,  0.149403576166799,
        0.000000000000000,  0.000000000000000,  0.004810648493911,  -0.021047771408305, 0.000000000000000,  0.000000000000000,  -0.059850096785934,
        -0.009726173412835, 0.000000000000000,  0.000000000000000,  -0.028613484811977, 0.045112150512839,  0.418110863055600,  0.459951510763202,
        -0.044324568943974, -0.126529017797389, 0.000000000000000,  0.000000000000000,  0.029244097406021,  -0.006376953449083, 0.161933640948275,
        0.178138454124882,  -0.016054320379784, -0.027776309071721, 0.000000000000000,  0.000000000000000,  -0.007634359740686, 0.008951737157055,
        0.000000000000000,  0.000000000000000,  0.033313732890579,  -0.014963968283940, 0.000000000000000,  0.000000000000000,  -0.049675474263371,
        -0.013942451498423, 0.000000000000000,  0.000000000000000,  0.016642620317288,  0.108489349495066,  0.364463299975712,  0.545544725589981,
        -0.122024111157103, -0.206009512481811, 0.000000000000000,  0.000000000000000,  0.009304651433314,  -0.021203239447251, 0.141156029110973,
        0.211288563682129,  -0.041843232411832, -0.057048198148126, 0.000000000000000,  0.000000000000000,  -0.018898875247376, 0.006875478996881,
        0.056961219069929,  0.023409505235262,  0.000000000000000,  0.000000000000000,  -0.023838437609848, -0.013890845192905, -0.000000000000000,
        -0.000000000000000, 0.052042589082216,  0.055899726718189,  0.000000000000000,  0.000000000000000,  -0.033117854367137, -0.071258687421742,
        0.381950833870782,  0.308199453421727,  0.028096326369311,  0.021195920847612,  0.000000000000000,  0.000000000000000,  -0.017960331436506,
        -0.042550427318209, 0.147928921865158,  0.119365135041258,  0.074165241336371,  0.071747393330238,  0.000000000000000,  0.000000000000000,
        0.087428781507514,  0.084340503791496,  0.000000000000000,  0.000000000000000,  -0.015939211613876, -0.003262321408456, -0.000000000000000,
        0.000000000000000,  0.105555075947093,  0.135405594140927,  0.000000000000000,  0.000000000000000,  -0.134991138304511, -0.211634859821950,
        0.181077530394103,  0.668153104781061,  0.009570055746818,  0.006986247930522,  0.000000000000000,  0.000000000000000,  -0.122032894912189,
        -0.172687731292528, 0.070131025958873,  0.258774584753383,  0.055821900110932,  0.077963078385074,  0.000000000000000,  0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.025971082026348, 0.009939622533261,  0.000000000000000,  0.000000000000000,  -0.019304813530469,
        0.003976500857823,  -0.323867281896550, -0.356276908249765, 0.064877998595637,  0.103546140840498,  0.000000000000000,  0.000000000000000,
        -0.030859608378728, 0.025120057751079,  0.000000000000000,  0.000000000000000,  -0.007625753378509, -0.008711983305891, 0.000000000000000,
        0.000000000000000,  0.052300080485013,  0.007959125775792,  0.000000000000000,  0.000000000000000,  -0.010849149809444, 0.020802530492604,
        -0.000000000000000, 0.000000000000000,  -0.039837993639575, 0.004786348511566,  0.000000000000000,  0.000000000000000,  -0.019284407433320,
        0.001119472790833,  -0.282312058221946, -0.422577127364258, 0.100546712578883,  0.169808239520384,  0.000000000000000,  0.000000000000000,
        0.000131373659574,  0.075978423296940,  0.000000000000000,  0.000000000000000,  -0.024598381498307, -0.017392637755722, 0.000000000000000,
        0.000000000000000,  0.058499194812898,  0.022605987242340,  0.000000000000000,  0.000000000000000,  -0.038983986672818, 0.015409049830545,
        0.007330069865878,  0.017779968925851,  0.000000000000000,  -0.000000000000000, 0.002337795683853,  -0.021863683247659, 0.000000000000000,
        0.000000000000000,  0.017979821355566,  0.077353965251912,  -0.295857843730315, -0.238730270082515, 0.027313272869996,  0.033361576879127,
        0.000000000000000,  0.000000000000000,  -0.034530235739213, -0.020111563228597, -0.000000000000000, -0.000000000000000, 0.037483084474712,
        0.034125548051245,  0.000000000000000,  0.000000000000000,  -0.094184263955151, -0.036733953425713, -0.000000000000000, 0.000000000000000,
        -0.025293921810685, -0.015410440296993, 0.000000000000000,  -0.000000000000000, -0.070057118209569, -0.090648236604962, 0.000000000000000,
        0.000000000000000,  0.153563340765975,  0.240937556739735,  -0.140262051917746, -0.517549169506767, 0.073391999500809,  0.085001463486422,
        0.000000000000000,  0.000000000000000,  -0.022707004663820, -0.013652348945120, -0.000000000000000, 0.000000000000000,  0.091570403385510,
        0.107744110757298,  0.000000000000000,  0.000000000000000,  -0.091351366607725, -0.082096602557342, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.005432625748072, 0.011203092881310,  -0.161933640948275, -0.178138454124882, 0.038323933967631,
        0.035022278454231,  0.000000000000000,  0.000000000000000,  -0.028020101994232, 0.011673721137343,  0.000000000000000,  0.000000000000000,
        0.014910799545433,  0.002259371228639,  0.000000000000000,  0.000000000000000,  -0.038813298807546, 0.022970697615580,  0.000000000000000,
        0.000000000000000,  0.001111636141510,  -0.001330582136318, 0.000000000000000,  0.000000000000000,  0.020702837478400,  -0.016166185357781,
        0.000000000000000,  0.000000000000000,  -0.020345806137225, 0.007564420842833,  -0.141156029110973, -0.211288563682129, 0.065217608471486,
        0.067792535619239,  0.000000000000000,  0.000000000000000,  -0.018784119825133, 0.030297540535280,  0.000000000000000,  0.000000000000000,
        0.005544191282592,  0.004493094702254,  0.000000000000000,  0.000000000000000,  -0.011776734559167, 0.059168973875171,  0.000000000000000,
        0.000000000000000,  -0.001115109076354, -0.002056242783377, 0.000000000000000,  0.000000000000000,  0.040918294528214,  -0.009659668099974,
        -0.119164128392150, -0.071532129332801, 0.000000000000000,  0.000000000000000,  0.049032296682626,  0.061966066295047,  -0.147928921865158,
        -0.119365135041258, -0.025379434525416, 0.001696116929470,  0.000000000000000,  0.000000000000000,  0.018243987923074,  0.023704824990072,
        0.000000000000000,  0.000000000000000,  0.043761923376858,  0.028951600377292,  0.000000000000000,  0.000000000000000,  -0.012480895042028,
        0.016576939570195,  -0.000000000000000, -0.000000000000000, 0.022200929388118,  0.007909277063204,  0.000000000000000,  0.000000000000000,
        -0.108657198600586, -0.116806243352556, 0.000000000000000,  0.000000000000000,  0.144710710558408,  0.195498107853423,  -0.070131025958873,
        -0.258774584753383, 0.034833969859178,  0.070061564086794,  0.000000000000000,  0.000000000000000,  0.025359363004115,  0.026575247004303,
        0.000000000000000,  0.000000000000000,  0.021186737486302,  0.013077845289997,  0.000000000000000,  0.000000000000000,  0.042884578429342,
        0.063534388727975,  -0.000000000000000, 0.000000000000000,  0.072121931145407,  0.069955636995943,  0.000000000000000,  0.000000000000000,
        -0.093492431192343, -0.102848284442025, -0.021795253913731, 0.016915888307643,  0.000000000000000,  0.000000000000000,  0.003666998561137,
        0.045803934110137,  -0.362094629004386, -0.398329692829965, 0.075634222225331,  0.102055247802253,  0.000000000000000,  0.000000000000000,
        -0.023647950638706, 0.015788406678663,  0.000000000000000,  0.000000000000000,  -0.019734252777103, -0.017182183497051, 0.000000000000000,
        0.000000000000000,  0.046024995599049,  0.037053668794154,  0.000000000000000,  0.000000000000000,  0.025072157196928,  0.036825968339639,
        -0.081496471404959, -0.121987509118567, -0.026803442887593, 0.023285457733459,  0.000000000000000,  0.000000000000000,  0.026145932795240,
        0.090386686883472,  -0.315634476526075, -0.472455591261534, 0.095876443216478,  0.145620688868722,  0.000000000000000,  0.000000000000000,
        0.002826814384050,  0.046804183229870,  0.000000000000000,  0.000000000000000,  -0.034034018521660, -0.019263168031762, 0.000000000000000,
        0.000000000000000,  0.058641318732901,  0.081707552897384,  0.000000000000000,  0.000000000000000,  0.005862411373906,  0.044387953553725,
        0.047637009063405,  0.078044643421767,  -0.085406802859780, -0.068915492847926, -0.008403885374886, 0.022105101550607,  0.000000000000000,
        0.000000000000000,  0.033606572914227,  0.057140646983243,  -0.330779125128747, -0.266908556095694, -0.028426286458739, -0.003798140992426,
        0.000000000000000,  0.000000000000000,  -0.003305013930871, -0.002200758227945, 0.000000000000000,  0.000000000000000,  0.001797692782229,
        0.012321976892532,  0.000000000000000,  0.000000000000000,  0.082569953995726,  0.085138357797776,  -0.000000000000000, -0.000000000000000,
        0.093728558527104,  0.145170554556078,  -0.040490166715900, -0.149403576166799, 0.068993017847872,  0.114572232808933,  0.000000000000000,
        0.000000000000000,  0.051394342922891,  0.095457384541693,  -0.156817741375842, -0.578637562357845, 0.053298509036715,  0.085668834506828,
        0.000000000000000,  0.000000000000000,  0.000705731145842,  -0.000568803853190, 0.000000000000000,  0.000000000000000,  0.043945779734494,
        0.042407514685992,  0.000000000000000,  0.000000000000000,  0.059360212393642,  0.095880516564378,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.076892026463351,  0.098890438162571,  -0.428436142844360, -0.471310048551927, 0.070679994403983,
        0.033850019523020,  0.000000000000000,  0.000000000000000,  -0.044066496756308, 0.018746577894421,  0.000000000000000,  0.000000000000000,
        0.050985312614466,  -0.008539285219204, 0.000000000000000,  0.000000000000000,  -0.003322897890241, 0.036967554603362,  0.000000000000000,
        0.000000000000000,  -0.077035569161497, -0.010833839633744, 0.000000000000000,  0.000000000000000,  -0.003649966837086, -0.045339988283546,
        0.000000000000000,  0.000000000000000,  0.115175136862328,  0.174885087283434,  -0.373463749085028, -0.559016994374947, 0.083331236654928,
        0.033660615247382,  0.000000000000000,  0.000000000000000,  -0.028240735209270, 0.039395411013415,  0.000000000000000,  0.000000000000000,
        0.004507176667854,  -0.026042595214385, 0.000000000000000,  0.000000000000000,  0.025986152825142,  0.078268684185992,  0.000000000000000,
        0.000000000000000,  -0.073730818212572, -0.011661434943452, 0.000000000000000,  0.000000000000000,  0.056819185218163,  -0.022087566773732,
        0.066245107093654,  0.081515329744440,  0.000000000000000,  0.000000000000000,  -0.018272604084236, -0.000233775025729, -0.391383138969112,
        -0.315810462530809, 0.004421857180524,  0.013147109440466,  0.000000000000000,  0.000000000000000,  -0.005319082215714, -0.000034951542023,
        0.000000000000000,  0.000000000000000,  -0.001097312821695, 0.012171714020184,  0.000000000000000,  0.000000000000000,  -0.015877895146516,
        0.002821131504703,  0.000000000000000,  0.000000000000000,  0.007466503015103,  -0.040381719168816, 0.000000000000000,  0.000000000000000,
        0.147956764770007,  0.214391779560141,  0.000000000000000,  0.000000000000000,  0.013297057012566,  0.013965755879779,  -0.185549253876993,
        -0.684653196881458, 0.013936459312063,  0.035639611609990,  0.000000000000000,  0.000000000000000,  -0.018882794378429, -0.023177951404558,
        0.000000000000000,  0.000000000000000,  0.057439060231139,  0.090764005608055,  0.000000000000000,  0.000000000000000,  -0.013121925690890,
        -0.004951791236688, 0.000000000000000,  0.000000000000000,  0.072136846289552,  0.027051634127647,  0.000000000000000,  0.000000000000000,
        -0.494715444803513, -0.544221966806461, -0.026328122334887, -0.079500861023815, 0.000000000000000,  0.000000000000000,  0.112377144485169,
        0.101401622030891,  -0.000000000000000, -0.000000000000000, 0.025586123131171,  0.030917435413837,  0.000000000000000,  0.000000000000000,
        0.029610790892776,  0.010325316477799,  0.000000000000000,  0.000000000000000,  -0.108728525451818, -0.079831980005423, 0.000000000000000,
        0.000000000000000,  0.066824399262988,  0.120620860278080,  0.000000000000000,  0.000000000000000,  0.056617228603624,  0.040097237024099,
        -0.431238792133616, -0.645497224367903, -0.073736101897765, -0.177114056460358, 0.000000000000000,  0.000000000000000,  0.136062875726909,
        0.166354550249061,  -0.000000000000000, -0.000000000000000, 0.008505701716576,  0.037187959391923,  0.000000000000000,  0.000000000000000,
        0.020719124802057,  0.013419156901577,  0.000000000000000,  0.000000000000000,  -0.081558096938949, -0.106743127949218, 0.000000000000000,
        0.000000000000000,  0.084833833735676,  0.189654384241000,  0.000000000000000,  0.000000000000000,  0.098687393631019,  0.090365992963625,
        0.019040173929188,  0.018477843188087,  -0.451930321280195, -0.364666511110126, 0.019768368254860,  0.029996006603913,  0.000000000000000,
        0.000000000000000,  0.033036407400880,  0.038333704942547,  0.000000000000000,  0.000000000000000,  -0.002303709397697, 0.001357895087367,
        0.000000000000000,  0.000000000000000,  -0.051063707024740, -0.059548566257628, 0.000000000000000,  -0.000000000000000, 0.039826518822267,
        0.070598147941087,  0.000000000000000,  0.000000000000000,  0.019279172938576,  0.005114454495398,  0.000000000000000,  0.000000000000000,
        -0.040049714237843, -0.074447266118618, -0.214253823347632, -0.790569415042096, 0.055211173620262,  0.087978922199114,  0.000000000000000,
        0.000000000000000,  0.005628093138722,  0.021069509376219,  0.000000000000000,  -0.000000000000000, 0.000078636315475,  0.001837731279084,
        0.000000000000000,  0.000000000000000,  -0.018912404695314, -0.045158848669880, -0.000000000000000, 0.000000000000000,  0.063960231461824,
        0.127119088935242,  0.000000000000000,  0.000000000000000,  0.069653623461353,  0.071422222455604,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 36, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.027078386138035,  0.024749082591828,  0.000000000000000,  0.000000000000000,  0.023911634347318,
        0.002892860174882,  0.000000000000000,  0.000000000000000,  -0.027896000581314, -0.002974415407513, 0.000000000000000,  0.000000000000000,
        0.014968457168580,  0.000336048765749,  0.000000000000000,  0.000000000000000,  0.012414769093386,  0.001031725199334,  0.000000000000000,
        0.000000000000000,  -0.050860799521591, -0.006778585855959, 0.000000000000000,  0.000000000000000,  0.038704902956424,  0.036999965622862,
        0.000000000000000,  0.000000000000000,  0.053794586652344,  0.056989010437002,  0.000000000000000,  0.000000000000000,  0.023042733654748,
        0.003321197187506,  0.000000000000000,  0.000000000000000,  -0.022143668862298, -0.004538229084778, 0.000000000000000,  0.000000000000000,
        0.008510333464500,  -0.000151896378992, 0.000000000000000,  0.000000000000000,  0.008442489087694,  0.001552181287229,  0.000000000000000,
        0.000000000000000,  -0.052340655253002, -0.007833957273736, 0.000000000000000,  0.000000000000000,  0.079561892390922,  0.085300886097349,
        -0.023176373642119, -0.038711835343769, 0.000000000000000,  0.000000000000000,  -0.047042395738523, -0.043362075776814, 0.000000000000000,
        0.000000000000000,  0.079299390795379,  0.056837555278441,  0.000000000000000,  0.000000000000000,  -0.042870611092035, -0.024757531980476,
        0.000000000000000,  0.000000000000000,  -0.031793013729463, -0.019034685886267, -0.000000000000000, 0.000000000000000,  0.100307916380557,
        0.098679643605639,  0.000000000000000,  0.000000000000000,  -0.033005054226590, -0.057275796924213, 0.000000000000000,  0.000000000000000,
        -0.035821711823903, -0.069796998258400, 0.000000000000000,  0.000000000000000,  -0.048816745431011, -0.066994896794657, 0.000000000000000,
        0.000000000000000,  0.050841304389029,  0.061567450184954,  -0.000000000000000, 0.000000000000000,  -0.019259825727761, -0.021413988352261,
        0.000000000000000,  0.000000000000000,  -0.014476276122401, -0.016782769009982, 0.000000000000000,  0.000000000000000,  0.114356914534726,
        0.158025895307268,  0.000000000000000,  0.000000000000000,  -0.053546530341243, -0.104471822772886, 0.000000000000000,  0.000000000000000,
        0.349816645778283,  0.384823043199529,  -0.034522258058987, 0.055504530020285,  0.000000000000000,  0.000000000000000,  -0.040416066307150,
        -0.037723751789755, 0.000000000000000,  0.000000000000000,  -0.036894417761855, -0.024683766072372, 0.000000000000000,  0.000000000000000,
        -0.011061075027871, -0.004558298764580, 0.000000000000000,  0.000000000000000,  0.065617406892792,  0.051645569440796,  0.000000000000000,
        0.000000000000000,  -0.053884378447425, -0.055660751139087, 0.000000000000000,  0.000000000000000,  0.002265972376090,  0.000305387846407,
        0.304931874228376,  0.456435464587639,  0.004786367948912,  0.133113469134719,  0.000000000000000,  0.000000000000000,  -0.026567744803658,
        -0.037620347037605, -0.000000000000000, 0.000000000000000,  -0.016909995677407, -0.033021744411934, 0.000000000000000,  0.000000000000000,
        -0.003140657108991, -0.004234387639724, 0.000000000000000,  0.000000000000000,  0.029741864177756,  0.069856474922304,  0.000000000000000,
        0.000000000000000,  -0.038281748718457, -0.055798504527288, 0.000000000000000,  0.000000000000000,  0.001280020490588,  0.000377456636185,
        0.015877490905208,  -0.001193983278579, 0.319562994801041,  0.257858162877610,  0.037213792231805,  0.018952790426491,  0.000000000000000,
        0.000000000000000,  0.032223227946512,  -0.004053239146602, 0.000000000000000,  0.000000000000000,  0.009574267056180,  -0.000630059661704,
        0.000000000000000,  0.000000000000000,  -0.059336741281446, 0.009978920292736,  0.000000000000000,  0.000000000000000,  0.049331871202215,
        0.027328937349656,  0.000000000000000,  0.000000000000000,  -0.001014734582905, -0.000344975901028, -0.000000000000000, 0.000000000000000,
        -0.007013421386732, -0.009898427353306, 0.151500331384255,  0.559016994374948,  0.058327950806957,  0.046075327094278,  0.000000000000000,
        0.000000000000000,  -0.002096885659169, -0.021262618250099, -0.000000000000000, -0.000000000000000, 0.002424383752500,  -0.001101970140950,
        0.000000000000000,  0.000000000000000,  0.004988228692895,  0.047026503054659,  0.000000000000000,  0.000000000000000,  0.086014535923650,
        0.068338932251117,  0.000000000000000,  0.000000000000000,  -0.000042858854192, -0.000028067986783, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.083733473292421, -0.095761802661260, 0.458017502467011,  0.503851635607172,  0.012331417115483,
        0.018619672567818,  0.000000000000000,  0.000000000000000,  -0.050804625951705, -0.018177497158087, 0.000000000000000,  0.000000000000000,
        -0.024151388187597, 0.021657491422629,  0.000000000000000,  0.000000000000000,  -0.043272476037459, -0.017702065419835, 0.000000000000000,
        0.000000000000000,  0.011913462544304,  -0.000488785323754, 0.000000000000000,  0.000000000000000,  0.153149360742655,  0.148422400717502,
        0.000000000000000,  0.000000000000000,  -0.116305825108214, -0.160354730434213, 0.399249541558939,  0.597614304667197,  0.043414313796975,
        0.089623501921872,  0.000000000000000,  0.000000000000000,  -0.045600198693274, -0.021438301765320, 0.000000000000000,  0.000000000000000,
        0.025845076241260,  0.057850647530900,  0.000000000000000,  0.000000000000000,  -0.051261140364662, -0.016804266504154, 0.000000000000000,
        0.000000000000000,  -0.002908130527590, -0.003272105277209, 0.000000000000000,  0.000000000000000,  0.191002829669516,  0.246515734461922,
        0.005413179024717,  -0.002789499247164, -0.000000000000000, -0.000000000000000, -0.026843998689420, -0.046935499252511, 0.418406175137871,
        0.337615585699685,  0.043355660732153,  0.039059256043948,  0.000000000000000,  0.000000000000000,  -0.019325565990851, -0.023598689375346,
        -0.000000000000000, 0.000000000000000,  0.060589474053477,  0.066976333917086,  0.000000000000000,  0.000000000000000,  -0.010419666071604,
        -0.000960085114387, 0.000000000000000,  0.000000000000000,  -0.015606071475068, 0.001743172980213,  0.000000000000000,  0.000000000000000,
        -0.013462155066278, -0.031564211002121, -0.000000000000000, 0.000000000000000,  0.001973694041578,  -0.026157832576695, 0.198360496108355,
        0.731925054711400,  0.050539340731316,  0.063945395538710,  0.000000000000000,  0.000000000000000,  0.027561278948903,  0.042657539732409,
        0.000000000000000,  0.000000000000000,  0.084532366824449,  0.105106843897664,  0.000000000000000,  0.000000000000000,  -0.006083733769649,
        -0.005145250176199, 0.000000000000000,  0.000000000000000,  0.019937006590859,  0.047233180675730,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.115097636157530, -0.052626136683455, 0.000000000000000,  0.000000000000000,  -0.039416025000925,
        -0.041507080190634, 0.512079135200457,  0.563323253896045,  -0.102877049222521, -0.077245679437821, 0.000000000000000,  0.000000000000000,
        0.002614637582901,  0.022665196477222,  0.000000000000000,  0.000000000000000,  -0.001012682096178, -0.020981459085829, 0.000000000000000,
        0.000000000000000,  0.039143212493290,  0.076659677711938,  0.000000000000000,  0.000000000000000,  -0.133692613564635, -0.090037639410707,
        -0.000000000000000, 0.000000000000000,  -0.100450410952214, -0.077855650089951, 0.000000000000000,  0.000000000000000,  -0.049931785272418,
        -0.084832007878256, 0.446374557455708,  0.668153104781062,  -0.058983513209724, -0.049395512802486, 0.000000000000000,  0.000000000000000,
        -0.002533883009062, 0.057892445442013,  0.000000000000000,  0.000000000000000,  -0.027449625876354, -0.051972842163423, 0.000000000000000,
        0.000000000000000,  0.122861882617771,  0.165036625799378,  0.000000000000000,  0.000000000000000,  -0.143446403293859, -0.138833005208917,
        0.013749767120708,  0.001475058803150,  0.000000000000000,  0.000000000000000,  0.026347630595976,  0.009921429979116,  -0.000000000000000,
        -0.000000000000000, 0.028926329368324,  -0.034278280005480, 0.467792324906982,  0.377465699943951,  0.015690223022157,  0.056333198584289,
        0.000000000000000,  0.000000000000000,  -0.002840977945441, 0.002345551745904,  0.000000000000000,  0.000000000000000,  -0.001857715429884,
        -0.012698800063850, 0.000000000000000,  0.000000000000000,  0.007191954363487,  -0.003044801238021, 0.000000000000000,  0.000000000000000,
        -0.005110163284891, -0.011696015928758, -0.000000000000000, -0.000000000000000, -0.022403725852894, -0.035536759104525, -0.000000000000000,
        0.000000000000000,  0.035450911444182,  -0.017609338406758, 0.221773776674433,  0.818317088384972,  0.104784828295144,  0.145767432345059,
        0.000000000000000,  0.000000000000000,  -0.028834179951535, -0.034881331886679, 0.000000000000000,  0.000000000000000,  0.073327451226013,
        0.086797889367705,  0.000000000000000,  0.000000000000000,  -0.010469310885646, -0.023150308873184, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.034436388081692, -0.012695704322782, 0.000000000000000,  0.000000000000000,  0.014518378986800,
        0.049459834392304,  0.000000000000000,  0.000000000000000,  0.039167578015169,  -0.044178990247252, 0.528873056685777,  0.581797754898868,
        -0.080533876194316, -0.079138505362744, 0.000000000000000,  0.000000000000000,  0.026111718676779,  -0.029452660164834, 0.000000000000000,
        0.000000000000000,  -0.006049324577833, -0.020608264330127, 0.000000000000000,  0.000000000000000,  0.176008205750868,  0.064889155427551,
        0.000000000000000,  0.000000000000000,  -0.027485479627600, -0.017699962179625, 0.000000000000000,  0.000000000000000,  0.111491509017682,
        0.114490628147353,  0.000000000000000,  0.000000000000000,  -0.040641766838198, -0.120806550379327, 0.461013660585776,  0.690065559342354,
        -0.075263311473459, -0.053629949942830, 0.000000000000000,  0.000000000000000,  -0.027094511225466, -0.080537700252885, 0.000000000000000,
        0.000000000000000,  -0.046454795424034, -0.047704428394730, 0.000000000000000,  0.000000000000000,  0.140481340318842,  0.090466473362529,
        0.003861693875814,  0.000125303005249,  0.000000000000000,  0.000000000000000,  0.020252345816494,  -0.015582216655179, -0.000000000000000,
        0.000000000000000,  -0.036672062862514, -0.025710321422400, -0.000000000000000, 0.000000000000000,  0.029721224790970,  -0.013246375930252,
        0.483133835692903,  0.389844898572652,  -0.024448041908342, -0.017140214281600, -0.000000000000000, -0.000000000000000, -0.008438477423539,
        0.006492590272991,  0.000000000000000,  0.000000000000000,  -0.019737546476383, -0.000640437582384, -0.000000000000000, -0.000000000000000,
        -0.001273289417677, -0.002659415173175, 0.000000000000000,  0.000000000000000,  0.064874612464063,  0.062614940288278,  0.000000000000000,
        0.000000000000000,  -0.114729519688592, -0.142806452207322, 0.000000000000000,  0.000000000000000,  0.046965208041552,  0.000866369135377,
        0.229046971649493,  0.845154254728517,  -0.076486346459061, -0.095204301471548, -0.000000000000000, 0.000000000000000,  -0.027031088526693,
        -0.026089558453449, 0.000000000000000,  0.000000000000000,  0.006507923690350,  0.013592566440674,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.218036822566669,  0.111496271735905,  0.000000000000000,  0.000000000000000,  -0.043754172110543,
        -0.073336818305941, 0.000000000000000,  0.000000000000000,  -0.001012682096178, -0.020981459085829, 0.000000000000000,  0.000000000000000,
        0.001743091721934,  0.015110130984815,  0.512079135200457,  0.563323253896045,  -0.102033147475706, -0.059761130199630, 0.000000000000000,
        0.000000000000000,  -0.015848898068297, -0.058490583821285, -0.000000000000000, -0.000000000000000, -0.031456295563847, -0.031346326294300,
        0.000000000000000,  0.000000000000000,  0.201218345892354,  0.167247534798838,  0.000000000000000,  0.000000000000000,  -0.111793219992584,
        -0.156316176418918, 0.000000000000000,  0.000000000000000,  -0.027449625876354, -0.051972842163423, 0.000000000000000,  0.000000000000000,
        -0.001689255339375, 0.038594963628008,  0.446374557455707,  0.668153104781062,  -0.036108824979429, -0.006084810999633, 0.000000000000000,
        0.000000000000000,  -0.106504949801152, -0.129403193600608, 0.000000000000000,  -0.000000000000000, -0.043159901208708, -0.049677908246614,
        -0.022462656568346, -0.000851614362915, -0.000000000000000, 0.000000000000000,  0.010549345536979,  0.013202648888040,  -0.000000000000000,
        0.000000000000000,  -0.002840977945441, 0.002345551745904,  0.000000000000000,  0.000000000000000,  0.010460148681438,  0.037555465722860,
        0.000000000000000,  0.000000000000000,  0.031293810989525,  -0.036232906460400, 0.467792324906982,  0.377465699943951,  -0.018076256618067,
        0.007346202655478,  -0.000000000000000, -0.000000000000000, -0.001393679232444, -0.002388886667778, -0.000000000000000, -0.000000000000000,
        0.011531488991026,  0.026061628018649,  0.000000000000000,  0.000000000000000,  -0.064160867584473, -0.079068793049801, 0.000000000000000,
        0.000000000000000,  -0.028834179951535, -0.034881331886679, 0.000000000000000,  0.000000000000000,  0.069856552196763,  0.097178288230039,
        0.000000000000000,  0.000000000000000,  0.059479394737128,  0.011458438165475,  0.221773776674433,  0.818317088384972,  -0.069255153354097,
        -0.075041029173812, -0.000000000000000, 0.000000000000000,  -0.004056836663722, -0.008808957776172, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.110977968358034, -0.141105788037527, 0.000000000000000,  0.000000000000000,  0.011913462544304,
        -0.000488785323754, 0.000000000000000,  0.000000000000000,  0.033392137170430,  0.014832811324647,  0.000000000000000,  0.000000000000000,
        0.010063078411499,  -0.009023954759429, 0.000000000000000,  0.000000000000000,  -0.000305116186887, -0.003512420671567, 0.458017502467010,
        0.503851635607172,  0.035959784495020,  0.017650248342373,  0.000000000000000,  0.000000000000000,  -0.092351412774705, -0.097256989842093,
        0.000000000000000,  0.000000000000000,  -0.165677642673887, -0.237356164282616, 0.000000000000000,  0.000000000000000,  -0.002908130527590,
        -0.003272105277209, 0.000000000000000,  0.000000000000000,  0.046119393062087,  0.012198310661006,  0.000000000000000,  0.000000000000000,
        -0.010768781767192, -0.024104436471208, 0.000000000000000,  0.000000000000000,  -0.019320156924559, 0.002103250321881,  0.399249541558939,
        0.597614304667197,  0.037646521583921,  0.083133826455408,  0.000000000000000,  0.000000000000000,  -0.121481156454055, -0.162226535395479,
        0.004146269285372,  -0.005479896843414, -0.000000000000000, 0.000000000000000,  -0.010419666071604, -0.000960085114387, 0.000000000000000,
        0.000000000000000,  -0.059256268940051, -0.069492568872436, -0.000000000000000, 0.000000000000000,  0.008052319162855,  0.009832787239727,
        0.000000000000000,  0.000000000000000,  0.036541501263532,  0.051920012482400,  0.000000000000000,  0.000000000000000,  -0.047509669731434,
        -0.048839668062711, 0.418406175137871,  0.337615585699685,  0.007755048148910,  -0.002025880635254, -0.000000000000000, -0.000000000000000,
        -0.020329229480883, -0.047406365519291, 0.000000000000000,  0.000000000000000,  -0.006083733769649, -0.005145250176199, 0.000000000000000,
        0.000000000000000,  -0.087149373542692, -0.107863469074544, 0.000000000000000,  0.000000000000000,  -0.011483866228710, -0.017773974888504,
        0.000000000000000,  0.000000000000000,  0.063915152846778,  0.078034813109429,  0.000000000000000,  0.000000000000000,  -0.010092377934893,
        -0.036362578759488, 0.198360496108355,  0.731925054711401,  -0.013382002314883, -0.031528819794559, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.002265972376090,  0.000305387846407,  0.000000000000000,  0.000000000000000,  0.073322124558248,
        0.058328148712471,  0.000000000000000,  0.000000000000000,  -0.032386688435315, -0.040637643161234, 0.000000000000000,  0.000000000000000,
        0.056534383475785,  0.023297971463410,  -0.000000000000000, -0.000000000000000, -0.003940621958190, -0.013767572511807, 0.000000000000000,
        0.000000000000000,  -0.044388269029965, -0.038268848111284, 0.349816645778283,  0.384823043199529,  -0.045660552226483, 0.054003408601353,
        0.000000000000000,  0.000000000000000,  0.001280020490588,  0.000377456636185,  0.000000000000000,  0.000000000000000,  0.042809340441922,
        0.057621275393876,  0.000000000000000,  0.000000000000000,  -0.014028638890770, -0.056239501492831, 0.000000000000000,  0.000000000000000,
        0.016052247445952,  0.021642425714147,  0.000000000000000,  -0.000000000000000, -0.001327713934479, -0.019518245761039, 0.000000000000000,
        0.000000000000000,  -0.027492981303261, -0.037992839576505, 0.304931874228376,  0.456435464587639,  -0.001505520211346, 0.131258096538981,
        -0.001014734582905, -0.000344975901028, -0.000000000000000, 0.000000000000000,  -0.068045996013128, -0.030502117200758, -0.000000000000000,
        0.000000000000000,  0.033251225643502,  -0.010342900496924, -0.000000000000000, 0.000000000000000,  -0.048935142731587, 0.003220304937597,
        -0.000000000000000, 0.000000000000000,  0.006355091605550,  -0.004414186182422, -0.000000000000000, -0.000000000000000, 0.041038119245090,
        0.019601245940452,  0.000000000000000,  0.000000000000000,  0.020865377079632,  0.000501731597246,  0.319562994801041,  0.257858162877610,
        -0.000042858854192, -0.000028067986783, 0.000000000000000,  0.000000000000000,  -0.090275415156554, -0.070571361521692, 0.000000000000000,
        0.000000000000000,  -0.004924030302881, -0.041223922263965, 0.000000000000000,  0.000000000000000,  -0.012391294734998, 0.005632291831523,
        0.000000000000000,  0.000000000000000,  -0.002033222255738, -0.015508392299328, 0.000000000000000,  0.000000000000000,  0.059198683246512,
        0.046531535420928,  0.000000000000000,  0.000000000000000,  -0.006802750448854, -0.009760460316825, 0.151500331384255,  0.559016994374948,
        0.000000000000000,  0.000000000000000,  -0.039896709208391, -0.037077018230769, 0.000000000000000,  0.000000000000000,  0.052753116668339,
        0.006826212834528,  0.000000000000000,  0.000000000000000,  0.000964024864539,  -0.000166759972475, -0.000000000000000, 0.000000000000000,
        0.014843720025508,  0.000333248359368,  0.000000000000000,  0.000000000000000,  -0.030630025477238, -0.003151175470623, 0.000000000000000,
        0.000000000000000,  0.019260830731820,  0.002775805946154,  0.000000000000000,  0.000000000000000,  0.025322688638509,  0.024635573310592,
        0.000000000000000,  0.000000000000000,  -0.080265998102016, -0.085414684263207, 0.000000000000000,  0.000000000000000,  0.053199358953713,
        0.007873651401312,  0.000000000000000,  0.000000000000000,  -0.000538448294338, -0.000274723469486, 0.000000000000000,  0.000000000000000,
        0.008439414018962,  -0.000150630575834, 0.000000000000000,  0.000000000000000,  -0.023758899979198, -0.004799284116210, 0.000000000000000,
        0.000000000000000,  0.020932272264716,  0.003223639760430,  0.000000000000000,  0.000000000000000,  0.052757340342947,  0.056821369803369,
        0.034101418826952,  0.057769272085392,  -0.000000000000000, 0.000000000000000,  -0.103959069758880, -0.100242098815098, -0.000000000000000,
        0.000000000000000,  0.000488803904888,  0.003814632714166,  0.000000000000000,  0.000000000000000,  -0.042513355999601, -0.024551219213972,
        0.000000000000000,  0.000000000000000,  0.085696566002411,  0.059947850901550,  -0.000000000000000, 0.000000000000000,  -0.038068848486242,
        -0.039521983565160, 0.000000000000000,  0.000000000000000,  -0.021561275060242, -0.037984877329301, 0.000000000000000,  0.000000000000000,
        0.053662451961499,  0.104611196492895,  0.000000000000000,  0.000000000000000,  -0.115169628570354, -0.158826601748418, 0.000000000000000,
        0.000000000000000,  0.005766390520781,  0.007673070641049,  0.000000000000000,  0.000000000000000,  -0.019099327180029, -0.021235538449326,
        0.000000000000000,  0.000000000000000,  0.052621214009461,  0.063429063586981,  0.000000000000000,  0.000000000000000,  -0.046819314196105,
        -0.065026976978546, 0.000000000000000,  0.000000000000000,  -0.035650943044591, -0.069591681252121, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 36, 28));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeGGForLiH)
{
    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix dipxmat(36, 36);

    CDenseMatrix dipymat(36, 36);

    CDenseMatrix dipzmat(36, 36);

    dipdrv.compute(dipxmat.values(), dipymat.values(), dipzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.006821341833058, -0.039098286446571, 0.000000000000000,  0.000000000000000,  0.034200684162914,
        -0.061155262375952, 0.000000000000000,  0.000000000000000,  -0.023619028986785, 0.050032644692810,  0.000000000000000,  0.000000000000000,
        0.064359224443025,  0.045155681388649,  0.000000000000000,  0.000000000000000,  -0.013079985661420, 0.005264530981218,  0.000000000000000,
        0.000000000000000,  -0.057553311331311, -0.077494519328308, 0.000000000000000,  0.000000000000000,  0.085640842612310,  0.116415429758019,
        0.000000000000000,  0.000000000000000,  -0.082461244151037, -0.053896036163021, 0.000000000000000,  0.000000000000000,  0.059119062138170,
        0.169242204909982,  0.000000000000000,  0.000000000000000,  0.012633928260685,  -0.029843948175081, 0.000000000000000,  0.000000000000000,
        0.009574932803796,  -0.120006616759786, 0.000000000000000,  0.000000000000000,  -0.028373203921344, 0.055672014644282,  0.000000000000000,
        0.000000000000000,  0.037204554474458,  0.053456391280975,  0.000000000000000,  0.000000000000000,  -0.013128113702966, 0.003113662720051,
        0.000000000000000,  0.000000000000000,  -0.016960756457656, -0.084680156746780, 0.000000000000000,  0.000000000000000,  0.082313495850095,
        0.161113199157626,  0.000000000000000,  0.000000000000000,  -0.112166982876032, -0.107074789470815, 0.000000000000000,  0.000000000000000,
        0.103044920220173,  0.306783947871049,  -0.006821341833058, 0.012633928260685,  0.400000000000000,  0.184508281839215,  -0.058883842148247,
        -0.036602054861462, 0.000000000000000,  0.000000000000000,  -0.023690564415310, -0.055967775832442, -0.000000000000000, 0.000000000000000,
        -0.022302716510014, -0.027770838878246, 0.000000000000000,  0.000000000000000,  -0.020162989090149, -0.019199558526272, 0.000000000000000,
        0.000000000000000,  0.057755951945061,  0.079241500430763,  0.000000000000000,  0.000000000000000,  -0.028424944316171, -0.053636243484735,
        -0.000000000000000, 0.000000000000000,  0.032354201590300,  0.008576938294578,  0.000000000000000,  0.000000000000000,  -0.058930167452621,
        -0.103214201527832, 0.000000000000000,  0.000000000000000,  -0.039098286446571, -0.029843948175081, 0.184508281839215,  0.400000000000001,
        -0.015376323530953, 0.014461492783577,  0.000000000000000,  0.000000000000000,  0.005017790909769,  -0.020504083257299, -0.000000000000000,
        -0.000000000000000, -0.001032739853789, -0.009782262118431, 0.000000000000000,  0.000000000000000,  0.000999365654843,  -0.002561012836084,
        0.000000000000000,  0.000000000000000,  -0.001892621968710, 0.022641227947703,  0.000000000000000,  0.000000000000000,  -0.023922010093523,
        -0.055543533534681, 0.000000000000000,  0.000000000000000,  0.062134561807731,  0.068761681891073,  0.000000000000000,  0.000000000000000,
        -0.169075370455401, -0.306682000304054, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.058883842148247,
        -0.015376323530953, 0.000000000000000,  0.000000000000000,  0.004309644572538,  0.011107343649414,  0.000000000000000,  0.000000000000000,
        -0.027036756721736, -0.085027175169007, 0.000000000000000,  0.000000000000000,  0.043108420249234,  0.033757993808592,  0.000000000000000,
        0.000000000000000,  -0.027004513311476, -0.051997991481490, 0.000000000000000,  0.000000000000000,  0.007806753336187,  0.067397374178108,
        0.000000000000000,  0.000000000000000,  0.038339976636594,  -0.003891840077239, 0.000000000000000,  0.000000000000000,  -0.098985759846868,
        -0.050175312133182, 0.000000000000000,  0.000000000000000,  -0.030745452778552, -0.062344527473845, 0.000000000000000,  0.000000000000000,
        -0.036602054861462, 0.014461492783577,  0.000000000000000,  0.000000000000000,  -0.020160782676027, 0.002249530341763,  0.000000000000000,
        0.000000000000000,  -0.031203244191271, -0.160067566321820, 0.000000000000000,  0.000000000000000,  0.028835957569525,  0.048364061380386,
        0.000000000000000,  0.000000000000000,  -0.037510780046509, -0.076077156522146, 0.000000000000000,  0.000000000000000,  0.035522230900010,
        0.105719813578257,  0.000000000000000,  0.000000000000000,  0.022984500806834,  -0.014661246710016, 0.000000000000000,  0.000000000000000,
        -0.091174082421832, -0.043255874072557, 0.000000000000000,  0.000000000000000,  -0.007241674547707, -0.068772022284619, 0.034200684162914,
        0.009574932803796,  0.000000000000000,  0.000000000000000,  0.004309644572538,  -0.020160782676027, 0.400000000000000,  0.184508281839215,
        0.034150247796604,  0.033271610637065,  0.000000000000000,  0.000000000000000,  -0.026478232473931, -0.031350491510485, -0.000000000000000,
        0.000000000000000,  0.029550069288374,  0.036243610928639,  0.000000000000000,  0.000000000000000,  -0.038303447738966, -0.045190788540850,
        -0.000000000000000, 0.000000000000000,  -0.027656152677645, -0.013736194300752, 0.000000000000000,  0.000000000000000,  0.098959206179438,
        0.094211321573546,  -0.000000000000000, 0.000000000000000,  0.082745319749382,  0.112872791913204,  0.000000000000000,  0.000000000000000,
        -0.061155262375952, -0.120006616759786, 0.000000000000000,  0.000000000000000,  0.011107343649414,  0.002249530341763,  0.184508281839215,
        0.400000000000000,  0.045992645879811,  0.102234133230886,  0.000000000000000,  0.000000000000000,  -0.024951779020418, -0.042678808796704,
        0.000000000000000,  0.000000000000000,  0.028374119436555,  0.049789694443224,  0.000000000000000,  0.000000000000000,  -0.035163672919762,
        -0.061050985931356, 0.000000000000000,  0.000000000000000,  -0.014002835774006, -0.018584245419354, 0.000000000000000,  0.000000000000000,
        0.049122164258998,  0.042959083673670,  0.000000000000000,  0.000000000000000,  0.053416351011936,  0.106768465092346,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.023690564415310, 0.005017790909769,  0.000000000000000,  0.000000000000000,
        0.034150247796604,  0.045992645879811,  0.000000000000000,  0.000000000000000,  -0.022734752486310, -0.005361472259316, 0.000000000000000,
        0.000000000000000,  0.043537713727278,  -0.031521370646367, 0.000000000000000,  0.000000000000000,  -0.008935768938220, 0.026574574563423,
        0.000000000000000,  0.000000000000000,  0.028678383097636,  0.041774602837464,  0.000000000000000,  0.000000000000000,  -0.084281346894554,
        -0.085344721450464, 0.000000000000000,  0.000000000000000,  0.021100821920048,  0.009697329079743,  0.000000000000000,  0.000000000000000,
        0.036879727767326,  0.021486131263897,  0.000000000000000,  0.000000000000000,  -0.055967775832442, -0.020504083257299, 0.000000000000000,
        0.000000000000000,  0.033271610637065,  0.102234133230886,  0.000000000000000,  0.000000000000000,  -0.041272443984109, -0.022621961809920,
        0.000000000000000,  0.000000000000000,  0.013912966411812,  -0.095152660374100, 0.000000000000000,  0.000000000000000,  0.023733962170985,
        0.059211149296002,  0.000000000000000,  0.000000000000000,  0.035847751191566,  0.061836635838156,  0.000000000000000,  0.000000000000000,
        -0.100177898473738, -0.117277729348473, 0.000000000000000,  0.000000000000000,  0.012394318496725,  0.013844068321298,  0.000000000000000,
        0.000000000000000,  0.063037944451425,  0.054814231672789,  -0.023619028986785, -0.028373203921344, -0.000000000000000, -0.000000000000000,
        -0.027036756721736, -0.031203244191271, 0.000000000000000,  0.000000000000000,  -0.022734752486310, -0.041272443984109, 0.400000000000000,
        0.184508281839215,  -0.018334367686501, -0.013574782278479, 0.000000000000000,  0.000000000000000,  -0.005767614623309, -0.014867519998350,
        -0.000000000000000, 0.000000000000000,  0.008995031731307,  -0.018004506919395, 0.000000000000000,  0.000000000000000,  0.077659138392527,
        0.095827911844943,  0.000000000000000,  0.000000000000000,  -0.043372674387150, -0.017816785500110, 0.000000000000000,  0.000000000000000,
        -0.093084229516635, -0.080466245373229, 0.000000000000000,  0.000000000000000,  0.050032644692810,  0.055672014644282,  0.000000000000000,
        -0.000000000000000, -0.085027175169007, -0.160067566321820, 0.000000000000000,  0.000000000000000,  -0.005361472259316, -0.022621961809920,
        0.184508281839215,  0.400000000000000,  0.038352502703283,  0.089490311726419,  0.000000000000000,  0.000000000000000,  -0.041519716795890,
        -0.057816714743488, 0.000000000000000,  0.000000000000000,  -0.032259384589601, -0.059945224074326, 0.000000000000000,  0.000000000000000,
        0.086657485406873,  0.117662197192166,  0.000000000000000,  0.000000000000000,  0.005933092577749,  0.019011839364818,  0.000000000000000,
        0.000000000000000,  -0.122088368321977, -0.165394776227614, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.022302716510014, -0.001032739853789, 0.000000000000000,  0.000000000000000,  -0.026478232473931, -0.024951779020418, 0.000000000000000,
        0.000000000000000,  -0.018334367686501, 0.038352502703283,  0.000000000000000,  0.000000000000000,  -0.002550654853348, -0.024657822814585,
        0.000000000000000,  0.000000000000000,  -0.003852081932776, 0.025697672614217,  0.000000000000000,  0.000000000000000,  -0.010030801542109,
        -0.040609685547492, 0.000000000000000,  0.000000000000000,  -0.002607272832495, -0.001253599314923, 0.000000000000000,  0.000000000000000,
        0.035094824133488,  0.038139454979994,  0.000000000000000,  0.000000000000000,  -0.045052172813698, -0.001980111847577, 0.000000000000000,
        0.000000000000000,  -0.027770838878246, -0.009782262118431, 0.000000000000000,  0.000000000000000,  -0.031350491510485, -0.042678808796704,
        0.000000000000000,  0.000000000000000,  -0.013574782278479, 0.089490311726419,  0.000000000000000,  0.000000000000000,  -0.020757460910599,
        -0.043340530653085, 0.000000000000000,  0.000000000000000,  0.014811467546293,  0.043193268954748,  0.000000000000000,  0.000000000000000,
        -0.040207526303312, -0.068297526911119, 0.000000000000000,  0.000000000000000,  -0.003285257648681, -0.002460494399034, 0.000000000000000,
        0.000000000000000,  0.045972206798271,  0.065052669337060,  0.000000000000000,  0.000000000000000,  -0.061555479241106, -0.022482860545147,
        0.064359224443025,  0.037204554474458,  0.000000000000000,  0.000000000000000,  0.043108420249234,  0.028835957569525,  -0.000000000000000,
        0.000000000000000,  0.043537713727278,  0.013912966411812,  0.000000000000000,  0.000000000000000,  -0.002550654853348, -0.020757460910599,
        0.400000000000000,  0.184508281839215,  0.005717516364397,  -0.006903587768821, 0.000000000000000,  0.000000000000000,  0.016248225737753,
        0.041469071876822,  0.000000000000000,  0.000000000000000,  -0.034330187504903, -0.018606066334748, 0.000000000000000,  0.000000000000000,
        -0.025767757784648, -0.044775943799143, 0.000000000000000,  0.000000000000000,  0.028832093804792,  0.011105177171950,  0.000000000000000,
        0.000000000000000,  0.045155681388649,  0.053456391280975,  0.000000000000000,  0.000000000000000,  0.033757993808592,  0.048364061380386,
        0.000000000000000,  0.000000000000000,  -0.031521370646367, -0.095152660374100, 0.000000000000000,  0.000000000000000,  -0.024657822814585,
        -0.043340530653085, 0.184508281839215,  0.400000000000000,  -0.022369406298936, -0.042384019210961, 0.000000000000000,  0.000000000000000,
        0.056038618636364,  0.076401247136465,  0.000000000000000,  0.000000000000000,  0.002143712354623,  0.011543362788243,  0.000000000000000,
        0.000000000000000,  -0.070581543038773, -0.109589447168055, 0.000000000000000,  0.000000000000000,  0.061162666789253,  0.069748851581147,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.020162989090149, 0.000999365654843,  0.000000000000000,
        0.000000000000000,  0.029550069288374,  0.028374119436555,  0.000000000000000,  0.000000000000000,  -0.005767614623309, -0.041519716795890,
        0.000000000000000,  0.000000000000000,  0.005717516364397,  -0.022369406298936, 0.000000000000000,  0.000000000000000,  -0.003258058520571,
        -0.023377971193027, 0.000000000000000,  0.000000000000000,  -0.085142006219897, 0.030074731667189,  0.000000000000000,  0.000000000000000,
        -0.000572739886869, -0.027571694671115, 0.000000000000000,  0.000000000000000,  -0.012835264944303, -0.007323999042433, 0.000000000000000,
        0.000000000000000,  0.042029943096571,  -0.005544884126423, 0.000000000000000,  0.000000000000000,  -0.019199558526272, -0.002561012836084,
        0.000000000000000,  0.000000000000000,  0.036243610928639,  0.049789694443224,  0.000000000000000,  0.000000000000000,  -0.014867519998350,
        -0.057816714743488, 0.000000000000000,  0.000000000000000,  -0.006903587768821, -0.042384019210961, 0.000000000000000,  0.000000000000000,
        -0.029860456240858, -0.046880120022887, 0.000000000000000,  0.000000000000000,  -0.058617936481520, 0.106796499590705,  0.000000000000000,
        0.000000000000000,  -0.013260373650021, -0.041954294011928, 0.000000000000000,  0.000000000000000,  -0.012228795833806, -0.014313787340408,
        0.000000000000000,  0.000000000000000,  0.050435242431562,  0.005857423616859,  -0.013079985661420, -0.013128113702966, 0.000000000000000,
        0.000000000000000,  -0.027004513311476, -0.037510780046509, 0.000000000000000,  0.000000000000000,  -0.008935768938220, 0.023733962170985,
        -0.000000000000000, 0.000000000000000,  -0.003852081932776, 0.014811467546293,  0.000000000000000,  0.000000000000000,  -0.003258058520571,
        -0.029860456240858, 0.400000000000001,  0.184508281839215,  0.084652449308872,  0.057694551254498,  0.000000000000000,  0.000000000000000,
        0.013326847144682,  0.030588841556302,  -0.000000000000000, 0.000000000000000,  -0.012825690087719, 0.008524215325334,  0.000000000000000,
        0.000000000000000,  -0.054177468197478, -0.014523779062350, 0.000000000000000,  0.000000000000000,  0.005264530981218,  0.003113662720051,
        0.000000000000000,  0.000000000000000,  -0.051997991481490, -0.076077156522146, 0.000000000000000,  0.000000000000000,  0.026574574563423,
        0.059211149296002,  0.000000000000000,  0.000000000000000,  0.025697672614217,  0.043193268954748,  0.000000000000000,  0.000000000000000,
        -0.023377971193027, -0.046880120022887, 0.184508281839215,  0.400000000000000,  -0.024847628509437, -0.107147791188246, 0.000000000000000,
        0.000000000000000,  0.027846522023712,  0.046617998545371,  0.000000000000000,  0.000000000000000,  0.022635694713484,  0.034704767623314,
        0.000000000000000,  0.000000000000000,  -0.045210973181629, -0.044741869688686, 0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.057755951945061,  -0.001892621968710, 0.000000000000000,  0.000000000000000,  -0.038303447738966, -0.035163672919762,
        0.000000000000000,  0.000000000000000,  0.008995031731307,  -0.032259384589601, 0.000000000000000,  0.000000000000000,  0.016248225737753,
        0.056038618636364,  0.000000000000000,  0.000000000000000,  0.084652449308872,  -0.024847628509437, 0.000000000000000,  0.000000000000000,
        -0.009160725443869, -0.020651649719735, 0.000000000000000,  0.000000000000000,  -0.028339752372535, 0.048785274593136,  0.000000000000000,
        0.000000000000000,  -0.044798896427359, -0.034815024664136, 0.000000000000000,  0.000000000000000,  0.002229902886476,  -0.004171197701139,
        0.000000000000000,  0.000000000000000,  0.079241500430763,  0.022641227947703,  0.000000000000000,  0.000000000000000,  -0.045190788540850,
        -0.061050985931356, 0.000000000000000,  0.000000000000000,  -0.018004506919395, -0.059945224074326, 0.000000000000000,  0.000000000000000,
        0.041469071876822,  0.076401247136465,  0.000000000000000,  0.000000000000000,  0.057694551254498,  -0.107147791188246, 0.000000000000000,
        0.000000000000000,  -0.035640077753108, -0.043635050784108, 0.000000000000000,  0.000000000000000,  -0.013957522752232, 0.108562301866374,
        0.000000000000000,  0.000000000000000,  -0.043257591448422, -0.055361942292589, 0.000000000000000,  0.000000000000000,  -0.003057399054588,
        -0.008224530418347, -0.057553311331311, -0.016960756457656, 0.000000000000000,  0.000000000000000,  0.007806753336187,  0.035522230900010,
        -0.000000000000000, 0.000000000000000,  0.028678383097636,  0.035847751191566,  0.000000000000000,  0.000000000000000,  -0.010030801542109,
        -0.040207526303312, 0.000000000000000,  0.000000000000000,  -0.085142006219897, -0.058617936481520, 0.000000000000000,  0.000000000000000,
        -0.009160725443869, -0.035640077753108, 0.400000000000000,  0.184508281839215,  0.041683695542515,  0.006151572009191,  0.000000000000000,
        0.000000000000000,  0.047718562744460,  0.049339875888249,  0.000000000000000,  -0.000000000000000, 0.052993180383879,  0.041034527035104,
        0.000000000000000,  0.000000000000000,  -0.077494519328308, -0.084680156746780, 0.000000000000000,  0.000000000000000,  0.067397374178108,
        0.105719813578257,  0.000000000000000,  0.000000000000000,  0.041774602837464,  0.061836635838156,  0.000000000000000,  0.000000000000000,
        -0.040609685547492, -0.068297526911119, 0.000000000000000,  0.000000000000000,  0.030074731667189,  0.106796499590705,  0.000000000000000,
        0.000000000000000,  -0.020651649719735, -0.043635050784108, 0.184508281839215,  0.400000000000000,  -0.045215517441885, -0.121089117943525,
        0.000000000000000,  0.000000000000000,  0.051010614178405,  0.073342469222339,  -0.000000000000000, -0.000000000000000, 0.030716870490056,
        0.041207864328248,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.028424944316171, -0.023922010093523,
        0.000000000000000,  0.000000000000000,  -0.027656152677645, -0.014002835774006, 0.000000000000000,  0.000000000000000,  0.077659138392527,
        0.086657485406873,  0.000000000000000,  0.000000000000000,  -0.034330187504903, 0.002143712354623,  0.000000000000000,  0.000000000000000,
        0.013326847144682,  0.027846522023712,  0.000000000000000,  0.000000000000000,  0.041683695542515,  -0.045215517441885, 0.000000000000000,
        0.000000000000000,  -0.026970470388055, -0.011228476299532, 0.000000000000000,  0.000000000000000,  0.034796772273076,  0.041379372324349,
        0.000000000000000,  0.000000000000000,  -0.022077715299720, 0.005703630620801,  0.000000000000000,  0.000000000000000,  -0.053636243484735,
        -0.055543533534681, 0.000000000000000,  0.000000000000000,  -0.013736194300752, -0.018584245419354, 0.000000000000000,  0.000000000000000,
        0.095827911844943,  0.117662197192166,  0.000000000000000,  0.000000000000000,  -0.018606066334748, 0.011543362788243,  0.000000000000000,
        0.000000000000000,  0.030588841556302,  0.046617998545371,  0.000000000000000,  0.000000000000000,  0.006151572009191,  -0.121089117943525,
        0.000000000000000,  0.000000000000000,  -0.038455371609894, -0.028572045037692, 0.000000000000000,  0.000000000000000,  0.034027240737896,
        0.097142999802967,  0.000000000000000,  0.000000000000000,  -0.056253393487115, -0.020057645025169, 0.085640842612310,  0.082313495850095,
        -0.000000000000000, 0.000000000000000,  0.038339976636594,  0.022984500806834,  0.000000000000000,  0.000000000000000,  -0.084281346894554,
        -0.100177898473738, 0.000000000000000,  0.000000000000000,  -0.002607272832495, -0.003285257648681, 0.000000000000000,  0.000000000000000,
        -0.000572739886869, -0.013260373650021, -0.000000000000000, 0.000000000000000,  -0.028339752372535, -0.013957522752232, 0.000000000000000,
        0.000000000000000,  -0.026970470388055, -0.038455371609894, 0.400000000000000,  0.184508281839215,  -0.021426204582106, -0.022350967433354,
        0.000000000000000,  0.000000000000000,  -0.018177110660340, -0.026839334608101, -0.000000000000000, -0.000000000000000, 0.116415429758019,
        0.161113199157626,  0.000000000000000,  0.000000000000000,  -0.003891840077239, -0.014661246710016, 0.000000000000000,  0.000000000000000,
        -0.085344721450464, -0.117277729348473, 0.000000000000000,  0.000000000000000,  -0.001253599314923, -0.002460494399034, 0.000000000000000,
        0.000000000000000,  -0.027571694671115, -0.041954294011928, 0.000000000000000,  0.000000000000000,  0.048785274593136,  0.108562301866374,
        0.000000000000000,  0.000000000000000,  -0.011228476299532, -0.028572045037692, 0.184508281839215,  0.400000000000000,  -0.082643286068208,
        -0.155371908648837, 0.000000000000000,  0.000000000000000,  0.051498129198513,  0.056974017216437,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.032354201590300,  0.062134561807731,  0.000000000000000,  0.000000000000000,  0.098959206179438,
        0.049122164258998,  0.000000000000000,  0.000000000000000,  -0.043372674387150, 0.005933092577749,  0.000000000000000,  0.000000000000000,
        -0.025767757784648, -0.070581543038773, 0.000000000000000,  0.000000000000000,  -0.012825690087719, 0.022635694713484,  0.000000000000000,
        0.000000000000000,  0.047718562744460,  0.051010614178405,  0.000000000000000,  0.000000000000000,  -0.021426204582106, -0.082643286068208,
        0.000000000000000,  0.000000000000000,  0.007242299461634,  0.011384961981673,  0.000000000000000,  0.000000000000000,  -0.060099221475223,
        -0.014710740221847, 0.000000000000000,  0.000000000000000,  0.008576938294578,  0.068761681891073,  0.000000000000000,  0.000000000000000,
        0.094211321573546,  0.042959083673670,  0.000000000000000,  0.000000000000000,  -0.017816785500110, 0.019011839364818,  0.000000000000000,
        0.000000000000000,  -0.044775943799143, -0.109589447168055, 0.000000000000000,  0.000000000000000,  0.008524215325334,  0.034704767623314,
        0.000000000000000,  0.000000000000000,  0.049339875888249,  0.073342469222339,  0.000000000000000,  0.000000000000000,  -0.022350967433354,
        -0.155371908648837, 0.000000000000000,  0.000000000000000,  -0.019865709689379, 0.002354522969004,  0.000000000000000,  0.000000000000000,
        -0.038746624771442, 0.014678954819671,  -0.082461244151037, -0.112166982876032, 0.000000000000000,  0.000000000000000,  -0.098985759846868,
        -0.091174082421832, -0.000000000000000, 0.000000000000000,  0.021100821920048,  0.012394318496725,  0.000000000000000,  0.000000000000000,
        0.035094824133488,  0.045972206798271,  0.000000000000000,  0.000000000000000,  -0.012835264944303, -0.012228795833806, 0.000000000000000,
        0.000000000000000,  -0.044798896427359, -0.043257591448422, 0.000000000000000,  -0.000000000000000, 0.034796772273076,  0.034027240737896,
        0.000000000000000,  0.000000000000000,  0.007242299461634,  -0.019865709689379, 0.400000000000000,  0.184508281839215,  0.036240993228781,
        0.008977392282990,  0.000000000000000,  0.000000000000000,  -0.053896036163021, -0.107074789470815, 0.000000000000000,  0.000000000000000,
        -0.050175312133182, -0.043255874072557, 0.000000000000000,  0.000000000000000,  0.009697329079743,  0.013844068321298,  0.000000000000000,
        0.000000000000000,  0.038139454979994,  0.065052669337060,  0.000000000000000,  0.000000000000000,  -0.007323999042433, -0.014313787340408,
        0.000000000000000,  0.000000000000000,  -0.034815024664136, -0.055361942292589, -0.000000000000000, -0.000000000000000, 0.041379372324349,
        0.097142999802967,  0.000000000000000,  0.000000000000000,  0.011384961981673,  0.002354522969004,  0.184508281839215,  0.400000000000000,
        -0.059826781540379, -0.119061706161714, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.058930167452621,
        -0.169075370455401, 0.000000000000000,  0.000000000000000,  0.082745319749382,  0.053416351011936,  0.000000000000000,  0.000000000000000,
        -0.093084229516635, -0.122088368321977, 0.000000000000000,  0.000000000000000,  0.028832093804792,  0.061162666789253,  0.000000000000000,
        0.000000000000000,  -0.054177468197478, -0.045210973181629, 0.000000000000000,  0.000000000000000,  0.052993180383879,  0.030716870490056,
        0.000000000000000,  0.000000000000000,  -0.018177110660340, 0.051498129198513,  0.000000000000000,  0.000000000000000,  0.036240993228781,
        -0.059826781540379, 0.000000000000000,  0.000000000000000,  -0.006968980497622, -0.038875774023464, 0.000000000000000,  0.000000000000000,
        -0.103214201527832, -0.306682000304054, 0.000000000000000,  0.000000000000000,  0.112872791913204,  0.106768465092346,  0.000000000000000,
        0.000000000000000,  -0.080466245373229, -0.165394776227614, 0.000000000000000,  0.000000000000000,  0.011105177171950,  0.069748851581147,
        0.000000000000000,  0.000000000000000,  -0.014523779062350, -0.044741869688686, 0.000000000000000,  0.000000000000000,  0.041034527035104,
        0.041207864328248,  0.000000000000000,  0.000000000000000,  -0.026839334608101, 0.056974017216437,  0.000000000000000,  0.000000000000000,
        0.008977392282990,  -0.119061706161714, 0.000000000000000,  0.000000000000000,  0.012207696998806,  -0.029723633654130, 0.059119062138170,
        0.103044920220173,  0.000000000000000,  0.000000000000000,  -0.030745452778552, -0.007241674547707, 0.000000000000000,  0.000000000000000,
        0.036879727767326,  0.063037944451425,  0.000000000000000,  0.000000000000000,  -0.045052172813698, -0.061555479241106, 0.000000000000000,
        0.000000000000000,  0.042029943096571,  0.050435242431562,  0.000000000000000,  0.000000000000000,  0.002229902886476,  -0.003057399054588,
        0.000000000000000,  0.000000000000000,  -0.022077715299720, -0.056253393487115, -0.000000000000000, -0.000000000000000, -0.060099221475223,
        -0.038746624771442, 0.000000000000000,  0.000000000000000,  -0.006968980497622, 0.012207696998806,  0.400000000000001,  0.184508281839215,
        0.169242204909982,  0.306783947871049,  0.000000000000000,  0.000000000000000,  -0.062344527473845, -0.068772022284619, 0.000000000000000,
        0.000000000000000,  0.021486131263897,  0.054814231672789,  0.000000000000000,  0.000000000000000,  -0.001980111847577, -0.022482860545147,
        0.000000000000000,  0.000000000000000,  -0.005544884126423, 0.005857423616859,  0.000000000000000,  -0.000000000000000, -0.004171197701139,
        -0.008224530418347, 0.000000000000000,  0.000000000000000,  0.005703630620801,  -0.020057645025169, -0.000000000000000, 0.000000000000000,
        -0.014710740221847, 0.014678954819671,  0.000000000000000,  0.000000000000000,  -0.038875774023464, -0.029723633654130, 0.184508281839215,
        0.400000000000000};

    ASSERT_EQ(dipxmat, CDenseMatrix(intxvals, 36, 36));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.010390231091920, -0.058404879057739, 0.000000000000000,  0.000000000000000,  -0.083579286734248,
        -0.053957090657111, 0.000000000000000,  0.000000000000000,  -0.067565467381732, -0.112323861669683, 0.000000000000000,  0.000000000000000,
        0.091563411643455,  0.074523179949317,  0.000000000000000,  0.000000000000000,  -0.064258771460466, -0.046735559791160, 0.000000000000000,
        0.000000000000000,  -0.016489948799540, 0.016720958848820,  0.000000000000000,  0.000000000000000,  0.120755179916521,  0.102069640735670,
        0.000000000000000,  0.000000000000000,  -0.032585718894384, -0.104539765271398, 0.000000000000000,  0.000000000000000,  -0.039206748156724,
        -0.112649429028628, 0.000000000000000,  0.000000000000000,  0.018487639643383,  -0.044634666496294, 0.000000000000000,  0.000000000000000,
        -0.112631245633853, -0.107153196915308, 0.000000000000000,  0.000000000000000,  -0.053267367007083, -0.147471777948757, 0.000000000000000,
        0.000000000000000,  0.061149775335909,  0.092018699518211,  0.000000000000000,  0.000000000000000,  -0.021322601965666, -0.047143075706988,
        0.000000000000000,  0.000000000000000,  -0.012688847846067, 0.018036247917029,  0.000000000000000,  0.000000000000000,  0.116322316369629,
        0.149506572215593,  0.000000000000000,  0.000000000000000,  -0.084785295433845, -0.208162406088968, 0.000000000000000,  0.000000000000000,
        -0.068876124903515, -0.204413287110298, -0.010390231091920, 0.018487639643383,  0.600000000000000,  0.276762422758823,  0.031236159007089,
        0.008112675536757,  0.000000000000000,  0.000000000000000,  0.035274568478158,  0.068023367142963,  0.000000000000000,  0.000000000000000,
        -0.025428512854962, -0.039709424316522, 0.000000000000000,  0.000000000000000,  0.036946813279102,  0.046462398685577,  -0.000000000000000,
        -0.000000000000000, -0.022302716510014, -0.027770838878246, 0.000000000000000,  0.000000000000000,  -0.023037069488502, -0.027225083364517,
        -0.000000000000000, -0.000000000000000, -0.033798342652858, -0.032151650975143, 0.000000000000000,  0.000000000000000,  0.039492738237136,
        0.068629956261822,  -0.000000000000000, 0.000000000000000,  -0.058404879057739, -0.044634666496294, 0.276762422758823,  0.600000000000001,
        0.062073507313641,  0.068683274446580,  0.000000000000000,  0.000000000000000,  0.014278994786950,  0.048923653365460,  0.000000000000000,
        -0.000000000000000, -0.005445816050792, -0.021512360252684, 0.000000000000000,  0.000000000000000,  -0.005581285485537, 0.005255014809031,
        -0.000000000000000, 0.000000000000000,  -0.001032739853789, -0.009782262118431, 0.000000000000000,  0.000000000000000,  -0.030725010316023,
        -0.049520072498679, -0.000000000000000, 0.000000000000000,  0.037156057904022,  0.071985321033605,  0.000000000000000,  0.000000000000000,
        0.112895621214961,  0.204564011673104,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.031236159007089,
        0.062073507313641,  0.000000000000000,  0.000000000000000,  0.006905681494988,  0.016305455665035,  0.000000000000000,  0.000000000000000,
        0.041413358274000,  -0.003787576309411, 0.000000000000000,  0.000000000000000,  -0.019844341460640, -0.069531701439105, 0.000000000000000,
        0.000000000000000,  0.021082367965132,  0.021269849428111,  0.000000000000000,  0.000000000000000,  -0.016459316901163, 0.057435911968397,
        0.000000000000000,  0.000000000000000,  0.005067192725950,  -0.086993260142484, 0.000000000000000,  0.000000000000000,  0.064877353878210,
        0.033183167712395,  0.000000000000000,  0.000000000000000,  0.032601675663235,  -0.036489452744490, 0.000000000000000,  0.000000000000000,
        0.008112675536757,  0.068683274446580,  0.000000000000000,  0.000000000000000,  -0.029047151920003, 0.003278211328240,  0.000000000000000,
        0.000000000000000,  0.024065161188895,  -0.014550699836878, 0.000000000000000,  0.000000000000000,  -0.043580805357461, -0.106870483264313,
        0.000000000000000,  0.000000000000000,  0.018530462507874,  0.030471532874384,  0.000000000000000,  0.000000000000000,  0.026423804648841,
        0.092872835914473,  0.000000000000000,  0.000000000000000,  -0.008006402338666, -0.169674055487793, 0.000000000000000,  0.000000000000000,
        0.061138480742239,  0.028751875381055,  0.000000000000000,  0.000000000000000,  0.030014851289190,  -0.071766546716052, -0.083579286734248,
        -0.112631245633853, 0.000000000000000,  0.000000000000000,  0.006905681494988,  -0.029047151920003, 0.600000000000000,  0.276762422758823,
        -0.025584129866266, -0.013131356953959, 0.000000000000000,  0.000000000000000,  0.046038237311154,  0.049979049102213,  -0.000000000000000,
        0.000000000000000,  -0.012099104082486, -0.016274385628545, 0.000000000000000,  0.000000000000000,  -0.026478232473931, -0.031350491510485,
        -0.000000000000000, -0.000000000000000, 0.009388894667566,  0.021653000501359,  0.000000000000000,  0.000000000000000,  -0.067085956805995,
        -0.062451788588012, -0.000000000000000, 0.000000000000000,  0.034644740297604,  0.084195525137066,  0.000000000000000,  0.000000000000000,
        -0.053957090657111, -0.107153196915308, 0.000000000000000,  0.000000000000000,  0.016305455665035,  0.003278211328240,  0.276762422758823,
        0.600000000000000,  -0.014102460772172, -0.018697441407976, 0.000000000000000,  0.000000000000000,  0.038936075449087,  0.065887325477246,
        0.000000000000000,  0.000000000000000,  -0.013659236155013, -0.023371755655611, 0.000000000000000,  0.000000000000000,  -0.024951779020418,
        -0.042678808796704, -0.000000000000000, 0.000000000000000,  0.031749154929090,  0.083909407527992,  0.000000000000000,  0.000000000000000,
        -0.033015149882391, -0.028724763116430, 0.000000000000000,  0.000000000000000,  0.105869267957398,  0.209108628968499,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.035274568478158,  0.014278994786950,  0.000000000000000,  0.000000000000000,
        -0.025584129866266, -0.014102460772172, 0.000000000000000,  0.000000000000000,  -0.032828771134874, -0.011957817836578, 0.000000000000000,
        0.000000000000000,  0.031666977195475,  0.038504672990469,  0.000000000000000,  0.000000000000000,  -0.020791045782014, 0.009923968441182,
        0.000000000000000,  0.000000000000000,  0.070900955773931,  -0.031945326838971, 0.000000000000000,  0.000000000000000,  0.050276251667144,
        0.054435662550879,  0.000000000000000,  0.000000000000000,  -0.018927313237369, -0.035872725896946, 0.000000000000000,  0.000000000000000,
        0.018782584983035,  0.031080557590604,  0.000000000000000,  0.000000000000000,  0.068023367142963,  0.048923653365460,  0.000000000000000,
        0.000000000000000,  -0.013131356953959, -0.018697441407976, 0.000000000000000,  0.000000000000000,  -0.058013822581842, -0.037391120506105,
        0.000000000000000,  0.000000000000000,  0.036257710277209,  0.058542996648873,  0.000000000000000,  0.000000000000000,  0.004464025978878,
        0.033978792596281,  0.000000000000000,  0.000000000000000,  0.029247205405084,  -0.103399779702101, 0.000000000000000,  0.000000000000000,
        0.065935166500666,  0.075172300086685,  0.000000000000000,  0.000000000000000,  -0.023870423542370, -0.088444130721984, 0.000000000000000,
        0.000000000000000,  0.024066649083602,  0.049444167272336,  -0.067565467381732, -0.053267367007083, 0.000000000000000,  0.000000000000000,
        0.041413358274000,  0.024065161188895,  0.000000000000000,  0.000000000000000,  -0.032828771134874, -0.058013822581842, 0.600000000000001,
        0.276762422758823,  0.014209577396298,  -0.011433991622033, 0.000000000000000,  0.000000000000000,  -0.006362258360670, -0.007335761805729,
        -0.000000000000000, -0.000000000000000, -0.018334367686501, -0.013574782278479, 0.000000000000000,  0.000000000000000,  -0.057684071857577,
        -0.064735373711788, -0.000000000000000, 0.000000000000000,  -0.014563721823328, 0.011546737363506,  0.000000000000000,  0.000000000000000,
        -0.122199627964126, -0.118145484967711, 0.000000000000000,  0.000000000000000,  -0.112323861669683, -0.147471777948757, 0.000000000000000,
        -0.000000000000000, -0.003787576309411, -0.014550699836878, 0.000000000000000,  0.000000000000000,  -0.011957817836578, -0.037391120506105,
        0.276762422758823,  0.600000000000000,  -0.029752185959756, -0.055024235276258, 0.000000000000000,  0.000000000000000,  -0.027762977755833,
        -0.035921539944683, -0.000000000000000, 0.000000000000000,  0.038352502703283,  0.089490311726419,  0.000000000000000,  0.000000000000000,
        -0.060232475354013, -0.081454317607075, 0.000000000000000,  0.000000000000000,  0.088864644973888,  0.173826324545226,  0.000000000000000,
        0.000000000000000,  -0.101141936057667, -0.148954605012599, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.025428512854962, -0.005445816050792, 0.000000000000000,  0.000000000000000,  0.046038237311154,  0.038936075449087,  0.000000000000000,
        0.000000000000000,  0.014209577396298,  -0.029752185959756, 0.000000000000000,  0.000000000000000,  -0.007536268903716, -0.027354523253989,
        0.000000000000000,  0.000000000000000,  0.081442381031559,  -0.003432901330924, 0.000000000000000,  0.000000000000000,  0.014968696666560,
        0.039774379974652,  0.000000000000000,  0.000000000000000,  0.018671165236033,  -0.022947120197570, 0.000000000000000,  0.000000000000000,
        0.005265527502843,  0.015533856180920,  0.000000000000000,  0.000000000000000,  0.029828140877873,  -0.003106086668201, 0.000000000000000,
        0.000000000000000,  -0.039709424316522, -0.021512360252684, 0.000000000000000,  0.000000000000000,  0.049979049102213,  0.065887325477246,
        0.000000000000000,  0.000000000000000,  -0.011433991622033, -0.055024235276258, 0.000000000000000,  0.000000000000000,  -0.044388781692249,
        -0.062165845244670, 0.000000000000000,  0.000000000000000,  0.070037440876409,  -0.071153400392623, 0.000000000000000,  0.000000000000000,
        0.033693604542823,  0.053125318711971,  0.000000000000000,  0.000000000000000,  0.026223563811160,  -0.060658360470297, 0.000000000000000,
        0.000000000000000,  0.018784259690345,  0.030642873502483,  0.000000000000000,  0.000000000000000,  0.042260041201209,  0.009343990882574,
        0.091563411643455,  0.061149775335909,  0.000000000000000,  0.000000000000000,  -0.019844341460640, -0.043580805357461, -0.000000000000000,
        0.000000000000000,  0.031666977195475,  0.036257710277209,  0.000000000000000,  0.000000000000000,  -0.007536268903716, -0.044388781692249,
        0.600000000000000,  0.276762422758823,  -0.080377409249566, -0.064370926288871, 0.000000000000000,  0.000000000000000,  -0.002550654853348,
        -0.020757460910599, 0.000000000000000,  0.000000000000000,  -0.066827595664645, -0.036195514287848, 0.000000000000000,  0.000000000000000,
        0.013806887669412,  -0.008151606439052, 0.000000000000000,  0.000000000000000,  -0.019266497574336, 0.002786250019163,  0.000000000000000,
        0.000000000000000,  0.074523179949317,  0.092018699518211,  0.000000000000000,  0.000000000000000,  -0.069531701439105, -0.106870483264313,
        0.000000000000000,  0.000000000000000,  0.038504672990469,  0.058542996648873,  0.000000000000000,  0.000000000000000,  -0.027354523253989,
        -0.062165845244670, 0.276762422758823,  0.600000000000001,  0.011433559751409,  0.071476483581571,  0.000000000000000,  0.000000000000000,
        -0.024657822814585, -0.043340530653085, 0.000000000000000,  0.000000000000000,  0.011765819180246,  0.070930937740596,  0.000000000000000,
        0.000000000000000,  -0.040101830399979, -0.067461268604722, 0.000000000000000,  0.000000000000000,  -0.033663448707555, -0.033930476079912,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.036946813279102,  -0.005581285485537, 0.000000000000000,
        0.000000000000000,  -0.012099104082486, -0.013659236155013, 0.000000000000000,  0.000000000000000,  -0.006362258360670, -0.027762977755833,
        0.000000000000000,  0.000000000000000,  -0.080377409249566, 0.011433559751409,  0.000000000000000,  0.000000000000000,  -0.004887087780857,
        -0.035066956789541, 0.000000000000000,  0.000000000000000,  0.005717516364397,  -0.022369406298936, 0.000000000000000,  0.000000000000000,
        0.004634882748000,  0.041482291844532,  0.000000000000000,  0.000000000000000,  -0.030292416375920, -0.021985645037314, 0.000000000000000,
        0.000000000000000,  -0.004711015016647, -0.001177493617062, 0.000000000000000,  0.000000000000000,  0.046462398685577,  0.005255014809031,
        0.000000000000000,  0.000000000000000,  -0.016274385628545, -0.023371755655611, 0.000000000000000,  0.000000000000000,  -0.007335761805729,
        -0.035921539944683, 0.000000000000000,  0.000000000000000,  -0.064370926288871, 0.071476483581571,  0.000000000000000,  0.000000000000000,
        -0.044790684361287, -0.070320180034330, 0.000000000000000,  0.000000000000000,  -0.006903587768821, -0.042384019210961, 0.000000000000000,
        0.000000000000000,  0.016026683185276,  0.058997036191427,  0.000000000000000,  0.000000000000000,  -0.032164024581004, -0.040655608747221,
        0.000000000000000,  0.000000000000000,  -0.000241324394658, -0.000386840100583, -0.064258771460466, -0.021322601965666, -0.000000000000000,
        -0.000000000000000, 0.021082367965132,  0.018530462507874,  0.000000000000000,  0.000000000000000,  -0.020791045782014, 0.004464025978878,
        -0.000000000000000, -0.000000000000000, 0.081442381031559,  0.070037440876409,  0.000000000000000,  0.000000000000000,  -0.004887087780857,
        -0.044790684361287, 0.600000000000001,  0.276762422758823,  -0.003852081932776, 0.014811467546293,  0.000000000000000,  0.000000000000000,
        0.002260529017779,  -0.028845339131785, -0.000000000000000, -0.000000000000000, -0.007188486405685, 0.027420446753191,  0.000000000000000,
        0.000000000000000,  -0.036252293420583, -0.020141536078013, 0.000000000000000,  0.000000000000000,  -0.046735559791160, -0.047143075706988,
        -0.000000000000000, 0.000000000000000,  0.021269849428111,  0.030471532874384,  0.000000000000000,  0.000000000000000,  0.009923968441182,
        0.033978792596281,  -0.000000000000000, 0.000000000000000,  -0.003432901330924, -0.071153400392623, 0.000000000000000,  0.000000000000000,
        -0.035066956789541, -0.070320180034330, 0.276762422758823,  0.600000000000000,  0.025697672614217,  0.043193268954748,  0.000000000000000,
        0.000000000000000,  -0.030081161133918, -0.061684037416476, -0.000000000000000, 0.000000000000000,  0.053375314458338,  0.080345964672328,
        0.000000000000000,  0.000000000000000,  -0.012725008078676, -0.014863826596495, 0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  -0.022302716510014, -0.001032739853789, 0.000000000000000,  0.000000000000000,  -0.026478232473931, -0.024951779020418,
        0.000000000000000,  0.000000000000000,  -0.018334367686501, 0.038352502703283,  0.000000000000000,  0.000000000000000,  -0.002550654853348,
        -0.024657822814585, 0.000000000000000,  0.000000000000000,  -0.003852081932776, 0.025697672614217,  0.000000000000000,  0.000000000000000,
        -0.010030801542109, -0.040609685547492, 0.000000000000000,  0.000000000000000,  -0.002607272832495, -0.001253599314923, 0.000000000000000,
        0.000000000000000,  0.035094824133488,  0.038139454979994,  0.000000000000000,  0.000000000000000,  -0.045052172813698, -0.001980111847577,
        0.000000000000000,  0.000000000000000,  -0.027770838878246, -0.009782262118431, 0.000000000000000,  0.000000000000000,  -0.031350491510485,
        -0.042678808796704, 0.000000000000000,  0.000000000000000,  -0.013574782278479, 0.089490311726419,  0.000000000000000,  0.000000000000000,
        -0.020757460910599, -0.043340530653085, 0.000000000000000,  0.000000000000000,  0.014811467546293,  0.043193268954748,  0.000000000000000,
        0.000000000000000,  -0.040207526303312, -0.068297526911119, 0.000000000000000,  0.000000000000000,  -0.003285257648681, -0.002460494399034,
        0.000000000000000,  0.000000000000000,  0.045972206798271,  0.065052669337060,  0.000000000000000,  0.000000000000000,  -0.061555479241106,
        -0.022482860545147, -0.016489948799540, -0.012688847846067, 0.000000000000000,  0.000000000000000,  -0.016459316901163, 0.026423804648841,
        -0.000000000000000, -0.000000000000000, 0.070900955773931,  0.029247205405084,  0.000000000000000,  0.000000000000000,  0.014968696666560,
        0.033693604542823,  0.000000000000000,  0.000000000000000,  0.005717516364397,  -0.006903587768821, 0.000000000000000,  0.000000000000000,
        -0.010030801542109, -0.040207526303312, 0.600000000000000,  0.276762422758823,  0.031341593407063,  0.018196107249106,  0.000000000000000,
        0.000000000000000,  -0.037422315053204, -0.045247886761885, 0.000000000000000,  -0.000000000000000, 0.110360671864521,  0.061417851780883,
        0.000000000000000,  0.000000000000000,  0.016720958848820,  0.018036247917029,  0.000000000000000,  0.000000000000000,  0.057435911968397,
        0.092872835914473,  -0.000000000000000, 0.000000000000000,  -0.031945326838971, -0.103399779702101, 0.000000000000000,  0.000000000000000,
        0.039774379974652,  0.053125318711971,  0.000000000000000,  0.000000000000000,  -0.022369406298936, -0.042384019210961, 0.000000000000000,
        0.000000000000000,  -0.040609685547492, -0.068297526911119, 0.276762422758823,  0.600000000000001,  0.001126217492372,  -0.008249723598960,
        0.000000000000000,  0.000000000000000,  -0.065948906877072, -0.100881208672255, -0.000000000000000, -0.000000000000000, 0.089836336577316,
        0.105466643208656,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.023037069488502, -0.030725010316023,
        0.000000000000000,  0.000000000000000,  0.009388894667566,  0.031749154929090,  0.000000000000000,  0.000000000000000,  -0.057684071857577,
        -0.060232475354013, 0.000000000000000,  0.000000000000000,  -0.066827595664645, 0.011765819180246,  0.000000000000000,  0.000000000000000,
        0.002260529017779,  -0.030081161133918, 0.000000000000000,  0.000000000000000,  0.031341593407063,  0.001126217492372,  0.000000000000000,
        0.000000000000000,  -0.041729063176674, -0.012927105001694, 0.000000000000000,  0.000000000000000,  -0.023172844731428, -0.009597704081576,
        0.000000000000000,  0.000000000000000,  0.030802660718196,  0.016939083419715,  0.000000000000000,  0.000000000000000,  -0.027225083364517,
        -0.049520072498679, 0.000000000000000,  0.000000000000000,  0.021653000501359,  0.083909407527992,  0.000000000000000,  0.000000000000000,
        -0.064735373711788, -0.081454317607075, 0.000000000000000,  0.000000000000000,  -0.036195514287848, 0.070930937740596,  0.000000000000000,
        0.000000000000000,  -0.028845339131785, -0.061684037416476, 0.000000000000000,  0.000000000000000,  0.018196107249106,  -0.008249723598960,
        0.000000000000000,  0.000000000000000,  -0.061577900809162, -0.039399889765313, 0.000000000000000,  0.000000000000000,  -0.012999155843518,
        -0.013730872332676, 0.000000000000000,  0.000000000000000,  0.060571797572391,  0.050007533507295,  0.120755179916521,  0.116322316369629,
        -0.000000000000000, -0.000000000000000, 0.005067192725950,  -0.008006402338666, 0.000000000000000,  0.000000000000000,  0.050276251667144,
        0.065935166500666,  -0.000000000000000, 0.000000000000000,  0.018671165236033,  0.026223563811160,  0.000000000000000,  0.000000000000000,
        0.004634882748000,  0.016026683185276,  -0.000000000000000, -0.000000000000000, -0.002607272832495, -0.003285257648681, 0.000000000000000,
        0.000000000000000,  -0.041729063176674, -0.061577900809162, 0.600000000000001,  0.276762422758823,  0.040299292749744,  0.016736125118049,
        0.000000000000000,  0.000000000000000,  -0.055447462839606, -0.052835785981434, -0.000000000000000, 0.000000000000000,  0.102069640735670,
        0.149506572215593,  -0.000000000000000, 0.000000000000000,  -0.086993260142484, -0.169674055487793, 0.000000000000000,  0.000000000000000,
        0.054435662550879,  0.075172300086685,  0.000000000000000,  0.000000000000000,  -0.022947120197570, -0.060658360470297, 0.000000000000000,
        0.000000000000000,  0.041482291844532,  0.058997036191427,  -0.000000000000000, 0.000000000000000,  -0.001253599314923, -0.002460494399034,
        0.000000000000000,  0.000000000000000,  -0.012927105001694, -0.039399889765313, 0.276762422758823,  0.600000000000000,  -0.006037356345576,
        -0.019122386237957, 0.000000000000000,  0.000000000000000,  -0.106285866277310, -0.142681060299368, 0.000000000000000,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.033798342652858, 0.037156057904022,  0.000000000000000,  0.000000000000000,  -0.067085956805995,
        -0.033015149882391, 0.000000000000000,  0.000000000000000,  -0.014563721823328, 0.088864644973888,  0.000000000000000,  0.000000000000000,
        0.013806887669412,  -0.040101830399979, 0.000000000000000,  0.000000000000000,  -0.007188486405685, 0.053375314458338,  0.000000000000000,
        0.000000000000000,  -0.037422315053204, -0.065948906877072, 0.000000000000000,  0.000000000000000,  0.040299292749744,  -0.006037356345576,
        0.000000000000000,  0.000000000000000,  0.010422234556270,  0.017433002781594,  0.000000000000000,  0.000000000000000,  0.031863495361763,
        0.062405581967935,  0.000000000000000,  0.000000000000000,  -0.032151650975143, 0.071985321033605,  0.000000000000000,  0.000000000000000,
        -0.062451788588012, -0.028724763116430, 0.000000000000000,  0.000000000000000,  0.011546737363506,  0.173826324545226,  0.000000000000000,
        0.000000000000000,  -0.008151606439052, -0.067461268604722, 0.000000000000000,  0.000000000000000,  0.027420446753191,  0.080345964672328,
        0.000000000000000,  0.000000000000000,  -0.045247886761885, -0.100881208672255, 0.000000000000000,  0.000000000000000,  0.016736125118049,
        -0.019122386237957, 0.000000000000000,  0.000000000000000,  -0.030992586628105, 0.003627868637910,  0.000000000000000,  0.000000000000000,
        0.007705937305528,  0.068850429729112,  -0.032585718894384, -0.084785295433845, 0.000000000000000,  0.000000000000000,  0.064877353878210,
        0.061138480742239,  -0.000000000000000, 0.000000000000000,  -0.018927313237369, -0.023870423542370, 0.000000000000000,  0.000000000000000,
        0.005265527502843,  0.018784259690345,  0.000000000000000,  0.000000000000000,  -0.030292416375920, -0.032164024581004, 0.000000000000000,
        0.000000000000000,  0.035094824133488,  0.045972206798271,  0.000000000000000,  -0.000000000000000, -0.023172844731428, -0.012999155843518,
        0.000000000000000,  0.000000000000000,  0.010422234556270,  -0.030992586628105, 0.600000000000000,  0.276762422758823,  -0.081627277166171,
        -0.112408529155384, 0.000000000000000,  0.000000000000000,  -0.104539765271398, -0.208162406088968, 0.000000000000000,  0.000000000000000,
        0.033183167712395,  0.028751875381055,  0.000000000000000,  0.000000000000000,  -0.035872725896946, -0.088444130721984, 0.000000000000000,
        0.000000000000000,  0.015533856180920,  0.030642873502483,  0.000000000000000,  0.000000000000000,  -0.021985645037314, -0.040655608747221,
        0.000000000000000,  0.000000000000000,  0.038139454979994,  0.065052669337060,  -0.000000000000000, -0.000000000000000, -0.009597704081576,
        -0.013730872332676, 0.000000000000000,  0.000000000000000,  0.017433002781594,  0.003627868637910,  0.276762422758823,  0.600000000000000,
        -0.053355296517846, -0.106690057647853, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.039492738237136,
        0.112895621214961,  0.000000000000000,  0.000000000000000,  0.034644740297604,  0.105869267957398,  0.000000000000000,  0.000000000000000,
        -0.122199627964126, -0.101141936057667, 0.000000000000000,  0.000000000000000,  -0.019266497574336, -0.033663448707555, 0.000000000000000,
        0.000000000000000,  -0.036252293420583, -0.012725008078676, 0.000000000000000,  0.000000000000000,  0.110360671864521,  0.089836336577316,
        0.000000000000000,  0.000000000000000,  -0.055447462839606, -0.106285866277310, 0.000000000000000,  0.000000000000000,  -0.081627277166171,
        -0.053355296517846, 0.000000000000000,  0.000000000000000,  -0.010295252404099, -0.058556211647314, 0.000000000000000,  0.000000000000000,
        0.068629956261822,  0.204564011673104,  0.000000000000000,  0.000000000000000,  0.084195525137066,  0.209108628968499,  0.000000000000000,
        0.000000000000000,  -0.118145484967711, -0.148954605012599, 0.000000000000000,  0.000000000000000,  0.002786250019163,  -0.033930476079912,
        0.000000000000000,  0.000000000000000,  -0.020141536078013, -0.014863826596495, 0.000000000000000,  0.000000000000000,  0.061417851780883,
        0.105466643208656,  0.000000000000000,  0.000000000000000,  -0.052835785981434, -0.142681060299368, 0.000000000000000,  0.000000000000000,
        -0.112408529155384, -0.106690057647853, 0.000000000000000,  0.000000000000000,  0.018774798245853,  -0.044716706247522, -0.039206748156724,
        -0.068876124903515, -0.000000000000000, 0.000000000000000,  0.032601675663235,  0.030014851289190,  0.000000000000000,  0.000000000000000,
        0.018782584983035,  0.024066649083602,  0.000000000000000,  0.000000000000000,  0.029828140877873,  0.042260041201209,  0.000000000000000,
        0.000000000000000,  -0.004711015016647, -0.000241324394658, 0.000000000000000,  0.000000000000000,  -0.045052172813698, -0.061555479241106,
        0.000000000000000,  0.000000000000000,  0.030802660718196,  0.060571797572391,  -0.000000000000000, 0.000000000000000,  0.031863495361763,
        0.007705937305528,  0.000000000000000,  0.000000000000000,  -0.010295252404099, 0.018774798245853,  0.600000000000001,  0.276762422758823,
        -0.112649429028628, -0.204413287110298, 0.000000000000000,  0.000000000000000,  -0.036489452744490, -0.071766546716052, 0.000000000000000,
        0.000000000000000,  0.031080557590604,  0.049444167272336,  0.000000000000000,  0.000000000000000,  -0.003106086668201, 0.009343990882574,
        0.000000000000000,  0.000000000000000,  -0.001177493617062, -0.000386840100583, 0.000000000000000,  -0.000000000000000, -0.001980111847577,
        -0.022482860545147, 0.000000000000000,  0.000000000000000,  0.016939083419715,  0.050007533507295,  0.000000000000000,  -0.000000000000000,
        0.062405581967935,  0.068850429729112,  0.000000000000000,  0.000000000000000,  -0.058556211647314, -0.044716706247522, 0.276762422758823,
        0.600000000000001};

    ASSERT_EQ(dipymat, CDenseMatrix(intyvals, 36, 36));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.032768100684023, 0.007700298933820,  0.000000000000000,  0.000000000000000,  -0.022194778039081,
        -0.007745579174130, 0.000000000000000,  0.000000000000000,  -0.014707990239910, 0.001356750460815,  0.000000000000000,  0.000000000000000,
        0.020122600091297,  -0.002242884936255, 0.000000000000000,  0.000000000000000,  -0.012089050984557, 0.000486957208406,  0.000000000000000,
        0.000000000000000,  -0.010470682259376, 0.000512110525445,  0.000000000000000,  0.000000000000000,  0.027803180325318,  -0.003510501061153,
        0.000000000000000,  0.000000000000000,  -0.031311934649384, -0.011576154487108, 0.000000000000000,  0.000000000000000,  0.000395287746122,
        0.000021586023396,  0.000000000000000,  0.000000000000000,  -0.024308105814384, 0.030563564131050,  0.000000000000000,  0.000000000000000,
        -0.029207954676029, -0.009360408314230, 0.000000000000000,  0.000000000000000,  -0.006949624636176, 0.004864455620238,  0.000000000000000,
        0.000000000000000,  0.007313022474401,  -0.006751882365026, 0.000000000000000,  0.000000000000000,  -0.003567471548069, 0.001509251595289,
        0.000000000000000,  0.000000000000000,  -0.003438538605710, 0.001710705170258,  0.000000000000000,  0.000000000000000,  0.014043361972229,
        -0.011944317975315, 0.000000000000000,  0.000000000000000,  -0.043192440060091, -0.014010615683868, 0.000000000000000,  0.000000000000000,
        0.000164141672154,  0.000027721217848,  -0.032768100684023, -0.024308105814384, 1.100000000000000,  0.507397775057842,  -0.050972466148479,
        -0.078276643436268, 0.000000000000000,  0.000000000000000,  -0.070776542371295, -0.063073817113984, 0.000000000000000,  0.000000000000000,
        0.115449810164266,  0.085954547140347,  0.000000000000000,  0.000000000000000,  -0.064716459595693, -0.038333310149363, 0.000000000000000,
        0.000000000000000,  -0.049230722881434, -0.030194636911218, 0.000000000000000,  0.000000000000000,  0.147713784338415,  0.141778212494429,
        -0.000000000000000, 0.000000000000000,  -0.072401574687066, -0.115808581099605, 0.000000000000000,  0.000000000000000,  0.000395287746122,
        0.000164141672154,  0.000000000000000,  0.000000000000000,  0.007700298933820,  0.030563564131050,  0.507397775057842,  1.100000000000001,
        -0.087681883101812, -0.154168705254664, 0.000000000000000,  0.000000000000000,  -0.051330315321698, -0.074559925859669, 0.000000000000000,
        0.000000000000000,  0.058172356970146,  0.078170024200701,  0.000000000000000,  0.000000000000000,  -0.020409859566889, -0.025008006665764,
        0.000000000000000,  0.000000000000000,  -0.017295652858440, -0.022141520153849, 0.000000000000000,  0.000000000000000,  0.119954741276695,
        0.175399936484218,  0.000000000000000,  0.000000000000000,  -0.131057730026701, -0.230759001882322, 0.000000000000000,  0.000000000000000,
        0.000021586023396,  0.000027721217848,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.050972466148479,
        -0.087681883101812, 0.000000000000000,  0.000000000000000,  0.026942095599766,  -0.030255588139185, 0.000000000000000,  0.000000000000000,
        -0.003678608003457, 0.030359367691951,  0.000000000000000,  0.000000000000000,  0.024897750282058,  0.024835943406667,  0.000000000000000,
        0.000000000000000,  0.006760787175363,  0.006293609115805,  0.000000000000000,  0.000000000000000,  -0.041726379375411, -0.052127160060778,
        0.000000000000000,  0.000000000000000,  -0.012071631921458, 0.043699146844328,  0.000000000000000,  0.000000000000000,  -0.001685269049817,
        -0.000192780011590, 0.000000000000000,  0.000000000000000,  0.074929606488063,  0.131347534787367,  0.000000000000000,  0.000000000000000,
        -0.078276643436268, -0.154168705254664, 0.000000000000000,  0.000000000000000,  -0.000924971739713, -0.039065522317446, 0.000000000000000,
        0.000000000000000,  -0.023788429895959, 0.031558950302349,  0.000000000000000,  0.000000000000000,  0.002329334342103,  0.026089666429683,
        0.000000000000000,  0.000000000000000,  0.000118655453486,  0.006932553052519,  0.000000000000000,  0.000000000000000,  -0.003245763232906,
        -0.056218750110575, 0.000000000000000,  0.000000000000000,  -0.037162481103020, 0.045504325481849,  0.000000000000000,  0.000000000000000,
        -0.000263316346337, -0.000110774219473, 0.000000000000000,  0.000000000000000,  0.116809533853078,  0.231066852742623,  -0.022194778039081,
        -0.029207954676029, 0.000000000000000,  0.000000000000000,  0.026942095599766,  -0.000924971739713, 1.100000000000000,  0.507397775057842,
        0.010615656611837,  -0.026944821755616, 0.000000000000000,  0.000000000000000,  0.014266035578594,  -0.026817332061352, -0.000000000000000,
        0.000000000000000,  0.004294469165028,  -0.007716660463066, 0.000000000000000,  0.000000000000000,  -0.019494170490209, 0.057617678105221,
        -0.000000000000000, 0.000000000000000,  0.009569668588293,  -0.039987357158457, 0.000000000000000,  0.000000000000000,  -0.001685269049817,
        -0.000263316346337, 0.000000000000000,  0.000000000000000,  0.032545835768249,  0.043578451222996,  -0.000000000000000, 0.000000000000000,
        -0.007745579174130, -0.009360408314230, 0.000000000000000,  0.000000000000000,  -0.030255588139185, -0.039065522317446, 0.507397775057842,
        1.100000000000001,  -0.011657902982477, -0.061561626859853, 0.000000000000000,  0.000000000000000,  -0.012979290230889, -0.035035367364953,
        0.000000000000000,  0.000000000000000,  -0.003880384536326, -0.009468144463982, 0.000000000000000,  0.000000000000000,  0.030106506695983,
        0.078362437735382,  0.000000000000000,  0.000000000000000,  -0.017392717486796, -0.091387382087002, 0.000000000000000,  0.000000000000000,
        -0.000192780011590, -0.000110774219473, 0.000000000000000,  0.000000000000000,  0.011602458591507,  0.014029306959426,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.070776542371295, -0.051330315321698, 0.000000000000000,  0.000000000000000,
        0.010615656611837,  -0.011657902982477, 0.000000000000000,  0.000000000000000,  -0.050560522950458, -0.081302959123406, 0.000000000000000,
        0.000000000000000,  0.021998317925467,  0.016782398044487,  0.000000000000000,  0.000000000000000,  -0.026707695631198, -0.044054706435964,
        0.000000000000000,  0.000000000000000,  0.021029376085533,  0.038587872279782,  0.000000000000000,  0.000000000000000,  -0.007363633302731,
        -0.000652339030951, 0.000000000000000,  0.000000000000000,  -0.027894443219641, 0.017664214014286,  0.000000000000000,  0.000000000000000,
        -0.154135399033103, -0.120893493668213, 0.000000000000000,  0.000000000000000,  -0.063073817113984, -0.074559925859669, 0.000000000000000,
        0.000000000000000,  -0.026944821755616, -0.061561626859853, 0.000000000000000,  0.000000000000000,  -0.068785407873950, -0.122491516973596,
        0.000000000000000,  0.000000000000000,  -0.009434526087431, 0.016405526003518,  0.000000000000000,  0.000000000000000,  -0.029317733672924,
        -0.054693671581336, 0.000000000000000,  0.000000000000000,  -0.009739516666367, 0.048376627003299,  0.000000000000000,  0.000000000000000,
        -0.001124263621162, -0.001046482906849, 0.000000000000000,  0.000000000000000,  0.041227142948577,  0.094141825309507,  0.000000000000000,
        0.000000000000000,  -0.144561100948043, -0.176427365496614, -0.014707990239910, -0.006949624636176, 0.000000000000000,  0.000000000000000,
        -0.003678608003457, -0.023788429895959, 0.000000000000000,  0.000000000000000,  -0.050560522950458, -0.068785407873950, 1.100000000000001,
        0.507397775057842,  0.054019474693666,  0.026574674472261,  0.000000000000000,  0.000000000000000,  -0.035729999430081, -0.008844583183380,
        -0.000000000000000, 0.000000000000000,  0.076860771197161,  0.033200570474108,  0.000000000000000,  0.000000000000000,  -0.007363633302731,
        -0.001124263621162, 0.000000000000000,  0.000000000000000,  -0.006829676242864, 0.032894547544221,  -0.000000000000000, 0.000000000000000,
        -0.029976389322302, -0.014807504256544, 0.000000000000000,  0.000000000000000,  0.001356750460815,  0.004864455620238,  0.000000000000000,
        0.000000000000000,  0.030359367691951,  0.031558950302349,  0.000000000000000,  0.000000000000000,  -0.081302959123406, -0.122491516973596,
        0.507397775057842,  1.100000000000001,  0.028604730799282,  0.011208389926129,  0.000000000000000,  0.000000000000000,  0.001263370165794,
        0.025989369455368,  0.000000000000000,  0.000000000000000,  0.027165051593849,  -0.012551837444082, 0.000000000000000,  0.000000000000000,
        -0.000652339030951, -0.001046482906849, 0.000000000000000,  0.000000000000000,  -0.049005538641807, -0.050793976124796, 0.000000000000000,
        0.000000000000000,  0.003436775443890,  0.011866149531679,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.115449810164266,  0.058172356970146,  0.000000000000000,  0.000000000000000,  0.014266035578594,  -0.012979290230889, 0.000000000000000,
        0.000000000000000,  0.054019474693666,  0.028604730799282,  0.000000000000000,  0.000000000000000,  -0.020055509615774, -0.055669905816641,
        0.000000000000000,  0.000000000000000,  -0.039205263139301, 0.009293510648453,  0.000000000000000,  0.000000000000000,  0.012430852062212,
        0.015489972955040,  0.000000000000000,  0.000000000000000,  -0.075610238944159, -0.022442438212326, 0.000000000000000,  0.000000000000000,
        -0.001874401826337, -0.028593767771127, 0.000000000000000,  0.000000000000000,  -0.002006131583366, 0.005922183334779,  0.000000000000000,
        0.000000000000000,  0.085954547140347,  0.078170024200701,  0.000000000000000,  0.000000000000000,  -0.026817332061352, -0.035035367364953,
        0.000000000000000,  0.000000000000000,  0.026574674472261,  0.011208389926129,  0.000000000000000,  0.000000000000000,  -0.097262602674588,
        -0.126288028154894, 0.000000000000000,  0.000000000000000,  -0.030103039035633, 0.034085484630039,  0.000000000000000,  0.000000000000000,
        0.015613730016059,  0.014645582981019,  0.000000000000000,  0.000000000000000,  -0.031202138103823, 0.021361164144064,  0.000000000000000,
        0.000000000000000,  -0.047843882681997, -0.070069040720156, 0.000000000000000,  0.000000000000000,  0.004468352802619,  0.008973250795682,
        0.020122600091297,  0.007313022474401,  0.000000000000000,  0.000000000000000,  0.024897750282058,  0.002329334342103,  -0.000000000000000,
        0.000000000000000,  0.021998317925467,  -0.009434526087431, 0.000000000000000,  0.000000000000000,  -0.020055509615774, -0.097262602674588,
        1.100000000000000,  0.507397775057842,  0.045580223087795,  0.051106999532743,  0.000000000000000,  0.000000000000000,  0.012430852062212,
        0.015613730016059,  0.000000000000000,  0.000000000000000,  -0.017438945844733, 0.008415834926933,  -0.000000000000000, 0.000000000000000,
        0.015598522416674,  -0.000152264575994, 0.000000000000000,  0.000000000000000,  -0.002094243925249, -0.000422545248285, 0.000000000000000,
        0.000000000000000,  -0.002242884936255, -0.006751882365026, 0.000000000000000,  0.000000000000000,  0.024835943406667,  0.026089666429683,
        0.000000000000000,  0.000000000000000,  0.016782398044487,  0.016405526003518,  0.000000000000000,  0.000000000000000,  -0.055669905816641,
        -0.126288028154894, 0.507397775057842,  1.100000000000001,  0.018663469662872,  -0.012593620022900, 0.000000000000000,  0.000000000000000,
        0.015489972955040,  0.014645582981019,  0.000000000000000,  0.000000000000000,  -0.042612154843698, -0.055507128402706, 0.000000000000000,
        0.000000000000000,  0.041287878734369,  0.046948533703816,  0.000000000000000,  0.000000000000000,  -0.000371175057148, -0.000961298907069,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.064716459595693, -0.020409859566889, 0.000000000000000,
        0.000000000000000,  0.004294469165028,  -0.003880384536326, 0.000000000000000,  0.000000000000000,  -0.035729999430081, 0.001263370165794,
        0.000000000000000,  0.000000000000000,  0.045580223087795,  0.018663469662872,  0.000000000000000,  0.000000000000000,  -0.014440456901100,
        -0.054776470714941, 0.000000000000000,  0.000000000000000,  0.030386815391864,  0.012442313108582,  0.000000000000000,  0.000000000000000,
        0.014887499762534,  -0.000526404235748, 0.000000000000000,  0.000000000000000,  -0.021949509065697, 0.019833076518999,  0.000000000000000,
        0.000000000000000,  -0.064177155765729, -0.020239777403831, 0.000000000000000,  0.000000000000000,  -0.038333310149363, -0.025008006665764,
        0.000000000000000,  0.000000000000000,  -0.007716660463066, -0.009468144463982, 0.000000000000000,  0.000000000000000,  -0.008844583183380,
        0.025989369455368,  0.000000000000000,  0.000000000000000,  0.051106999532743,  -0.012593620022900, 0.000000000000000,  0.000000000000000,
        -0.101707529510565, -0.131737259891564, 0.000000000000000,  0.000000000000000,  0.034071333021828,  -0.008395746681934, 0.000000000000000,
        0.000000000000000,  0.003685242993075,  -0.010828903939737, 0.000000000000000,  0.000000000000000,  0.039440709033449,  0.048392738371466,
        0.000000000000000,  0.000000000000000,  -0.038013865898118, -0.024799606610216, -0.012089050984557, -0.003567471548069, 0.000000000000000,
        0.000000000000000,  0.006760787175363,  0.000118655453486,  0.000000000000000,  0.000000000000000,  -0.026707695631198, -0.029317733672924,
        -0.000000000000000, 0.000000000000000,  -0.039205263139301, -0.030103039035633, 0.000000000000000,  0.000000000000000,  -0.014440456901100,
        -0.101707529510565, 1.100000000000001,  0.507397775057842,  -0.026136842092867, -0.020068692690422, 0.000000000000000,  0.000000000000000,
        0.011128206512999,  0.012215722363718,  0.000000000000000,  -0.000000000000000, -0.034555134451856, -0.000606461206708, -0.000000000000000,
        0.000000000000000,  -0.011988308893019, -0.003537742618502, 0.000000000000000,  0.000000000000000,  0.000486957208406,  0.001509251595289,
        0.000000000000000,  0.000000000000000,  0.006293609115805,  0.006932553052519,  0.000000000000000,  0.000000000000000,  -0.044054706435964,
        -0.054693671581336, 0.000000000000000,  0.000000000000000,  0.009293510648453,  0.034085484630039,  0.000000000000000,  0.000000000000000,
        -0.054776470714941, -0.131737259891564, 0.507397775057842,  1.100000000000000,  0.006195673765636,  0.022723656420026,  0.000000000000000,
        0.000000000000000,  0.018356127681652,  0.022789029825557,  -0.000000000000000, 0.000000000000000,  -0.032167335480781, -0.035433048935096,
        -0.000000000000000, 0.000000000000000,  0.000482899231670,  0.001496674498662,  0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  -0.049230722881434, -0.017295652858440, 0.000000000000000,  0.000000000000000,  -0.019494170490209, 0.030106506695983,
        0.000000000000000,  0.000000000000000,  0.076860771197161,  0.027165051593849,  0.000000000000000,  0.000000000000000,  0.012430852062212,
        0.015489972955040,  0.000000000000000,  0.000000000000000,  -0.026136842092867, 0.006195673765636,  0.000000000000000,  0.000000000000000,
        -0.030414553000951, -0.068578216612508, 0.000000000000000,  0.000000000000000,  0.047627865400548,  0.004466929071501,  0.000000000000000,
        0.000000000000000,  -0.006924465301981, -0.011479157463740, 0.000000000000000,  0.000000000000000,  0.125920323136973,  0.060496583572971,
        0.000000000000000,  0.000000000000000,  -0.030194636911218, -0.022141520153849, 0.000000000000000,  0.000000000000000,  0.057617678105221,
        0.078362437735382,  0.000000000000000,  0.000000000000000,  0.033200570474108,  -0.012551837444082, 0.000000000000000,  0.000000000000000,
        0.015613730016059,  0.014645582981019,  0.000000000000000,  0.000000000000000,  -0.020068692690422, 0.022723656420026,  0.000000000000000,
        0.000000000000000,  -0.110274044354637, -0.138492680639076, 0.000000000000000,  0.000000000000000,  0.016360464579693,  -0.033817057651559,
        0.000000000000000,  0.000000000000000,  -0.017124984933322, -0.026811081991521, 0.000000000000000,  0.000000000000000,  0.091211844730379,
        0.080861027319120,  -0.010470682259376, -0.003438538605710, 0.000000000000000,  0.000000000000000,  -0.041726379375411, -0.003245763232906,
        -0.000000000000000, 0.000000000000000,  0.021029376085533,  -0.009739516666367, 0.000000000000000,  0.000000000000000,  0.012430852062212,
        0.015613730016059,  0.000000000000000,  0.000000000000000,  0.030386815391864,  0.034071333021828,  0.000000000000000,  0.000000000000000,
        -0.030414553000951, -0.110274044354637, 1.100000000000000,  0.507397775057842,  0.003647230028043,  -0.002669041641435, 0.000000000000000,
        0.000000000000000,  -0.001012374535356, -0.001040376568390, 0.000000000000000,  -0.000000000000000, 0.022690306949797,  0.008102054685770,
        0.000000000000000,  -0.000000000000000, 0.000512110525445,  0.001710705170258,  0.000000000000000,  0.000000000000000,  -0.052127160060778,
        -0.056218750110575, 0.000000000000000,  0.000000000000000,  0.038587872279782,  0.048376627003299,  0.000000000000000,  0.000000000000000,
        0.015489972955040,  0.014645582981019,  0.000000000000000,  0.000000000000000,  0.012442313108582,  -0.008395746681934, 0.000000000000000,
        0.000000000000000,  -0.068578216612508, -0.138492680639076, 0.507397775057842,  1.100000000000001,  0.037350953371166,  0.052850310933818,
        0.000000000000000,  0.000000000000000,  0.014086989424645,  0.016896701826313,  -0.000000000000000, -0.000000000000000, -0.002271685819223,
        -0.006905027363534, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.147713784338415,  0.119954741276695,
        0.000000000000000,  0.000000000000000,  0.009569668588293,  -0.017392717486796, 0.000000000000000,  0.000000000000000,  -0.007363633302731,
        -0.000652339030951, 0.000000000000000,  0.000000000000000,  -0.017438945844733, -0.042612154843698, 0.000000000000000,  0.000000000000000,
        0.011128206512999,  0.018356127681652,  0.000000000000000,  0.000000000000000,  0.003647230028043,  0.037350953371166,  0.000000000000000,
        0.000000000000000,  -0.065165062334208, -0.082596764868125, 0.000000000000000,  0.000000000000000,  0.014360417926786,  -0.011713384684912,
        0.000000000000000,  0.000000000000000,  -0.054993950700170, -0.049023115905347, 0.000000000000000,  0.000000000000000,  0.141778212494429,
        0.175399936484218,  0.000000000000000,  0.000000000000000,  -0.039987357158457, -0.091387382087002, 0.000000000000000,  0.000000000000000,
        -0.001124263621162, -0.001046482906849, 0.000000000000000,  0.000000000000000,  0.008415834926933,  -0.055507128402706, 0.000000000000000,
        0.000000000000000,  0.012215722363718,  0.022789029825557,  0.000000000000000,  0.000000000000000,  -0.002669041641435, 0.052850310933818,
        0.000000000000000,  0.000000000000000,  -0.071015197389254, -0.124567041405512, 0.000000000000000,  0.000000000000000,  -0.027198178315740,
        -0.062124511404486, 0.000000000000000,  0.000000000000000,  -0.056234230153712, -0.072034783299011, 0.027803180325318,  0.014043361972229,
        -0.000000000000000, 0.000000000000000,  -0.012071631921458, -0.037162481103020, 0.000000000000000,  0.000000000000000,  -0.007363633302731,
        -0.001124263621162, 0.000000000000000,  0.000000000000000,  -0.075610238944159, -0.031202138103823, -0.000000000000000, 0.000000000000000,
        0.014887499762534,  0.003685242993075,  0.000000000000000,  -0.000000000000000, 0.047627865400548,  0.016360464579693,  0.000000000000000,
        0.000000000000000,  -0.065165062334208, -0.071015197389254, 1.100000000000001,  0.507397775057842,  0.000183970884394,  -0.022916255868868,
        0.000000000000000,  0.000000000000000,  -0.009366830446598, -0.005071569625813, -0.000000000000000, 0.000000000000000,  -0.003510501061153,
        -0.011944317975315, 0.000000000000000,  0.000000000000000,  0.043699146844328,  0.045504325481849,  0.000000000000000,  0.000000000000000,
        -0.000652339030951, -0.001046482906849, 0.000000000000000,  0.000000000000000,  -0.022442438212326, 0.021361164144064,  0.000000000000000,
        0.000000000000000,  -0.000526404235748, -0.010828903939737, -0.000000000000000, 0.000000000000000,  0.004466929071501,  -0.033817057651559,
        0.000000000000000,  0.000000000000000,  -0.082596764868125, -0.124567041405512, 0.507397775057842,  1.100000000000001,  0.031443755965473,
        0.032639917435414,  0.000000000000000,  0.000000000000000,  0.001537948082953,  0.005056572507676,  -0.000000000000000, -0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.072401574687066, -0.131057730026701, 0.000000000000000,  0.000000000000000,  -0.001685269049817,
        -0.000192780011590, 0.000000000000000,  0.000000000000000,  -0.006829676242864, -0.049005538641807, 0.000000000000000,  0.000000000000000,
        0.015598522416674,  0.041287878734369,  0.000000000000000,  0.000000000000000,  -0.034555134451856, -0.032167335480781, 0.000000000000000,
        0.000000000000000,  -0.001012374535356, 0.014086989424645,  0.000000000000000,  0.000000000000000,  0.000183970884394,  0.031443755965473,
        0.000000000000000,  0.000000000000000,  0.035225966412272,  -0.029307985908301, 0.000000000000000,  0.000000000000000,  -0.047248321301607,
        -0.087254960107566, 0.000000000000000,  0.000000000000000,  -0.115808581099605, -0.230759001882322, 0.000000000000000,  0.000000000000000,
        -0.000263316346337, -0.000110774219473, 0.000000000000000,  0.000000000000000,  0.032894547544221,  -0.050793976124796, 0.000000000000000,
        0.000000000000000,  -0.000152264575994, 0.046948533703816,  0.000000000000000,  0.000000000000000,  -0.000606461206708, -0.035433048935096,
        0.000000000000000,  0.000000000000000,  -0.001040376568390, 0.016896701826313,  0.000000000000000,  0.000000000000000,  -0.022916255868868,
        0.032639917435414,  0.000000000000000,  0.000000000000000,  0.000369348948201,  -0.038521016190326, 0.000000000000000,  0.000000000000000,
        -0.076802099865520, -0.153715197828632, -0.031311934649384, -0.043192440060091, 0.000000000000000,  0.000000000000000,  -0.001685269049817,
        -0.000263316346337, 0.000000000000000,  0.000000000000000,  -0.027894443219641, 0.041227142948577,  -0.000000000000000, 0.000000000000000,
        -0.001874401826337, -0.047843882681997, 0.000000000000000,  0.000000000000000,  -0.021949509065697, 0.039440709033449,  -0.000000000000000,
        -0.000000000000000, -0.006924465301981, -0.017124984933322, 0.000000000000000,  -0.000000000000000, 0.014360417926786,  -0.027198178315740,
        0.000000000000000,  0.000000000000000,  0.035225966412272,  0.000369348948201,  1.100000000000000,  0.507397775057842,  -0.020377068906008,
        -0.028639306179362, 0.000000000000000,  0.000000000000000,  -0.011576154487108, -0.014010615683868, 0.000000000000000,  0.000000000000000,
        -0.000192780011590, -0.000110774219473, 0.000000000000000,  0.000000000000000,  0.017664214014286,  0.094141825309507,  0.000000000000000,
        0.000000000000000,  -0.028593767771127, -0.070069040720156, 0.000000000000000,  0.000000000000000,  0.019833076518999,  0.048392738371466,
        0.000000000000000,  0.000000000000000,  -0.011479157463740, -0.026811081991521, -0.000000000000000, -0.000000000000000, -0.011713384684912,
        -0.062124511404486, 0.000000000000000,  0.000000000000000,  -0.029307985908301, -0.038521016190326, 0.507397775057842,  1.100000000000001,
        -0.007706829544947, -0.009332873447966, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000395287746122,
        0.000021586023396,  0.000000000000000,  0.000000000000000,  0.032545835768249,  0.011602458591507,  0.000000000000000,  0.000000000000000,
        -0.029976389322302, 0.003436775443890,  0.000000000000000,  0.000000000000000,  -0.002094243925249, -0.000371175057148, 0.000000000000000,
        0.000000000000000,  -0.011988308893019, 0.000482899231670,  0.000000000000000,  0.000000000000000,  0.022690306949797,  -0.002271685819223,
        0.000000000000000,  0.000000000000000,  -0.009366830446598, 0.001537948082953,  0.000000000000000,  0.000000000000000,  -0.020377068906008,
        -0.007706829544947, 0.000000000000000,  0.000000000000000,  -0.032774716494340, 0.007699937655137,  0.000000000000000,  0.000000000000000,
        0.000164141672154,  0.000027721217848,  0.000000000000000,  0.000000000000000,  0.043578451222996,  0.014029306959426,  0.000000000000000,
        0.000000000000000,  -0.014807504256544, 0.011866149531679,  0.000000000000000,  0.000000000000000,  -0.000422545248285, -0.000961298907069,
        0.000000000000000,  0.000000000000000,  -0.003537742618502, 0.001496674498662,  0.000000000000000,  0.000000000000000,  0.008102054685770,
        -0.006905027363534, 0.000000000000000,  0.000000000000000,  -0.005071569625813, 0.005056572507676,  0.000000000000000,  0.000000000000000,
        -0.028639306179362, -0.009332873447966, 0.000000000000000,  0.000000000000000,  -0.024310853003435, 0.030563100169491,  0.000395287746122,
        0.000164141672154,  0.000000000000000,  0.000000000000000,  0.074929606488063,  0.116809533853078,  -0.000000000000000, 0.000000000000000,
        -0.154135399033103, -0.144561100948043, 0.000000000000000,  0.000000000000000,  -0.002006131583366, 0.004468352802619,  0.000000000000000,
        0.000000000000000,  -0.064177155765729, -0.038013865898118, 0.000000000000000,  0.000000000000000,  0.125920323136973,  0.091211844730379,
        0.000000000000000,  -0.000000000000000, -0.054993950700170, -0.056234230153712, -0.000000000000000, -0.000000000000000, -0.047248321301607,
        -0.076802099865520, 0.000000000000000,  0.000000000000000,  -0.032774716494340, -0.024310853003435, 1.100000000000001,  0.507397775057842,
        0.000021586023396,  0.000027721217848,  0.000000000000000,  0.000000000000000,  0.131347534787367,  0.231066852742623,  0.000000000000000,
        0.000000000000000,  -0.120893493668213, -0.176427365496614, 0.000000000000000,  0.000000000000000,  0.005922183334779,  0.008973250795682,
        0.000000000000000,  0.000000000000000,  -0.020239777403831, -0.024799606610216, 0.000000000000000,  -0.000000000000000, 0.060496583572971,
        0.080861027319120,  -0.000000000000000, 0.000000000000000,  -0.049023115905347, -0.072034783299011, 0.000000000000000,  -0.000000000000000,
        -0.087254960107566, -0.153715197828632, 0.000000000000000,  0.000000000000000,  0.007699937655137,  0.030563100169491,  0.507397775057842,
        1.100000000000001};

    ASSERT_EQ(dipzmat, CDenseMatrix(intzvals, 36, 36));
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeElectricDipoleForH2O)
{
    auto mh2o = vlxmol::getMoleculeH2O();

    auto mbas = vlxbas::getMolecularBasisForH2O();

    const int nrows = 24, ncols = 24;

    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    auto dipmat = dipdrv.compute(mh2o, mbas);

    std::vector<double> intxvals{
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0711721794901836, -0.0095418670107523, -0.0030973122602807,
        -0.0030973122602807, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4995877131608721,  0.3935639485884765,  0.1551485852674516,
        0.1551485852674516,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4668201757605733,  0.9876018205210119,  0.3637525206977920,
        0.3637525206977920,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1584260326714147,  0.3452622822326464,  0.6150444770656970,
        0.0591587481177416,  0.1486080648815627,  0.0000000000000000,  0.0000000000000000,  0.1167634795497993,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.2427430238094662,  0.8931732169920334,  0.5410966456047174,
        0.2360344379464691,  0.0726828478323672,  0.0000000000000000,  0.0000000000000000,  0.0571079518682885,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1584260326714147,  0.3452622822326464,  0.0591587481177416,
        0.6150444770656970,  -0.1486080648815627, 0.0000000000000000,  0.0000000000000000,  0.1167634795497993,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.2427430238094662,  0.8931732169920334,  0.2360344379464691,
        0.5410966456047174,  -0.0726828478323672, 0.0000000000000000,  0.0000000000000000,  0.0571079518682885,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1091283809642190,
        -0.1091283809642190, 0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3871282468215228,
        -0.3871282468215228, 0.3989009056106751,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1607176634927347, -0.1337602828408713, -0.0000000000000002,
        -0.0608387861453430, -0.1001956268097828, 0.0000000000000000,  0.0000000000000000,  -0.1680231563924489, 0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1607176634927347,  0.1337602828408713,  0.0608387861453430,
        0.0000000000000002,  -0.1001956268097828, 0.0000000000000000,  0.0000000000000000,  0.1680231563924489,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0857437279004578,
        0.0857437279004578,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3041721939311966,
        0.3041721939311966,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3989009056106752,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1262781641728630, -0.1050973650892559, 0.0000000000000000,
        0.0000000000000000,  -0.1680231563924488, 0.0000000000000000,  0.0000000000000000,  -0.0183661675277460, 0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1262781641728630, -0.1050973650892559, 0.0000000000000000,
        0.0000000000000000,  0.1680231563924488,  0.0000000000000000,  0.0000000000000000,  -0.0183661675277460, 0.0000000000000000,
        -0.0711721794901836, 0.4995877131608721,  0.4668201757605733,  0.1584260326714147,  0.2427430238094662,  0.1584260326714147,
        0.2427430238094662,  0.0000000000000000,  0.0000000000000000,  -0.1607176634927347, 0.1607176634927347,  0.0000000000000000,
        0.0000000000000000,  -0.1262781641728630, -0.1262781641728630, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2355293849427206, 0.0000000000000000,  0.4079488613962401,
        -0.0095418670107523, 0.3935639485884765,  0.9876018205210119,  0.3452622822326464,  0.8931732169920334,  0.3452622822326464,
        0.8931732169920334,  0.0000000000000000,  0.0000000000000000,  -0.1337602828408713, 0.1337602828408713,  0.0000000000000000,
        0.0000000000000000,  -0.1050973650892559, -0.1050973650892559, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2303055452343087, 0.0000000000000000,  0.3989009056106749,
        -0.0030973122602807, 0.1551485852674516,  0.3637525206977920,  0.6150444770656970,  0.5410966456047174,  0.0591587481177416,
        0.2360344379464691,  0.1091283809642190,  0.3871282468215228,  -0.0000000000000002, 0.0608387861453430,  0.0857437279004578,
        0.3041721939311966,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.1120154375949659,  -0.0559582016964863, 0.0000000000000000,  0.0423694755838101,
        -0.0030973122602807, 0.1551485852674516,  0.3637525206977920,  0.0591587481177416,  0.2360344379464691,  0.6150444770656970,
        0.5410966456047174,  -0.1091283809642190, -0.3871282468215228, -0.0608387861453430, 0.0000000000000002,  0.0857437279004578,
        0.3041721939311966,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.1120154375949659, -0.0559582016964863, 0.0000000000000000,  0.0423694755838101,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1486080648815627,  0.0726828478323672,  -0.1486080648815627,
        -0.0726828478323672, 0.4079488613962403,  0.3989009056106751,  -0.1001956268097828, -0.1001956268097828, 0.0000000000000000,
        0.0000000000000000,  -0.1680231563924488, 0.1680231563924488,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1120154375949659,
        -0.1120154375949659, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2355293849427206, -0.2303055452343087, -0.0559582016964863,
        -0.0559582016964863, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1167634795497993,  0.0571079518682885,  0.1167634795497993,
        0.0571079518682885,  0.0000000000000000,  0.0000000000000000,  -0.1680231563924489, 0.1680231563924489,  0.4079488613962403,
        0.3989009056106752,  -0.0183661675277460, -0.0183661675277460, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962401,  0.3989009056106749,  0.0423694755838101,
        0.0423694755838101,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000};

    CDenseMatrix refxdip(intxvals, nrows, ncols);

    std::vector<double> intyvals{
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0035198906277128, -0.0012071460044094, 0.0035198906277128,
        0.0012071460044094,  -0.0711721794901836, -0.0095418670107523, 0.0056615819978661,  0.0056615819978661,  0.0000000000000000,
        0.0000000000000000,  0.0068819883456867,  -0.0068819883456867, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1861706299632680,  0.0725504081298810,  -0.1861706299632680,
        -0.0725504081298810, 0.4995877131608721,  0.3935639485884766,  -0.0895993277676917, -0.0895993277676917, 0.0000000000000000,
        0.0000000000000000,  -0.1923019316704697, 0.1923019316704697,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4842937511937106,  0.3151909287606370,  -0.4842937511937107,
        -0.3151909287606370, 0.4668201757605733,  0.9876018205210119,  0.0877793262952771,  0.0877793262952771,  0.0000000000000000,
        0.0000000000000000,  -0.2168360813162617, 0.2168360813162617,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        -0.0035198906277128, 0.1861706299632680,  0.4842937511937106,  1.3999999999999992,  0.9587197546435219,  0.0000000000000000,
        0.2677722573792120,  0.2654471595272959,  0.7977820109791161,  0.6150444770656966,  0.0061382822841992,  0.0840880282439067,
        0.3555512154436549,  0.0000000000000001,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.2223197492853924,  -0.0766970384892921, 0.0000000000000000,  -0.2157802365314856,
        -0.0012071460044094, 0.0725504081298810,  0.3151909287606370,  0.9587197546435219,  1.3999999999999995,  -0.2677722573792120,
        0.0000000000000000,  0.2540021940356266,  1.0238809904913750,  0.5410966456047174,  0.0700655591134371,  0.0088464908919831,
        0.1026989648923400,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0596263747132495,  -0.0417463041090712, 0.0000000000000000,  -0.0742854805518878,
        0.0035198906277128,  -0.1861706299632680, -0.4842937511937107, 0.0000000000000000,  -0.2677722573792120, -1.3999999999999997,
        -0.9587197546435219, 0.2654471595272959,  0.7977820109791161,  0.0061382822841992,  0.6150444770656965,  -0.0840880282439067,
        -0.3555512154436549, -0.0000000000000000, -0.0000000000000001, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.2223197492853924,  0.0766970384892921,  0.0000000000000000,  0.2157802365314856,
        0.0012071460044094,  -0.0725504081298810, -0.3151909287606370, 0.2677722573792120,  0.0000000000000000,  -0.9587197546435219,
        -1.3999999999999995, 0.2540021940356266,  1.0238809904913750,  0.0700655591134371,  0.5410966456047174,  -0.0088464908919831,
        -0.1026989648923400, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0596263747132495,  0.0417463041090712,  0.0000000000000000,  0.0742854805518878,
        -0.0711721794901836, 0.4995877131608721,  0.4668201757605733,  0.2654471595272959,  0.2540021940356266,  0.2654471595272959,
        0.2540021940356266,  0.0000000000000000,  0.0000000000000000,  -0.1405495113171718, 0.1405495113171718,  0.0000000000000000,
        0.0000000000000000,  -0.2819192146929792, -0.2819192146929792, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2355293849427206, 0.0000000000000000,  -0.4079488613962401,
        -0.0095418670107523, 0.3935639485884766,  0.9876018205210119,  0.7977820109791161,  1.0238809904913750,  0.7977820109791161,
        1.0238809904913750,  0.0000000000000000,  0.0000000000000000,  0.3287413029481355,  -0.3287413029481355, 0.0000000000000000,
        0.0000000000000000,  -0.3500476498317150, -0.3500476498317150, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2303055452343086, 0.0000000000000000,  -0.3989009056106749,
        0.0056615819978661,  -0.0895993277676917, 0.0877793262952771,  0.6150444770656966,  0.5410966456047174,  0.0061382822841992,
        0.0700655591134371,  -0.1405495113171718, 0.3287413029481355,  1.3999999999999981,  0.0000000000000000,  -0.0698973226196584,
        0.0592219091887373,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.1547605285812049, -0.0329772496283651, 0.0000000000000000,  0.0204732215512857,
        0.0056615819978661,  -0.0895993277676917, 0.0877793262952771,  0.0061382822841992,  0.0700655591134371,  0.6150444770656965,
        0.5410966456047174,  0.1405495113171718,  -0.3287413029481355, 0.0000000000000000,  -1.3999999999999981, -0.0698973226196584,
        0.0592219091887373,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.1547605285812049,  -0.0329772496283651, 0.0000000000000000,  0.0204732215512857,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0840880282439067,  0.0088464908919831,  -0.0840880282439067,
        -0.0088464908919831, 0.0000000000000000,  0.0000000000000000,  -0.0698973226196584, -0.0698973226196584, 0.0000000000000000,
        0.0000000000000000,  -0.0131610158730151, 0.0131610158730151,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3555512154436549,  0.1026989648923400,  -0.3555512154436549,
        -0.1026989648923400, 0.0000000000000000,  0.0000000000000000,  0.0592219091887373,  0.0592219091887373,  0.0000000000000000,
        0.0000000000000000,  0.1946673088095906,  -0.1946673088095906, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.3989009056106753,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0068819883456867,  -0.1923019316704697, -0.2168360813162617, 0.0000000000000001,  0.0000000000000000,  -0.0000000000000000,
        0.0000000000000000,  -0.2819192146929792, -0.3500476498317150, 0.0000000000000000,  0.0000000000000000,  -0.0131610158730151,
        0.1946673088095906,  1.3999999999999986,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0414046880745507, 0.2120728914857800,  0.0000000000000000,  0.2734072800817928,
        -0.0068819883456867, 0.1923019316704697,  0.2168360813162617,  0.0000000000000000,  0.0000000000000000,  -0.0000000000000001,
        0.0000000000000000,  -0.2819192146929792, -0.3500476498317150, 0.0000000000000000,  0.0000000000000000,  0.0131610158730151,
        -0.1946673088095906, 0.0000000000000000,  -1.3999999999999986, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0414046880745507, -0.2120728914857800, 0.0000000000000000,  -0.2734072800817927,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1091283809642190,
        -0.1091283809642190, 0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3871282468215228,
        -0.3871282468215228, 0.3989009056106751,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1091283809642190,  0.3871282468215228,  1.3999999999999986,
        0.0000000000000000,  0.2562171291741995,  0.0000000000000000,  0.0000000000000000,  0.1120154375949659,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1091283809642190, -0.3871282468215228, 0.0000000000000000,
        -1.3999999999999986, 0.2562171291741995,  0.0000000000000000,  0.0000000000000000,  -0.1120154375949659, 0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.3989009056106751,  0.2562171291741995,
        0.2562171291741995,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.2223197492853924,  0.0596263747132495,  0.2223197492853924,
        0.0596263747132495,  0.0000000000000000,  0.0000000000000000,  -0.1547605285812049, 0.1547605285812049,  0.4079488613962403,
        0.3989009056106753,  -0.0414046880745507, -0.0414046880745507, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0766970384892921, -0.0417463041090712, 0.0766970384892921,
        0.0417463041090712,  -0.2355293849427206, -0.2303055452343086, -0.0329772496283651, -0.0329772496283651, 0.0000000000000000,
        0.0000000000000000,  0.2120728914857800,  -0.2120728914857800, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1120154375949659,
        -0.1120154375949659, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2157802365314856, -0.0742854805518878, 0.2157802365314856,
        0.0742854805518878,  -0.4079488613962401, -0.3989009056106749, 0.0204732215512857,  0.0204732215512857,  0.0000000000000000,
        0.0000000000000000,  0.2734072800817928,  -0.2734072800817927, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000};

    CDenseMatrix refydip(intyvals, nrows, ncols);

    std::vector<double> intzvals{
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0027656283503458, -0.0009484718606074, -0.0027656283503458,
        -0.0009484718606074, 0.0000000000000000,  0.0000000000000000,  0.0068819883456867,  -0.0068819883456867, -0.0711721794901836,
        -0.0095418670107523, 0.0023099642970446,  0.0023099642970446,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1462769235425677,  0.0570038921020493,  0.1462769235425677,
        0.0570038921020493,  0.0000000000000000,  0.0000000000000000,  -0.1923019316704697, 0.1923019316704697,  0.4995877131608721,
        0.3935639485884766,  0.0040542103835110,  0.0040542103835110,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3805165187950585,  0.2476500154547863,  0.3805165187950585,
        0.2476500154547863,  0.0000000000000000,  0.0000000000000000,  -0.2168360813162617, 0.2168360813162617,  0.4668201757605733,
        0.9876018205210119,  0.1933813139493006,  0.1933813139493006,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        -0.0027656283503458, 0.1462769235425677,  0.3805165187950585,  1.0999999999999996,  0.7532798072199102,  0.1447567973878563,
        0.3500103401159430,  0.0840880282439067,  0.3555512154436549,  -0.0000000000000004, 0.1692739096902533,  0.2244951977201985,
        0.6246239515098039,  0.6150444770656971,  0.0591587481177416,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.2315451339595288,  0.1419783202357668,  0.0000000000000000,  -0.0527781348677965,
        -0.0009484718606074, 0.0570038921020493,  0.2476500154547863,  0.7532798072199102,  1.0999999999999996,  0.3500103401159430,
        0.6819954241656764,  0.0088464908919831,  0.1026989648923400,  0.0000000000000000,  0.1773113496892306,  0.2496938380817387,
        0.9738652608360148,  0.5410966456047173,  0.2360344379464691,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0746616086391223,  0.0661132066378035,  0.0000000000000000,  -0.0012592114224805,
        -0.0027656283503458, 0.1462769235425677,  0.3805165187950585,  0.1447567973878563,  0.3500103401159430,  1.0999999999999996,
        0.7532798072199102,  -0.0840880282439067, -0.3555512154436549, -0.1692739096902533, 0.0000000000000004,  0.2244951977201984,
        0.6246239515098039,  0.0591587481177416,  0.6150444770656971,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.2315451339595287, 0.1419783202357668,  0.0000000000000000,  -0.0527781348677966,
        -0.0009484718606074, 0.0570038921020493,  0.2476500154547863,  0.3500103401159430,  0.6819954241656764,  0.7532798072199102,
        1.0999999999999996,  -0.0088464908919831, -0.1026989648923400, -0.1773113496892306, 0.0000000000000000,  0.2496938380817387,
        0.9738652608360148,  0.2360344379464691,  0.5410966456047173,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0746616086391223, 0.0661132066378035,  0.0000000000000000,  -0.0012592114224805,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0840880282439067,  0.0088464908919831,  -0.0840880282439067,
        -0.0088464908919831, 0.0000000000000000,  0.0000000000000000,  -0.0698973226196584, -0.0698973226196584, 0.0000000000000000,
        0.0000000000000000,  -0.0131610158730151, 0.0131610158730151,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3555512154436549,  0.1026989648923400,  -0.3555512154436549,
        -0.1026989648923400, 0.0000000000000000,  0.0000000000000000,  0.0592219091887373,  0.0592219091887373,  0.0000000000000000,
        0.0000000000000000,  0.1946673088095906,  -0.1946673088095906, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.3989009056106753,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0068819883456867,  -0.1923019316704697, -0.2168360813162617, -0.0000000000000004, 0.0000000000000000,  -0.1692739096902533,
        -0.1773113496892306, -0.0698973226196584, 0.0592219091887373,  1.0999999999999992,  -0.2520116347243380, -0.2830070603299689,
        -0.3262212208528037, -0.0000000000000002, -0.0608387861453430, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.1777871202112785, -0.2729681813805748, 0.0000000000000000,  -0.0066313139056220,
        -0.0068819883456867, 0.1923019316704697,  0.2168360813162617,  0.1692739096902533,  0.1773113496892306,  0.0000000000000004,
        0.0000000000000000,  -0.0698973226196584, 0.0592219091887373,  -0.2520116347243380, 1.0999999999999992,  0.2830070603299690,
        0.3262212208528037,  0.0608387861453430,  0.0000000000000002,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.1777871202112785, 0.2729681813805747,  0.0000000000000000,  0.0066313139056220,
        -0.0711721794901836, 0.4995877131608721,  0.4668201757605733,  0.2244951977201985,  0.2496938380817387,  0.2244951977201984,
        0.2496938380817387,  0.0000000000000000,  0.0000000000000000,  -0.2830070603299689, 0.2830070603299690,  0.0000000000000000,
        0.0000000000000000,  -0.0508752344583457, -0.0508752344583457, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4710587698854412,  0.0000000000000000,  -0.0000000000000000,
        -0.0095418670107523, 0.3935639485884766,  0.9876018205210119,  0.6246239515098039,  0.9738652608360148,  0.6246239515098039,
        0.9738652608360148,  0.0000000000000000,  0.0000000000000000,  -0.3262212208528037, 0.3262212208528037,  0.0000000000000000,
        0.0000000000000000,  0.3520277143351905,  0.3520277143351905,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4606110904686173,  0.0000000000000000,  -0.0000000000000000,
        0.0023099642970446,  0.0040542103835110,  0.1933813139493006,  0.6150444770656971,  0.5410966456047173,  0.0591587481177416,
        0.2360344379464691,  -0.0131610158730151, 0.1946673088095906,  -0.0000000000000002, 0.0608387861453430,  -0.0508752344583457,
        0.3520277143351905,  1.0999999999999992,  0.0478019033999124,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0741094135128294, 0.0788593634582486,  0.0000000000000000,  0.0115192602734023,
        0.0023099642970446,  0.0040542103835110,  0.1933813139493006,  0.0591587481177416,  0.2360344379464691,  0.6150444770656971,
        0.5410966456047173,  0.0131610158730151,  -0.1946673088095906, -0.0608387861453430, 0.0000000000000002,  -0.0508752344583457,
        0.3520277143351905,  0.0478019033999124,  1.0999999999999992,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0741094135128294,  0.0788593634582486,  0.0000000000000000,  0.0115192602734023,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0857437279004578,
        0.0857437279004578,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3041721939311966,
        0.3041721939311966,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3989009056106752,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0857437279004578,  0.3041721939311966,  1.0999999999999992,
        0.0478019033999124,  0.1120154375949659,  0.0000000000000000,  0.0000000000000000,  0.2016641563195084,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0857437279004578,  0.3041721939311966,  0.0478019033999124,
        1.0999999999999992,  -0.1120154375949659, 0.0000000000000000,  0.0000000000000000,  0.2016641563195084,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1120154375949659,
        -0.1120154375949659, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.2315451339595288,  0.0746616086391223,  -0.2315451339595287,
        -0.0746616086391223, 0.4079488613962403,  0.3989009056106753,  -0.1777871202112785, -0.1777871202112785, 0.0000000000000000,
        0.0000000000000000,  -0.0741094135128294, 0.0741094135128294,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1419783202357668,  0.0661132066378035,  0.1419783202357668,
        0.0661132066378035,  0.0000000000000000,  0.0000000000000000,  -0.2729681813805748, 0.2729681813805747,  0.4710587698854412,
        0.4606110904686173,  0.0788593634582486,  0.0788593634582486,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.3989009056106752,  0.2016641563195084,
        0.2016641563195084,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0527781348677965, -0.0012592114224805, -0.0527781348677966,
        -0.0012592114224805, 0.0000000000000000,  0.0000000000000000,  -0.0066313139056220, 0.0066313139056220,  -0.0000000000000000,
        -0.0000000000000000, 0.0115192602734023,  0.0115192602734023,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000};

    CDenseMatrix refzdip(intzvals, nrows, ncols);

    CElectricDipoleMatrix refmat(refxdip, refydip, refzdip, 0.0, 0.0, 0.0);

    ASSERT_EQ(refmat, dipmat);
}

TEST_F(CElectricDipoleIntegralsDriverTest, ComputeElectricDipoleForH2OWithOrigin)
{
    auto mh2o = vlxmol::getMoleculeH2O();

    auto mbas = vlxbas::getMolecularBasisForH2O();

    const int nrows = 24, ncols = 24;

    CElectricDipoleIntegralsDriver dipdrv(MPI_COMM_WORLD);

    dipdrv.setElectricDipoleOrigin(1.0, 1.0, 1.0);

    auto dipmat = dipdrv.compute(mh2o, mbas);

    std::vector<double> intxvals{
        -0.9999999999999997, 0.3440165538027237,  0.1578700420051422,  0.0501656231976193,  0.0633305279577229,  0.0501656231976193,
        0.0633305279577229,  0.0000000000000000,  0.0000000000000000,  -0.0763467930722837, 0.0763467930722837,  0.0000000000000000,
        0.0000000000000000,  -0.0599867659853658, -0.0599867659853658, -0.0711721794901836, -0.0095418670107523, -0.0030973122602807,
        -0.0030973122602807, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0000000000000000,
        0.3440165538027237,  -0.9999999999999997, -0.7889407941247983, -0.3406235992599204, -0.3959240096535122, -0.3406235992599204,
        -0.3959240096535122, 0.0000000000000000,  0.0000000000000000,  0.3517726258351696,  -0.3517726258351696, 0.0000000000000000,
        0.0000000000000000,  0.2763927774419191,  0.2763927774419191,  0.4995877131608720,  0.3935639485884767,  0.1551485852674516,
        0.1551485852674516,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.1578700420051422,  -0.7889407941247983, -1.0000000000000004, -0.5204161955407220, -0.6964708172927371, -0.5204161955407220,
        -0.6964708172927371, 0.0000000000000000,  0.0000000000000000,  0.2600327171534035,  -0.2600327171534035, 0.0000000000000000,
        0.0000000000000000,  0.2043114206205314,  0.2043114206205314,  0.4668201757605733,  0.9876018205210118,  0.3637525206977919,
        0.3637525206977919,  0.0000000000000000,  0.0000000000000000,  -0.0000000000000001, 0.0000000000000000,  0.0000000000000000,
        0.0501656231976193,  -0.3406235992599204, -0.5204161955407220, -0.9999999999999994, -0.6847998247453728, -0.1315970885344148,
        -0.3181912182872208, -0.2268286782743811, -0.4907655073442481, 0.0000000000000004,  -0.1538853724456848, -0.1782225329298709,
        -0.3856014700561949, -0.0000000000000001, -0.0000000000000000, 0.1584260326714147,  0.3452622822326464,  0.6150444770656970,
        0.0591587481177416,  0.1486080648815627,  -0.1945155339272352, -0.0167726149682624, 0.1167634795497993,  0.1237826124991496,
        0.0633305279577229,  -0.3959240096535122, -0.6964708172927371, -0.6847998247453728, -0.9999999999999996, -0.3181912182872208,
        -0.6199958401506149, -0.0828867746314030, -0.3049819763377968, 0.0000000000000000,  -0.1611921360811187, -0.0651253229246738,
        -0.2396286956939832, 0.0000000000000000,  0.0000000000000000,  0.2427430238094663,  0.8931732169920334,  0.5410966456047174,
        0.2360344379464691,  0.0726828478323673,  -0.0195000204820850, -0.0016814406994436, 0.0571079518682885,  0.0124091039431450,
        0.0501656231976193,  -0.3406235992599204, -0.5204161955407220, -0.1315970885344148, -0.3181912182872208, -0.9999999999999996,
        -0.6847998247453728, 0.2268286782743811,  0.4907655073442481,  0.1538853724456848,  -0.0000000000000004, -0.1782225329298709,
        -0.3856014700561949, -0.0000000000000000, -0.0000000000000001, 0.1584260326714147,  0.3452622822326464,  0.0591587481177416,
        0.6150444770656970,  -0.1486080648815627, 0.1945155339272352,  -0.0167726149682624, 0.1167634795497993,  0.1237826124991496,
        0.0633305279577229,  -0.3959240096535122, -0.6964708172927371, -0.3181912182872208, -0.6199958401506149, -0.6847998247453728,
        -0.9999999999999996, 0.0828867746314030,  0.3049819763377968,  0.1611921360811187,  0.0000000000000000,  -0.0651253229246738,
        -0.2396286956939832, 0.0000000000000000,  0.0000000000000000,  0.2427430238094663,  0.8931732169920334,  0.2360344379464691,
        0.5410966456047174,  -0.0726828478323673, 0.0195000204820850,  -0.0016814406994436, 0.0571079518682885,  0.0124091039431450,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2268286782743811, -0.0828867746314030, 0.2268286782743811,
        0.0828867746314030,  -0.9999999999999990, -0.5021408928230413, 0.1672603916116159,  0.1672603916116159,  0.0000000000000000,
        0.0000000000000000,  0.2828630877472131,  -0.2828630877472131, 0.0000000000000000,  0.0000000000000000,  0.1091283809642190,
        -0.1091283809642190, 0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.4907655073442481, -0.3049819763377968, 0.4907655073442481,
        0.3049819763377968,  -0.5021408928230413, -0.9999999999999988, -0.0724402019095872, -0.0724402019095872, 0.0000000000000000,
        0.0000000000000000,  0.2354180977999332,  -0.2354180977999332, 0.0000000000000000,  0.0000000000000000,  0.3871282468215228,
        -0.3871282468215228, 0.3989009056106751,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        -0.0763467930722837, 0.3517726258351696,  0.2600327171534035,  0.0000000000000004,  0.0000000000000000,  0.1538853724456848,
        0.1611921360811187,  0.1672603916116159,  -0.0724402019095872, -0.9999999999999993, 0.2291014861130346,  0.2828630877472131,
        0.2354180977999334,  0.0000000000000000,  0.0000000000000000,  -0.1607176634927348, -0.1337602828408713, -0.0000000000000002,
        -0.0608387861453430, -0.1001956268097828, 0.1763443031852177,  0.1794358005318928,  -0.1680231563924489, 0.0150711679673227,
        0.0763467930722837,  -0.3517726258351696, -0.2600327171534035, -0.1538853724456848, -0.1611921360811187, -0.0000000000000004,
        0.0000000000000000,  0.1672603916116159,  -0.0724402019095872, 0.2291014861130346,  -0.9999999999999993, -0.2828630877472131,
        -0.2354180977999334, 0.0000000000000000,  0.0000000000000000,  0.1607176634927348,  0.1337602828408713,  0.0608387861453430,
        0.0000000000000002,  -0.1001956268097828, 0.1763443031852177,  -0.1794358005318928, 0.1680231563924489,  -0.0150711679673227,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1782225329298709, -0.0651253229246738, -0.1782225329298709,
        -0.0651253229246738, 0.0000000000000000,  0.0000000000000000,  0.2828630877472131,  -0.2828630877472131, -0.9999999999999990,
        -0.5021408928230413, 0.0295023943321291,  0.0295023943321291,  0.0000000000000000,  0.0000000000000000,  0.0857437279004578,
        0.0857437279004578,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.3856014700561949, -0.2396286956939832, -0.3856014700561949,
        -0.2396286956939832, 0.0000000000000000,  0.0000000000000000,  0.2354180977999334,  -0.2354180977999334, -0.5021408928230413,
        -0.9999999999999988, -0.1870918729160483, -0.1870918729160483, 0.0000000000000000,  0.0000000000000000,  0.3041721939311966,
        0.3041721939311966,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3989009056106752,  0.0000000000000000,
        -0.0599867659853658, 0.2763927774419191,  0.2043114206205314,  -0.0000000000000001, 0.0000000000000000,  -0.0000000000000000,
        0.0000000000000000,  0.2828630877472131,  0.2354180977999332,  0.0000000000000000,  0.0000000000000000,  0.0295023943321291,
        -0.1870918729160483, -0.9999999999999992, -0.0434562758181022, -0.1262781641728631, -0.1050973650892559, 0.0000000000000000,
        0.0000000000000000,  -0.1680231563924488, 0.0411402152621511,  -0.2054726373437663, -0.0183661675277460, -0.1881859351595428,
        -0.0599867659853658, 0.2763927774419191,  0.2043114206205314,  -0.0000000000000000, 0.0000000000000000,  -0.0000000000000001,
        0.0000000000000000,  -0.2828630877472131, -0.2354180977999332, 0.0000000000000000,  0.0000000000000000,  0.0295023943321291,
        -0.1870918729160483, -0.0434562758181022, -0.9999999999999992, -0.1262781641728631, -0.1050973650892559, 0.0000000000000000,
        0.0000000000000000,  0.1680231563924488,  -0.0411402152621511, -0.2054726373437663, -0.0183661675277460, -0.1881859351595428,
        -0.0711721794901836, 0.4995877131608720,  0.4668201757605733,  0.1584260326714147,  0.2427430238094663,  0.1584260326714147,
        0.2427430238094663,  0.0000000000000000,  0.0000000000000000,  -0.1607176634927348, 0.1607176634927348,  0.0000000000000000,
        0.0000000000000000,  -0.1262781641728631, -0.1262781641728631, -0.9999999999999990, -0.5021408928230413, -0.1927471746121099,
        -0.1927471746121099, 0.0000000000000000,  0.0000000000000000,  -0.2355293849427206, 0.0000000000000000,  0.4079488613962401,
        -0.0095418670107523, 0.3935639485884767,  0.9876018205210118,  0.3452622822326464,  0.8931732169920334,  0.3452622822326464,
        0.8931732169920334,  0.0000000000000000,  0.0000000000000000,  -0.1337602828408713, 0.1337602828408713,  0.0000000000000000,
        0.0000000000000000,  -0.1050973650892559, -0.1050973650892559, -0.5021408928230413, -0.9999999999999991, -0.3720632354731387,
        -0.3720632354731387, 0.0000000000000000,  0.0000000000000000,  -0.2303055452343087, 0.0000000000000000,  0.3989009056106749,
        -0.0030973122602807, 0.1551485852674516,  0.3637525206977919,  0.6150444770656970,  0.5410966456047174,  0.0591587481177416,
        0.2360344379464691,  0.1091283809642190,  0.3871282468215228,  -0.0000000000000002, 0.0608387861453430,  0.0857437279004578,
        0.3041721939311966,  0.0000000000000000,  0.0000000000000000,  -0.1927471746121099, -0.3720632354731387, -0.9999999999999992,
        -0.0434562758181022, -0.2545805399885588, 0.1120154375949659,  -0.0559582016964863, -0.2000275671338677, 0.0423694755838100,
        -0.0030973122602807, 0.1551485852674516,  0.3637525206977919,  0.0591587481177416,  0.2360344379464691,  0.6150444770656970,
        0.5410966456047174,  -0.1091283809642190, -0.3871282468215228, -0.0608387861453430, 0.0000000000000002,  0.0857437279004578,
        0.3041721939311966,  0.0000000000000000,  0.0000000000000000,  -0.1927471746121099, -0.3720632354731387, -0.0434562758181022,
        -0.9999999999999992, 0.2545805399885588,  -0.1120154375949659, -0.0559582016964863, -0.2000275671338677, 0.0423694755838100,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1486080648815627,  0.0726828478323673,  -0.1486080648815627,
        -0.0726828478323673, 0.4079488613962403,  0.3989009056106751,  -0.1001956268097828, -0.1001956268097828, 0.0000000000000000,
        0.0000000000000000,  -0.1680231563924488, 0.1680231563924488,  0.0000000000000000,  0.0000000000000000,  -0.2545805399885588,
        0.2545805399885588,  -1.0000000000000013, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1945155339272352, -0.0195000204820850, 0.1945155339272352,
        0.0195000204820850,  0.0000000000000000,  0.0000000000000000,  0.1763443031852177,  0.1763443031852177,  0.0000000000000000,
        0.0000000000000000,  0.0411402152621511,  -0.0411402152621511, 0.0000000000000000,  0.0000000000000000,  0.1120154375949659,
        -0.1120154375949659, 0.0000000000000000,  -1.0000000000000018, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0000000000000001, -0.0167726149682624, -0.0016814406994436, -0.0167726149682624,
        -0.0016814406994436, 0.0000000000000000,  0.0000000000000000,  0.1794358005318928,  -0.1794358005318928, 0.0000000000000000,
        0.0000000000000000,  -0.2054726373437663, -0.2054726373437663, -0.2355293849427206, -0.2303055452343087, -0.0559582016964863,
        -0.0559582016964863, 0.0000000000000000,  0.0000000000000000,  -1.0000000000000009, 0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.1167634795497993,  0.0571079518682885,  0.1167634795497993,
        0.0571079518682885,  0.0000000000000000,  0.0000000000000000,  -0.1680231563924489, 0.1680231563924489,  0.4079488613962403,
        0.3989009056106752,  -0.0183661675277460, -0.0183661675277460, 0.0000000000000000,  0.0000000000000000,  -0.2000275671338677,
        -0.2000275671338677, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000018, 0.0000000000000000,
        -0.0000000000000000, 0.0000000000000000,  0.0000000000000000,  0.1237826124991496,  0.0124091039431450,  0.1237826124991496,
        0.0124091039431450,  0.0000000000000000,  0.0000000000000000,  0.0150711679673227,  -0.0150711679673227, 0.0000000000000000,
        0.0000000000000000,  -0.1881859351595428, -0.1881859351595428, 0.4079488613962401,  0.3989009056106749,  0.0423694755838100,
        0.0423694755838100,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000011};

    CDenseMatrix refxdip(intxvals, nrows, ncols);

    std::vector<double> intyvals{
        -0.9999999999999997, 0.3440165538027237,  0.1578700420051422,  0.0466457325699065,  0.0621233819533135,  0.0536855138253321,
        0.0645376739621323,  -0.0711721794901836, -0.0095418670107523, -0.0706852110744176, 0.0820083750701497,  0.0000000000000000,
        0.0000000000000000,  -0.0531047776396790, -0.0668687543310525, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0000000000000000,
        0.3440165538027237,  -0.9999999999999997, -0.7889407941247983, -0.1544529692966524, -0.3233736015236311, -0.5267942292231884,
        -0.4684744177833932, 0.4995877131608720,  0.3935639485884767,  0.2621732980674780,  -0.4413719536028615, 0.0000000000000000,
        0.0000000000000000,  0.0840908457714494,  0.4686947091123888,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.1578700420051422,  -0.7889407941247983, -1.0000000000000004, -0.0361224443470115, -0.3812798885321001, -1.0047099467344327,
        -1.0116617460533741, 0.4668201757605733,  0.9876018205210116,  0.3478120434486807,  -0.1722533908581265, 0.0000000000000000,
        0.0000000000000000,  -0.0125246606957303, 0.4211475019367931,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0000000000000001, 0.0000000000000000,  0.0000000000000000,
        0.0466457325699065,  -0.1544529692966524, -0.0361224443470115, 0.3999999999999997,  0.2739199298981491,  -0.1315970885344148,
        -0.0504189609080088, 0.0386184812529147,  0.3070165036348682,  0.6150444770656969,  -0.1477470901614856, -0.0941345046859642,
        -0.0300502546125401, 0.0000000000000000,  -0.0000000000000000, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0278042153581572,  -0.0934696534575545, 0.0000000000000000,  -0.0919976240323359,
        0.0621233819533135,  -0.3233736015236311, -0.3812798885321001, 0.2739199298981491,  0.4000000000000000,  -0.5859634756664328,
        -0.6199958401506149, 0.1711154194042236,  0.7188990141535784,  0.5410966456047174,  -0.0911265769676817, -0.0562788320326906,
        -0.1369297308016432, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0401263542311645,  -0.0434277448085148, 0.0000000000000000,  -0.0618763766087428,
        0.0536855138253321,  -0.5267942292231884, -1.0047099467344327, -0.1315970885344148, -0.5859634756664328, -2.3999999999999986,
        -1.6435195793888946, 0.4922758378016771,  1.2885475183233639,  0.1600236547298841,  0.6150444770656960,  -0.2623105611737775,
        -0.7411526854998497, -0.0000000000000000, -0.0000000000000002, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.4168352832126276,  0.0599244235210295,  0.0000000000000000,  0.3395628490306352,
        0.0645376739621323,  -0.4684744177833932, -1.0116617460533741, -0.0504189609080088, -0.6199958401506149, -1.6435195793888946,
        -2.3999999999999990, 0.3368889686670297,  1.3288629668291718,  0.2312576951945558,  0.5410966456047174,  -0.0739718138166569,
        -0.3423276605863232, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0791263951953345,  0.0400648634096277,  0.0000000000000000,  0.0866945844950327,
        -0.0711721794901836, 0.4995877131608720,  0.4668201757605733,  0.0386184812529147,  0.1711154194042236,  0.4922758378016771,
        0.3368889686670297,  -0.9999999999999990, -0.5021408928230413, 0.0267108802944441,  0.3078099029287877,  0.0000000000000000,
        0.0000000000000000,  0.0009438730542339,  -0.5647823024401925, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2355293849427206, 0.0000000000000000,  -0.4079488613962401,
        -0.0095418670107523, 0.3935639485884767,  0.9876018205210116,  0.3070165036348682,  0.7188990141535784,  1.2885475183233639,
        1.3288629668291718,  -0.5021408928230413, -0.9999999999999991, 0.2563011010385483,  -0.4011815048577226, 0.0000000000000000,
        0.0000000000000000,  -0.1146295520317819, -0.5854657476316483, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.2303055452343086, 0.0000000000000000,  -0.3989009056106749,
        -0.0706852110744176, 0.2621732980674780,  0.3478120434486807,  0.6150444770656969,  0.5410966456047174,  0.1600236547298841,
        0.2312576951945558,  0.0267108802944441,  0.2563011010385483,  0.3999999999999990,  0.2291014861130346,  0.2129657651275548,
        0.2946400069886707,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0215837746040128,  0.1464585509035277,  0.0000000000000000,  0.0355443895186084,
        0.0820083750701497,  -0.4413719536028615, -0.1722533908581265, -0.1477470901614856, -0.0911265769676817, 0.6150444770656960,
        0.5410966456047174,  0.3078099029287877,  -0.4011815048577226, 0.2291014861130346,  -2.3999999999999972, -0.3527604103668716,
        -0.1761961886111961, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.3311048317664225,  -0.2124130501602579, 0.0000000000000000,  0.0054020535839629,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0941345046859642, -0.0562788320326906, -0.2623105611737775,
        -0.0739718138166569, 0.0000000000000000,  0.0000000000000000,  0.2129657651275548,  -0.3527604103668716, -0.9999999999999990,
        -0.5021408928230413, 0.0163413784591139,  0.0426634102051442,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0300502546125401, -0.1369297308016432, -0.7411526854998497,
        -0.3423276605863232, 0.0000000000000000,  0.0000000000000000,  0.2946400069886707,  -0.1761961886111961, -0.5021408928230413,
        -0.9999999999999989, 0.0075754358935424,  -0.3817591817256388, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.3989009056106752,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        -0.0531047776396790, 0.0840908457714494,  -0.0125246606957303, 0.0000000000000000,  0.0000000000000000,  -0.0000000000000000,
        0.0000000000000000,  0.0009438730542339,  -0.1146295520317819, 0.0000000000000000,  0.0000000000000000,  0.0163413784591139,
        0.0075754358935424,  0.3999999999999994,  -0.0434562758181022, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0002644728123995, 0.0066002541420138,  0.0000000000000000,  0.0852213449222500,
        -0.0668687543310525, 0.4686947091123888,  0.4211475019367931,  -0.0000000000000000, 0.0000000000000000,  -0.0000000000000002,
        0.0000000000000000,  -0.5647823024401925, -0.5854657476316483, 0.0000000000000000,  0.0000000000000000,  0.0426634102051442,
        -0.3817591817256388, -0.0434562758181022, -2.3999999999999972, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0825449033367018, -0.4175455288295462, 0.0000000000000000,  -0.4615932152413353,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.9999999999999990, -0.5021408928230413, -0.0836187936478908,
        -0.3018755555763289, 0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.5021408928230413, -0.9999999999999989, 0.0150650113483842,
        -0.7591914822946615, 0.3989009056106751,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0836187936478908, 0.0150650113483842,  0.3999999999999994,
        -0.0434562758181022, 0.0016365891856407,  0.0000000000000000,  0.0000000000000000,  -0.0880121295389018, 0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.3018755555763289, -0.7591914822946615, -0.0434562758181022,
        -2.3999999999999972, 0.5107976691627584,  0.0000000000000000,  0.0000000000000000,  -0.3120430047288337, 0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.3989009056106751,  0.0016365891856407,
        0.5107976691627584,  -1.0000000000000013, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0278042153581572,  0.0401263542311645,  0.4168352832126277,
        0.0791263951953345,  0.0000000000000000,  0.0000000000000000,  0.0215837746040128,  0.3311048317664225,  0.4079488613962403,
        0.3989009056106752,  -0.0002644728123995, -0.0825449033367018, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -1.0000000000000018, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0000000000000001, -0.0934696534575545, -0.0434277448085148, 0.0599244235210295,
        0.0400648634096277,  -0.2355293849427206, -0.2303055452343086, 0.1464585509035277,  -0.2124130501602579, 0.0000000000000000,
        0.0000000000000000,  0.0066002541420138,  -0.4175455288295462, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000009, 0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0880121295389018,
        -0.3120430047288337, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000018, 0.0000000000000000,
        -0.0000000000000000, 0.0000000000000000,  0.0000000000000000,  -0.0919976240323359, -0.0618763766087428, 0.3395628490306352,
        0.0866945844950327,  -0.4079488613962401, -0.3989009056106749, 0.0355443895186084,  0.0054020535839629,  0.0000000000000000,
        0.0000000000000000,  0.0852213449222500,  -0.4615932152413353, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000011};

    CDenseMatrix refydip(intyvals, nrows, ncols);

    std::vector<double> intzvals{
        -0.9999999999999997, 0.3440165538027237,  0.1578700420051422,  0.0473999948472735,  0.0623820560971155,  0.0473999948472735,
        0.0623820560971155,  0.0000000000000000,  0.0000000000000000,  -0.0694648047265969, 0.0694648047265969,  -0.0711721794901836,
        -0.0095418670107523, -0.0576768016883212, -0.0576768016883212, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0000000000000000,
        0.3440165538027237,  -0.9999999999999997, -0.7889407941247983, -0.1943466757173527, -0.3389201175514628, -0.1943466757173527,
        -0.3389201175514628, 0.0000000000000000,  0.0000000000000000,  0.1594706941646999,  -0.1594706941646999, 0.4995877131608720,
        0.3935639485884767,  0.2804469878254301,  0.2804469878254301,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.1578700420051422,  -0.7889407941247983, -1.0000000000000004, -0.1398996767456636, -0.4488208018379508, -0.1398996767456636,
        -0.4488208018379508, 0.0000000000000000,  0.0000000000000000,  0.0431966358371419,  -0.0431966358371419, 0.4668201757605733,
        0.9876018205210118,  0.3976927345698320,  0.3976927345698320,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.0000000000000001, 0.0000000000000000,  0.0000000000000000,
        0.0473999948472735,  -0.1943466757173527, -0.1398996767456636, 0.1000000000000000,  0.0684799824745375,  0.0131597088534415,
        0.0318191218287222,  -0.1427406500304745, -0.1352142919005932, -0.0000000000000000, 0.0153885372445685,  0.0462726647903276,
        0.2390224814536089,  0.6150444770656970,  0.0591587481177416,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0370296000322935,  0.1252057052675043,  0.0000000000000000,  0.0710044776313531,
        0.0623820560971155,  -0.3389201175514628, -0.4488208018379508, 0.0684799824745375,  0.1000000000000000,  0.0318191218287222,
        0.0619995840150615,  -0.0740402837394198, -0.2022830114454569, 0.0000000000000000,  0.0161192136081119,  0.1845685151570649,
        0.7342365651420314,  0.5410966456047173,  0.2360344379464691,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0551615881570373,  0.0644317659383599,  0.0000000000000000,  0.0111498925206645,
        0.0473999948472735,  -0.1943466757173527, -0.1398996767456636, 0.0131597088534415,  0.0318191218287222,  0.1000000000000000,
        0.0684799824745375,  0.1427406500304744,  0.1352142919005932,  -0.0153885372445685, 0.0000000000000000,  0.0462726647903276,
        0.2390224814536089,  0.0591587481177416,  0.6150444770656970,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0370296000322935, 0.1252057052675043,  0.0000000000000000,  0.0710044776313531,
        0.0623820560971155,  -0.3389201175514628, -0.4488208018379508, 0.0318191218287222,  0.0619995840150615,  0.0684799824745375,
        0.1000000000000000,  0.0740402837394198,  0.2022830114454569,  -0.0161192136081119, 0.0000000000000000,  0.1845685151570649,
        0.7342365651420314,  0.2360344379464691,  0.5410966456047173,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0551615881570373, 0.0644317659383599,  0.0000000000000000,  0.0111498925206645,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1427406500304745, -0.0740402837394198, 0.1427406500304745,
        0.0740402837394198,  -0.9999999999999990, -0.5021408928230413, 0.0973630689919575,  0.0973630689919575,  0.0000000000000000,
        0.0000000000000000,  0.2697020718741980,  -0.2697020718741980, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1352142919005932, -0.2022830114454569, 0.1352142919005932,
        0.2022830114454569,  -0.5021408928230413, -0.9999999999999989, -0.0132182927208499, -0.0132182927208499, 0.0000000000000000,
        0.0000000000000000,  0.4300854066095238,  -0.4300854066095238, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.3989009056106752,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        -0.0694648047265969, 0.1594706941646999,  0.0431966358371419,  -0.0000000000000000, 0.0000000000000000,  -0.0153885372445685,
        -0.0161192136081119, 0.0973630689919575,  -0.0132182927208499, 0.1000000000000000,  -0.0229101486113035, -0.0001439725827558,
        -0.0908031230528703, -0.0000000000000002, -0.0608387861453430, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0014428170260609, -0.0935323808486820, 0.0000000000000000,  0.0084398540617007,
        0.0694648047265969,  -0.1594706941646999, -0.0431966358371419, 0.0153885372445685,  0.0161192136081119,  0.0000000000000000,
        0.0000000000000000,  0.0973630689919575,  -0.0132182927208499, -0.0229101486113035, 0.1000000000000000,  0.0001439725827558,
        0.0908031230528703,  0.0608387861453430,  0.0000000000000002,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0014428170260609, 0.0935323808486820,  0.0000000000000000,  -0.0084398540617007,
        -0.0711721794901836, 0.4995877131608720,  0.4668201757605733,  0.0462726647903276,  0.1845685151570649,  0.0462726647903276,
        0.1845685151570649,  0.0000000000000000,  0.0000000000000000,  -0.0001439725827558, 0.0001439725827558,  -0.9999999999999990,
        -0.5021408928230413, -0.0213728401262166, -0.0213728401262166, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4710587698854412,  0.0000000000000000,  -0.0000000000000000,
        -0.0095418670107523, 0.3935639485884767,  0.9876018205210118,  0.2390224814536089,  0.7342365651420314,  0.2390224814536089,
        0.7342365651420314,  0.0000000000000000,  0.0000000000000000,  -0.0908031230528703, 0.0908031230528703,  -0.5021408928230413,
        -0.9999999999999991, 0.1649358414191423,  0.1649358414191423,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4606110904686173,  0.0000000000000000,  0.0000000000000000,
        -0.0576768016883212, 0.2804469878254301,  0.3976927345698320,  0.6150444770656970,  0.5410966456047173,  0.0591587481177416,
        0.2360344379464691,  0.2697020718741980,  0.4300854066095238,  -0.0000000000000002, 0.0608387861453430,  -0.0213728401262166,
        0.1649358414191423,  0.1000000000000000,  0.0043456275818102,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0329691982506783, -0.1266132738855176, 0.0000000000000000,  -0.1766666748861404,
        -0.0576768016883212, 0.2804469878254301,  0.3976927345698320,  0.0591587481177416,  0.2360344379464691,  0.6150444770656970,
        0.5410966456047173,  -0.2697020718741980, -0.4300854066095238, -0.0608387861453430, 0.0000000000000002,  -0.0213728401262166,
        0.1649358414191423,  0.0043456275818102,  0.1000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0329691982506783,  -0.1266132738855176, 0.0000000000000000,  -0.1766666748861404,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.9999999999999990, -0.5021408928230413, -0.1070034467116520,
        -0.1070034467116520, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.5021408928230413, -0.9999999999999989, -0.0678910415419420,
        -0.0678910415419420, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.3989009056106751,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1070034467116520, -0.0678910415419420, 0.1000000000000000,
        0.0043456275818102,  -0.1425651023935929, 0.0000000000000000,  0.0000000000000000,  0.0016365891856407,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1070034467116520, -0.0678910415419420, 0.0043456275818102,
        0.1000000000000000,  0.1425651023935929,  0.0000000000000000,  0.0000000000000000,  0.0016365891856407,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -0.1425651023935929,
        0.1425651023935929,  -1.0000000000000013, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0370296000322935,  0.0551615881570373,  -0.0370296000322936,
        -0.0551615881570373, 0.4079488613962403,  0.3989009056106752,  -0.0014428170260609, -0.0014428170260609, 0.0000000000000000,
        0.0000000000000000,  -0.0329691982506783, 0.0329691982506783,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -1.0000000000000018, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  -0.0000000000000001, 0.1252057052675043,  0.0644317659383599,  0.1252057052675043,
        0.0644317659383599,  0.0000000000000000,  0.0000000000000000,  -0.0935323808486820, 0.0935323808486820,  0.4710587698854412,
        0.4606110904686173,  -0.1266132738855176, -0.1266132738855176, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000009, 0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.4079488613962403,  0.3989009056106751,  0.0016365891856407,
        0.0016365891856407,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000018, 0.0000000000000000,
        -0.0000000000000000, 0.0000000000000000,  0.0000000000000000,  0.0710044776313531,  0.0111498925206645,  0.0710044776313531,
        0.0111498925206645,  0.0000000000000000,  0.0000000000000000,  0.0084398540617007,  -0.0084398540617007, -0.0000000000000000,
        0.0000000000000000,  -0.1766666748861404, -0.1766666748861404, 0.0000000000000000,  0.0000000000000000,  0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  -1.0000000000000011};

    CDenseMatrix refzdip(intzvals, nrows, ncols);

    CElectricDipoleMatrix refmat(refxdip, refydip, refzdip, 1.0, 1.0, 1.0);

    ASSERT_EQ(refmat, dipmat);
}
