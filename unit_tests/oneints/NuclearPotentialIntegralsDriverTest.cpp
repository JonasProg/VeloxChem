//
//                     V.E.L.O.X. C.H.E.M. MP
//      ---------------------------------------------------
//           An Electronic Structure Code for Nanoscale
//
//  Created by Zilvinas Rinkevicius (rinkevic@kth.se), KTH, Sweden.
//  Copyright Â© 2018 by Velox Chem MP developers. All rights reserved.

#include "NuclearPotentialIntegralsDriverTest.hpp"

#include "NuclearPotentialIntegralsDriver.hpp"
#include "MoleculeSetter.hpp"
#include "MolecularBasisSetter.hpp"

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeSSForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH(0, 0);

    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);

    std::vector<double> intvals{ 7.736774122879349,  6.549415227007131,  0.855280000184068,
                                 1.949488520360516,  6.549415227007131,  6.001510859920003,
                                 1.170889580069949,  2.179290275400536,  0.855280000184068,
                                 1.170889580069949,  4.797350021933383,  3.463727426618309,
                                 1.949488520360516,  2.179290275400536,  3.463727426618309,
                                 3.665666692150181};

    std::vector<int32_t> rows{0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3};

    std::vector<int32_t> cols{0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3};

    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 4, 4, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeSPForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(0, 1);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);

    std::vector<double> intvals{ 7.736774122879349,  6.549415227007131, -0.774664715309043,
                                -1.589464820573308, -1.420218644733246, -2.914018837717731,
                                -0.516443143539362, -1.059643213715538,  6.549415227007131,
                                 6.001510859920003, -0.809642632993596, -1.540988269659015,
                                -1.484344827154925, -2.825145161041527, -0.539761755329064,
                                -1.027325513106010, -0.774664715309043, -0.809642632993596,
                                 3.907390315716412,  2.469876297996402,  0.152991511314216,
                                 0.155932067578619,  0.055633276841533,  0.056702570028589,
                                -1.589464820573308, -1.540988269659015,  2.469876297996402,
                                 3.000285580452371,  0.155932067578619,  0.304609876553509,
                                 0.056702570028589,  0.110767227837640, -1.420218644733246,
                                -1.484344827154925,  0.152991511314216,  0.155932067578619,
                                 4.104424837863508,  2.670697900180988,  0.101994340876144,
                                 0.103954711719079, -2.914018837717731, -2.825145161041527,
                                 0.155932067578619,  0.304609876553509,  2.670697900180988,
                                 3.392586179044012,  0.103954711719079,  0.203073251035673,
                                -0.516443143539362, -0.539761755329064,  0.055633276841533,
                                 0.056702570028589,  0.101994340876144,  0.103954711719079,
                                 3.861029251681802,  2.422624156305912, -1.059643213715538,
                                -1.027325513106010,  0.056702570028589,  0.110767227837640,
                                 0.103954711719079,  0.203073251035673,  2.422624156305912,
                                 2.907979557254338};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 2,
                              2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,
                              4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6,
                              6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0,
                              1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1,
                              2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2,
                              3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 8, 8, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputePSForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(1, 0);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 4.797350021933383,  3.463727426618309,  0.716688045592732,
                                 0.961285903361370,  1.313928083586676,  1.762357489495846,
                                 0.477792030395155,  0.640857268907580,  3.463727426618309,
                                 3.665666692150181,  0.783057851629905,  0.977433983512970,
                                 1.435606061321493,  1.791962303107112,  0.522038567753270,
                                 0.651622655675314,  0.716688045592732,  0.783057851629905,
                                 5.389681097734912,  4.421159622196003,  0.059837391701642,
                                 0.068258249204655,  0.021759051527870,  0.024821181528965,
                                 0.961285903361370,  0.977433983512970,  4.421159622196003,
                                 4.214690910981703,  0.068258249204655,  0.090090018433681,
                                 0.024821181528965,  0.032760006703157,  1.313928083586676,
                                 1.435606061321493,  0.059837391701642,  0.068258249204655,
                                 5.466744405229450,  4.509067973444423,  0.039891594467762,
                                 0.045505499469770,  1.762357489495846,  1.791962303107112,
                                 0.068258249204655,  0.090090018433681,  4.509067973444423,
                                 4.330715934722049,  0.045505499469770,  0.060060012289120,
                                 0.477792030395155,  0.522038567753270,  0.021759051527870,
                                 0.024821181528965,  0.039891594467762,  0.045505499469770,
                                 5.371548554795020,  4.400475304255199,  0.640857268907580,
                                 0.651622655675314,  0.024821181528965,  0.032760006703157,
                                 0.045505499469770,  0.060060012289120,  4.400475304255199,
                                 4.187390905395738};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 2,
                              2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,
                              4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6,
                              6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0,
                              1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1,
                              2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2,
                              3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 8, 8, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputePPForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(1, 1);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 5.389681097734912,  4.421159622196003,  0.090389933774467,
                                 0.697209517300726,  0.059837391701642,  0.068258249204655,
                                -1.087539794737917, -1.062407626496478,  0.021759051527870,
                                 0.024821181528965, -0.395469016268334, -0.386330045998719,
                                 4.421159622196003,  4.214690910981703,  0.286901921345548,
                                 0.935226972547510,  0.068258249204655,  0.090090018433681,
                                -1.094475238977150, -1.119418015165562,  0.024821181528965,
                                 0.032760006703157, -0.397990995991691, -0.407061096423841,
                                 0.090389933774467,  0.286901921345548,  3.907390315716412,
                                 2.469876297996402, -1.087539794737917, -1.094475238977150,
                                 0.152991511314216,  0.155932067578619, -0.395469016268334,
                                -0.397990995991691,  0.055633276841533,  0.056702570028589,
                                 0.697209517300726,  0.935226972547510,  2.469876297996402,
                                 3.000285580452371, -1.062407626496478, -1.119418015165562,
                                 0.155932067578619,  0.304609876553509, -0.386330045998719,
                                -0.407061096423841,  0.056702570028589,  0.110767227837640,
                                 0.059837391701642,  0.068258249204655, -1.087539794737917,
                                -1.062407626496478,  5.466744405229450,  4.509067973444423,
                                -1.310229498842548, -0.671042728944738,  0.039891594467762,
                                 0.045505499469770, -0.725026529825278, -0.708271750997652,
                                 0.068258249204655,  0.090090018433681, -1.094475238977150,
                                -1.119418015165562,  4.509067973444423,  4.330715934722049,
                                -1.122649522791691, -0.506447743953594,  0.045505499469770,
                                 0.060060012289120, -0.729650159318100, -0.746278676777042,
                                -1.087539794737917, -1.094475238977150,  0.152991511314216,
                                 0.155932067578619, -1.310229498842548, -1.122649522791691,
                                 4.104424837863508,  2.670697900180988, -0.725026529825278,
                                -0.729650159318100,  0.101994340876144,  0.103954711719079,
                                -1.062407626496478, -1.119418015165562,  0.155932067578619,
                                 0.304609876553509, -0.671042728944738, -0.506447743953594,
                                 2.670697900180988,  3.392586179044012, -0.708271750997652,
                                -0.746278676777042,  0.103954711719079,  0.203073251035673,
                                 0.021759051527870,  0.024821181528965, -0.395469016268334,
                                -0.386330045998719,  0.039891594467762,  0.045505499469770,
                                -0.725026529825278, -0.708271750997652,  5.371548554795020,
                                 4.400475304255199,  0.419947447331411,  1.019151222299658,
                                 0.024821181528965,  0.032760006703157, -0.397990995991691,
                                -0.407061096423841,  0.045505499469770,  0.060060012289120,
                                -0.729650159318100, -0.746278676777042,  4.400475304255199,
                                 4.187390905395738,  0.618561084671957,  1.274444552900710,
                                -0.395469016268334, -0.397990995991691,  0.055633276841533,
                                 0.056702570028589, -0.725026529825278, -0.729650159318100,
                                 0.101994340876144,  0.103954711719079,  0.419947447331411,
                                 0.618561084671957,  3.861029251681802,  2.422624156305912,
                                -0.386330045998719, -0.407061096423841,  0.056702570028589,
                                 0.110767227837640, -0.708271750997652, -0.746278676777042,
                                 0.103954711719079,  0.203073251035673,  1.019151222299658,
                                 1.274444552900710,  2.422624156305912,  2.907979557254338};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11};

    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 12, 12, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeSDForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(0, 2);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 7.736774122879349,  6.549415227007131,  0.519832082887633,
                                 0.892787578276054,  1.429538227940991,  2.455165840259148,
                                 1.187995555579791,  2.040327463393719,  0.953025485293994,
                                 1.636777226839432, -0.216596701203180, -0.371994824281689,
                                 6.549415227007131,  6.001510859920003,  0.435076680819680,
                                 0.770277454057193,  1.196460872254120,  2.118262998657282,
                                 0.994300236874595,  1.760349586158707,  0.797640581502747,
                                 1.412175332438188, -0.181281950341533, -0.320948939190497,
                                 0.519832082887633,  0.435076680819680,  3.478214801540742,
                                 1.893711993539113,  0.113845079639040,  0.098457288097802,
                                -0.010398449425070,  0.004397542058047,  0.135796844437519,
                                 0.109803540345022, -0.006358322731098, -0.006887707600306,
                                 0.892787578276054,  0.770277454057193,  1.893711993539113,
                                 2.568625662074751,  0.098457288097802,  0.176831721729404,
                                 0.004397542058047,  0.018338724450592,  0.109803540345022,
                                 0.191254160791963, -0.006887707600306, -0.013453349418572,
                                 1.429538227940991,  1.196460872254120,  0.113845079639040,
                                 0.098457288097802,  3.749890559770268,  2.128666885590687,
                                 0.158154370861165,  0.149787169537950,  0.116143059381084,
                                 0.112249489928672, -0.125305611931207, -0.098438822804517,
                                 2.455165840259148,  2.118262998657282,  0.098457288097802,
                                 0.176831721729404,  2.128666885590687,  2.990610452565374,
                                 0.149787169537950,  0.279165123100005,  0.112249489928672,
                                 0.210807136455715, -0.098438822804517, -0.169056134251319,
                                 1.187995555579791,  0.994300236874595, -0.010398449425070,
                                 0.004397542058047,  0.158154370861165,  0.149787169537950,
                                 3.749582339653307,  2.116088199964572,  0.105436247240776,
                                 0.099858113025300,  0.004332687260446, -0.001832309190852,
                                 2.040327463393719,  1.760349586158707,  0.004397542058047,
                                 0.018338724450592,  0.149787169537950,  0.279165123100005,
                                 2.116088199964572,  2.958418999537411,  0.099858113025300,
                                 0.186110082066670, -0.001832309190853, -0.007641135187747,
                                 0.953025485293994,  0.797640581502747,  0.135796844437519,
                                 0.109803540345022,  0.116143059381084,  0.112249489928672,
                                 0.105436247240776,  0.099858113025300,  3.653104676952698,
                                 2.035125643983459,  0.060223224606778,  0.040370954001891,
                                 1.636777226839432,  1.412175332438188,  0.109803540345022,
                                 0.191254160791963,  0.112249489928672,  0.210807136455715,
                                 0.099858113025300,  0.186110082066670,  2.035125643983459,
                                 2.814937838852278,  0.040370954001891,  0.063375141632784,
                                -0.216596701203180, -0.181281950341533, -0.006358322731098,
                                -0.006887707600306, -0.125305611931207, -0.098438822804517,
                                 0.004332687260446, -0.001832309190853,  0.060223224606778,
                                 0.040370954001891,  3.465604128124063,  1.880051373465174,
                                -0.371994824281689, -0.320948939190497, -0.006887707600306,
                                -0.013453349418572, -0.098438822804517, -0.169056134251319,
                                -0.001832309190852, -0.007641135187747,  0.040370954001891,
                                 0.063375141632784,  1.880051373465174,  2.541943185727918};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 12, 12, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeDSForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(2, 0);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 4.797350021933383,  3.463727426618309,  0.438292441916984,
                                 0.561132101826224,  1.205304215271707,  1.543113280022117,
                                 1.001649359826341,  1.282380339742899,  0.803536143514471,
                                 1.028742186681411, -0.182621850798743, -0.233805042427594,
                                 3.463727426618309,  3.665666692150181,  0.267827379173099,
                                 0.358034235799362,  0.736525292726023,  0.984594148448247,
                                 0.612077912453517,  0.818231684570712,  0.491016861817349,
                                 0.656396098965498, -0.111594741322125, -0.149180931583067,
                                 0.438292441916984,  0.267827379173099,  4.421808648667628,
                                 3.506299950695142,  0.044116585394124,  0.047866613129848,
                                -0.001316915371077,  0.002013659246585,  0.051075823687660,
                                 0.053453670625175, -0.002745282618823, -0.003335681649018,
                                 0.561132101826224,  0.358034235799362,  3.506299950695142,
                                 3.454438074787293,  0.047866613129848,  0.061292674094833,
                                 0.002013659246585,  0.005807780289902,  0.053453670625175,
                                 0.066604724762238, -0.003335681649018, -0.004606233887275,
                                 1.205304215271707,  0.736525292726023,  0.044116585394124,
                                 0.047866613129848,  4.527086863812696,  3.620527095664100,
                                 0.063922540896472,  0.072700727888479,  0.047398494293154,
                                 0.054462355723841, -0.046546107366602, -0.047949795904296,
                                 1.543113280022117,  0.984594148448247,  0.047866613129848,
                                 0.061292674094833,  3.620527095664100,  3.600704683422691,
                                 0.072700727888479,  0.096229946162625,  0.054462355723841,
                                 0.072585355729927, -0.047949795904296, -0.059004438848235,
                                 1.001649359826341,  0.612077912453517, -0.001316915371077,
                                 0.002013659246585,  0.063922540896472,  0.072700727888479,
                                 4.524473246959378,  3.614526031975203,  0.042615027264315,
                                 0.048467151925653,  0.000548714737949, -0.000839024686077,
                                 1.282380339742899,  0.818231684570712,  0.002013659246585,
                                 0.005807780289902,  0.072700727888479,  0.096229946162625,
                                 3.614526031975203,  3.590051139109891,  0.048467151925653,
                                 0.064153297441750, -0.000839024686077, -0.002419908454125,
                                 0.803536143514471,  0.491016861817349,  0.051075823687660,
                                 0.053453670625175,  0.047398494293154,  0.054462355723841,
                                 0.042615027264315,  0.048467151925653,  4.487588118568403,
                                 3.575141799227565,  0.020964701975384,  0.019735697889799,
                                 1.028742186681411,  0.656396098965498,  0.053453670625175,
                                 0.066604724762238,  0.054462355723841,  0.072585355729927,
                                 0.048467151925653,  0.064153297441750,  3.575141799227565,
                                 3.540216886981085,  0.019735697889799,  0.022446768312149,
                                -0.182621850798743, -0.111594741322125, -0.002745282618823,
                                -0.003335681649018, -0.046546107366602, -0.047949795904296,
                                 0.000548714737949, -0.000839024686077,  0.020964701975384,
                                 0.019735697889799,  4.416363838140298,  3.499684182091257,
                                -0.233805042427594, -0.149180931583067, -0.003335681649018,
                                -0.004606233887275, -0.047949795904296, -0.059004438848235,
                                -0.000839024686077, -0.002419908454125,  0.019735697889799,
                                 0.022446768312149,  3.499684182091257,  3.445302377577531};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 12, 12, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputePDForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(1, 2);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 5.389681097734912,  4.421159622196003,  0.059837391701642,
                                 0.068258249204655,  0.021759051527870,  0.024821181528965,
                                -0.039269066424899, -0.365912043357681, -0.107989932668474,
                                -1.006258119233623,  1.184479184876926,  1.269312134986109,
                                 0.669295261674803,  0.554079251226094,  0.454396254263369,
                                 0.876278531670122,  4.421159622196003,  4.214690910981703,
                                 0.068258249204655,  0.090090018433681,  0.024821181528965,
                                 0.032760006703157, -0.118609518833216, -0.424599801578702,
                                -0.326176176791343, -1.167649454341430,  0.999592752257153,
                                 1.237890104912429,  0.521763136210959,  0.506231370650304,
                                 0.486228858738117,  0.936036421388687,  0.059837391701642,
                                 0.068258249204655,  5.466744405229450,  4.509067973444423,
                                 0.039891594467762,  0.045505499469770,  0.669295261674803,
                                 0.554079251226094,  1.234053155870793,  0.521512306650251,
                                 0.245621024457827, -0.855358062381776,  0.822702103913862,
                                 0.347674871100167, -0.278873025697835, -0.230866354677539,
                                 0.068258249204655,  0.090090018433681,  4.509067973444423,
                                 4.330715934722049,  0.045505499469770,  0.060060012289120,
                                 0.521763136210959,  0.506231370650304,  0.830037234884984,
                                 0.341047263660945, -0.087947390100520, -1.068190669537318,
                                 0.553358156589990,  0.227364842440630, -0.217401306754566,
                                -0.210929737770960,  0.021759051527870,  0.024821181528965,
                                 0.039891594467762,  0.045505499469770,  5.371548554795020,
                                 4.400475304255199, -0.363128718580441, -0.800722270139291,
                                 0.669295261674803,  0.554079251226094,  0.789652789917951,
                                 0.846208089990739, -0.665735984064143, -1.467990828588701,
                                -0.505747582137641, -0.752088491181928,  0.024821181528965,
                                 0.032760006703157,  0.045505499469770,  0.060060012289120,
                                 4.400475304255199,  4.187390905395738, -0.415079340163896,
                                -0.867004870845463,  0.521763136210959,  0.506231370650304,
                                 0.666395168171435,  0.825260069941620, -0.760978790300476,
                                -1.589508929883350, -0.482262613768127, -0.777427726577399,
                                -0.039269066424899, -0.118609518833216,  0.669295261674803,
                                 0.521763136210959, -0.363128718580441, -0.415079340163896,
                                 3.478214801540742,  1.893711993539113,  0.113845079639040,
                                 0.098457288097802, -0.010398449425070,  0.004397542058047,
                                 0.135796844437519,  0.109803540345022, -0.006358322731098,
                                -0.006887707600306, -0.365912043357681, -0.424599801578702,
                                 0.554079251226094,  0.506231370650304, -0.800722270139291,
                                -0.867004870845463,  1.893711993539113,  2.568625662074751,
                                 0.098457288097802,  0.176831721729404,  0.004397542058047,
                                 0.018338724450592,  0.109803540345022,  0.191254160791963,
                                -0.006887707600306, -0.013453349418572, -0.107989932668474,
                                -0.326176176791343,  1.234053155870793,  0.830037234884984,
                                 0.669295261674803,  0.521763136210959,  0.113845079639040,
                                 0.098457288097802,  3.749890559770268,  2.128666885590687,
                                 0.158154370861165,  0.149787169537950,  0.116143059381084,
                                 0.112249489928672, -0.125305611931207, -0.098438822804517,
                                -1.006258119233623, -1.167649454341430,  0.521512306650251,
                                 0.341047263660945,  0.554079251226094,  0.506231370650304,
                                 0.098457288097802,  0.176831721729404,  2.128666885590687,
                                 2.990610452565374,  0.149787169537950,  0.279165123100005,
                                 0.112249489928672,  0.210807136455715, -0.098438822804517,
                                -0.169056134251319,  1.184479184876926,  0.999592752257153,
                                 0.245621024457827, -0.087947390100520,  0.789652789917951,
                                 0.666395168171435, -0.010398449425070,  0.004397542058047,
                                 0.158154370861165,  0.149787169537950,  3.749582339653307,
                                 2.116088199964572,  0.105436247240776,  0.099858113025300,
                                 0.004332687260446, -0.001832309190852,  1.269312134986109,
                                 1.237890104912429, -0.855358062381776, -1.068190669537318,
                                 0.846208089990739,  0.825260069941620,  0.004397542058047,
                                 0.018338724450592,  0.149787169537950,  0.279165123100005,
                                 2.116088199964572,  2.958418999537411,  0.099858113025300,
                                 0.186110082066670, -0.001832309190853, -0.007641135187747,
                                 0.669295261674803,  0.521763136210959,  0.822702103913862,
                                 0.553358156589990, -0.665735984064143, -0.760978790300476,
                                 0.135796844437519,  0.109803540345022,  0.116143059381084,
                                 0.112249489928672,  0.105436247240776,  0.099858113025300,
                                 3.653104676952698,  2.035125643983459,  0.060223224606778,
                                 0.040370954001891,  0.554079251226094,  0.506231370650304,
                                 0.347674871100167,  0.227364842440630, -1.467990828588701,
                                -1.589508929883350,  0.109803540345022,  0.191254160791963,
                                 0.112249489928672,  0.210807136455715,  0.099858113025300,
                                 0.186110082066670,  2.035125643983459,  2.814937838852278,
                                 0.040370954001891,  0.063375141632784,  0.454396254263369,
                                 0.486228858738117, -0.278873025697835, -0.217401306754566,
                                -0.505747582137641, -0.482262613768127, -0.006358322731098,
                                -0.006887707600306, -0.125305611931207, -0.098438822804517,
                                 0.004332687260446, -0.001832309190853,  0.060223224606778,
                                 0.040370954001891,  3.465604128124063,  1.880051373465174,
                                 0.876278531670122,  0.936036421388687, -0.230866354677539,
                                -0.210929737770960, -0.752088491181928, -0.777427726577399,
                                -0.006887707600306, -0.013453349418572, -0.098438822804517,
                                -0.169056134251319, -0.001832309190852, -0.007641135187747,
                                 0.040370954001891,  0.063375141632784,  1.880051373465174,
                                 2.541943185727918};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6,
                              7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2,
                              3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15};

    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 16, 16, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeDPForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(2, 1);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.907390315716412,  2.469876297996402,  0.152991511314216,
                                 0.155932067578619,  0.055633276841533,  0.056702570028589,
                                 0.053732256478708,  0.165222660910237,  0.147763705316446,
                                 0.454362317503151, -1.112131754195617, -1.156286927453336,
                                -0.619919801552792, -0.589436667671049, -0.446914631090166,
                                -0.596137476807338,  2.469876297996402,  3.000285580452371,
                                 0.155932067578619,  0.304609876553509,  0.056702570028589,
                                 0.110767227837640,  0.203192151544686,  0.299565425425056,
                                 0.558778416747886,  0.823804919918905, -0.730424306790824,
                                -0.879972486779474, -0.322558217233817, -0.361004522152646,
                                -0.495390810227920, -0.662668992136875,  0.152991511314216,
                                 0.155932067578619,  4.104424837863508,  2.670697900180988,
                                 0.101994340876144,  0.103954711719079, -0.619919801552792,
                                -0.589436667671049, -1.116973959190741, -0.890850480271898,
                                -0.172375081541401,  0.198520636337938, -0.744649306127161,
                                -0.593900320181266,  0.258299917313663,  0.245598611529604,
                                 0.155932067578619,  0.304609876553509,  2.670697900180988,
                                 3.392586179044012,  0.103954711719079,  0.203073251035673,
                                -0.322558217233817, -0.361004522152646, -0.318335601430117,
                                -0.248046961475482,  0.466752209835439,  0.751506345591479,
                                -0.212223734286745, -0.165364640983654,  0.134399257180757,
                                 0.150418550896936,  0.055633276841533,  0.056702570028589,
                                 0.101994340876144,  0.103954711719079,  3.861029251681802,
                                 2.422624156305912,  0.362380112696603,  0.515759749397650,
                                -0.619919801552792, -0.589436667671049, -0.741421169463745,
                                -0.770857951635558,  0.664363539943773,  0.945559540562358,
                                 0.485797572712472,  0.576042156559756,  0.056702570028589,
                                 0.110767227837640,  0.103954711719079,  0.203073251035673,
                                 2.422624156305912,  2.907979557254338,  0.451405598786945,
                                 0.613441102752424, -0.322558217233817, -0.361004522152646,
                                -0.486949537860549, -0.586648324519649,  0.827576931109400,
                                 1.124642021712777,  0.428005454465225,  0.551174637834477,
                                 0.053732256478708,  0.203192151544686, -0.619919801552792,
                                -0.322558217233817,  0.362380112696603,  0.451405598786945,
                                 4.421808648667628,  3.506299950695142,  0.044116585394124,
                                 0.047866613129848, -0.001316915371077,  0.002013659246585,
                                 0.051075823687660,  0.053453670625175, -0.002745282618823,
                                -0.003335681649018,  0.165222660910237,  0.299565425425056,
                                -0.589436667671049, -0.361004522152646,  0.515759749397650,
                                 0.613441102752424,  3.506299950695142,  3.454438074787293,
                                 0.047866613129848,  0.061292674094833,  0.002013659246585,
                                 0.005807780289902,  0.053453670625175,  0.066604724762238,
                                -0.003335681649018, -0.004606233887275,  0.147763705316446,
                                 0.558778416747886, -1.116973959190741, -0.318335601430117,
                                -0.619919801552792, -0.322558217233817,  0.044116585394124,
                                 0.047866613129848,  4.527086863812696,  3.620527095664100,
                                 0.063922540896472,  0.072700727888479,  0.047398494293154,
                                 0.054462355723841, -0.046546107366602, -0.047949795904296,
                                 0.454362317503151,  0.823804919918905, -0.890850480271898,
                                -0.248046961475482, -0.589436667671049, -0.361004522152646,
                                 0.047866613129848,  0.061292674094833,  3.620527095664100,
                                 3.600704683422691,  0.072700727888479,  0.096229946162625,
                                 0.054462355723841,  0.072585355729927, -0.047949795904296,
                                -0.059004438848235, -1.112131754195617, -0.730424306790824,
                                -0.172375081541401,  0.466752209835439, -0.741421169463745,
                                -0.486949537860549, -0.001316915371077,  0.002013659246585,
                                 0.063922540896472,  0.072700727888479,  4.524473246959378,
                                 3.614526031975203,  0.042615027264315,  0.048467151925653,
                                 0.000548714737949, -0.000839024686077, -1.156286927453336,
                                -0.879972486779474,  0.198520636337938,  0.751506345591479,
                                -0.770857951635558, -0.586648324519649,  0.002013659246585,
                                 0.005807780289902,  0.072700727888479,  0.096229946162625,
                                 3.614526031975203,  3.590051139109891,  0.048467151925653,
                                 0.064153297441750, -0.000839024686077, -0.002419908454125,
                                -0.619919801552792, -0.322558217233817, -0.744649306127161,
                                -0.212223734286745,  0.664363539943773,  0.827576931109400,
                                 0.051075823687660,  0.053453670625175,  0.047398494293154,
                                 0.054462355723841,  0.042615027264315,  0.048467151925653,
                                 4.487588118568403,  3.575141799227565,  0.020964701975384,
                                 0.019735697889799, -0.589436667671049, -0.361004522152646,
                                -0.593900320181266, -0.165364640983654,  0.945559540562358,
                                 1.124642021712777,  0.053453670625175,  0.066604724762238,
                                 0.054462355723841,  0.072585355729927,  0.048467151925653,
                                 0.064153297441750,  3.575141799227565,  3.540216886981085,
                                 0.019735697889799,  0.022446768312149, -0.446914631090166,
                                -0.495390810227920,  0.258299917313663,  0.134399257180757,
                                 0.485797572712472,  0.428005454465225, -0.002745282618823,
                                -0.003335681649018, -0.046546107366602, -0.047949795904296,
                                 0.000548714737949, -0.000839024686077,  0.020964701975384,
                                 0.019735697889799,  4.416363838140298,  3.499684182091257,
                                -0.596137476807338, -0.662668992136875,  0.245598611529604,
                                 0.150418550896936,  0.576042156559756,  0.551174637834477,
                                -0.003335681649018, -0.004606233887275, -0.047949795904296,
                                -0.059004438848235, -0.000839024686077, -0.002419908454125,
                                 0.019735697889799,  0.022446768312149,  3.499684182091257,
                                 3.445302377577531};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6,
                              7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2,
                              3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 16, 16, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeDDForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(2, 2);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 4.421808648667628,  3.506299950695142,  0.066142674108319,
                                 0.436419975514195,  0.044116585394124,  0.047866613129848,
                                -0.067731427130434, -0.283924409369267, -0.001316915371077,
                                 0.002013659246585,  0.837284525150745,  0.523835565566178,
                                 0.051075823687660,  0.053453670625175, -0.554879643447441,
                                -0.622692453744409, -0.002745282618823, -0.003335681649018,
                                -0.082415000500325, -0.035782879943729,  3.506299950695142,
                                 3.454438074787293,  0.183841540395159,  0.645399613935919,
                                 0.047866613129848,  0.061292674094833, -0.186645209674165,
                                -0.358804340598495,  0.002013659246585,  0.005807780289902,
                                 0.691691567445462,  0.558758426341339,  0.053453670625175,
                                 0.066604724762238, -0.607475353484824, -0.728030634616388,
                                -0.003335681649018, -0.004606233887275, -0.059546825267923,
                                -0.034513477039754,  0.066142674108319,  0.183841540395159,
                                 3.478214801540742,  1.893711993539113, -0.067731427130434,
                                -0.186645209674165,  0.113845079639040,  0.098457288097802,
                                 0.837284525150745,  0.691691567445462, -0.010398449425070,
                                 0.004397542058047, -0.554879643447441, -0.607475353484824,
                                 0.135796844437519,  0.109803540345022, -0.082415000500325,
                                -0.059546825267923, -0.006358322731098, -0.006887707600306,
                                 0.436419975514195,  0.645399613935919,  1.893711993539113,
                                 2.568625662074751, -0.283924409369267, -0.358804340598494,
                                 0.098457288097802,  0.176831721729404,  0.523835565566178,
                                 0.558758426341338,  0.004397542058047,  0.018338724450592,
                                -0.622692453744409, -0.728030634616388,  0.109803540345022,
                                 0.191254160791963, -0.035782879943729, -0.034513477039754,
                                -0.006887707600306, -0.013453349418572,  0.044116585394124,
                                 0.047866613129848, -0.067731427130434, -0.283924409369267,
                                 4.527086863812696,  3.620527095664100, -0.095489140634761,
                                -0.241126910480648,  0.063922540896472,  0.072700727888479,
                                 0.713366049669415,  0.089310667075767,  0.047398494293154,
                                 0.054462355723841,  0.663583089454348,  0.149286619865730,
                                -0.046546107366602, -0.047949795904296,  0.690864394272978,
                                 0.681734205651562,  0.047866613129848,  0.061292674094833,
                                -0.186645209674165, -0.358804340598494,  3.620527095664100,
                                 3.600704683422691, -0.261561800872734, -0.210838017037761,
                                 0.072700727888479,  0.096229946162625,  0.396165876002178,
                                 0.012571602390134,  0.054462355723841,  0.072585355729927,
                                 0.404341536773256,  0.097653096329639, -0.047949795904296,
                                -0.059004438848235,  0.705727615176897,  0.784977871731982,
                                -0.067731427130434, -0.186645209674165,  0.113845079639040,
                                 0.098457288097802, -0.095489140634761, -0.261561800872734,
                                 3.749890559770268,  2.128666885590687,  0.713366049669415,
                                 0.396165876002179,  0.158154370861165,  0.149787169537950,
                                 0.663583089454348,  0.404341536773256,  0.116143059381084,
                                 0.112249489928672,  0.690864394272978,  0.705727615176897,
                                -0.125305611931207, -0.098438822804517, -0.283924409369267,
                                -0.358804340598495,  0.098457288097802,  0.176831721729404,
                                -0.241126910480648, -0.210838017037761,  2.128666885590687,
                                 2.990610452565374,  0.089310667075768,  0.012571602390134,
                                 0.149787169537950,  0.279165123100005,  0.149286619865730,
                                 0.097653096329639,  0.112249489928672,  0.210807136455715,
                                 0.681734205651561,  0.784977871731982, -0.098438822804517,
                                -0.169056134251319, -0.001316915371077,  0.002013659246585,
                                 0.837284525150745,  0.523835565566178,  0.063922540896472,
                                 0.072700727888479,  0.713366049669415,  0.089310667075768,
                                 4.524473246959378,  3.614526031975203, -0.859473609818857,
                                -0.698163343060088,  0.042615027264315,  0.048467151925653,
                                 0.475577366446277,  0.059540444717178,  0.000548714737949,
                                -0.000839024686077, -0.348868552146144, -0.218264818985907,
                                 0.002013659246585,  0.005807780289902,  0.691691567445462,
                                 0.558758426341338,  0.072700727888479,  0.096229946162625,
                                 0.396165876002179,  0.012571602390134,  3.614526031975203,
                                 3.590051139109891, -0.881369573633583, -0.693493533669878,
                                 0.048467151925653,  0.064153297441750,  0.264110584001453,
                                 0.008381068260089, -0.000839024686077, -0.002419908454125,
                                -0.288204819768943, -0.232816010975558,  0.837284525150745,
                                 0.691691567445462, -0.010398449425070,  0.004397542058047,
                                 0.713366049669415,  0.396165876002178,  0.158154370861165,
                                 0.149787169537950, -0.859473609818857, -0.881369573633583,
                                 3.749582339653307,  2.116088199964572,  0.475577366446277,
                                 0.264110584001453,  0.105436247240776,  0.099858113025300,
                                -0.348868552146144, -0.288204819768943,  0.004332687260446,
                                -0.001832309190852,  0.523835565566178,  0.558758426341339,
                                 0.004397542058047,  0.018338724450592,  0.089310667075767,
                                 0.012571602390134,  0.149787169537950,  0.279165123100005,
                                -0.698163343060088, -0.693493533669878,  2.116088199964572,
                                 2.958418999537411,  0.059540444717178,  0.008381068260089,
                                 0.099858113025300,  0.186110082066670, -0.218264818985907,
                                -0.232816010975558, -0.001832309190853, -0.007641135187747,
                                 0.051075823687660,  0.053453670625175, -0.554879643447441,
                                -0.622692453744409,  0.047398494293154,  0.054462355723841,
                                 0.663583089454348,  0.149286619865730,  0.042615027264315,
                                 0.048467151925653,  0.475577366446277,  0.059540444717178,
                                 4.487588118568403,  3.575141799227565, -0.648475048513384,
                                -0.365532427035423,  0.020964701975384,  0.019735697889799,
                                -0.762764598016511, -0.585693363561380,  0.053453670625175,
                                 0.066604724762238, -0.607475353484824, -0.728030634616388,
                                 0.054462355723841,  0.072585355729927,  0.404341536773256,
                                 0.097653096329639,  0.048467151925653,  0.064153297441750,
                                 0.264110584001453,  0.008381068260089,  3.575141799227565,
                                 3.540216886981085, -0.598513081517114, -0.292215597312460,
                                 0.019735697889799,  0.022446768312149, -0.688823436100316,
                                -0.649867996967086, -0.554879643447441, -0.607475353484824,
                                 0.135796844437519,  0.109803540345022,  0.663583089454348,
                                 0.404341536773256,  0.116143059381084,  0.112249489928672,
                                 0.475577366446277,  0.264110584001453,  0.105436247240776,
                                 0.099858113025300, -0.648475048513384, -0.598513081517114,
                                 3.653104676952698,  2.035125643983459, -0.762764598016511,
                                -0.688823436100316,  0.060223224606778,  0.040370954001891,
                                -0.622692453744409, -0.728030634616388,  0.109803540345022,
                                 0.191254160791963,  0.149286619865730,  0.097653096329639,
                                 0.112249489928672,  0.210807136455715,  0.059540444717178,
                                 0.008381068260089,  0.099858113025300,  0.186110082066670,
                                -0.365532427035423, -0.292215597312460,  2.035125643983459,
                                 2.814937838852278, -0.585693363561380, -0.649867996967086,
                                 0.040370954001891,  0.063375141632784, -0.002745282618823,
                                -0.003335681649018, -0.082415000500325, -0.035782879943729,
                                -0.046546107366602, -0.047949795904296,  0.690864394272978,
                                 0.681734205651561,  0.000548714737949, -0.000839024686077,
                                -0.348868552146144, -0.218264818985907,  0.020964701975384,
                                 0.019735697889799, -0.762764598016511, -0.585693363561380,
                                 4.416363838140298,  3.499684182091257, -0.097313743550659,
                                 0.365450596959133, -0.003335681649018, -0.004606233887275,
                                -0.059546825267923, -0.034513477039754, -0.047949795904296,
                                -0.059004438848235,  0.705727615176897,  0.784977871731982,
                                -0.000839024686077, -0.002419908454125, -0.288204819768943,
                                -0.232816010975558,  0.019735697889799,  0.022446768312149,
                                -0.688823436100316, -0.649867996967086,  3.499684182091257,
                                 3.445302377577531,  0.065740336947112,  0.576947884473741,
                                -0.082415000500325, -0.059546825267923, -0.006358322731098,
                                -0.006887707600306,  0.690864394272978,  0.705727615176897,
                                -0.125305611931207, -0.098438822804517, -0.348868552146144,
                                -0.288204819768943,  0.004332687260446, -0.001832309190853,
                                -0.762764598016511, -0.688823436100316,  0.060223224606778,
                                 0.040370954001891, -0.097313743550659,  0.065740336947112,
                                 3.465604128124063,  1.880051373465174, -0.035782879943729,
                                -0.034513477039754, -0.006887707600306, -0.013453349418572,
                                 0.681734205651562,  0.784977871731982, -0.098438822804517,
                                -0.169056134251319, -0.218264818985907, -0.232816010975558,
                                -0.001832309190852, -0.007641135187747, -0.585693363561380,
                                -0.649867996967086,  0.040370954001891,  0.063375141632784,
                                 0.365450596959133,  0.576947884473741,  1.880051373465174,
                                 2.541943185727918};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19};

    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 20, 20, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeSFForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(0, 3);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 7.736774122879349,  6.549415227007131, -0.057956006178184,
                                -0.078507074765919, -1.041059379551694, -1.410216678750225,
                                -1.616131056533765, -2.189207470520627, -0.481600673596999,
                                -0.652375182188258, -1.077420704355843, -1.459471647013751,
                                 0.433774741479873,  0.587590282812593,  0.296219587132940,
                                 0.401258382136920,  6.549415227007131,  6.001510859920003,
                                -0.040903224433351, -0.061369150577214, -0.734741543772515,
                                -1.102369435656144, -1.140606050663185, -1.711308226726399,
                                -0.339896099445278, -0.509963094509904, -0.760404033775457,
                                -1.140872151150932,  0.306142309905215,  0.459320598190060,
                                 0.209060924881573,  0.313664547394648, -0.057956006178184,
                                -0.040903224433351,  3.202114389066253,  1.498507930212499,
                                 0.087511576187288,  0.053669164220241,  0.001941158133635,
                                 0.001118525640133, -0.003589663796302, -0.002233902239870,
                                 0.005729793284020,  0.007684076611919,  0.125730541821356,
                                 0.075374800777164, -0.000821963019536, -0.000761412092355,
                                -0.078507074765919, -0.061369150577214,  1.498507930212499,
                                 2.278401667003069,  0.053669164220241,  0.085909795209512,
                                 0.001118525640133,  0.001602704487722, -0.002233902239870,
                                -0.003636511406393,  0.007684076611919,  0.011625036476239,
                                 0.075374800777164,  0.121122204922951, -0.000761412092355,
                                -0.001149402707479, -1.041059379551694, -0.734741543772515,
                                 0.087511576187288,  0.053669164220241,  3.447397372239345,
                                 1.667595787800838,  0.184417039427437,  0.141122982779134,
                                -0.057538044976563, -0.029267324742193,  0.198549715295908,
                                 0.141785349958338, -0.024768165949220, -0.022246402142357,
                                -0.141699058769991, -0.090166977082764, -1.410216678750225,
                                -1.102369435656144,  0.053669164220241,  0.085909795209512,
                                 1.667595787800838,  2.544656848838963,  0.141122982779134,
                                 0.218879961491351, -0.029267324742194, -0.048799058880514,
                                 0.141785349958338,  0.222215216209289, -0.022246402142357,
                                -0.033751276068106, -0.090166977082764, -0.143451988841386,
                                -1.616131056533765, -1.140606050663185,  0.001941158133635,
                                 0.001118525640133,  0.184417039427437,  0.141122982779134,
                                 3.649959487299250,  1.815494951635113,  0.122804047405404,
                                 0.089618123628917,  0.167742046329345,  0.132070894515547,
                                -0.175126962142334, -0.120815612695229, -0.020785695899594,
                                -0.022710943493426, -2.189207470520627, -1.711308226726399,
                                 0.001118525640133,  0.001602704487722,  0.141122982779134,
                                 0.218879961491351,  1.815494951635113,  2.775314355284775,
                                 0.089618123628917,  0.140085311011584,  0.132070894515547,
                                 0.204084991101359, -0.120815612695229, -0.190383798400968,
                                -0.022710943493426, -0.034047539732430, -0.481600673596999,
                                -0.339896099445278, -0.003589663796302, -0.002233902239870,
                                -0.057538044976563, -0.029267324742194,  0.122804047405404,
                                 0.089618123628917,  3.530495447921870,  1.704930068725853,
                                 0.081869364936936,  0.059745415752611,  0.023974185406902,
                                 0.012194718642580,  0.018347170514432,  0.011417722559337,
                                -0.652375182188258, -0.509963094509904, -0.002233902239870,
                                -0.003636511406393, -0.029267324742193, -0.048799058880514,
                                 0.089618123628917,  0.140085311011584,  1.704930068725853,
                                 2.608159076469363,  0.059745415752611,  0.093390207341056,
                                 0.012194718642580,  0.020332941200214,  0.011417722559337,
                                 0.018586613854896, -1.077420704355843, -0.760404033775457,
                                 0.005729793284020,  0.007684076611919,  0.198549715295908,
                                 0.141785349958338,  0.167742046329345,  0.132070894515547,
                                 0.081869364936936,  0.059745415752611,  3.510174448691463,
                                 1.705435872872156,  0.064700745531391,  0.033944325656577,
                                -0.012989278626807, -0.013783117350694, -1.459471647013751,
                                -1.140872151150932,  0.007684076611919,  0.011625036476239,
                                 0.141785349958338,  0.222215216209289,  0.132070894515547,
                                 0.204084991101359,  0.059745415752611,  0.093390207341056,
                                 1.705435872872156,  2.605243529366976,  0.033944325656577,
                                 0.056186048248821, -0.013783117350694, -0.020632944574667,
                                 0.433774741479873,  0.306142309905215,  0.125730541821356,
                                 0.075374800777164, -0.024768165949220, -0.022246402142357,
                                -0.175126962142334, -0.120815612695229,  0.023974185406902,
                                 0.012194718642580,  0.064700745531391,  0.033944325656577,
                                 3.398273843106729,  1.623473756885164,  0.090774824206942,
                                 0.056692021019711,  0.587590282812593,  0.459320598190060,
                                 0.075374800777164,  0.121122204922951, -0.022246402142357,
                                -0.033751276068106, -0.120815612695229, -0.190383798400968,
                                 0.012194718642580,  0.020332941200214,  0.033944325656577,
                                 0.056186048248821,  1.623473756885164,  2.477716817970552,
                                 0.056692021019711,  0.090473000633380,  0.296219587132940,
                                 0.209060924881573, -0.000821963019536, -0.000761412092355,
                                -0.141699058769991, -0.090166977082764, -0.020785695899594,
                                -0.022710943493426,  0.018347170514432,  0.011417722559337,
                                -0.012989278626807, -0.013783117350694,  0.090774824206942,
                                 0.056692021019711,  3.206154714536678,  1.502250620086754,
                                 0.401258382136920,  0.313664547394648, -0.000761412092355,
                                -0.001149402707479, -0.090166977082764, -0.143451988841386,
                                -0.022710943493426, -0.034047539732430,  0.011417722559337,
                                 0.018586613854896, -0.013783117350694, -0.020632944574667,
                                 0.056692021019711,  0.090473000633380,  1.502250620086754,
                                 2.284051508813985};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6,
                              7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2,
                              3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15};

    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 16, 16, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeFSForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(3, 0);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 4.797350021933383,  3.463727426618309,  0.043678820424515,
                                 0.052270364417627,  0.784599365782599,  0.938928624278447,
                                 1.218004877420146,  1.457584206405559,  0.362960644211664,
                                 0.434354338276772,  0.812003251613431,  0.971722804270373,
                                -0.326916402409416, -0.391220260116019, -0.223247304391966,
                                -0.267159640356759,  3.463727426618309,  3.665666692150181,
                                 0.017421943036592,  0.023421388678948,  0.312949052294881,
                                 0.420716643092687,  0.485819245722911,  0.653116667750037,
                                 0.144772216981186,  0.194626188175893,  0.323879497148607,
                                 0.435411111833358, -0.130395438456200, -0.175298601288619,
                                -0.089045486631468, -0.119709319914623,  0.043678820424515,
                                 0.017421943036592,  3.856368291421526,  2.956118688354651,
                                 0.031098228475630,  0.029118300052022,  0.000667006083549,
                                 0.000604990800414, -0.001285274849412, -0.001212429829315,
                                 0.003053217697576,  0.004075161603475,  0.044261951379235,
                                 0.040937008744552, -0.000354120703374, -0.000406829268913,
                                 0.052270364417627,  0.023421388678948,  2.956118688354651,
                                 3.002946777845089,  0.029118300052022,  0.033923227925973,
                                 0.000604990800414,  0.000696810175471, -0.001212429829315,
                                -0.001416677385472,  0.004075161603475,  0.005485673636577,
                                 0.040937008744552,  0.047380987883265, -0.000406829268913,
                                -0.000520160875585,  0.784599365782599,  0.312949052294881,
                                 0.031098228475630,  0.029118300052022,  3.948047001235177,
                                 3.047413386676495,  0.072304030065319,  0.075892441232213,
                                -0.019004352350503, -0.016031566759634,  0.075399686736140,
                                 0.076449078973143, -0.010503810771218, -0.011898484222150,
                                -0.051141558270653, -0.048840600416474,  0.938928624278447,
                                 0.420716643092687,  0.029118300052022,  0.033923227925973,
                                 3.047413386676495,  3.112641907817842,  0.075892441232213,
                                 0.093434351901512, -0.016031566759634, -0.017588503804400,
                                 0.076449078973143,  0.092642892970634, -0.011898484222150,
                                -0.015127792115902, -0.048840600416474, -0.057486305957660,
                                 1.218004877420146,  0.485819245722911,  0.000667006083549,
                                 0.000604990800414,  0.072304030065319,  0.075892441232213,
                                 4.025743657955895,  3.127084149876759,  0.047100903903013,
                                 0.048282128187159,  0.066661774657982,  0.070952776536786,
                                -0.065482779227589, -0.065232204110590, -0.009798192042638,
                                -0.012085508740386,  1.457584206405559,  0.653116667750037,
                                 0.000604990800414,  0.000696810175471,  0.075892441232213,
                                 0.093434351901512,  3.127084149876759,  3.209702482925850,
                                 0.048282128187159,  0.058806050008381,  0.070952776536786,
                                 0.087890141053622, -0.065232204110590, -0.078390302506144,
                                -0.012085508740386, -0.015859612850645,  0.362960644211664,
                                 0.144772216981186, -0.001285274849412, -0.001212429829315,
                                -0.019004352350503, -0.016031566759634,  0.047100903903013,
                                 0.048282128187159,  3.974293440465643,  3.068002687773665,
                                 0.031400602602008,  0.032188085458106,  0.007918480146044,
                                 0.006679819483181,  0.006569182563660,  0.006196863572054,
                                 0.434354338276772,  0.194626188175893, -0.001212429829315,
                                -0.001416677385472, -0.016031566759634, -0.017588503804400,
                                 0.048282128187159,  0.058806050008381,  3.068002687773665,
                                 3.134180406469717,  0.032188085458106,  0.039204033338920,
                                 0.006679819483181,  0.007328543251833,  0.006196863572054,
                                 0.007240795525744,  0.812003251613431,  0.323879497148607,
                                 0.003053217697576,  0.004075161603475,  0.075399686736140,
                                 0.076449078973143,  0.066661774657982,  0.070952776536786,
                                 0.031400602602008,  0.032188085458106,  3.970192179074243,
                                 3.067956836096106,  0.021617613910500,  0.018561747490275,
                                -0.006021760141972, -0.007338603443690,  0.971722804270373,
                                 0.435411111833358,  0.004075161603475,  0.005485673636577,
                                 0.076449078973143,  0.092642892970634,  0.070952776536786,
                                 0.087890141053622,  0.032188085458106,  0.039204033338920,
                                 3.067956836096106,  3.136460698714497,  0.018561747490275,
                                 0.020587778416340, -0.007338603443689, -0.009590679545146,
                                -0.326916402409416, -0.130395438456200,  0.044261951379235,
                                 0.040937008744552, -0.010503810771218, -0.011898484222150,
                                -0.065482779227589, -0.065232204110590,  0.007918480146044,
                                 0.006679819483181,  0.021617613910500,  0.018561747490275,
                                 3.927214443205593,  3.023814726302565,  0.032504111290962,
                                 0.030733439388662, -0.391220260116019, -0.175298601288619,
                                 0.040937008744552,  0.047380987883265, -0.011898484222150,
                                -0.015127792115902, -0.065232204110590, -0.078390302506144,
                                 0.006679819483181,  0.007328543251833,  0.018561747490275,
                                 0.020587778416340,  3.023814726302565,  3.082638453454637,
                                 0.030733439388662,  0.035988301301310, -0.223247304391966,
                                -0.089045486631468, -0.000354120703374, -0.000406829268913,
                                -0.051141558270653, -0.048840600416474, -0.009798192042638,
                                -0.012085508740386,  0.006569182563660,  0.006196863572054,
                                -0.006021760141972, -0.007338603443689,  0.032504111290962,
                                 0.030733439388662,  3.858108957197775,  2.958118440920442,
                                -0.267159640356759, -0.119709319914623, -0.000406829268913,
                                -0.000520160875585, -0.048840600416474, -0.057486305957660,
                                -0.012085508740386, -0.015859612850645,  0.006196863572054,
                                 0.007240795525744, -0.007338603443690, -0.009590679545146,
                                 0.030733439388662,  0.035988301301310,  2.958118440920442,
                                 3.005503607269763};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5, 6,
                              7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1, 2,
                              3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 16, 16, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputePFForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(1, 3);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 5.389681097734912,  4.421159622196003,  0.059837391701642,
                                 0.068258249204655,  0.021759051527870,  0.024821181528965,
                                -0.232348363297015, -0.298246881178766,  0.038823802133755,
                                 0.536615221150720, -0.121380711823174,  0.578875614794904,
                                -1.122569762429578, -1.347560628366781, -0.807522182830570,
                                -0.630726704340153, -0.776763246355208, -1.287784393241105,
                                -0.280298665740275, -0.529417511829048,  4.421159622196003,
                                 4.214690910981703,  0.068258249204655,  0.090090018433681,
                                 0.024821181528965,  0.032760006703157, -0.175493126173823,
                                -0.270380849098194,  0.135010250206369,  0.542539419894654,
                                 0.067830378548896,  0.609401759251971, -0.827602295638263,
                                -1.210898537236897, -0.521812942476761, -0.525058051267279,
                                -0.649809006709523, -1.200944391150766, -0.248537016663913,
                                -0.499487491515759,  0.059837391701642,  0.068258249204655,
                                 5.466744405229450,  4.509067973444423,  0.039891594467762,
                                 0.045505499469770, -0.067693301802475, -0.045490940081359,
                                -0.833016963425489, -0.281332015439146, -0.555557087971638,
                                 0.595310227558532,  0.611660582833231,  1.264859951285956,
                                -0.370371391981092,  0.396873485039022,  0.347090401427287,
                                 0.117221673099644,  0.345987986990424,  0.232509249304721,
                                 0.068258249204655,  0.090090018433681,  4.509067973444423,
                                 4.330715934722049,  0.045505499469770,  0.060060012289120,
                                -0.042140044697171, -0.036472455832522, -0.458105719034252,
                                -0.164300137557416, -0.135534520296590,  0.690378858693007,
                                 0.566142116540306,  1.201929173338134, -0.090356346864394,
                                 0.460252572462005,  0.190877382930938,  0.068458390648923,
                                 0.215382450674433,  0.186414774255109,  0.021759051527870,
                                 0.024821181528965,  0.039891594467762,  0.045505499469770,
                                 5.371548554795020,  4.400475304255199,  0.444403639806880,
                                 0.639698578692948,  0.610949197934921,  1.176354802122253,
                                -0.807522182830570, -0.630726704340153, -0.748379841619719,
                                -0.898373752244520,  0.551554440535634,  1.104481201745031,
                                 0.886317827392997,  1.106144242424851, -0.069610930680966,
                                -0.188884823205399,  0.024821181528965,  0.032760006703157,
                                 0.045505499469770,  0.060060012289120,  4.400475304255199,
                                 4.187390905395738,  0.350694700778268,  0.587905566261265,
                                 0.546587399463376,  1.111605484694892, -0.521812942476761,
                                -0.525058051267279, -0.551734863758842, -0.807265691491265,
                                 0.502674497279530,  1.046950135308037,  0.662587353908897,
                                 0.999160497335785, -0.074186756093753, -0.182699591642233,
                                -0.232348363297015, -0.175493126173823, -0.067693301802475,
                                -0.042140044697171,  0.444403639806880,  0.350694700778268,
                                 3.202114389066253,  1.498507930212499,  0.087511576187288,
                                 0.053669164220241,  0.001941158133635,  0.001118525640133,
                                -0.003589663796302, -0.002233902239870,  0.005729793284020,
                                 0.007684076611919,  0.125730541821356,  0.075374800777164,
                                -0.000821963019536, -0.000761412092355, -0.298246881178766,
                                -0.270380849098194, -0.045490940081359, -0.036472455832522,
                                 0.639698578692948,  0.587905566261265,  1.498507930212499,
                                 2.278401667003069,  0.053669164220241,  0.085909795209512,
                                 0.001118525640133,  0.001602704487722, -0.002233902239870,
                                -0.003636511406393,  0.007684076611919,  0.011625036476239,
                                 0.075374800777164,  0.121122204922951, -0.000761412092355,
                                -0.001149402707479,  0.038823802133755,  0.135010250206369,
                                -0.833016963425489, -0.458105719034252,  0.610949197934921,
                                 0.546587399463376,  0.087511576187288,  0.053669164220241,
                                 3.447397372239345,  1.667595787800838,  0.184417039427437,
                                 0.141122982779134, -0.057538044976563, -0.029267324742193,
                                 0.198549715295908,  0.141785349958338, -0.024768165949220,
                                -0.022246402142357, -0.141699058769991, -0.090166977082764,
                                 0.536615221150720,  0.542539419894654, -0.281332015439146,
                                -0.164300137557416,  1.176354802122253,  1.111605484694892,
                                 0.053669164220241,  0.085909795209512,  1.667595787800838,
                                 2.544656848838963,  0.141122982779134,  0.218879961491351,
                                -0.029267324742194, -0.048799058880514,  0.141785349958338,
                                 0.222215216209289, -0.022246402142357, -0.033751276068106,
                                -0.090166977082764, -0.143451988841386, -0.121380711823174,
                                 0.067830378548896, -0.555557087971638, -0.135534520296590,
                                -0.807522182830570, -0.521812942476761,  0.001941158133635,
                                 0.001118525640133,  0.184417039427437,  0.141122982779134,
                                 3.649959487299250,  1.815494951635113,  0.122804047405404,
                                 0.089618123628917,  0.167742046329345,  0.132070894515547,
                                -0.175126962142334, -0.120815612695229, -0.020785695899594,
                                -0.022710943493426,  0.578875614794904,  0.609401759251971,
                                 0.595310227558532,  0.690378858693007, -0.630726704340153,
                                -0.525058051267279,  0.001118525640133,  0.001602704487722,
                                 0.141122982779134,  0.218879961491351,  1.815494951635113,
                                 2.775314355284775,  0.089618123628917,  0.140085311011584,
                                 0.132070894515547,  0.204084991101359, -0.120815612695229,
                                -0.190383798400968, -0.022710943493426, -0.034047539732430,
                                -1.122569762429578, -0.827602295638263,  0.611660582833231,
                                 0.566142116540306, -0.748379841619719, -0.551734863758842,
                                -0.003589663796302, -0.002233902239870, -0.057538044976563,
                                -0.029267324742194,  0.122804047405404,  0.089618123628917,
                                 3.530495447921870,  1.704930068725853,  0.081869364936936,
                                 0.059745415752611,  0.023974185406902,  0.012194718642580,
                                 0.018347170514432,  0.011417722559337, -1.347560628366781,
                                -1.210898537236897,  1.264859951285956,  1.201929173338134,
                                -0.898373752244520, -0.807265691491265, -0.002233902239870,
                                -0.003636511406393, -0.029267324742193, -0.048799058880514,
                                 0.089618123628917,  0.140085311011584,  1.704930068725853,
                                 2.608159076469363,  0.059745415752611,  0.093390207341056,
                                 0.012194718642580,  0.020332941200214,  0.011417722559337,
                                 0.018586613854896, -0.807522182830570, -0.521812942476761,
                                -0.370371391981092, -0.090356346864394,  0.551554440535634,
                                 0.502674497279530,  0.005729793284020,  0.007684076611919,
                                 0.198549715295908,  0.141785349958338,  0.167742046329345,
                                 0.132070894515547,  0.081869364936936,  0.059745415752611,
                                 3.510174448691463,  1.705435872872156,  0.064700745531391,
                                 0.033944325656577, -0.012989278626807, -0.013783117350694,
                                -0.630726704340153, -0.525058051267279,  0.396873485039022,
                                 0.460252572462005,  1.104481201745031,  1.046950135308037,
                                 0.007684076611919,  0.011625036476239,  0.141785349958338,
                                 0.222215216209289,  0.132070894515547,  0.204084991101359,
                                 0.059745415752611,  0.093390207341056,  1.705435872872156,
                                 2.605243529366976,  0.033944325656577,  0.056186048248821,
                                -0.013783117350694, -0.020632944574667, -0.776763246355208,
                                -0.649809006709523,  0.347090401427287,  0.190877382930938,
                                 0.886317827392997,  0.662587353908897,  0.125730541821356,
                                 0.075374800777164, -0.024768165949220, -0.022246402142357,
                                -0.175126962142334, -0.120815612695229,  0.023974185406902,
                                 0.012194718642580,  0.064700745531391,  0.033944325656577,
                                 3.398273843106729,  1.623473756885164,  0.090774824206942,
                                 0.056692021019711, -1.287784393241105, -1.200944391150766,
                                 0.117221673099644,  0.068458390648923,  1.106144242424851,
                                 0.999160497335785,  0.075374800777164,  0.121122204922951,
                                -0.022246402142357, -0.033751276068106, -0.120815612695229,
                                -0.190383798400968,  0.012194718642580,  0.020332941200214,
                                 0.033944325656577,  0.056186048248821,  1.623473756885164,
                                 2.477716817970552,  0.056692021019711,  0.090473000633380,
                                -0.280298665740275, -0.248537016663913,  0.345987986990424,
                                 0.215382450674433, -0.069610930680966, -0.074186756093753,
                                -0.000821963019536, -0.000761412092355, -0.141699058769991,
                                -0.090166977082764, -0.020785695899594, -0.022710943493426,
                                 0.018347170514432,  0.011417722559337, -0.012989278626807,
                                -0.013783117350694,  0.090774824206942,  0.056692021019711,
                                 3.206154714536678,  1.502250620086754, -0.529417511829048,
                                -0.499487491515759,  0.232509249304721,  0.186414774255109,
                                -0.188884823205399, -0.182699591642233, -0.000761412092355,
                                -0.001149402707479, -0.090166977082764, -0.143451988841386,
                                -0.022710943493426, -0.034047539732430,  0.011417722559337,
                                 0.018586613854896, -0.013783117350694, -0.020632944574667,
                                 0.056692021019711,  0.090473000633380,  1.502250620086754,
                                 2.284051508813985};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 20, 20, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeFPForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(3, 1);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.907390315716412,  2.469876297996402,  0.152991511314216,
                                 0.155932067578619,  0.055633276841533,  0.056702570028589,
                                -0.211553798903225, -0.239975795862148,  0.084586439635007,
                                 0.263828600759257, -0.036205186708769,  0.212303845467154,
                                -1.012656265132826, -1.116496973241504, -0.694202398126696,
                                -0.647509145731536, -0.736650577798849, -0.935879208960114,
                                -0.272369615195874, -0.367459988926520,  2.469876297996402,
                                 3.000285580452371,  0.155932067578619,  0.304609876553509,
                                 0.056702570028589,  0.110767227837640, -0.105836805412474,
                                -0.143959293068280,  0.174741245447228,  0.282502684216266,
                                 0.181750687420318,  0.314862121808604, -0.481208518937358,
                                -0.645941246964678, -0.236896968518736, -0.284861761402531,
                                -0.447620486449054, -0.635620900111723, -0.182405679054002,
                                -0.263725884644979,  0.152991511314216,  0.155932067578619,
                                 4.104424837863508,  2.670697900180988,  0.101994340876144,
                                 0.103954711719079, -0.057447215766801, -0.050886859450495,
                                -0.678764432359070, -0.498213576715992, -0.373489578835355,
                                 0.027578072114531,  0.605441760884711,  0.852225490457338,
                                -0.248993052556904,  0.018385381409687,  0.282818513482945,
                                 0.207588990298330,  0.293619102808096,  0.260088392746976,
                                 0.155932067578619,  0.304609876553509,  2.670697900180988,
                                 3.392586179044012,  0.103954711719079,  0.203073251035673,
                                -0.017476979141168, -0.019960220545292, -0.125221314422463,
                                -0.097777336887945,  0.169096884098845,  0.350477712120319,
                                 0.433395868252647,  0.633674862325853,  0.112731256065896,
                                 0.233651808080213,  0.052175547676026,  0.040740557036644,
                                 0.089326782277079,  0.102018905009269,  0.055633276841533,
                                 0.056702570028589,  0.101994340876144,  0.103954711719079,
                                 3.861029251681802,  2.422624156305912,  0.411635592812363,
                                 0.490822072442872,  0.595934212026617,  0.811232368693677,
                                -0.694202398126696, -0.647509145731536, -0.675104176755217,
                                -0.744331315494336,  0.542296811730144,  0.751894800243434,
                                 0.803803420248637,  0.900912451009937, -0.073448371100207,
                                -0.117641729708432,  0.056702570028589,  0.110767227837640,
                                 0.103954711719079,  0.203073251035673,  2.422624156305912,
                                 2.907979557254338,  0.224774113335621,  0.312114298088111,
                                 0.404810805307928,  0.586728544622340, -0.236896968518736,
                                -0.284861761402531, -0.320805679291572, -0.430627497976452,
                                 0.379164827852598,  0.552246922977380,  0.393546282390760,
                                 0.532396945606442, -0.063821441416536, -0.095974116403841,
                                -0.211553798903225, -0.105836805412474, -0.057447215766801,
                                -0.017476979141168,  0.411635592812363,  0.224774113335621,
                                 3.856368291421526,  2.956118688354651,  0.031098228475630,
                                 0.029118300052022,  0.000667006083549,  0.000604990800414,
                                -0.001285274849412, -0.001212429829315,  0.003053217697576,
                                 0.004075161603475,  0.044261951379235,  0.040937008744552,
                                -0.000354120703374, -0.000406829268913, -0.239975795862148,
                                -0.143959293068280, -0.050886859450495, -0.019960220545292,
                                 0.490822072442872,  0.312114298088111,  2.956118688354651,
                                 3.002946777845089,  0.029118300052022,  0.033923227925973,
                                 0.000604990800414,  0.000696810175471, -0.001212429829315,
                                -0.001416677385472,  0.004075161603475,  0.005485673636577,
                                 0.040937008744552,  0.047380987883265, -0.000406829268913,
                                -0.000520160875585,  0.084586439635007,  0.174741245447228,
                                -0.678764432359070, -0.125221314422463,  0.595934212026617,
                                 0.404810805307928,  0.031098228475630,  0.029118300052022,
                                 3.948047001235177,  3.047413386676495,  0.072304030065319,
                                 0.075892441232213, -0.019004352350503, -0.016031566759634,
                                 0.075399686736140,  0.076449078973143, -0.010503810771218,
                                -0.011898484222150, -0.051141558270653, -0.048840600416474,
                                 0.263828600759257,  0.282502684216266, -0.498213576715992,
                                -0.097777336887945,  0.811232368693677,  0.586728544622340,
                                 0.029118300052022,  0.033923227925973,  3.047413386676495,
                                 3.112641907817842,  0.075892441232213,  0.093434351901512,
                                -0.016031566759634, -0.017588503804400,  0.076449078973143,
                                 0.092642892970634, -0.011898484222150, -0.015127792115902,
                                -0.048840600416474, -0.057486305957660, -0.036205186708769,
                                 0.181750687420318, -0.373489578835355,  0.169096884098845,
                                -0.694202398126696, -0.236896968518736,  0.000667006083549,
                                 0.000604990800414,  0.072304030065319,  0.075892441232213,
                                 4.025743657955895,  3.127084149876759,  0.047100903903013,
                                 0.048282128187159,  0.066661774657982,  0.070952776536786,
                                -0.065482779227589, -0.065232204110590, -0.009798192042638,
                                -0.012085508740386,  0.212303845467154,  0.314862121808604,
                                 0.027578072114531,  0.350477712120319, -0.647509145731536,
                                -0.284861761402531,  0.000604990800414,  0.000696810175471,
                                 0.075892441232213,  0.093434351901512,  3.127084149876759,
                                 3.209702482925850,  0.048282128187159,  0.058806050008381,
                                 0.070952776536786,  0.087890141053622, -0.065232204110590,
                                -0.078390302506144, -0.012085508740386, -0.015859612850645,
                                -1.012656265132826, -0.481208518937358,  0.605441760884711,
                                 0.433395868252647, -0.675104176755217, -0.320805679291572,
                                -0.001285274849412, -0.001212429829315, -0.019004352350503,
                                -0.016031566759634,  0.047100903903013,  0.048282128187159,
                                 3.974293440465643,  3.068002687773665,  0.031400602602008,
                                 0.032188085458106,  0.007918480146044,  0.006679819483181,
                                 0.006569182563660,  0.006196863572054, -1.116496973241504,
                                -0.645941246964678,  0.852225490457338,  0.633674862325853,
                                -0.744331315494336, -0.430627497976452, -0.001212429829315,
                                -0.001416677385472, -0.016031566759634, -0.017588503804400,
                                 0.048282128187159,  0.058806050008381,  3.068002687773665,
                                 3.134180406469717,  0.032188085458106,  0.039204033338920,
                                 0.006679819483181,  0.007328543251833,  0.006196863572054,
                                 0.007240795525744, -0.694202398126696, -0.236896968518736,
                                -0.248993052556904,  0.112731256065896,  0.542296811730144,
                                 0.379164827852598,  0.003053217697576,  0.004075161603475,
                                 0.075399686736140,  0.076449078973143,  0.066661774657982,
                                 0.070952776536786,  0.031400602602008,  0.032188085458106,
                                 3.970192179074243,  3.067956836096106,  0.021617613910500,
                                 0.018561747490275, -0.006021760141972, -0.007338603443690,
                                -0.647509145731536, -0.284861761402531,  0.018385381409687,
                                 0.233651808080213,  0.751894800243434,  0.552246922977380,
                                 0.004075161603475,  0.005485673636577,  0.076449078973143,
                                 0.092642892970634,  0.070952776536786,  0.087890141053622,
                                 0.032188085458106,  0.039204033338920,  3.067956836096106,
                                 3.136460698714497,  0.018561747490275,  0.020587778416340,
                                -0.007338603443689, -0.009590679545146, -0.736650577798849,
                                -0.447620486449054,  0.282818513482945,  0.052175547676026,
                                 0.803803420248637,  0.393546282390760,  0.044261951379235,
                                 0.040937008744552, -0.010503810771218, -0.011898484222150,
                                -0.065482779227589, -0.065232204110590,  0.007918480146044,
                                 0.006679819483181,  0.021617613910500,  0.018561747490275,
                                 3.927214443205593,  3.023814726302565,  0.032504111290962,
                                 0.030733439388662, -0.935879208960114, -0.635620900111723,
                                 0.207588990298330,  0.040740557036644,  0.900912451009937,
                                 0.532396945606442,  0.040937008744552,  0.047380987883265,
                                -0.011898484222150, -0.015127792115902, -0.065232204110590,
                                -0.078390302506144,  0.006679819483181,  0.007328543251833,
                                 0.018561747490275,  0.020587778416340,  3.023814726302565,
                                 3.082638453454637,  0.030733439388662,  0.035988301301310,
                                -0.272369615195874, -0.182405679054002,  0.293619102808096,
                                 0.089326782277079, -0.073448371100207, -0.063821441416536,
                                -0.000354120703374, -0.000406829268913, -0.051141558270653,
                                -0.048840600416474, -0.009798192042638, -0.012085508740386,
                                 0.006569182563660,  0.006196863572054, -0.006021760141972,
                                -0.007338603443689,  0.032504111290962,  0.030733439388662,
                                 3.858108957197775,  2.958118440920442, -0.367459988926520,
                                -0.263725884644979,  0.260088392746976,  0.102018905009269,
                                -0.117641729708432, -0.095974116403841, -0.000406829268913,
                                -0.000520160875585, -0.048840600416474, -0.057486305957660,
                                -0.012085508740386, -0.015859612850645,  0.006196863572054,
                                 0.007240795525744, -0.007338603443690, -0.009590679545146,
                                 0.030733439388662,  0.035988301301310,  2.958118440920442,
                                 3.005503607269763};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19};

    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 20, 20, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeDFForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(2, 3);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 4.421808648667628,  3.506299950695142,  0.044116585394124,
                                 0.047866613129848, -0.001316915371077,  0.002013659246585,
                                 0.051075823687660,  0.053453670625175, -0.002745282618823,
                                -0.003335681649018, -0.174493956649244, -0.420888142805826,
                                -0.088602266663134, -0.616267427669904, -0.037538560847799,
                                 0.246390558372112, -1.019209316004539, -0.676615688136024,
                                 0.545529511972206,  0.640635561411790,  0.142373327048830,
                                 0.050191178829942,  0.330432541871992,  0.655548215881282,
                                 3.506299950695142,  3.454438074787293,  0.047866613129848,
                                 0.061292674094833,  0.002013659246585,  0.005807780289902,
                                 0.053453670625175,  0.066604724762238, -0.003335681649018,
                                -0.004606233887275, -0.216573513662098, -0.502656236206957,
                                -0.215452427977239, -0.792512582191375,  0.086031585702210,
                                 0.290749453143057, -0.714506902266925, -0.653722942624173,
                                 0.492228006693058,  0.679381350251309,  0.079548452574986,
                                 0.042068929854638,  0.363240430224619,  0.774281571858836,
                                 0.044116585394124,  0.047866613129848,  4.527086863812696,
                                 3.620527095664100,  0.063922540896472,  0.072700727888479,
                                 0.047398494293154,  0.054462355723841, -0.046546107366602,
                                -0.047949795904296, -0.335973728930381, -0.222965238919807,
                                 0.036696931680922,  0.126053826364958, -0.288985329134589,
                                -0.528830782498041, -0.287201136175275,  0.239683908857185,
                                -0.445146288559062,  0.037384493539170, -0.744550441894939,
                                -0.311121229556206, -0.413420957975636, -0.396601043840595,
                                 0.047866613129848,  0.061292674094833,  3.620527095664100,
                                 3.600704683422691,  0.072700727888479,  0.096229946162625,
                                 0.054462355723841,  0.072585355729927, -0.047949795904296,
                                -0.059004438848235, -0.235496691236012, -0.215410462515390,
                                 0.109107408037268,  0.094234421099878, -0.228275028910268,
                                -0.706892921605056, -0.047500749004108,  0.343084311932823,
                                -0.159897117324597,  0.084367022612018, -0.493585617413652,
                                -0.210610376104811, -0.345657545302412, -0.400885025660087,
                                -0.001316915371077,  0.002013659246585,  0.063922540896472,
                                 0.072700727888479,  4.524473246959378,  3.614526031975203,
                                 0.042615027264315,  0.048467151925653,  0.000548714737949,
                                -0.000839024686077, -0.097070793129895, -0.053970433238499,
                                -0.780893147622112, -0.275289960779911,  0.073775785305374,
                                 0.094592512008711,  0.869093045675869, -0.150286670615510,
                                 0.049183856870249,  0.063061674672474,  0.325372144842546,
                                 0.114704150324963,  0.496139609330572,  0.275848880996773,
                                 0.002013659246585,  0.005807780289902,  0.072700727888479,
                                 0.096229946162625,  3.614526031975203,  3.590051139109891,
                                 0.048467151925653,  0.064153297441750, -0.000839024686077,
                                -0.002419908454125, -0.063264129954071, -0.050626777867238,
                                -0.436309544823971, -0.230740825772902,  0.133200316160326,
                                 0.028509055877260,  0.412982469001902, -0.406641325240602,
                                 0.088800210773550,  0.019006037251506,  0.181795643676654,
                                 0.096142010738709,  0.323349997543028,  0.258759086876994,
                                 0.051075823687660,  0.053453670625175,  0.047398494293154,
                                 0.054462355723841,  0.042615027264315,  0.048467151925653,
                                 4.487588118568403,  3.575141799227565,  0.020964701975384,
                                 0.019735697889799,  0.645915627476985,  0.478562895655354,
                                 0.585433893193350,  0.282958039554183, -0.445146288559062,
                                 0.037384493539170, -0.191467424116850,  0.159789272571457,
                                 0.081969911331296, -0.559984527114016,  0.849959291711271,
                                 0.269999019708635, -0.105416515008210, -0.141686402536838,
                                 0.053453670625175,  0.066604724762238,  0.054462355723841,
                                 0.072585355729927,  0.048467151925653,  0.064153297441750,
                                 3.575141799227565,  3.540216886981085,  0.019735697889799,
                                 0.022446768312149,  0.475559624393546,  0.469583300439288,
                                 0.417449193100325,  0.194627588922889, -0.159897117324597,
                                 0.084367022612018, -0.031667166002739,  0.228722874621882,
                                -0.095027431139771, -0.777198773781738,  0.498249132305383,
                                 0.175924222251922, -0.106677129470637, -0.147284673359349,
                                -0.002745282618823, -0.003335681649018, -0.046546107366602,
                                -0.047949795904296,  0.000548714737949, -0.000839024686077,
                                 0.020964701975384,  0.019735697889799,  4.416363838140298,
                                 3.499684182091257, -0.225281543620246, -0.618479105628697,
                                 0.142373327048830,  0.050191178829942, -0.726080717945377,
                                -0.721950478567877,  0.424670548335224,  0.281923203390009,
                                 0.885278714126188,  0.662000134947666,  0.193771498650379,
                                -0.516721589657187, -0.195982100345581, -0.428463404867493,
                                -0.003335681649018, -0.004606233887275, -0.047949795904296,
                                -0.059004438848235, -0.000839024686077, -0.002419908454125,
                                 0.019735697889799,  0.022446768312149,  3.499684182091257,
                                 3.445302377577531, -0.304489262635674, -0.743211215765516,
                                 0.079548452574986,  0.042068929854638, -0.601182195134980,
                                -0.752358501412327,  0.297711209277885,  0.272384559426738,
                                 0.642908548849815,  0.663743781299367, -0.057681330370184,
                                -0.709075871313008, -0.228579614911430, -0.509005622209277,
                                -0.174493956649244, -0.216573513662098, -0.335973728930381,
                                -0.235496691236012, -0.097070793129895, -0.063264129954071,
                                 0.645915627476985,  0.475559624393546, -0.225281543620246,
                                -0.304489262635674,  3.202114389066253,  1.498507930212499,
                                 0.087511576187288,  0.053669164220241,  0.001941158133635,
                                 0.001118525640133, -0.003589663796302, -0.002233902239870,
                                 0.005729793284020,  0.007684076611919,  0.125730541821356,
                                 0.075374800777164, -0.000821963019536, -0.000761412092355,
                                -0.420888142805826, -0.502656236206957, -0.222965238919807,
                                -0.215410462515390, -0.053970433238499, -0.050626777867238,
                                 0.478562895655354,  0.469583300439288, -0.618479105628697,
                                -0.743211215765516,  1.498507930212499,  2.278401667003069,
                                 0.053669164220241,  0.085909795209512,  0.001118525640133,
                                 0.001602704487722, -0.002233902239870, -0.003636511406393,
                                 0.007684076611919,  0.011625036476239,  0.075374800777164,
                                 0.121122204922951, -0.000761412092355, -0.001149402707479,
                                -0.088602266663134, -0.215452427977239,  0.036696931680922,
                                 0.109107408037268, -0.780893147622112, -0.436309544823971,
                                 0.585433893193350,  0.417449193100325,  0.142373327048830,
                                 0.079548452574986,  0.087511576187288,  0.053669164220241,
                                 3.447397372239345,  1.667595787800838,  0.184417039427437,
                                 0.141122982779134, -0.057538044976563, -0.029267324742193,
                                 0.198549715295908,  0.141785349958338, -0.024768165949220,
                                -0.022246402142357, -0.141699058769991, -0.090166977082764,
                                -0.616267427669904, -0.792512582191375,  0.126053826364958,
                                 0.094234421099878, -0.275289960779911, -0.230740825772902,
                                 0.282958039554183,  0.194627588922889,  0.050191178829942,
                                 0.042068929854638,  0.053669164220241,  0.085909795209512,
                                 1.667595787800838,  2.544656848838963,  0.141122982779134,
                                 0.218879961491351, -0.029267324742194, -0.048799058880514,
                                 0.141785349958338,  0.222215216209289, -0.022246402142357,
                                -0.033751276068106, -0.090166977082764, -0.143451988841386,
                                -0.037538560847799,  0.086031585702210, -0.288985329134589,
                                -0.228275028910268,  0.073775785305374,  0.133200316160326,
                                -0.445146288559062, -0.159897117324597, -0.726080717945377,
                                -0.601182195134980,  0.001941158133635,  0.001118525640133,
                                 0.184417039427437,  0.141122982779134,  3.649959487299250,
                                 1.815494951635113,  0.122804047405404,  0.089618123628917,
                                 0.167742046329345,  0.132070894515547, -0.175126962142334,
                                -0.120815612695229, -0.020785695899594, -0.022710943493426,
                                 0.246390558372112,  0.290749453143057, -0.528830782498041,
                                -0.706892921605056,  0.094592512008711,  0.028509055877260,
                                 0.037384493539170,  0.084367022612018, -0.721950478567877,
                                -0.752358501412327,  0.001118525640133,  0.001602704487722,
                                 0.141122982779134,  0.218879961491351,  1.815494951635113,
                                 2.775314355284775,  0.089618123628917,  0.140085311011584,
                                 0.132070894515547,  0.204084991101359, -0.120815612695229,
                                -0.190383798400968, -0.022710943493426, -0.034047539732430,
                                -1.019209316004539, -0.714506902266925, -0.287201136175275,
                                -0.047500749004108,  0.869093045675869,  0.412982469001902,
                                -0.191467424116850, -0.031667166002739,  0.424670548335224,
                                 0.297711209277885, -0.003589663796302, -0.002233902239870,
                                -0.057538044976563, -0.029267324742194,  0.122804047405404,
                                 0.089618123628917,  3.530495447921870,  1.704930068725853,
                                 0.081869364936936,  0.059745415752611,  0.023974185406902,
                                 0.012194718642580,  0.018347170514432,  0.011417722559337,
                                -0.676615688136024, -0.653722942624173,  0.239683908857185,
                                 0.343084311932823, -0.150286670615510, -0.406641325240602,
                                 0.159789272571457,  0.228722874621882,  0.281923203390009,
                                 0.272384559426738, -0.002233902239870, -0.003636511406393,
                                -0.029267324742193, -0.048799058880514,  0.089618123628917,
                                 0.140085311011584,  1.704930068725853,  2.608159076469363,
                                 0.059745415752611,  0.093390207341056,  0.012194718642580,
                                 0.020332941200214,  0.011417722559337,  0.018586613854896,
                                 0.545529511972206,  0.492228006693058, -0.445146288559062,
                                -0.159897117324597,  0.049183856870249,  0.088800210773550,
                                 0.081969911331296, -0.095027431139771,  0.885278714126188,
                                 0.642908548849815,  0.005729793284020,  0.007684076611919,
                                 0.198549715295908,  0.141785349958338,  0.167742046329345,
                                 0.132070894515547,  0.081869364936936,  0.059745415752611,
                                 3.510174448691463,  1.705435872872156,  0.064700745531391,
                                 0.033944325656577, -0.012989278626807, -0.013783117350694,
                                 0.640635561411790,  0.679381350251309,  0.037384493539170,
                                 0.084367022612018,  0.063061674672474,  0.019006037251506,
                                -0.559984527114016, -0.777198773781738,  0.662000134947666,
                                 0.663743781299367,  0.007684076611919,  0.011625036476239,
                                 0.141785349958338,  0.222215216209289,  0.132070894515547,
                                 0.204084991101359,  0.059745415752611,  0.093390207341056,
                                 1.705435872872156,  2.605243529366976,  0.033944325656577,
                                 0.056186048248821, -0.013783117350694, -0.020632944574667,
                                 0.142373327048830,  0.079548452574986, -0.744550441894939,
                                -0.493585617413652,  0.325372144842546,  0.181795643676654,
                                 0.849959291711271,  0.498249132305383,  0.193771498650379,
                                -0.057681330370184,  0.125730541821356,  0.075374800777164,
                                -0.024768165949220, -0.022246402142357, -0.175126962142334,
                                -0.120815612695229,  0.023974185406902,  0.012194718642580,
                                 0.064700745531391,  0.033944325656577,  3.398273843106729,
                                 1.623473756885164,  0.090774824206942,  0.056692021019711,
                                 0.050191178829942,  0.042068929854638, -0.311121229556206,
                                -0.210610376104811,  0.114704150324963,  0.096142010738709,
                                 0.269999019708635,  0.175924222251922, -0.516721589657187,
                                -0.709075871313008,  0.075374800777164,  0.121122204922951,
                                -0.022246402142357, -0.033751276068106, -0.120815612695229,
                                -0.190383798400968,  0.012194718642580,  0.020332941200214,
                                 0.033944325656577,  0.056186048248821,  1.623473756885164,
                                 2.477716817970552,  0.056692021019711,  0.090473000633380,
                                 0.330432541871992,  0.363240430224619, -0.413420957975636,
                                -0.345657545302412,  0.496139609330572,  0.323349997543028,
                                -0.105416515008210, -0.106677129470637, -0.195982100345581,
                                -0.228579614911430, -0.000821963019536, -0.000761412092355,
                                -0.141699058769991, -0.090166977082764, -0.020785695899594,
                                -0.022710943493426,  0.018347170514432,  0.011417722559337,
                                -0.012989278626807, -0.013783117350694,  0.090774824206942,
                                 0.056692021019711,  3.206154714536678,  1.502250620086754,
                                 0.655548215881282,  0.774281571858836, -0.396601043840595,
                                -0.400885025660087,  0.275848880996773,  0.258759086876994,
                                -0.141686402536838, -0.147284673359349, -0.428463404867493,
                                -0.509005622209277, -0.000761412092355, -0.001149402707479,
                                -0.090166977082764, -0.143451988841386, -0.022710943493426,
                                -0.034047539732430,  0.011417722559337,  0.018586613854896,
                                -0.013783117350694, -0.020632944574667,  0.056692021019711,
                                 0.090473000633380,  1.502250620086754,  2.284051508813985};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 24, 24, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeFDForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(3, 2);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.478214801540742,  1.893711993539113,  0.113845079639040,
                                 0.098457288097802, -0.010398449425070,  0.004397542058047,
                                 0.135796844437519,  0.109803540345022, -0.006358322731098,
                                -0.006887707600306,  0.180855392472083,  0.274873749969854,
                                 0.105152737064425,  0.286397092662552,  0.014129133748873,
                                -0.128756406385473,  0.971708070924803,  0.833083969792524,
                                -0.540637951647308, -0.601456714011899, -0.131613182315514,
                                -0.087530307345866, -0.334783192060545, -0.454541832081184,
                                 1.893711993539113,  2.568625662074751,  0.098457288097802,
                                 0.176831721729404,  0.004397542058047,  0.018338724450592,
                                 0.109803540345022,  0.191254160791963, -0.006887707600306,
                                -0.013453349418572,  0.251348227892756,  0.371333205666617,
                                 0.366732814204038,  0.584773958942253, -0.143996176519217,
                                -0.214052075206614,  0.413677270730184,  0.486281801569800,
                                -0.385115843175543, -0.503070608355133, -0.031860773365048,
                                -0.031653057531083, -0.392394376509024, -0.572271625420402,
                                 0.113845079639040,  0.098457288097802,  3.749890559770268,
                                 2.128666885590687,  0.158154370861165,  0.149787169537950,
                                 0.116143059381084,  0.112249489928672, -0.125305611931207,
                                -0.098438822804517,  0.320308329078972,  0.274570019859666,
                                -0.055792727380626, -0.150264605137332,  0.267417939274440,
                                 0.267317845626096,  0.246949382397578,  0.017574219979649,
                                 0.393421649095059,  0.147230787109356,  0.709820750706902,
                                 0.570542997256591,  0.405519398613688,  0.417405542900168,
                                 0.098457288097802,  0.176831721729404,  2.128666885590687,
                                 2.990610452565374,  0.149787169537950,  0.279165123100005,
                                 0.112249489928672,  0.210807136455715, -0.098438822804517,
                                -0.169056134251319,  0.136321112083318,  0.160236976032876,
                                -0.072657690691507, -0.069356056707353,  0.320365924627206,
                                 0.522811791295060, -0.137134070386632, -0.251622341625851,
                                -0.014037104730080, -0.060058149083741,  0.192494625354576,
                                 0.158275482532672,  0.239242630688194,  0.297213949693776,
                                -0.010398449425070,  0.004397542058047,  0.158154370861165,
                                 0.149787169537950,  3.749582339653307,  2.116088199964572,
                                 0.105436247240776,  0.099858113025300,  0.004332687260446,
                                -0.001832309190852,  0.091572304143107,  0.072530125882854,
                                 0.721875609268270,  0.480088641829673, -0.093220785549932,
                                -0.178875331558504, -0.802764644554370, -0.436740285380555,
                                -0.062147190366621, -0.119250221039003, -0.300781503861779,
                                -0.200036934095697, -0.468036221175879, -0.370709532290143,
                                 0.004397542058047,  0.018338724450592,  0.149787169537950,
                                 0.279165123100005,  2.116088199964572,  2.958418999537411,
                                 0.099858113025300,  0.186110082066670, -0.001832309190853,
                                -0.007641135187747,  0.033274493326465,  0.037744416068528,
                                 0.174750847749552,  0.173611562219330, -0.053804144411655,
                                -0.020973344940833,  0.078950237946961,  0.296282843909406,
                                -0.035869429607770, -0.013982229960555, -0.072812853228980,
                                -0.072338150924721, -0.170069632557491, -0.192915904350256,
                                 0.135796844437519,  0.109803540345022,  0.116143059381084,
                                 0.112249489928672,  0.105436247240776,  0.099858113025300,
                                 3.653104676952698,  2.035125643983459,  0.060223224606778,
                                 0.040370954001891, -0.620442825344957, -0.560341936251074,
                                -0.565328829252449, -0.490893899667993,  0.393421649095059,
                                 0.147230787109356,  0.164632921598385,  0.011716146653099,
                                -0.060433434971442,  0.144625523034966, -0.794306992592274,
                                -0.557359992812390,  0.107175930903796,  0.132824763120018,
                                 0.109803540345022,  0.191254160791963,  0.112249489928672,
                                 0.210807136455715,  0.099858113025300,  0.186110082066670,
                                 2.035125643983459,  2.814937838852278,  0.040370954001891,
                                 0.063375141632784, -0.291271055724744, -0.348903176193851,
                                -0.173223527819811, -0.145758236962293, -0.014037104730080,
                                -0.060058149083741, -0.091422713591088, -0.167748227750567,
                                 0.332063511902272,  0.572860248864845, -0.171154411424751,
                                -0.133333089622624,  0.084726257255406,  0.108978493086969,
                                -0.006358322731098, -0.006887707600306, -0.125305611931207,
                                -0.098438822804517,  0.004332687260446, -0.001832309190853,
                                 0.060223224606778,  0.040370954001891,  3.465604128124063,
                                 1.880051373465174,  0.237579187697993,  0.389895599633843,
                                -0.131613182315514, -0.087530307345866,  0.709187447328494,
                                 0.723953345342005, -0.404878362885335, -0.347118320746886,
                                -0.847346066399408, -0.754850299850462, -0.155880074528012,
                                 0.112795316426584,  0.200719527366942,  0.288084537840165,
                                -0.006887707600306, -0.013453349418572, -0.098438822804517,
                                -0.169056134251319, -0.001832309190852, -0.007641135187747,
                                 0.040370954001891,  0.063375141632784,  1.880051373465174,
                                 2.541943185727918,  0.368863338822038,  0.548893997980596,
                                -0.031860773365048, -0.031653057531082,  0.435852316694559,
                                 0.557668357018697, -0.172365529470910, -0.202617417320750,
                                -0.403315930060851, -0.493107235042607,  0.303542280363359,
                                 0.521995394838940,  0.256156915661285,  0.376110543267382,
                                 0.180855392472083,  0.251348227892756,  0.320308329078972,
                                 0.136321112083318,  0.091572304143107,  0.033274493326465,
                                -0.620442825344957, -0.291271055724744,  0.237579187697993,
                                 0.368863338822038,  3.856368291421526,  2.956118688354651,
                                 0.031098228475630,  0.029118300052022,  0.000667006083549,
                                 0.000604990800414, -0.001285274849412, -0.001212429829315,
                                 0.003053217697576,  0.004075161603475,  0.044261951379235,
                                 0.040937008744552, -0.000354120703374, -0.000406829268913,
                                 0.274873749969854,  0.371333205666617,  0.274570019859666,
                                 0.160236976032876,  0.072530125882854,  0.037744416068528,
                                -0.560341936251074, -0.348903176193851,  0.389895599633843,
                                 0.548893997980596,  2.956118688354651,  3.002946777845089,
                                 0.029118300052022,  0.033923227925973,  0.000604990800414,
                                 0.000696810175471, -0.001212429829315, -0.001416677385472,
                                 0.004075161603475,  0.005485673636577,  0.040937008744552,
                                 0.047380987883265, -0.000406829268913, -0.000520160875585,
                                 0.105152737064425,  0.366732814204038, -0.055792727380626,
                                -0.072657690691507,  0.721875609268270,  0.174750847749552,
                                -0.565328829252449, -0.173223527819811, -0.131613182315514,
                                -0.031860773365048,  0.031098228475630,  0.029118300052022,
                                 3.948047001235177,  3.047413386676495,  0.072304030065319,
                                 0.075892441232213, -0.019004352350503, -0.016031566759634,
                                 0.075399686736140,  0.076449078973143, -0.010503810771218,
                                -0.011898484222150, -0.051141558270653, -0.048840600416474,
                                 0.286397092662552,  0.584773958942253, -0.150264605137332,
                                -0.069356056707353,  0.480088641829673,  0.173611562219330,
                                -0.490893899667993, -0.145758236962293, -0.087530307345866,
                                -0.031653057531082,  0.029118300052022,  0.033923227925973,
                                 3.047413386676495,  3.112641907817842,  0.075892441232213,
                                 0.093434351901512, -0.016031566759634, -0.017588503804400,
                                 0.076449078973143,  0.092642892970634, -0.011898484222150,
                                -0.015127792115902, -0.048840600416474, -0.057486305957660,
                                 0.014129133748873, -0.143996176519217,  0.267417939274440,
                                 0.320365924627206, -0.093220785549932, -0.053804144411655,
                                 0.393421649095059, -0.014037104730080,  0.709187447328494,
                                 0.435852316694559,  0.000667006083549,  0.000604990800414,
                                 0.072304030065319,  0.075892441232213,  4.025743657955895,
                                 3.127084149876759,  0.047100903903013,  0.048282128187159,
                                 0.066661774657982,  0.070952776536786, -0.065482779227589,
                                -0.065232204110590, -0.009798192042638, -0.012085508740386,
                                -0.128756406385473, -0.214052075206614,  0.267317845626096,
                                 0.522811791295060, -0.178875331558504, -0.020973344940833,
                                 0.147230787109356, -0.060058149083741,  0.723953345342005,
                                 0.557668357018697,  0.000604990800414,  0.000696810175471,
                                 0.075892441232213,  0.093434351901512,  3.127084149876759,
                                 3.209702482925850,  0.048282128187159,  0.058806050008381,
                                 0.070952776536786,  0.087890141053622, -0.065232204110590,
                                -0.078390302506144, -0.012085508740386, -0.015859612850645,
                                 0.971708070924803,  0.413677270730184,  0.246949382397578,
                                -0.137134070386632, -0.802764644554370,  0.078950237946961,
                                 0.164632921598385, -0.091422713591088, -0.404878362885335,
                                -0.172365529470910, -0.001285274849412, -0.001212429829315,
                                -0.019004352350503, -0.016031566759634,  0.047100903903013,
                                 0.048282128187159,  3.974293440465643,  3.068002687773665,
                                 0.031400602602008,  0.032188085458106,  0.007918480146044,
                                 0.006679819483181,  0.006569182563660,  0.006196863572054,
                                 0.833083969792524,  0.486281801569800,  0.017574219979649,
                                -0.251622341625851, -0.436740285380555,  0.296282843909406,
                                 0.011716146653099, -0.167748227750567, -0.347118320746886,
                                -0.202617417320750, -0.001212429829315, -0.001416677385472,
                                -0.016031566759634, -0.017588503804400,  0.048282128187159,
                                 0.058806050008381,  3.068002687773665,  3.134180406469717,
                                 0.032188085458106,  0.039204033338920,  0.006679819483181,
                                 0.007328543251833,  0.006196863572054,  0.007240795525744,
                                -0.540637951647308, -0.385115843175543,  0.393421649095059,
                                -0.014037104730080, -0.062147190366621, -0.035869429607770,
                                -0.060433434971442,  0.332063511902272, -0.847346066399408,
                                -0.403315930060851,  0.003053217697576,  0.004075161603475,
                                 0.075399686736140,  0.076449078973143,  0.066661774657982,
                                 0.070952776536786,  0.031400602602008,  0.032188085458106,
                                 3.970192179074243,  3.067956836096106,  0.021617613910500,
                                 0.018561747490275, -0.006021760141972, -0.007338603443690,
                                -0.601456714011899, -0.503070608355133,  0.147230787109356,
                                -0.060058149083741, -0.119250221039003, -0.013982229960555,
                                 0.144625523034966,  0.572860248864845, -0.754850299850462,
                                -0.493107235042607,  0.004075161603475,  0.005485673636577,
                                 0.076449078973143,  0.092642892970634,  0.070952776536786,
                                 0.087890141053622,  0.032188085458106,  0.039204033338920,
                                 3.067956836096106,  3.136460698714497,  0.018561747490275,
                                 0.020587778416340, -0.007338603443689, -0.009590679545146,
                                -0.131613182315514, -0.031860773365048,  0.709820750706902,
                                 0.192494625354576, -0.300781503861779, -0.072812853228980,
                                -0.794306992592274, -0.171154411424751, -0.155880074528012,
                                 0.303542280363359,  0.044261951379235,  0.040937008744552,
                                -0.010503810771218, -0.011898484222150, -0.065482779227589,
                                -0.065232204110590,  0.007918480146044,  0.006679819483181,
                                 0.021617613910500,  0.018561747490275,  3.927214443205593,
                                 3.023814726302565,  0.032504111290962,  0.030733439388662,
                                -0.087530307345866, -0.031653057531083,  0.570542997256591,
                                 0.158275482532672, -0.200036934095697, -0.072338150924721,
                                -0.557359992812390, -0.133333089622624,  0.112795316426584,
                                 0.521995394838940,  0.040937008744552,  0.047380987883265,
                                -0.011898484222150, -0.015127792115902, -0.065232204110590,
                                -0.078390302506144,  0.006679819483181,  0.007328543251833,
                                 0.018561747490275,  0.020587778416340,  3.023814726302565,
                                 3.082638453454637,  0.030733439388662,  0.035988301301310,
                                -0.334783192060545, -0.392394376509024,  0.405519398613688,
                                 0.239242630688194, -0.468036221175879, -0.170069632557491,
                                 0.107175930903796,  0.084726257255406,  0.200719527366942,
                                 0.256156915661285, -0.000354120703374, -0.000406829268913,
                                -0.051141558270653, -0.048840600416474, -0.009798192042638,
                                -0.012085508740386,  0.006569182563660,  0.006196863572054,
                                -0.006021760141972, -0.007338603443689,  0.032504111290962,
                                 0.030733439388662,  3.858108957197775,  2.958118440920442,
                                -0.454541832081184, -0.572271625420402,  0.417405542900168,
                                 0.297213949693776, -0.370709532290143, -0.192915904350256,
                                 0.132824763120018,  0.108978493086969,  0.288084537840165,
                                 0.376110543267382, -0.000406829268913, -0.000520160875585,
                                -0.048840600416474, -0.057486305957660, -0.012085508740386,
                                -0.015859612850645,  0.006196863572054,  0.007240795525744,
                                -0.007338603443690, -0.009590679545146,  0.030733439388662,
                                 0.035988301301310,  2.958118440920442,  3.005503607269763};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 24, 24, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeFFForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(3, 3);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.856368291421526,  2.956118688354651, -0.126910759291633,
                                 0.164813309951453,  0.031098228475630,  0.029118300052022,
                                -0.273308280457999, -0.345881896682755,  0.000667006083549,
                                 0.000604990800414, -0.413785521080321, -0.185602419409492,
                                -0.001285274849412, -0.001212429829315, -0.125166356116090,
                                -0.045462050972860,  0.003053217697576,  0.004075161603475,
                                 0.777224045632482,  0.389336469232082,  0.044261951379235,
                                 0.040937008744552, -0.353737154289293, -0.508014821333807,
                                -0.000354120703374, -0.000406829268913,  0.008346861413723,
                                 0.001604493525407,  2.956118688354651,  3.002946777845089,
                                -0.034909574409162,  0.321644743164593,  0.029118300052022,
                                 0.033923227925973, -0.324950209608891, -0.443382487474170,
                                 0.000604990800414,  0.000696810175471, -0.292241898960243,
                                -0.202933909650354, -0.001212429829315, -0.001416677385472,
                                -0.082103960274255, -0.046579900663697,  0.004075161603475,
                                 0.005485673636577,  0.579674393161854,  0.433506646973487,
                                 0.040937008744552,  0.047380987883265, -0.459120765614685,
                                -0.655705104740157, -0.000406829268913, -0.000520160875585,
                                 0.004201921330691,  0.001390809360298, -0.126910759291633,
                                -0.034909574409162,  3.202114389066253,  1.498507930212499,
                                -0.273308280457998, -0.324950209608891,  0.087511576187288,
                                 0.053669164220241, -0.413785521080321, -0.292241898960243,
                                 0.001941158133635,  0.001118525640133, -0.125166356116089,
                                -0.082103960274255, -0.003589663796302, -0.002233902239870,
                                 0.777224045632481,  0.579674393161854,  0.005729793284020,
                                 0.007684076611919, -0.353737154289293, -0.459120765614685,
                                 0.125730541821356,  0.075374800777164,  0.008346861413723,
                                 0.004201921330691, -0.000821963019536, -0.000761412092355,
                                 0.164813309951453,  0.321644743164593,  1.498507930212499,
                                 2.278401667003069, -0.345881896682755, -0.443382487474170,
                                 0.053669164220241,  0.085909795209512, -0.185602419409492,
                                -0.202933909650354,  0.001118525640133,  0.001602704487722,
                                -0.045462050972860, -0.046579900663697, -0.002233902239870,
                                -0.003636511406393,  0.389336469232082,  0.433506646973487,
                                 0.007684076611919,  0.011625036476239, -0.508014821333806,
                                -0.655705104740158,  0.075374800777164,  0.121122204922951,
                                 0.001604493525407,  0.001390809360298, -0.000761412092355,
                                -0.001149402707479,  0.031098228475630,  0.029118300052022,
                                -0.273308280457998, -0.345881896682755,  3.948047001235177,
                                 3.047413386676495, -0.077095141004698, -0.149965288491415,
                                 0.072304030065319,  0.075892441232213, -0.139031715687433,
                                -0.087491951600475, -0.019004352350503, -0.016031566759634,
                                -0.600053050877533, -0.013563099458974,  0.075399686736140,
                                 0.076449078973143,  0.225143658289144, -0.095429972414734,
                                -0.010503810771218, -0.011898484222150,  0.148266419241601,
                                 0.014828501506565, -0.051141558270653, -0.048840600416474,
                                 0.515894082016007,  0.539185788208806,  0.029118300052022,
                                 0.033923227925973, -0.324950209608891, -0.443382487474170,
                                 3.047413386676495,  3.112641907817842, -0.168143514352861,
                                -0.139693807942651,  0.075892441232213,  0.093434351901512,
                                -0.066615941586792, -0.131259101072383, -0.016031566759634,
                                -0.017588503804400, -0.262562752629236,  0.053578014301398,
                                 0.076449078973143,  0.092642892970634,  0.075971930523655,
                                -0.181788262378492, -0.011898484222150, -0.015127792115902,
                                 0.062441494567843,  0.008271604875978, -0.048840600416474,
                                -0.057486305957660,  0.540752725193405,  0.682724766591586,
                                -0.273308280457999, -0.324950209608891,  0.087511576187288,
                                 0.053669164220241, -0.077095141004698, -0.168143514352861,
                                 3.447397372239345,  1.667595787800838, -0.139031715687433,
                                -0.066615941586792,  0.184417039427437,  0.141122982779134,
                                -0.600053050877533, -0.262562752629236, -0.057538044976563,
                                -0.029267324742193,  0.225143658289145,  0.075971930523656,
                                 0.198549715295908,  0.141785349958338,  0.148266419241601,
                                 0.062441494567843, -0.024768165949220, -0.022246402142357,
                                 0.515894082016007,  0.540752725193405, -0.141699058769991,
                                -0.090166977082764, -0.345881896682755, -0.443382487474170,
                                 0.053669164220241,  0.085909795209512, -0.149965288491415,
                                -0.139693807942651,  1.667595787800838,  2.544656848838963,
                                -0.087491951600475, -0.131259101072383,  0.141122982779134,
                                 0.218879961491351, -0.013563099458974,  0.053578014301398,
                                -0.029267324742194, -0.048799058880514, -0.095429972414734,
                                -0.181788262378492,  0.141785349958338,  0.222215216209289,
                                 0.014828501506565,  0.008271604875978, -0.022246402142357,
                                -0.033751276068106,  0.539185788208805,  0.682724766591585,
                                -0.090166977082764, -0.143451988841386,  0.000667006083549,
                                 0.000604990800414, -0.413785521080321, -0.185602419409492,
                                 0.072304030065319,  0.075892441232213, -0.139031715687433,
                                -0.087491951600475,  4.025743657955895,  3.127084149876759,
                                -0.655598714473931, -0.545327155039054,  0.047100903903013,
                                 0.048282128187159,  0.262775997097894,  0.025546885303376,
                                 0.066661774657982,  0.070952776536786, -0.090100636882410,
                                -0.004009352349030, -0.065482779227589, -0.065232204110590,
                                -0.355251027835233,  0.084687585918940, -0.009798192042638,
                                -0.012085508740386, -0.464381719603078, -0.308018589013680,
                                 0.000604990800414,  0.000696810175471, -0.292241898960243,
                                -0.202933909650354,  0.075892441232213,  0.093434351901512,
                                -0.066615941586792, -0.131259101072383,  3.127084149876759,
                                 3.209702482925850, -0.617689628734494, -0.635577957308615,
                                 0.048282128187159,  0.058806050008381,  0.154618531312811,
                                -0.013375298165643,  0.070952776536786,  0.087890141053622,
                                 0.006249467290756, -0.023200440346472, -0.065232204110590,
                                -0.078390302506144, -0.128740683394809,  0.177258145609467,
                                -0.012085508740386, -0.015859612850645, -0.403288647737608,
                                -0.355920072788905, -0.413785521080321, -0.292241898960243,
                                 0.001941158133635,  0.001118525640133, -0.139031715687433,
                                -0.066615941586792,  0.184417039427437,  0.141122982779134,
                                -0.655598714473931, -0.617689628734494,  3.649959487299250,
                                 1.815494951635113,  0.262775997097896,  0.154618531312811,
                                 0.122804047405404,  0.089618123628917, -0.090100636882410,
                                 0.006249467290756,  0.167742046329345,  0.132070894515547,
                                -0.355251027835233, -0.128740683394808, -0.175126962142334,
                                -0.120815612695229, -0.464381719603078, -0.403288647737609,
                                -0.020785695899594, -0.022710943493426, -0.185602419409492,
                                -0.202933909650354,  0.001118525640133,  0.001602704487722,
                                -0.087491951600475, -0.131259101072383,  0.141122982779134,
                                 0.218879961491351, -0.545327155039054, -0.635577957308615,
                                 1.815494951635113,  2.775314355284775,  0.025546885303376,
                                -0.013375298165643,  0.089618123628917,  0.140085311011584,
                                -0.004009352349030, -0.023200440346472,  0.132070894515547,
                                 0.204084991101359,  0.084687585918941,  0.177258145609467,
                                -0.120815612695229, -0.190383798400968, -0.308018589013680,
                                -0.355920072788905, -0.022710943493426, -0.034047539732430,
                                -0.001285274849412, -0.001212429829315, -0.125166356116089,
                                -0.045462050972860, -0.019004352350503, -0.016031566759634,
                                -0.600053050877533, -0.013563099458974,  0.047100903903013,
                                 0.048282128187159,  0.262775997097896,  0.025546885303376,
                                 3.974293440465643,  3.068002687773665,  0.095838595814482,
                                -0.510707905744770,  0.031400602602008,  0.032188085458106,
                                 0.175183998065263,  0.017031256868917,  0.007918480146044,
                                 0.006679819483181,  0.250022104532306,  0.005651291441239,
                                 0.006569182563660,  0.006196863572054,  0.639739153482234,
                                 0.232361593861287, -0.001212429829315, -0.001416677385472,
                                -0.082103960274255, -0.046579900663697, -0.016031566759634,
                                -0.017588503804400, -0.262562752629236,  0.053578014301398,
                                 0.048282128187159,  0.058806050008381,  0.154618531312811,
                                -0.013375298165643,  3.068002687773665,  3.134180406469717,
                                -0.327731630637784, -0.648254606053537,  0.032188085458106,
                                 0.039204033338920,  0.103079020875207, -0.008916865443762,
                                 0.006679819483181,  0.007328543251833,  0.109401146928848,
                                -0.022324172625583,  0.006196863572054,  0.007240795525744,
                                 0.419642463623972,  0.238075047836671, -0.125166356116090,
                                -0.082103960274255, -0.003589663796302, -0.002233902239870,
                                -0.600053050877533, -0.262562752629236, -0.057538044976563,
                                -0.029267324742194,  0.262775997097894,  0.154618531312811,
                                 0.122804047405404,  0.089618123628917,  0.095838595814482,
                                -0.327731630637784,  3.530495447921870,  1.704930068725853,
                                 0.175183998065263,  0.103079020875207,  0.081869364936936,
                                 0.059745415752611,  0.250022104532306,  0.109401146928848,
                                 0.023974185406902,  0.012194718642580,  0.639739153482234,
                                 0.419642463623972,  0.018347170514432,  0.011417722559337,
                                -0.045462050972860, -0.046579900663697, -0.002233902239870,
                                -0.003636511406393, -0.013563099458974,  0.053578014301398,
                                -0.029267324742193, -0.048799058880514,  0.025546885303376,
                                -0.013375298165643,  0.089618123628917,  0.140085311011584,
                                -0.510707905744770, -0.648254606053537,  1.704930068725853,
                                 2.608159076469363,  0.017031256868917, -0.008916865443762,
                                 0.059745415752611,  0.093390207341056,  0.005651291441239,
                                -0.022324172625582,  0.012194718642580,  0.020332941200214,
                                 0.232361593861288,  0.238075047836672,  0.011417722559337,
                                 0.018586613854896,  0.003053217697576,  0.004075161603475,
                                 0.777224045632481,  0.389336469232082,  0.075399686736140,
                                 0.076449078973143,  0.225143658289145, -0.095429972414734,
                                 0.066661774657982,  0.070952776536786, -0.090100636882410,
                                -0.004009352349030,  0.031400602602008,  0.032188085458106,
                                 0.175183998065263,  0.017031256868917,  3.970192179074243,
                                 3.067956836096106, -0.580514850405256, -0.541986028081529,
                                 0.021617613910500,  0.018561747490275,  0.525961506437019,
                                -0.032586420621974, -0.006021760141972, -0.007338603443690,
                                -0.103550214434495, -0.104962188192910,  0.004075161603475,
                                 0.005485673636577,  0.579674393161854,  0.433506646973487,
                                 0.076449078973143,  0.092642892970634,  0.075971930523656,
                                -0.181788262378492,  0.070952776536786,  0.087890141053622,
                                 0.006249467290756, -0.023200440346472,  0.032188085458106,
                                 0.039204033338920,  0.103079020875207, -0.008916865443762,
                                 3.067956836096106,  3.136460698714497, -0.622897518143458,
                                -0.616244257019889,  0.018561747490275,  0.020587778416340,
                                 0.203091017532435, -0.108105170919590, -0.007338603443689,
                                -0.009590679545146, -0.117326034747867, -0.125993890250643,
                                 0.777224045632482,  0.579674393161854,  0.005729793284020,
                                 0.007684076611919,  0.225143658289144,  0.075971930523655,
                                 0.198549715295908,  0.141785349958338, -0.090100636882410,
                                 0.006249467290756,  0.167742046329345,  0.132070894515547,
                                 0.175183998065263,  0.103079020875207,  0.081869364936936,
                                 0.059745415752611, -0.580514850405256, -0.622897518143458,
                                 3.510174448691463,  1.705435872872156,  0.525961506437018,
                                 0.203091017532434,  0.064700745531391,  0.033944325656577,
                                -0.103550214434495, -0.117326034747867, -0.012989278626807,
                                -0.013783117350694,  0.389336469232082,  0.433506646973487,
                                 0.007684076611919,  0.011625036476239, -0.095429972414734,
                                -0.181788262378492,  0.141785349958338,  0.222215216209289,
                                -0.004009352349030, -0.023200440346472,  0.132070894515547,
                                 0.204084991101359,  0.017031256868917, -0.008916865443762,
                                 0.059745415752611,  0.093390207341056, -0.541986028081529,
                                -0.616244257019889,  1.705435872872156,  2.605243529366976,
                                -0.032586420621974, -0.108105170919590,  0.033944325656577,
                                 0.056186048248821, -0.104962188192910, -0.125993890250644,
                                -0.013783117350694, -0.020632944574667,  0.044261951379235,
                                 0.040937008744552, -0.353737154289293, -0.508014821333806,
                                -0.010503810771218, -0.011898484222150,  0.148266419241601,
                                 0.014828501506565, -0.065482779227589, -0.065232204110590,
                                -0.355251027835233,  0.084687585918941,  0.007918480146044,
                                 0.006679819483181,  0.250022104532306,  0.005651291441239,
                                 0.021617613910500,  0.018561747490275,  0.525961506437018,
                                -0.032586420621974,  3.927214443205593,  3.023814726302565,
                                 0.216966590491145, -0.120555427170062,  0.032504111290962,
                                 0.030733439388662, -0.306445877078868, -0.352251843012320,
                                 0.040937008744552,  0.047380987883265, -0.459120765614685,
                                -0.655705104740158, -0.011898484222150, -0.015127792115902,
                                 0.062441494567843,  0.008271604875978, -0.065232204110590,
                                -0.078390302506144, -0.128740683394808,  0.177258145609467,
                                 0.006679819483181,  0.007328543251833,  0.109401146928848,
                                -0.022324172625582,  0.018561747490275,  0.020587778416340,
                                 0.203091017532434, -0.108105170919590,  3.023814726302565,
                                 3.082638453454637, -0.044301216793305, -0.123288458271961,
                                 0.030733439388662,  0.035988301301310, -0.341632117596502,
                                -0.448904093413658, -0.353737154289293, -0.459120765614685,
                                 0.125730541821356,  0.075374800777164,  0.148266419241601,
                                 0.062441494567843, -0.024768165949220, -0.022246402142357,
                                -0.355251027835233, -0.128740683394809, -0.175126962142334,
                                -0.120815612695229,  0.250022104532306,  0.109401146928848,
                                 0.023974185406902,  0.012194718642580,  0.525961506437019,
                                 0.203091017532435,  0.064700745531391,  0.033944325656577,
                                 0.216966590491145, -0.044301216793305,  3.398273843106729,
                                 1.623473756885164, -0.306445877078868, -0.341632117596502,
                                 0.090774824206942,  0.056692021019711, -0.508014821333807,
                                -0.655705104740157,  0.075374800777164,  0.121122204922951,
                                 0.014828501506565,  0.008271604875978, -0.022246402142357,
                                -0.033751276068106,  0.084687585918940,  0.177258145609467,
                                -0.120815612695229, -0.190383798400968,  0.005651291441239,
                                -0.022324172625583,  0.012194718642580,  0.020332941200214,
                                -0.032586420621974, -0.108105170919590,  0.033944325656577,
                                 0.056186048248821, -0.120555427170062, -0.123288458271961,
                                 1.623473756885164,  2.477716817970552, -0.352251843012320,
                                -0.448904093413658,  0.056692021019711,  0.090473000633380,
                                -0.000354120703374, -0.000406829268913,  0.008346861413723,
                                 0.001604493525407, -0.051141558270653, -0.048840600416474,
                                 0.515894082016007,  0.539185788208805, -0.009798192042638,
                                -0.012085508740386, -0.464381719603078, -0.308018589013680,
                                 0.006569182563660,  0.006196863572054,  0.639739153482234,
                                 0.232361593861288, -0.006021760141972, -0.007338603443689,
                                -0.103550214434495, -0.104962188192910,  0.032504111290962,
                                 0.030733439388662, -0.306445877078868, -0.352251843012320,
                                 3.858108957197775,  2.958118440920442, -0.167939413825271,
                                 0.156926487912315, -0.000406829268913, -0.000520160875585,
                                 0.004201921330691,  0.001390809360298, -0.048840600416474,
                                -0.057486305957660,  0.540752725193405,  0.682724766591585,
                                -0.012085508740386, -0.015859612850645, -0.403288647737609,
                                -0.355920072788905,  0.006196863572054,  0.007240795525744,
                                 0.419642463623972,  0.238075047836672, -0.007338603443690,
                                -0.009590679545146, -0.117326034747867, -0.125993890250644,
                                 0.030733439388662,  0.035988301301310, -0.341632117596502,
                                -0.448904093413658,  2.958118440920442,  3.005503607269763,
                                -0.055563946167511,  0.314808276864575,  0.008346861413723,
                                 0.004201921330691, -0.000821963019536, -0.000761412092355,
                                 0.515894082016007,  0.540752725193405, -0.141699058769991,
                                -0.090166977082764, -0.464381719603078, -0.403288647737608,
                                -0.020785695899594, -0.022710943493426,  0.639739153482234,
                                 0.419642463623972,  0.018347170514432,  0.011417722559337,
                                -0.103550214434495, -0.117326034747867, -0.012989278626807,
                                -0.013783117350694, -0.306445877078868, -0.341632117596502,
                                 0.090774824206942,  0.056692021019711, -0.167939413825271,
                                -0.055563946167511,  3.206154714536678,  1.502250620086754,
                                 0.001604493525407,  0.001390809360298, -0.000761412092355,
                                -0.001149402707479,  0.539185788208806,  0.682724766591586,
                                -0.090166977082764, -0.143451988841386, -0.308018589013680,
                                -0.355920072788905, -0.022710943493426, -0.034047539732430,
                                 0.232361593861287,  0.238075047836671,  0.011417722559337,
                                 0.018586613854896, -0.104962188192910, -0.125993890250643,
                                -0.013783117350694, -0.020632944574667, -0.352251843012320,
                                -0.448904093413658,  0.056692021019711,  0.090473000633380,
                                 0.156926487912315,  0.314808276864575,  1.502250620086754,
                                 2.284051508813985};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 28, 28, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeSGForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(0, 4);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 7.736774122879349,  6.549415227007131, -0.107127517515837,
                                -0.108279483910388,  0.124988480243763,  0.126332509605085,
                                 1.364526335179643,  1.379199395090462,  1.291259605179917,
                                 1.305144811393055, -0.243022509956842, -0.245635785902011,
                                 0.860839736786612,  0.870096540928703, -0.568552639658183,
                                -0.574666414621026, -0.638830010134786, -0.645699493537101,
                                -0.106234788203205, -0.107377154877801,  6.549415227007131,
                                 6.001510859920003, -0.067554509012894, -0.077977923782271,
                                 0.078817614847530,  0.090978885837331,  0.860468988227947,
                                 0.993236220075855,  0.814267059098207,  0.939905501506276,
                                -0.153249759911486, -0.176895639871328,  0.542844706065471,
                                 0.626603667670851, -0.358528745094978, -0.413848425031606,
                                -0.402845586998481, -0.465003194279692, -0.066991554771120,
                                -0.077328107750752, -0.107127517515837, -0.067554509012894,
                                 3.003272845956699,  1.213900698796220,  0.083064703295064,
                                 0.039855058707057, -0.013921681609226, -0.009215874368535,
                                 0.001578609714113, -0.000658448989035,  0.008515351649315,
                                 0.005243791588594, -0.003153652116547, -0.002152103687203,
                                 0.018909908341683,  0.012137417241391,  0.129473548473349,
                                 0.063092274290374,  0.000626945753456,  0.000425509377579,
                                -0.108279483910388, -0.077977923782271,  1.213900698796220,
                                 2.079262852380217,  0.039855058707057,  0.063118240620152,
                                -0.009215874368535, -0.009931928773966, -0.000658448989035,
                                 0.001680016871824,  0.005243791588594,  0.006172832267994,
                                -0.002152103687203, -0.002194867512680,  0.012137417241391,
                                 0.013722104243975,  0.063092274290374,  0.098095422808380,
                                 0.000425509377579,  0.000439442678647,  0.124988480243763,
                                 0.078817614847530,  0.083064703295064,  0.039855058707057,
                                 3.187752389649002,  1.306076478719369,  0.132599269407999,
                                 0.068705352967274,  0.008887509030065,  0.004679246004160,
                                -0.012068998812081, -0.006987217657977, -0.001635740087389,
                                 0.003048083298650,  0.179648707563497,  0.090109626923777,
                                -0.004680364934214, -0.003150099278026, -0.126434960277506,
                                -0.061029978206855,  0.126332509605085,  0.090978885837331,
                                 0.039855058707057,  0.063118240620152,  1.306076478719369,
                                 2.218725892099505,  0.068705352967274,  0.099538382672895,
                                 0.004679246004160,  0.006531392918573, -0.006987217657977,
                                -0.008883786114476,  0.003048083298650, -0.002190511077071,
                                 0.090109626923777,  0.135771991486161, -0.003150099278026,
                                -0.003290254167836, -0.061029978206855, -0.095965596856573,
                                 1.364526335179643,  0.860468988227947, -0.013921681609226,
                                -0.009215874368535,  0.132599269407999,  0.068705352967274,
                                 3.454395284543255,  1.460895665547285,  0.223480122686521,
                                 0.132162521859241, -0.143558959884823, -0.077107504692447,
                                 0.227134148978855,  0.127868110920420, -0.054024950863989,
                                -0.035441676819435, -0.235167390362799, -0.127453570444064,
                                -0.023114306656439, -0.015030976089177,  1.379199395090462,
                                 0.993236220075855, -0.009215874368535, -0.009931928773966,
                                 0.068705352967274,  0.099538382672895,  1.460895665547285,
                                 2.413849781863635,  0.132162521859241,  0.162897834626554,
                                -0.077107504692447, -0.107060499760845,  0.127868110920420,
                                 0.167526249594067, -0.035441676819435, -0.038303715460235,
                                -0.127453570444064, -0.174809396154466, -0.015030976089177,
                                -0.016654466479835,  1.291259605179917,  0.814267059098207,
                                 0.001578609714113, -0.000658448989035,  0.008887509030065,
                                 0.004679246004160,  0.223480122686521,  0.132162521859241,
                                 3.533678762391258,  1.497498623392848,  0.069710415465437,
                                 0.033430003079897,  0.188550664006585,  0.109014945335631,
                                -0.194708338463578, -0.106755409359887, -0.026906696991985,
                                -0.023741233601018, -0.002317196933221, -0.002234375155657,
                                 1.305144811393055,  0.939905501506276, -0.000658448989035,
                                 0.001680016871824,  0.004679246004160,  0.006531392918573,
                                 0.132162521859241,  0.162897834626554,  1.497498623392848,
                                 2.474625653375880,  0.033430003079897,  0.053281022699056,
                                 0.109014945335631,  0.138304927472457, -0.106755409359887,
                                -0.144480098890337, -0.023741233601018, -0.017352723600471,
                                -0.002234375155657, -0.001393978494386, -0.243022509956842,
                                -0.153249759911486,  0.008515351649315,  0.005243791588594,
                                -0.012068998812081, -0.006987217657977, -0.143558959884823,
                                -0.077107504692447,  0.069710415465437,  0.033430003079897,
                                 3.395594910542604,  1.409393007079869,  0.046473610310292,
                                 0.022286668719931,  0.059816233285344,  0.032128126955186,
                                 0.061685993928415,  0.035712445807440,  0.008444390385572,
                                 0.005200093325356, -0.245635785902011, -0.176895639871328,
                                 0.005243791588594,  0.006172832267994, -0.006987217657977,
                                -0.008883786114476, -0.077107504692447, -0.107060499760845,
                                 0.033430003079897,  0.053281022699056,  1.409393007079869,
                                 2.375861213692788,  0.022286668719931,  0.035520681799371,
                                 0.032128126955186,  0.044608541567018,  0.035712445807440,
                                 0.045406017918435,  0.005200093325356,  0.006121391999095,
                                 0.860839736786612,  0.542844706065471, -0.003153652116547,
                                -0.002152103687203, -0.001635740087389,  0.003048083298650,
                                 0.227134148978855,  0.127868110920420,  0.188550664006585,
                                 0.109014945335631,  0.046473610310292,  0.022286668719931,
                                 3.376553209052437,  1.406652835613155,  0.057748202275101,
                                 0.024253158327630, -0.019417074406980, -0.015841461379022,
                                 0.002696605667332,  0.000237950372488,  0.870096540928703,
                                 0.626603667670851, -0.002152103687203, -0.002194867512680,
                                 0.003048083298650, -0.002190511077071,  0.127868110920420,
                                 0.167526249594067,  0.109014945335631,  0.138304927472457,
                                 0.022286668719931,  0.035520681799371,  1.406652835613155,
                                 2.359371547148832,  0.024253158327630,  0.045106397696382,
                                -0.015841461379022, -0.012848981469989,  0.000237950372488,
                                 0.002413415888344, -0.568552639658183, -0.358528745094978,
                                 0.018909908341683,  0.012137417241391,  0.179648707563497,
                                 0.090109626923777, -0.054024950863989, -0.035441676819435,
                                -0.194708338463578, -0.106755409359887,  0.059816233285344,
                                 0.032128126955186,  0.057748202275101,  0.024253158327630,
                                 3.347245798663011,  1.390603006522073,  0.143944795876198,
                                 0.076336778611286, -0.003588407973325, -0.002104289519202,
                                -0.574666414621026, -0.413848425031606,  0.012137417241391,
                                 0.013722104243975,  0.090109626923777,  0.135771991486161,
                                -0.035441676819435, -0.038303715460235, -0.106755409359887,
                                -0.144480098890337,  0.032128126955186,  0.044608541567018,
                                 0.024253158327630,  0.045106397696382,  1.390603006522073,
                                 2.337880746200838,  0.076336778611286,  0.107515875754190,
                                -0.002104289519202, -0.002724975694288, -0.638830010134786,
                                -0.402845586998481,  0.129473548473349,  0.063092274290374,
                                -0.004680364934214, -0.003150099278026, -0.235167390362799,
                                -0.127453570444064, -0.026906696991985, -0.023741233601018,
                                 0.061685993928415,  0.035712445807440, -0.019417074406980,
                                -0.015841461379022,  0.143944795876198,  0.076336778611286,
                                 3.210758531294226,  1.321560662368604,  0.087540969205506,
                                 0.042893109624429, -0.645699493537101, -0.465003194279692,
                                 0.063092274290374,  0.098095422808380, -0.003150099278026,
                                -0.003290254167836, -0.127453570444064, -0.174809396154466,
                                -0.023741233601018, -0.017352723600471,  0.035712445807440,
                                 0.045406017918435, -0.015841461379022, -0.012848981469989,
                                 0.076336778611286,  0.107515875754190,  1.321560662368604,
                                 2.234899001354447,  0.042893109624429,  0.066255772489816,
                                -0.106234788203205, -0.066991554771120,  0.000626945753456,
                                 0.000425509377579, -0.126434960277506, -0.061029978206855,
                                -0.023114306656439, -0.015030976089177, -0.002317196933221,
                                -0.002234375155657,  0.008444390385572,  0.005200093325356,
                                 0.002696605667332,  0.000237950372488, -0.003588407973325,
                                -0.002104289519202,  0.087540969205506,  0.042893109624429,
                                 3.003262352957049,  1.213893577175685, -0.107377154877801,
                                -0.077328107750752,  0.000425509377579,  0.000439442678647,
                                -0.061029978206855, -0.095965596856573, -0.015030976089177,
                                -0.016654466479835, -0.002234375155657, -0.001393978494386,
                                 0.005200093325356,  0.006121391999095,  0.000237950372488,
                                 0.002413415888344, -0.002104289519202, -0.002724975694288,
                                 0.042893109624429,  0.066255772489816,  1.213893577175685,
                                 2.079255497562280};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 20, 20, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeGSForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(4, 0);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 4.797350021933383,  3.463727426618309, -0.071026043746404,
                                -0.077589592373335,  0.082867945336992,  0.090525809412531,
                                 0.904687324255993,  0.988289886523487,  0.856111140556533,
                                 0.935224755854651, -0.161125057537190, -0.176014696525649,
                                 0.570740760371022,  0.623483170569768, -0.376953051773330,
                                -0.411787452718120, -0.423547276166848, -0.462687470330712,
                                -0.070434160048517, -0.076943012436891,  3.463727426618309,
                                 3.665666692150181, -0.022116728405789, -0.027426214780640,
                                 0.025804166245101,  0.031998883048554,  0.281709677004821,
                                 0.349338743306027,  0.266583587964770,  0.330581386467709,
                                -0.050172569792015, -0.062217324821528,  0.177722391976513,
                                 0.220387590978474, -0.117379032085342, -0.145557809710845,
                                -0.131887960808293, -0.163549846692612, -0.021932422335741,
                                -0.027197662990802, -0.071026043746404, -0.022116728405789,
                                 3.474587590985533,  2.578487920480574,  0.028293520891176,
                                 0.024110587268697, -0.005498015009990, -0.005463660747301,
                                 0.000116411567457, -0.000330286643014,  0.003245640265673,
                                 0.003122228035217, -0.001264469336186, -0.001271048735608,
                                 0.007355338513117,  0.007215635648191,  0.044390197714380,
                                 0.038123159399283,  0.000250690744247,  0.000251637254066,
                                -0.077589592373335, -0.027426214780640,  2.578487920480574,
                                 2.698654718918641,  0.024110587268697,  0.026999661286588,
                                -0.005463660747301, -0.006083479711474, -0.000330286643014,
                                -0.000315327441310,  0.003122228035217,  0.003486333143956,
                                -0.001271048735608, -0.001397268533830,  0.007215635648191,
                                 0.008086087322139,  0.038123159399283,  0.042663959960894,
                                 0.000251637254066,  0.000278274549525,  0.082867945336992,
                                 0.025804166245101,  0.028293520891176,  0.024110587268697,
                                 3.538517702935191,  2.634101679475617,  0.046681675215264,
                                 0.041345610443234,  0.003150327847346,  0.002804808707416,
                                -0.004467667101000, -0.004175930646790,  0.000585454079810,
                                 0.001679336657875,  0.062359854241753,  0.054356595056153,
                                -0.001863616340291, -0.001863901956766, -0.043175186795051,
                                -0.036903561075787,  0.090525809412531,  0.031998883048554,
                                 0.024110587268697,  0.026999661286588,  2.634101679475617,
                                 2.760958469765402,  0.041345610443234,  0.046263673617302,
                                 0.002804808707416,  0.003087569642281, -0.004175930646790,
                                -0.004669837995675,  0.001679336657875,  0.001853070620862,
                                 0.054356595056153,  0.060916607541699, -0.001863901956766,
                                -0.002062575147156, -0.036903561075787, -0.041315259923083,
                                 0.904687324255993,  0.281709677004821, -0.005498015009990,
                                -0.005463660747301,  0.046681675215264,  0.041345610443234,
                                 3.637350945516853,  2.726547037387453,  0.083551349692954,
                                 0.078826929644507, -0.051351798301188, -0.046290647090463,
                                 0.082995097181347,  0.076512139404940, -0.021237914966400,
                                -0.021004544790756, -0.084459405801862, -0.076453729855153,
                                -0.009048418043576, -0.008925313631502,  0.988289886523487,
                                 0.349338743306027, -0.005463660747301, -0.006083479711474,
                                 0.041345610443234,  0.046263673617302,  2.726547037387453,
                                 2.863921596644260,  0.078826929644507,  0.087752630956915,
                                -0.046290647090463, -0.051760481943523,  0.076512139404940,
                                 0.085348837430947, -0.021004544790756, -0.023283808588019,
                                -0.076453729855153, -0.085370254990487, -0.008925313631502,
                                -0.009974676460764,  0.856111140556533,  0.266583587964770,
                                 0.000116411567457, -0.000330286643014,  0.003150327847346,
                                 0.002804808707416,  0.083551349692954,  0.078826929644507,
                                 3.663928921153976,  2.748761951474151,  0.023741293549964,
                                 0.020243166278018,  0.069751278003412,  0.065123348278219,
                                -0.070295518973921, -0.063993662886393, -0.012391600331178,
                                -0.013869014274793, -0.001123442257539, -0.001297590655861,
                                 0.935224755854651,  0.330581386467709, -0.000330286643014,
                                -0.000315327441310,  0.002804808707416,  0.003087569642281,
                                 0.078826929644507,  0.087752630956915,  2.748761951474151,
                                 2.888869885803429,  0.020243166278018,  0.022784383405884,
                                 0.065123348278219,  0.072610168872129, -0.063993662886393,
                                -0.071464804729619, -0.013869014274793, -0.015278052885122,
                                -0.001297590655861, -0.001408476761562, -0.161125057537190,
                                -0.050172569792015,  0.003245640265673,  0.003122228035217,
                                -0.004467667101000, -0.004175930646790, -0.051351798301188,
                                -0.046290647090463,  0.023741293549964,  0.020243166278018,
                                 3.610384526879928,  2.696453358939132,  0.015827529033309,
                                 0.013495444185345,  0.021396582625496,  0.019287769621026,
                                 0.022834742960667,  0.021343645528039,  0.003218593263458,
                                 0.003096209468257, -0.176014696525649, -0.062217324821528,
                                 0.003122228035217,  0.003486333143956, -0.004175930646790,
                                -0.004669837995675, -0.046290647090463, -0.051760481943523,
                                 0.020243166278018,  0.022784383405884,  2.696453358939132,
                                 2.830779385136692,  0.013495444185345,  0.015189588937256,
                                 0.019287769621025,  0.021566867476469,  0.021343645528039,
                                 0.023868060866785,  0.003096209468257,  0.003457280367758,
                                 0.570740760371022,  0.177722391976513, -0.001264469336186,
                                -0.001271048735608,  0.000585454079810,  0.001679336657875,
                                 0.082995097181347,  0.076512139404940,  0.069751278003412,
                                 0.065123348278219,  0.015827529033309,  0.013495444185345,
                                 3.605802856151133,  2.694492494575635,  0.018642394410558,
                                 0.014843605216382, -0.008557433851926, -0.009283288262695,
                                 0.000604393501183,  0.000194627939497,  0.623483170569768,
                                 0.220387590978474, -0.001271048735608, -0.001397268533830,
                                 0.001679336657875,  0.001853070620862,  0.076512139404940,
                                 0.085348837430947,  0.065123348278219,  0.072610168872129,
                                 0.013495444185345,  0.015189588937256,  2.694492494575635,
                                 2.828361411743325,  0.014843605216382,  0.016789797150130,
                                -0.009283288262695, -0.010225537769775,  0.000194627939497,
                                 0.000258040944013, -0.376953051773330, -0.117379032085342,
                                 0.007355338513117,  0.007215635648191,  0.062359854241753,
                                 0.054356595056153, -0.021237914966400, -0.021004544790756,
                                -0.070295518973921, -0.063993662886393,  0.021396582625496,
                                 0.019287769621025,  0.018642394410558,  0.014843605216382,
                                 3.595229080833495,  2.684888023552452,  0.051197831480479,
                                 0.045861272830970, -0.001336883555298, -0.001261734785903,
                                -0.411787452718120, -0.145557809710845,  0.007215635648191,
                                 0.008086087322139,  0.054356595056153,  0.060916607541699,
                                -0.021004544790756, -0.023283808588019, -0.063993662886393,
                                -0.071464804729619,  0.019287769621026,  0.021566867476469,
                                 0.014843605216382,  0.016789797150130,  2.684888023552452,
                                 2.817742042944695,  0.045861272830970,  0.051260901404156,
                                -0.001261734785903, -0.001441838531401, -0.423547276166848,
                                -0.131887960808293,  0.044390197714380,  0.038123159399283,
                                -0.001863616340291, -0.001863901956766, -0.084459405801862,
                                -0.076453729855153, -0.012391600331178, -0.013869014274793,
                                 0.022834742960667,  0.021343645528039, -0.008557433851926,
                                -0.009283288262695,  0.051197831480479,  0.045861272830970,
                                 3.547678232530579,  2.643263613007064,  0.030083402115111,
                                 0.025907226381350, -0.462687470330712, -0.163549846692612,
                                 0.038123159399283,  0.042663959960894, -0.001863901956766,
                                -0.002062575147156, -0.076453729855153, -0.085370254990487,
                                -0.013869014274793, -0.015278052885122,  0.021343645528039,
                                 0.023868060866785, -0.009283288262695, -0.010225537769775,
                                 0.045861272830970,  0.051260901404156,  2.643263613007064,
                                 2.771096973206129,  0.025907226381350,  0.028986485302729,
                                -0.070434160048517, -0.021932422335741,  0.000250690744247,
                                 0.000251637254066, -0.043175186795051, -0.036903561075787,
                                -0.009048418043576, -0.008925313631502, -0.001123442257539,
                                -0.001297590655861,  0.003218593263458,  0.003096209468257,
                                 0.000604393501183,  0.000194627939497, -0.001336883555298,
                                -0.001261734785903,  0.030083402115111,  0.025907226381350,
                                 3.474583395251088,  2.578483708904679, -0.076943012436891,
                                -0.027197662990802,  0.000251637254066,  0.000278274549525,
                                -0.036903561075787, -0.041315259923083, -0.008925313631502,
                                -0.009974676460764, -0.001297590655861, -0.001408476761562,
                                 0.003096209468257,  0.003457280367758,  0.000194627939497,
                                 0.000258040944013, -0.001261734785903, -0.001441838531401,
                                 0.025907226381350,  0.028986485302729,  2.578483708904679,
                                 2.698650061522470};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 20, 20, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputePGForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(1, 4);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 5.389681097734912,  4.421159622196003,  0.059837391701642,
                                 0.068258249204655,  0.021759051527870,  0.024821181528965,
                                 0.222336685294364,  0.290433866902630,  0.430679665737998,
                                 0.446225123300809,  0.077022044002110, -0.389908431910521,
                                 0.482606780010918,  0.097149143391863,  0.873711926412961,
                                 1.079034672401860,  0.816827806274688,  0.628009432227169,
                                 0.818077597784155,  1.129665180225594,  0.498389189261651,
                                 0.790563370120176, -0.005117449905936,  0.031356294791279,
                                 4.421159622196003,  4.214690910981703,  0.068258249204655,
                                 0.090090018433681,  0.024821181528965,  0.032760006703157,
                                 0.145900616547717,  0.237189664341569,  0.262083222910646,
                                 0.356157257250076, -0.036021596993284, -0.353260122321757,
                                 0.222584887706907,  0.041471259877448,  0.562352279752248,
                                 0.876796746247892,  0.458542690034919,  0.481705303810894,
                                 0.547604359618947,  0.926901279309253,  0.351673493885191,
                                 0.655540173950692,  0.003355155669618,  0.028309182580617,
                                 0.059837391701642,  0.068258249204655,  5.466744405229450,
                                 4.509067973444423,  0.039891594467762,  0.045505499469770,
                                -0.111974335441718, -0.058655747196055,  0.091433974921624,
                                 0.023828269001504,  0.504096402090611, -0.301987972276131,
                                -0.250854065863873, -1.113856056951764, -0.746612648482098,
                                -0.693467498271177, -0.167236043909248, -0.742570704634509,
                                -0.210040167537755,  0.125828321781721, -0.467329205154963,
                                -0.121788930452130, -0.111041215979704, -0.058166949302755,
                                 0.068258249204655,  0.090090018433681,  4.509067973444423,
                                 4.330715934722049,  0.045505499469770,  0.060060012289120,
                                -0.058017534225752, -0.041681066836701,  0.043127548575965,
                                 0.012670582580972,  0.161295106455057, -0.314829843749987,
                                -0.303353504730818, -0.965483306404032, -0.440204559963981,
                                -0.546324541434752, -0.202235669820545, -0.643655537602688,
                                -0.067206294356273,  0.131179101562495, -0.220429692721598,
                                -0.064760755413859, -0.057534054773870, -0.041333724613062,
                                 0.021759051527870,  0.024821181528965,  0.039891594467762,
                                 0.045505499469770,  5.371548554795020,  4.400475304255199,
                                -0.096168426243619, -0.084413084300438, -0.815100436900435,
                                -0.956466876511754, -0.602628983064004, -1.003941518911791,
                                 0.816827806274688,  0.628009432227169,  0.582474617608641,
                                 0.719356448267906, -0.198083058551321, -0.426192050130778,
                                -1.024159764567550, -1.032496034181070,  0.116607678496203,
                                 0.281704146129161,  0.243034971542682,  0.301276292899476,
                                 0.024821181528965,  0.032760006703157,  0.045505499469770,
                                 0.060060012289120,  4.400475304255199,  4.187390905395738,
                                -0.055834652537456, -0.066011602128360, -0.515771861400197,
                                -0.773432033979977, -0.433703137127634, -0.835283334118496,
                                 0.458542690034919,  0.481705303810893,  0.374901519834831,
                                 0.584531164165262, -0.159534020655526, -0.359949826631629,
                                -0.618183400837770, -0.821529619963409,  0.099352341791599,
                                 0.239247829387702,  0.156625069843993,  0.244894346393201,
                                 0.222336685294364,  0.145900616547717, -0.111974335441718,
                                -0.058017534225752, -0.096168426243619, -0.055834652537456,
                                 3.003272845956699,  1.213900698796220,  0.083064703295064,
                                 0.039855058707057, -0.013921681609226, -0.009215874368535,
                                 0.001578609714113, -0.000658448989035,  0.008515351649315,
                                 0.005243791588594, -0.003153652116547, -0.002152103687203,
                                 0.018909908341683,  0.012137417241391,  0.129473548473349,
                                 0.063092274290374,  0.000626945753456,  0.000425509377579,
                                 0.290433866902630,  0.237189664341569, -0.058655747196055,
                                -0.041681066836701, -0.084413084300438, -0.066011602128360,
                                 1.213900698796220,  2.079262852380217,  0.039855058707057,
                                 0.063118240620152, -0.009215874368535, -0.009931928773966,
                                -0.000658448989035,  0.001680016871824,  0.005243791588594,
                                 0.006172832267994, -0.002152103687203, -0.002194867512680,
                                 0.012137417241391,  0.013722104243975,  0.063092274290374,
                                 0.098095422808380,  0.000425509377579,  0.000439442678647,
                                 0.430679665737998,  0.262083222910646,  0.091433974921624,
                                 0.043127548575965, -0.815100436900435, -0.515771861400197,
                                 0.083064703295064,  0.039855058707057,  3.187752389649002,
                                 1.306076478719369,  0.132599269407999,  0.068705352967274,
                                 0.008887509030065,  0.004679246004160, -0.012068998812081,
                                -0.006987217657977, -0.001635740087389,  0.003048083298650,
                                 0.179648707563497,  0.090109626923777, -0.004680364934214,
                                -0.003150099278026, -0.126434960277506, -0.061029978206855,
                                 0.446225123300809,  0.356157257250076,  0.023828269001504,
                                 0.012670582580972, -0.956466876511754, -0.773432033979977,
                                 0.039855058707057,  0.063118240620152,  1.306076478719369,
                                 2.218725892099505,  0.068705352967274,  0.099538382672895,
                                 0.004679246004160,  0.006531392918573, -0.006987217657977,
                                -0.008883786114476,  0.003048083298650, -0.002190511077071,
                                 0.090109626923777,  0.135771991486161, -0.003150099278026,
                                -0.003290254167836, -0.061029978206855, -0.095965596856573,
                                 0.077022044002110, -0.036021596993284,  0.504096402090611,
                                 0.161295106455057, -0.602628983064004, -0.433703137127634,
                                -0.013921681609226, -0.009215874368535,  0.132599269407999,
                                 0.068705352967274,  3.454395284543255,  1.460895665547285,
                                 0.223480122686521,  0.132162521859241, -0.143558959884823,
                                -0.077107504692447,  0.227134148978855,  0.127868110920420,
                                -0.054024950863989, -0.035441676819435, -0.235167390362799,
                                -0.127453570444064, -0.023114306656439, -0.015030976089177,
                                -0.389908431910521, -0.353260122321757, -0.301987972276131,
                                -0.314829843749987, -1.003941518911791, -0.835283334118496,
                                -0.009215874368535, -0.009931928773966,  0.068705352967274,
                                 0.099538382672895,  1.460895665547285,  2.413849781863635,
                                 0.132162521859241,  0.162897834626554, -0.077107504692447,
                                -0.107060499760845,  0.127868110920420,  0.167526249594067,
                                -0.035441676819435, -0.038303715460235, -0.127453570444064,
                                -0.174809396154466, -0.015030976089177, -0.016654466479835,
                                 0.482606780010918,  0.222584887706907, -0.250854065863873,
                                -0.303353504730818,  0.816827806274688,  0.458542690034919,
                                 0.001578609714113, -0.000658448989035,  0.008887509030065,
                                 0.004679246004160,  0.223480122686521,  0.132162521859241,
                                 3.533678762391258,  1.497498623392848,  0.069710415465437,
                                 0.033430003079897,  0.188550664006585,  0.109014945335631,
                                -0.194708338463578, -0.106755409359887, -0.026906696991985,
                                -0.023741233601018, -0.002317196933221, -0.002234375155657,
                                 0.097149143391863,  0.041471259877448, -1.113856056951764,
                                -0.965483306404032,  0.628009432227169,  0.481705303810893,
                                -0.000658448989035,  0.001680016871824,  0.004679246004160,
                                 0.006531392918573,  0.132162521859241,  0.162897834626554,
                                 1.497498623392848,  2.474625653375880,  0.033430003079897,
                                 0.053281022699056,  0.109014945335631,  0.138304927472457,
                                -0.106755409359887, -0.144480098890337, -0.023741233601018,
                                -0.017352723600471, -0.002234375155657, -0.001393978494386,
                                 0.873711926412961,  0.562352279752248, -0.746612648482098,
                                -0.440204559963981,  0.582474617608641,  0.374901519834831,
                                 0.008515351649315,  0.005243791588594, -0.012068998812081,
                                -0.006987217657977, -0.143558959884823, -0.077107504692447,
                                 0.069710415465437,  0.033430003079897,  3.395594910542604,
                                 1.409393007079869,  0.046473610310292,  0.022286668719931,
                                 0.059816233285344,  0.032128126955186,  0.061685993928415,
                                 0.035712445807440,  0.008444390385572,  0.005200093325356,
                                 1.079034672401860,  0.876796746247892, -0.693467498271177,
                                -0.546324541434752,  0.719356448267906,  0.584531164165262,
                                 0.005243791588594,  0.006172832267994, -0.006987217657977,
                                -0.008883786114476, -0.077107504692447, -0.107060499760845,
                                 0.033430003079897,  0.053281022699056,  1.409393007079869,
                                 2.375861213692788,  0.022286668719931,  0.035520681799371,
                                 0.032128126955186,  0.044608541567018,  0.035712445807440,
                                 0.045406017918435,  0.005200093325356,  0.006121391999095,
                                 0.816827806274688,  0.458542690034919, -0.167236043909248,
                                -0.202235669820545, -0.198083058551321, -0.159534020655526,
                                -0.003153652116547, -0.002152103687203, -0.001635740087389,
                                 0.003048083298650,  0.227134148978855,  0.127868110920420,
                                 0.188550664006585,  0.109014945335631,  0.046473610310292,
                                 0.022286668719931,  3.376553209052437,  1.406652835613155,
                                 0.057748202275101,  0.024253158327630, -0.019417074406980,
                                -0.015841461379022,  0.002696605667332,  0.000237950372488,
                                 0.628009432227169,  0.481705303810894, -0.742570704634509,
                                -0.643655537602688, -0.426192050130778, -0.359949826631629,
                                -0.002152103687203, -0.002194867512680,  0.003048083298650,
                                -0.002190511077071,  0.127868110920420,  0.167526249594067,
                                 0.109014945335631,  0.138304927472457,  0.022286668719931,
                                 0.035520681799371,  1.406652835613155,  2.359371547148832,
                                 0.024253158327630,  0.045106397696382, -0.015841461379022,
                                -0.012848981469989,  0.000237950372488,  0.002413415888344,
                                 0.818077597784155,  0.547604359618947, -0.210040167537755,
                                -0.067206294356273, -1.024159764567550, -0.618183400837770,
                                 0.018909908341683,  0.012137417241391,  0.179648707563497,
                                 0.090109626923777, -0.054024950863989, -0.035441676819435,
                                -0.194708338463578, -0.106755409359887,  0.059816233285344,
                                 0.032128126955186,  0.057748202275101,  0.024253158327630,
                                 3.347245798663011,  1.390603006522073,  0.143944795876198,
                                 0.076336778611286, -0.003588407973325, -0.002104289519202,
                                 1.129665180225594,  0.926901279309253,  0.125828321781721,
                                 0.131179101562495, -1.032496034181070, -0.821529619963409,
                                 0.012137417241391,  0.013722104243975,  0.090109626923777,
                                 0.135771991486161, -0.035441676819435, -0.038303715460235,
                                -0.106755409359887, -0.144480098890337,  0.032128126955186,
                                 0.044608541567018,  0.024253158327630,  0.045106397696382,
                                 1.390603006522073,  2.337880746200838,  0.076336778611286,
                                 0.107515875754190, -0.002104289519202, -0.002724975694288,
                                 0.498389189261651,  0.351673493885191, -0.467329205154963,
                                -0.220429692721598,  0.116607678496203,  0.099352341791599,
                                 0.129473548473349,  0.063092274290374, -0.004680364934214,
                                -0.003150099278026, -0.235167390362799, -0.127453570444064,
                                -0.026906696991985, -0.023741233601018,  0.061685993928415,
                                 0.035712445807440, -0.019417074406980, -0.015841461379022,
                                 0.143944795876198,  0.076336778611286,  3.210758531294226,
                                 1.321560662368604,  0.087540969205506,  0.042893109624429,
                                 0.790563370120176,  0.655540173950692, -0.121788930452130,
                                -0.064760755413859,  0.281704146129161,  0.239247829387702,
                                 0.063092274290374,  0.098095422808380, -0.003150099278026,
                                -0.003290254167836, -0.127453570444064, -0.174809396154466,
                                -0.023741233601018, -0.017352723600471,  0.035712445807440,
                                 0.045406017918435, -0.015841461379022, -0.012848981469989,
                                 0.076336778611286,  0.107515875754190,  1.321560662368604,
                                 2.234899001354447,  0.042893109624429,  0.066255772489816,
                                -0.005117449905936,  0.003355155669618, -0.111041215979704,
                                -0.057534054773870,  0.243034971542682,  0.156625069843993,
                                 0.000626945753456,  0.000425509377579, -0.126434960277506,
                                -0.061029978206855, -0.023114306656439, -0.015030976089177,
                                -0.002317196933221, -0.002234375155657,  0.008444390385572,
                                 0.005200093325356,  0.002696605667332,  0.000237950372488,
                                -0.003588407973325, -0.002104289519202,  0.087540969205506,
                                 0.042893109624429,  3.003262352957049,  1.213893577175685,
                                 0.031356294791279,  0.028309182580617, -0.058166949302755,
                                -0.041333724613062,  0.301276292899476,  0.244894346393201,
                                 0.000425509377579,  0.000439442678647, -0.061029978206855,
                                -0.095965596856573, -0.015030976089177, -0.016654466479835,
                                -0.002234375155657, -0.001393978494386,  0.005200093325356,
                                 0.006121391999095,  0.000237950372488,  0.002413415888344,
                                -0.002104289519202, -0.002724975694288,  0.042893109624429,
                                 0.066255772489816,  1.213893577175685,  2.079255497562280};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 24, 24, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeGPForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(4, 1);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.907390315716412,  2.469876297996402,  0.152991511314216,
                                 0.155932067578619,  0.055633276841533,  0.056702570028589,
                                -0.197003119004198, -0.230767446379459, -0.363968888964216,
                                -0.385415045897144,  0.006106442314894,  0.179709486805977,
                                -0.346785110020393, -0.218625578612031, -0.764719219026149,
                                -0.873876237129028, -0.657214147791102, -0.615422972705952,
                                -0.734114310510155, -0.881402283456665, -0.462750961936614,
                                -0.591145142401602, -0.001231860557726, -0.014825175461233,
                                 2.469876297996402,  3.000285580452371,  0.155932067578619,
                                 0.304609876553509,  0.056702570028589,  0.110767227837640,
                                -0.068532658008046, -0.099084829723335, -0.109842910056506,
                                -0.150689494970811,  0.072830398267474,  0.139535833331014,
                                -0.043769982233096, -0.026061706063758, -0.257050497387505,
                                -0.367297954521371, -0.165349949394635, -0.208422716847129,
                                -0.264177510243983, -0.386208615125420, -0.181092184829744,
                                -0.271562649885976, -0.005911971211089, -0.011202744326776,
                                 0.152991511314216,  0.155932067578619,  4.104424837863508,
                                 2.670697900180988,  0.101994340876144,  0.103954711719079,
                                 0.085935308781093,  0.069842687338108, -0.066523339673987,
                                -0.044290845313939, -0.301070508426720, -0.014791595940767,
                                 0.341437730696159,  0.676517461860668,  0.618824385081803,
                                 0.625746259290904,  0.227625153797439,  0.451011641240445,
                                 0.125446045177800,  0.006163164975319,  0.340008180555934,
                                 0.226375431604579,  0.085219181207918,  0.069260664943625,
                                 0.155932067578619,  0.304609876553509,  2.670697900180988,
                                 3.392586179044012,  0.103954711719079,  0.203073251035673,
                                 0.017265706463292,  0.018847562645706, -0.009360161165593,
                                -0.006859583531231,  0.033713009581937,  0.115781811731348,
                                 0.232100542333169,  0.390445062821873,  0.174651594408825,
                                 0.232841817875433,  0.154733694888779,  0.260296708547916,
                                -0.014047087325807, -0.048242421554728,  0.047840823735254,
                                 0.035060093604070,  0.017121825576099,  0.018690499623659,
                                 0.055633276841533,  0.056702570028589,  0.101994340876144,
                                 0.103954711719079,  3.861029251681802,  2.422624156305912,
                                 0.078964253500624,  0.078001060826159,  0.705812720266498,
                                 0.788690093733876,  0.566817084270659,  0.740208886553350,
                                -0.657214147791102, -0.615422972705952, -0.509812812684100,
                                -0.582584158086018,  0.200893346472192,  0.294226898642928,
                                 0.861181154205649,  0.901364626534033, -0.122932645287081,
                                -0.189516302492639, -0.212888130627370, -0.243677761311655,
                                 0.056702570028589,  0.110767227837640,  0.103954711719079,
                                 0.203073251035673,  2.422624156305912,  2.907979557254338,
                                 0.021529587511976,  0.028251221447210,  0.229926977318425,
                                 0.324871607308444,  0.228423991895651,  0.345384415480290,
                                -0.165349949394635, -0.208422716847129, -0.171366998258336,
                                -0.244865303014247,  0.094021642262433,  0.147623891308849,
                                 0.255570603158949,  0.348192853739459, -0.061415074171898,
                                -0.097824778860197, -0.071724197687624, -0.102568773121481,
                                -0.197003119004198, -0.068532658008046,  0.085935308781093,
                                 0.017265706463292,  0.078964253500624,  0.021529587511976,
                                 3.474587590985533,  2.578487920480574,  0.028293520891176,
                                 0.024110587268697, -0.005498015009990, -0.005463660747301,
                                 0.000116411567457, -0.000330286643014,  0.003245640265673,
                                 0.003122228035217, -0.001264469336186, -0.001271048735608,
                                 0.007355338513117,  0.007215635648191,  0.044390197714380,
                                 0.038123159399283,  0.000250690744247,  0.000251637254066,
                                -0.230767446379459, -0.099084829723335,  0.069842687338108,
                                 0.018847562645706,  0.078001060826159,  0.028251221447210,
                                 2.578487920480574,  2.698654718918641,  0.024110587268697,
                                 0.026999661286588, -0.005463660747301, -0.006083479711474,
                                -0.000330286643014, -0.000315327441310,  0.003122228035217,
                                 0.003486333143956, -0.001271048735608, -0.001397268533830,
                                 0.007215635648191,  0.008086087322139,  0.038123159399283,
                                 0.042663959960894,  0.000251637254066,  0.000278274549525,
                                -0.363968888964216, -0.109842910056506, -0.066523339673987,
                                -0.009360161165593,  0.705812720266498,  0.229926977318425,
                                 0.028293520891176,  0.024110587268697,  3.538517702935191,
                                 2.634101679475617,  0.046681675215264,  0.041345610443234,
                                 0.003150327847346,  0.002804808707416, -0.004467667101000,
                                -0.004175930646790,  0.000585454079810,  0.001679336657875,
                                 0.062359854241753,  0.054356595056153, -0.001863616340291,
                                -0.001863901956766, -0.043175186795051, -0.036903561075787,
                                -0.385415045897144, -0.150689494970811, -0.044290845313939,
                                -0.006859583531231,  0.788690093733876,  0.324871607308444,
                                 0.024110587268697,  0.026999661286588,  2.634101679475617,
                                 2.760958469765402,  0.041345610443234,  0.046263673617302,
                                 0.002804808707416,  0.003087569642281, -0.004175930646790,
                                -0.004669837995675,  0.001679336657875,  0.001853070620862,
                                 0.054356595056153,  0.060916607541699, -0.001863901956766,
                                -0.002062575147156, -0.036903561075787, -0.041315259923083,
                                 0.006106442314894,  0.072830398267474, -0.301070508426720,
                                 0.033713009581937,  0.566817084270659,  0.228423991895651,
                                -0.005498015009990, -0.005463660747301,  0.046681675215264,
                                 0.041345610443234,  3.637350945516853,  2.726547037387453,
                                 0.083551349692954,  0.078826929644507, -0.051351798301188,
                                -0.046290647090463,  0.082995097181347,  0.076512139404940,
                                -0.021237914966400, -0.021004544790756, -0.084459405801862,
                                -0.076453729855153, -0.009048418043576, -0.008925313631502,
                                 0.179709486805977,  0.139535833331014, -0.014791595940767,
                                 0.115781811731348,  0.740208886553350,  0.345384415480290,
                                -0.005463660747301, -0.006083479711474,  0.041345610443234,
                                 0.046263673617302,  2.726547037387453,  2.863921596644260,
                                 0.078826929644507,  0.087752630956915, -0.046290647090463,
                                -0.051760481943523,  0.076512139404940,  0.085348837430947,
                                -0.021004544790756, -0.023283808588019, -0.076453729855153,
                                -0.085370254990487, -0.008925313631502, -0.009974676460764,
                                -0.346785110020393, -0.043769982233096,  0.341437730696159,
                                 0.232100542333169, -0.657214147791102, -0.165349949394635,
                                 0.000116411567457, -0.000330286643014,  0.003150327847346,
                                 0.002804808707416,  0.083551349692954,  0.078826929644507,
                                 3.663928921153976,  2.748761951474151,  0.023741293549964,
                                 0.020243166278018,  0.069751278003412,  0.065123348278219,
                                -0.070295518973921, -0.063993662886393, -0.012391600331178,
                                -0.013869014274793, -0.001123442257539, -0.001297590655861,
                                -0.218625578612031, -0.026061706063758,  0.676517461860668,
                                 0.390445062821873, -0.615422972705952, -0.208422716847129,
                                -0.000330286643014, -0.000315327441310,  0.002804808707416,
                                 0.003087569642281,  0.078826929644507,  0.087752630956915,
                                 2.748761951474151,  2.888869885803429,  0.020243166278018,
                                 0.022784383405884,  0.065123348278219,  0.072610168872129,
                                -0.063993662886393, -0.071464804729619, -0.013869014274793,
                                -0.015278052885122, -0.001297590655861, -0.001408476761562,
                                -0.764719219026149, -0.257050497387505,  0.618824385081803,
                                 0.174651594408825, -0.509812812684100, -0.171366998258336,
                                 0.003245640265673,  0.003122228035217, -0.004467667101000,
                                -0.004175930646790, -0.051351798301188, -0.046290647090463,
                                 0.023741293549964,  0.020243166278018,  3.610384526879928,
                                 2.696453358939132,  0.015827529033309,  0.013495444185345,
                                 0.021396582625496,  0.019287769621026,  0.022834742960667,
                                 0.021343645528039,  0.003218593263458,  0.003096209468257,
                                -0.873876237129028, -0.367297954521371,  0.625746259290904,
                                 0.232841817875433, -0.582584158086018, -0.244865303014247,
                                 0.003122228035217,  0.003486333143956, -0.004175930646790,
                                -0.004669837995675, -0.046290647090463, -0.051760481943523,
                                 0.020243166278018,  0.022784383405884,  2.696453358939132,
                                 2.830779385136692,  0.013495444185345,  0.015189588937256,
                                 0.019287769621025,  0.021566867476469,  0.021343645528039,
                                 0.023868060866785,  0.003096209468257,  0.003457280367758,
                                -0.657214147791102, -0.165349949394635,  0.227625153797439,
                                 0.154733694888779,  0.200893346472192,  0.094021642262433,
                                -0.001264469336186, -0.001271048735608,  0.000585454079810,
                                 0.001679336657875,  0.082995097181347,  0.076512139404940,
                                 0.069751278003412,  0.065123348278219,  0.015827529033309,
                                 0.013495444185345,  3.605802856151133,  2.694492494575635,
                                 0.018642394410558,  0.014843605216382, -0.008557433851926,
                                -0.009283288262695,  0.000604393501183,  0.000194627939497,
                                -0.615422972705952, -0.208422716847129,  0.451011641240445,
                                 0.260296708547916,  0.294226898642928,  0.147623891308849,
                                -0.001271048735608, -0.001397268533830,  0.001679336657875,
                                 0.001853070620862,  0.076512139404940,  0.085348837430947,
                                 0.065123348278219,  0.072610168872129,  0.013495444185345,
                                 0.015189588937256,  2.694492494575635,  2.828361411743325,
                                 0.014843605216382,  0.016789797150130, -0.009283288262695,
                                -0.010225537769775,  0.000194627939497,  0.000258040944013,
                                -0.734114310510155, -0.264177510243983,  0.125446045177800,
                                -0.014047087325807,  0.861181154205649,  0.255570603158949,
                                 0.007355338513117,  0.007215635648191,  0.062359854241753,
                                 0.054356595056153, -0.021237914966400, -0.021004544790756,
                                -0.070295518973921, -0.063993662886393,  0.021396582625496,
                                 0.019287769621025,  0.018642394410558,  0.014843605216382,
                                 3.595229080833495,  2.684888023552452,  0.051197831480479,
                                 0.045861272830970, -0.001336883555298, -0.001261734785903,
                                -0.881402283456665, -0.386208615125420,  0.006163164975319,
                                -0.048242421554728,  0.901364626534033,  0.348192853739459,
                                 0.007215635648191,  0.008086087322139,  0.054356595056153,
                                 0.060916607541699, -0.021004544790756, -0.023283808588019,
                                -0.063993662886393, -0.071464804729619,  0.019287769621026,
                                 0.021566867476469,  0.014843605216382,  0.016789797150130,
                                 2.684888023552452,  2.817742042944695,  0.045861272830970,
                                 0.051260901404156, -0.001261734785903, -0.001441838531401,
                                -0.462750961936614, -0.181092184829744,  0.340008180555934,
                                 0.047840823735254, -0.122932645287081, -0.061415074171898,
                                 0.044390197714380,  0.038123159399283, -0.001863616340291,
                                -0.001863901956766, -0.084459405801862, -0.076453729855153,
                                -0.012391600331178, -0.013869014274793,  0.022834742960667,
                                 0.021343645528039, -0.008557433851926, -0.009283288262695,
                                 0.051197831480479,  0.045861272830970,  3.547678232530579,
                                 2.643263613007064,  0.030083402115111,  0.025907226381350,
                                -0.591145142401602, -0.271562649885976,  0.226375431604579,
                                 0.035060093604070, -0.189516302492639, -0.097824778860197,
                                 0.038123159399283,  0.042663959960894, -0.001863901956766,
                                -0.002062575147156, -0.076453729855153, -0.085370254990487,
                                -0.013869014274793, -0.015278052885122,  0.021343645528039,
                                 0.023868060866785, -0.009283288262695, -0.010225537769775,
                                 0.045861272830970,  0.051260901404156,  2.643263613007064,
                                 2.771096973206129,  0.025907226381350,  0.028986485302729,
                                -0.001231860557726, -0.005911971211089,  0.085219181207918,
                                 0.017121825576099, -0.212888130627370, -0.071724197687624,
                                 0.000250690744247,  0.000251637254066, -0.043175186795051,
                                -0.036903561075787, -0.009048418043576, -0.008925313631502,
                                -0.001123442257539, -0.001297590655861,  0.003218593263458,
                                 0.003096209468257,  0.000604393501183,  0.000194627939497,
                                -0.001336883555298, -0.001261734785903,  0.030083402115111,
                                 0.025907226381350,  3.474583395251088,  2.578483708904679,
                                -0.014825175461233, -0.011202744326776,  0.069260664943625,
                                 0.018690499623659, -0.243677761311655, -0.102568773121481,
                                 0.000251637254066,  0.000278274549525, -0.036903561075787,
                                -0.041315259923083, -0.008925313631502, -0.009974676460764,
                                -0.001297590655861, -0.001408476761562,  0.003096209468257,
                                 0.003457280367758,  0.000194627939497,  0.000258040944013,
                                -0.001261734785903, -0.001441838531401,  0.025907226381350,
                                 0.028986485302729,  2.578483708904679,  2.698650061522470};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 24, 24, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeDGForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(2, 4);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 4.421808648667628,  3.506299950695142,  0.044116585394124,
                                 0.047866613129848, -0.001316915371077,  0.002013659246585,
                                 0.051075823687660,  0.053453670625175, -0.002745282618823,
                                -0.003335681649018, -0.159178000176039, -0.229088674485392,
                                 0.280308415171983,  0.603760389787196,  0.004999974792371,
                                 0.402071177600859,  0.206667159494729, -0.159886808240781,
                                 1.046617507301348,  0.698815475185345, -0.399975169860451,
                                -0.566065530685361, -0.193223402252560, -0.064767215682437,
                                -0.545892836142161, -0.940516208346110, -0.340099811046303,
                                -0.538154990768791,  3.506299950695142,  3.454438074787293,
                                 0.047866613129848,  0.061292674094833,  0.002013659246585,
                                 0.005807780289902,  0.053453670625175,  0.066604724762238,
                                -0.003335681649018, -0.004606233887275, -0.124475651804931,
                                -0.230732452571095,  0.272808213994875,  0.627076406790304,
                                 0.093693876614890,  0.461858048021905,  0.028479683652075,
                                -0.191172615621801,  0.615232784597104,  0.611535384717131,
                                -0.322318233983322, -0.554369211423746, -0.090055656048231,
                                -0.049877168042704, -0.464898964666141, -0.966142243356829,
                                -0.280127264560101, -0.545224798432427,  0.044116585394124,
                                 0.047866613129848,  4.527086863812696,  3.620527095664100,
                                 0.063922540896472,  0.072700727888479,  0.047398494293154,
                                 0.054462355723841, -0.046546107366602, -0.047949795904296,
                                 0.311071128737756,  0.209678139112103,  0.401298846301015,
                                 0.105432863407356,  0.139799429191168,  0.235604910698969,
                                 0.533027898662788,  0.699942249014922, -0.182747164483221,
                                -0.693631152393580,  0.155217564733101, -0.206957348299187,
                                 0.290427292301607, -0.411720897291680,  0.468376799094124,
                                 0.185299185116057, -0.004308003951257,  0.022903664136614,
                                 0.047866613129848,  0.061292674094833,  3.620527095664100,
                                 3.600704683422691,  0.072700727888479,  0.096229946162625,
                                 0.054462355723841,  0.072585355729927, -0.047949795904296,
                                -0.059004438848235,  0.185755310593417,  0.181032647417521,
                                 0.188293149181568,  0.060451747165707,  0.079329610302813,
                                 0.288646811868866,  0.364968557130649,  0.740156505536247,
                                -0.250850194638600, -0.748353493074605, -0.016491802840606,
                                -0.221355478998855,  0.026696611058178, -0.519805184466898,
                                 0.259264551287108,  0.111120263240652,  0.007410333949169,
                                 0.022156044640788, -0.001316915371077,  0.002013659246585,
                                 0.063922540896472,  0.072700727888479,  4.524473246959378,
                                 3.614526031975203,  0.042615027264315,  0.048467151925653,
                                 0.000548714737949, -0.000839024686077, -0.175640642642093,
                                -0.082569880730805,  0.110766401884652,  0.040637774372884,
                                 0.384636398667601,  0.182508201378991, -0.318872391565857,
                                 0.435775119861854, -0.299963164361378,  0.673415248694319,
                                -0.212581594377238,  0.290516746574570, -0.160265166111499,
                                -0.076045083907913, -0.566139387410439, -0.207704180128075,
                                -0.174176970620075, -0.081881798391381,  0.002013659246585,
                                 0.005807780289902,  0.072700727888479,  0.096229946162625,
                                 3.614526031975203,  3.590051139109891,  0.048467151925653,
                                 0.064153297441750, -0.000839024686077, -0.002419908454125,
                                -0.091027053031260, -0.067984066785500,  0.052982495708830,
                                 0.031946351566656,  0.172200272829820,  0.184589978311493,
                                -0.046796187749984,  0.568896594249222,  0.061179035364079,
                                 0.782935197456997, -0.031197458499989,  0.379264396166148,
                                -0.071750113679092, -0.076912490963121, -0.270799422511798,
                                -0.163281352451796, -0.090268494256001, -0.067417532895620,
                                 0.051075823687660,  0.053453670625175,  0.047398494293154,
                                 0.054462355723841,  0.042615027264315,  0.048467151925653,
                                 4.487588118568403,  3.575141799227565,  0.020964701975384,
                                 0.019735697889799, -0.131459829398568, -0.060653642662607,
                                -0.761122616862355, -0.225381840182091, -0.175013499358139,
                                 0.398263928543243,  0.155217564733101, -0.206957348299187,
                                -0.121831442988814, -0.462420768262387,  0.403679928051870,
                                 0.872406705930912, -0.450093290297665,  0.304384973190980,
                                 0.110992577014185,  0.065684230466872,  0.338815979104052,
                                 0.217392540083915,  0.053453670625175,  0.066604724762238,
                                 0.054462355723841,  0.072585355729927,  0.048467151925653,
                                 0.064153297441750,  3.575141799227565,  3.540216886981085,
                                 0.019735697889799,  0.022446768312149, -0.067686520636041,
                                -0.049787596503102, -0.373252129244892, -0.131217263215235,
                                 0.006924395060068,  0.499766346006067, -0.016491802840606,
                                -0.221355478998855, -0.167233463092400, -0.498902328716403,
                                 0.378711726164488,  0.924619404701959, -0.092511087634886,
                                 0.391067541779777,  0.075255467706765,  0.040522222190912,
                                 0.198073057286546,  0.186679296206805, -0.002745282618823,
                                -0.003335681649018, -0.046546107366602, -0.047949795904296,
                                 0.000548714737949, -0.000839024686077,  0.020964701975384,
                                 0.019735697889799,  4.416363838140298,  3.499684182091257,
                                 0.322981527809870,  0.533395285847287,  0.353888124884828,
                                 0.887129676735357, -0.193223402252560, -0.064767215682437,
                                 0.612967942591215,  0.663936126182618, -0.436090628042228,
                                -0.291173114660560, -0.881962567795840, -0.660114296337872,
                                -0.378226439675205,  0.273616199830693,  0.319545558846010,
                                 0.614670200267116, -0.117105891014033, -0.217390607437973,
                                -0.003335681649018, -0.004606233887275, -0.047949795904296,
                                -0.059004438848235, -0.000839024686077, -0.002419908454125,
                                 0.019735697889799,  0.022446768312149,  3.499684182091257,
                                 3.445302377577531,  0.272527343351523,  0.541740875036355,
                                 0.379655563965434,  0.927065327963727, -0.090055656048231,
                                -0.049877168042704,  0.431829561821753,  0.634652297821059,
                                -0.256346993582127, -0.254806410298804, -0.531244880855459,
                                -0.601508390541402, -0.084916507880768,  0.362934998070542,
                                 0.290228138426175,  0.635061974090067, -0.105797101491579,
                                -0.222169911374231, -0.159178000176039, -0.124475651804931,
                                 0.311071128737756,  0.185755310593417, -0.175640642642093,
                                -0.091027053031260, -0.131459829398568, -0.067686520636041,
                                 0.322981527809870,  0.272527343351523,  3.003272845956699,
                                 1.213900698796220,  0.083064703295064,  0.039855058707057,
                                -0.013921681609226, -0.009215874368535,  0.001578609714113,
                                -0.000658448989035,  0.008515351649315,  0.005243791588594,
                                -0.003153652116547, -0.002152103687203,  0.018909908341683,
                                 0.012137417241391,  0.129473548473349,  0.063092274290374,
                                 0.000626945753456,  0.000425509377579, -0.229088674485392,
                                -0.230732452571095,  0.209678139112103,  0.181032647417521,
                                -0.082569880730805, -0.067984066785500, -0.060653642662607,
                                -0.049787596503102,  0.533395285847287,  0.541740875036355,
                                 1.213900698796220,  2.079262852380217,  0.039855058707057,
                                 0.063118240620152, -0.009215874368535, -0.009931928773966,
                                -0.000658448989035,  0.001680016871824,  0.005243791588594,
                                 0.006172832267994, -0.002152103687203, -0.002194867512680,
                                 0.012137417241391,  0.013722104243975,  0.063092274290374,
                                 0.098095422808380,  0.000425509377579,  0.000439442678647,
                                 0.280308415171983,  0.272808213994875,  0.401298846301015,
                                 0.188293149181568,  0.110766401884652,  0.052982495708830,
                                -0.761122616862355, -0.373252129244892,  0.353888124884828,
                                 0.379655563965434,  0.083064703295064,  0.039855058707057,
                                 3.187752389649002,  1.306076478719369,  0.132599269407999,
                                 0.068705352967274,  0.008887509030065,  0.004679246004160,
                                -0.012068998812081, -0.006987217657977, -0.001635740087389,
                                 0.003048083298650,  0.179648707563497,  0.090109626923777,
                                -0.004680364934214, -0.003150099278026, -0.126434960277506,
                                -0.061029978206855,  0.603760389787196,  0.627076406790304,
                                 0.105432863407356,  0.060451747165707,  0.040637774372884,
                                 0.031946351566656, -0.225381840182091, -0.131217263215235,
                                 0.887129676735357,  0.927065327963727,  0.039855058707057,
                                 0.063118240620152,  1.306076478719369,  2.218725892099505,
                                 0.068705352967274,  0.099538382672895,  0.004679246004160,
                                 0.006531392918573, -0.006987217657977, -0.008883786114476,
                                 0.003048083298650, -0.002190511077071,  0.090109626923777,
                                 0.135771991486161, -0.003150099278026, -0.003290254167836,
                                -0.061029978206855, -0.095965596856573,  0.004999974792371,
                                 0.093693876614890,  0.139799429191168,  0.079329610302813,
                                 0.384636398667601,  0.172200272829820, -0.175013499358139,
                                 0.006924395060068, -0.193223402252560, -0.090055656048231,
                                -0.013921681609226, -0.009215874368535,  0.132599269407999,
                                 0.068705352967274,  3.454395284543255,  1.460895665547285,
                                 0.223480122686521,  0.132162521859241, -0.143558959884823,
                                -0.077107504692447,  0.227134148978855,  0.127868110920420,
                                -0.054024950863989, -0.035441676819435, -0.235167390362799,
                                -0.127453570444064, -0.023114306656439, -0.015030976089177,
                                 0.402071177600859,  0.461858048021905,  0.235604910698969,
                                 0.288646811868866,  0.182508201378991,  0.184589978311493,
                                 0.398263928543243,  0.499766346006067, -0.064767215682437,
                                -0.049877168042704, -0.009215874368535, -0.009931928773966,
                                 0.068705352967274,  0.099538382672895,  1.460895665547285,
                                 2.413849781863635,  0.132162521859241,  0.162897834626554,
                                -0.077107504692447, -0.107060499760845,  0.127868110920420,
                                 0.167526249594067, -0.035441676819435, -0.038303715460235,
                                -0.127453570444064, -0.174809396154466, -0.015030976089177,
                                -0.016654466479835,  0.206667159494729,  0.028479683652075,
                                 0.533027898662788,  0.364968557130649, -0.318872391565857,
                                -0.046796187749984,  0.155217564733101, -0.016491802840606,
                                 0.612967942591215,  0.431829561821753,  0.001578609714113,
                                -0.000658448989035,  0.008887509030065,  0.004679246004160,
                                 0.223480122686521,  0.132162521859241,  3.533678762391258,
                                 1.497498623392848,  0.069710415465437,  0.033430003079897,
                                 0.188550664006585,  0.109014945335631, -0.194708338463578,
                                -0.106755409359887, -0.026906696991985, -0.023741233601018,
                                -0.002317196933221, -0.002234375155657, -0.159886808240781,
                                -0.191172615621801,  0.699942249014922,  0.740156505536247,
                                 0.435775119861854,  0.568896594249222, -0.206957348299187,
                                -0.221355478998855,  0.663936126182618,  0.634652297821059,
                                -0.000658448989035,  0.001680016871824,  0.004679246004160,
                                 0.006531392918573,  0.132162521859241,  0.162897834626554,
                                 1.497498623392848,  2.474625653375880,  0.033430003079897,
                                 0.053281022699056,  0.109014945335631,  0.138304927472457,
                                -0.106755409359887, -0.144480098890337, -0.023741233601018,
                                -0.017352723600471, -0.002234375155657, -0.001393978494386,
                                 1.046617507301348,  0.615232784597104, -0.182747164483221,
                                -0.250850194638600, -0.299963164361378,  0.061179035364079,
                                -0.121831442988814, -0.167233463092400, -0.436090628042228,
                                -0.256346993582127,  0.008515351649315,  0.005243791588594,
                                -0.012068998812081, -0.006987217657977, -0.143558959884823,
                                -0.077107504692447,  0.069710415465437,  0.033430003079897,
                                 3.395594910542604,  1.409393007079869,  0.046473610310292,
                                 0.022286668719931,  0.059816233285344,  0.032128126955186,
                                 0.061685993928415,  0.035712445807440,  0.008444390385572,
                                 0.005200093325356,  0.698815475185345,  0.611535384717131,
                                -0.693631152393580, -0.748353493074605,  0.673415248694319,
                                 0.782935197456997, -0.462420768262387, -0.498902328716403,
                                -0.291173114660560, -0.254806410298804,  0.005243791588594,
                                 0.006172832267994, -0.006987217657977, -0.008883786114476,
                                -0.077107504692447, -0.107060499760845,  0.033430003079897,
                                 0.053281022699056,  1.409393007079869,  2.375861213692788,
                                 0.022286668719931,  0.035520681799371,  0.032128126955186,
                                 0.044608541567018,  0.035712445807440,  0.045406017918435,
                                 0.005200093325356,  0.006121391999095, -0.399975169860451,
                                -0.322318233983322,  0.155217564733101, -0.016491802840606,
                                -0.212581594377238, -0.031197458499989,  0.403679928051870,
                                 0.378711726164488, -0.881962567795840, -0.531244880855459,
                                -0.003153652116547, -0.002152103687203, -0.001635740087389,
                                 0.003048083298650,  0.227134148978855,  0.127868110920420,
                                 0.188550664006585,  0.109014945335631,  0.046473610310292,
                                 0.022286668719931,  3.376553209052437,  1.406652835613155,
                                 0.057748202275101,  0.024253158327630, -0.019417074406980,
                                -0.015841461379022,  0.002696605667332,  0.000237950372488,
                                -0.566065530685361, -0.554369211423746, -0.206957348299187,
                                -0.221355478998855,  0.290516746574570,  0.379264396166148,
                                 0.872406705930912,  0.924619404701959, -0.660114296337872,
                                -0.601508390541402, -0.002152103687203, -0.002194867512680,
                                 0.003048083298650, -0.002190511077071,  0.127868110920420,
                                 0.167526249594067,  0.109014945335631,  0.138304927472457,
                                 0.022286668719931,  0.035520681799371,  1.406652835613155,
                                 2.359371547148832,  0.024253158327630,  0.045106397696382,
                                -0.015841461379022, -0.012848981469989,  0.000237950372488,
                                 0.002413415888344, -0.193223402252560, -0.090055656048231,
                                 0.290427292301607,  0.026696611058178, -0.160265166111499,
                                -0.071750113679092, -0.450093290297665, -0.092511087634886,
                                -0.378226439675205, -0.084916507880768,  0.018909908341683,
                                 0.012137417241391,  0.179648707563497,  0.090109626923777,
                                -0.054024950863989, -0.035441676819435, -0.194708338463578,
                                -0.106755409359887,  0.059816233285344,  0.032128126955186,
                                 0.057748202275101,  0.024253158327630,  3.347245798663011,
                                 1.390603006522073,  0.143944795876198,  0.076336778611286,
                                -0.003588407973325, -0.002104289519202, -0.064767215682437,
                                -0.049877168042704, -0.411720897291680, -0.519805184466898,
                                -0.076045083907913, -0.076912490963121,  0.304384973190980,
                                 0.391067541779777,  0.273616199830693,  0.362934998070542,
                                 0.012137417241391,  0.013722104243975,  0.090109626923777,
                                 0.135771991486161, -0.035441676819435, -0.038303715460235,
                                -0.106755409359887, -0.144480098890337,  0.032128126955186,
                                 0.044608541567018,  0.024253158327630,  0.045106397696382,
                                 1.390603006522073,  2.337880746200838,  0.076336778611286,
                                 0.107515875754190, -0.002104289519202, -0.002724975694288,
                                -0.545892836142161, -0.464898964666141,  0.468376799094124,
                                 0.259264551287108, -0.566139387410439, -0.270799422511798,
                                 0.110992577014185,  0.075255467706765,  0.319545558846010,
                                 0.290228138426175,  0.129473548473349,  0.063092274290374,
                                -0.004680364934214, -0.003150099278026, -0.235167390362799,
                                -0.127453570444064, -0.026906696991985, -0.023741233601018,
                                 0.061685993928415,  0.035712445807440, -0.019417074406980,
                                -0.015841461379022,  0.143944795876198,  0.076336778611286,
                                 3.210758531294226,  1.321560662368604,  0.087540969205506,
                                 0.042893109624429, -0.940516208346110, -0.966142243356829,
                                 0.185299185116057,  0.111120263240652, -0.207704180128075,
                                -0.163281352451796,  0.065684230466872,  0.040522222190912,
                                 0.614670200267116,  0.635061974090067,  0.063092274290374,
                                 0.098095422808380, -0.003150099278026, -0.003290254167836,
                                -0.127453570444064, -0.174809396154466, -0.023741233601018,
                                -0.017352723600471,  0.035712445807440,  0.045406017918435,
                                -0.015841461379022, -0.012848981469989,  0.076336778611286,
                                 0.107515875754190,  1.321560662368604,  2.234899001354447,
                                 0.042893109624429,  0.066255772489816, -0.340099811046303,
                                -0.280127264560101, -0.004308003951257,  0.007410333949169,
                                -0.174176970620075, -0.090268494256001,  0.338815979104052,
                                 0.198073057286546, -0.117105891014033, -0.105797101491579,
                                 0.000626945753456,  0.000425509377579, -0.126434960277506,
                                -0.061029978206855, -0.023114306656439, -0.015030976089177,
                                -0.002317196933221, -0.002234375155657,  0.008444390385572,
                                 0.005200093325356,  0.002696605667332,  0.000237950372488,
                                -0.003588407973325, -0.002104289519202,  0.087540969205506,
                                 0.042893109624429,  3.003262352957049,  1.213893577175685,
                                -0.538154990768791, -0.545224798432427,  0.022903664136614,
                                 0.022156044640788, -0.081881798391381, -0.067417532895620,
                                 0.217392540083915,  0.186679296206805, -0.217390607437973,
                                -0.222169911374231,  0.000425509377579,  0.000439442678647,
                                -0.061029978206855, -0.095965596856573, -0.015030976089177,
                                -0.016654466479835, -0.002234375155657, -0.001393978494386,
                                 0.005200093325356,  0.006121391999095,  0.000237950372488,
                                 0.002413415888344, -0.002104289519202, -0.002724975694288,
                                 0.042893109624429,  0.066255772489816,  1.213893577175685,
                                 2.079255497562280};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 28, 28, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeGDForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(4, 2);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.478214801540742,  1.893711993539113,  0.113845079639040,
                                 0.098457288097802, -0.010398449425070,  0.004397542058047,
                                 0.135796844437519,  0.109803540345022, -0.006358322731098,
                                -0.006887707600306, -0.156436297443300, -0.185844437552346,
                                 0.295289035182079,  0.430276278973106,  0.032433568164412,
                                 0.176218987944024,  0.150085363478457, -0.015964307502480,
                                 0.958084080849999,  0.833218500991274, -0.400921785160483,
                                -0.486942098855487, -0.165929703403569, -0.107769015630013,
                                -0.549317377323077, -0.709929880228829, -0.339886335364944,
                                -0.424461153158040,  1.893711993539113,  2.568625662074751,
                                 0.098457288097802,  0.176831721729404,  0.004397542058047,
                                 0.018338724450592,  0.109803540345022,  0.191254160791963,
                                -0.006887707600306, -0.013453349418572, -0.086318842634328,
                                -0.129938492774533,  0.224364912789462,  0.351874894016134,
                                 0.146022753445749,  0.257087755931327, -0.052638333548148,
                                -0.105114525271974,  0.275354622219946,  0.349913268694802,
                                -0.212913139388889, -0.312648062884434, -0.027905654446235,
                                -0.029310173281421, -0.352110448158003, -0.542999087901701,
                                -0.201962972765268, -0.306775929127380,  0.113845079639040,
                                 0.098457288097802,  3.749890559770268,  2.128666885590687,
                                 0.158154370861165,  0.149787169537950,  0.116143059381084,
                                 0.112249489928672, -0.125305611931207, -0.098438822804517,
                                 0.286672109487259,  0.253533333409385,  0.348298491300949,
                                 0.227457515629760,  0.112351225157015,  0.100321649244353,
                                 0.492624738734226,  0.518135033347869, -0.216889496555993,
                                -0.419791852514995,  0.093513425470452, -0.086744908615759,
                                 0.219066322368861, -0.043102825046880,  0.429245433590754,
                                 0.344441317432027,  0.000814202667576,  0.016084064510909,
                                 0.098457288097802,  0.176831721729404,  2.128666885590687,
                                 2.990610452565374,  0.149787169537950,  0.279165123100005,
                                 0.112249489928672,  0.210807136455715, -0.098438822804517,
                                -0.169056134251319,  0.082451732230376,  0.103655240199703,
                                 0.047060624213426,  0.037056595935269,  0.089938770180962,
                                 0.161070079687750,  0.266252265292557,  0.416155302275358,
                                -0.254949193040231, -0.418480905615031, -0.070276158535404,
                                -0.122668895784349, -0.143119576775078, -0.286785606309918,
                                 0.076416331003493,  0.066438274717922,  0.008045755363898,
                                 0.012389798571636, -0.010398449425070,  0.004397542058047,
                                 0.158154370861165,  0.149787169537950,  3.749582339653307,
                                 2.116088199964572,  0.105436247240776,  0.099858113025300,
                                 0.004332687260446, -0.001832309190852, -0.155223513780620,
                                -0.115954587858114,  0.095770761522136,  0.064443983242623,
                                 0.320071336852261,  0.198071609825813, -0.251658544523736,
                                 0.011962950072792, -0.185509617554948,  0.218054976723664,
                                -0.167772363015825,  0.007975300048528, -0.133363057021775,
                                -0.082529837427422, -0.489495003335357, -0.329380358795627,
                                -0.153929984499114, -0.114988299625963,  0.004397542058047,
                                 0.018338724450592,  0.149787169537950,  0.279165123100005,
                                 2.116088199964572,  2.958418999537411,  0.099858113025300,
                                 0.186110082066670, -0.001832309190853, -0.007641135187747,
                                -0.033802348654510, -0.039337361430632,  0.017246514047106,
                                 0.018682349658090,  0.075831461990169,  0.105354607077182,
                                 0.151830413538511,  0.313528343459542,  0.236485548424458,
                                 0.433925248604690,  0.101220275692341,  0.209018895639695,
                                -0.031596442495904, -0.043897752948826, -0.088148849574100,
                                -0.095487564919126, -0.033520662415722, -0.039009550085377,
                                 0.135796844437519,  0.109803540345022,  0.116143059381084,
                                 0.112249489928672,  0.105436247240776,  0.099858113025300,
                                 3.653104676952698,  2.035125643983459,  0.060223224606778,
                                 0.040370954001891, -0.115965895173878, -0.085916716673710,
                                -0.669879129171538, -0.463646477242321, -0.129621746960157,
                                 0.067882744005261,  0.093513425470453, -0.086744908615759,
                                -0.144592997703996, -0.279861235009997,  0.414696884175516,
                                 0.590422457194335, -0.344809938043027, -0.026331269876260,
                                 0.109670076516672,  0.109245732151218,  0.310203946146839,
                                 0.267803992645334,  0.109803540345022,  0.191254160791963,
                                 0.112249489928672,  0.210807136455715,  0.099858113025300,
                                 0.186110082066670,  2.035125643983459,  2.814937838852278,
                                 0.040370954001891,  0.063375141632784, -0.024891501341021,
                                -0.028828196175849, -0.098031222783807, -0.079750437751486,
                                 0.141224633351163,  0.276359340130312, -0.070276158535404,
                                -0.122668895784349, -0.169966128693488, -0.278987270410021,
                                 0.324815730738727,  0.518379382095649,  0.099624036569866,
                                 0.214359884605737,  0.025625856531282,  0.023855367593651,
                                 0.085894246483658,  0.107014510731887, -0.006358322731098,
                                -0.006887707600306, -0.125305611931207, -0.098438822804517,
                                 0.004332687260446, -0.001832309190853,  0.060223224606778,
                                 0.040370954001891,  3.465604128124063,  1.880051373465174,
                                 0.325367437634593,  0.415656305283699,  0.386468292050448,
                                 0.611171596443715, -0.165929703403569, -0.107769015630013,
                                 0.588736734273933,  0.625840790136018, -0.399201700354167,
                                -0.347174375413031, -0.809857709768068, -0.725890951825190,
                                -0.296660343585999, -0.037522893055502,  0.328568077733604,
                                 0.450458038808591, -0.120752774639840, -0.164204503465046,
                                -0.006887707600306, -0.013453349418572, -0.098438822804517,
                                -0.169056134251319, -0.001832309190852, -0.007641135187747,
                                 0.040370954001891,  0.063375141632784,  1.880051373465174,
                                 2.541943185727918,  0.199838977383958,  0.304703294253574,
                                 0.328286965728863,  0.519751683066143, -0.027905654446235,
                                -0.029310173281421,  0.253099831108889,  0.359140945377377,
                                -0.114731092591644, -0.145797195289500, -0.258036980117039,
                                -0.342744813569234,  0.090676538794050,  0.198955912256509,
                                 0.229233363135115,  0.356625619962429, -0.081098636594516,
                                -0.124844516967531, -0.156436297443300, -0.086318842634328,
                                 0.286672109487259,  0.082451732230376, -0.155223513780620,
                                -0.033802348654510, -0.115965895173878, -0.024891501341021,
                                 0.325367437634593,  0.199838977383958,  3.474587590985533,
                                 2.578487920480574,  0.028293520891176,  0.024110587268697,
                                -0.005498015009990, -0.005463660747301,  0.000116411567457,
                                -0.000330286643014,  0.003245640265673,  0.003122228035217,
                                -0.001264469336186, -0.001271048735608,  0.007355338513117,
                                 0.007215635648191,  0.044390197714380,  0.038123159399283,
                                 0.000250690744247,  0.000251637254066, -0.185844437552346,
                                -0.129938492774533,  0.253533333409385,  0.103655240199703,
                                -0.115954587858114, -0.039337361430632, -0.085916716673710,
                                -0.028828196175849,  0.415656305283699,  0.304703294253574,
                                 2.578487920480574,  2.698654718918641,  0.024110587268697,
                                 0.026999661286588, -0.005463660747301, -0.006083479711474,
                                -0.000330286643014, -0.000315327441310,  0.003122228035217,
                                 0.003486333143956, -0.001271048735608, -0.001397268533830,
                                 0.007215635648191,  0.008086087322139,  0.038123159399283,
                                 0.042663959960894,  0.000251637254066,  0.000278274549525,
                                 0.295289035182079,  0.224364912789462,  0.348298491300949,
                                 0.047060624213426,  0.095770761522136,  0.017246514047106,
                                -0.669879129171538, -0.098031222783807,  0.386468292050448,
                                 0.328286965728863,  0.028293520891176,  0.024110587268697,
                                 3.538517702935191,  2.634101679475617,  0.046681675215264,
                                 0.041345610443234,  0.003150327847346,  0.002804808707416,
                                -0.004467667101000, -0.004175930646790,  0.000585454079810,
                                 0.001679336657875,  0.062359854241753,  0.054356595056153,
                                -0.001863616340291, -0.001863901956766, -0.043175186795051,
                                -0.036903561075787,  0.430276278973106,  0.351874894016134,
                                 0.227457515629760,  0.037056595935269,  0.064443983242623,
                                 0.018682349658090, -0.463646477242321, -0.079750437751486,
                                 0.611171596443715,  0.519751683066143,  0.024110587268697,
                                 0.026999661286588,  2.634101679475617,  2.760958469765402,
                                 0.041345610443234,  0.046263673617302,  0.002804808707416,
                                 0.003087569642281, -0.004175930646790, -0.004669837995675,
                                 0.001679336657875,  0.001853070620862,  0.054356595056153,
                                 0.060916607541699, -0.001863901956766, -0.002062575147156,
                                -0.036903561075787, -0.041315259923083,  0.032433568164412,
                                 0.146022753445749,  0.112351225157015,  0.089938770180962,
                                 0.320071336852261,  0.075831461990169, -0.129621746960157,
                                 0.141224633351163, -0.165929703403569, -0.027905654446235,
                                -0.005498015009990, -0.005463660747301,  0.046681675215264,
                                 0.041345610443234,  3.637350945516853,  2.726547037387453,
                                 0.083551349692954,  0.078826929644507, -0.051351798301188,
                                -0.046290647090463,  0.082995097181347,  0.076512139404940,
                                -0.021237914966400, -0.021004544790756, -0.084459405801862,
                                -0.076453729855153, -0.009048418043576, -0.008925313631502,
                                 0.176218987944024,  0.257087755931327,  0.100321649244353,
                                 0.161070079687750,  0.198071609825813,  0.105354607077182,
                                 0.067882744005261,  0.276359340130312, -0.107769015630013,
                                -0.029310173281421, -0.005463660747301, -0.006083479711474,
                                 0.041345610443234,  0.046263673617302,  2.726547037387453,
                                 2.863921596644260,  0.078826929644507,  0.087752630956915,
                                -0.046290647090463, -0.051760481943523,  0.076512139404940,
                                 0.085348837430947, -0.021004544790756, -0.023283808588019,
                                -0.076453729855153, -0.085370254990487, -0.008925313631502,
                                -0.009974676460764,  0.150085363478457, -0.052638333548148,
                                 0.492624738734226,  0.266252265292557, -0.251658544523736,
                                 0.151830413538511,  0.093513425470453, -0.070276158535404,
                                 0.588736734273933,  0.253099831108889,  0.000116411567457,
                                -0.000330286643014,  0.003150327847346,  0.002804808707416,
                                 0.083551349692954,  0.078826929644507,  3.663928921153976,
                                 2.748761951474151,  0.023741293549964,  0.020243166278018,
                                 0.069751278003412,  0.065123348278219, -0.070295518973921,
                                -0.063993662886393, -0.012391600331178, -0.013869014274793,
                                -0.001123442257539, -0.001297590655861, -0.015964307502480,
                                -0.105114525271974,  0.518135033347869,  0.416155302275358,
                                 0.011962950072792,  0.313528343459542, -0.086744908615759,
                                -0.122668895784349,  0.625840790136018,  0.359140945377377,
                                -0.000330286643014, -0.000315327441310,  0.002804808707416,
                                 0.003087569642281,  0.078826929644507,  0.087752630956915,
                                 2.748761951474151,  2.888869885803429,  0.020243166278018,
                                 0.022784383405884,  0.065123348278219,  0.072610168872129,
                                -0.063993662886393, -0.071464804729619, -0.013869014274793,
                                -0.015278052885122, -0.001297590655861, -0.001408476761562,
                                 0.958084080849999,  0.275354622219946, -0.216889496555993,
                                -0.254949193040231, -0.185509617554948,  0.236485548424458,
                                -0.144592997703996, -0.169966128693488, -0.399201700354167,
                                -0.114731092591644,  0.003245640265673,  0.003122228035217,
                                -0.004467667101000, -0.004175930646790, -0.051351798301188,
                                -0.046290647090463,  0.023741293549964,  0.020243166278018,
                                 3.610384526879928,  2.696453358939132,  0.015827529033309,
                                 0.013495444185345,  0.021396582625496,  0.019287769621026,
                                 0.022834742960667,  0.021343645528039,  0.003218593263458,
                                 0.003096209468257,  0.833218500991274,  0.349913268694802,
                                -0.419791852514995, -0.418480905615031,  0.218054976723664,
                                 0.433925248604690, -0.279861235009997, -0.278987270410021,
                                -0.347174375413031, -0.145797195289500,  0.003122228035217,
                                 0.003486333143956, -0.004175930646790, -0.004669837995675,
                                -0.046290647090463, -0.051760481943523,  0.020243166278018,
                                 0.022784383405884,  2.696453358939132,  2.830779385136692,
                                 0.013495444185345,  0.015189588937256,  0.019287769621025,
                                 0.021566867476469,  0.021343645528039,  0.023868060866785,
                                 0.003096209468257,  0.003457280367758, -0.400921785160483,
                                -0.212913139388889,  0.093513425470452, -0.070276158535404,
                                -0.167772363015825,  0.101220275692341,  0.414696884175516,
                                 0.324815730738727, -0.809857709768068, -0.258036980117039,
                                -0.001264469336186, -0.001271048735608,  0.000585454079810,
                                 0.001679336657875,  0.082995097181347,  0.076512139404940,
                                 0.069751278003412,  0.065123348278219,  0.015827529033309,
                                 0.013495444185345,  3.605802856151133,  2.694492494575635,
                                 0.018642394410558,  0.014843605216382, -0.008557433851926,
                                -0.009283288262695,  0.000604393501183,  0.000194627939497,
                                -0.486942098855487, -0.312648062884434, -0.086744908615759,
                                -0.122668895784349,  0.007975300048528,  0.209018895639695,
                                 0.590422457194335,  0.518379382095649, -0.725890951825190,
                                -0.342744813569234, -0.001271048735608, -0.001397268533830,
                                 0.001679336657875,  0.001853070620862,  0.076512139404940,
                                 0.085348837430947,  0.065123348278219,  0.072610168872129,
                                 0.013495444185345,  0.015189588937256,  2.694492494575635,
                                 2.828361411743325,  0.014843605216382,  0.016789797150130,
                                -0.009283288262695, -0.010225537769775,  0.000194627939497,
                                 0.000258040944013, -0.165929703403569, -0.027905654446235,
                                 0.219066322368861, -0.143119576775078, -0.133363057021775,
                                -0.031596442495904, -0.344809938043027,  0.099624036569866,
                                -0.296660343585999,  0.090676538794050,  0.007355338513117,
                                 0.007215635648191,  0.062359854241753,  0.054356595056153,
                                -0.021237914966400, -0.021004544790756, -0.070295518973921,
                                -0.063993662886393,  0.021396582625496,  0.019287769621025,
                                 0.018642394410558,  0.014843605216382,  3.595229080833495,
                                 2.684888023552452,  0.051197831480479,  0.045861272830970,
                                -0.001336883555298, -0.001261734785903, -0.107769015630013,
                                -0.029310173281421, -0.043102825046880, -0.286785606309918,
                                -0.082529837427422, -0.043897752948826, -0.026331269876260,
                                 0.214359884605737, -0.037522893055502,  0.198955912256509,
                                 0.007215635648191,  0.008086087322139,  0.054356595056153,
                                 0.060916607541699, -0.021004544790756, -0.023283808588019,
                                -0.063993662886393, -0.071464804729619,  0.019287769621026,
                                 0.021566867476469,  0.014843605216382,  0.016789797150130,
                                 2.684888023552452,  2.817742042944695,  0.045861272830970,
                                 0.051260901404156, -0.001261734785903, -0.001441838531401,
                                -0.549317377323077, -0.352110448158003,  0.429245433590754,
                                 0.076416331003493, -0.489495003335357, -0.088148849574100,
                                 0.109670076516672,  0.025625856531282,  0.328568077733604,
                                 0.229233363135115,  0.044390197714380,  0.038123159399283,
                                -0.001863616340291, -0.001863901956766, -0.084459405801862,
                                -0.076453729855153, -0.012391600331178, -0.013869014274793,
                                 0.022834742960667,  0.021343645528039, -0.008557433851926,
                                -0.009283288262695,  0.051197831480479,  0.045861272830970,
                                 3.547678232530579,  2.643263613007064,  0.030083402115111,
                                 0.025907226381350, -0.709929880228829, -0.542999087901701,
                                 0.344441317432027,  0.066438274717922, -0.329380358795627,
                                -0.095487564919126,  0.109245732151218,  0.023855367593651,
                                 0.450458038808591,  0.356625619962429,  0.038123159399283,
                                 0.042663959960894, -0.001863901956766, -0.002062575147156,
                                -0.076453729855153, -0.085370254990487, -0.013869014274793,
                                -0.015278052885122,  0.021343645528039,  0.023868060866785,
                                -0.009283288262695, -0.010225537769775,  0.045861272830970,
                                 0.051260901404156,  2.643263613007064,  2.771096973206129,
                                 0.025907226381350,  0.028986485302729, -0.339886335364944,
                                -0.201962972765268,  0.000814202667576,  0.008045755363898,
                                -0.153929984499114, -0.033520662415722,  0.310203946146839,
                                 0.085894246483658, -0.120752774639840, -0.081098636594516,
                                 0.000250690744247,  0.000251637254066, -0.043175186795051,
                                -0.036903561075787, -0.009048418043576, -0.008925313631502,
                                -0.001123442257539, -0.001297590655861,  0.003218593263458,
                                 0.003096209468257,  0.000604393501183,  0.000194627939497,
                                -0.001336883555298, -0.001261734785903,  0.030083402115111,
                                 0.025907226381350,  3.474583395251088,  2.578483708904679,
                                -0.424461153158040, -0.306775929127380,  0.016084064510909,
                                 0.012389798571636, -0.114988299625963, -0.039009550085377,
                                 0.267803992645334,  0.107014510731887, -0.164204503465046,
                                -0.124844516967531,  0.000251637254066,  0.000278274549525,
                                -0.036903561075787, -0.041315259923083, -0.008925313631502,
                                -0.009974676460764, -0.001297590655861, -0.001408476761562,
                                 0.003096209468257,  0.003457280367758,  0.000194627939497,
                                 0.000258040944013, -0.001261734785903, -0.001441838531401,
                                 0.025907226381350,  0.028986485302729,  2.578483708904679,
                                 2.698650061522470};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 28, 28, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeFGForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(3, 4);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.856368291421526,  2.956118688354651,  0.031098228475630,
                                 0.029118300052022,  0.000667006083549,  0.000604990800414,
                                -0.001285274849412, -0.001212429829315,  0.003053217697576,
                                 0.004075161603475,  0.044261951379235,  0.040937008744552,
                                -0.000354120703374, -0.000406829268913, -0.119811382408356,
                                -0.323105650691470,  0.220768126048180, -0.228530991953617,
                                 0.252766332536412,  0.337025853563729,  0.478245283014938,
                                 0.220416870542618,  0.146622239456403,  0.054710859533696,
                                -0.866202889656627, -0.455538635336129,  0.298506686345342,
                                 0.490076790107645, -0.014716214198011, -0.002213354255926,
                                 0.173568112108603,  0.483733657335117,  2.956118688354651,
                                 3.002946777845089,  0.029118300052022,  0.033923227925973,
                                 0.000604990800414,  0.000696810175471, -0.001212429829315,
                                -0.001416677385472,  0.004075161603475,  0.005485673636577,
                                 0.040937008744552,  0.047380987883265, -0.000406829268913,
                                -0.000520160875585, -0.160353138214552, -0.425209702232193,
                                 0.052802967288775, -0.391860345194959,  0.251733494341369,
                                 0.389012603895188,  0.280137881817059,  0.219417760451281,
                                 0.079883625821160,  0.051530803052328, -0.539388134360521,
                                -0.462593454934849,  0.343807539117434,  0.570920343485944,
                                -0.005699824984055, -0.001673770719415,  0.238148116245855,
                                 0.637115191978468,  0.031098228475630,  0.029118300052022,
                                 3.948047001235177,  3.047413386676495,  0.072304030065319,
                                 0.075892441232213, -0.019004352350503, -0.016031566759634,
                                 0.075399686736140,  0.076449078973143, -0.010503810771218,
                                -0.011898484222150, -0.051141558270653, -0.048840600416474,
                                -0.242435101033924, -0.183694900557661,  0.272676191656847,
                                 0.148473318612677, -0.101071751307893, -0.326639823332661,
                                 0.270409658253605,  0.160333134981443,  0.239183366096080,
                                -0.234662925055439,  0.098051705836223,  0.283720445321818,
                                -0.129074697679630, -0.002058796147637, -0.537084157846740,
                                -0.232379468609034, -0.519414097757684, -0.431478116375146,
                                 0.029118300052022,  0.033923227925973,  3.047413386676495,
                                 3.112641907817842,  0.075892441232213,  0.093434351901512,
                                -0.016031566759634, -0.017588503804400,  0.076449078973143,
                                 0.092642892970634, -0.011898484222150, -0.015127792115902,
                                -0.048840600416474, -0.057486305957660, -0.177780583617710,
                                -0.197834728044391,  0.211322908771243,  0.109155337868415,
                                -0.105322945596517, -0.494586607166844,  0.139677254712731,
                                 0.197222367265136, -0.032371653214033, -0.304695696594566,
                                 0.142087538343467,  0.363861506120758, -0.036671741920732,
                                 0.003160225423052, -0.359224783732776, -0.168437854355480,
                                -0.402493207742488, -0.467702761052394,  0.000667006083549,
                                 0.000604990800414,  0.072304030065319,  0.075892441232213,
                                 4.025743657955895,  3.127084149876759,  0.047100903903013,
                                 0.048282128187159,  0.066661774657982,  0.070952776536786,
                                -0.065482779227589, -0.065232204110590, -0.009798192042638,
                                -0.012085508740386,  0.402395931664368,  0.198284342884378,
                                 0.333557910178166,  0.040193174257892,  0.344258786784416,
                                 0.201809115039114,  0.556018496071361,  0.015252968753156,
                                -0.372146813107542,  0.044814268684892, -0.027862568831746,
                                 0.087261392651480, -0.235442485249740, -0.252918880988598,
                                 0.303646990006238,  0.039081042382875, -0.014624862401105,
                                 0.018449718720334,  0.000604990800414,  0.000696810175471,
                                 0.075892441232213,  0.093434351901512,  3.127084149876759,
                                 3.209702482925850,  0.048282128187159,  0.058806050008381,
                                 0.070952776536786,  0.087890141053622, -0.065232204110590,
                                -0.078390302506144, -0.012085508740386, -0.015859612850645,
                                 0.246189745940052,  0.197389869022942,  0.134563905740757,
                                 0.019229930488287,  0.223306060336052,  0.195149203085522,
                                 0.304700016297443, -0.155816053142237, -0.148148984401885,
                                 0.133657373862080,  0.012133819973403,  0.121519170971189,
                                -0.249984607657161, -0.233794345992497,  0.143817682311865,
                                 0.007474549811756,  0.007170777237412,  0.021520955161401,
                                -0.001285274849412, -0.001212429829315, -0.019004352350503,
                                -0.016031566759634,  0.047100903903013,  0.048282128187159,
                                 3.974293440465643,  3.068002687773665,  0.031400602602008,
                                 0.032188085458106,  0.007918480146044,  0.006679819483181,
                                 0.006569182563660,  0.006196863572054, -0.238133613163384,
                                -0.071381708165922,  0.101730084897153,  0.007427110540201,
                                 0.122006119185929, -0.085102314412389, -0.083518490915538,
                                 0.131223732889803,  0.325978991719019,  0.048349132479649,
                                -0.055678993943692,  0.087482488593202, -0.050835882994137,
                                 0.035459297671828, -0.519953767252118, -0.037960787205473,
                                -0.236149166387020, -0.070786860597872, -0.001212429829315,
                                -0.001416677385472, -0.016031566759634, -0.017588503804400,
                                 0.048282128187159,  0.058806050008381,  3.068002687773665,
                                 3.134180406469717,  0.032188085458106,  0.039204033338920,
                                 0.006679819483181,  0.007328543251833,  0.006196863572054,
                                 0.007240795525744, -0.119532781829063, -0.063647100416892,
                                 0.038580206504523,  0.000088051086921, -0.011684318469292,
                                -0.105757016377877,  0.088332066230761,  0.106355043201926,
                                 0.281623240588236, -0.123371720664715,  0.058888044153841,
                                 0.070903362134617,  0.004868466028871,  0.044065423490782,
                                -0.197187722134227, -0.000450038888708, -0.118536675313820,
                                -0.063116707913418,  0.003053217697576,  0.004075161603475,
                                 0.075399686736140,  0.076449078973143,  0.066661774657982,
                                 0.070952776536786,  0.031400602602008,  0.032188085458106,
                                 3.970192179074243,  3.067956836096106,  0.021617613910500,
                                 0.018561747490275, -0.006021760141972, -0.007338603443690,
                                -0.179860140792021, -0.060834455393067, -0.597665921616511,
                                -0.073035229268122,  0.300276107155944,  0.264409986735538,
                                -0.027862568831746,  0.087261392651481, -0.248097875405028,
                                 0.029876179123261,  0.579237303431149, -0.057464858456410,
                                 0.012886941486042,  0.143076796776977,  0.041989136331312,
                                 0.006521938930023,  0.442139935666982,  0.206945880361889,
                                 0.004075161603475,  0.005485673636577,  0.076449078973143,
                                 0.092642892970634,  0.070952776536786,  0.087890141053622,
                                 0.032188085458106,  0.039204033338920,  3.067956836096106,
                                 3.136460698714497,  0.018561747490275,  0.020587778416340,
                                -0.007338603443689, -0.009590679545146, -0.092579184189474,
                                -0.057142810389581, -0.249815132883434, -0.030360516297041,
                                 0.269594103698758,  0.247393451831525,  0.012133819973403,
                                 0.121519170971189, -0.098765989601257,  0.089104915908054,
                                 0.294588499652940, -0.257082028951561,  0.123079747234561,
                                 0.125642662130492,  0.029449767257284, -0.003465319609621,
                                 0.263643390241813,  0.204669377126523,  0.044261951379235,
                                 0.040937008744552, -0.010503810771218, -0.011898484222150,
                                -0.065482779227589, -0.065232204110590,  0.007918480146044,
                                 0.006679819483181,  0.021617613910500,  0.018561747490275,
                                 3.927214443205593,  3.023814726302565,  0.032504111290962,
                                 0.030733439388662,  0.493924867071662,  0.427644474348734,
                                 0.341038740908800,  0.217577709783545, -0.129074697679631,
                                -0.002058796147636, -0.005782871372966, -0.296686668176714,
                                -0.099659735873367,  0.097776218773099, -0.201186606780813,
                                 0.226604940684246, -0.357069901705827, -0.330723102358807,
                                 0.312739074180178,  0.151498133649042, -0.179789467644972,
                                -0.174272845577288,  0.040937008744552,  0.047380987883265,
                                -0.011898484222150, -0.015127792115902, -0.065232204110590,
                                -0.078390302506144,  0.006679819483181,  0.007328543251833,
                                 0.018561747490275,  0.020587778416340,  3.023814726302565,
                                 3.082638453454637,  0.030733439388662,  0.035988301301310,
                                 0.392620821275855,  0.464803705126146,  0.294564447620420,
                                 0.161235818486105, -0.036671741920733,  0.003160225423052,
                                -0.121859035225778, -0.384269892687674,  0.013488188839180,
                                 0.126956540247736,  0.036287127666766,  0.301531898607152,
                                -0.178055233739304, -0.488318826744458,  0.224536578797554,
                                 0.110627110692642, -0.153516928473267, -0.190709632863334,
                                -0.000354120703374, -0.000406829268913, -0.051141558270653,
                                -0.048840600416474, -0.009798192042638, -0.012085508740386,
                                 0.006569182563660,  0.006196863572054, -0.006021760141972,
                                -0.007338603443689,  0.032504111290962,  0.030733439388662,
                                 3.858108957197775,  2.958118440920442, -0.163402103289951,
                                -0.482204664988187, -0.014716214198011, -0.002213354255926,
                                -0.531085232423541, -0.534670066301150,  0.458107542440358,
                                 0.349072180312714, -0.749402557221622, -0.279633282061113,
                                 0.073550730358806,  0.114837635977732,  0.300294946642843,
                                 0.346138717375468,  0.293105072649513, -0.217651339995139,
                                -0.104835427857346, -0.320853230857399, -0.000406829268913,
                                -0.000520160875585, -0.048840600416474, -0.057486305957660,
                                -0.012085508740386, -0.015859612850645,  0.006196863572054,
                                 0.007240795525744, -0.007338603443690, -0.009590679545146,
                                 0.030733439388662,  0.035988301301310,  2.958118440920442,
                                 3.005503607269763, -0.234210658536079, -0.635958945700381,
                                -0.005699824984055, -0.001673770719415, -0.441267651820759,
                                -0.607255327674507,  0.346717435809184,  0.369826541676551,
                                -0.408294087530371, -0.263379660045234,  0.089072772420318,
                                 0.127423904803469,  0.271649966284092,  0.396437843545112,
                                 0.080820222947111, -0.383632993953389, -0.154552711640070,
                                -0.423506389553707, -0.119811382408356, -0.160353138214552,
                                -0.242435101033924, -0.177780583617710,  0.402395931664368,
                                 0.246189745940052, -0.238133613163384, -0.119532781829063,
                                -0.179860140792021, -0.092579184189474,  0.493924867071662,
                                 0.392620821275855, -0.163402103289951, -0.234210658536079,
                                 3.003272845956699,  1.213900698796220,  0.083064703295064,
                                 0.039855058707057, -0.013921681609226, -0.009215874368535,
                                 0.001578609714113, -0.000658448989035,  0.008515351649315,
                                 0.005243791588594, -0.003153652116547, -0.002152103687203,
                                 0.018909908341683,  0.012137417241391,  0.129473548473349,
                                 0.063092274290374,  0.000626945753456,  0.000425509377579,
                                -0.323105650691470, -0.425209702232193, -0.183694900557661,
                                -0.197834728044391,  0.198284342884378,  0.197389869022942,
                                -0.071381708165922, -0.063647100416892, -0.060834455393067,
                                -0.057142810389581,  0.427644474348734,  0.464803705126146,
                                -0.482204664988187, -0.635958945700381,  1.213900698796220,
                                 2.079262852380217,  0.039855058707057,  0.063118240620152,
                                -0.009215874368535, -0.009931928773966, -0.000658448989035,
                                 0.001680016871824,  0.005243791588594,  0.006172832267994,
                                -0.002152103687203, -0.002194867512680,  0.012137417241391,
                                 0.013722104243975,  0.063092274290374,  0.098095422808380,
                                 0.000425509377579,  0.000439442678647,  0.220768126048180,
                                 0.052802967288775,  0.272676191656847,  0.211322908771243,
                                 0.333557910178166,  0.134563905740757,  0.101730084897153,
                                 0.038580206504523, -0.597665921616511, -0.249815132883434,
                                 0.341038740908800,  0.294564447620420, -0.014716214198011,
                                -0.005699824984055,  0.083064703295064,  0.039855058707057,
                                 3.187752389649002,  1.306076478719369,  0.132599269407999,
                                 0.068705352967274,  0.008887509030065,  0.004679246004160,
                                -0.012068998812081, -0.006987217657977, -0.001635740087389,
                                 0.003048083298650,  0.179648707563497,  0.090109626923777,
                                -0.004680364934214, -0.003150099278026, -0.126434960277506,
                                -0.061029978206855, -0.228530991953617, -0.391860345194959,
                                 0.148473318612677,  0.109155337868415,  0.040193174257892,
                                 0.019229930488287,  0.007427110540201,  0.000088051086921,
                                -0.073035229268122, -0.030360516297041,  0.217577709783545,
                                 0.161235818486105, -0.002213354255926, -0.001673770719415,
                                 0.039855058707057,  0.063118240620152,  1.306076478719369,
                                 2.218725892099505,  0.068705352967274,  0.099538382672895,
                                 0.004679246004160,  0.006531392918573, -0.006987217657977,
                                -0.008883786114476,  0.003048083298650, -0.002190511077071,
                                 0.090109626923777,  0.135771991486161, -0.003150099278026,
                                -0.003290254167836, -0.061029978206855, -0.095965596856573,
                                 0.252766332536412,  0.251733494341369, -0.101071751307893,
                                -0.105322945596517,  0.344258786784416,  0.223306060336052,
                                 0.122006119185929, -0.011684318469292,  0.300276107155944,
                                 0.269594103698758, -0.129074697679631, -0.036671741920733,
                                -0.531085232423541, -0.441267651820759, -0.013921681609226,
                                -0.009215874368535,  0.132599269407999,  0.068705352967274,
                                 3.454395284543255,  1.460895665547285,  0.223480122686521,
                                 0.132162521859241, -0.143558959884823, -0.077107504692447,
                                 0.227134148978855,  0.127868110920420, -0.054024950863989,
                                -0.035441676819435, -0.235167390362799, -0.127453570444064,
                                -0.023114306656439, -0.015030976089177,  0.337025853563729,
                                 0.389012603895188, -0.326639823332661, -0.494586607166844,
                                 0.201809115039114,  0.195149203085522, -0.085102314412389,
                                -0.105757016377877,  0.264409986735538,  0.247393451831525,
                                -0.002058796147636,  0.003160225423052, -0.534670066301150,
                                -0.607255327674507, -0.009215874368535, -0.009931928773966,
                                 0.068705352967274,  0.099538382672895,  1.460895665547285,
                                 2.413849781863635,  0.132162521859241,  0.162897834626554,
                                -0.077107504692447, -0.107060499760845,  0.127868110920420,
                                 0.167526249594067, -0.035441676819435, -0.038303715460235,
                                -0.127453570444064, -0.174809396154466, -0.015030976089177,
                                -0.016654466479835,  0.478245283014938,  0.280137881817059,
                                 0.270409658253605,  0.139677254712731,  0.556018496071361,
                                 0.304700016297443, -0.083518490915538,  0.088332066230761,
                                -0.027862568831746,  0.012133819973403, -0.005782871372966,
                                -0.121859035225778,  0.458107542440358,  0.346717435809184,
                                 0.001578609714113, -0.000658448989035,  0.008887509030065,
                                 0.004679246004160,  0.223480122686521,  0.132162521859241,
                                 3.533678762391258,  1.497498623392848,  0.069710415465437,
                                 0.033430003079897,  0.188550664006585,  0.109014945335631,
                                -0.194708338463578, -0.106755409359887, -0.026906696991985,
                                -0.023741233601018, -0.002317196933221, -0.002234375155657,
                                 0.220416870542618,  0.219417760451281,  0.160333134981443,
                                 0.197222367265136,  0.015252968753156, -0.155816053142237,
                                 0.131223732889803,  0.106355043201926,  0.087261392651481,
                                 0.121519170971189, -0.296686668176714, -0.384269892687674,
                                 0.349072180312714,  0.369826541676551, -0.000658448989035,
                                 0.001680016871824,  0.004679246004160,  0.006531392918573,
                                 0.132162521859241,  0.162897834626554,  1.497498623392848,
                                 2.474625653375880,  0.033430003079897,  0.053281022699056,
                                 0.109014945335631,  0.138304927472457, -0.106755409359887,
                                -0.144480098890337, -0.023741233601018, -0.017352723600471,
                                -0.002234375155657, -0.001393978494386,  0.146622239456403,
                                 0.079883625821160,  0.239183366096080, -0.032371653214033,
                                -0.372146813107542, -0.148148984401885,  0.325978991719019,
                                 0.281623240588236, -0.248097875405028, -0.098765989601257,
                                -0.099659735873367,  0.013488188839180, -0.749402557221622,
                                -0.408294087530371,  0.008515351649315,  0.005243791588594,
                                -0.012068998812081, -0.006987217657977, -0.143558959884823,
                                -0.077107504692447,  0.069710415465437,  0.033430003079897,
                                 3.395594910542604,  1.409393007079869,  0.046473610310292,
                                 0.022286668719931,  0.059816233285344,  0.032128126955186,
                                 0.061685993928415,  0.035712445807440,  0.008444390385572,
                                 0.005200093325356,  0.054710859533696,  0.051530803052328,
                                -0.234662925055439, -0.304695696594566,  0.044814268684892,
                                 0.133657373862080,  0.048349132479649, -0.123371720664715,
                                 0.029876179123261,  0.089104915908054,  0.097776218773099,
                                 0.126956540247736, -0.279633282061113, -0.263379660045234,
                                 0.005243791588594,  0.006172832267994, -0.006987217657977,
                                -0.008883786114476, -0.077107504692447, -0.107060499760845,
                                 0.033430003079897,  0.053281022699056,  1.409393007079869,
                                 2.375861213692788,  0.022286668719931,  0.035520681799371,
                                 0.032128126955186,  0.044608541567018,  0.035712445807440,
                                 0.045406017918435,  0.005200093325356,  0.006121391999095,
                                -0.866202889656627, -0.539388134360521,  0.098051705836223,
                                 0.142087538343467, -0.027862568831746,  0.012133819973403,
                                -0.055678993943692,  0.058888044153841,  0.579237303431149,
                                 0.294588499652940, -0.201186606780813,  0.036287127666766,
                                 0.073550730358806,  0.089072772420318, -0.003153652116547,
                                -0.002152103687203, -0.001635740087389,  0.003048083298650,
                                 0.227134148978855,  0.127868110920420,  0.188550664006585,
                                 0.109014945335631,  0.046473610310292,  0.022286668719931,
                                 3.376553209052437,  1.406652835613155,  0.057748202275101,
                                 0.024253158327630, -0.019417074406980, -0.015841461379022,
                                 0.002696605667332,  0.000237950372488, -0.455538635336129,
                                -0.462593454934849,  0.283720445321818,  0.363861506120758,
                                 0.087261392651480,  0.121519170971189,  0.087482488593202,
                                 0.070903362134617, -0.057464858456410, -0.257082028951561,
                                 0.226604940684246,  0.301531898607152,  0.114837635977732,
                                 0.127423904803469, -0.002152103687203, -0.002194867512680,
                                 0.003048083298650, -0.002190511077071,  0.127868110920420,
                                 0.167526249594067,  0.109014945335631,  0.138304927472457,
                                 0.022286668719931,  0.035520681799371,  1.406652835613155,
                                 2.359371547148832,  0.024253158327630,  0.045106397696382,
                                -0.015841461379022, -0.012848981469989,  0.000237950372488,
                                 0.002413415888344,  0.298506686345342,  0.343807539117434,
                                -0.129074697679630, -0.036671741920732, -0.235442485249740,
                                -0.249984607657161, -0.050835882994137,  0.004868466028871,
                                 0.012886941486042,  0.123079747234561, -0.357069901705827,
                                -0.178055233739304,  0.300294946642843,  0.271649966284092,
                                 0.018909908341683,  0.012137417241391,  0.179648707563497,
                                 0.090109626923777, -0.054024950863989, -0.035441676819435,
                                -0.194708338463578, -0.106755409359887,  0.059816233285344,
                                 0.032128126955186,  0.057748202275101,  0.024253158327630,
                                 3.347245798663011,  1.390603006522073,  0.143944795876198,
                                 0.076336778611286, -0.003588407973325, -0.002104289519202,
                                 0.490076790107645,  0.570920343485944, -0.002058796147637,
                                 0.003160225423052, -0.252918880988598, -0.233794345992497,
                                 0.035459297671828,  0.044065423490782,  0.143076796776977,
                                 0.125642662130492, -0.330723102358807, -0.488318826744458,
                                 0.346138717375468,  0.396437843545112,  0.012137417241391,
                                 0.013722104243975,  0.090109626923777,  0.135771991486161,
                                -0.035441676819435, -0.038303715460235, -0.106755409359887,
                                -0.144480098890337,  0.032128126955186,  0.044608541567018,
                                 0.024253158327630,  0.045106397696382,  1.390603006522073,
                                 2.337880746200838,  0.076336778611286,  0.107515875754190,
                                -0.002104289519202, -0.002724975694288, -0.014716214198011,
                                -0.005699824984055, -0.537084157846740, -0.359224783732776,
                                 0.303646990006238,  0.143817682311865, -0.519953767252118,
                                -0.197187722134227,  0.041989136331312,  0.029449767257284,
                                 0.312739074180178,  0.224536578797554,  0.293105072649513,
                                 0.080820222947111,  0.129473548473349,  0.063092274290374,
                                -0.004680364934214, -0.003150099278026, -0.235167390362799,
                                -0.127453570444064, -0.026906696991985, -0.023741233601018,
                                 0.061685993928415,  0.035712445807440, -0.019417074406980,
                                -0.015841461379022,  0.143944795876198,  0.076336778611286,
                                 3.210758531294226,  1.321560662368604,  0.087540969205506,
                                 0.042893109624429, -0.002213354255926, -0.001673770719415,
                                -0.232379468609034, -0.168437854355480,  0.039081042382875,
                                 0.007474549811756, -0.037960787205473, -0.000450038888708,
                                 0.006521938930023, -0.003465319609621,  0.151498133649042,
                                 0.110627110692642, -0.217651339995139, -0.383632993953389,
                                 0.063092274290374,  0.098095422808380, -0.003150099278026,
                                -0.003290254167836, -0.127453570444064, -0.174809396154466,
                                -0.023741233601018, -0.017352723600471,  0.035712445807440,
                                 0.045406017918435, -0.015841461379022, -0.012848981469989,
                                 0.076336778611286,  0.107515875754190,  1.321560662368604,
                                 2.234899001354447,  0.042893109624429,  0.066255772489816,
                                 0.173568112108603,  0.238148116245855, -0.519414097757684,
                                -0.402493207742488, -0.014624862401105,  0.007170777237412,
                                -0.236149166387020, -0.118536675313820,  0.442139935666982,
                                 0.263643390241813, -0.179789467644972, -0.153516928473267,
                                -0.104835427857346, -0.154552711640070,  0.000626945753456,
                                 0.000425509377579, -0.126434960277506, -0.061029978206855,
                                -0.023114306656439, -0.015030976089177, -0.002317196933221,
                                -0.002234375155657,  0.008444390385572,  0.005200093325356,
                                 0.002696605667332,  0.000237950372488, -0.003588407973325,
                                -0.002104289519202,  0.087540969205506,  0.042893109624429,
                                 3.003262352957049,  1.213893577175685,  0.483733657335117,
                                 0.637115191978468, -0.431478116375146, -0.467702761052394,
                                 0.018449718720334,  0.021520955161401, -0.070786860597872,
                                -0.063116707913418,  0.206945880361889,  0.204669377126523,
                                -0.174272845577288, -0.190709632863334, -0.320853230857399,
                                -0.423506389553707,  0.000425509377579,  0.000439442678647,
                                -0.061029978206855, -0.095965596856573, -0.015030976089177,
                                -0.016654466479835, -0.002234375155657, -0.001393978494386,
                                 0.005200093325356,  0.006121391999095,  0.000237950372488,
                                 0.002413415888344, -0.002104289519202, -0.002724975694288,
                                 0.042893109624429,  0.066255772489816,  1.213893577175685,
                                 2.079255497562280};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,
                              28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,
                              28, 28, 28, 28, 28, 28, 28, 28, 29, 29, 29, 29, 29,
                              29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29,
                              29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29,
                              29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
                              30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
                              30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 31,
                              31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31,
                              31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
                              30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
                              26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
                              31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
                              27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
                              30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
                              26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
                              31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
                              27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 32, 32, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeGFForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(4, 3);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.202114389066253,  1.498507930212499,  0.087511576187288,
                                 0.053669164220241,  0.001941158133635,  0.001118525640133,
                                -0.003589663796302, -0.002233902239870,  0.005729793284020,
                                 0.007684076611919,  0.125730541821356,  0.075374800777164,
                                -0.000821963019536, -0.000761412092355,  0.126923343954733,
                                 0.205647077625585, -0.206335643233953, -0.049048241163231,
                                -0.259741639843945, -0.316565949473913, -0.460040407901132,
                                -0.330346851913075, -0.140130275567218, -0.093069153559254,
                                 0.839054536515244,  0.642289812999968, -0.314641189028142,
                                -0.437646748606383,  0.013579392555949,  0.006144121406331,
                                -0.184711059237137, -0.305903382400148,  1.498507930212499,
                                 2.278401667003069,  0.053669164220241,  0.085909795209512,
                                 0.001118525640133,  0.001602704487722, -0.002233902239870,
                                -0.003636511406393,  0.007684076611919,  0.011625036476239,
                                 0.075374800777164,  0.121122204922951, -0.000761412092355,
                                -0.001149402707479,  0.199894722814091,  0.321477488097703,
                                 0.140323100831573,  0.295228209791229, -0.208454875145862,
                                -0.294558959261469, -0.139156160065986, -0.167148813380665,
                                -0.034801788150596, -0.039363779304691,  0.286376217193760,
                                 0.352006106879535, -0.302435628585934, -0.432107269003996,
                                 0.001500676105406,  0.001301879598740, -0.299215047982206,
                                -0.481672260210044,  0.087511576187288,  0.053669164220241,
                                 3.447397372239345,  1.667595787800838,  0.184417039427437,
                                 0.141122982779134, -0.057538044976563, -0.029267324742193,
                                 0.198549715295908,  0.141785349958338, -0.024768165949220,
                                -0.022246402142357, -0.141699058769991, -0.090166977082764,
                                 0.239006326512523,  0.216464383116023, -0.273696682133603,
                                -0.259684991262238,  0.099798823607161,  0.131883497805104,
                                -0.252557853116796, -0.160227216214568, -0.201951266216922,
                                 0.071090831660529, -0.104561383807375, -0.182976306406898,
                                 0.116197988130989,  0.035493241427786,  0.527115414147117,
                                 0.432829063607062,  0.516007742536756,  0.493449501435347,
                                 0.053669164220241,  0.085909795209512,  1.667595787800838,
                                 2.544656848838963,  0.141122982779134,  0.218879961491351,
                                -0.029267324742194, -0.048799058880514,  0.141785349958338,
                                 0.222215216209289, -0.022246402142357, -0.033751276068106,
                                -0.090166977082764, -0.143451988841386,  0.114482540655537,
                                 0.150133140804837, -0.091963715908973, -0.083278254726296,
                                 0.203902529832870,  0.374004632887424, -0.101260846120252,
                                -0.149524660004539,  0.140995478225238,  0.229375829841804,
                                -0.175069170186684, -0.274941986167154,  0.002628288560144,
                                -0.002103240188098,  0.145182789477716,  0.128772996986968,
                                 0.268391825298140,  0.354796613987408,  0.001941158133635,
                                 0.001118525640133,  0.184417039427437,  0.141122982779134,
                                 3.649959487299250,  1.815494951635113,  0.122804047405404,
                                 0.089618123628917,  0.167742046329345,  0.132070894515547,
                                -0.175126962142334, -0.120815612695229, -0.020785695899594,
                                -0.022710943493426, -0.389430253316650, -0.292442165316720,
                                -0.310303216346214, -0.146947089087909, -0.331853750066589,
                                -0.266938650379810, -0.536092566092608, -0.356382561335472,
                                 0.348832838521945,  0.161870115234910,  0.025574429060702,
                                -0.019061737929331,  0.246787402277437,  0.316640039073031,
                                -0.289125642602341, -0.163610144498878,  0.011005593940955,
                                -0.011557971025683,  0.001118525640133,  0.001602704487722,
                                 0.141122982779134,  0.218879961491351,  1.815494951635113,
                                 2.775314355284775,  0.089618123628917,  0.140085311011584,
                                 0.132070894515547,  0.204084991101359, -0.120815612695229,
                                -0.190383798400968, -0.022710943493426, -0.034047539732430,
                                -0.124862522974734, -0.150326888374208, -0.027784795552434,
                                -0.015489873912342, -0.125870561484611, -0.148075553685135,
                                -0.010796495090188,  0.116262129067970, -0.025181034144324,
                                -0.099861538355234, -0.053304402689018, -0.091456803316431,
                                 0.155182118385594,  0.177178836564793, -0.026545375173857,
                                -0.006737269761405, -0.011083177265859, -0.016241018651642,
                                -0.003589663796302, -0.002233902239870, -0.057538044976563,
                                -0.029267324742194,  0.122804047405404,  0.089618123628917,
                                 3.530495447921870,  1.704930068725853,  0.081869364936936,
                                 0.059745415752611,  0.023974185406902,  0.012194718642580,
                                 0.018347170514432,  0.011417722559337,  0.225692883971217,
                                 0.137123710301459, -0.094229710459572, -0.041445216516089,
                                -0.101831214410958,  0.030039011271399,  0.054606401031907,
                                -0.131091601513125, -0.339309213832757, -0.351735494586383,
                                 0.036404267354604, -0.087394401008750,  0.042429672671233,
                                -0.012516254696416,  0.481618520126700,  0.211831106637789,
                                 0.223812109938124,  0.135981012715613, -0.002233902239870,
                                -0.003636511406393, -0.029267324742193, -0.048799058880514,
                                 0.089618123628917,  0.140085311011584,  1.704930068725853,
                                 2.608159076469363,  0.059745415752611,  0.093390207341056,
                                 0.012194718642580,  0.020332941200214,  0.011417722559337,
                                 0.018586613854896,  0.045871827656226,  0.048778333796385,
                                -0.005524659629217, -0.000361196686549,  0.050628466066364,
                                 0.079627587090795, -0.077509949681888, -0.080025812140254,
                                -0.028158098202713,  0.092057297090479, -0.051673299787926,
                                -0.053350541426836, -0.021095194194319, -0.033178161287832,
                                 0.028237149216000,  0.001846116397917,  0.045489562425758,
                                 0.048371847681415,  0.005729793284020,  0.007684076611919,
                                 0.198549715295908,  0.141785349958338,  0.167742046329345,
                                 0.132070894515547,  0.081869364936936,  0.059745415752611,
                                 3.510174448691463,  1.705435872872156,  0.064700745531391,
                                 0.033944325656577, -0.012989278626807, -0.013783117350694,
                                 0.170654576888727,  0.106679102412380,  0.558712670193213,
                                 0.275481664801898, -0.304708915236463, -0.335971101341497,
                                 0.025574429060702, -0.019061737929331,  0.232555225681297,
                                 0.107913410156607, -0.557404590309861, -0.340497779727696,
                                -0.035810461609344, -0.168135443229876, -0.042962747318599,
                                -0.036007831454081, -0.426553437305296, -0.311880654477820,
                                 0.007684076611919,  0.011625036476239,  0.141785349958338,
                                 0.222215216209289,  0.132070894515547,  0.204084991101359,
                                 0.059745415752611,  0.093390207341056,  1.705435872872156,
                                 2.605243529366976,  0.033944325656577,  0.056186048248821,
                                -0.013783117350694, -0.020632944574667,  0.038887768516672,
                                 0.043679610445243,  0.050295750411718,  0.024748173683426,
                                -0.162941439272052, -0.187548335171618, -0.053304402689018,
                                -0.091456803316431, -0.016787356096216, -0.066574358903490,
                                 0.033623840483993,  0.192476131831662, -0.086211810287153,
                                -0.095075894139141, -0.004232340108222,  0.002370939143662,
                                -0.130544533247094, -0.155934104787641,  0.125730541821356,
                                 0.075374800777164, -0.024768165949220, -0.022246402142357,
                                -0.175126962142334, -0.120815612695229,  0.023974185406902,
                                 0.012194718642580,  0.064700745531391,  0.033944325656577,
                                 3.398273843106729,  1.623473756885164,  0.090774824206942,
                                 0.056692021019711, -0.492487544693929, -0.482807570991711,
                                -0.348673046467148, -0.366544342329929,  0.116197988130989,
                                 0.035493241427786,  0.022278765047029,  0.165766951032411,
                                 0.084146360923718, -0.029621179858554,  0.167997753880527,
                                -0.072268288744971,  0.330258166733622,  0.202278426636879,
                                -0.310162291609241, -0.273230612695756,  0.181200043166929,
                                 0.190309397061918,  0.075374800777164,  0.121122204922951,
                                -0.022246402142357, -0.033751276068106, -0.120815612695229,
                                -0.190383798400968,  0.012194718642580,  0.020332941200214,
                                 0.033944325656577,  0.056186048248821,  1.623473756885164,
                                 2.477716817970552,  0.056692021019711,  0.090473000633380,
                                -0.265792578037872, -0.352541692377054, -0.134104282498969,
                                -0.122870940336142,  0.002628288560144, -0.002103240188098,
                                 0.182022540488575,  0.290138485015258, -0.058748115927182,
                                -0.095573262434085, -0.136800294329920, -0.227195654117070,
                                 0.209115302143823,  0.369833206514363, -0.094227665408817,
                                -0.084484370155778,  0.108094294067800,  0.144591153513687,
                                -0.000821963019536, -0.000761412092355, -0.141699058769991,
                                -0.090166977082764, -0.020785695899594, -0.022710943493426,
                                 0.018347170514432,  0.011417722559337, -0.012989278626807,
                                -0.013783117350694,  0.090774824206942,  0.056692021019711,
                                 3.206154714536678,  1.502250620086754,  0.175330370520716,
                                 0.301659003271170,  0.013579392555949,  0.006144121406331,
                                 0.530862679996508,  0.544939979697584, -0.454935054707313,
                                -0.424112086055893,  0.716221408454671,  0.475686784858404,
                                -0.079121921774934, -0.113987272693533, -0.303927606172488,
                                -0.338491869395398, -0.273084589734815, -0.079249417641210,
                                 0.113104275883836,  0.199394512821960, -0.000761412092355,
                                -0.001149402707479, -0.090166977082764, -0.143451988841386,
                                -0.022710943493426, -0.034047539732430,  0.011417722559337,
                                 0.018586613854896, -0.013783117350694, -0.020632944574667,
                                 0.056692021019711,  0.090473000633380,  1.502250620086754,
                                 2.284051508813985,  0.298178376028657,  0.480772917532400,
                                 0.001500676105406,  0.001301879598740,  0.331987659635773,
                                 0.460172527087374, -0.217392786810272, -0.280772707989591,
                                 0.177875806103046,  0.201192649779528, -0.070747591602360,
                                -0.096509026148137, -0.214493983668610, -0.300294238132779,
                                 0.132946589057416,  0.288828874082449,  0.198367559859818,
                                 0.320152630397259,  0.126923343954733,  0.199894722814091,
                                 0.239006326512523,  0.114482540655537, -0.389430253316650,
                                -0.124862522974734,  0.225692883971217,  0.045871827656226,
                                 0.170654576888727,  0.038887768516672, -0.492487544693929,
                                -0.265792578037872,  0.175330370520716,  0.298178376028657,
                                 3.474587590985533,  2.578487920480574,  0.028293520891176,
                                 0.024110587268697, -0.005498015009990, -0.005463660747301,
                                 0.000116411567457, -0.000330286643014,  0.003245640265673,
                                 0.003122228035217, -0.001264469336186, -0.001271048735608,
                                 0.007355338513117,  0.007215635648191,  0.044390197714380,
                                 0.038123159399283,  0.000250690744247,  0.000251637254066,
                                 0.205647077625585,  0.321477488097703,  0.216464383116023,
                                 0.150133140804837, -0.292442165316720, -0.150326888374208,
                                 0.137123710301459,  0.048778333796385,  0.106679102412380,
                                 0.043679610445243, -0.482807570991711, -0.352541692377054,
                                 0.301659003271170,  0.480772917532400,  2.578487920480574,
                                 2.698654718918641,  0.024110587268697,  0.026999661286588,
                                -0.005463660747301, -0.006083479711474, -0.000330286643014,
                                -0.000315327441310,  0.003122228035217,  0.003486333143956,
                                -0.001271048735608, -0.001397268533830,  0.007215635648191,
                                 0.008086087322139,  0.038123159399283,  0.042663959960894,
                                 0.000251637254066,  0.000278274549525, -0.206335643233953,
                                 0.140323100831573, -0.273696682133603, -0.091963715908973,
                                -0.310303216346214, -0.027784795552434, -0.094229710459572,
                                -0.005524659629217,  0.558712670193213,  0.050295750411718,
                                -0.348673046467148, -0.134104282498969,  0.013579392555949,
                                 0.001500676105406,  0.028293520891176,  0.024110587268697,
                                 3.538517702935191,  2.634101679475617,  0.046681675215264,
                                 0.041345610443234,  0.003150327847346,  0.002804808707416,
                                -0.004467667101000, -0.004175930646790,  0.000585454079810,
                                 0.001679336657875,  0.062359854241753,  0.054356595056153,
                                -0.001863616340291, -0.001863901956766, -0.043175186795051,
                                -0.036903561075787, -0.049048241163231,  0.295228209791229,
                                -0.259684991262238, -0.083278254726296, -0.146947089087909,
                                -0.015489873912342, -0.041445216516089, -0.000361196686549,
                                 0.275481664801898,  0.024748173683426, -0.366544342329929,
                                -0.122870940336142,  0.006144121406331,  0.001301879598740,
                                 0.024110587268697,  0.026999661286588,  2.634101679475617,
                                 2.760958469765402,  0.041345610443234,  0.046263673617302,
                                 0.002804808707416,  0.003087569642281, -0.004175930646790,
                                -0.004669837995675,  0.001679336657875,  0.001853070620862,
                                 0.054356595056153,  0.060916607541699, -0.001863901956766,
                                -0.002062575147156, -0.036903561075787, -0.041315259923083,
                                -0.259741639843945, -0.208454875145862,  0.099798823607161,
                                 0.203902529832870, -0.331853750066589, -0.125870561484611,
                                -0.101831214410958,  0.050628466066364, -0.304708915236463,
                                -0.162941439272052,  0.116197988130989,  0.002628288560144,
                                 0.530862679996508,  0.331987659635773, -0.005498015009990,
                                -0.005463660747301,  0.046681675215264,  0.041345610443234,
                                 3.637350945516853,  2.726547037387453,  0.083551349692954,
                                 0.078826929644507, -0.051351798301188, -0.046290647090463,
                                 0.082995097181347,  0.076512139404940, -0.021237914966400,
                                -0.021004544790756, -0.084459405801862, -0.076453729855153,
                                -0.009048418043576, -0.008925313631502, -0.316565949473913,
                                -0.294558959261469,  0.131883497805104,  0.374004632887424,
                                -0.266938650379810, -0.148075553685135,  0.030039011271399,
                                 0.079627587090795, -0.335971101341497, -0.187548335171618,
                                 0.035493241427786, -0.002103240188098,  0.544939979697584,
                                 0.460172527087374, -0.005463660747301, -0.006083479711474,
                                 0.041345610443234,  0.046263673617302,  2.726547037387453,
                                 2.863921596644260,  0.078826929644507,  0.087752630956915,
                                -0.046290647090463, -0.051760481943523,  0.076512139404940,
                                 0.085348837430947, -0.021004544790756, -0.023283808588019,
                                -0.076453729855153, -0.085370254990487, -0.008925313631502,
                                -0.009974676460764, -0.460040407901132, -0.139156160065986,
                                -0.252557853116796, -0.101260846120252, -0.536092566092608,
                                -0.010796495090188,  0.054606401031907, -0.077509949681888,
                                 0.025574429060702, -0.053304402689018,  0.022278765047029,
                                 0.182022540488575, -0.454935054707313, -0.217392786810272,
                                 0.000116411567457, -0.000330286643014,  0.003150327847346,
                                 0.002804808707416,  0.083551349692954,  0.078826929644507,
                                 3.663928921153976,  2.748761951474151,  0.023741293549964,
                                 0.020243166278018,  0.069751278003412,  0.065123348278219,
                                -0.070295518973921, -0.063993662886393, -0.012391600331178,
                                -0.013869014274793, -0.001123442257539, -0.001297590655861,
                                -0.330346851913075, -0.167148813380665, -0.160227216214568,
                                -0.149524660004539, -0.356382561335472,  0.116262129067970,
                                -0.131091601513125, -0.080025812140254, -0.019061737929331,
                                -0.091456803316431,  0.165766951032411,  0.290138485015258,
                                -0.424112086055893, -0.280772707989591, -0.000330286643014,
                                -0.000315327441310,  0.002804808707416,  0.003087569642281,
                                 0.078826929644507,  0.087752630956915,  2.748761951474151,
                                 2.888869885803429,  0.020243166278018,  0.022784383405884,
                                 0.065123348278219,  0.072610168872129, -0.063993662886393,
                                -0.071464804729619, -0.013869014274793, -0.015278052885122,
                                -0.001297590655861, -0.001408476761562, -0.140130275567218,
                                -0.034801788150596, -0.201951266216922,  0.140995478225238,
                                 0.348832838521945, -0.025181034144324, -0.339309213832757,
                                -0.028158098202713,  0.232555225681297, -0.016787356096216,
                                 0.084146360923718, -0.058748115927182,  0.716221408454671,
                                 0.177875806103046,  0.003245640265673,  0.003122228035217,
                                -0.004467667101000, -0.004175930646790, -0.051351798301188,
                                -0.046290647090463,  0.023741293549964,  0.020243166278018,
                                 3.610384526879928,  2.696453358939132,  0.015827529033309,
                                 0.013495444185345,  0.021396582625496,  0.019287769621026,
                                 0.022834742960667,  0.021343645528039,  0.003218593263458,
                                 0.003096209468257, -0.093069153559254, -0.039363779304691,
                                 0.071090831660529,  0.229375829841804,  0.161870115234910,
                                -0.099861538355234, -0.351735494586383,  0.092057297090479,
                                 0.107913410156607, -0.066574358903490, -0.029621179858554,
                                -0.095573262434085,  0.475686784858404,  0.201192649779528,
                                 0.003122228035217,  0.003486333143956, -0.004175930646790,
                                -0.004669837995675, -0.046290647090463, -0.051760481943523,
                                 0.020243166278018,  0.022784383405884,  2.696453358939132,
                                 2.830779385136692,  0.013495444185345,  0.015189588937256,
                                 0.019287769621025,  0.021566867476469,  0.021343645528039,
                                 0.023868060866785,  0.003096209468257,  0.003457280367758,
                                 0.839054536515244,  0.286376217193760, -0.104561383807375,
                                -0.175069170186684,  0.025574429060702, -0.053304402689018,
                                 0.036404267354604, -0.051673299787926, -0.557404590309861,
                                 0.033623840483993,  0.167997753880527, -0.136800294329920,
                                -0.079121921774934, -0.070747591602360, -0.001264469336186,
                                -0.001271048735608,  0.000585454079810,  0.001679336657875,
                                 0.082995097181347,  0.076512139404940,  0.069751278003412,
                                 0.065123348278219,  0.015827529033309,  0.013495444185345,
                                 3.605802856151133,  2.694492494575635,  0.018642394410558,
                                 0.014843605216382, -0.008557433851926, -0.009283288262695,
                                 0.000604393501183,  0.000194627939497,  0.642289812999968,
                                 0.352006106879535, -0.182976306406898, -0.274941986167154,
                                -0.019061737929331, -0.091456803316431, -0.087394401008750,
                                -0.053350541426836, -0.340497779727696,  0.192476131831662,
                                -0.072268288744971, -0.227195654117070, -0.113987272693533,
                                -0.096509026148137, -0.001271048735608, -0.001397268533830,
                                 0.001679336657875,  0.001853070620862,  0.076512139404940,
                                 0.085348837430947,  0.065123348278219,  0.072610168872129,
                                 0.013495444185345,  0.015189588937256,  2.694492494575635,
                                 2.828361411743325,  0.014843605216382,  0.016789797150130,
                                -0.009283288262695, -0.010225537769775,  0.000194627939497,
                                 0.000258040944013, -0.314641189028142, -0.302435628585934,
                                 0.116197988130989,  0.002628288560144,  0.246787402277437,
                                 0.155182118385594,  0.042429672671233, -0.021095194194319,
                                -0.035810461609344, -0.086211810287153,  0.330258166733622,
                                 0.209115302143823, -0.303927606172488, -0.214493983668610,
                                 0.007355338513117,  0.007215635648191,  0.062359854241753,
                                 0.054356595056153, -0.021237914966400, -0.021004544790756,
                                -0.070295518973921, -0.063993662886393,  0.021396582625496,
                                 0.019287769621025,  0.018642394410558,  0.014843605216382,
                                 3.595229080833495,  2.684888023552452,  0.051197831480479,
                                 0.045861272830970, -0.001336883555298, -0.001261734785903,
                                -0.437646748606383, -0.432107269003996,  0.035493241427786,
                                -0.002103240188098,  0.316640039073031,  0.177178836564793,
                                -0.012516254696416, -0.033178161287832, -0.168135443229876,
                                -0.095075894139141,  0.202278426636879,  0.369833206514363,
                                -0.338491869395398, -0.300294238132779,  0.007215635648191,
                                 0.008086087322139,  0.054356595056153,  0.060916607541699,
                                -0.021004544790756, -0.023283808588019, -0.063993662886393,
                                -0.071464804729619,  0.019287769621026,  0.021566867476469,
                                 0.014843605216382,  0.016789797150130,  2.684888023552452,
                                 2.817742042944695,  0.045861272830970,  0.051260901404156,
                                -0.001261734785903, -0.001441838531401,  0.013579392555949,
                                 0.001500676105406,  0.527115414147117,  0.145182789477716,
                                -0.289125642602341, -0.026545375173857,  0.481618520126700,
                                 0.028237149216000, -0.042962747318599, -0.004232340108222,
                                -0.310162291609241, -0.094227665408817, -0.273084589734815,
                                 0.132946589057416,  0.044390197714380,  0.038123159399283,
                                -0.001863616340291, -0.001863901956766, -0.084459405801862,
                                -0.076453729855153, -0.012391600331178, -0.013869014274793,
                                 0.022834742960667,  0.021343645528039, -0.008557433851926,
                                -0.009283288262695,  0.051197831480479,  0.045861272830970,
                                 3.547678232530579,  2.643263613007064,  0.030083402115111,
                                 0.025907226381350,  0.006144121406331,  0.001301879598740,
                                 0.432829063607062,  0.128772996986968, -0.163610144498878,
                                -0.006737269761405,  0.211831106637789,  0.001846116397917,
                                -0.036007831454081,  0.002370939143662, -0.273230612695756,
                                -0.084484370155778, -0.079249417641210,  0.288828874082449,
                                 0.038123159399283,  0.042663959960894, -0.001863901956766,
                                -0.002062575147156, -0.076453729855153, -0.085370254990487,
                                -0.013869014274793, -0.015278052885122,  0.021343645528039,
                                 0.023868060866785, -0.009283288262695, -0.010225537769775,
                                 0.045861272830970,  0.051260901404156,  2.643263613007064,
                                 2.771096973206129,  0.025907226381350,  0.028986485302729,
                                -0.184711059237137, -0.299215047982206,  0.516007742536756,
                                 0.268391825298140,  0.011005593940955, -0.011083177265859,
                                 0.223812109938124,  0.045489562425758, -0.426553437305296,
                                -0.130544533247094,  0.181200043166929,  0.108094294067800,
                                 0.113104275883836,  0.198367559859818,  0.000250690744247,
                                 0.000251637254066, -0.043175186795051, -0.036903561075787,
                                -0.009048418043576, -0.008925313631502, -0.001123442257539,
                                -0.001297590655861,  0.003218593263458,  0.003096209468257,
                                 0.000604393501183,  0.000194627939497, -0.001336883555298,
                                -0.001261734785903,  0.030083402115111,  0.025907226381350,
                                 3.474583395251088,  2.578483708904679, -0.305903382400148,
                                -0.481672260210044,  0.493449501435347,  0.354796613987408,
                                -0.011557971025683, -0.016241018651642,  0.135981012715613,
                                 0.048371847681415, -0.311880654477820, -0.155934104787641,
                                 0.190309397061918,  0.144591153513687,  0.199394512821960,
                                 0.320152630397259,  0.000251637254066,  0.000278274549525,
                                -0.036903561075787, -0.041315259923083, -0.008925313631502,
                                -0.009974676460764, -0.001297590655861, -0.001408476761562,
                                 0.003096209468257,  0.003457280367758,  0.000194627939497,
                                 0.000258040944013, -0.001261734785903, -0.001441838531401,
                                 0.025907226381350,  0.028986485302729,  2.578483708904679,
                                 2.698650061522470};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,
                              28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,
                              28, 28, 28, 28, 28, 28, 28, 28, 29, 29, 29, 29, 29,
                              29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29,
                              29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29,
                              29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
                              30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
                              30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 31,
                              31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31,
                              31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
                              30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
                              26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
                              31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
                              27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
                              30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
                              26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
                              31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
                              27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 32, 32, 1.0e-13));
}

TEST_F(CNuclearPotentialIntegralsDriverTest, ComputeGGForLiH)
{
    CNuclearPotentialIntegralsDriver npotdrv(mpi::master(), mpi::nodes(MPI_COMM_WORLD),
                                             MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH(4, 4);
    
    auto npotmat = npotdrv.compute(mlih, mbas, MPI_COMM_WORLD);
    
    std::vector<double> intvals{ 3.474587590985533,  2.578487920480574, -0.204986074308824,
                                 0.025585719860120,  0.028293520891176,  0.024110587268697,
                                -0.189106506656511, -0.273549593220990, -0.005498015009990,
                                -0.005463660747301, -0.284419971954827, -0.137300318813979,
                                 0.000116411567457, -0.000330286643014,  0.473760320302692,
                                 0.158874838842672,  0.003245640265673,  0.003122228035217,
                                -0.289911829365999, -0.061208459262206, -0.001264469336186,
                                -0.001271048735608, -0.224602916436719, -0.050532129308808,
                                 0.007355338513117,  0.007215635648191,  0.559653398823313,
                                 0.315890795120668,  0.044390197714380,  0.038123159399283,
                                -0.257803440919057, -0.408151438026285,  0.000250690744247,
                                 0.000251637254066,  0.003324214281434,  0.000279365264845,
                                 2.578487920480574,  2.698654718918641, -0.132864740897985,
                                 0.127658363303601,  0.024110587268697,  0.026999661286588,
                                -0.243035553357281, -0.384339026413734, -0.005463660747301,
                                -0.006083479711474, -0.206630436684250, -0.165144495120644,
                                -0.000330286643014, -0.000315327441310,  0.297241089377820,
                                 0.174894712042765,  0.003122228035217,  0.003486333143956,
                                -0.146524134184470, -0.061242673248464, -0.001271048735608,
                                -0.001397268533830, -0.115136452289624, -0.051923670056512,
                                 0.007215635648191,  0.008086087322139,  0.449314694857421,
                                 0.384801193957882,  0.038123159399283,  0.042663959960894,
                                -0.355758175148898, -0.574844814000336,  0.000251637254066,
                                 0.000278274549525,  0.001130747938582,  0.000213896666931,
                                -0.204986074308824, -0.132864740897985,  3.003272845956699,
                                 1.213900698796220, -0.189106506656511, -0.243035553357281,
                                 0.083064703295064,  0.039855058707057, -0.284419971954827,
                                -0.206630436684250, -0.013921681609226, -0.009215874368535,
                                 0.473760320302692,  0.297241089377819,  0.001578609714113,
                                -0.000658448989035, -0.289911829366000, -0.146524134184469,
                                 0.008515351649315,  0.005243791588594, -0.224602916436717,
                                -0.115136452289623, -0.003153652116547, -0.002152103687203,
                                 0.559653398823314,  0.449314694857421,  0.018909908341683,
                                 0.012137417241391, -0.257803440919057, -0.355758175148898,
                                 0.129473548473349,  0.063092274290374,  0.003324214281434,
                                 0.001130747938582,  0.000626945753456,  0.000425509377579,
                                 0.025585719860120,  0.127658363303601,  1.213900698796220,
                                 2.079262852380217, -0.273549593220990, -0.384339026413734,
                                 0.039855058707057,  0.063118240620152, -0.137300318813979,
                                -0.165144495120645, -0.009215874368535, -0.009931928773966,
                                 0.158874838842672,  0.174894712042765, -0.000658448989035,
                                 0.001680016871824, -0.061208459262206, -0.061242673248464,
                                 0.005243791588594,  0.006172832267994, -0.050532129308808,
                                -0.051923670056512, -0.002152103687203, -0.002194867512680,
                                 0.315890795120669,  0.384801193957881,  0.012137417241391,
                                 0.013722104243975, -0.408151438026285, -0.574844814000336,
                                 0.063092274290374,  0.098095422808380,  0.000279365264845,
                                 0.000213896666931,  0.000425509377579,  0.000439442678647,
                                 0.028293520891176,  0.024110587268697, -0.189106506656511,
                                -0.273549593220990,  3.538517702935191,  2.634101679475617,
                                 0.238643332295442, -0.050614536766353,  0.046681675215264,
                                 0.041345610443234,  0.071910936262096, -0.087162266577496,
                                 0.003150327847346,  0.002804808707416,  0.217447412309272,
                                -0.030323037203771, -0.004467667101000, -0.004175930646790,
                                 0.064057601390443, -0.007959658762103,  0.000585454079810,
                                 0.001679336657875, -0.354525695461056,  0.071499451010489,
                                 0.062359854241753,  0.054356595056153,  0.044747806525237,
                                -0.133259863643456, -0.001863616340291, -0.001863901956766,
                                -0.015983709813175, -0.000711038143728, -0.043175186795051,
                                -0.036903561075787,  0.273914752336893,  0.409505424382214,
                                 0.024110587268697,  0.026999661286588, -0.243035553357281,
                                -0.384339026413734,  2.634101679475617,  2.760958469765402,
                                 0.044869991437089, -0.065174603908893,  0.041345610443234,
                                 0.046263673617302,  0.008426927739665, -0.157932316770520,
                                 0.002804808707416,  0.003087569642281,  0.048360661121327,
                                -0.059028694251005, -0.004175930646790, -0.004669837995675,
                                 0.012004365791777, -0.014044111084254,  0.001679336657875,
                                 0.001853070620862, -0.072947444573448,  0.132479604114054,
                                 0.054356595056153,  0.060916607541699, -0.004792024929336,
                                -0.237886750137717, -0.001863901956766, -0.002062575147156,
                                -0.004521323389004, -0.000331595834599, -0.036903561075787,
                                -0.041315259923083,  0.361238517458754,  0.575881496813299,
                                -0.189106506656511, -0.243035553357281,  0.083064703295064,
                                 0.039855058707057,  0.238643332295442,  0.044869991437089,
                                 3.187752389649002,  1.306076478719369,  0.071910936262096,
                                 0.008426927739665,  0.132599269407999,  0.068705352967274,
                                 0.217447412309272,  0.048360661121327,  0.008887509030065,
                                 0.004679246004160,  0.064057601390443,  0.012004365791778,
                                -0.012068998812081, -0.006987217657977, -0.354525695461056,
                                -0.072947444573448, -0.001635740087389,  0.003048083298650,
                                 0.044747806525237, -0.004792024929336,  0.179648707563497,
                                 0.090109626923777, -0.015983709813175, -0.004521323389004,
                                -0.004680364934214, -0.003150099278026,  0.273914752336892,
                                 0.361238517458754, -0.126434960277506, -0.061029978206855,
                                -0.273549593220990, -0.384339026413734,  0.039855058707057,
                                 0.063118240620152, -0.050614536766353, -0.065174603908893,
                                 1.306076478719369,  2.218725892099505, -0.087162266577495,
                                -0.157932316770519,  0.068705352967274,  0.099538382672895,
                                -0.030323037203771, -0.059028694251005,  0.004679246004160,
                                 0.006531392918573, -0.007959658762103, -0.014044111084254,
                                -0.006987217657977, -0.008883786114476,  0.071499451010488,
                                 0.132479604114054,  0.003048083298650, -0.002190511077071,
                                -0.133259863643456, -0.237886750137717,  0.090109626923777,
                                 0.135771991486161, -0.000711038143728, -0.000331595834599,
                                -0.003150099278026, -0.003290254167836,  0.409505424382215,
                                 0.575881496813299, -0.061029978206855, -0.095965596856573,
                                -0.005498015009990, -0.005463660747301, -0.284419971954827,
                                -0.137300318813979,  0.046681675215264,  0.041345610443234,
                                 0.071910936262096, -0.087162266577495,  3.637350945516853,
                                 2.726547037387453, -0.273174110720996, -0.341961926634549,
                                 0.083551349692954,  0.078826929644507,  0.314459986269418,
                                 0.033183240067805, -0.051351798301188, -0.046290647090463,
                                -0.192364804230368, -0.032426636588093,  0.082995097181347,
                                 0.076512139404940,  0.379709830701023,  0.034208398392744,
                                -0.021237914966400, -0.021004544790756, -0.075926658239190,
                                -0.007616610340892, -0.084459405801862, -0.076453729855153,
                                -0.226785501825435,  0.126002236228016, -0.009048418043576,
                                -0.008925313631502, -0.595299881331342, -0.319842341054571,
                                -0.005463660747301, -0.006083479711474, -0.206630436684250,
                                -0.165144495120645,  0.041345610443234,  0.046263673617302,
                                 0.008426927739665, -0.157932316770519,  2.726547037387453,
                                 2.863921596644260, -0.328257735218364, -0.449339064278194,
                                 0.078826929644507,  0.087752630956915,  0.154560522132983,
                                 0.002613617272280, -0.046290647090463, -0.051760481943523,
                                -0.141972917977200,  0.001972782097701,  0.076512139404940,
                                 0.085348837430947,  0.207119137930004, -0.017131202433479,
                                -0.021004544790756, -0.023283808588019, -0.020706806220768,
                                -0.008752848986340, -0.076453729855153, -0.085370254990487,
                                -0.045484074943532,  0.235036507798505, -0.008925313631502,
                                -0.009974676460764, -0.462824301453009, -0.388148446096054,
                                -0.284419971954827, -0.206630436684250, -0.013921681609226,
                                -0.009215874368535,  0.071910936262096,  0.008426927739665,
                                 0.132599269407999,  0.068705352967274, -0.273174110720996,
                                -0.328257735218364,  3.454395284543255,  1.460895665547285,
                                 0.314459986269418,  0.154560522132983,  0.223480122686521,
                                 0.132162521859241, -0.192364804230369, -0.141972917977200,
                                -0.143558959884823, -0.077107504692447,  0.379709830701023,
                                 0.207119137930004,  0.227134148978855,  0.127868110920420,
                                -0.075926658239190, -0.020706806220767, -0.054024950863989,
                                -0.035441676819435, -0.226785501825435, -0.045484074943532,
                                -0.235167390362799, -0.127453570444064, -0.595299881331342,
                                -0.462824301453009, -0.023114306656439, -0.015030976089177,
                                -0.137300318813979, -0.165144495120644, -0.009215874368535,
                                -0.009931928773966, -0.087162266577496, -0.157932316770520,
                                 0.068705352967274,  0.099538382672895, -0.341961926634549,
                                -0.449339064278194,  1.460895665547285,  2.413849781863635,
                                 0.033183240067805,  0.002613617272281,  0.132162521859241,
                                 0.162897834626554, -0.032426636588093,  0.001972782097701,
                                -0.077107504692447, -0.107060499760845,  0.034208398392744,
                                -0.017131202433479,  0.127868110920420,  0.167526249594067,
                                -0.007616610340892, -0.008752848986340, -0.035441676819435,
                                -0.038303715460235,  0.126002236228016,  0.235036507798505,
                                -0.127453570444064, -0.174809396154466, -0.319842341054571,
                                -0.388148446096054, -0.015030976089177, -0.016654466479835,
                                 0.000116411567457, -0.000330286643014,  0.473760320302692,
                                 0.158874838842672,  0.003150327847346,  0.002804808707416,
                                 0.217447412309272, -0.030323037203771,  0.083551349692954,
                                 0.078826929644507,  0.314459986269418,  0.033183240067805,
                                 3.663928921153976,  2.748761951474151,  0.055603308846730,
                                -0.399103782287418,  0.023741293549964,  0.020243166278018,
                                -0.037834379984139,  0.020813063711452,  0.069751278003412,
                                 0.065123348278219,  0.048731765175139,  0.039543481412724,
                                -0.070295518973921, -0.063993662886393, -0.352115786090092,
                                -0.029538459880055, -0.012391600331178, -0.013869014274793,
                                 0.111992225778163, -0.069650410027065, -0.001123442257539,
                                -0.001297590655861, -0.029075731336306,  0.013131651299228,
                                -0.000330286643014, -0.000315327441310,  0.297241089377819,
                                 0.174894712042765,  0.002804808707416,  0.003087569642281,
                                 0.048360661121327, -0.059028694251005,  0.078826929644507,
                                 0.087752630956915,  0.154560522132983,  0.002613617272281,
                                 2.748761951474151,  2.888869885803429, -0.213817815865693,
                                -0.582698511944095,  0.020243166278018,  0.022784383405884,
                                 0.049347967789759,  0.005585767750492,  0.065123348278219,
                                 0.072610168872129,  0.081537186859482,  0.027533880101460,
                                -0.063993662886393, -0.071464804729619, -0.199702644349163,
                                 0.023446690936049, -0.013869014274793, -0.015278052885122,
                                 0.010457383533249, -0.119161832971505, -0.001297590655861,
                                -0.001408476761562,  0.005556558763670,  0.017874752739555,
                                 0.473760320302692,  0.297241089377820,  0.001578609714113,
                                -0.000658448989035,  0.217447412309272,  0.048360661121327,
                                 0.008887509030065,  0.004679246004160,  0.314459986269418,
                                 0.154560522132983,  0.223480122686521,  0.132162521859241,
                                 0.055603308846730, -0.213817815865693,  3.533678762391258,
                                 1.497498623392848, -0.037834379984138,  0.049347967789758,
                                 0.069710415465437,  0.033430003079897,  0.048731765175138,
                                 0.081537186859481,  0.188550664006585,  0.109014945335631,
                                -0.352115786090092, -0.199702644349163, -0.194708338463578,
                                -0.106755409359887,  0.111992225778163,  0.010457383533249,
                                -0.026906696991985, -0.023741233601018, -0.029075731336306,
                                 0.005556558763670, -0.002317196933221, -0.002234375155657,
                                 0.158874838842672,  0.174894712042765, -0.000658448989035,
                                 0.001680016871824, -0.030323037203771, -0.059028694251005,
                                 0.004679246004160,  0.006531392918573,  0.033183240067805,
                                 0.002613617272280,  0.132162521859241,  0.162897834626554,
                                -0.399103782287418, -0.582698511944095,  1.497498623392848,
                                 2.474625653375880,  0.020813063711453,  0.005585767750492,
                                 0.033430003079897,  0.053281022699056,  0.039543481412724,
                                 0.027533880101461,  0.109014945335631,  0.138304927472457,
                                -0.029538459880055,  0.023446690936049, -0.106755409359887,
                                -0.144480098890337, -0.069650410027065, -0.119161832971505,
                                -0.023741233601018, -0.017352723600471,  0.013131651299227,
                                 0.017874752739555, -0.002234375155657, -0.001393978494386,
                                 0.003245640265673,  0.003122228035217, -0.289911829366000,
                                -0.061208459262206, -0.004467667101000, -0.004175930646790,
                                 0.064057601390443, -0.007959658762103, -0.051351798301188,
                                -0.046290647090463, -0.192364804230369, -0.032426636588093,
                                 0.023741293549964,  0.020243166278018, -0.037834379984138,
                                 0.020813063711453,  3.610384526879928,  2.696453358939132,
                                 0.100366898161862, -0.422787458697087,  0.015827529033309,
                                 0.013495444185345, -0.025222919989425,  0.013875375807634,
                                 0.021396582625496,  0.019287769621026,  0.080152001762653,
                                 0.013511098578373,  0.022834742960667,  0.021343645528039,
                                -0.327405518217819,  0.040682700339636,  0.003218593263458,
                                 0.003096209468257, -0.287495897454616, -0.060698388768354,
                                 0.003122228035217,  0.003486333143956, -0.146524134184469,
                                -0.061242673248464, -0.004175930646790, -0.004669837995675,
                                 0.012004365791778, -0.014044111084254, -0.046290647090463,
                                -0.051760481943523, -0.141972917977200,  0.001972782097701,
                                 0.020243166278018,  0.022784383405884,  0.049347967789758,
                                 0.005585767750492,  2.696453358939132,  2.830779385136692,
                                -0.204339211142936, -0.622194642525827,  0.013495444185345,
                                 0.015189588937256,  0.032898645193173,  0.003723845166995,
                                 0.019287769621025,  0.021566867476469,  0.059155382490500,
                                -0.000821992540709,  0.021343645528039,  0.023868060866785,
                                -0.061355647380197,  0.071781012208410,  0.003096209468257,
                                 0.003457280367758, -0.145303099732931, -0.060732317638060,
                                -0.289911829365999, -0.146524134184470,  0.008515351649315,
                                 0.005243791588594,  0.064057601390443,  0.012004365791777,
                                -0.012068998812081, -0.006987217657977, -0.192364804230368,
                                -0.141972917977200, -0.143558959884823, -0.077107504692447,
                                -0.037834379984139,  0.049347967789759,  0.069710415465437,
                                 0.033430003079897,  0.100366898161862, -0.204339211142936,
                                 3.395594910542604,  1.409393007079869, -0.025222919989425,
                                 0.032898645193172,  0.046473610310292,  0.022286668719931,
                                 0.080152001762655,  0.059155382490500,  0.059816233285344,
                                 0.032128126955186, -0.327405518217819, -0.061355647380197,
                                 0.061685993928415,  0.035712445807440, -0.287495897454615,
                                -0.145303099732932,  0.008444390385572,  0.005200093325356,
                                -0.061208459262206, -0.061242673248464,  0.005243791588594,
                                 0.006172832267994, -0.007959658762103, -0.014044111084254,
                                -0.006987217657977, -0.008883786114476, -0.032426636588093,
                                 0.001972782097701, -0.077107504692447, -0.107060499760845,
                                 0.020813063711452,  0.005585767750492,  0.033430003079897,
                                 0.053281022699056, -0.422787458697087, -0.622194642525827,
                                 1.409393007079869,  2.375861213692788,  0.013875375807635,
                                 0.003723845166995,  0.022286668719931,  0.035520681799371,
                                 0.013511098578372, -0.000821992540709,  0.032128126955186,
                                 0.044608541567018,  0.040682700339635,  0.071781012208410,
                                 0.035712445807440,  0.045406017918435, -0.060698388768355,
                                -0.060732317638060,  0.005200093325356,  0.006121391999095,
                                -0.001264469336186, -0.001271048735608, -0.224602916436717,
                                -0.050532129308808,  0.000585454079810,  0.001679336657875,
                                -0.354525695461056,  0.071499451010488,  0.082995097181347,
                                 0.076512139404940,  0.379709830701023,  0.034208398392744,
                                 0.069751278003412,  0.065123348278219,  0.048731765175138,
                                 0.039543481412724,  0.015827529033309,  0.013495444185345,
                                -0.025222919989425,  0.013875375807635,  3.605802856151133,
                                 2.694492494575635,  0.014993504534114, -0.432056683464687,
                                 0.018642394410558,  0.014843605216382,  0.173423758257993,
                                 0.009314665447395, -0.008557433851926, -0.009283288262695,
                                -0.023064945126264, -0.028489404895210,  0.000604393501183,
                                 0.000194627939497,  0.525600847988301,  0.166517817598398,
                                -0.001271048735608, -0.001397268533830, -0.115136452289623,
                                -0.051923670056512,  0.001679336657875,  0.001853070620862,
                                -0.072947444573448,  0.132479604114054,  0.076512139404940,
                                 0.085348837430947,  0.207119137930004, -0.017131202433479,
                                 0.065123348278219,  0.072610168872129,  0.081537186859481,
                                 0.027533880101461,  0.013495444185345,  0.015189588937256,
                                 0.032898645193172,  0.003723845166995,  2.694492494575635,
                                 2.828361411743325, -0.281765471581928, -0.605643412028645,
                                 0.014843605216382,  0.016789797150130,  0.116653999386461,
                                -0.029665546185299, -0.009283288262695, -0.010225537769775,
                                -0.013608649410203, -0.045821904534645,  0.000194627939497,
                                 0.000258040944013,  0.319634300450125,  0.181852782248241,
                                -0.224602916436719, -0.115136452289624, -0.003153652116547,
                                -0.002152103687203, -0.354525695461056, -0.072947444573448,
                                -0.001635740087389,  0.003048083298650,  0.379709830701023,
                                 0.207119137930004,  0.227134148978855,  0.127868110920420,
                                 0.048731765175139,  0.081537186859482,  0.188550664006585,
                                 0.109014945335631, -0.025222919989425,  0.032898645193173,
                                 0.046473610310292,  0.022286668719931,  0.014993504534114,
                                -0.281765471581928,  3.376553209052437,  1.406652835613155,
                                 0.173423758257993,  0.116653999386461,  0.057748202275101,
                                 0.024253158327630, -0.023064945126264, -0.013608649410204,
                                -0.019417074406980, -0.015841461379022,  0.525600847988302,
                                 0.319634300450125,  0.002696605667332,  0.000237950372488,
                                -0.050532129308808, -0.051923670056512, -0.002152103687203,
                                -0.002194867512680,  0.071499451010489,  0.132479604114054,
                                 0.003048083298650, -0.002190511077071,  0.034208398392744,
                                -0.017131202433479,  0.127868110920420,  0.167526249594067,
                                 0.039543481412724,  0.027533880101460,  0.109014945335631,
                                 0.138304927472457,  0.013875375807634,  0.003723845166995,
                                 0.022286668719931,  0.035520681799371, -0.432056683464687,
                                -0.605643412028645,  1.406652835613155,  2.359371547148832,
                                 0.009314665447394, -0.029665546185299,  0.024253158327630,
                                 0.045106397696382, -0.028489404895210, -0.045821904534644,
                                -0.015841461379022, -0.012848981469989,  0.166517817598399,
                                 0.181852782248240,  0.000237950372488,  0.002413415888344,
                                 0.007355338513117,  0.007215635648191,  0.559653398823314,
                                 0.315890795120669,  0.062359854241753,  0.054356595056153,
                                 0.044747806525237, -0.133259863643456, -0.021237914966400,
                                -0.021004544790756, -0.075926658239190, -0.007616610340892,
                                -0.070295518973921, -0.063993662886393, -0.352115786090092,
                                -0.029538459880055,  0.021396582625496,  0.019287769621025,
                                 0.080152001762655,  0.013511098578372,  0.018642394410558,
                                 0.014843605216382,  0.173423758257993,  0.009314665447394,
                                 3.595229080833495,  2.684888023552452, -0.423761982895390,
                                -0.357068203810651,  0.051197831480479,  0.045861272830970,
                                 0.109111269305018, -0.085679133336819, -0.001336883555298,
                                -0.001261734785903, -0.196810561442945, -0.127588487925705,
                                 0.007215635648191,  0.008086087322139,  0.449314694857421,
                                 0.384801193957881,  0.054356595056153,  0.060916607541699,
                                -0.004792024929336, -0.237886750137717, -0.021004544790756,
                                -0.023283808588019, -0.020706806220767, -0.008752848986340,
                                -0.063993662886393, -0.071464804729619, -0.199702644349163,
                                 0.023446690936049,  0.019287769621026,  0.021566867476469,
                                 0.059155382490500, -0.000821992540709,  0.014843605216382,
                                 0.016789797150130,  0.116653999386461, -0.029665546185299,
                                 2.684888023552452,  2.817742042944695, -0.369326234222885,
                                -0.466698881434434,  0.045861272830970,  0.051260901404156,
                                 0.018701105603133, -0.157349855186962, -0.001261734785903,
                                -0.001441838531401, -0.173427478445095, -0.156917854901829,
                                 0.559653398823313,  0.449314694857421,  0.018909908341683,
                                 0.012137417241391,  0.044747806525237, -0.004792024929336,
                                 0.179648707563497,  0.090109626923777, -0.075926658239190,
                                -0.020706806220768, -0.054024950863989, -0.035441676819435,
                                -0.352115786090092, -0.199702644349163, -0.194708338463578,
                                -0.106755409359887,  0.080152001762653,  0.059155382490500,
                                 0.059816233285344,  0.032128126955186,  0.173423758257993,
                                 0.116653999386461,  0.057748202275101,  0.024253158327630,
                                -0.423761982895390, -0.369326234222885,  3.347245798663011,
                                 1.390603006522073,  0.109111269305018,  0.018701105603133,
                                 0.143944795876198,  0.076336778611286, -0.196810561442946,
                                -0.173427478445096, -0.003588407973325, -0.002104289519202,
                                 0.315890795120668,  0.384801193957882,  0.012137417241391,
                                 0.013722104243975, -0.133259863643456, -0.237886750137717,
                                 0.090109626923777,  0.135771991486161, -0.007616610340892,
                                -0.008752848986340, -0.035441676819435, -0.038303715460235,
                                -0.029538459880055,  0.023446690936049, -0.106755409359887,
                                -0.144480098890337,  0.013511098578373, -0.000821992540709,
                                 0.032128126955186,  0.044608541567018,  0.009314665447395,
                                -0.029665546185299,  0.024253158327630,  0.045106397696382,
                                -0.357068203810651, -0.466698881434434,  1.390603006522073,
                                 2.337880746200838, -0.085679133336819, -0.157349855186962,
                                 0.076336778611286,  0.107515875754190, -0.127588487925705,
                                -0.156917854901830, -0.002104289519202, -0.002724975694288,
                                 0.044390197714380,  0.038123159399283, -0.257803440919057,
                                -0.408151438026285, -0.001863616340291, -0.001863901956766,
                                -0.015983709813175, -0.000711038143728, -0.084459405801862,
                                -0.076453729855153, -0.226785501825435,  0.126002236228016,
                                -0.012391600331178, -0.013869014274793,  0.111992225778163,
                                -0.069650410027065,  0.022834742960667,  0.021343645528039,
                                -0.327405518217819,  0.040682700339635, -0.008557433851926,
                                -0.009283288262695, -0.023064945126264, -0.028489404895210,
                                 0.051197831480479,  0.045861272830970,  0.109111269305018,
                                -0.085679133336819,  3.547678232530579,  2.643263613007064,
                                 0.317210601546192, -0.047119457968079,  0.030083402115111,
                                 0.025907226381350, -0.165372288847454, -0.271554981718010,
                                 0.038123159399283,  0.042663959960894, -0.355758175148898,
                                -0.574844814000336, -0.001863901956766, -0.002062575147156,
                                -0.004521323389004, -0.000331595834599, -0.076453729855153,
                                -0.085370254990487, -0.045484074943532,  0.235036507798505,
                                -0.013869014274793, -0.015278052885122,  0.010457383533249,
                                -0.119161832971505,  0.021343645528039,  0.023868060866785,
                                -0.061355647380197,  0.071781012208410, -0.009283288262695,
                                -0.010225537769775, -0.013608649410204, -0.045821904534644,
                                 0.045861272830970,  0.051260901404156,  0.018701105603133,
                                -0.157349855186962,  2.643263613007064,  2.771096973206129,
                                 0.067094370897529, -0.063544658200177,  0.025907226381350,
                                 0.028986485302729, -0.234962241714487, -0.382811847462023,
                                -0.257803440919057, -0.355758175148898,  0.129473548473349,
                                 0.063092274290374, -0.015983709813175, -0.004521323389004,
                                -0.004680364934214, -0.003150099278026, -0.226785501825435,
                                -0.045484074943532, -0.235167390362799, -0.127453570444064,
                                 0.111992225778163,  0.010457383533249, -0.026906696991985,
                                -0.023741233601018, -0.327405518217819, -0.061355647380197,
                                 0.061685993928415,  0.035712445807440, -0.023064945126264,
                                -0.013608649410203, -0.019417074406980, -0.015841461379022,
                                 0.109111269305018,  0.018701105603133,  0.143944795876198,
                                 0.076336778611286,  0.317210601546192,  0.067094370897529,
                                 3.210758531294226,  1.321560662368604, -0.165372288847455,
                                -0.234962241714487,  0.087540969205506,  0.042893109624429,
                                -0.408151438026285, -0.574844814000336,  0.063092274290374,
                                 0.098095422808380, -0.000711038143728, -0.000331595834599,
                                -0.003150099278026, -0.003290254167836,  0.126002236228016,
                                 0.235036507798505, -0.127453570444064, -0.174809396154466,
                                -0.069650410027065, -0.119161832971505, -0.023741233601018,
                                -0.017352723600471,  0.040682700339636,  0.071781012208410,
                                 0.035712445807440,  0.045406017918435, -0.028489404895210,
                                -0.045821904534645, -0.015841461379022, -0.012848981469989,
                                -0.085679133336819, -0.157349855186962,  0.076336778611286,
                                 0.107515875754190, -0.047119457968079, -0.063544658200177,
                                 1.321560662368604,  2.234899001354447, -0.271554981718010,
                                -0.382811847462023,  0.042893109624429,  0.066255772489816,
                                 0.000250690744247,  0.000251637254066,  0.003324214281434,
                                 0.000279365264845, -0.043175186795051, -0.036903561075787,
                                 0.273914752336892,  0.409505424382215, -0.009048418043576,
                                -0.008925313631502, -0.595299881331342, -0.319842341054571,
                                -0.001123442257539, -0.001297590655861, -0.029075731336306,
                                 0.013131651299227,  0.003218593263458,  0.003096209468257,
                                -0.287495897454615, -0.060698388768355,  0.000604393501183,
                                 0.000194627939497,  0.525600847988302,  0.166517817598399,
                                -0.001336883555298, -0.001261734785903, -0.196810561442946,
                                -0.127588487925705,  0.030083402115111,  0.025907226381350,
                                -0.165372288847455, -0.271554981718010,  3.474583395251088,
                                 2.578483708904679, -0.205041710668296,  0.025581044208978,
                                 0.000251637254066,  0.000278274549525,  0.001130747938582,
                                 0.000213896666931, -0.036903561075787, -0.041315259923083,
                                 0.361238517458754,  0.575881496813299, -0.008925313631502,
                                -0.009974676460764, -0.462824301453009, -0.388148446096054,
                                -0.001297590655861, -0.001408476761562,  0.005556558763670,
                                 0.017874752739555,  0.003096209468257,  0.003457280367758,
                                -0.145303099732932, -0.060732317638060,  0.000194627939497,
                                 0.000258040944013,  0.319634300450125,  0.181852782248240,
                                -0.001261734785903, -0.001441838531401, -0.173427478445096,
                                -0.156917854901830,  0.025907226381350,  0.028986485302729,
                                -0.234962241714487, -0.382811847462023,  2.578483708904679,
                                 2.698650061522470, -0.132883665880991,  0.127654783380395,
                                 0.003324214281434,  0.001130747938582,  0.000626945753456,
                                 0.000425509377579,  0.273914752336893,  0.361238517458754,
                                -0.126434960277506, -0.061029978206855, -0.595299881331342,
                                -0.462824301453009, -0.023114306656439, -0.015030976089177,
                                -0.029075731336306,  0.005556558763670, -0.002317196933221,
                                -0.002234375155657, -0.287495897454616, -0.145303099732931,
                                 0.008444390385572,  0.005200093325356,  0.525600847988301,
                                 0.319634300450125,  0.002696605667332,  0.000237950372488,
                                -0.196810561442945, -0.173427478445095, -0.003588407973325,
                                -0.002104289519202, -0.165372288847454, -0.234962241714487,
                                 0.087540969205506,  0.042893109624429, -0.205041710668296,
                                -0.132883665880991,  3.003262352957049,  1.213893577175685,
                                 0.000279365264845,  0.000213896666931,  0.000425509377579,
                                 0.000439442678647,  0.409505424382214,  0.575881496813299,
                                -0.061029978206855, -0.095965596856573, -0.319842341054571,
                                -0.388148446096054, -0.015030976089177, -0.016654466479835,
                                 0.013131651299228,  0.017874752739555, -0.002234375155657,
                                -0.001393978494386, -0.060698388768354, -0.060732317638060,
                                 0.005200093325356,  0.006121391999095,  0.166517817598398,
                                 0.181852782248241,  0.000237950372488,  0.002413415888344,
                                -0.127588487925705, -0.156917854901829, -0.002104289519202,
                                -0.002724975694288, -0.271554981718010, -0.382811847462023,
                                 0.042893109624429,  0.066255772489816,  0.025581044208978,
                                 0.127654783380395,  1.213893577175685,  2.079255497562280};

    std::vector<int32_t> rows{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                              0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                              1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                              2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                              3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
                              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
                              5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
                              6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
                              7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
                              8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
                              9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                              10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
                              11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,
                              12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
                              13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                              15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16,
                              16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
                              17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
                              18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
                              19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
                              20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
                              21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,
                              22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,
                              23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
                              24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,
                              25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,
                              26, 26, 26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,
                              28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,
                              28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,
                              28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 29, 29, 29,
                              29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29,
                              29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29,
                              29, 29, 29, 29, 29, 29, 29, 30, 30, 30, 30, 30, 30,
                              30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
                              30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
                              30, 30, 30, 30, 31, 31, 31, 31, 31, 31, 31, 31, 31,
                              31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31,
                              31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31,
                              31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32,
                              32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32,
                              32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33,
                              33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,
                              33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,
                              33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34,
                              34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34,
                              34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34,
                              34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 35, 35, 35,
                              35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35,
                              35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35,
                              35, 35};

    std::vector<int32_t> cols{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
                              33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
                              30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
                              35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
                              27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
                              32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
                              34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
                              26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
                              31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
                              33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
                              30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
                              35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
                              27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
                              32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
                              34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
                              13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
                              26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3,
                              4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
                              18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30,
                              31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
                              10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
                              23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
                              0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
                              15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27,
                              28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5,
                              6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                              20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
                              33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,
                              12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                              25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1,
                              2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
                              17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
                              30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8,
                              9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,
                              22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
                              35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,
                              14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,
                              27, 28, 29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4,
                              5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
                              19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
                              32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
                              11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
                              24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 0,
                              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                              16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,
                              29, 30, 31, 32, 33, 34, 35, 0, 1, 2, 3, 4, 5, 6, 7,
                              8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
                              21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
                              34, 35};
    
    ASSERT_EQ(npotmat, CSparseMatrix(intvals, rows, cols, 36, 36, 1.0e-13));
}




