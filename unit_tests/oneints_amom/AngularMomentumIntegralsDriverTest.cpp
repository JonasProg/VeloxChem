//
//                           VELOXCHEM 1.0-RC
//         ----------------------------------------------------
//                     An Electronic Structure Code
//
//  Copyright Â© 2018-2021 by VeloxChem developers. All rights reserved.
//  Contact: https://veloxchem.org/contact
//
//  SPDX-License-Identifier: LGPL-3.0-or-later
//
//  This file is part of VeloxChem.
//
//  VeloxChem is free software: you can redistribute it and/or modify it under
//  the terms of the GNU Lesser General Public License as published by the Free
//  Software Foundation, either version 3 of the License, or (at your option)
//  any later version.
//
//  VeloxChem is distributed in the hope that it will be useful, but WITHOUT
//  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
//  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public
//  License for more details.
//
//  You should have received a copy of the GNU Lesser General Public License
//  along with VeloxChem. If not, see <https://www.gnu.org/licenses/>.

#include "AngularMomentumIntegralsDriverTest.hpp"

#include <mpi.h>

#include "AngularMomentumIntegralsDriver.hpp"
#include "MolecularBasisSetter.hpp"
#include "MoleculeSetter.hpp"

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeSSForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix amomxmat(4, 4);

    CDenseMatrix amomymat(4, 4);

    CDenseMatrix amomzmat(4, 4);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{0.000000000000000,
                                 -0.000000000000000,
                                 0.127944518802996,
                                 0.145535821281024,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.146032908655964,
                                 0.162329148804550,
                                 -0.127944518802996,
                                 -0.146032908655964,
                                 0.000000000000001,
                                 -0.000000000000000,
                                 -0.145535821281024,
                                 -0.162329148804550,
                                 0.000000000000000,
                                 0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 4, 4));

    std::vector<double> intyvals{0.000000000000000,
                                 -0.000000000000000,
                                 0.031986129700749,
                                 0.036383955320256,
                                 0.000000000000000,
                                 0.000000000000000,
                                 0.036508227163991,
                                 0.040582287201138,
                                 -0.031986129700749,
                                 -0.036508227163991,
                                 -0.000000000000000,
                                 0.000000000000000,
                                 -0.036383955320256,
                                 -0.040582287201138,
                                 -0.000000000000000,
                                 0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 4, 4));

    std::vector<double> intzvals{0.000000000000000,
                                 -0.000000000000000,
                                 -0.063972259401498,
                                 -0.072767910640512,
                                 0.000000000000000,
                                 0.000000000000000,
                                 -0.073016454327982,
                                 -0.081164574402275,
                                 0.063972259401498,
                                 0.073016454327982,
                                 0.000000000000000,
                                 -0.000000000000000,
                                 0.072767910640512,
                                 0.081164574402275,
                                 0.000000000000000,
                                 0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 4, 4));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeSPForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix amomxmat(4, 12);

    CDenseMatrix amomymat(4, 12);

    CDenseMatrix amomzmat(4, 12);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -4.297789018638930, -3.895414738760628, -0.732981563948731, -1.331052427370746, 2.865192679092620,  2.596943159173752,  0.220384457978629,
        0.610624618477252,  -0.000000000000000, -0.000000000000000, -0.071538644796584, -0.073798311049754, -3.025897147732096, -3.286335345030998,
        -0.802989885202249, -1.465709248261963, 2.017264765154731,  2.190890230020665,  0.309025256946127,  0.715794610592518,  -0.000000000000000,
        -0.000000000000000, -0.060347022183655, -0.069691970199677, -0.561857855804990, -0.761101328533047, -2.974047821940778, -2.045750765960131,
        0.110286423042074,  0.232130677913452,  2.191403658272153,  1.507395301233781,  -0.078779084552498, -0.085255095141393, -0.000000000000000,
        -0.000000000000000, -0.573029497153610, -0.789236297361076, -1.184236488734583, -1.699411662899840, 0.239880772935673,  0.362165510843122,
        0.872595307488640,  1.252198067399882,  -0.047299362107478, -0.056903255386153, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 4, 12));

    std::vector<double> intyvals{
        -0.000000000000000, -0.000000000000000, -0.026826991798719, -0.027674366643658, -1.432596339546310, -1.298471579586876, -0.257740683882270,
        -0.457521325778744, 4.297789018638930,  3.895414738760628,  0.607788935554708,  1.201905383033676,  -0.000000000000000, -0.000000000000000,
        -0.022630133318871, -0.026134488824879, -1.008632382577365, -1.095445115010333, -0.278978361726851, -0.501636993833094, 3.025897147732096,
        3.286335345030998,  0.697382596380853,  1.343748300412527,  -0.029542156707187, -0.031970660678022, 0.000000000000000,  -0.000000000000000,
        -0.194273008727603, -0.258576673432115, -0.939172996402351, -0.646026557671620, 0.423994457838119,  0.611904912035608,  2.974047821940778,
        2.045750765960131,  -0.017737260790304, -0.021338720769808, -0.000000000000000, -0.000000000000000, -0.191070033762278, -0.261399329430142,
        -0.373969417495132, -0.536656314599950, 0.490255613465523,  0.689655600435307,  1.184236488734583,  1.699411662899840};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 4, 12));

    std::vector<double> intzvals{
        1.432596339546310,  1.298471579586876,  0.262211849182056,  0.462133720219354,  -0.000000000000000, -0.000000000000000, 0.098365636595303,
        0.101472677693412,  -2.865192679092620, -2.596943159173752, -0.381346408770944, -0.776670818339199, 1.008632382577365,  1.095445115010333,
        0.282750050613330,  0.505992741970574,  -0.000000000000000, -0.000000000000000, 0.082977155502525,  0.095826459024556,  -2.017264765154731,
        -2.190890230020665, -0.444806056859350, -0.872601543541792, 0.199196701512134,  0.263905116878452,  0.939172996402351,  0.646026557671620,
        0.108321241259684,  0.117225755819416,  -0.000000000000000, -0.000000000000000, -0.287539363285194, -0.423954641981587, -2.191403658272153,
        -1.507395301233781, 0.194026243893996,  0.264955782891777,  0.373969417495132,  0.536656314599950,  0.065036622897782,  0.078241976155961,
        -0.000000000000000, -0.000000000000000, -0.346304337677498, -0.490197835461968, -0.872595307488640, -1.252198067399882};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 4, 12));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeSDForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix amomxmat(4, 20);

    CDenseMatrix amomymat(4, 20);

    CDenseMatrix amomzmat(4, 20);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, 0.411952396827558,  0.675386512880428,  -0.000000000000000, -0.000000000000000, 0.782639367123680,
        1.238495259926459,  -0.000000000000000, -0.000000000000000, -0.903669408506440, -1.716639085269846, -0.000000000000000, -0.000000000000000,
        -0.120328249529738, -0.308835519289342, -0.000000000000000, -0.000000000000000, -0.551062366509595, -0.951796835069455, -0.000000000000000,
        -0.000000000000000, 0.332868387812593,  0.629265698757862,  -0.000000000000000, -0.000000000000000, 0.619968912352689,  1.146095735887740,
        -0.000000000000000, -0.000000000000000, -0.795643950131443, -1.640638447148975, -0.000000000000000, -0.000000000000000, -0.128289174340101,
        -0.307308558184870, -0.000000000000000, -0.000000000000000, -0.458732578564851, -0.895277721486854, -0.346013965178969, -0.444669858076491,
        -0.000000000000000, -0.000000000000000, -0.650192968636667, -0.814250895637435, 0.000000000000000,  -0.000000000000000, 0.706380372031158,
        1.013735118866077,  0.000000000000000,  -0.000000000000000, 0.066388783143402,  0.134908638949957,  0.000000000000000,  0.000000000000000,
        0.439538844993449,  0.585763353071593,  0.000000000000001,  -0.000000000000000, -0.187944989034211, -0.276660814890571, -0.000000000000000,
        -0.000000000000000, -0.334713127173424, -0.488104270957426, -0.000000000000000, -0.000000000000000, 0.475365253038457,  0.722624684837850,
        -0.000000000000000, -0.000000000000000, 0.078971715758726,  0.126954380697062,  0.000000000000000,  -0.000000000000000, 0.256832203326365,
        0.382577337902563,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 4, 20));

    std::vector<double> intyvals{
        -0.000000000000000, -0.000000000000000, -0.509913918059293, -0.914084260145648, -0.000000000000000, -0.000000000000000, 0.217549199540426,
        0.348299918137535,  -0.000000000000000, -0.000000000000000, 0.608179203132772,  1.044597694188758,  -0.000000000000000, -0.000000000000000,
        -0.818098941724669, -1.469548593435449, -0.000000000000000, -0.000000000000000, -0.356659169222464, -0.624710240326562, -0.000000000000000,
        -0.000000000000000, -0.433766422777750, -0.865357212779199, -0.000000000000000, -0.000000000000000, 0.173455925221418,  0.323047992452959,
        -0.000000000000000, -0.000000000000000, 0.504650366134764,  0.981593937943259,  -0.000000000000000, -0.000000000000000, -0.696765390381895,
        -1.391693244863072, -0.000000000000000, -0.000000000000000, -0.299320115973676, -0.589060015181951, 0.390626781747293,  0.535768624429659,
        0.000000000000001,  -0.000000000000000, -0.179588609053525, -0.226667584228958, -0.000000000000000, -0.000000000000000, -0.472730094286367,
        -0.626979643740700, -0.000000000000000, -0.000000000000000, 0.630050403982753,  0.865502131243066,  -0.000000000000000, -0.000000000000000,
        0.280288380191946,  0.377489441463892,  0.000000000000000,  0.000000000000000,  0.241395107803319,  0.362630332097460,  -0.000000000000000,
        -0.000000000000000, -0.093977615902708, -0.137447336875789, -0.000000000000000, -0.000000000000000, -0.273616025893953, -0.406973105343416,
        -0.000000000000000, -0.000000000000000, 0.390518956876373,  0.586904284085827,  -0.000000000000000, -0.000000000000000, 0.167201391925117,
        0.249857025839963,  0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 4, 20));

    std::vector<double> intzvals{
        -0.000000000000000, -0.000000000000000, 0.202625146430343,  0.384260669136956,  -0.000000000000000, -0.000000000000000, -0.405912588734844,
        -0.645031698733843, -0.000000000000000, -0.000000000000000, -0.104229665919701, -0.124185434369223, -0.000000000000000, -0.000000000000000,
        0.585508710993025,  1.082644235386747,  -0.000000000000000, -0.000000000000000, 0.421460234984841,  0.733739105240860,  -0.000000000000000,
        -0.000000000000000, 0.178221485914303,  0.367149575600179,  -0.000000000000000, -0.000000000000000, -0.322293587598509, -0.597397240264553,
        -0.000000000000000, -0.000000000000000, -0.071218927379361, -0.107516476245847, -0.000000000000000, -0.000000000000000, 0.507273318367964,
        1.030231682637005,  -0.000000000000000, -0.000000000000000, 0.352457603504068,  0.691132583950252,  -0.178562692283595, -0.254354820713488,
        -0.000000000000000, 0.000000000000000,  0.337652544135229,  0.424150081738423,  -0.000000000000000, -0.000000000000000, 0.125259951990641,
        0.141858121009123,  0.000000000000000,  0.000000000000000,  -0.485212544979945, -0.680341140584351, -0.000000000000000, -0.000000000000000,
        -0.345330020665681, -0.463128015732844, -0.000000000000000, -0.000000000000000, -0.118519030265326, -0.179834724211633, 0.000000000000000,
        -0.000000000000000, 0.174945546614656,  0.255415175895031,  -0.000000000000000, -0.000000000000000, 0.051496465488663,  0.071677650830565,
        0.000000000000000,  -0.000000000000000, -0.312689246885346, -0.472546645335998, -0.000000000000000, -0.000000000000000, -0.204305931942622,
        -0.304919073114467, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 4, 20));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeSFForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix amomxmat(4, 28);

    CDenseMatrix amomymat(4, 28);

    CDenseMatrix amomzmat(4, 28);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, 0.148710709195116,  0.237603004173714,  -0.000000000000000, -0.000000000000000, -0.453064166539150,
        -0.633513199468962, 0.000000000000000,  0.000000000000000,  -0.171664745165793, -0.149364469257212, -0.000000000000001, -0.000000000000000,
        1.215691620845642,  1.942955326862025,  -0.000000000000000, -0.000000000000000, 0.459236665249403,  0.800428776593109,  -0.000000000000000,
        -0.000000000000000, 0.789288985155962,  1.206064380180399,  -0.000000000000000, -0.000000000000000, 0.398852237622244,  0.603745442139554,
        -0.000000000000000, 0.000000000000000,  0.091492028233984,  0.189098622169050,  -0.000000000000000, -0.000000000000000, -0.257250654528765,
        -0.492047611040186, 0.000000000000000,  -0.000000000000000, -0.075909853246321, -0.102093077460317, -0.000000000000000, -0.000000000000000,
        0.748073967235467,  1.546397511575116,  -0.000000000000000, -0.000000000000000, 0.298395362783097,  0.645986516235802,  0.000000000000000,
        0.000000000000000,  0.472513385389033,  0.952466218324949,  -0.000000000000000, -0.000000000000000, 0.237416346588161,  0.475993455174958,
        0.122229347298343,  0.159178232394563,  -0.000000000000000, -0.000000000000000, -0.404066792687587, -0.478025837030177, 0.000000000000000,
        -0.000000000000000, -0.147623764255892, -0.126334909053288, 0.000000000000000,  0.000000000000000,  1.053393841025728,  1.371127035870524,
        -0.000000000000000, -0.000000000000000, 0.382188127097404,  0.532754774391758,  0.000000000000000,  -0.000000000000000, 0.671444166500165,
        0.845013064051811,  -0.000000000000000, -0.000000000000000, 0.346172620023293,  0.432821205821633,  0.000000000000000,  -0.000000000000000,
        0.040400134136035,  0.064601668696293,  -0.000000000000000, -0.000000000000000, -0.110170520288697, -0.171101260555517, -0.000000000000000,
        -0.000000000000000, -0.016806201399842, -0.019943541582058, -0.000000000000000, -0.000000000000000, 0.347836312051864,  0.556132760153746,
        -0.000000000000000, -0.000000000000000, 0.143325445443614,  0.232867551644294,  -0.000000000000000, -0.000000000000000, 0.207661692709725,
        0.328969100038430,  -0.000000000000000, 0.000000000000000,  0.105686019948709,  0.167104618465978,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 4, 28));

    std::vector<double> intyvals{
        -0.000000000000000, -0.000000000000000, 0.368912587615161,  0.579835831194031,  -0.000000000000000, -0.000000000000000, 0.705614298044281,
        1.126304264316847,  -0.000000000000000, -0.000000000000000, -0.485127720909174, -0.731095040417558, 0.000000000000000,  0.000000000000000,
        -0.749994236807912, -1.167676094545371, -0.000000000000000, -0.000000000000000, 0.537101262433782,  0.862610940535170,  -0.000000000000000,
        -0.000000000000000, 0.606762416128525,  0.943857377137143,  -0.000000000000000, -0.000000000000000, -0.147159431992677, -0.236364164228350,
        -0.000000000000000, -0.000000000000000, 0.224686141656453,  0.460178902438039,  -0.000000000000000, -0.000000000000000, 0.433858626370601,
        0.896233161410234,  -0.000000000000000, -0.000000000000000, -0.287999785597355, -0.575935707102840, 0.000000000000000,  0.000000000000000,
        -0.454138996966099, -0.925191604252206, -0.000000000000000, -0.000000000000000, 0.331503040356063,  0.687115713745461,  0.000000000000000,
        0.000000000000000,  0.367213991348655,  0.747739086666377,  -0.000000000000000, 0.000000000000000,  -0.090832432123533, -0.188279215291489,
        0.308470393707084,  0.396567006567145,  0.000000000000000,  -0.000000000000000, 0.585005578483109,  0.761178493409597,  -0.000000000000000,
        -0.000000000000000, -0.407371501221944, -0.507170971898242, -0.000000000000000, -0.000000000000000, -0.619577410765446, -0.790679289441640,
        0.000000000000000,  0.000000000000000,  0.449324954087368,  0.587353089375431,  -0.000000000000000, -0.000000000000000, 0.510872179952544,
        0.651595742346524,  -0.000000000000000, -0.000000000000000, -0.120275864069524, -0.157299776474641, -0.000000000000000, -0.000000000000000,
        0.099457988446160,  0.158496266306914,  -0.000000000000000, -0.000000000000000, 0.193035518913418,  0.308602286870618,  -0.000000000000000,
        -0.000000000000000, -0.123318101376554, -0.194736720878771, -0.000000000000000, -0.000000000000000, -0.196929887329536, -0.313197569616373,
        0.000000000000000,  0.000000000000000,  0.149582301980893,  0.239420388462652,  0.000000000000000,  -0.000000000000000, 0.162204497670227,
        0.257931076014356,  -0.000000000000000, 0.000000000000000,  -0.040077438203260, -0.064155640087015, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 4, 28));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  -0.295511961475146, -0.465758222187258, -0.000000000000000, -0.000000000000000, -0.319388143183137,
        -0.539698443054911, -0.000000000000000, -0.000000000000000, 0.380640062328047,  0.537184850030776,  -0.000000000000000, -0.000000000000000,
        0.094765617590061,  0.130798954076239,  0.000000000000000,  0.000000000000000,  -0.511146396705656, -0.841883552554483, -0.000000000000000,
        -0.000000000000000, -0.667604605804337, -1.031259711484895, 0.000000000000000,  0.000000000000000,  -0.034844457878964, -0.043672371227618,
        -0.000000000000000, -0.000000000000000, -0.180288103848963, -0.369818809015042, -0.000000000000000, -0.000000000000000, -0.203488866070813,
        -0.433472903926761, -0.000000000000000, -0.000000000000000, 0.217303141480344,  0.417988163888666,  -0.000000000000000, -0.000000000000000,
        0.053401342232244,  0.101328565643099,  0.000000000000000,  0.000000000000000,  -0.320467147831741, -0.673405981242241, -0.000000000000000,
        -0.000000000000000, -0.402313789362114, -0.815981463885901, -0.000000000000000, -0.000000000000000, -0.018583827447032, -0.033145008197327,
        -0.265892715562591, -0.342474078226705, 0.000000000000000,  -0.000000000000000, -0.303456702244105, -0.409912836081753, -0.000000000000000,
        -0.000000000000000, 0.346786505402241,  0.413600161099743,  -0.000000000000000, -0.000000000000000, 0.123880037082204,  0.149618307208411,
        -0.000000000000000, -0.000000000000000, -0.451772532621452, -0.601024836716136, 0.000000000000000,  0.000000000000000,  -0.588467132544032,
        -0.746969409324326, -0.000000000000000, -0.000000000000000, -0.020693348587706, -0.020775282330780, 0.000000000000000,  0.000000000000000,
        -0.086042770687497, -0.137187249498661, -0.000000000000000, -0.000000000000000, -0.107446007529246, -0.173359181729240, -0.000000000000000,
        -0.000000000000000, 0.096173190930043,  0.149788175883955,  -0.000000000000000, -0.000000000000000, 0.035263186858017,  0.055156284931934,
        -0.000000000000000, -0.000000000000000, -0.155479205283905, -0.249952144649626, 0.000000000000000,  0.000000000000000,  -0.185096480191660,
        -0.293939456022714, -0.000000000000000, -0.000000000000000, -0.003843788676137, -0.005497302609350, 0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 4, 28));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeSGForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 0);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix amomxmat(4, 36);

    CDenseMatrix amomymat(4, 36);

    CDenseMatrix amomzmat(4, 36);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, -0.205737522150743, -0.275765692932913, -0.000000000000000, -0.000000000000000, -0.259737461330393,
        -0.361371083682367, -0.000000000000000, -0.000000000000000, 0.161685816961841,  0.151652766920654,  -0.000000000000000, -0.000000000000000,
        -0.471503517422279, -0.710091288051068, -0.000000000000000, -0.000000000000000, -0.953593699077736, -1.291058004414469, -0.000000000000000,
        -0.000000000000000, -0.659805850051974, -0.945596085723171, -0.000000000000000, -0.000000000000000, -0.660611619983323, -0.874055317435882,
        -0.000000000000000, -0.000000000000000, -0.556242719597079, -0.727828381691747, -0.000000000000000, -0.000000000000000, -0.046600074329830,
        -0.058295888576921, -0.000000000000000, -0.000000000000000, -0.086902196915375, -0.181777305638529, 0.000000000000000,  0.000000000000000,
        -0.112358222693820, -0.239748378587283, -0.000000000000000, -0.000000000000000, 0.055272918157278,  0.092377334660287,  0.000000000000000,
        0.000000000000000,  -0.214790319630305, -0.477180894078105, -0.000000000000000, -0.000000000000000, -0.405370254806906, -0.852533089779921,
        -0.000000000000000, -0.000000000000000, -0.290947507967935, -0.630449465276866, -0.000000000000000, -0.000000000000000, -0.276753977442665,
        -0.574822730579625, -0.000000000000000, -0.000000000000000, -0.231401714371055, -0.477695289486364, -0.000000000000000, -0.000000000000000,
        -0.018849862854303, -0.037941270670567, 0.185458449741992,  0.221381521849173,  -0.000000000000000, -0.000000000000000, 0.227552312745387,
        0.279397243599371,  -0.000000000000000, -0.000000000000000, -0.146540385947762, -0.136152359965029, -0.000000000000000, -0.000000000000000,
        0.445469039347620,  0.578668547634319,  -0.000000000000000, -0.000000000000000, 0.872875705886213,  1.049862911311355,  0.000000000000000,
        -0.000000000000000, 0.602672161327634,  0.756033449486438,  0.000000000000000,  -0.000000000000000, 0.585995191467914,  0.692532269276182,
        0.000000000000000,  -0.000000000000000, 0.503845396539023,  0.590903641169180,  -0.000000000000000, -0.000000000000000, 0.044615644902092,
        0.050820085254057,  0.000000000000000,  -0.000000000000000, 0.030705809301467,  0.051653398414232,  -0.000000000000000, -0.000000000000000,
        0.039785353020290,  0.067405771049963,  -0.000000000000000, -0.000000000000000, -0.013730050418028, -0.020707283460854, -0.000000000000000,
        -0.000000000000000, 0.086498350913919,  0.148398857045198,  -0.000000000000000, -0.000000000000000, 0.146668744300016,  0.247214181354379,
        -0.000000000000000, -0.000000000000000, 0.109731306076265,  0.186847364182297,  -0.000000000000000, -0.000000000000000, 0.095128314418206,
        0.159595609811686,  -0.000000000000000, -0.000000000000000, 0.080558206472555,  0.134865939551139,  -0.000000000000000, -0.000000000000000,
        0.006724744235360,  0.011162164425000,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 4, 36));

    std::vector<double> intyvals{
        -0.000000000000000, -0.000000000000000, -0.040686339904801, -0.054250588669172, -0.000000000000000, -0.000000000000000, -0.590475223897727,
        -0.808672192397686, -0.000000000000000, -0.000000000000000, -0.542529718974081, -0.758886851843804, -0.000000000000000, -0.000000000000000,
        0.623812577000843,  0.836245434227800,  -0.000000000000000, -0.000000000000000, 0.580956030063746,  0.797160623523127,  0.000000000000000,
        -0.000000000000000, -0.102330206321786, -0.150805884381822, -0.000000000000000, -0.000000000000000, -0.663809744801301, -0.900097141893496,
        -0.000000000000000, -0.000000000000000, 0.192299861437528,  0.270959213707956,  -0.000000000000000, -0.000000000000000, 0.195787165632225,
        0.268959134942065,  -0.000000000000000, -0.000000000000000, -0.017128725212906, -0.035727356171514, -0.000000000000000, -0.000000000000000,
        -0.252857857406285, -0.535062287788351, -0.000000000000000, -0.000000000000000, -0.235503860382172, -0.503933744650015, -0.000000000000000,
        -0.000000000000000, 0.263514777672449,  0.551242310021290,  -0.000000000000000, -0.000000000000000, 0.249086725151101,  0.527619681886436,
        -0.000000000000000, -0.000000000000000, -0.045954423873299, -0.100998430489667, -0.000000000000000, -0.000000000000000, -0.282458783823127,
        -0.594525868102585, 0.000000000000000,  0.000000000000000,  0.083868992311811,  0.180148967519526,  -0.000000000000000, -0.000000000000000,
        0.084006237794034,  0.178052207928044,  0.036854099161120,  0.043826268679428,  -0.000000000000000, -0.000000000000000, 0.521918262043197,
        0.633092798996883,  -0.000000000000000, -0.000000000000000, 0.479195189286985,  0.590734364595981,  -0.000000000000000, -0.000000000000000,
        -0.544923328426050, -0.650230512686299, -0.000000000000000, -0.000000000000000, -0.506795211944449, -0.615669727497367, -0.000000000000000,
        -0.000000000000000, 0.095256983693131,  0.121894618137805,  0.000000000000000,  -0.000000000000000, 0.587740383781609,  0.707563860354470,
        0.000000000000000,  0.000000000000000,  -0.167246402364285, -0.207406643301789, -0.000000000000000, -0.000000000000000, -0.172398994969965,
        -0.209613836095794, -0.000000000000000, -0.000000000000000, 0.006056617323870,  0.010178202425421,  -0.000000000000000, -0.000000000000000,
        0.089150493365541,  0.150590386017144,  -0.000000000000000, -0.000000000000000, 0.084423939263340,  0.143171823401255,  -0.000000000000000,
        -0.000000000000000, -0.090155127556240, -0.151644184068708, -0.000000000000000, -0.000000000000000, -0.086817555926304, -0.146704693658396,
        -0.000000000000000, -0.000000000000000, 0.017995189829651,  0.030776066515775,  -0.000000000000000, 0.000000000000000,  0.098934548756316,
        0.166796436137305,  0.000000000000000,  -0.000000000000000, -0.029799727670602, -0.050607707822307, 0.000000000000000,  -0.000000000000000,
        -0.029581629470055, -0.049997799431795, 0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 4, 36));

    std::vector<double> intzvals{
        0.000000000000000,  -0.000000000000000, 0.095703400653448,  0.128088956757085,  -0.000000000000000, -0.000000000000000, 0.480229303041949,
        0.659571822825913,  -0.000000000000000, -0.000000000000000, 0.307791206995440,  0.455373645588985,  -0.000000000000000, -0.000000000000000,
        -0.258707212193136, -0.320799860134844, -0.000000000000000, -0.000000000000000, -0.069439453683252, -0.101087747543928, -0.000000000000000,
        -0.000000000000000, 0.288155420898516,  0.415735951495605,  -0.000000000000000, -0.000000000000000, 0.662743703195308,  0.891416533740958,
        -0.000000000000000, -0.000000000000000, 0.057214332240674,  0.061969984758611,  -0.000000000000000, -0.000000000000000, -0.114991418978207,
        -0.159874127102403, -0.000000000000000, -0.000000000000000, 0.040386549113729,  0.084410672660519,  -0.000000000000000, -0.000000000000000,
        0.206024645835463,  0.436624318054661,  -0.000000000000000, -0.000000000000000, 0.138578267535689,  0.305163384879914,  -0.000000000000000,
        -0.000000000000000, -0.104079745238198, -0.208434575321492, -0.000000000000000, -0.000000000000000, -0.030934398498432, -0.067568757997650,
        -0.000000000000000, -0.000000000000000, 0.127618785238178,  0.277482108752066,  -0.000000000000000, -0.000000000000000, 0.280557181696307,
        0.587958155594932,  -0.000000000000000, -0.000000000000000, 0.021221243249144,  0.039132451482437,  -0.000000000000000, -0.000000000000000,
        -0.049720870911255, -0.106054381728507, -0.085721478247771, -0.102202994347738, 0.000000000000000,  -0.000000000000000, -0.456429976056688,
        -0.554720139344873, -0.000000000000000, -0.000000000000000, -0.306815280754275, -0.392282470765976, -0.000000000000000, -0.000000000000000,
        0.260848019046262,  0.296379783779067,  -0.000000000000000, -0.000000000000000, 0.097783091152895,  0.122115721952369,  -0.000000000000000,
        0.000000000000000,  -0.260506881035244, -0.328564492149889, -0.000000000000000, -0.000000000000000, -0.618122974828947, -0.740057245295772,
        -0.000000000000000, 0.000000000000000,  -0.035874881375481, -0.033775202146844, -0.000000000000000, -0.000000000000000, 0.112941687377208,
        0.138403852306146,  -0.000000000000000, 0.000000000000000,  -0.014159342018051, -0.023811327602173, -0.000000000000000, 0.000000000000000,
        -0.078253632907332, -0.132247370028410, -0.000000000000000, -0.000000000000000, -0.057871307746241, -0.098955885623813, 0.000000000000000,
        -0.000000000000000, 0.039114825279150,  0.064875022878459,  -0.000000000000000, -0.000000000000000, 0.017654385114114,  0.030030559110067,
        0.000000000000000,  -0.000000000000000, -0.047911604951195, -0.081681532437612, -0.000000000000000, -0.000000000000000, -0.102939661531456,
        -0.173301250778547, -0.000000000000000, -0.000000000000000, -0.003481739549837, -0.005299354094449, -0.000000000000000, -0.000000000000000,
        0.019673386693085,  0.033315589762901,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 4, 36));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputePSForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix amomxmat(12, 4);

    CDenseMatrix amomymat(12, 4);

    CDenseMatrix amomzmat(12, 4);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        4.297789018638930,  3.025897147732096,  0.561857855804990,  0.573029497153610,  3.895414738760628,  3.286335345030998,  0.761101328533047,
        0.789236297361076,  0.732981563948731,  0.802989885202249,  2.974047821940778,  1.184236488734583,  1.331052427370746,  1.465709248261963,
        2.045750765960131,  1.699411662899840,  -2.865192679092620, -2.017264765154731, -0.110286423042074, -0.239880772935673, -2.596943159173752,
        -2.190890230020665, -0.232130677913452, -0.362165510843122, -0.220384457978629, -0.309025256946127, -2.191403658272153, -0.872595307488640,
        -0.610624618477252, -0.715794610592518, -1.507395301233781, -1.252198067399882, 0.000000000000000,  0.000000000000000,  0.078779084552498,
        0.047299362107478,  0.000000000000000,  0.000000000000000,  0.085255095141393,  0.056903255386153,  0.071538644796584,  0.060347022183655,
        0.000000000000000,  0.000000000000000,  0.073798311049754,  0.069691970199677,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 12, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.029542156707187,  0.017737260790304,  0.000000000000000,  0.000000000000000,  0.031970660678022,
        0.021338720769808,  0.026826991798719,  0.022630133318871,  -0.000000000000000, 0.000000000000000,  0.027674366643658,  0.026134488824879,
        0.000000000000000,  0.000000000000000,  1.432596339546310,  1.008632382577365,  0.194273008727603,  0.191070033762278,  1.298471579586876,
        1.095445115010333,  0.258576673432115,  0.261399329430142,  0.257740683882270,  0.278978361726851,  0.939172996402351,  0.373969417495132,
        0.457521325778744,  0.501636993833094,  0.646026557671620,  0.536656314599950,  -4.297789018638930, -3.025897147732096, -0.423994457838119,
        -0.490255613465523, -3.895414738760628, -3.286335345030998, -0.611904912035608, -0.689655600435307, -0.607788935554708, -0.697382596380853,
        -2.974047821940778, -1.184236488734583, -1.201905383033676, -1.343748300412527, -2.045750765960131, -1.699411662899840};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 12, 4));

    std::vector<double> intzvals{
        -1.432596339546310, -1.008632382577365, -0.199196701512134, -0.194026243893996, -1.298471579586876, -1.095445115010333, -0.263905116878452,
        -0.264955782891777, -0.262211849182056, -0.282750050613330, -0.939172996402351, -0.373969417495132, -0.462133720219354, -0.505992741970574,
        -0.646026557671620, -0.536656314599950, 0.000000000000000,  0.000000000000000,  -0.108321241259684, -0.065036622897782, 0.000000000000000,
        0.000000000000000,  -0.117225755819416, -0.078241976155961, -0.098365636595303, -0.082977155502525, 0.000000000000000,  0.000000000000000,
        -0.101472677693412, -0.095826459024556, 0.000000000000000,  0.000000000000000,  2.865192679092620,  2.017264765154731,  0.287539363285194,
        0.346304337677498,  2.596943159173752,  2.190890230020665,  0.423954641981587,  0.490197835461968,  0.381346408770944,  0.444806056859350,
        2.191403658272153,  0.872595307488640,  0.776670818339199,  0.872601543541792,  1.507395301233781,  1.252198067399882};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 12, 4));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputePPForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix amomxmat(12, 12);

    CDenseMatrix amomymat(12, 12);

    CDenseMatrix amomzmat(12, 12);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  -0.000000000000000, -0.907341083385578, -0.893152565820163, -1.000000000000000, -0.920751180279673, -0.617320651703922,
        -0.687952712267003, 0.000000000000000,  -0.000000000000000, -0.307957287791119, -0.286954992733073, 0.000000000000000,  0.000000000000000,
        -0.953626249942108, -1.064931390160424, -0.920751180279673, -1.000000000000000, -0.668224442545837, -0.868849946301356, 0.000000000000000,
        0.000000000000000,  -0.314398087047840, -0.338838914152244, 0.907341083385578,  0.953626249942108,  0.000000000000001,  -0.000000000000000,
        0.812382805497170,  0.775190629733435,  -1.000000000000000, -0.696850865854261, 0.447941764039344,  0.465892953135664,  0.000000000000000,
        0.000000000000000,  0.893152565820163,  1.064931390160424,  0.000000000000000,  0.000000000000000,  0.615972845137712,  0.664736506026268,
        -0.696850865854261, -1.000000000000000, 0.432381302559532,  0.513793291530891,  0.000000000000000,  0.000000000000000,  1.000000000000000,
        0.920751180279673,  -0.812382805497170, -0.615972845137712, 0.000000000000000,  -0.000000000000000, 0.983540150929104,  1.188018729440291,
        0.000000000000000,  -0.000000000000000, 0.056857874515223,  0.119520525128044,  0.920751180279673,  1.000000000000000,  -0.775190629733435,
        -0.664736506026268, 0.000000000000000,  0.000000000000000,  1.159606403929490,  1.461409819187232,  0.000000000000000,  0.000000000000000,
        0.096148897438541,  0.155486726659423,  0.617320651703922,  0.668224442545837,  1.000000000000000,  0.696850865854261,  -0.983540150929104,
        -1.159606403929490, 0.000000000000001,  -0.000000000000000, -0.133213043377891, -0.178782460759172, -0.000000000000000, -0.000000000000000,
        0.687952712267003,  0.868849946301356,  0.696850865854261,  1.000000000000000,  -1.188018729440291, -1.461409819187232, 0.000000000000000,
        0.000000000000000,  -0.198843966851567, -0.250916387047775, -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.000000000000000,
        -0.447941764039344, -0.432381302559532, -0.000000000000000, -0.000000000000000, 0.133213043377891,  0.198843966851567,  0.000000000000000,
        -0.000000000000000, 0.083148001620446,  0.108363006911262,  0.000000000000000,  -0.000000000000000, -0.465892953135664, -0.513793291530891,
        0.000000000000000,  -0.000000000000000, 0.178782460759172,  0.250916387047775,  0.000000000000000,  0.000000000000000,  0.102572514512713,
        0.134619440921169,  0.307957287791119,  0.314398087047840,  -0.000000000000000, -0.000000000000000, -0.056857874515223, -0.096148897438541,
        0.000000000000000,  0.000000000000000,  -0.083148001620446, -0.102572514512713, 0.000000000000001,  -0.000000000000000, 0.286954992733073,
        0.338838914152244,  -0.000000000000000, -0.000000000000000, -0.119520525128044, -0.155486726659423, 0.000000000000000,  -0.000000000000000,
        -0.108363006911262, -0.134619440921169, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 12, 12));

    std::vector<double> intyvals{
        0.000000000000000,  -0.000000000000000, 0.007002433795528,  0.019639898823250,  -0.000000000000000, -0.000000000000000, -0.236376991968298,
        -0.222896418893875, 0.000000000000000,  -0.000000000000000, 0.556122286538513,  0.585984789440947,  0.000000000000000,  0.000000000000000,
        0.014658725183906,  0.026020487399224,  0.000000000000000,  -0.000000000000000, -0.242832439667677, -0.263767581313407, 0.000000000000000,
        0.000000000000000,  0.606570440771606,  0.706561205515363,  -0.007002433795528, -0.014658725183906, -0.000000000000000, 0.000000000000000,
        0.160021823105629,  0.160198876347046,  -0.000000000000000, -0.000000000000000, -0.346145572166175, -0.379328141639871, 0.000000000000001,
        -0.000000000000000, -0.019639898823250, -0.026020487399224, -0.000000000000000, 0.000000000000000,  0.143572977170352,  0.168337920925054,
        0.000000000000000,  -0.000000000000000, -0.367845324701258, -0.444129639447393, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.000000000000000, -0.160021823105629, -0.143572977170352, 0.000000000000000,  -0.000000000000000, -0.611519879288105, -0.593731465326993,
        -1.000000000000000, -0.920751180279673, 0.790988401866251,  0.699538314716210,  0.000000000000000,  0.000000000000000,  -0.160198876347046,
        -0.168337920925054, 0.000000000000000,  0.000000000000000,  -0.638004453805547, -0.706243106647402, -0.920751180279673, -1.000000000000000,
        0.812614724993215,  0.785741315398699,  0.236376991968298,  0.242832439667677,  0.000000000000000,  -0.000000000000000, 0.611519879288105,
        0.638004453805547,  -0.000000000000000, 0.000000000000000,  -0.659555555458560, -0.774509840572809, -1.000000000000000, -0.696850865854261,
        0.222896418893875,  0.263767581313407,  0.000000000000000,  0.000000000000000,  0.593731465326993,  0.706243106647402,  -0.000000000000000,
        0.000000000000000,  -0.837621049948437, -1.069379472664081, -0.696850865854261, -1.000000000000000, -0.000000000000000, -0.000000000000000,
        0.346145572166175,  0.367845324701258,  1.000000000000000,  0.920751180279673,  0.659555555458560,  0.837621049948437,  0.000000000000000,
        -0.000000000000000, 0.644354212783571,  0.674898859136590,  0.000000000000000,  -0.000000000000000, 0.379328141639871,  0.444129639447393,
        0.920751180279673,  1.000000000000000,  0.774509840572809,  1.069379472664081,  0.000000000000000,  0.000000000000000,  0.700483895746666,
        0.812997086735173,  -0.556122286538513, -0.606570440771606, -0.000000000000001, -0.000000000000000, -0.790988401866251, -0.812614724993215,
        1.000000000000000,  0.696850865854261,  -0.644354212783571, -0.700483895746666, -0.000000000000000, 0.000000000000000,  -0.585984789440947,
        -0.706561205515363, 0.000000000000000,  -0.000000000000000, -0.699538314716210, -0.785741315398699, 0.696850865854261,  1.000000000000000,
        -0.674898859136590, -0.812997086735173, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 12, 12));

    std::vector<double> intzvals{
        0.000000000000000,  -0.000000000000000, 0.291415807859618,  0.278013969247594,  -0.000000000000000, -0.000000000000000, 0.300954853995591,
        0.267315093909823,  1.000000000000000,  0.920751180279673,  -0.120123760995985, -0.003968029054466, 0.000000000000000,  0.000000000000000,
        0.301216802914713,  0.329677666754962,  0.000000000000000,  -0.000000000000000, 0.299739361863935,  0.312818426753020,  0.920751180279673,
        1.000000000000000,  -0.087374165248839, 0.050795087565600,  -0.291415807859618, -0.301216802914713, 0.000000000000000,  -0.000000000000000,
        -0.440939330243817, -0.451234227951758, -0.000000000000000, -0.000000000000000, 0.259115470976912,  0.341929817589001,  1.000000000000000,
        0.696850865854261,  -0.278013969247594, -0.329677666754962, 0.000000000000000,  0.000000000000000,  -0.412741403736282, -0.487772804131667,
        0.000000000000000,  -0.000000000000000, 0.422987953724172,  0.570823116908530,  0.696850865854261,  1.000000000000000,  0.000000000000000,
        -0.000000000000000, 0.440939330243817,  0.412741403736282,  0.000000000000000,  -0.000000000000000, 0.103163948590407,  0.024052452042308,
        0.000000000000000,  -0.000000000000000, -0.639270288158959, -0.694347796352210, 0.000000000000000,  0.000000000000000,  0.451234227951758,
        0.487772804131667,  0.000000000000000,  0.000000000000000,  0.064049978908506,  0.012851194265632,  0.000000000000000,  0.000000000000000,
        -0.709142955284319, -0.841180646436532, -0.300954853995591, -0.299739361863935, 0.000000000000000,  -0.000000000000000, -0.103163948590407,
        -0.064049978908506, 0.000000000000000,  -0.000000000000000, 0.429293573786621,  0.481900656152584,  0.000000000000000,  -0.000000000000000,
        -0.267315093909823, -0.312818426753020, 0.000000000000000,  0.000000000000000,  -0.024052452042308, -0.012851194265632, 0.000000000000000,
        0.000000000000000,  0.476208331612520,  0.578749080368563,  0.000000000000000,  0.000000000000000,  -1.000000000000000, -0.920751180279673,
        -0.259115470976912, -0.422987953724172, -0.000000000000000, -0.000000000000000, -0.429293573786621, -0.476208331612520, 0.000000000000000,
        -0.000000000000000, -0.474253291032011, -0.503681006555597, -0.920751180279673, -1.000000000000000, -0.341929817589001, -0.570823116908530,
        0.000000000000000,  -0.000000000000000, -0.481900656152584, -0.578749080368563, 0.000000000000000,  0.000000000000000,  -0.519543116073266,
        -0.608077795994583, 0.120123760995985,  0.087374165248839,  -1.000000000000000, -0.696850865854261, 0.639270288158959,  0.709142955284319,
        -0.000000000000000, -0.000000000000000, 0.474253291032011,  0.519543116073266,  0.000000000000000,  -0.000000000000000, 0.003968029054466,
        -0.050795087565600, -0.696850865854261, -1.000000000000000, 0.694347796352210,  0.841180646436532,  0.000000000000000,  -0.000000000000000,
        0.503681006555597,  0.608077795994583,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 12, 12));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputePDForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix amomxmat(12, 20);

    CDenseMatrix amomymat(12, 20);

    CDenseMatrix amomzmat(12, 20);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, 0.510052836548960,  0.450430508027105,  2.866012392260649,  2.503398351528607,  1.621619920667511,
        1.899561145353391,  2.482039539258736,  2.168006568215861,  0.323075525681844,  0.768881387704801,  -0.000000000000000, -0.000000000000000,
        0.346591536592109,  0.346049992935380,  4.299018588390975,  3.755097527292912,  0.140030303234717,  0.668213448344149,  -0.000000000000000,
        -0.000000000000000, 0.394449776744316,  0.457201724116235,  1.956313815268270,  2.190890230020664,  1.412645218856654,  2.105874537265660,
        1.694217461796779,  1.897366596101028,  0.404924371391680,  0.975872059254605,  -0.000000000000000, -0.000000000000000, 0.276515860995470,
        0.373019048097960,  2.934470722902404,  3.286335345030997,  0.293806291235454,  0.884259517724209,  0.558876593189870,  0.555660128607940,
        -0.000000000000000, -0.000000000000000, 1.475727290665789,  1.526822246456110,  2.191517704768308,  1.303800953530988,  0.258587761688884,
        0.212826998527680,  1.717156671346748,  1.021589057023238,  0.501955305547508,  0.452452688945043,  -0.000000000000000, -0.000000000000000,
        0.050620614893620,  0.204887294095409,  2.974202599328418,  1.769444151220628,  0.291396438503444,  0.373303644535167,  -0.000000000000000,
        -0.000000000000000, 0.859360962060433,  1.141344466733845,  0.758590849304379,  1.252198067399883,  0.084670560408818,  0.093425542079658,
        0.594391427854482,  0.981155781039213,  0.200303936980241,  0.233018354654564,  -0.000000000000000, -0.000000000000000, 0.252709270401290,
        0.422377477657837,  1.029516152627371,  1.699411662899841,  -0.000000000000000, -0.000000000000000, 0.460386939494906,  0.312000613047525,
        -4.299018588390974, -3.755097527292911, -0.052237141576598, -0.900341043326778, 3.309386052344980,  2.890675424287815,  -1.532694517167169,
        -1.075923551940383, -0.000000000000000, -0.000000000000000, -0.545904390235721, -0.598156022437867, -0.000000000000000, 0.000000000000000,
        -0.739238768110802, -0.565489142297451, -0.000000000000000, -0.000000000000000, 0.320364977896085,  0.285388034803283,  -2.934470722902404,
        -3.286335345030997, -0.348722852245330, -1.214621040421939, 2.258956615729039,  2.529822128134704,  -1.122934031728415, -0.945443508943988,
        -0.000000000000000, -0.000000000000000, -0.479991865777972, -0.627419846148159, -0.000000000000000, -0.000000000000000, -0.545334799264601,
        -0.536557866012657, 0.380097859916213,  0.389040057741943,  0.000000000000000,  0.000000000000000,  0.035325016742854,  -0.110915252977131,
        -2.974202599328418, -1.769444151220627, -1.543642101844257, -1.555314391083978, 2.530546673563627,  1.505499662981615,  -0.602776616552922,
        -0.674741571082021, -0.000000000000000, -0.000000000000000, -0.701963334739314, -0.752371396949996, -0.000000000000000, -0.000000000000000,
        0.224884998034159,  0.304568777392899,  0.000000000000000,  -0.000000000000000, -0.156068133446100, -0.257703250499289, -1.029516152627371,
        -1.699411662899841, -0.774735751733108, -0.951406975300998, 0.875945262101340,  1.445913782584103,  -0.388075954438520, -0.512286159186172,
        -0.000000000000000, -0.000000000000000, -0.442986879076064, -0.599783033932462, -0.000000000000000, -0.000000000000000, -4.299018588390974,
        -3.755097527292911, -0.477859490383632, -0.990447835904842, -0.000000000000000, -0.000000000000000, 0.479263383032632,  0.399832910727535,
        -0.000000000000000, -0.000000000000000, -0.509900640376408, -0.516384061128068, 2.866012392260649,  2.503398351528607,  0.146452980925238,
        0.455807558443999,  -0.000000000000000, -0.000000000000000, -0.408128990571764, -0.374103199693884, -2.934470722902404, -3.286335345030996,
        -0.566970041672542, -1.215511576368733, -0.000000000000000, -0.000000000000000, 0.358978688685182,  0.401755192067967,  -0.000000000000000,
        -0.000000000000000, -0.427252981970255, -0.535689667398840, 1.956313815268270,  2.190890230020664,  0.218723200067117,  0.593607931797707,
        -0.000000000000000, -0.000000000000000, -0.322442512172765, -0.382116740569098, -0.367914483477564, -0.534249160364474, -2.974202599328418,
        -1.769444151220627, 0.357844341971861,  0.335513961425315,  0.000000000000000,  -0.000000000000000, -0.337597230203321, -0.371804690099662,
        0.000000000000000,  -0.000000000000000, 0.075058606816277,  0.163676194452714,  2.191517704768308,  1.303800953530989,  -0.318563400881526,
        -0.321695241869661, -0.000000000000000, -0.000000000000000, -0.431736574033400, -0.654513067356538, -1.029516152627371, -1.699411662899841,
        0.166749724194721,  0.209555391354006,  -0.000000000000000, -0.000000000000000, -0.211384705275894, -0.278051537959113, -0.000000000000000,
        -0.000000000000000, 0.181600293974772,  0.300343585546260,  0.758590849304379,  1.252198067399883,  -0.170954964231797, -0.220003611526341,
        -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 12, 20));

    std::vector<double> intyvals{
        4.299018588390974,  3.755097527292911,  0.138041837865464,  0.648894349757392,  -1.433006196130324, -1.251699175764303, -0.056902702679890,
        -0.246662422017405, -0.000000000000000, -0.000000000000000, 0.573094450041449,  0.520567450133967,  -0.000000000000000, -0.000000000000000,
        -0.749358170293568, -0.712246684584943, -0.000000000000000, -0.000000000000000, -0.300139358796242, -0.277738761961131, 2.934470722902404,
        3.286335345030996,  0.283519680066745,  0.861582432387719,  -0.978156907634135, -1.095445115010332, -0.113262941814310, -0.321638822679586,
        -0.000000000000000, -0.000000000000000, 0.450408393782822,  0.530919395853708,  -0.000000000000000, -0.000000000000000, -0.604664886751286,
        -0.731771312005503, -0.000000000000000, -0.000000000000000, -0.238431405882455, -0.284129334794141, 0.101567012748200,  0.245762053750412,
        2.974202599328418,  1.769444151220627,  -0.044757570007081, -0.103628129797261, -0.939221873472132, -0.558771837227566, 0.404786737420279,
        0.405055865739040,  -0.000000000000000, -0.000000000000000, -0.514833428263505, -0.535309913872790, -0.000000000000000, -0.000000000000000,
        -0.200196979597631, -0.203361291974649, -0.000000000000000, -0.000000000000000, 0.269707221928669,  0.442192298625010,  1.029516152627371,
        1.699411662899841,  -0.104900064982974, -0.167603612972608, -0.325110363987591, -0.536656314599950, 0.213596625360265,  0.274156627552415,
        -0.000000000000000, -0.000000000000000, -0.291361145368443, -0.377959068144506, -0.000000000000000, -0.000000000000000, -0.108604480096094,
        -0.139997229737112, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.667555873229949, -0.530516397310046,
        -0.000000000000000, -0.000000000000000, 0.516031691587574,  0.449196795757830,  -1.654693026172490, -1.445337712143907, 0.824701527177400,
        0.500057102409351,  4.299018588390974,  3.755097527292911,  -0.422598316051934, 0.302571540175198,  -0.000000000000000, 0.000000000000000,
        -0.542968034469407, -0.432184831412288, -0.000000000000000, -0.000000000000000, -0.504011424633944, -0.506007646260939, -0.000000000000000,
        -0.000000000000000, 0.395828823039832,  0.454811787390017,  -1.129478307864519, -1.264911064067352, 0.563693289377225,  0.416492014368196,
        2.934470722902404,  3.286335345030997,  -0.107379064395073, 0.576699129459711,  -0.000000000000000, -0.000000000000000, -0.407769327447705,
        -0.415632757991542, -0.606930581010622, -0.675763113819387, -0.000000000000000, -0.000000000000000, 0.565168670609831,  0.557682558324797,
        0.000000000000000,  -0.000000000000000, 0.810203434037384,  0.776898004641900,  -1.084520002955840, -0.645214141277835, -0.562710827832350,
        -0.529408731429369, 2.974202599328418,  1.769444151220627,  -0.562496097573578, -0.603839095244868, 0.000000000000000,  -0.000000000000000,
        -0.410925051406997, -0.562294329322652, -0.000000000000000, -0.000000000000000, 0.290535928475425,  0.371352269369576,  -0.000000000000000,
        -0.000000000000000, 0.376156355654986,  0.459701360907280,  -0.375405112329146, -0.619677335393187, -0.232355179228063, -0.263157808700251,
        1.029516152627371,  1.699411662899841,  -0.352708423423164, -0.475029761143693, 0.000000000000000,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.541390792485272, -0.510271139280430, -0.000000000000000, -0.000000000000000, -0.550350400632783, -0.631572307896711,
        -2.482039539258736, -2.168006568215861, -0.705863519552157, -1.196412512640925, -1.433006196130324, -1.251699175764303, -1.211948549641857,
        -1.386191407391484, 4.299018588390975,  3.755097527292912,  0.471899435592658,  0.969236312111897,  -0.000000000000000, -0.000000000000000,
        -0.434708062921692, -0.523560024417352, -0.000000000000000, -0.000000000000000, -0.480970645216718, -0.688667096050492, -1.694217461796779,
        -1.897366596101028, -0.745531581825181, -1.425460296450393, -0.978156907634135, -1.095445115010332, -1.054613738128205, -1.513955494087815,
        2.934470722902404,  3.286335345030997,  0.554416445005753,  1.191195677277121,  -0.594493758084355, -0.611977917088951, 0.000000000000000,
        -0.000000000000000, -0.730999873626977, -0.710718005152383, 0.000000000000000,  -0.000000000000000, -0.495125782047012, -0.500496789851146,
        -1.717156671346748, -1.021589057023238, -1.089288606960709, -1.136689751727059, -0.939221873472132, -0.558771837227567, 0.414573355094351,
        0.571910647407353,  2.974202599328418,  1.769444151220628,  -0.330417138299249, -0.427484969847204, -0.000000000000000, -0.000000000000000,
        -0.341692464546722, -0.413153513095343, -0.000000000000000, -0.000000000000000, -0.259349868082483, -0.327731763983383, -0.594391427854482,
        -0.981155781039213, -0.628360191412463, -0.822866101315360, -0.325110363987591, -0.536656314599950, 0.447525728444722,  0.672989802495877,
        1.029516152627371,  1.699411662899841};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 12, 20));

    std::vector<double> intzvals{
        -2.866012392260649, -2.503398351528607, -0.383072064445402, -0.801123373009106, -0.000000000000000, -0.000000000000000, -0.451267971790708,
        -0.385676843008198, -0.827346513086245, -0.722668856071954, -0.345731321928567, -0.353931478610066, -0.000000000000000, -0.000000000000000,
        0.189846774568201,  0.008381292810140,  -1.433006196130325, -1.251699175764304, 0.068868768924288,  -0.186777532525244, -1.956313815268270,
        -2.190890230020664, -0.452487298094656, -0.990108677263317, -0.000000000000000, -0.000000000000000, -0.342592154533400, -0.389231923622582,
        -0.564739153932260, -0.632455532033676, -0.281686836771746, -0.380547426919646, -0.000000000000000, -0.000000000000000, 0.098919014390669,
        -0.059970909884021, -0.978156907634135, -1.095445115010332, -0.030061370620095, -0.284578870511692, -0.118436267076581, -0.174308062786432,
        -2.191517704768308, -1.303800953530988, -0.493953921128072, -0.482765717505928, -0.000000000000000, -0.000000000000000, -0.540546848486443,
        -0.578800896427782, -0.542260001477920, -0.322607070638917, 0.435192250765744,  0.545984639849490,  -0.000000000000000, -0.000000000000000,
        0.226817177091792,  0.213505648986071,  -0.939221873472132, -0.558771837227567, -0.148705283452710, -0.230325456926048, -0.758590849304379,
        -1.252198067399883, -0.249382450011056, -0.317806534825760, -0.000000000000000, -0.000000000000000, -0.345131383455670, -0.470991772685372,
        -0.187702556164573, -0.309838667696594, 0.381229846508745,  0.550268747558130,  -0.000000000000000, -0.000000000000000, 0.098609236332806,
        0.116799095923312,  -0.325110363987591, -0.536656314599950, -0.000000000000000, -0.000000000000000, 0.339817652518168,  0.341553486147450,
        1.433006196130324,  1.251699175764303,  -0.422360680352742, -0.153170488710130, -0.000000000000000, -0.000000000000000, -0.063193809665041,
        -0.004183389005898, -2.866012392260649, -2.503398351528607, 0.602905189368329,  0.256439126140944,  -0.000000000000000, -0.000000000000000,
        0.708268349368006,  0.651841961655015,  -0.000000000000000, -0.000000000000000, 0.283450361605797,  0.353929143981013,  0.978156907634135,
        1.095445115010332,  -0.245715746870872, -0.080116369388381, -0.000000000000000, -0.000000000000000, -0.023155411812567, 0.004770271545132,
        -1.956313815268270, -2.190890230020664, 0.385941686684169,  0.138163380207796,  -0.000000000000000, -0.000000000000000, 0.560873918055220,
        0.666246075363240,  0.266347470729364,  0.288487106614062,  -0.000000000000000, -0.000000000000000, -0.313086771964780, -0.231885831628054,
        0.939221873472132,  0.558771837227566,  -0.067189507216959, -0.033251175639378, -0.000000000000000, -0.000000000000000, 0.439774821447228,
        0.371633719420077,  -2.191517704768308, -1.303800953530989, 0.518760380479157,  0.525056533844311,  -0.000000000000000, -0.000000000000000,
        0.162029352104730,  0.212320768731529,  -0.000000000000000, -0.000000000000000, -0.061849659211748, -0.041951778381398, 0.325110363987591,
        0.536656314599950,  -0.002211920084371, 0.003894910406697,  -0.000000000000000, -0.000000000000000, 0.109760851393672,  0.077615482598246,
        -0.758590849304379, -1.252198067399883, 0.279559444327891,  0.360000841263453,  -0.000000000000000, -0.000000000000000, 1.433006196130324,
        1.251699175764303,  0.617538661899427,  0.831469035609070,  -0.000000000000000, -0.000000000000000, 0.391727872246915,  0.583092304767478,
        1.654693026172490,  1.445337712143907,  0.425368478315038,  0.559281308180990,  -0.000000000000000, -0.000000000000000, 0.729923147214376,
        0.698086980980353,  -2.866012392260650, -2.503398351528608, -0.309092099535651, -0.748725772583759, 0.978156907634135,  1.095445115010332,
        0.580084013997161,  0.945689996108885,  -0.000000000000000, -0.000000000000000, 0.389638066275812,  0.673938826458893,  1.129478307864520,
        1.264911064067352,  0.397331971190480,  0.629639705536686,  -0.000000000000000, -0.000000000000000, 0.591130939468772,  0.717923335774729,
        -1.956313815268270, -2.190890230020664, -0.401718004358735, -0.939182539822924, 0.436794889343239,  0.468586161204697,  0.939221873472132,
        0.558771837227567,  0.205150296382395,  0.141290341743335,  -0.000000000000000, -0.000000000000000, 0.712161872123198,  0.831350577494216,
        1.265273336781814,  0.752749831490807,  0.801921093484831,  0.832069194257976,  -0.000000000000000, -0.000000000000000, -0.055504275356647,
        -0.120680332566226, -2.191517704768308, -1.303800953530989, 0.269208974886060,  0.358879265156373,  0.325110363987591,  0.536656314599950,
        0.002157349046276,  -0.048966042875428, -0.000000000000000, -0.000000000000000, 0.537576393920369,  0.754512816374001,  0.437972631050670,
        0.722956891292052,  0.452124817874071,  0.586181949028294,  -0.000000000000000, -0.000000000000000, -0.124639951873227, -0.201288994462054,
        -0.758590849304379, -1.252198067399883};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 12, 20));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputePFForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix amomxmat(12, 28);

    CDenseMatrix amomymat(12, 28);

    CDenseMatrix amomzmat(12, 28);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, -0.554884381130376, -0.952817145173948, -0.000000000000000, -0.000000000000000, -0.928839884305137,
        -0.961485146077200, -0.000000000000000, -0.000000000000000, -2.063709734775537, -2.842912408411502, 0.000000000000000,  -0.000000000000000,
        0.146902760477648,  -0.394994231976923, -0.000000000000000, -0.000000000000000, -0.205144698310518, -0.340709244221714, 0.000000000000000,
        0.000000000000000,  0.107148531878130,  -0.379546485472708, -0.000000000000000, -0.000000000000000, -0.045425802764658, -0.380325136517259,
        -0.000000000000000, -0.000000000000000, -0.463266720040639, -0.987693645539818, -0.000000000000000, -0.000000000000000, -0.585533647148247,
        -0.904104694543090, -0.000000000000000, -0.000000000000000, -1.511075982767128, -2.847018328821560, 0.000000000000000,  -0.000000000000000,
        -0.064186624667769, -0.514116512515669, -0.000000000000000, -0.000000000000000, -0.162661282925832, -0.358653496329365, 0.000000000000000,
        -0.000000000000000, -0.077450761368103, -0.478670290509365, -0.000000000000000, -0.000000000000000, -0.127835174731196, -0.439458668464026,
        0.467242496268111,  0.609055596520692,  0.000000000000001,  -0.000000000000000, 0.915539875642562,  0.892963762658460,  0.000000000000000,
        0.000000000000000,  1.666584664884141,  1.816777770838379,  0.000000000000000,  -0.000000000000000, -0.346193938812369, -0.321087899200332,
        -0.000000000000000, 0.000000000000000,  0.222431889891284,  0.149714720247635,  0.000000000000000,  0.000000000000000,  -0.121544310185504,
        0.048160472982627,  -0.000000000000000, -0.000000000000000, -0.035327122361626, 0.079970971396707,  0.000000000000000,  0.000000000000000,
        0.269391255753715,  0.430954362274049,  -0.000000000000000, -0.000000000000000, 0.281874041332333,  0.400089670600852,  0.000000000000000,
        -0.000000000000000, 0.672216710974144,  1.016877260390133,  -0.000000000000000, -0.000000000000000, -0.085582710845870, -0.109891349985112,
        0.000000000000000,  -0.000000000000000, 0.018390232347903,  0.009019350679697,  0.000000000000000,  -0.000000000000000, 0.100824304700693,
        0.197426713660904,  0.000000000000000,  -0.000000000000000, 0.083587149008206,  0.155562509402780,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.227657334753506,  0.163717382994361,  -0.000000000000000, -0.000000000000000, 0.012313570254065,
        0.450908824261503,  0.000000000000000,  -0.000000000000000, 1.230321639240091,  1.850918857948859,  -0.000000000000000, -0.000000000000000,
        0.796223908181802,  -0.512199409292782, -0.000000000000000, -0.000000000000000, 0.842591650249866,  0.520858438716719,  -0.000000000000000,
        -0.000000000000000, 0.487942008345730,  -0.183197141699056, -0.000000000000000, -0.000000000000000, 0.518511249769909,  0.340584107995023,
        -0.000000000000000, -0.000000000000000, 0.124264105192968,  0.133275969154311,  -0.000000000000000, -0.000000000000000, 0.145434828931975,
        0.521467240950715,  0.000000000000000,  -0.000000000000000, 0.965955716531206,  1.856419340093491,  -0.000000000000000, -0.000000000000000,
        0.119879784520703,  -0.831576033810181, -0.000000000000000, -0.000000000000000, 0.442874369773382,  0.380861361291035,  -0.000000000000000,
        -0.000000000000000, 0.105064828035826,  -0.344479392383113, -0.000000000000000, -0.000000000000000, 0.269687267281905,  0.270429337032047,
        -0.249250937886642, -0.257688408120388, 0.000000000000000,  0.000000000000000,  0.025389025940355,  -0.063630670461134, -0.000000000000000,
        -0.000000000000000, -1.004972406370180, -1.166687451711343, 0.000000000000000,  -0.000000000000000, -1.008379461304348, -0.684032558967271,
        0.000000000000000,  -0.000000000000000, -0.927314851422325, -0.877485259397749, 0.000000000000000,  0.000000000000000,  -0.643309346350468,
        -0.545387210311497, 0.000000000000000,  -0.000000000000000, -0.512345692199500, -0.513873280038169, -0.000000000000000, -0.000000000000000,
        -0.085911842093787, -0.124206713892419, -0.000000000000000, -0.000000000000000, -0.051653134074219, -0.090335925402154, -0.000000000000000,
        -0.000000000000000, -0.433758603073408, -0.650627362566810, 0.000000000000000,  -0.000000000000000, -0.041551932151324, 0.056107476598559,
        -0.000000000000000, -0.000000000000000, -0.238433983309178, -0.308603704467249, 0.000000000000000,  -0.000000000000000, -0.129355529712061,
        -0.156310424592076, -0.000000000000000, -0.000000000000000, -0.169367563034555, -0.244914523496565, 0.000000000000000,  -0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.594401538707279,  0.822911467982223,  -0.000000000000000, -0.000000000000000, 0.503116620973810,
        0.914264335259962,  -0.000000000000000, -0.000000000000000, -0.236138176335093, -0.240502749145966, -0.000000000000000, -0.000000000000000,
        0.836332274401782,  0.840516347703700,  -0.000000000000000, -0.000000000000000, -0.533280304498474, -1.169927660003883, -0.000000000000000,
        -0.000000000000000, 0.363326286795776,  0.107820577976648,  -0.000000000000000, -0.000000000000000, -0.429131260720559, -0.858668346447200,
        -0.000000000000000, -0.000000000000000, 0.438919894882541,  0.821405930320721,  -0.000000000000000, -0.000000000000000, 0.438468455644218,
        0.950456331124551,  -0.000000000000000, -0.000000000000000, -0.143681642516108, -0.230758801883990, -0.000000000000000, -0.000000000000000,
        0.526080306394801,  0.775308749172487,  -0.000000000000000, -0.000000000000000, -0.516293146039845, -1.257080621288600, -0.000000000000000,
        -0.000000000000000, 0.151162236920249,  0.032780164687128,  -0.000000000000000, -0.000000000000000, -0.395095950811402, -0.907477360104770,
        -0.486997631965421, -0.577718841785961, -0.000000000000000, -0.000000000000000, -0.422148415352204, -0.569184778174584, 0.000000000000000,
        -0.000000000000000, 0.192318328891811,  0.184047597134712,  0.000000000000000,  0.000000000000000,  -0.625558720226595, -0.662613206626192,
        -0.000000000000000, -0.000000000000000, 0.422352059525656,  0.651763639795178,  0.000000000000000,  -0.000000000000000, -0.302141494491739,
        -0.220304404257852, 0.000000000000000,  0.000000000000000,  0.344060093654598,  0.496942309110766,  0.000000000000001,  -0.000000000000000,
        -0.231832575307880, -0.359728092620332, -0.000000000000000, -0.000000000000000, -0.253350463091012, -0.404784504517046, -0.000000000000000,
        -0.000000000000000, 0.063128013731076,  0.094282480309947,  0.000000000000000,  -0.000000000000000, -0.228574458813310, -0.335113326459245,
        -0.000000000000000, -0.000000000000000, 0.334236779442707,  0.557089074097148,  -0.000000000000000, -0.000000000000000, -0.029840887111769,
        -0.016845294547571, 0.000000000000000,  -0.000000000000000, 0.237314688181051,  0.387350606524210,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 12, 28));

    std::vector<double> intyvals{
        -0.000000000000000, -0.000000000000000, -0.097245181914934, -0.411555271704529, -0.000000000000000, -0.000000000000000, -0.168826546210434,
        -0.784561577781872, -0.000000000000000, -0.000000000000000, 0.106545799099751,  0.502664776372284,  -0.000000000000000, -0.000000000000000,
        -0.856594674234179, -0.805947663687300, -0.000000000000000, -0.000000000000000, 0.653508573172081,  0.676659044316438,  -0.000000000000000,
        -0.000000000000000, 0.339872045669224,  0.140343087996488,  -0.000000000000000, -0.000000000000000, 0.488039871716975,  0.897178973619410,
        -0.000000000000000, -0.000000000000000, -0.152695653310445, -0.464903667479190, -0.000000000000000, -0.000000000000000, -0.284419802744195,
        -0.892323696840082, -0.000000000000000, -0.000000000000000, 0.184514710609447,  0.568208740728453,  -0.000000000000000, -0.000000000000000,
        -0.520534193030768, -0.731654567123889, -0.000000000000000, -0.000000000000000, 0.416984255370582,  0.629415950882410,  -0.000000000000000,
        -0.000000000000000, 0.153754447376236,  0.076650324723578,  -0.000000000000000, -0.000000000000000, 0.424641977909241,  0.939428872943500,
        0.087564655961013,  0.190306395936119,  0.000000000000000,  0.000000000000000,  0.145865946734292,  0.344747779014480,  -0.000000000000000,
        -0.000000000000000, -0.090535851006836, -0.220966658436563, -0.000000000000000, -0.000000000000000, 0.646211754598194,  0.652957148261872,
        0.000000000000000,  -0.000000000000000, -0.490008098766632, -0.521878401337897, -0.000000000000000, -0.000000000000000, -0.240945448481676,
        -0.188859830694228, 0.000000000000000,  -0.000000000000000, -0.375944800889843, -0.520398269620897, -0.000000000000001, -0.000000000000000,
        0.114760081558709,  0.197758804423011,  0.000000000000000,  -0.000000000000000, 0.216457327132336,  0.376310370406572,  -0.000000000000000,
        -0.000000000000000, -0.135705433219265, -0.233985976576005, -0.000000000000000, -0.000000000000000, 0.213152410959478,  0.306010538426847,
        -0.000000000000000, -0.000000000000000, -0.181301709543888, -0.266540654938396, -0.000000000000000, -0.000000000000000, -0.033930181597551,
        -0.031434072069554, -0.000000000000000, -0.000000000000000, -0.242573582997350, -0.393840963273075, -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.529432775817358,  0.370555231781952,  -0.000000000000000, -0.000000000000000, 0.384120428524592,
        -0.221834479158050, -0.000000000000000, -0.000000000000000, -0.678257426324378, -0.342661543620450, -0.000000000000000, -0.000000000000000,
        -0.395851434177016, 0.354091097236413,  -0.000000000000000, -0.000000000000000, -0.418605781414878, -1.298072228954080, -0.000000000000000,
        -0.000000000000000, 0.579558815375472,  0.099453335597376,  -0.000000000000000, -0.000000000000000, -0.182849968634755, -0.127906197491791,
        -0.000000000000000, -0.000000000000000, 0.284914425321733,  0.299316989779113,  -0.000000000000000, -0.000000000000000, 0.065476029760604,
        -0.371387075338617, -0.000000000000000, -0.000000000000000, -0.322543395787661, -0.231250140003394, -0.000000000000000, -0.000000000000000,
        -0.027246455762924, 0.527519240913294,  -0.000000000000000, 0.000000000000000,  -0.516673092396241, -1.439294058159200, -0.000000000000000,
        -0.000000000000000, 0.221212331069304,  -0.036057448256048, -0.000000000000000, -0.000000000000000, -0.099006910908797, -0.102415956473236,
        -0.556896233311532, -0.572350777054086, -0.000000000000000, -0.000000000000000, -0.524900861261127, -0.465430992283845, 0.000000000000000,
        -0.000000000000000, 0.727034450240350,  0.639225027349703,  -0.000000000000000, -0.000000000000000, 0.516728567512852,  0.348556699380938,
        -0.000000000000000, -0.000000000000000, 0.098689762730260,  0.276609580847855,  -0.000000000000000, 0.000000000000000,  -0.730387186120845,
        -0.663920404387186, 0.000000000000000,  0.000000000000000,  0.166916130384323,  0.178927367073990,  0.000000000000000,  0.000000000000000,
        -0.190778124987134, -0.276141162144338, -0.000000000000000, -0.000000000000000, -0.113738118750090, -0.138371969288406, -0.000000000000000,
        -0.000000000000000, 0.164202115059147,  0.208862890275488,  -0.000000000000000, -0.000000000000000, 0.025039078448154,  -0.019495129981155,
        -0.000000000000000, -0.000000000000000, 0.185575704815740,  0.326963732716262,  -0.000000000000000, 0.000000000000000,  -0.178925620551941,
        -0.233270603060957, 0.000000000000000,  -0.000000000000000, 0.062379393774480,  0.091764903650999,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.379379084140056, -0.810070122658677, -0.000000000000000, -0.000000000000000, 1.040710107044749,
        1.053155693193572,  -0.000000000000000, -0.000000000000000, 0.607018356135218,  0.826968786930061,  -0.000000000000000, -0.000000000000000,
        0.536532534968906,  1.118470311074272,  -0.000000000000000, -0.000000000000000, 1.601168593983799,  2.022372806776204,  0.000000000000000,
        0.000000000000000,  -0.608186564898937, -1.181204358303570, -0.000000000000000, -0.000000000000000, -0.617461627501079, -0.842296297799147,
        -0.000000000000000, -0.000000000000000, -0.363278734484117, -0.864325404036416, -0.000000000000000, -0.000000000000000, 0.655637845898472,
        0.974968531110615,  -0.000000000000000, -0.000000000000000, 0.445453715985168,  0.821257992550472,  -0.000000000000000, -0.000000000000000,
        0.506284288906125,  1.189309924858473,  -0.000000000000000, -0.000000000000000, 1.125875482567596,  1.980285139214178,  0.000000000000000,
        -0.000000000000000, -0.548467597261966, -1.244910915319755, -0.000000000000000, -0.000000000000000, -0.452326137628466, -0.838248184672260,
        0.272317843903038,  0.422007274990772,  0.000000000000001,  -0.000000000000000, -1.013007820585905, -0.997249089623242, -0.000000000000000,
        -0.000000000000000, -0.535178440265841, -0.470379086007280, -0.000000000000000, -0.000000000000000, -0.161336305128728, -0.237527145231043,
        -0.000000000000000, -0.000000000000000, -1.270504814374931, -1.346445786910240, -0.000000000000000, -0.000000000000000, 0.560127482089157,
        0.742660337124301,  -0.000000000000000, -0.000000000000000, 0.576985725090312,  0.664965352350372,  0.000000000000000,  0.000000000000000,
        0.213359300626427,  0.353645751875211,  -0.000000000000000, -0.000000000000000, -0.309019957745120, -0.432674232476884, -0.000000000000000,
        -0.000000000000000, -0.114195037469129, -0.138645960493022, -0.000000000000000, -0.000000000000000, -0.115177370067776, -0.188771614085858,
        -0.000000000000000, -0.000000000000000, -0.468602782128301, -0.690276855217198, -0.000000000000000, -0.000000000000000, 0.332373987891835,
        0.533273971579746,  -0.000000000000000, -0.000000000000000, 0.258189471802646,  0.396189224531480,  0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 12, 28));

    std::vector<double> intzvals{
        -0.000000000000000, -0.000000000000000, 0.335063488965044,  0.728597673436279,  -0.000000000000000, -0.000000000000000, 0.585391263037434,
        1.108974767793779,  -0.000000000000000, -0.000000000000000, 0.504972112708790,  0.440369966571092,  -0.000000000000000, -0.000000000000000,
        0.348821696930114,  0.393870467998885,  -0.000000000000000, -0.000000000000000, -0.243005966617089, -0.134225562654423, -0.000000000000000,
        -0.000000000000000, -0.122121162373663, 0.255313980979856,  -0.000000000000000, -0.000000000000000, -0.344270708653990, -0.527053534705388,
        -0.000000000000000, -0.000000000000000, 0.324589157856088,  0.779194974251223,  -0.000000000000000, -0.000000000000000, 0.516810060007426,
        1.168965762345837,  -0.000000000000000, -0.000000000000000, 0.293046643222565,  0.394948627758821,  -0.000000000000000, -0.000000000000000,
        0.230228240864711,  0.377615042441524,  -0.000000000000000, -0.000000000000000, -0.122895913113688, -0.090976815125901, -0.000000000000000,
        -0.000000000000000, 0.035053614701413,  0.335986305296006,  -0.000000000000000, 0.000000000000000,  -0.268122355933049, -0.537091233210169,
        -0.108105079105629, -0.198595438279955, -0.000000000000000, -0.000000000000000, -0.199339996223319, -0.278819099863977, -0.000000000000000,
        -0.000000000000000, -0.596718558594981, -0.582116344296126, -0.000000000000000, 0.000000000000000,  -0.575596503322272, -0.646788679332665,
        -0.000000000000000, -0.000000000000000, 0.442351211348522,  0.535742192464130,  0.000000000000000,  -0.000000000000000, 0.388054634941275,
        0.344030767427250,  -0.000000000000000, -0.000000000000000, 0.247604269746896,  0.305042065756270,  0.000000000000000,  -0.000000000000000,
        -0.111106029525748, -0.188542489860821, -0.000000000000000, -0.000000000000000, -0.134918111370261, -0.222031829053903, -0.000000000000000,
        -0.000000000000000, -0.184850657286636, -0.263299085172547, 0.000000000000000,  -0.000000000000000, -0.245914766458345, -0.375076564121834,
        -0.000000000000000, -0.000000000000000, 0.215803342990943,  0.334434441266781,  -0.000000000000000, -0.000000000000000, 0.088609375231354,
        0.112593359178798,  -0.000000000000000, -0.000000000000000, 0.128759362472683,  0.203321924607026,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.497156356792346, -0.411356196277694, -0.000000000000000, -0.000000000000000, -0.334290074763376,
        -0.129702757478090, -0.000000000000000, -0.000000000000000, 0.129592377235342,  -0.262162027226318, -0.000000000000000, -0.000000000000000,
        0.020262399832397,  -0.034568684016399, -0.000000000000000, -0.000000000000000, -0.120228268673607, 0.493268615687445,  -0.000000000000000,
        -0.000000000000000, -0.703198332465000, -0.248163665973136, -0.000000000000000, -0.000000000000000, -0.058908610996416, -0.038510627172210,
        -0.000000000000000, -0.000000000000000, -0.286224241572095, -0.356502262841531, -0.000000000000000, -0.000000000000000, -0.154048652900023,
        -0.058132634284469, -0.000000000000000, -0.000000000000000, -0.040833068093339, -0.337449938844463, -0.000000000000000, -0.000000000000000,
        -0.005546113364033, -0.043654182048597, -0.000000000000000, -0.000000000000000, 0.099308890669263,  0.627664670406190,  -0.000000000000000,
        -0.000000000000000, -0.304916684296485, -0.109430489410705, -0.000000000000000, -0.000000000000000, -0.029546027097839, -0.031951512838730,
        0.399432976004407,  0.387412445849842,  -0.000000000000000, -0.000000000000000, 0.276282468617912,  0.224436999160104,  -0.000000000000000,
        0.000000000000000,  -0.101782477884976, 0.036919061301850,  -0.000000000000000, -0.000000000000000, -0.020653034371599, 0.009656058364321,
        0.000000000000000,  0.000000000000000,  0.067656039240976,  -0.129885238457281, -0.000000000000000, -0.000000000000000, 0.543086942973415,
        0.409164234952080,  -0.000000000000000, -0.000000000000000, 0.031884707235244,  0.023455960510131,  -0.000000000000000, -0.000000000000000,
        0.117072493749171,  0.161969288197321,  -0.000000000000000, -0.000000000000000, 0.036893135958676,  0.028474134110474,  0.000000000000000,
        -0.000000000000000, 0.072577419488190,  0.139703496266059,  -0.000000000000000, -0.000000000000000, 0.015422047853832,  0.029102788032398,
        0.000000000000000,  -0.000000000000000, -0.152935069898819, -0.290548419158752, -0.000000000000000, -0.000000000000000, 0.063771068709320,
        0.048279366617124,  -0.000000000000000, -0.000000000000000, 0.005258894816299,  0.006490356748865,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.089187912556500,  0.321740113569306,  -0.000000000000000, -0.000000000000000, -0.965650356291754,
        -1.155867501887098, 0.000000000000000,  0.000000000000000,  -0.364748897976032, -0.505939326631284, -0.000000000000000, -0.000000000000000,
        -0.355226355971247, -0.567910286178347, -0.000000000000000, -0.000000000000000, -0.782950608010582, -0.769413916685663, -0.000000000000000,
        -0.000000000000000, 0.466531548568630,  1.035589758993986,  -0.000000000000000, -0.000000000000000, 0.646704815924873,  0.989932344783424,
        -0.000000000000000, 0.000000000000000,  0.123719328970593,  0.359955837559112,  -0.000000000000000, -0.000000000000000, -0.661526930490595,
        -1.116523117744837, 0.000000000000000,  0.000000000000000,  -0.272173895906918, -0.501651661900173, -0.000000000000000, -0.000000000000000,
        -0.285251302214992, -0.580755755207840, -0.000000000000000, -0.000000000000000, -0.487687122336649, -0.704595781942959, -0.000000000000000,
        -0.000000000000000, 0.459038896923841,  1.108840129227580,  -0.000000000000000, -0.000000000000000, 0.505492902326556,  1.006164772385401,
        -0.005650655329204, -0.074729628538260, -0.000000000000000, 0.000000000000000,  0.743953269566622,  0.753357184557728,  -0.000000000000000,
        -0.000000000000000, 0.284471453985139,  0.246227550033141,  0.000000000000000,  -0.000000000000000, 0.671623030176423,  0.847558942380352,
        -0.000000000000000, -0.000000000000000, 0.932001777747012,  0.966547405111352,  0.000000000000000,  0.000000000000000,  -0.091186377644560,
        -0.192324263951561, -0.000000000000000, -0.000000000000000, -0.417242998793424, -0.500775705523699, -0.000000000000000, -0.000000000000000,
        -0.060228817146383, -0.108968597747727, -0.000000000000000, -0.000000000000000, 0.242875701293027,  0.345956633346761,  -0.000000000000000,
        -0.000000000000000, 0.054319126227018,  0.060651210083934,  0.000000000000000,  0.000000000000000,  0.361729375146458,  0.572170307213120,
        -0.000000000000000, -0.000000000000000, 0.324076077248778,  0.469730521295306,  0.000000000000000,  -0.000000000000000, -0.113287484300368,
        -0.194040920206143, -0.000000000000000, -0.000000000000000, -0.202996584733673, -0.315919281650817, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 12, 28));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputePGForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 1);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix amomxmat(12, 36);

    CDenseMatrix amomymat(12, 36);

    CDenseMatrix amomzmat(12, 36);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, 0.349568357258917,  0.616400075976620,  -0.000000000000000, -0.000000000000000, 0.762961218231390,
        1.182136845801180,  -0.000000000000000, -0.000000000000000, 1.195271391836920,  1.392847177249617,  0.000000000000000,  0.000000000000000,
        1.938596323867818,  2.815284875404118,  -0.000000000000000, -0.000000000000000, -0.697181339816468, -0.425943731467505, -0.000000000000000,
        -0.000000000000000, -0.027189630735889, 0.189840640064276,  -0.000000000000000, 0.000000000000000,  -0.663049475863555, -0.517156935306398,
        -0.000000000000000, -0.000000000000000, -0.137964459529965, 0.196805031239922,  -0.000000000000000, -0.000000000000000, -0.277955024969881,
        -0.347238925416636, -0.000000000000000, -0.000000000000000, 0.233212913622471,  0.551031289618188,  -0.000000000000001, 0.000000000000000,
        0.466988394934797,  1.039524860149995,  -0.000000000000000, -0.000000000000000, 0.612958105705349,  1.170256501195988,  -0.000000000000000,
        -0.000000000000000, 1.136530436671144,  2.455303078613208,  -0.000000000000001, -0.000000000000001, -0.261869188877666, -0.290466708245189,
        -0.000000000000000, -0.000000000000000, 0.039312164612065,  0.200511484627559,  0.000000000000000,  -0.000000000000001, -0.276301624261496,
        -0.390679750735676, -0.000000000000000, -0.000000000000000, 0.020472577496286,  0.223622316566220,  -0.000000000000000, -0.000000000000001,
        -0.148986762946735, -0.294808511492056, 0.283055754912303,  0.393453830742950,  0.000000000000000,  -0.000000000000000, 0.677518550264271,
        0.841811851152425,  -0.000000000000000, -0.000000000000000, 1.045266768116533,  1.049245495625678,  0.000000000000000,  -0.000000000000000,
        1.456733565629403,  1.687576034833793,  0.000000000000000,  0.000000000000000,  -0.795483581666252, -0.762042269848875, -0.000000000000000,
        -0.000000000000000, -0.131195726416106, -0.165764571535506, -0.000000000000000, -0.000000000000000, -0.546037440397103, -0.485129473124146,
        0.000000000000000,  -0.000000000000000, -0.177904891033980, -0.031182731363530, -0.000000000000000, -0.000000000000000, -0.257042592662391,
        -0.287030463387846, 0.000000000000000,  -0.000000000000000, 0.107885614300350,  0.187158167908795,  -0.000000000000000, -0.000000000000000,
        0.212058093096806,  0.360236811389544,  -0.000000000000000, -0.000000000000000, 0.212686499131913,  0.338605166205617,  -0.000000000000000,
        -0.000000000000000, 0.401378151438959,  0.671764336073400,  -0.000000000000000, 0.000000000000000,  -0.141684659305767, -0.217820191040052,
        -0.000000000000001, -0.000000000000000, -0.039220444660260, -0.064823813395834, -0.000000000000000, -0.000000000000000, -0.080637616481874,
        -0.118359864166788, -0.000000000000000, -0.000000000000000, 0.032449558313177,  0.073070740139929,  -0.000000000000000, -0.000000000000000,
        -0.065280781289598, -0.107734924536697, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.283918897955986,
        -0.166122895862279, 0.000000000000000,  0.000000000000000,  -0.253968610857822, -0.039637195828390, -0.000000000000000, -0.000000000000000,
        -0.663739160146048, -0.933868937231556, -0.000000000000001, -0.000000000000000, -1.306556272030799, -1.033556818971309, -0.000000000000001,
        -0.000000000000001, 0.430323661595615,  1.757887998169384,  -0.000000000000000, -0.000000000000000, -0.536092826765856, 0.188771936982872,
        0.000000000000000,  -0.000000000000000, 0.196220428441202,  0.972924616256872,  -0.000000000000000, -0.000000000000000, -0.294156780582726,
        0.172528562415299,  -0.000000000000000, 0.000000000000000,  -0.051693720729969, -0.025838591950454, -0.000000000000000, -0.000000000000000,
        -0.104531397341240, -0.111289675058391, 0.000000000000000,  -0.000000000000000, -0.067216904977701, 0.012030135567946,  -0.000000000000000,
        -0.000000000000000, -0.389637660844010, -0.798209763296331, 0.000000000000000,  -0.000000000000001, -0.557653120391924, -0.770064983391678,
        -0.000000000000000, 0.000000000000000,  0.539149382661401,  1.684815707282072,  -0.000000000000000, -0.000000000000000, -0.076383228258926,
        0.304721086912923,  -0.000000000000000, -0.000000000000000, 0.291225751564172,  0.937632869431867,  -0.000000000000000, -0.000000000000000,
        -0.018997055002826, 0.228344260882345,  0.000000000000000,  0.000000000000000,  -0.017488552586797, -0.016472751531248, -0.305342478495851,
        -0.291084093830353, 0.000000000000000,  0.000000000000000,  -0.333611462872097, -0.290933104284246, -0.000000000000000, -0.000000000000000,
        -0.572066877248041, -0.638277640487894, 0.000000000000000,  -0.000000000000000, -1.224003245495909, -1.122643467919048, -0.000000000000000,
        -0.000000000000000, 0.127492035826222,  0.575090555967895,  -0.000000000000002, -0.000000000000000, -0.681644573786595, -0.442676607961081,
        0.000000000000000,  -0.000000000000000, -0.075129177452292, 0.128866672604964,  -0.000000000000000, -0.000000000000000, -0.400425854522936,
        -0.298909986343293, 0.000000000000000,  -0.000000000000000, -0.046476697424670, -0.041636713586739, 0.000000000000000,  -0.000000000000000,
        -0.054076016129638, -0.083182039728954, -0.000000000000000, -0.000000000000000, -0.044614032475909, -0.062494847130374, -0.000000000000000,
        0.000000000000000,  -0.135281170735953, -0.216274092029481, -0.000000000000000, -0.000000000000000, -0.184511030913133, -0.266707324739081,
        -0.000000000000000, -0.000000000000000, 0.236390922924358,  0.442985841636022,  0.000000000000000,  -0.000000000000000, -0.015028253451009,
        0.019732191117560,  -0.000000000000000, -0.000000000000000, 0.078497545212667,  0.153601901902547,  0.000000000000000,  0.000000000000000,
        -0.034785258516508, -0.041408864217881, -0.000000000000000, -0.000000000000000, -0.007548737445401, -0.011618001941159, 0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.084030860002314,  0.213634660422134,  -0.000000000000000, -0.000000000000000,
        -0.713938470129535, -0.811339320272183, -0.000000000000000, -0.000000000000000, -0.117706853644103, -0.146820955409989, -0.000000000000000,
        -0.000000000000000, -0.078599976808153, 0.036227910894734,  -0.000000000000000, -0.000000000000000, -1.009463298482683, -1.077765434410711,
        0.000000000000000,  0.000000000000000,  0.683076479047643,  1.281787883516417,  -0.000000000000000, -0.000000000000000, -0.036821857918826,
        0.320378647615406,  0.000000000000000,  -0.000000000000000, 0.624989109119313,  1.093421201716799,  -0.000000000000000, -0.000000000000000,
        0.535228914380440,  0.747664478927376,  -0.000000000000000, -0.000000000000000, 0.072644899809741,  0.198302077316383,  -0.000000000000000,
        -0.000000000000000, -0.363399239350244, -0.674499114097850, -0.000000000000000, -0.000000000000000, -0.065649805847809, -0.120676745407002,
        -0.000000000000000, -0.000000000000000, -0.010772919377246, 0.055899665796584,  -0.000000000000000, -0.000000000000000, -0.495603491345503,
        -0.884832914379222, -0.000000000000000, -0.000000000000000, 0.473003687530194,  1.157957970662873,  -0.000000000000000, -0.000000000000000,
        0.073381437763702,  0.329005797460113,  0.000000000000001,  -0.000000000000000, 0.415429767411454,  0.975506991163929,  -0.000000000000000,
        -0.000000000000000, 0.307511162181785,  0.646255853270355,  0.069461210145638,  0.120499982626318,  0.000000000000001,  -0.000000000000000,
        -0.614885341081321, -0.663957725457114, 0.000000000000000,  -0.000000000000000, -0.101630465621044, -0.106515220373237, -0.000000000000000,
        -0.000000000000000, -0.056522688628495, -0.029980621767469, -0.000000000000000, -0.000000000000000, -0.828702694163531, -0.894120293274942,
        -0.000000000000000, -0.000000000000000, 0.610388151781229,  0.861084261884518,  -0.000000000000000, 0.000000000000000,  -0.021887401603522,
        0.125221029475904,  -0.000000000000000, -0.000000000000000, 0.537704758284750,  0.728955201530357,  0.000000000000000,  -0.000000000000000,
        0.460407165025359,  0.553660967479211,  0.000000000000000,  -0.000000000000000, 0.037702520429629,  0.067338600004933,  -0.000000000000000,
        0.000000000000000,  -0.144181758257146, -0.234260498806174, 0.000000000000000,  -0.000000000000000, -0.019105049205877, -0.028252975103291,
        -0.000000000000000, -0.000000000000000, 0.004553221250186,  0.013892890362320,  0.000000000000000,  -0.000000000000000, -0.194954157793579,
        -0.317372828637631, -0.000000000000000, -0.000000000000000, 0.241521363670792,  0.421851388121088,  0.000000000000000,  0.000000000000000,
        0.064296557177044,  0.123894148293765,  -0.000000000000000, -0.000000000000000, 0.195369968336040,  0.336861593578458,  -0.000000000000000,
        -0.000000000000000, 0.134802709976684,  0.226754754671366,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 12, 36));

    std::vector<double> intyvals{
        -0.000000000000000, 0.000000000000000,  -0.245430374180860, -0.326075764053581, 0.000000000000000,  -0.000000000000000, 0.199921543262933,
        0.650356068426301,  0.000000000000000,  0.000000000000000,  0.017806705385687,  0.381438607217311,  -0.000000000000000, -0.000000000000000,
        -0.041442341681965, -0.460142050245414, -0.000000000000000, -0.000000000000000, 0.983071924423748,  0.989185146357909,  -0.000000000000000,
        -0.000000000000000, -0.420369050892630, -0.540312448619930, -0.000000000000000, -0.000000000000000, -0.207013881779237, 0.109005423681231,
        -0.000000000000000, -0.000000000000000, -0.687065537822423, -1.108602770312427, -0.000000000000000, -0.000000000000000, -0.341479097897824,
        -0.607290170648377, -0.000000000000000, -0.000000000000000, -0.136631784844968, -0.279673265254600, 0.000000000000000,  -0.000000000000000,
        0.208007151307766,  0.615943846695332,  0.000000000000000,  -0.000000000000000, 0.098941162978042,  0.382584206736374,  0.000000000000000,
        -0.000000000000000, -0.125817588845365, -0.454480159153089, -0.000000000000000, -0.000000000000000, 0.468057723011162,  0.799869399944357,
        -0.000000000000000, -0.000000000000000, -0.230163466416529, -0.459599507360712, -0.000000000000000, -0.000000000000000, -0.018358043310933,
        0.150992473083357,  -0.000000000000000, -0.000000000000000, -0.431483341665477, -0.980755006599440, -0.000000000000000, -0.000000000000000,
        -0.228752752354476, -0.544020309407214, -0.198800864227133, -0.235833794695982, 0.000000000000001,  -0.000000000000000, 0.191105097183259,
        0.359395824082184,  0.000000000000000,  -0.000000000000000, 0.035951497558342,  0.167636969620624,  0.000000000000000,  -0.000000000000000,
        -0.050860973930037, -0.203742810888531, -0.000000000000000, -0.000000000000000, 0.789844716262617,  0.819710257159021,  0.000000000000000,
        -0.000000000000000, -0.345948590109338, -0.405872109699018, 0.000000000000000,  -0.000000000000000, -0.147067404151137, -0.042338759847349,
        -0.000000000000000, -0.000000000000000, -0.572613239278810, -0.747536249875607, 0.000000000000000,  -0.000000000000000, -0.290541541128068,
        -0.397447044133148, -0.000000000000000, -0.000000000000000, -0.056873589259542, -0.095451298501705, -0.000000000000000, 0.000000000000000,
        0.117794366280722,  0.212538953328255,  0.000000000000000,  0.000000000000000,  0.070922683189823,  0.133815826140437,  0.000000000000000,
        -0.000000000000000, -0.081574971691496, -0.152135926637548, -0.000000000000000, -0.000000000000000, 0.169597782124570,  0.271124549277851,
        -0.000000000000000, -0.000000000000000, -0.095887700701326, -0.159788245392882, -0.000000000000000, -0.000000000000000, 0.020323972071509,
        0.048580183983533,  -0.000000000000000, -0.000000000000000, -0.196568918451005, -0.337732009080417, -0.000000000000000, -0.000000000000000,
        -0.108175744460941, -0.187420907105425, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.067803287554364,
        -0.040958502452086, -0.000000000000000, -0.000000000000000, -0.481589678040348, 0.008298824606038,  -0.000000000000000, -0.000000000000000,
        0.286507286862199,  0.977775674947351,  -0.000000000000000, -0.000000000000000, 0.386089456116698,  -0.230776765201728, 0.000000000000000,
        0.000000000000000,  -0.278303358651620, -1.047084569347944, 0.000000000000001,  0.000000000000000,  0.759810002626481,  1.162863547644465,
        0.000000000000000,  -0.000000000000000, -0.239884368622059, 0.468312307387523,  0.000000000000000,  0.000000000000000,  0.073130500311058,
        -0.087508539047789, 0.000000000000000,  -0.000000000000000, 0.277550519456497,  0.167732738071140,  -0.000000000000000, -0.000000000000000,
        -0.025280775574405, -0.027883919786171, -0.000000000000000, -0.000000000000000, -0.105442724636453, 0.105442854573790,  -0.000000000000000,
        -0.000000000000000, 0.308007902041756,  0.931253464995023,  -0.000000000000000, -0.000000000000000, 0.026435110990086,  -0.307975180561910,
        0.000000000000000,  -0.000000000000000, -0.325012900382582, -1.000693902741600, -0.000000000000000, 0.000000000000001,  0.460701685330259,
        1.021829826719789,  -0.000000000000000, -0.000000000000000, 0.064978463468020,  0.519545925006334,  0.000000000000000,  -0.000000000000000,
        -0.004895705858071, -0.104182714921599, -0.000000000000000, -0.000000000000000, 0.104187522220281,  0.113182710564531,  -0.083507582025919,
        -0.078298704573097, -0.000000000000000, -0.000000000000000, -0.639084505816030, -0.541260935327736, 0.000000000000000,  -0.000000000000000,
        0.016670232962551,  0.177687609419903,  -0.000000000000000, -0.000000000000000, 0.496815357615931,  0.298723083651917,  -0.000000000000000,
        -0.000000000000000, -0.062998764961315, -0.291813694417607, 0.000000000000000,  0.000000000000000,  0.532746623226637,  0.657777278412038,
        0.000000000000000,  -0.000000000000000, -0.477181494859527, -0.279660020322447, 0.000000000000000,  -0.000000000000000, 0.108105254811449,
        0.087592668203157,  -0.000000000000000, -0.000000000000000, 0.301670205116537,  0.292886303824221,  -0.000000000000000, -0.000000000000000,
        -0.014150033381119, -0.021519126344987, -0.000000000000000, -0.000000000000000, -0.079184176145153, -0.108307916245977, -0.000000000000000,
        -0.000000000000000, 0.082085798555261,  0.156927020481425,  -0.000000000000000, -0.000000000000000, 0.005783569168210,  -0.021503495343172,
        -0.000000000000000, -0.000000000000000, -0.121623903512624, -0.228634321413556, -0.000000000000000, 0.000000000000000,  0.165824363515427,
        0.281969947853307,  -0.000000000000000, -0.000000000000000, -0.001006829955663, 0.029845286801468,  0.000000000000000,  0.000000000000000,
        0.010500319096272,  0.012333336486421,  -0.000000000000000, 0.000000000000000,  0.055082851388458,  0.084966480892968,  0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.521549149408411,  0.736597919791066,  -0.000000000000000, -0.000000000000000,
        0.466447731069560,  0.950723090307712,  -0.000000000000000, -0.000000000000000, -1.396833745144968, -1.491973970066161, -0.000000000000000,
        -0.000000000000000, -0.497484570001026, -0.770731542374241, 0.000000000000000,  -0.000000000000000, -0.161632324958390, -0.531247655909954,
        -0.000000000000000, -0.000000000000000, -1.608401604921567, -2.072826364146680, -0.000000000000000, 0.000000000000000,  0.381311731028181,
        0.750744554352219,  -0.000000000000000, -0.000000000000000, 1.041389662433399,  1.274838341230543,  -0.000000000000000, 0.000000000000000,
        -0.063181864249590, -0.196557929961455, -0.000000000000000, -0.000000000000000, 0.301533668635068,  0.638062236799607,  -0.000000000000000,
        -0.000000000000000, 0.342980242799763,  0.865289386054903,  -0.000000000000000, -0.000000000000000, -0.687180548073486, -1.223147690774193,
        -0.000000000000000, -0.000000000000000, -0.305291092400495, -0.676517235607173, 0.000000000000001,  0.000000000000001,  -0.169497566133147,
        -0.503536396694072, 0.000000000000000,  -0.000000000000000, -0.880164618111269, -1.766858875826883, -0.000000000000000, -0.000000000000001,
        0.274034663970147,  0.680212793347403,  -0.000000000000000, 0.000000000000000,  0.553007046488680,  1.076092872504534,  0.000000000000000,
        0.000000000000001,  -0.063458838706670, -0.185636742382748, 0.461221403120725,  0.553290169912821,  0.000000000000000,  -0.000000000000000,
        0.374350166244150,  0.572997477970781,  -0.000000000000000, -0.000000000000000, -1.199650045371508, -1.173741694449795, -0.000000000000000,
        -0.000000000000000, -0.233939033427923, -0.202196185046962, 0.000000000000000,  -0.000000000000000, 0.078992684596033,  -0.032664665290858,
        0.000000000000000,  0.000000000000000,  -1.196083260964648, -1.312459426649313, -0.000000000000000, 0.000000000000000,  0.352988816621533,
        0.461179942212542,  0.000000000000000,  -0.000000000000000, 0.964048998726116,  1.051047997030838,  -0.000000000000000, -0.000000000000000,
        -0.025152871609759, -0.078417460319364, -0.000000000000000, -0.000000000000000, 0.134588267662055,  0.226373748226272,  -0.000000000000000,
        -0.000000000000000, 0.168295707383571,  0.296788148432670,  -0.000000000000000, -0.000000000000000, -0.223218017095693, -0.345811267008252,
        -0.000000000000000, -0.000000000000000, -0.030227201835657, -0.041713189755651, -0.000000000000000, -0.000000000000000, -0.037681389301556,
        -0.077489352397828, 0.000000000000002,  0.000000000000000,  -0.290479291917966, -0.474878244150073, 0.000000000000000,  -0.000000000000000,
        0.120658007886147,  0.206898622550616,  -0.000000000000000, -0.000000000000000, 0.230926225581022,  0.376643230818647,  -0.000000000000000,
        -0.000000000000000, -0.030349117550586, -0.056399423393117, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 12, 36));

    std::vector<double> intzvals{
        -0.000000000000000, -0.000000000000000, 0.037934188412352,  -0.000687183889856, -0.000000000000000, -0.000000000000000, -0.520747497186915,
        -1.015567742404858, 0.000000000000000,  -0.000000000000000, -0.532749350628726, -0.895004516466317, -0.000000000000000, -0.000000000000000,
        -0.478043437824476, -0.437363209088993, 0.000000000000000,  0.000000000000000,  -0.291976434300284, -0.332194876137545, -0.000000000000000,
        -0.000000000000000, 0.266154547173781,  0.261844640639204,  0.000000000000000,  -0.000000000000000, 0.209411350757850,  -0.109456988458276,
        -0.000000000000000, -0.000000000000000, 0.547450705659495,  0.736466762879718,  0.000000000000000,  -0.000000000000000, 0.364458589194474,
        0.583120407142675,  0.000000000000000,  0.000000000000000,  0.008138113588924,  -0.008099741311418, -0.000000000000000, -0.000000000000000,
        -0.371276428263358, -0.919951787120220, -0.000000000000000, -0.000000000000000, -0.341941686504291, -0.798483793463391, -0.000000000000000,
        -0.000000000000000, -0.214780093011716, -0.347709893519056, 0.000000000000000,  0.000000000000000,  -0.148954075636916, -0.275874474129563,
        -0.000000000000000, -0.000000000000000, 0.126354770200020,  0.208829666335839,  0.000000000000000,  0.000000000000000,  0.018389766147009,
        -0.151343525688194, -0.000000000000000, -0.000000000000000, 0.306351890258449,  0.634113484000725,  0.000000000000000,  0.000000000000000,
        0.227726373335749,  0.515129271599822,  0.069400585527552,  0.064223291838801,  -0.000000000000001, -0.000000000000000, -0.180427643446637,
        -0.318227791346977, -0.000000000000000, -0.000000000000000, -0.196410573797402, -0.256588544320011, 0.000000000000000,  -0.000000000000000,
        -0.604460428675697, -0.600898449493342, -0.000000000000000, -0.000000000000000, -0.500083004924190, -0.569937516437046, 0.000000000000000,
        0.000000000000000,  0.328223054989473,  0.392351583094039,  -0.000000000000000, -0.000000000000000, 0.477071026571632,  0.421774154262272,
        -0.000000000000000, -0.000000000000000, 0.422193862728346,  0.491041525447946,  -0.000000000000000, -0.000000000000000, 0.237662030110902,
        0.313160710358284,  -0.000000000000000, -0.000000000000000, 0.011401663372677,  0.017219207059530,  -0.000000000000000, -0.000000000000000,
        -0.101301940502419, -0.181753395551131, -0.000000000000000, -0.000000000000000, -0.069744643360173, -0.121281206066358, -0.000000000000000,
        -0.000000000000000, -0.119693909138548, -0.189269292808702, -0.000000000000000, -0.000000000000000, -0.131311093545653, -0.217317414833783,
        0.000000000000000,  0.000000000000000,  0.093628569285037,  0.156319221048526,  -0.000000000000000, -0.000000000000000, 0.068705893242214,
        0.099730392487887,  0.000000000000000,  0.000000000000000,  0.117057706553830,  0.196000647995033,  -0.000000000000000, -0.000000000000000,
        0.082916444120500,  0.142700518706403,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.161399514178546,
        0.112441103631447,  -0.000000000000000, -0.000000000000000, 0.514016926866602,  0.160983251845883,  -0.000000000000000, -0.000000000000000,
        0.099900148258416,  -0.234617651807323, 0.000000000000000,  -0.000000000000000, 0.120042318490118,  0.423914139350680,  -0.000000000000000,
        -0.000000000000000, 0.026391374058935,  0.088580288052802,  -0.000000000000000, -0.000000000000000, -0.262707428155013, -0.741475434896487,
        -0.000000000000000, -0.000000000000000, 0.243835739698063,  -0.429384071296637, -0.000000000000000, -0.000000000000000, 0.062076428703110,
        0.015181568595628,  -0.000000000000000, -0.000000000000000, -0.193749816482616, -0.140374308278998, -0.000000000000000, -0.000000000000000,
        0.063986885035227,  0.081371187938217,  -0.000000000000000, 0.000000000000000,  0.155392088042478,  0.058555267402518,  -0.000000000000000,
        -0.000000000000000, -0.033291357130233, -0.261907461329372, 0.000000000000000,  -0.000000000000000, 0.136590508222611,  0.398580493356505,
        -0.000000000000000, -0.000000000000000, 0.027545768334341,  0.084963514434865,  -0.000000000000001, -0.000000000000000, -0.242840221113665,
        -0.698358463302162, -0.000000000000000, -0.000000000000000, -0.055023394452769, -0.479998270543469, -0.000000000000000, 0.000000000000000,
        0.016053574254023,  0.005248015435511,  -0.000000000000000, -0.000000000000000, -0.078758409827308, -0.102235543863142, 0.129339654081495,
        0.115333812069665,  -0.000000000000000, -0.000000000000000, 0.423780243898062,  0.304561901374930,  -0.000000000000000, -0.000000000000000,
        0.065678968062702,  -0.061121749247387, -0.000000000000000, -0.000000000000000, 0.107383662558532,  0.233723432656001,  0.000000000000000,
        -0.000000000000000, 0.038857977900914,  0.074410036115921,  -0.000000000000000, -0.000000000000000, -0.264439561671891, -0.455212152185500,
        -0.000000000000000, -0.000000000000000, 0.168954805754659,  -0.082882269628555, -0.000000000000000, -0.000000000000000, 0.034908480994060,
        0.018581048345250,  -0.000000000000000, -0.000000000000000, -0.169865623897292, -0.156213923346063, -0.000000000000000, -0.000000000000000,
        0.019171068829913,  0.028112698496771,  -0.000000000000000, -0.000000000000000, 0.026387391976424,  0.021721545477919,  -0.000000000000000,
        -0.000000000000000, -0.051817633983946, -0.105562851037146, -0.000000000000000, -0.000000000000000, 0.077021750441310,  0.138243036275228,
        0.000000000000000,  0.000000000000000,  0.025356375669009,  0.046248279359781,  -0.000000000000000, -0.000000000000000, -0.145633662969466,
        -0.262063142728207, -0.000000000000000, -0.000000000000000, -0.084620529248553, -0.172474332277299, -0.000000000000000, -0.000000000000000,
        0.001198950114964,  0.000870415501960,  0.000000000000000,  -0.000000000000000, -0.026626965515743, -0.039333847565941, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.422056238500137, -0.626351574262571, -0.000000000000000, -0.000000000000000,
        -0.131596353128823, -0.447376332661886, -0.000000000000000, 0.000000000000000,  1.006391089143002,  1.078619613082733,  -0.000000000000000,
        -0.000000000000000, 0.251052558576809,  0.336505557509768,  -0.000000000000000, -0.000000000000000, 0.229329445577190,  0.413399236554521,
        -0.000000000000000, -0.000000000000000, 0.695480076909632,  0.734715777515287,  0.000000000000000,  -0.000000000000000, -0.390663986904798,
        -0.810341567036113, -0.000000000000000, -0.000000000000000, -1.027760705346539, -1.383422004335383, -0.000000000000000, -0.000000000000000,
        -0.146754628574191, -0.131714802166075, 0.000000000000000,  0.000000000000000,  -0.251680908775130, -0.546788589605606, -0.000000000000000,
        -0.000000000000000, -0.141709933800091, -0.424979661047065, -0.000000000000000, 0.000000000000000,  0.496822647383748,  0.883766903427153,
        -0.000000000000000, -0.000000000000000, 0.141759755173155,  0.287176746418664,  -0.000000000000001, -0.000000000000001, 0.154849300815399,
        0.371217677982433,  -0.000000000000000, -0.000000000000000, 0.340576008917475,  0.600080263941848,  0.000000000000000,  0.000000000000000,
        -0.291363808748345, -0.738056781443404, -0.000000000000000, -0.000000000000000, -0.577561252799824, -1.187922292983022, -0.000000000000000,
        -0.000000000000001, -0.065933658862360, -0.103205950505330, -0.299868657524792, -0.371481853880578, -0.000000000000000, 0.000000000000000,
        -0.005617794136934, -0.118768054933975, -0.000000000000000, -0.000000000000000, 0.867516190596947,  0.853084506722593,  -0.000000000000000,
        0.000000000000000,  0.339414769129735,  0.352866924591768,  -0.000000000000000, -0.000000000000000, 0.494972777538927,  0.658631389259802,
        -0.000000000000000, 0.000000000000000,  0.890136964096741,  0.948992622864928,  -0.000000000000000, -0.000000000000000, -0.057625719428009,
        -0.147109302662531, -0.000000000000001, -0.000000000000000, -0.712054920478685, -0.806514737861586, -0.000000000000000, -0.000000000000000,
        -0.111988050158904, -0.100028444591914, 0.000000000000000,  0.000000000000000,  -0.093007867649233, -0.157671659188520, 0.000000000000000,
        -0.000000000000000, -0.055065030764008, -0.105044823921200, -0.000000000000000, -0.000000000000000, 0.162430310748890,  0.251545322184008,
        -0.000000000000000, -0.000000000000000, 0.071733813743361,  0.113672472372994,  -0.000000000000000, -0.000000000000000, 0.175635305743690,
        0.302790867260376,  -0.000000000000001, -0.000000000000000, 0.202337642266242,  0.326642322527151,  -0.000000000000000, -0.000000000000000,
        -0.053232871860416, -0.097663812801258, -0.000000000000000, -0.000000000000000, -0.184448359950530, -0.304543565763325, -0.000000000000000,
        -0.000000000000000, -0.016249667786531, -0.023481042545942, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 12, 36));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeDSForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix amomxmat(20, 4);

    CDenseMatrix amomymat(20, 4);

    CDenseMatrix amomzmat(20, 4);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  0.346013965178969,  0.187944989034211,  0.000000000000000,  0.000000000000000,  0.444669858076491,
        0.276660814890571,  -0.411952396827558, -0.332868387812593, 0.000000000000000,  0.000000000000000,  -0.675386512880428, -0.629265698757862,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.650192968636667,  0.334713127173424,  0.000000000000000,
        0.000000000000000,  0.814250895637435,  0.488104270957426,  -0.782639367123680, -0.619968912352689, -0.000000000000000, 0.000000000000000,
        -1.238495259926459, -1.146095735887740, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.706380372031158,
        -0.475365253038457, 0.000000000000000,  0.000000000000000,  -1.013735118866077, -0.722624684837850, 0.903669408506440,  0.795643950131443,
        -0.000000000000000, 0.000000000000000,  1.716639085269846,  1.640638447148975,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.066388783143402, -0.078971715758726, 0.000000000000000,  0.000000000000000,  -0.134908638949957, -0.126954380697062,
        0.120328249529738,  0.128289174340101,  -0.000000000000000, -0.000000000000000, 0.308835519289342,  0.307308558184870,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.439538844993449, -0.256832203326365, 0.000000000000000,  0.000000000000000,
        -0.585763353071593, -0.382577337902563, 0.551062366509595,  0.458732578564851,  -0.000000000000001, 0.000000000000000,  0.951796835069455,
        0.895277721486854,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 20, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.390626781747293, -0.241395107803319, 0.000000000000000,  0.000000000000000,  -0.535768624429659,
        -0.362630332097460, 0.509913918059293,  0.433766422777750,  -0.000000000000001, 0.000000000000000,  0.914084260145648,  0.865357212779199,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.179588609053525,  0.093977615902708,  0.000000000000000,
        0.000000000000000,  0.226667584228958,  0.137447336875789,  -0.217549199540426, -0.173455925221418, 0.000000000000000,  0.000000000000000,
        -0.348299918137535, -0.323047992452959, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.472730094286367,
        0.273616025893953,  0.000000000000000,  0.000000000000000,  0.626979643740700,  0.406973105343416,  -0.608179203132772, -0.504650366134764,
        0.000000000000000,  0.000000000000000,  -1.044597694188758, -0.981593937943259, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.630050403982753, -0.390518956876373, 0.000000000000000,  0.000000000000000,  -0.865502131243066, -0.586904284085827,
        0.818098941724669,  0.696765390381895,  0.000000000000000,  0.000000000000000,  1.469548593435449,  1.391693244863072,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.280288380191946, -0.167201391925117, 0.000000000000000,  0.000000000000000,
        -0.377489441463892, -0.249857025839963, 0.356659169222464,  0.299320115973676,  -0.000000000000000, -0.000000000000000, 0.624710240326562,
        0.589060015181951,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 20, 4));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.178562692283595,  0.118519030265326,  0.000000000000000,  0.000000000000000,  0.254354820713488,
        0.179834724211633,  -0.202625146430343, -0.178221485914303, 0.000000000000000,  -0.000000000000000, -0.384260669136956, -0.367149575600179,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.337652544135229, -0.174945546614656, 0.000000000000000,
        0.000000000000000,  -0.424150081738423, -0.255415175895031, 0.405912588734844,  0.322293587598509,  0.000000000000000,  0.000000000000000,
        0.645031698733843,  0.597397240264553,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.125259951990641,
        -0.051496465488663, 0.000000000000000,  0.000000000000000,  -0.141858121009123, -0.071677650830565, 0.104229665919701,  0.071218927379361,
        -0.000000000000000, -0.000000000000000, 0.124185434369223,  0.107516476245847,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.485212544979945,  0.312689246885346,  0.000000000000000,  0.000000000000000,  0.680341140584351,  0.472546645335998,
        -0.585508710993025, -0.507273318367964, 0.000000000000000,  0.000000000000000,  -1.082644235386747, -1.030231682637005, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.345330020665681,  0.204305931942622,  0.000000000000000,  0.000000000000000,
        0.463128015732844,  0.304919073114467,  -0.421460234984841, -0.352457603504068, 0.000000000000000,  0.000000000000000,  -0.733739105240860,
        -0.691132583950252, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 20, 4));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeDPForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix amomxmat(20, 12);

    CDenseMatrix amomymat(20, 12);

    CDenseMatrix amomzmat(20, 12);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.558876593189870, -0.291396438503444, 0.000000000000000,  0.000000000000000,  -0.380097859916213,
        -0.224884998034159, 4.299018588390974,  2.934470722902404,  0.367914483477564,  0.431736574033400,  0.000000000000000,  0.000000000000000,
        -0.555660128607940, -0.373303644535167, 0.000000000000000,  0.000000000000000,  -0.389040057741943, -0.304568777392899, 3.755097527292911,
        3.286335345030996,  0.534249160364474,  0.654513067356538,  -0.510052836548960, -0.394449776744316, 0.000000000000000,  0.000000000000000,
        -0.460386939494906, -0.320364977896085, -0.000000000000000, -0.000000000000000, 0.477859490383632,  0.566970041672542,  2.974202599328418,
        1.029516152627371,  -0.450430508027105, -0.457201724116235, 0.000000000000000,  0.000000000000000,  -0.312000613047525, -0.285388034803283,
        -0.000000000000000, 0.000000000000000,  0.990447835904842,  1.215511576368733,  1.769444151220627,  1.699411662899841,  -2.866012392260649,
        -1.956313815268270, -1.475727290665789, -0.859360962060433, 4.299018588390974,  2.934470722902404,  -0.035325016742854, 0.156068133446100,
        0.000000000000000,  0.000000000000000,  -0.357844341971861, -0.166749724194721, -2.503398351528607, -2.190890230020664, -1.526822246456110,
        -1.141344466733845, 3.755097527292911,  3.286335345030997,  0.110915252977131,  0.257703250499289,  0.000000000000000,  0.000000000000000,
        -0.335513961425315, -0.209555391354006, -1.621619920667511, -1.412645218856654, -2.191517704768308, -0.758590849304379, 0.052237141576598,
        0.348722852245330,  2.974202599328418,  1.029516152627371,  -0.479263383032632, -0.358978688685182, -0.000000000000000, 0.000000000000000,
        -1.899561145353391, -2.105874537265660, -1.303800953530988, -1.252198067399883, 0.900341043326778,  1.214621040421939,  1.769444151220627,
        1.699411662899841,  -0.399832910727535, -0.401755192067967, 0.000000000000000,  0.000000000000000,  -2.482039539258736, -1.694217461796779,
        -0.258587761688884, -0.084670560408818, -3.309386052344980, -2.258956615729039, 1.543642101844257,  0.774735751733108,  0.000000000000000,
        0.000000000000000,  0.337597230203321,  0.211384705275894,  -2.168006568215861, -1.897366596101028, -0.212826998527680, -0.093425542079658,
        -2.890675424287815, -2.529822128134704, 1.555314391083978,  0.951406975300998,  0.000000000000000,  0.000000000000000,  0.371804690099662,
        0.278051537959113,  -0.323075525681844, -0.404924371391680, -1.717156671346748, -0.594391427854482, 1.532694517167169,  1.122934031728415,
        -2.530546673563627, -0.875945262101340, 0.509900640376408,  0.427252981970255,  -0.000000000000000, 0.000000000000000,  -0.768881387704801,
        -0.975872059254605, -1.021589057023238, -0.981155781039213, 1.075923551940383,  0.945443508943988,  -1.505499662981615, -1.445913782584103,
        0.516384061128068,  0.535689667398840,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.501955305547508,
        -0.200303936980241, 0.000000000000000,  0.000000000000000,  0.602776616552922,  0.388075954438520,  -2.866012392260649, -1.956313815268270,
        -0.075058606816277, -0.181600293974772, 0.000000000000000,  0.000000000000000,  -0.452452688945043, -0.233018354654564, 0.000000000000000,
        0.000000000000000,  0.674741571082021,  0.512286159186172,  -2.503398351528607, -2.190890230020664, -0.163676194452714, -0.300343585546260,
        -0.346591536592109, -0.276515860995470, 0.000000000000000,  0.000000000000000,  0.545904390235721,  0.479991865777972,  0.000000000000000,
        0.000000000000000,  -0.146452980925238, -0.218723200067117, -2.191517704768308, -0.758590849304379, -0.346049992935380, -0.373019048097960,
        0.000000000000000,  0.000000000000000,  0.598156022437867,  0.627419846148159,  0.000000000000000,  0.000000000000000,  -0.455807558443999,
        -0.593607931797707, -1.303800953530989, -1.252198067399883, -4.299018588390975, -2.934470722902404, -0.050620614893620, -0.252709270401290,
        0.000000000000000,  0.000000000000000,  0.701963334739314,  0.442986879076064,  0.000000000000000,  0.000000000000000,  0.318563400881526,
        0.170954964231797,  -3.755097527292912, -3.286335345030997, -0.204887294095409, -0.422377477657837, -0.000000000000000, 0.000000000000000,
        0.752371396949996,  0.599783033932462,  0.000000000000000,  0.000000000000000,  0.321695241869661,  0.220003611526341,  -0.140030303234717,
        -0.293806291235454, -2.974202599328418, -1.029516152627371, 0.739238768110802,  0.545334799264601,  0.000000000000000,  0.000000000000000,
        0.408128990571764,  0.322442512172765,  0.000000000000000,  0.000000000000000,  -0.668213448344149, -0.884259517724209, -1.769444151220628,
        -1.699411662899841, 0.565489142297451,  0.536557866012657,  0.000000000000000,  0.000000000000000,  0.374103199693884,  0.382116740569098,
        0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 20, 12));

    std::vector<double> intyvals{
        -4.299018588390974, -2.934470722902404, -0.101567012748200, -0.269707221928669, 0.000000000000000,  0.000000000000000,  0.606930581010622,
        0.410925051406997,  0.000000000000000,  0.000000000000000,  0.594493758084355,  0.330417138299249,  -3.755097527292911, -3.286335345030996,
        -0.245762053750412, -0.442192298625010, 0.000000000000000,  0.000000000000000,  0.675763113819387,  0.562294329322652,  0.000000000000000,
        0.000000000000000,  0.611977917088951,  0.427484969847204,  -0.138041837865464, -0.283519680066745, -2.974202599328418, -1.029516152627371,
        0.667555873229949,  0.504011424633944,  0.000000000000000,  0.000000000000000,  0.541390792485272,  0.434708062921692,  -0.000000000000000,
        0.000000000000000,  -0.648894349757392, -0.861582432387719, -1.769444151220627, -1.699411662899841, 0.530516397310046,  0.506007646260939,
        0.000000000000000,  0.000000000000000,  0.510271139280430,  0.523560024417352,  0.000000000000000,  0.000000000000000,  1.433006196130324,
        0.978156907634135,  0.044757570007081,  0.104900064982974,  0.000000000000000,  0.000000000000000,  -0.565168670609831, -0.290535928475425,
        0.000000000000000,  0.000000000000000,  0.730999873626977,  0.341692464546722,  1.251699175764303,  1.095445115010332,  0.103628129797261,
        0.167603612972608,  0.000000000000000,  0.000000000000000,  -0.557682558324797, -0.371352269369576, 0.000000000000000,  0.000000000000000,
        0.710718005152383,  0.413153513095343,  0.056902702679890,  0.113262941814310,  0.939221873472132,  0.325110363987591,  -0.516031691587574,
        -0.395828823039832, -0.000000000000000, 0.000000000000000,  0.550350400632783,  0.480970645216718,  -0.000000000000000, 0.000000000000000,
        0.246662422017405,  0.321638822679586,  0.558771837227566,  0.536656314599950,  -0.449196795757830, -0.454811787390017, 0.000000000000000,
        0.000000000000000,  0.631572307896711,  0.688667096050492,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.404786737420279, -0.213596625360265, 1.654693026172490,  1.129478307864519,  -0.810203434037384, -0.376156355654986, 2.482039539258736,
        1.694217461796779,  0.495125782047012,  0.259349868082483,  0.000000000000000,  0.000000000000000,  -0.405055865739040, -0.274156627552415,
        1.445337712143907,  1.264911064067352,  -0.776898004641900, -0.459701360907280, 2.168006568215861,  1.897366596101028,  0.500496789851146,
        0.327731763983383,  -0.573094450041449, -0.450408393782822, 0.000000000000000,  0.000000000000000,  -0.824701527177400, -0.563693289377225,
        1.084520002955840,  0.375405112329146,  0.705863519552157,  0.745531581825181,  1.717156671346748,  0.594391427854482,  -0.520567450133967,
        -0.530919395853708, 0.000000000000000,  0.000000000000000,  -0.500057102409351, -0.416492014368196, 0.645214141277835,  0.619677335393187,
        1.196412512640925,  1.425460296450393,  1.021589057023238,  0.981155781039213,  0.000000000000000,  0.000000000000000,  0.514833428263505,
        0.291361145368443,  -4.299018588390974, -2.934470722902404, 0.562710827832350,  0.232355179228063,  1.433006196130324,  0.978156907634135,
        1.089288606960709,  0.628360191412463,  0.000000000000000,  0.000000000000000,  0.535309913872790,  0.377959068144506,  -3.755097527292911,
        -3.286335345030997, 0.529408731429369,  0.263157808700251,  1.251699175764303,  1.095445115010332,  1.136689751727059,  0.822866101315360,
        0.749358170293568,  0.604664886751286,  0.000000000000000,  0.000000000000000,  0.422598316051934,  0.107379064395073,  -2.974202599328418,
        -1.029516152627371, 1.211948549641857,  1.054613738128205,  0.939221873472132,  0.325110363987591,  0.712246684584943,  0.731771312005503,
        0.000000000000000,  0.000000000000000,  -0.302571540175198, -0.576699129459711, -1.769444151220627, -1.699411662899841, 1.386191407391484,
        1.513955494087815,  0.558771837227567,  0.536656314599950,  0.000000000000000,  0.000000000000000,  0.200196979597631,  0.108604480096094,
        0.000000000000000,  0.000000000000000,  0.562496097573578,  0.352708423423164,  -4.299018588390975, -2.934470722902404, -0.414573355094351,
        -0.447525728444722, 0.000000000000000,  0.000000000000000,  0.203361291974649,  0.139997229737112,  -0.000000000000000, 0.000000000000000,
        0.603839095244868,  0.475029761143693,  -3.755097527292912, -3.286335345030997, -0.571910647407353, -0.672989802495877, 0.300139358796242,
        0.238431405882455,  0.000000000000000,  0.000000000000000,  0.542968034469407,  0.407769327447705,  -0.000000000000000, -0.000000000000000,
        -0.471899435592658, -0.554416445005753, -2.974202599328418, -1.029516152627371, 0.277738761961131,  0.284129334794141,  0.000000000000000,
        0.000000000000000,  0.432184831412288,  0.415632757991542,  0.000000000000000,  0.000000000000000,  -0.969236312111897, -1.191195677277121,
        -1.769444151220628, -1.699411662899841};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 20, 12));

    std::vector<double> intzvals{
        2.866012392260649,  1.956313815268270,  0.118436267076581,  0.148705283452710,  0.000000000000000,  0.000000000000000,  -0.266347470729364,
        -0.162029352104730, -1.433006196130324, -0.978156907634135, -0.436794889343239, -0.269208974886060, 2.503398351528607,  2.190890230020664,
        0.174308062786432,  0.230325456926048,  0.000000000000000,  0.000000000000000,  -0.288487106614062, -0.212320768731529, -1.251699175764303,
        -1.095445115010332, -0.468586161204697, -0.358879265156373, 0.383072064445402,  0.452487298094656,  2.191517704768308,  0.758590849304379,
        -0.339817652518168, -0.283450361605797, 0.000000000000000,  0.000000000000000,  -0.617538661899427, -0.580084013997161, -0.939221873472132,
        -0.325110363987591, 0.801123373009106,  0.990108677263317,  1.303800953530988,  1.252198067399883,  -0.341553486147450, -0.353929143981013,
        0.000000000000000,  0.000000000000000,  -0.831469035609070, -0.945689996108885, -0.558771837227567, -0.536656314599950, 0.000000000000000,
        0.000000000000000,  0.493953921128072,  0.249382450011056,  -1.433006196130324, -0.978156907634135, 0.313086771964780,  0.061849659211748,
        0.000000000000000,  0.000000000000000,  -0.205150296382395, -0.002157349046276, 0.000000000000000,  0.000000000000000,  0.482765717505928,
        0.317806534825760,  -1.251699175764303, -1.095445115010332, 0.231885831628054,  0.041951778381398,  0.000000000000000,  0.000000000000000,
        -0.141290341743335, 0.048966042875428,  0.451267971790708,  0.342592154533400,  0.000000000000000,  0.000000000000000,  0.422360680352742,
        0.245715746870872,  -0.939221873472132, -0.325110363987591, -0.391727872246915, -0.389638066275812, 0.000000000000000,  0.000000000000000,
        0.385676843008198,  0.389231923622582,  0.000000000000000,  0.000000000000000,  0.153170488710130,  0.080116369388381,  -0.558771837227566,
        -0.536656314599950, -0.583092304767478, -0.673938826458893, 0.000000000000000,  0.000000000000000,  0.827346513086245,  0.564739153932260,
        0.540546848486443,  0.345131383455670,  0.000000000000000,  0.000000000000000,  0.067189507216959,  0.002211920084371,  -1.654693026172490,
        -1.129478307864520, -0.712161872123198, -0.537576393920369, 0.722668856071954,  0.632455532033676,  0.578800896427782,  0.470991772685372,
        0.000000000000000,  0.000000000000000,  0.033251175639378,  -0.003894910406697, -1.445337712143907, -1.264911064067352, -0.831350577494216,
        -0.754512816374001, 0.345731321928567,  0.281686836771746,  0.542260001477920,  0.187702556164573,  0.063193809665041,  0.023155411812567,
        0.000000000000000,  0.000000000000000,  -0.425368478315038, -0.397331971190480, -1.265273336781814, -0.437972631050670, 0.353931478610066,
        0.380547426919646,  0.322607070638917,  0.309838667696594,  0.004183389005898,  -0.004770271545132, 0.000000000000000,  0.000000000000000,
        -0.559281308180990, -0.629639705536686, -0.752749831490807, -0.722956891292052, 0.000000000000000,  0.000000000000000,  -0.435192250765744,
        -0.381229846508745, 2.866012392260649,  1.956313815268270,  -0.439774821447228, -0.109760851393672, 0.000000000000000,  0.000000000000000,
        -0.801921093484831, -0.452124817874071, 0.000000000000000,  0.000000000000000,  -0.545984639849490, -0.550268747558130, 2.503398351528607,
        2.190890230020664,  -0.371633719420077, -0.077615482598246, 0.000000000000000,  0.000000000000000,  -0.832069194257976, -0.586181949028294,
        -0.189846774568201, -0.098919014390669, 0.000000000000000,  0.000000000000000,  -0.602905189368329, -0.385941686684169, 2.191517704768308,
        0.758590849304379,  -0.729923147214376, -0.591130939468772, 0.000000000000000,  0.000000000000000,  -0.008381292810140, 0.059970909884021,
        0.000000000000000,  0.000000000000000,  -0.256439126140944, -0.138163380207796, 1.303800953530989,  1.252198067399883,  -0.698086980980353,
        -0.717923335774729, 0.000000000000000,  0.000000000000000,  1.433006196130325,  0.978156907634135,  -0.226817177091792, -0.098609236332806,
        0.000000000000000,  0.000000000000000,  -0.518760380479157, -0.279559444327891, 2.866012392260650,  1.956313815268270,  0.055504275356647,
        0.124639951873227,  1.251699175764304,  1.095445115010332,  -0.213505648986071, -0.116799095923312, 0.000000000000000,  0.000000000000000,
        -0.525056533844311, -0.360000841263453, 2.503398351528608,  2.190890230020664,  0.120680332566226,  0.201288994462054,  -0.068868768924288,
        0.030061370620095,  0.939221873472132,  0.325110363987591,  -0.708268349368006, -0.560873918055220, 0.000000000000000,  0.000000000000000,
        0.309092099535651,  0.401718004358735,  2.191517704768308,  0.758590849304379,  0.186777532525244,  0.284578870511692,  0.558771837227567,
        0.536656314599950,  -0.651841961655015, -0.666246075363240, 0.000000000000000,  0.000000000000000,  0.748725772583759,  0.939182539822924,
        1.303800953530989,  1.252198067399883};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 20, 12));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeDDForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix amomxmat(20, 20);

    CDenseMatrix amomymat(20, 20);

    CDenseMatrix amomzmat(20, 20);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  -0.000000000000000, -0.588040803084350, -0.668378109416148, -0.000000000000000, -0.000000000000000, 0.996865124311525,
        0.618033877933849,  -0.000000000000000, -0.000000000000000, 0.372873492383314,  0.402489431682797,  -1.000000000000000, -0.892931005151188,
        -0.400431263703079, -0.516104734303318, -0.000000000000000, -0.000000000000000, -0.224426884126286, -0.042637324094467, 0.000000000000000,
        0.000000000000000,  -0.670891612145987, -0.883146800303937, 0.000000000000000,  -0.000000000000000, 0.819691857526050,  0.738198391895139,
        0.000000000000000,  -0.000000000000000, 0.405118415080213,  0.533760804800920,  -0.892931005151188, -1.000000000000000, -0.470438160461457,
        -0.720536606498846, 0.000000000000000,  -0.000000000000000, -0.127726417259515, -0.022022491759124, 0.588040803084350,  0.670891612145987,
        0.000000000000001,  -0.000000000000000, -0.828321073606744, -0.630334594436051, 0.000000000000000,  0.000000000000000,  -0.405381728908605,
        -0.341592853447890, -0.000000000000000, 0.000000000000000,  0.523559280152284,  0.544572857869736,  -1.000000000000000, -0.605807395054961,
        0.424382555602105,  0.354610248799561,  0.000000000000001,  0.000000000000000,  0.668378109416148,  0.883146800303937,  0.000000000000000,
        0.000000000000000,  -0.430141609384103, -0.490007772165144, 0.000000000000000,  -0.000000000000000, -0.270353868184033, -0.330755302137297,
        -0.000000000000000, -0.000000000000000, 0.459007717771036,  0.551265484111499,  -0.605807395054961, -1.000000000000000, 0.269310182324952,
        0.322075326582387,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, 0.828321073606744,  0.430141609384103,
        0.000000000000000,  -0.000000000000000, 1.736444922069355,  0.963125827691782,  -1.732050807568879, -1.546601868575405, -0.661807308121725,
        -0.429983834005019, -0.000000000000000, -0.000000000000000, 0.027694505285450,  -0.077169377199631, -1.000000000000001, -0.892931005151188,
        -0.019942824424816, 0.214714978143047,  0.000000000000000,  0.000000000000000,  0.630334594436051,  0.490007772165144,  0.000000000000000,
        0.000000000000000,  1.353190936826306,  1.122120207856482,  -1.546601868575405, -1.732050807568879, -0.532624112717718, -0.556841488218744,
        0.000000000000000,  -0.000000000000000, -0.046241476969608, -0.110638461338701, -0.892931005151188, -1.000000000000000, 0.147022678017419,
        0.291009319510113,  -0.996865124311525, -0.819691857526050, -0.000000000000000, -0.000000000000000, -1.736444922069355, -1.353190936826306,
        0.000000000000001,  -0.000000000000000, 1.176163401276304,  1.117937478613362,  -1.732050807568877, -1.049289187836143, 0.024491880452858,
        0.199901467022777,  0.000000000000000,  0.000000000000000,  0.201412073036159,  0.005717871604249,  -1.000000000000000, -0.605807395054961,
        -0.618033877933849, -0.738198391895139, -0.000000000000000, 0.000000000000000,  -0.963125827691782, -1.122120207856482, 0.000000000000000,
        0.000000000000000,  0.866401207459908,  1.004513103722458,  -1.049289187836143, -1.732050807568879, 0.295275505780206,  0.425776219302074,
        0.000000000000000,  -0.000000000000000, -0.184793870993702, -0.341620691114353, -0.605807395054961, -1.000000000000000, 0.000000000000000,
        -0.000000000000000, 0.405381728908605,  0.270353868184033,  1.732050807568879,  1.546601868575405,  -1.176163401276304, -0.866401207459908,
        0.000000000000000,  -0.000000000000000, -1.175583389133468, 0.018223281802345,  -0.000000000000000, -0.000000000000000, -0.943163464103675,
        -0.494035067226010, -0.000000000000000, -0.000000000000000, -0.872304692347897, -0.557224501050289, 0.000000000000000,  0.000000000000000,
        0.341592853447890,  0.330755302137297,  1.546601868575405,  1.732050807568879,  -1.117937478613362, -1.004513103722458, 0.000000000000000,
        0.000000000000000,  -0.544840062869144, 0.258612099137920,  0.000000000000000,  -0.000000000000000, -0.739362043878736, -0.550402591873623,
        0.000000000000000,  -0.000000000000000, -0.730818373775483, -0.667659503041275, -0.372873492383314, -0.405118415080213, 0.000000000000000,
        0.000000000000000,  0.661807308121725,  0.532624112717718,  1.732050807568877,  1.049289187836143,  1.175583389133468,  0.544840062869144,
        0.000000000000001,  -0.000000000000000, 0.978886543499516,  0.706264754522623,  -0.000000000000000, -0.000000000000000, 1.027631526232525,
        0.979878282668950,  0.000000000000000,  -0.000000000000000, -0.402489431682797, -0.533760804800920, -0.000000000000000, 0.000000000000000,
        0.429983834005019,  0.556841488218744,  1.049289187836143,  1.732050807568879,  -0.018223281802345, -0.258612099137920, 0.000000000000000,
        0.000000000000000,  0.410613990384452,  0.419374646529395,  -0.000000000000000, -0.000000000000000, 0.855849262381251,  1.083329896560785,
        0.000000000000000,  -0.000000000000000, 1.000000000000000,  0.892931005151188,  -0.523559280152284, -0.459007717771036, 0.000000000000000,
        -0.000000000000000, -0.024491880452858, -0.295275505780206, 0.000000000000000,  -0.000000000000000, -0.978886543499516, -0.410613990384452,
        0.000000000000000,  -0.000000000000000, 0.642929351570089,  0.890443986435058,  -0.000000000000000, -0.000000000000000, -0.400283772021957,
        -0.073646330723357, 0.892931005151188,  1.000000000000000,  -0.544572857869736, -0.551265484111499, 0.000000000000000,  0.000000000000000,
        -0.199901467022777, -0.425776219302074, 0.000000000000000,  0.000000000000000,  -0.706264754522623, -0.419374646529395, 0.000000000000000,
        0.000000000000000,  0.816769306143680,  1.211946063073167,  0.000000000000000,  -0.000000000000000, -0.226329884401678, -0.035741045001584,
        0.400431263703079,  0.470438160461457,  1.000000000000000,  0.605807395054961,  -0.027694505285450, 0.046241476969608,  -0.000000000000000,
        -0.000000000000000, 0.943163464103675,  0.739362043878736,  0.000000000000000,  0.000000000000000,  -0.642929351570089, -0.816769306143680,
        0.000000000000001,  -0.000000000000000, 0.260354873106717,  0.141689159812948,  -0.000000000000000, -0.000000000000000, 0.516104734303318,
        0.720536606498846,  0.605807395054961,  1.000000000000000,  0.077169377199631,  0.110638461338701,  -0.000000000000000, 0.000000000000000,
        0.494035067226010,  0.550402591873623,  0.000000000000000,  0.000000000000000,  -0.890443986435058, -1.211946063073167, 0.000000000000000,
        0.000000000000000,  0.039781681853037,  0.011655035491922,  -0.000000000000000, -0.000000000000000, 0.000000000000000,  -0.000000000000000,
        -0.424382555602105, -0.269310182324952, 1.000000000000001,  0.892931005151188,  -0.201412073036159, 0.184793870993702,  0.000000000000000,
        -0.000000000000000, -1.027631526232525, -0.855849262381251, 0.000000000000000,  -0.000000000000000, -0.260354873106717, -0.039781681853037,
        0.000000000000000,  -0.000000000000000, -0.738636386095984, -0.735241930027361, 0.000000000000000,  0.000000000000000,  -0.354610248799561,
        -0.322075326582387, 0.892931005151188,  1.000000000000000,  -0.005717871604249, 0.341620691114353,  0.000000000000000,  0.000000000000000,
        -0.979878282668950, -1.083329896560785, 0.000000000000000,  0.000000000000000,  -0.141689159812948, -0.011655035491922, 0.000000000000000,
        0.000000000000000,  -0.777901918220402, -0.955957759833841, 0.224426884126286,  0.127726417259515,  -0.000000000000001, -0.000000000000000,
        0.019942824424816,  -0.147022678017419, 1.000000000000000,  0.605807395054961,  0.872304692347897,  0.730818373775483,  -0.000000000000000,
        -0.000000000000000, 0.400283772021957,  0.226329884401678,  0.000000000000000,  0.000000000000000,  0.738636386095984,  0.777901918220402,
        0.000000000000001,  -0.000000000000000, 0.042637324094467,  0.022022491759124,  -0.000000000000000, 0.000000000000000,  -0.214714978143047,
        -0.291009319510113, 0.605807395054961,  1.000000000000000,  0.557224501050289,  0.667659503041275,  0.000000000000000,  0.000000000000000,
        0.073646330723357,  0.035741045001584,  0.000000000000000,  0.000000000000000,  0.735241930027361,  0.955957759833841,  0.000000000000000,
        0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 20, 20));

    std::vector<double> intyvals{
        0.000000000000000,  -0.000000000000000, 0.140666608562486,  0.367329713443280,  1.000000000000000,  0.892931005151188,  0.148740751119229,
        0.457654931237591,  -0.000000000000000, -0.000000000000000, -0.844854190931255, -0.779255295948328, -0.000000000000000, -0.000000000000000,
        -1.117170396328322, -0.676167582932301, -0.000000000000000, -0.000000000000000, 0.085688756778697,  0.139288997470620,  0.000000000000000,
        0.000000000000000,  0.282472181057874,  0.521276199790079,  0.892931005151188,  1.000000000000000,  0.313079383247506,  0.685663056779726,
        0.000000000000000,  -0.000000000000000, -0.854067381671992, -1.000764152649477, 0.000000000000000,  -0.000000000000000, -0.918077801664235,
        -0.796058472163944, 0.000000000000000,  -0.000000000000000, 0.122546264490761,  0.191190554616478,  -0.140666608562486, -0.282472181057874,
        -0.000000000000000, 0.000000000000000,  -0.168994562530536, -0.327027469288805, 1.000000000000000,  0.605807395054961,  0.736624862124912,
        0.640493218881213,  0.000000000000000,  -0.000000000000000, 0.915666639884018,  0.703886956677531,  -0.000000000000000, -0.000000000000000,
        0.214244750435031,  0.217779482819310,  0.000000000000001,  -0.000000000000000, -0.367329713443280, -0.521276199790079, -0.000000000000000,
        0.000000000000000,  -0.379094755286314, -0.503800386977908, 0.605807395054961,  1.000000000000000,  0.503804707559554,  0.610746560558600,
        0.000000000000000,  -0.000000000000000, 0.472057599247502,  0.529915547209356,  0.000000000000000,  -0.000000000000000, 0.200720289875108,
        0.258888697618417,  0.000000000000000,  -0.000000000000000, -1.000000000000000, -0.892931005151188, 0.168994562530536,  0.379094755286314,
        0.000000000000000,  -0.000000000000000, -0.130689183503219, -0.322853142138074, -0.000000000000000, -0.000000000000000, 0.857722854489709,
        0.317383138248699,  -0.000000000000000, -0.000000000000000, -0.398474155952090, 0.151511105489922,  -0.000000000000000, -0.000000000000000,
        -0.343557372630766, -0.079070649872626, -0.892931005151188, -1.000000000000000, 0.327027469288805,  0.503800386977908,  0.000000000000000,
        0.000000000000000,  -0.257030302102791, -0.452827849899809, 0.000000000000000,  -0.000000000000000, 0.579966855123940,  0.314223496772178,
        0.000000000000000,  -0.000000000000000, -0.096990551872933, 0.303236277214729,  0.000000000000000,  -0.000000000000000, -0.204643502203439,
        -0.053608575451505, -0.148740751119229, -0.313079383247506, -1.000000000000000, -0.605807395054961, 0.130689183503219,  0.257030302102791,
        -0.000000000000000, 0.000000000000000,  -0.821999775093868, -0.613064144480053, -0.000000000000000, -0.000000000000000, 0.476753734559551,
        0.327480536952687,  0.000000000000001,  -0.000000000000000, 0.236588179455050,  0.144836359511414,  -0.000000000000000, -0.000000000000000,
        -0.457654931237591, -0.685663056779726, -0.605807395054961, -1.000000000000000, 0.322853142138074,  0.452827849899809,  -0.000000000000000,
        0.000000000000000,  -0.400804215090257, -0.445251442116406, 0.000000000000000,  -0.000000000000000, 0.175648087380941,  0.169470359730330,
        0.000000000000000,  -0.000000000000000, 0.061423716137360,  0.047474871166436,  0.000000000000000,  -0.000000000000000, 0.000000000000000,
        -0.000000000000000, -0.736624862124912, -0.503804707559554, 0.000000000000000,  -0.000000000000000, 0.821999775093868,  0.400804215090257,
        0.000000000000000,  -0.000000000000000, 0.611191027858889,  0.057027039556284,  -1.732050807568879, -1.546601868575405, 0.309418055183370,
        0.392551416681064,  -0.000000000000000, -0.000000000000000, -0.748166432068588, -0.456946955810599, 0.000000000000000,  0.000000000000000,
        -0.640493218881213, -0.610746560558600, 0.000000000000000,  0.000000000000000,  0.613064144480053,  0.445251442116406,  0.000000000000000,
        0.000000000000000,  0.312286013389844,  -0.027742129448689, -1.546601868575405, -1.732050807568879, 0.417603842448627,  0.475743510656293,
        0.000000000000000,  -0.000000000000000, -0.615859852724454, -0.540289457160019, 0.844854190931255,  0.854067381671992,  -0.000000000000000,
        -0.000000000000000, -0.857722854489709, -0.579966855123940, 0.000000000000000,  -0.000000000000000, -0.611191027858889, -0.312286013389844,
        -0.000000000000000, 0.000000000000000,  0.234707270801076,  0.140128448983591,  -1.732050807568878, -1.049289187836143, 0.956378777054527,
        0.860757005548295,  0.000000000000000,  -0.000000000000000, 0.779255295948328,  1.000764152649477,  0.000000000000000,  0.000000000000000,
        -0.317383138248699, -0.314223496772178, 0.000000000000000,  0.000000000000000,  -0.057027039556284, 0.027742129448689,  -0.000000000000000,
        0.000000000000000,  -0.025651607260807, -0.137261849606103, -1.049289187836143, -1.732050807568879, 0.707528292124991,  0.874409278236653,
        0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.915666639884018, -0.472057599247502, 0.000000000000000,
        -0.000000000000000, -0.476753734559551, -0.175648087380941, 1.732050807568879,  1.546601868575405,  -0.234707270801076, 0.025651607260807,
        0.000000000000000,  -0.000000000000000, -1.404282611018564, -0.654596880097634, -1.000000000000001, -0.892931005151188, 0.595271667405279,
        0.567379559035638,  0.000000000000000,  0.000000000000000,  -0.703886956677531, -0.529915547209356, 0.000000000000000,  0.000000000000000,
        -0.327480536952687, -0.169470359730330, 1.546601868575405,  1.732050807568879,  -0.140128448983591, 0.137261849606103,  0.000000000000000,
        0.000000000000000,  -1.038639134444629, -0.709084041427098, -0.892931005151188, -1.000000000000000, 0.637746162000515,  0.702336526217143,
        1.117170396328322,  0.918077801664235,  0.000000000000000,  -0.000000000000000, 0.398474155952090,  0.096990551872933,  -0.000000000000001,
        -0.000000000000000, -0.309418055183370, -0.417603842448627, 1.732050807568878,  1.049289187836143,  1.404282611018564,  1.038639134444629,
        -0.000000000000000, 0.000000000000000,  -0.567989005106054, -0.653150657410806, -1.000000000000000, -0.605807395054961, 0.676167582932301,
        0.796058472163944,  0.000000000000000,  0.000000000000000,  -0.151511105489922, -0.303236277214729, 0.000000000000000,  0.000000000000000,
        -0.392551416681064, -0.475743510656293, 1.049289187836143,  1.732050807568879,  0.654596880097634,  0.709084041427098,  -0.000000000000000,
        0.000000000000000,  -0.700792723650687, -0.967253541439960, -0.605807395054961, -1.000000000000000, 0.000000000000000,  -0.000000000000000,
        -0.214244750435031, -0.200720289875108, 0.000000000000000,  -0.000000000000000, -0.236588179455050, -0.061423716137360, 0.000000000000000,
        -0.000000000000000, -0.956378777054527, -0.707528292124991, 1.000000000000001,  0.892931005151188,  0.567989005106054,  0.700792723650687,
        0.000000000000000,  -0.000000000000000, 0.752392581931820,  0.670136533357563,  0.000000000000000,  0.000000000000000,  -0.217779482819310,
        -0.258888697618417, 0.000000000000000,  0.000000000000000,  -0.144836359511414, -0.047474871166436, 0.000000000000000,  0.000000000000000,
        -0.860757005548295, -0.874409278236653, 0.892931005151188,  1.000000000000000,  0.653150657410806,  0.967253541439960,  0.000000000000000,
        0.000000000000000,  0.744992904533316,  0.856771273467965,  -0.085688756778697, -0.122546264490761, -0.000000000000001, -0.000000000000000,
        0.343557372630766,  0.204643502203439,  0.000000000000000,  -0.000000000000000, 0.748166432068588,  0.615859852724454,  -0.000000000000000,
        -0.000000000000000, -0.595271667405279, -0.637746162000515, 1.000000000000000,  0.605807395054961,  -0.752392581931820, -0.744992904533316,
        -0.000000000000000, 0.000000000000000,  -0.139288997470620, -0.191190554616478, 0.000000000000000,  0.000000000000000,  0.079070649872626,
        0.053608575451505,  0.000000000000000,  0.000000000000000,  0.456946955810599,  0.540289457160019,  0.000000000000000,  0.000000000000000,
        -0.567379559035638, -0.702336526217143, 0.605807395054961,  1.000000000000000,  -0.670136533357563, -0.856771273467965, -0.000000000000000,
        0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 20, 20));

    std::vector<double> intzvals{
        0.000000000000000,  -0.000000000000000, 0.094407921596430,  -0.036635928702310, -0.000000000000000, -0.000000000000000, -0.176476214268522,
        -0.203079734202263, -0.000000000000000, -0.000000000000000, 0.347407270674709,  0.281944875878306,  -0.000000000000000, -0.000000000000000,
        0.671413814411483,  0.370465053329441,  2.000000000000001,  1.785862010302376,  0.170345230024986,  0.323587264779554,  0.000000000000000,
        0.000000000000000,  0.023065543640165,  -0.073327387510198, 0.000000000000000,  -0.000000000000000, -0.198450663431131, -0.271932343919461,
        0.000000000000000,  -0.000000000000000, 0.330695309197180,  0.352450489554280,  0.000000000000000,  -0.000000000000000, 0.532096943900819,
        0.423708612415346,  1.785862010302376,  2.000000000000001,  0.218983921886033,  0.511421364949563,  -0.094407921596430, -0.023065543640165,
        0.000000000000000,  -0.000000000000000, 0.639972353706668,  0.719183136928627,  -0.000000000000000, -0.000000000000000, -0.495821387758739,
        -0.462522652483622, 0.000000000000000,  -0.000000000000000, -1.040837367892708, -0.924780159709776, -0.000000000000000, -0.000000000000000,
        -0.130713031607047, -0.004593957300005, 1.999999999999999,  1.211614790109921,  0.036635928702310,  0.073327387510198,  0.000000000000000,
        0.000000000000000,  0.719783472714064,  0.954456548176949,  0.000000000000000,  -0.000000000000000, -0.388637722517586, -0.483449643875580,
        0.000000000000000,  -0.000000000000000, -0.744666690084906, -0.911637308165424, 0.000000000000000,  -0.000000000000000, 0.179101059790507,
        0.352088671979560,  1.211614790109921,  2.000000000000001,  0.000000000000000,  -0.000000000000000, -0.639972353706668, -0.719783472714064,
        0.000000000000000,  -0.000000000000000, -0.476320132938780, -0.090469518579061, -0.000000000000000, -0.000000000000000, -0.240026743341287,
        -0.035039338472271, 1.000000000000000,  0.892931005151188,  0.205186130805544,  0.003296614120025,  -0.000000000000000, -0.000000000000000,
        0.122192832080897,  -0.169391460211346, 0.000000000000000,  0.000000000000000,  -0.719183136928627, -0.954456548176949, 0.000000000000000,
        0.000000000000000,  -0.263510708525021, -0.052199518961432, 0.000000000000000,  -0.000000000000000, -0.123291368368925, -0.012930912127544,
        0.892931005151188,  1.000000000000000,  0.077499882335695,  -0.008042641051870, 0.000000000000000,  -0.000000000000000, -0.045806196592385,
        -0.274331669512728, 0.176476214268522,  0.198450663431131,  0.000000000000000,  -0.000000000000000, 0.476320132938780,  0.263510708525021,
        0.000000000000000,  -0.000000000000000, 0.325341380239797,  0.165567172962473,  -0.000000000000000, -0.000000000000000, -0.401069099400054,
        -0.297404283459187, 1.000000000000000,  0.605807395054961,  -0.352636293027130, -0.242162082218799, -0.000000000000000, -0.000000000000000,
        0.203079734202263,  0.271932343919461,  0.000000000000000,  0.000000000000000,  0.090469518579061,  0.052199518961432,  0.000000000000000,
        0.000000000000000,  0.039985342141722,  0.004221627691897,  0.000000000000000,  -0.000000000000000, -0.135066151430424, -0.090381287904581,
        0.605807395054961,  1.000000000000000,  -0.136425477724643, -0.137898139206984, 0.000000000000000,  -0.000000000000000, 0.000000000000000,
        -0.000000000000000, 0.495821387758739,  0.388637722517586,  0.000000000000000,  -0.000000000000000, -0.325341380239797, -0.039985342141722,
        0.000000000000000,  -0.000000000000000, -0.040227769817689, -0.045520241913290, -0.000000000000000, -0.000000000000000, 0.351869992496874,
        0.006316463035187,  -0.000000000000000, -0.000000000000000, 1.079663436495455,  0.762738953158103,  0.000000000000000,  0.000000000000000,
        0.462522652483622,  0.483449643875580,  0.000000000000000,  0.000000000000000,  -0.165567172962473, -0.004221627691897, 0.000000000000000,
        0.000000000000000,  -0.038781294884661, -0.065195126223496, 0.000000000000000,  -0.000000000000000, 0.171460581982003,  -0.060876314698910,
        0.000000000000000,  -0.000000000000000, 0.949785869947652,  0.933888652503109,  -0.347407270674709, -0.330695309197180, -0.000000000000000,
        -0.000000000000000, 0.240026743341287,  0.123291368368925,  0.000000000000000,  -0.000000000000000, 0.040227769817689,  0.038781294884661,
        0.000000000000000,  -0.000000000000000, -0.223898037149108, -0.108046875091681, -0.000000000000000, -0.000000000000000, -0.723469555493782,
        -0.633400246060192, -0.000000000000000, 0.000000000000000,  -0.281944875878306, -0.352450489554280, 0.000000000000000,  0.000000000000000,
        0.035039338472271,  0.012930912127544,  0.000000000000000,  0.000000000000000,  0.045520241913290,  0.065195126223496,  0.000000000000000,
        0.000000000000000,  0.001102542468988,  0.047812388045440,  0.000000000000000,  -0.000000000000000, -0.506676121223830, -0.619490682131989,
        -0.000000000000000, -0.000000000000000, 0.000000000000000,  -0.000000000000000, 1.040837367892708,  0.744666690084906,  -1.000000000000000,
        -0.892931005151188, 0.401069099400054,  0.135066151430424,  0.000000000000000,  -0.000000000000000, 0.223898037149108,  -0.001102542468988,
        0.000000000000000,  -0.000000000000000, 0.764464064275710,  0.163452860007319,  -0.000000000000000, -0.000000000000000, -0.513873053788525,
        -0.673121341457719, 0.000000000000000,  0.000000000000000,  0.924780159709776,  0.911637308165424,  -0.892931005151188, -1.000000000000000,
        0.297404283459187,  0.090381287904581,  0.000000000000000,  0.000000000000000,  0.108046875091681,  -0.047812388045440, 0.000000000000000,
        0.000000000000000,  0.453988197404459,  0.096280008150014,  0.000000000000000,  -0.000000000000000, -0.637899804140346, -0.905364174309777,
        -0.671413814411483, -0.532096943900819, 0.000000000000000,  -0.000000000000000, -0.205186130805544, -0.077499882335695, -1.000000000000000,
        -0.605807395054961, -0.351869992496874, -0.171460581982003, 0.000000000000000,  -0.000000000000000, -0.764464064275710, -0.453988197404459,
        0.000000000000000,  -0.000000000000000, 0.077568671585486,  0.137655035707632,  -0.000000000000000, -0.000000000000000, -0.370465053329441,
        -0.423708612415346, 0.000000000000000,  0.000000000000000,  -0.003296614120025, 0.008042641051870,  -0.605807395054961, -1.000000000000000,
        -0.006316463035187, 0.060876314698910,  0.000000000000000,  0.000000000000000,  -0.163452860007319, -0.096280008150014, 0.000000000000000,
        0.000000000000000,  0.169797217932337,  0.237650621862579,  0.000000000000000,  -0.000000000000000, -2.000000000000001, -1.785862010302376,
        0.130713031607047,  -0.179101059790507, 0.000000000000000,  -0.000000000000000, 0.352636293027130,  0.136425477724643,  0.000000000000000,
        -0.000000000000000, 0.723469555493782,  0.506676121223830,  0.000000000000000,  -0.000000000000000, -0.077568671585486, -0.169797217932337,
        0.000000000000000,  -0.000000000000000, -0.280880930778493, -0.224913699055497, -1.785862010302376, -2.000000000000001, 0.004593957300005,
        -0.352088671979560, 0.000000000000000,  0.000000000000000,  0.242162082218799,  0.137898139206984,  0.000000000000000,  0.000000000000000,
        0.633400246060192,  0.619490682131989,  0.000000000000000,  0.000000000000000,  -0.137655035707632, -0.237650621862579, 0.000000000000000,
        0.000000000000000,  -0.262925062502170, -0.282344880419783, -0.170345230024986, -0.218983921886033, -1.999999999999999, -1.211614790109921,
        -0.122192832080897, 0.045806196592385,  0.000000000000000,  -0.000000000000000, -1.079663436495455, -0.949785869947652, 0.000000000000000,
        0.000000000000000,  0.513873053788525,  0.637899804140346,  0.000000000000000,  -0.000000000000000, 0.280880930778493,  0.262925062502170,
        0.000000000000000,  -0.000000000000000, -0.323587264779554, -0.511421364949563, -1.211614790109921, -2.000000000000001, 0.169391460211346,
        0.274331669512728,  0.000000000000000,  0.000000000000000,  -0.762738953158103, -0.933888652503109, -0.000000000000000, 0.000000000000000,
        0.673121341457719,  0.905364174309777,  0.000000000000000,  0.000000000000000,  0.224913699055497,  0.282344880419783,  0.000000000000000,
        0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 20, 20));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeDFForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix amomxmat(20, 28);

    CDenseMatrix amomymat(20, 28);

    CDenseMatrix amomzmat(20, 28);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, 0.284741500961286,  0.190837561939722,  2.866829525219820,  2.416488049132818,  1.044221056491010,
        1.416474360048297,  -0.000000000000000, -0.000000000000000, -1.425393695907493, -1.050767653528845, -0.000000000000000, -0.000000000000000,
        -0.172536495454091, -0.372988191494457, 1.359856644467063,  1.146240926075487,  0.182848505392858,  0.465777809485293,  -0.000000000000000,
        -0.000000000000000, 0.416142877417949,  0.190112255483737,  5.266702137250438,  4.439372017431729,  0.145142257792017,  0.625487149248047,
        -0.000000000000000, -0.000000000000000, 0.189215792016033,  0.202413531616813,  1.899712152116142,  2.190890230020665,  0.997299211739410,
        1.746400168697757,  -0.000000000000000, -0.000000000000000, -0.991078034768541, -1.139659515677545, -0.000000000000000, -0.000000000000000,
        -0.238387479247419, -0.463321207726249, 0.901112594908090,  1.039230484541327,  0.238505803650213,  0.647714744240257,  -0.000000000000000,
        -0.000000000000000, 0.217723627066115,  0.197688282810979,  3.489994073136785,  4.024922359499623,  0.268656704868514,  0.907062508751335,
        0.425294388578750,  0.389527508250301,  0.000000000000000,  -0.000000000000000, 0.951858633857943,  1.070732615233847,  2.191631685973859,
        1.130601046437006,  -1.103795801074266, -0.914510669950093, 0.000000000000000,  -0.000000000000000, -0.191485296628975, -0.197629093037011,
        0.000000000000000,  0.000000000000000,  0.137434548535022,  0.096341019339240,  0.940574360554097,  0.485215815732171,  0.575852311954554,
        0.405305394785016,  -0.000000000000000, -0.000000000000000, 0.086461293128487,  0.204651650784308,  3.642828834295710,  1.879232773647146,
        0.193519793385831,  0.262944869587191,  -0.000000000000000, -0.000000000000000, 0.647567975433146,  0.946516107191428,  0.661130487463201,
        1.252198067399883,  -0.417898414660111, -0.552234786238229, -0.000000000000000, -0.000000000000000, -0.098830628743528, -0.129669387448458,
        0.000000000000000,  -0.000000000000000, 0.001120722920732,  -0.034466293935290, 0.283734894630436,  0.537401153701776,  0.133551125103907,
        0.143550193797155,  -0.000000000000000, -0.000000000000000, 0.245369074454737,  0.440066090800592,  1.098900521641597,  2.081345718519633,
        -0.000000000000000, -0.000000000000000, -0.722271374065912, -0.560586905537858, -0.000000000000000, -0.000000000000000, -1.001271257279524,
        -0.485222706012187, 3.626284385245503,  3.056642469534633,  -1.176306514923965, -0.182711939910266, 3.330954902277623,  2.807705391180197,
        1.152814005483548,  1.072380322751029,  -0.000000000000000, -0.000000000000000, 0.372748888302879,  0.256791017277244,  4.300244287829729,
        3.624732073699228,  0.703213648484915,  0.801132014785742,  -0.000000000000000, -0.000000000000000, 0.074867932769525,  -0.113974706126256,
        -0.000000000000000, -0.000000000000000, -0.539143337190077, -0.586121549416708, -0.000000000000000, -0.000000000000000, -0.559414227519789,
        -0.481754316229111, 2.402966919754908,  2.771281292110205,  -0.559098176295215, 0.061138084387480,  2.207266058320100,  2.545584412271571,
        0.790395834952954,  1.370547338048753,  -0.000000000000000, -0.000000000000000, 0.242580687073592,  0.289178041541365,  2.849568228174213,
        3.286335345030997,  0.521490502248135,  1.067784377350972,  -0.000000000000000, -0.000000000000000, -0.051685394256124, -0.137247981817524,
        -0.697162147779752, -0.745770517560850, -0.000000000000000, -0.000000000000000, -1.078997942963811, -0.789244660195416, -0.000000000000000,
        -0.000000000000000, -1.022638162885773, -0.736761012640393, 2.772219167948919,  1.430109772684295,  1.488916274088509,  1.117513213343091,
        2.303927248502108,  1.188531163672126,  0.694297197895463,  0.672764118738132,  -0.000000000000000, -0.000000000000000, 0.701012340856827,
        0.522453637020488,  2.974357288107380,  1.534387134450222,  0.233019992905935,  0.055771010744958,  -0.000000000000000, -0.000000000000000,
        -0.447026316455423, -0.655648519562330, 0.000000000000000,  -0.000000000000000, -0.314377940668712, -0.393350752048244, -0.000000000000000,
        -0.000000000000000, -0.277898877726583, -0.332565787149302, 0.836271268384445,  1.583919189857868,  0.399586578372302,  0.451376119754765,
        0.695005714066919,  1.316358613752347,  0.316020898048850,  0.407990682512949,  -0.000000000000000, -0.000000000000000, 0.240269589083773,
        0.332154429557985,  0.897248518700059,  1.699411662899841,  -0.058110186496420, -0.126512050719407, -0.000000000000000, -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.396936198687333,  0.247573315851381,  -0.000000000000000, -0.000000000000000, 0.388004787740672,
        0.227068861404837,  -4.710681598454165, -3.970695043355093, 1.619664960886245,  0.036039409000294,  3.846255418976980,  3.242058926806101,
        -0.179582075689062, -0.558990753587591, -0.000000000000000, -0.000000000000000, 0.917773892864464,  0.187019101496610,  -0.000000000000000,
        -0.000000000000000, 0.367644942833167,  0.149872746767300,  -0.000000000000000, -0.000000000000000, 0.817436070695036,  0.523833788751089,
        0.000000000000000,  -0.000000000000000, 0.254326241199364,  0.258478120881209,  -0.000000000000000, -0.000000000000000, 0.266794717735689,
        0.203995583618310,  -3.121545595442091, -3.600000000000001, 0.698035247932488,  -0.396112363496142, 2.548731305888469,  2.939387691339816,
        -0.440464775470327, -0.568248230876574, -0.000000000000000, -0.000000000000000, 0.394095356963276,  0.100428730780113,  -0.000000000000000,
        -0.000000000000000, 0.162146152633618,  0.177021476233393,  -0.000000000000000, -0.000000000000000, 0.528152759022962,  0.552415724922287,
        0.483164003264029,  0.425045612483275,  0.000000000000000,  -0.000000000000000, 0.205246813085550,  0.128079214969686,  0.000000000000000,
        0.000000000000000,  1.326297520293076,  0.890163914525718,  -3.258245161552610, -1.680836890968199, -0.067783445193102, -0.522295408956786,
        2.940382458888013,  1.516860477159325,  0.857928996041757,  0.418312519996267,  -0.000000000000000, -0.000000000000000, 0.713638716438646,
        0.527853290273909,  -0.000000000000000, -0.000000000000000, 0.878461912462217,  0.808879325704474,  -0.000000000000000, -0.000000000000000,
        0.203007888708771,  0.272002557974474,  -0.000000000000000, -0.000000000000000, 0.052717971089164,  0.076654141584884,  0.000000000000000,
        -0.000000000000000, 0.293786835928491,  0.333305143772760,  -0.982886506760236, -1.861612204515217, -0.432015551747109, -0.649527574012666,
        0.886999627179174,  1.680000000000002,  0.032583514419890,  -0.038776213320098, -0.000000000000000, -0.000000000000000, 0.171518104223822,
        0.174010611972543,  -0.000000000000000, -0.000000000000000, 0.406992579256691,  0.555978685999360,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.703247107454688,  0.397970842101330,  -4.300244287829728, -3.624732073699228, -0.047593846318825,
        -0.678275426489514, -0.000000000000000, -0.000000000000000, 0.605870475783287,  0.510962541113494,  -0.000000000000000, -0.000000000000000,
        0.923181290846326,  0.250678793221220,  3.626284385245503,  3.056642469534633,  -0.919978150762138, -0.734949493618054, -0.000000000000000,
        -0.000000000000000, -0.237118374976460, -0.604328023637026, -0.000000000000000, 0.000000000000000,  -0.581803512802681, -0.516989430620410,
        -0.000000000000000, -0.000000000000000, 0.442593853704895,  0.389184524758614,  -2.849568228174213, -3.286335345030997, -0.248710115760889,
        -1.007284314596907, -0.000000000000000, -0.000000000000000, 0.462273983135413,  0.562329510725159,  -0.000000000000000, -0.000000000000000,
        0.424132670547967,  0.184675493845896,  2.402966919754908,  2.771281292110205,  -0.741534582273415, -0.715002014325976, -0.000000000000000,
        -0.000000000000000, -0.391509774762119, -0.735498036657904, 0.000000000000000,  -0.000000000000000, -0.474304128813768, -0.549072480428872,
        0.602172526652358,  0.555126795883050,  0.000000000000000,  0.000000000000000,  0.016571566137341,  -0.079057957791480, -2.974357288107380,
        -1.534387134450222, 0.435176199568522,  0.365182205201212,  -0.000000000000000, -0.000000000000000, 1.044889695565119,  0.773154450714876,
        0.000000000000000,  -0.000000000000000, -0.938239490427690, -1.019018142069627, 2.772219167948919,  1.430109772684295,  -0.232857156401993,
        -0.411610696934073, -0.000000000000000, -0.000000000000000, -0.566918103781709, -0.656713205118786, -0.000000000000000, 0.000000000000000,
        0.295388960755159,  0.418807586732340,  0.000000000000000,  -0.000000000000000, -0.118965746598504, -0.213713111670121, -0.897248518700059,
        -1.699411662899841, 0.150033394544972,  0.184963441848995,  -0.000000000000000, -0.000000000000000, 0.298166415783574,  0.364709513143586,
        -0.000000000000000, -0.000000000000000, -0.528426766604782, -0.702829844589754, 0.836271268384445,  1.583919189857868,  -0.290927690227786,
        -0.434827895802418, -0.000000000000000, -0.000000000000000, -0.413534363093312, -0.614591700261620, -0.000000000000000, 0.000000000000000,
        -5.266702137250438, -4.439372017431729, 0.119410271158934,  -0.515608547893624, -0.000000000000000, -0.000000000000000, 0.602334107247477,
        0.271710111813068,  -1.359856644467063, -1.146240926075487, 0.711428549262898,  0.069004246049533,  -0.000000000000000, -0.000000000000000,
        1.186698106073661,  1.115326878317925,  -0.000000000000000, -0.000000000000000, 0.059699643424434,  -0.088855422101460, 2.866829525219820,
        2.416488049132819,  1.206339091135114,  1.482396169883047,  -0.000000000000000, -0.000000000000000, 0.032372204065926,  0.083079107952315,
        -3.489994073136784, -4.024922359499622, -0.129062248732328, -0.804207306073437, -0.000000000000000, -0.000000000000000, 0.340983090035378,
        0.246971767964535,  -0.901112594908090, -1.039230484541327, 0.322840746114049,  -0.094978930829373, -0.000000000000000, -0.000000000000000,
        0.940838588232396,  1.269477665660055,  -0.000000000000000, -0.000000000000000, -0.028754329398985, -0.121009004716454, 1.899712152116142,
        2.190890230020665,  1.080098685362694,  1.809201717666323,  -0.000000000000000, -0.000000000000000, 0.053793870175671,  0.101110613327766,
        0.175194651684395,  -0.023542682292491, -3.642828834295709, -1.879232773647146, 0.372872189646947,  0.231424032524669,  0.000000000000000,
        0.000000000000000,  0.567335253211982,  0.426687492198338,  -0.940574360554097, -0.485215815732172, 0.896824356933317,  0.806465830760654,
        0.000000000000000,  -0.000000000000000, 0.174371560716776,  0.010698198496485,  0.000000000000000,  -0.000000000000000, 1.121330163820556,
        1.175304979044931,  2.191631685973859,  1.130601046437006,  0.176711803719121,  0.214498688692786,  0.000000000000000,  -0.000000000000000,
        -0.180381593235099, -0.363091386877998, -1.098900521641598, -2.081345718519633, 0.081994951143611,  0.103310396673074,  0.000000000000000,
        -0.000000000000000, 0.202220717229634,  0.284313195188722,  -0.283734894630436, -0.537401153701776, 0.378068143877180,  0.495516972003903,
        -0.000000000000000, 0.000000000000000,  -0.060029596698122, -0.111527228121053, -0.000000000000000, -0.000000000000000, 0.680211264394929,
        0.982572055043661,  0.661130487463201,  1.252198067399883,  0.129923646679810,  0.187296476337145,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 20, 28));

    std::vector<double> intyvals{
        5.266702137250438,  4.439372017431729,  0.230605697214311,  0.688906528356577,  -1.433414762609910, -1.208244024566409, -0.246754388342551,
        -0.749277372710230, -1.359856644467063, -1.146240926075487, -0.063834130433671, -0.513273922747368, -0.000000000000000, -0.000000000000000,
        0.912632087593799,  0.989802045722308,  -0.000000000000000, -0.000000000000000, 1.644097333855250,  1.128986306356825,  -0.000000000000000,
        -0.000000000000000, -0.005582247881253, -0.001499268220685, -0.000000000000000, -0.000000000000000, 0.093692080432401,  0.157313998238053,
        3.489994073136785,  4.024922359499623,  0.329530518088954,  0.974960712749653,  -0.949856076058071, -1.095445115010332, -0.428052515026720,
        -0.970715614466253, -0.901112594908090, -1.039230484541327, -0.221203010901672, -0.729057390060503, -0.000000000000000, -0.000000000000000,
        0.790108341768431,  1.148016976313409,  -0.000000000000000, -0.000000000000000, 1.106425367055676,  1.203480107822936,  -0.000000000000000,
        -0.000000000000000, -0.019452175447648, 0.020162036398351,  -0.000000000000000, -0.000000000000000, 0.111143023003901,  0.187509687349379,
        0.285839760637814,  0.399813528027901,  3.642828834295710,  1.879232773647146,  -0.229265792844845, -0.454813203446170, -0.939270722560225,
        -0.484543305615860, 0.045881135820827,  -0.055326677357335, -0.940574360554097, -0.485215815732171, 0.693028241251509,  0.665499705259580,
        -0.000000000000000, -0.000000000000000, 1.250150294952112,  1.014702831326187,  -0.000000000000000, -0.000000000000000, 0.268828148639214,
        0.209230462978748,  -0.000000000000000, -0.000000000000000, 0.244695234000354,  0.294691365423029,  0.000000000000000,  -0.000000000000000,
        0.346852415180996,  0.579844291944718,  1.098900521641597,  2.081345718519633,  -0.344983812973753, -0.527603999114296, -0.283341637484229,
        -0.536656314599950, -0.043848775957191, -0.053954101263783, -0.283734894630436, -0.537401153701776, 0.327253565296468,  0.435128044383238,
        -0.000000000000000, -0.000000000000000, 0.444909378537869,  0.576981093327182,  -0.000000000000000, -0.000000000000000, 0.065703228124215,
        0.061384303896673,  -0.000000000000000, -0.000000000000000, 0.178683312391673,  0.257841024871114,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.171916712615078, -0.300166693298798, 4.300244287829728,  3.624732073699228,  -0.059511104431120,
        0.171739092070692,  -1.813142192622752, -1.528321234767317, 0.098466565871390,  0.205380104657535,  -0.000000000000000, -0.000000000000000,
        -0.774540331219926, -0.140079273357862, -0.000000000000000, -0.000000000000000, -0.164607738004130, -0.481965568109592, -0.000000000000000,
        -0.000000000000000, 0.027391087806464,  -0.361312705691834, -0.000000000000000, -0.000000000000000, 0.645674911344966,  0.526181837314151,
        0.000000000000000,  -0.000000000000000, -0.223755789238818, -0.341374349129149, 2.849568228174213,  3.286335345030997,  -0.040591186243060,
        0.369767045333742,  -1.201483459877454, -1.385640646055102, 0.179695637191120,  0.196652557613287,  -0.000000000000000, -0.000000000000000,
        -0.316064728611955, -0.067801056907164, -0.000000000000000, -0.000000000000000, -0.295107644587708, -0.600019734673689, -0.000000000000000,
        -0.000000000000000, -0.180203657922198, -0.464582221908368, -0.000000000000000, -0.000000000000000, 0.496963440995217,  0.553357467088622,
        -0.217237555278205, -0.343217803396543, -0.000000000000000, -0.000000000000000, -0.113742863971856, -0.211004461564829, 2.974357288107380,
        1.534387134450222,  0.087122964750097,  0.226737192698263,  -1.188093929120965, -0.612904188293269, -0.882421794659522, -0.621285226385506,
        -0.000000000000000, -0.000000000000000, 0.120394440835532,  0.029512463086469,  0.000000000000000,  -0.000000000000000, 0.057600551442488,
        -0.115323704781288, -0.000000000000000, -0.000000000000000, 0.599099373576166,  0.669569638952605,  0.000000000000000,  -0.000000000000000,
        -0.253958384988631, -0.392204235309559, 0.000000000000000,  -0.000000000000000, -0.126458105451800, -0.168731111959121, 0.897248518700059,
        1.699411662899841,  0.151209581633187,  0.211715581270847,  -0.358401972164762, -0.678822509939086, -0.226117984968250, -0.269281934985258,
        -0.000000000000000, -0.000000000000000, -0.017688348377230, -0.036340056318142, -0.000000000000000, -0.000000000000000, -0.131912987137187,
        -0.213626059340172, -0.000000000000000, -0.000000000000000, 0.415437162981033,  0.615657737183625,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.887567255457340,  0.562694822806409,  -0.000000000000000, -0.000000000000000, 0.180860047550087,
        0.077308536610382,  -0.000000000000000, -0.000000000000000, -0.784813712617292, -0.223277574264227, -1.923127709488490, -1.621029463403051,
        0.051841072051656,  0.163882662170384,  4.710681598454165,  3.970695043355093,  -0.766213263334411, 0.095637527068470,  -0.000000000000000,
        -0.000000000000000, 0.718612053441800,  0.334515268274647,  0.000000000000000,  0.000000000000000,  -0.267123231914297, -0.192182989689984,
        -0.000000000000000, -0.000000000000000, 0.572627199852819,  0.590224055098096,  -0.000000000000000, -0.000000000000000, 0.070311217964397,
        0.107579454649116,  -0.000000000000000, -0.000000000000000, -0.360786908232429, -0.173951947988104, -1.274365652944235, -1.469693845669908,
        0.154337866378732,  0.135330305298076,  3.121545595442091,  3.600000000000001,  -0.347416817975861, 0.430787494340908,  -0.000000000000000,
        -0.000000000000000, 0.380669586716733,  0.348204681341068,  0.000000000000000,  -0.000000000000000, -0.184697589295955, -0.206411545250905,
        1.034293074471177,  0.927935490556764,  -0.000000000000000, -0.000000000000000, 0.514731451633024,  0.414858271407221,  -0.000000000000000,
        -0.000000000000000, -0.717519975718919, -0.369641206907307, 0.000000000000000,  -0.000000000000000, -0.036598195559612, 0.154598405285324,
        -1.260163910952006, -0.650083061639711, -0.517750676709720, -0.509122605802855, 3.258245161552610,  1.680836890968199,  0.984265894656010,
        0.698971831680575,  -0.000000000000000, -0.000000000000000, -0.264436598024027, -0.270779378583868, 0.000000000000000,  -0.000000000000000,
        0.452694275654729,  0.611323258983124,  -0.000000000000000, -0.000000000000000, 0.140126252966319,  0.141631781215164,  -0.000000000000000,
        -0.000000000000000, -0.057985181953819, -0.021255242149034, -0.000000000000000, -0.000000000000000, 0.150672886328315,  0.234199955827594,
        -0.380142697362503, -0.720000000000001, -0.283568352267869, -0.405639625185596, 0.982886506760236,  1.861612204515217,  0.231839949530494,
        0.249911514276381,  -0.000000000000000, -0.000000000000000, -0.146888059916337, -0.205220127999292, -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.457321181878716, -0.455553846082688, -0.000000000000000, -0.000000000000000, 1.218230374052981,
        0.496293510927639,  -0.000000000000000, -0.000000000000000, 0.185074643216482,  -0.100708282355217, -3.330954902277623, -2.807705391180197,
        -0.284402290027343, -0.789748315157773, -1.813142192622752, -1.528321234767316, 1.086068337496170,  0.099650519117069,  4.300244287829729,
        3.624732073699228,  -0.253372991651437, 0.245079732477060,  -0.000000000000000, -0.000000000000000, -0.931876927999717, -0.587175308547680,
        -0.000000000000000, -0.000000000000000, -0.401376247284611, -0.489955433845794, -0.000000000000000, -0.000000000000000, 0.643687119482422,
        0.456641314096685,  -0.000000000000000, -0.000000000000000, 0.034432299505025,  -0.190292530897998, -2.207266058320100, -2.545584412271571,
        -0.364906648205639, -1.138734801884685, -1.201483459877454, -1.385640646055102, 0.455189924222233,  -0.106068592968782, 2.849568228174213,
        3.286335345030997,  -0.066333680901031, 0.493572141286983,  -0.000000000000000, -0.000000000000000, -0.613182676341384, -0.597682670306461,
        -0.375212496677870, -0.507742462875796, -0.000000000000000, -0.000000000000000, 1.310286028095235,  0.909714831189512,  0.000000000000000,
        -0.000000000000000, -0.268287056654881, -0.431860407218911, 0.000000000000000,  -0.000000000000000, -0.509862927180513, -0.371971688194448,
        -2.303927248502108, -1.188531163672126, 0.981263770110273,  0.619712927738353,  -1.188093929120965, -0.612904188293269, -0.334475359255532,
        -0.305407955336903, 2.974357288107380,  1.534387134450222,  -1.042199209199957, -0.957863705816438, -0.000000000000000, -0.000000000000000,
        -0.353715553392420, -0.540302416843935, -0.000000000000000, -0.000000000000000, 0.319717790302950,  0.372846071670287,  -0.000000000000000,
        -0.000000000000000, -0.266669603633047, -0.370880917314072, -0.000000000000000, -0.000000000000000, -0.103082278009107, -0.083833140029558,
        -0.695005714066919, -1.316358613752347, 0.185184161191309,  0.196591228516474,  -0.358401972164762, -0.678822509939086, -0.121177820250579,
        -0.136687897915127, 0.897248518700059,  1.699411662899841,  -0.495465368813296, -0.690681256840873, -0.000000000000000, 0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.337920566866076, -0.263352619631355, -0.000000000000000, -0.000000000000000, 0.273704596863038,
        0.120897516273311,  -0.000000000000000, -0.000000000000000, 0.219786261440999,  0.022385800202403,  -0.000000000000000, -0.000000000000000,
        1.291948479620935,  1.027455178741890,  -1.359856644467063, -1.146240926075487, -0.506586189478043, -0.855200583364234, -1.433414762609910,
        -1.208244024566409, -1.252673854992611, -1.218952166659913, 5.266702137250438,  4.439372017431729,  -0.016944917906062, 0.582619761710211,
        -0.000000000000000, -0.000000000000000, -0.243544231500398, -0.287447014912559, -0.000000000000000, -0.000000000000000, 0.165437019006246,
        0.094087264128685,  -0.000000000000000, -0.000000000000000, 0.080430777679623,  -0.002754437590258, -0.000000000000000, -0.000000000000000,
        0.933053898748777,  1.136300336863924,  -0.901112594908090, -1.039230484541327, -0.540214199968413, -1.100482701991328, -0.949856076058071,
        -1.095445115010332, -0.990161243084655, -1.424647893519339, 3.489994073136784,  4.024922359499622,  0.196244759129910,  0.874957517984028,
        -0.484647765769728, -0.465424372244357, -0.000000000000000, -0.000000000000000, -0.035642034822197, -0.051591580411772, 0.000000000000000,
        -0.000000000000000, 0.259513542868022,  0.101180242690493,  0.000000000000000,  -0.000000000000000, 0.936796457818738,  0.808889019134690,
        0.000000000000000,  -0.000000000000000, -0.349692290290708, -0.361030497873516, -0.940574360554097, -0.485215815732172, -1.155043297831285,
        -1.088764455640450, -0.939270722560225, -0.484543305615860, 0.042207502739696,  0.227676275351937,  3.642828834295709,  1.879232773647146,
        -0.241184637606637, -0.332374417962542, -0.000000000000000, -0.000000000000000, -0.011631032816229, 0.001024608210552,  -0.000000000000000,
        -0.000000000000000, -0.010516225844513, -0.042335766573968, -0.000000000000000, -0.000000000000000, 0.368977420644203,  0.480928739024219,
        -0.000000000000000, -0.000000000000000, -0.168326177183003, -0.210031524550363, -0.283734894630436, -0.537401153701776, -0.563022074268842,
        -0.778836367820746, -0.283341637484229, -0.536656314599950, 0.284151445941761,  0.505198242731273,  1.098900521641598,  2.081345718519633};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 20, 28));

    std::vector<double> intzvals{
        -3.511134758166959, -2.959581344954486, -0.471905188058117, -0.949187779326524, -0.000000000000000, -0.000000000000000, -0.157498846366249,
        0.049025281150797,  0.906571096311375,  0.764160617383658,  0.175761420896412,  0.206847624476151,  -0.000000000000000, -0.000000000000000,
        -0.391907535190519, -0.362312432103147, -0.453285548155688, -0.382080308691829, -0.830600064223088, -0.504200020893814, -0.000000000000000,
        -0.000000000000000, -0.259686039702472, -0.441517484410314, -1.755567379083479, -1.479790672477243, -0.269115402102897, -0.608895985691885,
        -2.326662715424523, -2.683281572999749, -0.534268715090519, -1.280996435917696, -0.000000000000000, -0.000000000000000, -0.025732698877921,
        0.086573532189023,  0.600741729938727,  0.692820323027551,  0.153569489248257,  0.249505525113448,  -0.000000000000000, -0.000000000000000,
        -0.312750366249985, -0.405449435734056, -0.300370864969363, -0.346410161513775, -0.524022098779922, -0.524778191755280, -0.000000000000000,
        -0.000000000000000, -0.250067316600438, -0.603806510827318, -1.163331357712261, -1.341640786499874, -0.340185049053877, -0.816154441895411,
        -0.092336372611125, -0.065196691771772, -2.684189667375786, -1.384697833213687, -0.164716039416178, -0.038339419777940, -0.000000000000000,
        -0.000000000000000, 0.698758921060975,  0.788432064676939,  0.693054791987230,  0.357527443171074,  -0.622088629640037, -0.617890127831780,
        -0.000000000000000, -0.000000000000000, -1.319990814294474, -1.185336050051191, -0.297023482280241, -0.153226047073317, -0.228323204393321,
        -0.010767136762955, -0.000000000000000, -0.000000000000000, -0.022683280868901, -0.027251523804795, -1.150367000303908, -0.593441928520151,
        -0.032617751138933, -0.048599650146841, -0.809716173841177, -1.533623161014466, 0.033729734577951,  0.070686993031174,  -0.000000000000000,
        -0.000000000000000, 0.492639227670441,  0.730931082516425,  0.209067817096111,  0.395979797464467,  -0.328059583270829, -0.455417355094521,
        -0.000000000000000, -0.000000000000000, -0.593104471853524, -0.815138315505655, -0.089600493041190, -0.169705627484771, 0.164323800289803,
        0.339410557878026,  -0.000000000000000, -0.000000000000000, -0.008031685997141, -0.004284156531433, -0.347021217360504, -0.657267069006200,
        -0.000000000000000, -0.000000000000000, 0.557778930190566,  0.651215380770832,  -2.866829525219820, -2.416488049132818, 0.597702548134970,
        0.259030781098251,  -0.000000000000000, -0.000000000000000, 0.288371495757850,  -0.051141343518884, -1.110318300759208, -0.935901797060066,
        0.127426820080180,  -0.080761344645112, -0.000000000000000, -0.000000000000000, -0.174079334185853, -0.111170862481392, -1.433414762609910,
        -1.208244024566409, -0.147342061148908, 0.058134720453727,  -0.000000000000000, -0.000000000000000, -0.578702069007678, -0.470187383374556,
        -0.000000000000000, -0.000000000000000, 0.514351005992970,  0.751137488802011,  -1.899712152116142, -2.190890230020665, 0.390716214606096,
        0.156768874220101,  -0.000000000000000, -0.000000000000000, 0.057593391330407,  -0.101669202997390, -0.735755352773366, -0.848528137423857,
        0.009009931014160,  -0.136224816653305, -0.000000000000000, -0.000000000000000, -0.078736450076578, -0.162026122059872, -0.949856076058071,
        -1.095445115010332, 0.024284848542652,  0.045058800292770,  -0.000000000000000, -0.000000000000000, -0.425794374227888, -0.517751491606760,
        0.154649362971881,  0.225898246692945,  -0.000000000000000, -0.000000000000000, 0.179823648882966,  0.152024073016509,  -2.191631685973859,
        -1.130601046437006, 0.302020288033619,  0.084311250880046,  -0.000000000000000, -0.000000000000000, 0.157773533313726,  0.001578410965419,
        -0.727555973211192, -0.375325630633303, -0.122596547738858, 0.043821057739518,  -0.000000000000000, -0.000000000000000, -0.379176378290147,
        -0.188340068408734, -0.939270722560225, -0.484543305615860, -0.374383281273459, -0.346161374068581, -0.000000000000000, -0.000000000000000,
        0.150653043919427,  0.222601539059255,  -0.000000000000000, -0.000000000000000, 0.046137892234094,  0.036468585131816,  -0.661130487463201,
        -1.252198067399883, -0.035810452462622, -0.083012556633016, -0.000000000000000, -0.000000000000000, -0.089543839237760, -0.176302909410140,
        -0.219475488652711, -0.415692193816531, 0.149424508799343,  0.287130162077783,  -0.000000000000000, -0.000000000000000, -0.031821159717312,
        -0.018493386835508, -0.283341637484229, -0.536656314599950, -0.175287521170466, -0.240050788421345, -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.922652978171269, -0.627273604925696, -0.000000000000000, -0.000000000000000, -0.381828550029278,
        -0.178812240350105, 1.570227199484722,  1.323565014451697,  0.029474353477041,  0.024800551231269,  -0.000000000000000, -0.000000000000000,
        0.032521021863281,  0.062325604531639,  -3.140454398969443, -2.647130028903395, 0.164540681252948,  0.084356933708748,  -0.000000000000000,
        -0.000000000000000, -0.877839905293030, -0.371546148194085, -0.000000000000000, -0.000000000000000, -0.117683356720615, -0.062311659192122,
        -0.000000000000000, 0.000000000000000,  -0.617380301122013, -0.667535267289675, -0.000000000000000, -0.000000000000000, -0.216996486828957,
        -0.170356752759600, 1.040515198480697,  1.200000000000000,  -0.013674726993827, 0.070153685985279,  -0.000000000000000, -0.000000000000000,
        0.041006622505647,  0.076188099315940,  -2.081030396961393, -2.400000000000001, 0.152586474066068,  0.010140421063098,  -0.000000000000000,
        -0.000000000000000, -0.468533645182926, -0.348818544972637, -0.000000000000000, 0.000000000000000,  -0.068491317050056, -0.063370804016576,
        -0.681301233267170, -0.590499054289131, -0.000000000000000, 0.000000000000000,  -0.283294936115053, -0.215180545286515, -0.000000000000000,
        -0.000000000000000, 0.052909420917736,  0.014874617587455,  1.028919524700824,  0.530790597147852,  0.036869110811297,  0.057096563095876,
        -0.000000000000000, -0.000000000000000, 0.146868652347793,  0.163532152715610,  -2.400812224301923, -1.238511393344988, -0.635360906417294,
        -0.443282060054401, -0.000000000000000, -0.000000000000000, -0.064092881452676, -0.042219901688964, -0.000000000000000, 0.000000000000000,
        -0.278350952551119, -0.371264168141269, 0.000000000000000,  0.000000000000000,  -0.082296992751414, -0.099545818446520, -0.000000000000000,
        -0.000000000000000, 0.023922485090782,  0.052794163140889,  0.310385212661127,  0.587877538267963,  0.041122082863041,  0.062207322598847,
        -0.000000000000000, -0.000000000000000, 0.042783207967624,  0.015008741535538,  -0.724232162875964, -1.371714255958581, -0.159997183334981,
        -0.189889418807198, -0.000000000000000, -0.000000000000000, -0.014930767184026, -0.017742374000505, 0.000000000000000,  0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.145320131854442,  0.288098491790761,  1.433414762609910,  1.208244024566409,  -1.015156122392523,
        -0.272248737887662, -0.000000000000000, -0.000000000000000, -0.120201591418860, 0.220908331585302,  2.220636601518415,  1.871803594120131,
        -0.027613732851998, 0.176081654990981,  -0.000000000000000, -0.000000000000000, -0.405605535620235, 0.117186482470651,  -2.866829525219819,
        -2.416488049132819, 0.468443941196779,  0.241494644249909,  -0.000000000000000, -0.000000000000000, 1.086718008340776,  0.883045361934896,
        -0.000000000000000, -0.000000000000000, 0.195511836276431,  0.346994440208752,  0.949856076058071,  1.095445115010332,  -0.503263199831265,
        -0.149735841585574, -0.000000000000000, -0.000000000000000, 0.034064891030915,  0.351661193426601,  1.471510705546733,  1.697056274847714,
        0.051572591615533,  0.267839159126271,  -0.000000000000000, -0.000000000000000, -0.069917841747461, 0.210537152959000,  -1.899712152116142,
        -2.190890230020665, 0.346377009373116,  0.148705483384082,  -0.000000000000000, -0.000000000000000, 0.802769641068421,  0.969934490628461,
        -0.000525410453050, 0.085359782703269,  -0.000000000000000, -0.000000000000000, -0.711851345181316, -0.411917188130551, 0.939270722560225,
        0.484543305615860,  -0.185157901119025, -0.110968847432625, -0.000000000000000, -0.000000000000000, -0.063066984198546, 0.089917965114865,
        1.697630604159448,  0.875759804811040,  -0.424445311486820, -0.103731485244220, -0.000000000000000, -0.000000000000000, 0.072013325240672,
        0.104647692443089,  -2.191631685973859, -1.130601046437006, 0.632290980784413,  0.568137242227518,  -0.000000000000000, -0.000000000000000,
        0.081356933751298,  0.128653109363723,  -0.000000000000000, -0.000000000000000, -0.085490594157046, -0.056823154539973, 0.283341637484229,
        0.536656314599950,  -0.074162538646558, -0.132293774682864, -0.000000000000000, -0.000000000000000, 0.170202422864314,  0.316303476227972,
        0.512109473522994,  0.969948452238572,  0.080815266414326,  0.171902865549281,  -0.000000000000000, -0.000000000000000, 0.038380224046773,
        0.031871096354729,  -0.661130487463201, -1.252198067399883, 0.276555979367282,  0.372988170283940,  -0.000000000000000, -0.000000000000000,
        1.755567379083480,  1.479790672477243,  0.350216187964018,  0.645743621830360,  -0.000000000000000, -0.000000000000000, -0.219178800537608,
        0.240838026661216,  0.453285548155688,  0.382080308691829,  -0.466167489382613, -0.218002622418384, -0.000000000000000, -0.000000000000000,
        -0.864421375026697, -0.663143552491504, 0.906571096311375,  0.764160617383658,  0.037398331192733,  0.154305348971414,  -0.000000000000000,
        -0.000000000000000, 0.437962831019237,  0.310437211173738,  -3.511134758166959, -2.959581344954486, -0.218905464619071, -0.840757384542529,
        1.163331357712262,  1.341640786499874,  0.385406448975532,  0.851111991216412,  -0.000000000000000, -0.000000000000000, -0.003984483974314,
        0.415691340057270,  0.300370864969363,  0.346410161513775,  -0.261101070434319, -0.209622145665206, -0.000000000000000, -0.000000000000000,
        -0.617174145050338, -0.722138445535792, 0.600741729938727,  0.692820323027551,  0.085740306910662,  0.199948843325129,  -0.000000000000000,
        -0.000000000000000, 0.299285815746346,  0.333348758538937,  -2.326662715424523, -2.683281572999748, -0.398199437702308, -1.179004219452735,
        0.105872868067184,  0.088088837964280,  1.150367000303908,  0.593441928520152,  -0.286727844200436, -0.348179196040883, -0.000000000000000,
        -0.000000000000000, -0.273714261909630, -0.070742684223526, 0.297023482280241,  0.153226047073317,  -1.403319138976287, -1.297411148782676,
        -0.000000000000000, -0.000000000000000, 0.513205534882125,  0.663193178917010,  0.693054791987229,  0.357527443171074,  0.476626243198114,
        0.420679148737850,  -0.000000000000000, -0.000000000000000, 0.159150664759059,  0.112293477994165,  -2.684189667375785, -1.384697833213687,
        0.030728988401250,  0.031520904261677,  0.347021217360504,  0.657267069006200,  -0.293776106522436, -0.493005951632405, -0.000000000000000,
        -0.000000000000000, 0.060890967176483,  0.134577604380682,  0.089600493041190,  0.169705627484772,  -0.651197331251719, -0.888109836725050,
        -0.000000000000000, -0.000000000000000, 0.446349452247819,  0.674635001289340,  0.209067817096111,  0.395979797464467,  0.202461113455018,
        0.272178121603544,  -0.000000000000000, -0.000000000000000, 0.031981676659751,  0.028285947964306,  -0.809716173841177, -1.533623161014466};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 20, 28));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeDGForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 2);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix amomxmat(20, 36);

    CDenseMatrix amomymat(20, 36);

    CDenseMatrix amomzmat(20, 36);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, -0.570306553155949, -1.023561982541201, -0.000000000000000, -0.000000000000000, -0.670717382216275,
        -0.683065189857790, -0.000000000000000, -0.000000000000000, -1.249870284444213, -1.986645491779359, -0.000000000000000, -0.000000000000000,
        1.614522025836364,  1.310665898327770,  -0.000000000000000, -0.000000000000000, -0.242716769142929, 0.150046534311740,  -0.000000000000000,
        -0.000000000000000, 0.107737851048735,  -0.210106422588256, -0.000000000000000, -0.000000000000000, -0.609998478766252, -0.393532429931383,
        -0.000000000000000, -0.000000000000000, 0.043526057763308,  -0.361110305542244, -0.000000000000000, -0.000000000000000, -0.233764716048911,
        -0.602116735696226, -0.000000000000000, -0.000000000000000, -0.487282847861199, -1.175428610092683, -0.000000000000000, -0.000000000000000,
        -0.410251758521277, -0.720528055857113, -0.000000000000000, -0.000000000000000, -1.011657504379476, -2.218540110823146, -0.000000000000000,
        -0.000000000000000, 0.911259066426347,  1.270751269569510,  -0.000000000000000, -0.000000000000000, -0.008791614768873, 0.223518963640805,
        -0.000000000000000, 0.000000000000000,  -0.017213655801459, -0.314679389136257, -0.000000000000000, -0.000000000000000, -0.286932652901608,
        -0.385613573734052, 0.000000000000000,  -0.000000000000000, -0.079738704320132, -0.496015236838515, -0.000000000000000, -0.000000000000000,
        -0.257995359609402, -0.712274687293789, 0.502753557986765,  0.649294671459247,  0.000000000000001,  -0.000000000000000, 0.743366752399347,
        0.681318331911371,  0.000000000000000,  0.000000000000000,  1.003889947913636,  1.184527646646289,  0.000000000000000,  -0.000000000000000,
        -1.224015567337882, -1.083328132106276, -0.000000000000000, -0.000000000000000, 0.241796769057950,  0.183429591502101,  -0.000000000000000,
        -0.000000000000000, -0.283445487380162, -0.313842901789277, -0.000000000000000, -0.000000000000000, 0.547332081771313,  0.324099083975153,
        0.000000000000000,  -0.000000000000000, -0.041495574272322, 0.069503512788302,  -0.000000000000000, -0.000000000000000, 0.091817292712964,
        0.225798363870296,  0.000000000000000,  0.000000000000000,  0.299186002388756,  0.516796190851908,  -0.000000000000000, -0.000000000000000,
        0.213385603589915,  0.325448917054183,  0.000000000000000,  -0.000000000000000, 0.470312571151825,  0.773079749238022,  -0.000000000000000,
        -0.000000000000000, -0.317763836669627, -0.469868876107570, -0.000000000000000, -0.000000000000000, 0.054773286946975,  0.085334078871520,
        -0.000000000000000, -0.000000000000000, -0.118047732662313, -0.190405425268145, -0.000000000000000, -0.000000000000000, 0.036292228361199,
        0.019226318800411,  -0.000000000000000, -0.000000000000000, 0.099482839338646,  0.205540957106216,  0.000000000000000,  -0.000000000000000,
        0.142163529179389,  0.261807038075275,  0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.426081915248715,
        0.337629958933001,  -0.000000000000000, -0.000000000000000, 0.402702279198328,  -0.215516602554180, -0.000000000000000, -0.000000000000000,
        0.676110722206274,  0.049432234359247,  -0.000000000000000, -0.000000000000000, -0.180352053523216, -1.700093698201993, 0.000000000000000,
        0.000000000000000,  -1.274564301973358, -1.275020400313969, -0.000000000000000, -0.000000000000000, -0.610864628742562, -0.466416458101752,
        -0.000000000000000, -0.000000000000000, -1.276853133962898, -1.276068081549995, -0.000000000000000, -0.000000000000000, -0.508971900555857,
        -0.483313108488190, -0.000000000000000, -0.000000000000000, -0.412202154307038, -0.236293333740514, -0.000000000000000, -0.000000000000000,
        0.253814065865535,  0.303722727833426,  -0.000000000000000, -0.000000000000000, 0.076046886063311,  -0.397768687396875, -0.000000000000000,
        -0.000000000000000, 0.202755700035875,  -0.074713049649111, -0.000000000000000, -0.000000000000000, -0.550356268274738, -2.171332728512369,
        0.000000000000000,  0.000000000000000,  -0.718366995174680, -1.412801093086334, -0.000000000000000, -0.000000000000000, -0.295356379218522,
        -0.500514629890083, -0.000000000000000, 0.000000000000000,  -0.745010672472157, -1.377931519428285, -0.000000000000000, -0.000000000000000,
        -0.261837995903535, -0.553130247540604, -0.000000000000000, 0.000000000000000,  -0.197303969852530, -0.205707740956291, -0.385693080050182,
        -0.453210231836015, -0.000000000000000, 0.000000000000000,  -0.543853916927826, -0.465318904683951, 0.000000000000001,  -0.000000000000000,
        -0.633312074295581, -0.391792640823418, 0.000000000000000,  0.000000000000000,  0.039343366209578,  0.247997020583833,  0.000000000000001,
        -0.000000000000000, 1.203076583302324,  0.816412420556067,  0.000000000000000,  0.000000000000000,  0.911346913615286,  0.672014170421062,
        0.000000000000000,  0.000000000000000,  1.184918589423015,  1.038812910742372,  -0.000000000000000, -0.000000000000000, 0.537117718332511,
        0.347395691397273,  0.000000000000000,  0.000000000000000,  0.465340560684730,  0.418541431243923,  -0.000000000000000, -0.000000000000000,
        -0.170184430169309, -0.272661083976382, -0.000000000000000, -0.000000000000000, -0.111581411005556, -0.144621324588095, -0.000000000000000,
        -0.000000000000000, -0.069219078121652, -0.079039281520965, 0.000000000000000,  -0.000000000000000, 0.189907486705916,  0.363325075750913,
        -0.000000000000000, -0.000000000000000, 0.168667096556366,  0.214474358399743,  0.000000000000000,  0.000000000000001,  0.134377919167185,
        0.159437417160440,  0.000000000000000,  -0.000000000000000, 0.336620447813822,  0.527298046543720,  0.000000000000000,  -0.000000000000000,
        0.083635055091061,  0.121242919446368,  0.000000000000000,  -0.000000000000000, 0.127712216975010,  0.192612502586680,  0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.579392135419206, -0.339827508534084, -0.000000000000000, -0.000000000000000,
        -0.457252600947600, -0.240015491751069, -0.000000000000000, -0.000000000000000, -0.796275733415174, 0.081549898982951,  0.000000000000000,
        -0.000000000000000, -0.591353672812757, 1.148542405743406,  -0.000000000000000, -0.000000000000000, 0.726683809596864,  -0.514467425056994,
        -0.000000000000000, -0.000000000000000, -0.356823583640382, -0.005142258662388, -0.000000000000000, -0.000000000000000, 0.080132787627213,
        -0.459793748204905, -0.000000000000000, -0.000000000000000, -0.462950934853586, -0.266093033326393, -0.000000000000000, -0.000000000000000,
        -0.097272056437835, -0.058940373305837, -0.000000000000000, -0.000000000000000, -0.273894488275992, -0.307023943135719, -0.000000000000000,
        -0.000000000000000, -0.198068429163515, -0.219524646297737, -0.000000000000000, -0.000000000000000, -0.205425951215743, 0.273349293463781,
        -0.000000000000000, 0.000000000000000,  0.244578590575168,  1.508245395602413,  -0.000000000000000, -0.000000000000000, 0.147297606447641,
        -0.943625661081550, -0.000000000000000, -0.000000000000000, -0.037185044618892, -0.023492413982845, -0.000000000000000, -0.000000000000000,
        -0.083194688753891, -0.651710804417365, -0.000000000000000, -0.000000000000000, -0.199313046665572, -0.261620711690548, -0.000000000000000,
        -0.000000000000000, -0.046493627892604, -0.053882226987960, 0.639376396501063,  0.547969507843538,  0.000000000000000,  -0.000000000000000,
        0.558278399919254,  0.406398271919425,  -0.000000000000000, -0.000000000000000, 0.661443406294741,  0.380579600640854,  -0.000000000000000,
        -0.000000000000000, 0.715573518020547,  0.122373794619066,  0.000000000000001,  -0.000000000000000, -0.809314248536637, -0.684712128406405,
        0.000000000000000,  -0.000000000000000, 0.243089262488264,  -0.097079598075650, 0.000000000000000,  0.000000000000000,  0.036988373105644,
        -0.029544462671949, 0.000000000000001,  -0.000000000000000, 0.639583752641668,  0.496680768634188,  -0.000000000000000, -0.000000000000000,
        0.085420676406656,  0.079113082125371,  0.000000000000000,  -0.000000000000000, 0.153225910906042,  0.222095566944769,  -0.000000000000000,
        -0.000000000000000, 0.087774279798377,  0.112027228843938,  0.000000000000000,  0.000000000000000,  0.057491286400490,  0.061656719265143,
        -0.000000000000000, -0.000000000000000, -0.113727836601033, -0.242350578609364, 0.000000000000000,  0.000000000000000,  -0.094741342370482,
        -0.049364754780429, -0.000000000000000, -0.000000000000000, -0.085961153484947, -0.142064764040028, 0.000000000000000,  -0.000000000000000,
        -0.027962104764386, -0.052185182731932, -0.000000000000000, -0.000000000000000, 0.111901587130376,  0.142694429055188,  -0.000000000000000,
        -0.000000000000000, 0.023991995261368,  0.035706631469712,  -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000,
        0.145567962499722,  0.155198795844946,  -0.000000000000000, -0.000000000000000, -0.144684931515395, 0.491224860606591,  -0.000000000000000,
        -0.000000000000000, 0.804499011797157,  1.395774570054763,  -0.000000000000000, -0.000000000000000, -0.812100602876461, -0.521920728257356,
        -0.000000000000000, -0.000000000000000, -0.528525364481484, 0.136656355904969,  -0.000000000000000, -0.000000000000000, 0.389714196229946,
        -0.425423124123380, -0.000000000000000, -0.000000000000000, 0.845423398089624,  0.716933496126615,  -0.000000000000000, -0.000000000000000,
        0.412046845330633,  -0.153280839639259, -0.000000000000000, -0.000000000000000, 0.700739104581290,  0.424792275773892,  -0.000000000000000,
        0.000000000000000,  0.105674487708566,  0.145660846116582,  -0.000000000000000, -0.000000000000000, 0.130523294325895,  0.629977762177920,
        0.000000000000000,  -0.000000000000000, 0.692081478237824,  1.568046608132682,  -0.000000000000000, -0.000000000000000, -0.386548747662046,
        -0.506455764876031, -0.000000000000000, -0.000000000000000, -0.078683060236300, 0.245114450691280,  -0.000000000000000, -0.000000000000000,
        0.041795026647208,  -0.710783295711774, -0.000000000000000, -0.000000000000000, 0.532028292109139,  0.644129007563637,  -0.000000000000000,
        -0.000000000000000, 0.108469617473225,  -0.333330917219988, -0.000000000000000, -0.000000000000000, 0.350502209035564,  0.368943482814719,
        -0.178409786174837, -0.223040973090082, -0.000000000000000, -0.000000000000000, 0.220303035261656,  0.045488465569227,  -0.000000000000000,
        -0.000000000000000, -0.650159840674527, -0.809106695344275, 0.000000000000001,  0.000000000000000,  0.677121516309835,  0.489200687626853,
        0.000000000000000,  0.000000000000000,  0.804788549924149,  0.525227589723292,  -0.000000000000000, -0.000000000000000, -0.509454577930375,
        -0.347095910602949, 0.000000000000000,  -0.000000000000000, -0.764300344128412, -0.777823938469361, 0.000000000000000,  0.000000000000000,
        -0.553456685808442, -0.504431210671859, 0.000000000000001,  -0.000000000000000, -0.693281039227559, -0.666183268268798, -0.000000000000000,
        -0.000000000000000, -0.085157658018173, -0.136393737776795, -0.000000000000000, -0.000000000000000, -0.036565477977935, -0.081572507008606,
        -0.000000000000000, -0.000000000000000, -0.326184441760079, -0.534479742251267, 0.000000000000000,  -0.000000000000000, 0.113706176680323,
        0.155476660503140,  0.000000000000000,  -0.000000000000000, 0.086890632765200,  0.089754048312506,  -0.000000000000000, -0.000000000000000,
        0.020311826488185,  0.128130569343435,  -0.000000000000000, -0.000000000000000, -0.223103489001163, -0.314792748372335, 0.000000000000000,
        -0.000000000000000, -0.127656093727244, -0.169794646740141, -0.000000000000000, -0.000000000000000, -0.216862495473263, -0.334375619282252,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.263837095011304,  0.613718481470981,  0.000000000000000,
        0.000000000000000,  -0.443624111501277, 0.209930973184170,  -0.000000000000000, -0.000000000000000, -0.646919941613215, -0.229400165393668,
        0.000000000000000,  0.000000000000000,  -1.219405645337672, -0.489035621585949, -0.000000000000000, -0.000000000000000, -1.046577701679201,
        -1.123452206200403, -0.000000000000000, -0.000000000000000, 0.160689151248424,  0.220881670412650,  -0.000000000000000, -0.000000000000000,
        -1.360891375132490, -2.051272327654599, -0.000000000000000, -0.000000000000000, -0.245240953191926, -0.517893947554715, -0.000000000000000,
        -0.000000000000000, -0.403494229282155, -0.963290861716229, -0.000000000000000, -0.000000000000000, 0.269626581947255,  0.721548300506853,
        -0.000000000000000, -0.000000000000000, -0.071061504188267, 0.373938436126334,  -0.000000000000000, -0.000000000000000, -0.254951062100805,
        -0.157172854826156, 0.000000000000000,  0.000000000000000,  -0.528046824927714, -0.328167928626378, -0.000000000000000, -0.000000000000000,
        -0.686084277474992, -1.159436635834255, -0.000000000000000, -0.000000000000000, 0.125872277523269,  0.232478600267746,  -0.000000000000000,
        -0.000000000000000, -1.062115876216328, -2.278374298739946, -0.000000000000000, -0.000000000000000, -0.246919475878725, -0.586769278066991,
        -0.000000000000000, -0.000000000000000, -0.425420229589638, -1.127723041164606, -0.120929112911004, -0.245635265822746, -0.000000000000000,
        -0.000000000000000, 0.418336096168250,  0.165585507406119,  0.000000000000000,  -0.000000000000000, 0.512730853598223,  0.381912584446900,
        -0.000000000000000, 0.000000000000000,  1.104596081539293,  0.944415342719867,  0.000000000000000,  0.000000000000000,  0.670757472551865,
        0.611895687167400,  0.000000000000000,  -0.000000000000000, -0.112939822776933, -0.228459239455096, -0.000000000000000, -0.000000000000000,
        1.121060527017821,  1.254325860852381,  0.000000000000000,  -0.000000000000000, 0.353301299057954,  0.432276740076187,  0.000000000000000,
        0.000000000000000,  0.338547942307181,  0.542188179035029,  0.000000000000001,  -0.000000000000000, -0.146284711265319, -0.267099237668186,
        -0.000000000000000, -0.000000000000000, -0.055062188564595, -0.150807395886531, 0.000000000000000,  0.000000000000000,  0.111068727730295,
        0.171520131405675,  0.000000000000000,  -0.000000000000000, 0.271756220335540,  0.401206279996259,  -0.000000000000000, -0.000000000000000,
        0.165981519253374,  0.231675413668918,  -0.000000000000000, -0.000000000000000, -0.108261335967757, -0.182680270913245, -0.000000000000000,
        -0.000000000000000, 0.483985056007151,  0.790555510931245,  -0.000000000000000, -0.000000000000000, 0.165383610614263,  0.265853185260645,
        0.000000000000000,  -0.000000000000000, 0.277606365528841,  0.489348665953124,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 20, 36));

    std::vector<double> intyvals{
        -0.000000000000000, -0.000000000000000, -0.393167501361362, -0.722746983127762, -0.000000000000000, -0.000000000000000, -0.319405459492701,
        -0.852622051905114, -0.000000000000000, -0.000000000000000, 0.201048926099353,  0.970933519894820,  0.000000000000000,  0.000000000000000,
        -0.096653517288908, 0.344633473563571,  -0.000000000000000, -0.000000000000000, -0.704435547383442, -0.951478245408478, -0.000000000000000,
        -0.000000000000000, -1.959596538481511, -1.442804993707949, -0.000000000000000, -0.000000000000000, -0.179656413935957, -0.214907023790586,
        -0.000000000000000, -0.000000000000000, -0.314693095251941, -0.549258885852235, -0.000000000000000, -0.000000000000000, 0.478500446834472,
        0.945214864023396,  -0.000000000000000, -0.000000000000000, -0.345772293860012, -0.826008919183932, 0.000000000000000,  -0.000000000000000,
        -0.341676993243417, -1.038912123492121, -0.000000000000000, -0.000000000000000, 0.394941059721813,  1.145723034613536,  0.000000000000000,
        -0.000000000000000, 0.069762505805406,  0.472416652786877,  -0.000000000000000, -0.000000000000000, -0.536712015306779, -1.009741539735937,
        -0.000000000000000, -0.000000000000000, -1.048341518478162, -1.371242684204022, -0.000000000000000, -0.000000000000000, -0.108538126590162,
        -0.248908929397986, -0.000000000000000, -0.000000000000000, -0.282093705240585, -0.604137910701124, -0.000000000000000, -0.000000000000000,
        0.433047240685504,  1.100034077198242,  0.430026639417535,  0.543393715352056,  0.000000000000000,  0.000000000000000,  0.381685650471150,
        0.502540683617116,  -0.000000000000000, -0.000000000000000, -0.144283473959089, -0.419787077612522, -0.000000000000000, -0.000000000000000,
        0.264653569967148,  0.180797009914166,  0.000000000000000,  0.000000000000000,  0.417322237305672,  0.429603400878128,  0.000000000000000,
        -0.000000000000000, 1.459902242179633,  1.244057851127956,  0.000000000000000,  -0.000000000000000, 0.190700949108379,  0.065769629129978,
        -0.000000000000000, -0.000000000000000, 0.430263167974593,  0.499326067130893,  0.000000000000000,  -0.000000000000000, -0.364513296907306,
        -0.514218024299074, -0.000000000000001, -0.000000000000000, 0.237634602144153,  0.403194011305525,  0.000000000000000,  -0.000000000000000,
        0.252415713829295,  0.448800885149912,  -0.000000000000000, -0.000000000000000, -0.217810496724991, -0.373623653179385, -0.000000000000000,
        -0.000000000000000, 0.037400663579436,  0.047666436438180,  0.000000000000000,  0.000000000000000,  0.124321105475823,  0.175669974076513,
        -0.000000000000000, -0.000000000000000, 0.346442327599999,  0.502058275982484,  -0.000000000000000, -0.000000000000000, -0.033558994060987,
        -0.085233670472820, -0.000000000000000, -0.000000000000000, 0.177372461876746,  0.276655517168077,  -0.000000000000000, -0.000000000000000,
        -0.257062303124753, -0.453705400058555, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.321471739060492,
        -0.182341493631878, -0.000000000000000, -0.000000000000000, 0.257452827012207,  0.110774575271531,  0.000000000000000,  0.000000000000000,
        -0.225948170471505, -0.778336551037292, -0.000000000000000, -0.000000000000000, 0.160788802645282,  0.316206588144175,  -0.000000000000000,
        -0.000000000000000, 0.382731723511611,  -0.224602009150747, -0.000000000000000, -0.000000000000000, 0.517651097841926,  0.658308831751952,
        -0.000000000000000, -0.000000000000000, 0.327648239180049,  0.457295773019949,  -0.000000000000000, -0.000000000000000, -0.401189323343188,
        0.209452678559083,  -0.000000000000000, -0.000000000000000, -0.490108775324251, -0.390925232055705, -0.000000000000000, 0.000000000000000,
        -0.154383648553573, -0.156573457878134, -0.000000000000000, -0.000000000000000, 0.162808410624336,  0.012174354871431,  -0.000000000000000,
        -0.000000000000000, -0.268290207737718, -0.996863600856856, -0.000000000000000, -0.000000000000000, 0.091926646132813,  0.439475602109394,
        -0.000000000000000, -0.000000000000000, 0.002696577963878,  -0.316408109222614, -0.000000000000000, -0.000000000000000, 0.369739361956797,
        0.705737420440340,  -0.000000000000000, -0.000000000000000, 0.297869126087008,  0.429335203125279,  -0.000000000000000, -0.000000000000000,
        -0.078290619972616, 0.390883796264238,  -0.000000000000000, -0.000000000000000, -0.290576919871134, -0.355232772344858, 0.304803354081787,
        0.286289493672151,  -0.000000000000000, -0.000000000000000, -0.344991568238098, -0.430422414785012, 0.000000000000000,  0.000000000000000,
        0.143218020622855,  0.205303706950464,  -0.000000000000000, -0.000000000000000, -0.154160904272990, -0.081967341659285, -0.000000000000000,
        -0.000000000000000, -0.633844728607037, -0.374580423512758, 0.000000000000000,  -0.000000000000000, -0.195919301919591, -0.204075864659280,
        -0.000000000000000, -0.000000000000000, -0.184169966723791, -0.305992323866444, 0.000000000000000,  -0.000000000000000, 0.546542365572349,
        0.481330521001241,  -0.000000000000001, -0.000000000000000, 0.528267725052515,  0.580532732899472,  0.000000000000000,  -0.000000000000000,
        0.091805553481675,  0.141011230425408,  -0.000000000000000, -0.000000000000000, -0.142064828720988, -0.210175771063669, 0.000000000000000,
        -0.000000000000000, 0.133466734767491,  0.254572388456140,  -0.000000000000000, 0.000000000000000,  -0.054964738509976, -0.114783975316014,
        -0.000000000000000, -0.000000000000000, -0.050145274860961, -0.042224942624950, -0.000000000000000, -0.000000000000000, -0.074173708898834,
        -0.118825517509865, -0.000000000000000, -0.000000000000000, -0.107422976107957, -0.158734896220591, -0.000000000000000, -0.000000000000000,
        0.119702433277141,  0.158103847659459,  -0.000000000000000, -0.000000000000000, 0.207643436140016,  0.327915060115430,  -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.149158785351737, -0.079581627679622, -0.000000000000000, -0.000000000000000,
        -0.837806371621871, -0.452132775355743, -0.000000000000000, -0.000000000000000, 0.272472182556747,  -0.373574205852204, -0.000000000000000,
        -0.000000000000000, 0.380162164556850,  0.142141833332747,  -0.000000000000000, -0.000000000000000, -0.324290342610150, 0.417862206004350,
        -0.000000000000000, -0.000000000000000, 0.309559740390085,  -1.061494571515155, -0.000000000000000, -0.000000000000000, -0.491003228008975,
        -0.483066016337928, -0.000000000000000, -0.000000000000000, 0.082091778744253,  0.071642531737119,  -0.000000000000000, -0.000000000000000,
        0.568021921305511,  0.338164411536735,  -0.000000000000000, -0.000000000000000, -0.066967679343910, -0.070453290465680, -0.000000000000000,
        -0.000000000000000, -0.364161121248266, -0.421123425350719, -0.000000000000000, -0.000000000000000, -0.007539681341158, -0.575833721510490,
        -0.000000000000000, -0.000000000000000, 0.108493403580870,  0.160763244215592,  -0.000000000000000, -0.000000000000000, -0.008182588447774,
        0.662621448146147,  -0.000000000000000, -0.000000000000000, -0.228027221782926, -1.436308520432952, -0.000000000000000, -0.000000000000000,
        -0.250041718748526, -0.566792180915148, -0.000000000000000, -0.000000000000000, 0.043773759461388,  0.076955262640756,  -0.000000000000000,
        -0.000000000000000, 0.271267994122254,  0.306008595220642,  0.188673943938814,  0.149116386584672,  0.000000000000000,  -0.000000000000000,
        1.053735912323136,  0.782827730417524,  -0.000000000000000, -0.000000000000000, -0.128386149405967, -0.123816043098845, 0.000000000000001,
        -0.000000000000000, -0.283567181588042, -0.040456183442412, -0.000000000000000, -0.000000000000000, 0.348999595317262,  0.277299652508352,
        -0.000000000000000, -0.000000000000000, -0.539984412013514, -0.294963980694148, -0.000000000000000, -0.000000000000000, 0.522378917511831,
        0.245135574350462,  0.000000000000000,  0.000000000000000,  -0.146251301308133, -0.140378273356023, -0.000000000000000, -0.000000000000000,
        -0.635839714112691, -0.548561269699406, -0.000000000000000, 0.000000000000000,  0.038485699761476,  0.054299145579760,  -0.000000000000000,
        -0.000000000000000, 0.171470617747430,  0.219056372612215,  -0.000000000000000, -0.000000000000000, -0.045862346560244, -0.074887286212461,
        -0.000000000000000, -0.000000000000000, 0.026783524861749,  0.050550877218196,  -0.000000000000000, -0.000000000000000, 0.033565689788854,
        0.010551387125766,  -0.000000000000000, -0.000000000000000, 0.002641789614780,  0.062954017361454,  -0.000000000000000, -0.000000000000000,
        0.013098207920496,  -0.008539288635325, 0.000000000000000,  -0.000000000000000, -0.035616853781527, -0.046704395298347, 0.000000000000000,
        0.000000000000000,  -0.153770563983889, -0.222960555925847, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000,
        0.748763996817820,  0.474024137802538,  -0.000000000000000, -0.000000000000000, 0.127278008831152,  -0.261074049526662, -0.000000000000000,
        -0.000000000000000, -0.947850985631809, -0.025581299921098, -0.000000000000000, -0.000000000000000, 0.215797136641078,  0.575052426518546,
        -0.000000000000000, -0.000000000000000, 0.736930737592206,  1.330270261404257,  -0.000000000000000, -0.000000000000000, -0.179068523521450,
        1.096601183508277,  -0.000000000000000, -0.000000000000000, -0.423435611385943, -1.065875553466037, -0.000000000000000, -0.000000000000000,
        0.972155493692215,  0.141168295491608,  -0.000000000000000, -0.000000000000000, -0.044075559957700, -0.093437828983611, -0.000000000000000,
        -0.000000000000000, 0.382448192342930,  0.417448812518213,  -0.000000000000000, -0.000000000000000, -0.001820498540472, -0.417983269127815,
        -0.000000000000000, -0.000000000000000, -0.248782264028981, 0.125616224398913,  -0.000000000000000, -0.000000000000000, 0.232950809291511,
        0.696825717961417,  -0.000000000000000, -0.000000000000000, 0.602140123462814,  1.569534029641511,  -0.000000000000000, -0.000000000000000,
        0.302841979528580,  1.416541946914065,  -0.000000000000000, 0.000000000000000,  -0.431060214832068, -1.297469908983231, -0.000000000000000,
        -0.000000000000000, 0.327329600477134,  -0.032353311809293, -0.000000000000000, -0.000000000000000, -0.056213226887147, -0.089862825668869,
        -0.811548338514484, -0.779564596065347, -0.000000000000000, -0.000000000000000, -0.232321619261071, -0.295493798849041, 0.000000000000001,
        -0.000000000000000, 0.912053785363682,  0.494846411340139,  -0.000000000000000, -0.000000000000000, -0.547257397877767, -0.478296088850594,
        -0.000000000000000, -0.000000000000000, -0.418456910820791, -0.278291318312967, -0.000000000000000, -0.000000000000000, 0.325091906469180,
        0.035474195136270,  -0.000000000000000, -0.000000000000000, 0.326257616563680,  0.422083520334737,  -0.000000000000000, -0.000000000000000,
        -1.174456852438329, -0.889217974453614, 0.000000000000000,  0.000000000000000,  -0.010735089579303, 0.067430393207884,  -0.000000000000000,
        0.000000000000000,  -0.251793540079292, -0.386527952617378, -0.000000000000000, -0.000000000000000, -0.088439866453062, -0.122252341117862,
        -0.000000000000000, -0.000000000000000, 0.063905303672325,  0.057965814213935,  -0.000000000000000, -0.000000000000000, -0.105181322629128,
        -0.124766652495813, -0.000000000000000, -0.000000000000000, -0.071761330649207, -0.107993247680950, -0.000000000000000, -0.000000000000001,
        -0.079574405795229, -0.169257698885127, -0.000000000000000, -0.000000000000000, 0.205073157309042,  0.360924495788580,  0.000000000000000,
        -0.000000000000000, -0.205190803325416, -0.271392748805826, 0.000000000000000,  -0.000000000000000, 0.043855117116519,  0.077650159201019,
        -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.318927791788188, -0.886232432964204, -0.000000000000000,
        -0.000000000000000, 0.709582353347158,  0.705748842583694,  -0.000000000000000, -0.000000000000000, -0.235038608206401, 0.031291373015986,
        -0.000000000000000, -0.000000000000000, -0.204840608655064, 0.002771117126671,  -0.000000000000000, -0.000000000000000, -1.428049721823365,
        -1.194949956435567, 0.000000000000000,  0.000000000000000,  0.262489499978718,  0.710041273326284,  -0.000000000000000, -0.000000000000000,
        1.492944210090222,  1.618519981276494,  -0.000000000000000, -0.000000000000000, 0.115468424711051,  -0.683186113982771, -0.000000000000000,
        -0.000000000000000, -0.424270774290385, -0.734532232117380, -0.000000000000000, -0.000000000000000, -0.373006394050730, -1.053185146913689,
        -0.000000000000000, -0.000000000000000, 0.435624148565870,  0.731317110512829,  -0.000000000000000, -0.000000000000000, -0.060565740388957,
        0.093752148963859,  -0.000000000000000, -0.000000000000000, -0.046499634408158, 0.031569174504636,  -0.000000000000000, -0.000000000000000,
        -0.810991169065209, -1.178729959919240, 0.000000000000000,  0.000000000000000,  0.307206751612762,  0.833731706673113,  -0.000000000000000,
        -0.000000000000000, 0.957610859944999,  1.709502757957802,  0.000000000000000,  0.000000000000000,  -0.174278489284148, -0.901684202882914,
        -0.000000000000000, -0.000000000000000, -0.357662927703236, -0.835404513613297, 0.208318554574905,  0.410808098642796,  0.000000000000001,
        -0.000000000000000, -0.795006211084065, -0.734637154238244, -0.000000000000000, -0.000000000000000, 0.138799106848745,  0.152489879837598,
        -0.000000000000000, -0.000000000000000, 0.151607121522388,  -0.000040707242522, -0.000000000000000, -0.000000000000000, 0.983374923944985,
        0.853485608407360,  0.000000000000000,  0.000000000000000,  -0.009848339115083, -0.060820783833427, 0.000000000000000,  0.000000000000000,
        -1.218616999507515, -1.148841433355010, -0.000000000000000, -0.000000000000000, -0.013361496431543, 0.249127782166980,  -0.000000000000000,
        -0.000000000000000, 0.460279169390815,  0.563756990605427,  0.000000000000000,  0.000000000000000,  0.236003082110529,  0.426828967588787,
        -0.000000000000000, -0.000000000000000, -0.223017032319156, -0.333418376673317, -0.000000000000000, -0.000000000000000, 0.078605754992657,
        0.143207048435076,  -0.000000000000000, -0.000000000000000, -0.041612885705455, -0.083545530285932, -0.000000000000000, -0.000000000000000,
        0.231405122606994,  0.327651097266197,  0.000000000000000,  -0.000000000000000, -0.027930994000689, -0.044475914192720, -0.000000000000000,
        -0.000000000000000, -0.371829820370859, -0.573655088841867, -0.000000000000000, -0.000000000000000, 0.203356805916278,  0.387784692087480,
        -0.000000000000000, -0.000000000000000, 0.241829888939600,  0.408567531709303,  0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 20, 36));

    std::vector<double> intzvals{
        -0.000000000000000, -0.000000000000000, 0.654235729218497,  1.145504692871084,  -0.000000000000000, -0.000000000000000, 0.723413825972723,
        1.305168540970296,  -0.000000000000000, -0.000000000000000, 0.237371857298468,  -0.007921341582753, -0.000000000000000, -0.000000000000000,
        -0.141382600564655, -0.179760507442849, -0.000000000000000, -0.000000000000000, 0.354524200454582,  0.357255254666303,  -0.000000000000000,
        -0.000000000000000, 0.896470196334181,  0.585141507511306,  -0.000000000000000, -0.000000000000000, 0.263398814890166,  0.332082030037828,
        -0.000000000000000, -0.000000000000000, 0.405457883872330,  0.837460231590603,  -0.000000000000000, -0.000000000000000, -0.320280954475902,
        -0.559108216370182, -0.000000000000000, -0.000000000000000, 0.555660681666655,  1.304311786932622,  -0.000000000000000, -0.000000000000000,
        0.611000855979898,  1.512400617893575,  -0.000000000000000, -0.000000000000000, 0.051339958335197,  -0.040396262593122, -0.000000000000000,
        -0.000000000000000, -0.097323281821921, -0.197260896611506, -0.000000000000000, -0.000000000000000, 0.229477824973462,  0.357047254552370,
        -0.000000000000000, -0.000000000000000, 0.448768977410885,  0.542430586376302,  -0.000000000000000, -0.000000000000000, 0.167313154644788,
        0.382579243388645,  -0.000000000000000, -0.000000000000000, 0.389146330670515,  0.963587756850334,  -0.000000000000000, -0.000000000000000,
        -0.267344845180717, -0.642125990808413, -0.224047019838728, -0.284253111510275, -0.000000000000001, -0.000000000000000, -0.159653317993483,
        -0.104957879318611, -0.000000000000000, -0.000000000000000, -0.262221196416634, -0.106414272931839, 0.000000000000000,  0.000000000000000,
        0.604024315308206,  0.712463126525880,  -0.000000000000000, -0.000000000000000, -0.624801933454383, -0.643356410745989, -0.000000000000000,
        -0.000000000000000, -1.432697333445856, -1.317651625220232, -0.000000000000000, -0.000000000000000, -0.376256689079680, -0.157556477507707,
        0.000000000000000,  -0.000000000000000, -0.037960369455757, -0.043796981242943, -0.000000000000000, -0.000000000000000, 0.144148149650722,
        0.183561594867171,  0.000000000000000,  -0.000000000000000, -0.126897896324720, -0.216950838245792, -0.000000000000000, -0.000000000000000,
        -0.029560465698792, -0.046849659423220, -0.000000000000000, -0.000000000000000, 0.005775030361714,  0.026930841728748,  0.000000000000000,
        -0.000000000000000, 0.291187762949399,  0.484003637307982,  -0.000000000000000, -0.000000000000000, -0.214447820318468, -0.330160272524102,
        0.000000000000000,  -0.000000000000000, -0.412003226641555, -0.627391355446929, -0.000000000000000, -0.000000000000000, 0.036816532895639,
        0.108831941356071,  -0.000000000000000, 0.000000000000000,  -0.007130564222774, -0.004129891342982, -0.000000000000000, -0.000000000000000,
        0.088248226117359,  0.155050293436831,  0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.065399266756818,
        -0.000894249260722, -0.000000000000000, -0.000000000000000, -0.533774757019808, -0.240452561022199, -0.000000000000000, -0.000000000000000,
        -0.127999502982320, 0.523533471262415,  -0.000000000000000, -0.000000000000000, -0.072716034922768, 0.195056863058281,  -0.000000000000000,
        -0.000000000000000, 0.033392778513093,  0.244500475924154,  0.000000000000000,  0.000000000000000,  0.095046671700615,  0.055679646486336,
        -0.000000000000000, -0.000000000000000, 0.203460389429116,  0.207248561125733,  0.000000000000000,  0.000000000000000,  0.578425898209542,
        0.175210732988902,  -0.000000000000000, -0.000000000000000, 0.610986216432858,  0.517614055732284,  -0.000000000000000, -0.000000000000000,
        0.013101397822130,  -0.007808083406147, -0.000000000000000, -0.000000000000000, -0.278948921125095, -0.123373849473737, -0.000000000000000,
        -0.000000000000000, 0.100949183362271,  0.729880608260067,  -0.000000000000000, -0.000000000000000, 0.064856105755175,  0.231275227156976,
        -0.000000000000000, -0.000000000000000, 0.093434388483203,  0.293425050393803,  -0.000000000000000, 0.000000000000000,  0.030594809114399,
        0.070824354644489,  -0.000000000000000, -0.000000000000000, 0.075125617843503,  0.285127459855948,  0.000000000000000,  -0.000000000000000,
        0.231203274335991,  0.085040349526653,  -0.000000000000000, -0.000000000000000, 0.360484118612406,  0.496580342872113,  -0.107522197307164,
        -0.072581222260107, -0.000000000000000, -0.000000000000000, 0.150859014090185,  0.173680499806585,  -0.000000000000000, -0.000000000000000,
        0.035279429126011,  -0.053363558166748, -0.000000000000000, -0.000000000000000, 0.063057783612097,  -0.121496954817336, -0.000000000000000,
        0.000000000000000,  -0.104724160097212, -0.275096839977818, -0.000000000000000, -0.000000000000000, 0.147113932954502,  0.294130497071082,
        0.000000000000000,  0.000000000000000,  -0.237031538551957, -0.053450678151588, -0.000000000000000, -0.000000000000000, -0.394090406138142,
        -0.268675435016025, 0.000000000000000,  -0.000000000000000, -0.354737415622452, -0.354838184292836, -0.000000000000000, -0.000000000000000,
        -0.015520993608347, -0.020329751641981, -0.000000000000000, -0.000000000000000, 0.033710523106975,  0.029852878332340,  -0.000000000000000,
        -0.000000000000000, -0.069223237280500, -0.141644496238579, -0.000000000000000, -0.000000000000000, -0.086499731508672, -0.154183484771318,
        0.000000000000000,  -0.000000000000000, -0.165150945675780, -0.299030996753405, -0.000000000000000, -0.000000000000000, 0.164891388584115,
        0.295113401026704,  -0.000000000000000, 0.000000000000000,  0.012689342959864,  0.026694758075500,  -0.000000000000000, -0.000000000000000,
        -0.039552753383153, -0.032192980383739, -0.000000000000000, 0.000000000000000,  -0.112126441041301, -0.168478495813055, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.355397723376088,  0.212047673356175,  -0.000000000000000, -0.000000000000000,
        0.908346343128069,  0.444559320737884,  -0.000000000000000, -0.000000000000000, 0.118669306908858,  0.122791444438041,  -0.000000000000000,
        -0.000000000000000, -0.004412635542924, -0.301541243486446, -0.000000000000000, -0.000000000000000, -0.014813938259273, -0.070234762493727,
        -0.000000000000000, -0.000000000000000, -0.197496364171085, 0.401409945488103,  -0.000000000000000, -0.000000000000000, 0.386897646830217,
        0.293918114931364,  -0.000000000000000, -0.000000000000000, 0.123209960708442,  0.046869662956789,  -0.000000000000000, -0.000000000000000,
        -0.421811325840355, -0.262900337942114, -0.000000000000000, -0.000000000000000, 0.169667331836381,  0.192196556322091,  -0.000000000000000,
        -0.000000000000000, 0.390695711983956,  0.384785167998420,  -0.000000000000000, -0.000000000000000, 0.055955685477749,  0.154735364186852,
        -0.000000000000000, -0.000000000000000, -0.081865613788401, -0.399853596357838, -0.000000000000000, -0.000000000000000, -0.029126248544721,
        -0.082426041132453, -0.000000000000000, -0.000000000000000, 0.036425128358566,  0.597302590401259,  -0.000000000000000, -0.000000000000000,
        0.165426166906210,  0.342117087439375,  -0.000000000000000, -0.000000000000000, 0.045716152452490,  0.038669342465001,  -0.000000000000000,
        -0.000000000000000, -0.206856780108515, -0.239927850556704, -0.266109806260581, -0.215681809807122, 0.000000000000000,  -0.000000000000000,
        -0.708870940022493, -0.528810657511449, -0.000000000000000, -0.000000000000000, -0.078327923863611, -0.066617059870594, -0.000000000000000,
        0.000000000000000,  0.047711798111066,  0.129447489097316,  -0.000000000000000, -0.000000000000000, 0.021596255489112,  0.055926266515969,
        0.000000000000000,  0.000000000000000,  0.164224012220587,  -0.020900921393294, -0.000000000000000, -0.000000000000000, -0.303120268187417,
        -0.223247741606875, -0.000000000000000, -0.000000000000000, -0.074295356783912, -0.042711090384748, -0.000000000000000, -0.000000000000000,
        0.343166133950048,  0.288102869787120,  0.000000000000000,  -0.000000000000000, -0.057205742661088, -0.081492703911080, 0.000000000000000,
        -0.000000000000000, -0.127170772572716, -0.174648245799226, -0.000000000000000, -0.000000000000000, -0.037174685992526, -0.071880743623243,
        0.000000000000000,  -0.000000000000000, 0.094679866069285,  0.180181898774577,  -0.000000000000000, -0.000000000000000, 0.031029078979484,
        0.054950694088302,  0.000000000000000,  -0.000000000000000, -0.123231678438783, -0.268620978738200, -0.000000000000000, -0.000000000000000,
        -0.087066936049218, -0.153015260289736, -0.000000000000000, -0.000000000000000, -0.007871368457891, -0.009760500865127, -0.000000000000000,
        -0.000000000000000, 0.078589839694404,  0.112921647964096,  0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.000000000000000,
        -0.708879037409409, -0.555742946923267, 0.000000000000000,  0.000000000000000,  -0.125139545278487, -0.105423670873048, -0.000000000000000,
        -0.000000000000000, 0.439692079102144,  -0.414686145982567, -0.000000000000000, -0.000000000000000, -0.110457564005448, -0.372546692957598,
        -0.000000000000000, -0.000000000000000, -0.152647443080939, -0.411448359907755, -0.000000000000000, -0.000000000000000, 0.031805540406086,
        -0.366999778869881, -0.000000000000000, -0.000000000000000, -0.040652292383834, 0.511678394081865,  -0.000000000000000, -0.000000000000000,
        -1.084910829680046, -0.329200255813725, -0.000000000000000, -0.000000000000000, -0.248949289171445, -0.116421364815153, -0.000000000000000,
        -0.000000000000000, -0.398582243754182, -0.527099662695628, 0.000000000000000,  -0.000000000000000, -0.105868511563229, -0.056993613649634,
        -0.000000000000000, -0.000000000000000, -0.032223630641231, -0.580392143640569, -0.000000000000000, -0.000000000000000, -0.153003277888689,
        -0.442670101540056, -0.000000000000000, -0.000000000000000, -0.164021987885814, -0.502429801050834, -0.000000000000000, -0.000000000000000,
        -0.135435025514400, -0.432111249414172, -0.000000000000000, -0.000000000000000, 0.109988703055001,  0.710999339762007,  -0.000000000000000,
        -0.000000000000000, -0.435903185059510, -0.159311116313785, -0.000000000000000, -0.000000000000000, -0.104743155646906, -0.099489679802534,
        0.450886916693005,  0.420746350065253,  -0.000000000000000, -0.000000000000000, -0.012829581658640, 0.064525212628697,  -0.000000000000000,
        0.000000000000000,  -0.368656429513499, -0.037138265261272, -0.000000000000000, -0.000000000000000, -0.105971944302700, -0.060800528895350,
        -0.000000000000000, -0.000000000000000, 0.269232990897232,  0.460556602570673,  -0.000000000000000, -0.000000000000000, -0.005737244696958,
        0.256874581199123,  0.000000000000000,  0.000000000000000,  -0.042293157363162, -0.070659667673784, -0.000000000000000, -0.000000000000000,
        0.667427475849140,  0.441405427048442,  -0.000000000000000, -0.000000000000000, 0.173913599648027,  0.113000693531093,  -0.000000000000000,
        -0.000000000000000, 0.125874089294630,  0.186154081381335,  -0.000000000000000, -0.000000000000000, 0.018058167974774,  0.017253544773965,
        -0.000000000000000, 0.000000000000000,  0.071893105902414,  0.146826389257385,  -0.000000000000000, -0.000000000000000, -0.024767692778868,
        -0.047216236429659, -0.000000000000000, -0.000000000000000, 0.267889900608991,  0.490074645436861,  -0.000000000000000, -0.000000000000000,
        0.162439650172532,  0.288074166276115,  0.000000000000000,  -0.000000000000000, -0.065786085952358, -0.133619979052447, -0.000000000000000,
        -0.000000000000000, 0.062500075773238,  0.050021084822439,  -0.000000000000000, -0.000000000000000, 0.022164688101835,  0.027722749462474,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.201308736431326,  0.514972815517777,  -0.000000000000000,
        -0.000000000000000, -0.537451017299354, -0.889004341287253, -0.000000000000000, -0.000000000000000, 0.338205514653080,  -0.071212653587901,
        -0.000000000000000, -0.000000000000000, 0.538893896089963,  0.281186830347169,  -0.000000000000000, -0.000000000000000, 0.847323289075486,
        0.681519299044553,  -0.000000000000000, -0.000000000000000, 0.028158656961112,  -0.112321294566971, -0.000000000000000, -0.000000000000000,
        -0.502600305373777, -0.345053008630518, -0.000000000000000, -0.000000000000000, 0.310411837565058,  1.153426530202688,  -0.000000000000000,
        -0.000000000000000, 0.620595935768478,  1.133724367605136,  -0.000000000000000, -0.000000000000000, 0.222476269243224,  0.607050596138722,
        -0.000000000000000, -0.000000000000000, -0.440602358573380, -1.004860173939653, 0.000000000000000,  0.000000000000000,  0.075277410744268,
        -0.163247912034107, -0.000000000000000, -0.000000000000000, 0.242022342686018,  0.243646828217076,  -0.000000000000000, -0.000000000000000,
        0.476122769148488,  0.659660262870810,  -0.000000000000000, -0.000000000000000, -0.032794975853304, -0.141106938552056, -0.000000000000000,
        -0.000000000000000, -0.256453179447669, -0.326042676115423, -0.000000000000000, -0.000000000000000, 0.456199603753600,  1.391984130480449,
        -0.000000000000000, -0.000000000000000, 0.543428607647333,  1.295033524996618,  -0.024474507352014, -0.104148532007536, -0.000000000000001,
        -0.000000000000000, 0.181273024643947,  0.141855602486711,  -0.000000000000000, -0.000000000000000, -0.311759631972593, -0.326571634161339,
        -0.000000000000000, -0.000000000000000, -0.460580665692821, -0.238059666466275, -0.000000000000000, -0.000000000000000, -1.479879765672622,
        -1.401339648242379, -0.000000000000000, -0.000000000000000, 0.366680427453923,  0.547133583650966,  -0.000000000000000, -0.000000000000000,
        0.586321072104964,  0.507295620874584,  0.000000000000000,  0.000000000000000,  0.274258854432317,  0.181229733779870,  -0.000000000000000,
        -0.000000000000000, -0.192276400629413, -0.263975087669525, -0.000000000000001, -0.000000000000000, -0.072049570020694, -0.134366511825171,
        -0.000000000000000, -0.000000000000000, 0.027559445742771,  0.030385890122863,  -0.000000000000000, -0.000000000000000, -0.145970188619142,
        -0.255052828925763, -0.000000000000000, -0.000000000000000, -0.004474444797515, 0.032560965747546,  -0.000000000000000, -0.000000000000000,
        -0.437440811944745, -0.660882555354593, -0.000000000000000, -0.000000000000000, 0.253313155401025,  0.432719643100213,  -0.000000000000000,
        -0.000000000000000, 0.147017662966366,  0.217361784076949,  0.000000000000000,  -0.000000000000000, 0.028563843310193,  0.027267419098424,
        -0.000000000000000, -0.000000000000000, -0.122877628019769, -0.211863829887087, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 20, 36));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeFSForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix amomxmat(28, 4);

    CDenseMatrix amomymat(28, 4);

    CDenseMatrix amomzmat(28, 4);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.122229347298343, -0.040400134136035, 0.000000000000000,  -0.000000000000000, -0.159178232394563,
        -0.064601668696293, -0.148710709195116, -0.091492028233984, 0.000000000000000,  0.000000000000000,  -0.237603004173714, -0.189098622169050,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.404066792687587,  0.110170520288697,  0.000000000000000,
        0.000000000000000,  0.478025837030177,  0.171101260555517,  0.453064166539150,  0.257250654528765,  -0.000000000000000, 0.000000000000000,
        0.633513199468962,  0.492047611040186,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.147623764255892,
        0.016806201399842,  -0.000000000000000, 0.000000000000000,  0.126334909053288,  0.019943541582058,  0.171664745165793,  0.075909853246321,
        -0.000000000000000, 0.000000000000000,  0.149364469257212,  0.102093077460317,  -0.000000000000000, 0.000000000000000,  0.000000000000001,
        0.000000000000000,  -1.053393841025728, -0.347836312051864, 0.000000000000000,  0.000000000000000,  -1.371127035870524, -0.556132760153746,
        -1.215691620845642, -0.748073967235467, 0.000000000000000,  0.000000000000000,  -1.942955326862025, -1.546397511575116, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.382188127097404, -0.143325445443614, 0.000000000000000,  0.000000000000000,
        -0.532754774391758, -0.232867551644294, -0.459236665249403, -0.298395362783097, -0.000000000000000, 0.000000000000000,  -0.800428776593109,
        -0.645986516235802, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.671444166500165, -0.207661692709725,
        0.000000000000000,  -0.000000000000000, -0.845013064051811, -0.328969100038430, -0.789288985155962, -0.472513385389033, 0.000000000000000,
        0.000000000000000,  -1.206064380180399, -0.952466218324949, 0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        -0.346172620023293, -0.105686019948709, 0.000000000000000,  0.000000000000000,  -0.432821205821633, -0.167104618465978, -0.398852237622244,
        -0.237416346588161, -0.000000000000000, 0.000000000000000,  -0.603745442139554, -0.475993455174958, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 28, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.308470393707084, -0.099457988446160, 0.000000000000000,  0.000000000000000,  -0.396567006567145,
        -0.158496266306914, -0.368912587615161, -0.224686141656453, -0.000000000000000, 0.000000000000000,  -0.579835831194031, -0.460178902438039,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.585005578483109, -0.193035518913418, 0.000000000000000,
        0.000000000000000,  -0.761178493409597, -0.308602286870618, -0.705614298044281, -0.433858626370601, 0.000000000000000,  0.000000000000000,
        -1.126304264316847, -0.896233161410234, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.407371501221944,
        0.123318101376554,  0.000000000000000,  0.000000000000000,  0.507170971898242,  0.194736720878771,  0.485127720909174,  0.287999785597355,
        0.000000000000000,  0.000000000000000,  0.731095040417558,  0.575935707102840,  0.000000000000000,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, 0.619577410765446,  0.196929887329536,  -0.000000000000000, -0.000000000000000, 0.790679289441640,  0.313197569616373,
        0.749994236807912,  0.454138996966099,  -0.000000000000000, -0.000000000000000, 1.167676094545371,  0.925191604252206,  -0.000000000000000,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  -0.449324954087368, -0.149582301980893, 0.000000000000000,  0.000000000000000,
        -0.587353089375431, -0.239420388462652, -0.537101262433782, -0.331503040356063, 0.000000000000000,  -0.000000000000000, -0.862610940535170,
        -0.687115713745461, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.510872179952544, -0.162204497670227,
        0.000000000000000,  -0.000000000000000, -0.651595742346524, -0.257931076014356, -0.606762416128525, -0.367213991348655, 0.000000000000000,
        0.000000000000000,  -0.943857377137143, -0.747739086666377, 0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.120275864069524,  0.040077438203260,  0.000000000000000,  -0.000000000000000, 0.157299776474641,  0.064155640087015,  0.147159431992677,
        0.090832432123533,  0.000000000000000,  0.000000000000000,  0.236364164228350,  0.188279215291489,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 28, 4));

    std::vector<double> intzvals{
        -0.000000000000000, 0.000000000000000,  0.265892715562591,  0.086042770687497,  -0.000000000000000, 0.000000000000000,  0.342474078226705,
        0.137187249498661,  0.295511961475146,  0.180288103848963,  -0.000000000000000, 0.000000000000000,  0.465758222187258,  0.369818809015042,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.303456702244105,  0.107446007529246,  0.000000000000000,
        0.000000000000000,  0.409912836081753,  0.173359181729240,  0.319388143183137,  0.203488866070813,  0.000000000000000,  0.000000000000000,
        0.539698443054911,  0.433472903926761,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.346786505402241,
        -0.096173190930043, 0.000000000000000,  0.000000000000000,  -0.413600161099743, -0.149788175883955, -0.380640062328047, -0.217303141480344,
        0.000000000000000,  0.000000000000000,  -0.537184850030776, -0.417988163888666, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.123880037082204, -0.035263186858017, 0.000000000000000,  0.000000000000000,  -0.149618307208411, -0.055156284931934,
        -0.094765617590061, -0.053401342232244, 0.000000000000000,  0.000000000000000,  -0.130798954076239, -0.101328565643099, 0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.451772532621452,  0.155479205283905,  -0.000000000000000, -0.000000000000000,
        0.601024836716136,  0.249952144649626,  0.511146396705656,  0.320467147831741,  -0.000000000000000, -0.000000000000000, 0.841883552554483,
        0.673405981242241,  -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.588467132544032,  0.185096480191660,
        0.000000000000000,  0.000000000000000,  0.746969409324326,  0.293939456022714,  0.667604605804337,  0.402313789362114,  0.000000000000000,
        0.000000000000000,  1.031259711484895,  0.815981463885901,  0.000000000000000,  0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.020693348587706,  0.003843788676137,  -0.000000000000000, 0.000000000000000,  0.020775282330780,  0.005497302609350,  0.034844457878964,
        0.018583827447032,  -0.000000000000000, -0.000000000000000, 0.043672371227618,  0.033145008197327,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 28, 4));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeFPForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix amomxmat(28, 12);

    CDenseMatrix amomymat(28, 12);

    CDenseMatrix amomzmat(28, 12);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.467242496268111, -0.269391255753715, 0.000000000000000,  0.000000000000000,  0.249250937886642,
        0.085911842093787,  0.000000000000000,  0.000000000000000,  0.486997631965421,  0.231832575307880,  0.000000000000000,  0.000000000000000,
        -0.609055596520692, -0.430954362274049, 0.000000000000000,  0.000000000000000,  0.257688408120388,  0.124206713892419,  0.000000000000000,
        0.000000000000000,  0.577718841785961,  0.359728092620332,  0.554884381130376,  0.463266720040639,  -0.000000000000001, 0.000000000000000,
        -0.227657334753506, -0.124264105192968, -0.000000000000000, 0.000000000000000,  -0.594401538707279, -0.438919894882541, 0.000000000000000,
        0.000000000000000,  0.952817145173948,  0.987693645539818,  0.000000000000000,  0.000000000000000,  -0.163717382994361, -0.133275969154311,
        -0.000000000000000, 0.000000000000000,  -0.822911467982223, -0.821405930320721, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.915539875642562, -0.281874041332333, 0.000000000000000,  0.000000000000000,  -0.025389025940355, 0.051653134074219,
        0.000000000000000,  0.000000000000000,  0.422148415352204,  0.253350463091012,  0.000000000000000,  0.000000000000000,  -0.892963762658460,
        -0.400089670600852, 0.000000000000000,  0.000000000000000,  0.063630670461134,  0.090335925402154,  0.000000000000000,  0.000000000000000,
        0.569184778174584,  0.404784504517046,  0.928839884305137,  0.585533647148247,  -0.000000000000000, -0.000000000000000, -0.012313570254065,
        -0.145434828931975, 0.000000000000000,  0.000000000000000,  -0.503116620973810, -0.438468455644218, -0.000000000000000, 0.000000000000000,
        0.961485146077200,  0.904104694543090,  -0.000000000000000, 0.000000000000000,  -0.450908824261503, -0.521467240950715, 0.000000000000000,
        0.000000000000000,  -0.914264335259962, -0.950456331124551, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -1.666584664884141, -0.672216710974144, -0.000000000000000, -0.000000000000000, 1.004972406370180,  0.433758603073408,  0.000000000000000,
        0.000000000000000,  -0.192318328891811, -0.063128013731076, 0.000000000000000,  0.000000000000000,  -1.816777770838379, -1.016877260390133,
        0.000000000000000,  0.000000000000000,  1.166687451711343,  0.650627362566810,  0.000000000000000,  0.000000000000000,  -0.184047597134712,
        -0.094282480309947, 2.063709734775537,  1.511075982767128,  -0.000000000000000, 0.000000000000000,  -1.230321639240091, -0.965955716531206,
        -0.000000000000000, -0.000000000000000, 0.236138176335093,  0.143681642516108,  -0.000000000000000, -0.000000000000000, 2.842912408411502,
        2.847018328821560,  0.000000000000000,  0.000000000000000,  -1.850918857948859, -1.856419340093491, 0.000000000000000,  0.000000000000000,
        0.240502749145966,  0.230758801883990,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.346193938812369,
        0.085582710845870,  0.000000000000000,  0.000000000000000,  1.008379461304348,  0.041551932151324,  0.000000000000000,  0.000000000000000,
        0.625558720226595,  0.228574458813310,  0.000000000000000,  0.000000000000000,  0.321087899200332,  0.109891349985112,  0.000000000000000,
        0.000000000000000,  0.684032558967271,  -0.056107476598559, 0.000000000000000,  0.000000000000000,  0.662613206626192,  0.335113326459245,
        -0.146902760477648, 0.064186624667769,  0.000000000000000,  -0.000000000000000, -0.796223908181802, -0.119879784520703, -0.000000000000000,
        0.000000000000000,  -0.836332274401782, -0.526080306394801, 0.000000000000000,  0.000000000000000,  0.394994231976923,  0.514116512515669,
        -0.000000000000000, 0.000000000000000,  0.512199409292782,  0.831576033810181,  0.000000000000000,  0.000000000000000,  -0.840516347703700,
        -0.775308749172487, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.222431889891284, -0.018390232347903,
        0.000000000000000,  0.000000000000000,  0.927314851422325,  0.238433983309178,  0.000000000000000,  0.000000000000000,  -0.422352059525656,
        -0.334236779442707, 0.000000000000000,  0.000000000000000,  -0.149714720247635, -0.009019350679697, 0.000000000000000,  0.000000000000000,
        0.877485259397749,  0.308603704467249,  0.000000000000000,  0.000000000000000,  -0.651763639795178, -0.557089074097148, 0.205144698310518,
        0.162661282925832,  -0.000000000000000, -0.000000000000000, -0.842591650249866, -0.442874369773382, -0.000000000000000, -0.000000000000000,
        0.533280304498474,  0.516293146039845,  -0.000000000000000, 0.000000000000000,  0.340709244221714,  0.358653496329365,  -0.000000000000000,
        0.000000000000000,  -0.520858438716719, -0.380861361291035, -0.000000000000000, 0.000000000000000,  1.169927660003883,  1.257080621288600,
        0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.121544310185504,  -0.100824304700693, 0.000000000000000,
        0.000000000000000,  0.643309346350468,  0.129355529712061,  0.000000000000000,  0.000000000000000,  0.302141494491739,  0.029840887111769,
        -0.000000000000000, 0.000000000000000,  -0.048160472982627, -0.197426713660904, 0.000000000000000,  0.000000000000000,  0.545387210311497,
        0.156310424592076,  0.000000000000000,  0.000000000000000,  0.220304404257852,  0.016845294547571,  -0.107148531878130, 0.077450761368103,
        0.000000000000000,  -0.000000000000000, -0.487942008345730, -0.105064828035826, -0.000000000000000, 0.000000000000000,  -0.363326286795776,
        -0.151162236920249, -0.000000000000000, -0.000000000000000, 0.379546485472708,  0.478670290509365,  0.000000000000000,  0.000000000000000,
        0.183197141699056,  0.344479392383113,  0.000000000000000,  0.000000000000000,  -0.107820577976648, -0.032780164687128, -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.035327122361626,  -0.083587149008206, 0.000000000000000,  0.000000000000000,
        0.512345692199500,  0.169367563034555,  0.000000000000000,  0.000000000000000,  -0.344060093654598, -0.237314688181051, 0.000000000000000,
        0.000000000000000,  -0.079970971396707, -0.155562509402780, 0.000000000000000,  0.000000000000000,  0.513873280038169,  0.244914523496565,
        0.000000000000000,  0.000000000000000,  -0.496942309110766, -0.387350606524210, 0.045425802764658,  0.127835174731196,  -0.000000000000000,
        -0.000000000000000, -0.518511249769909, -0.269687267281905, 0.000000000000000,  -0.000000000000000, 0.429131260720559,  0.395095950811402,
        -0.000000000000001, 0.000000000000000,  0.380325136517259,  0.439458668464026,  -0.000000000000000, 0.000000000000000,  -0.340584107995023,
        -0.270429337032047, 0.000000000000000,  0.000000000000000,  0.858668346447200,  0.907477360104770,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 28, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.087564655961013, -0.114760081558709, 0.000000000000000,  0.000000000000000,  0.556896233311532,
        0.190778124987134,  0.000000000000000,  0.000000000000000,  -0.272317843903038, -0.213359300626427, 0.000000000000000,  0.000000000000000,
        -0.190306395936119, -0.197758804423011, 0.000000000000000,  0.000000000000000,  0.572350777054086,  0.276141162144338,  0.000000000000000,
        0.000000000000000,  -0.422007274990772, -0.353645751875211, 0.097245181914934,  0.152695653310445,  -0.000000000000000, -0.000000000000000,
        -0.529432775817358, -0.284914425321733, 0.000000000000000,  0.000000000000000,  0.379379084140056,  0.363278734484117,  -0.000000000000001,
        0.000000000000000,  0.411555271704529,  0.464903667479190,  -0.000000000000000, 0.000000000000000,  -0.370555231781952, -0.299316989779113,
        0.000000000000000,  0.000000000000000,  0.810070122658677,  0.864325404036416,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.145865946734292, -0.216457327132336, 0.000000000000000,  0.000000000000000,  0.524900861261127,  0.113738118750090,
        0.000000000000000,  0.000000000000000,  1.013007820585905,  0.309019957745120,  0.000000000000000,  0.000000000000000,  -0.344747779014480,
        -0.376310370406572, 0.000000000000000,  0.000000000000000,  0.465430992283845,  0.138371969288406,  0.000000000000000,  0.000000000000000,
        0.997249089623242,  0.432674232476884,  0.168826546210434,  0.284419802744195,  0.000000000000000,  0.000000000000000,  -0.384120428524592,
        -0.065476029760604, -0.000000000000000, 0.000000000000000,  -1.040710107044749, -0.655637845898472, 0.000000000000000,  0.000000000000000,
        0.784561577781872,  0.892323696840082,  0.000000000000000,  0.000000000000000,  0.221834479158050,  0.371387075338617,  0.000000000000000,
        0.000000000000000,  -1.053155693193572, -0.974968531110615, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.090535851006836,  0.135705433219265,  0.000000000000000,  0.000000000000000,  -0.727034450240350, -0.164202115059147, 0.000000000000000,
        0.000000000000000,  0.535178440265841,  0.114195037469129,  0.000000000000000,  0.000000000000000,  0.220966658436563,  0.233985976576005,
        0.000000000000000,  0.000000000000000,  -0.639225027349703, -0.208862890275488, 0.000000000000000,  0.000000000000000,  0.470379086007280,
        0.138645960493022,  -0.106545799099751, -0.184514710609447, 0.000000000000000,  0.000000000000000,  0.678257426324378,  0.322543395787661,
        0.000000000000000,  0.000000000000000,  -0.607018356135218, -0.445453715985168, 0.000000000000000,  0.000000000000000,  -0.502664776372284,
        -0.568208740728453, 0.000000000000000,  0.000000000000000,  0.342661543620450,  0.231250140003394,  0.000000000000000,  0.000000000000000,
        -0.826968786930061, -0.821257992550472, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.646211754598194,
        -0.213152410959478, 0.000000000000000,  0.000000000000000,  -0.516728567512852, -0.025039078448154, 0.000000000000000,  0.000000000000000,
        0.161336305128728,  0.115177370067776,  0.000000000000000,  0.000000000000000,  -0.652957148261872, -0.306010538426847, 0.000000000000000,
        0.000000000000000,  -0.348556699380938, 0.019495129981155,  0.000000000000000,  0.000000000000000,  0.237527145231043,  0.188771614085858,
        0.856594674234179,  0.520534193030768,  -0.000000000000000, 0.000000000000000,  0.395851434177016,  0.027246455762924,  0.000000000000000,
        0.000000000000000,  -0.536532534968906, -0.506284288906125, 0.000000000000000,  0.000000000000000,  0.805947663687300,  0.731654567123889,
        0.000000000000000,  0.000000000000000,  -0.354091097236413, -0.527519240913294, 0.000000000000000,  0.000000000000000,  -1.118470311074272,
        -1.189309924858473, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.490008098766632,  0.181301709543888,
        0.000000000000000,  0.000000000000000,  -0.098689762730260, -0.185575704815740, 0.000000000000000,  0.000000000000000,  1.270504814374931,
        0.468602782128301,  0.000000000000000,  0.000000000000000,  0.521878401337897,  0.266540654938396,  0.000000000000000,  -0.000000000000000,
        -0.276609580847855, -0.326963732716262, 0.000000000000000,  0.000000000000000,  1.346445786910240,  0.690276855217198,  -0.653508573172081,
        -0.416984255370582, 0.000000000000000,  0.000000000000000,  0.418605781414878,  0.516673092396241,  0.000000000000000,  0.000000000000000,
        -1.601168593983799, -1.125875482567596, 0.000000000000000,  0.000000000000000,  -0.676659044316438, -0.629415950882410, 0.000000000000000,
        0.000000000000000,  1.298072228954080,  1.439294058159200,  -0.000000000000000, -0.000000000000000, -2.022372806776204, -1.980285139214178,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.240945448481676,  0.033930181597551,  0.000000000000000,
        0.000000000000000,  0.730387186120845,  0.178925620551941,  -0.000000000000000, -0.000000000000000, -0.560127482089157, -0.332373987891835,
        0.000000000000000,  0.000000000000000,  0.188859830694228,  0.031434072069554,  0.000000000000000,  0.000000000000000,  0.663920404387186,
        0.233270603060957,  -0.000000000000000, 0.000000000000000,  -0.742660337124301, -0.533273971579746, -0.339872045669224, -0.153754447376236,
        -0.000000000000000, 0.000000000000000,  -0.579558815375472, -0.221212331069304, -0.000000000000000, -0.000000000000000, 0.608186564898937,
        0.548467597261966,  0.000000000000000,  0.000000000000000,  -0.140343087996488, -0.076650324723578, 0.000000000000000,  0.000000000000000,
        -0.099453335597376, 0.036057448256048,  -0.000000000000000, 0.000000000000000,  1.181204358303570,  1.244910915319755,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.375944800889843,  0.242573582997350,  0.000000000000000,  0.000000000000000,
        -0.166916130384323, -0.062379393774480, 0.000000000000000,  0.000000000000000,  -0.576985725090312, -0.258189471802646, 0.000000000000000,
        0.000000000000000,  0.520398269620897,  0.393840963273075,  0.000000000000000,  0.000000000000000,  -0.178927367073990, -0.091764903650999,
        0.000000000000000,  0.000000000000000,  -0.664965352350372, -0.396189224531480, -0.488039871716975, -0.424641977909241, 0.000000000000001,
        0.000000000000000,  0.182849968634755,  0.099006910908797,  -0.000000000000000, 0.000000000000000,  0.617461627501079,  0.452326137628466,
        -0.000000000000000, -0.000000000000000, -0.897178973619410, -0.939428872943500, 0.000000000000000,  0.000000000000000,  0.127906197491791,
        0.102415956473236,  -0.000000000000000, 0.000000000000000,  0.842296297799147,  0.838248184672260,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 28, 12));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.108105079105629,  0.111106029525748,  0.000000000000000,  0.000000000000000,  -0.399432976004407,
        -0.117072493749171, 0.000000000000000,  0.000000000000000,  0.005650655329204,  0.060228817146383,  0.000000000000000,  0.000000000000000,
        0.198595438279955,  0.188542489860821,  0.000000000000000,  0.000000000000000,  -0.387412445849842, -0.161969288197321, 0.000000000000000,
        -0.000000000000000, 0.074729628538260,  0.108968597747727,  -0.335063488965044, -0.324589157856088, 0.000000000000000,  0.000000000000000,
        0.497156356792346,  0.286224241572095,  0.000000000000000,  0.000000000000000,  -0.089187912556500, -0.123719328970593, 0.000000000000000,
        0.000000000000000,  -0.728597673436279, -0.779194974251223, 0.000000000000000,  0.000000000000000,  0.411356196277694,  0.356502262841531,
        0.000000000000000,  0.000000000000000,  -0.321740113569306, -0.359955837559112, -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.199339996223319,  0.134918111370261,  0.000000000000000,  0.000000000000000,  -0.276282468617912, -0.036893135958676,
        0.000000000000000,  0.000000000000000,  -0.743953269566622, -0.242875701293027, 0.000000000000000,  0.000000000000000,  0.278819099863977,
        0.222031829053903,  0.000000000000000,  0.000000000000000,  -0.224436999160104, -0.028474134110474, 0.000000000000000,  0.000000000000000,
        -0.753357184557728, -0.345956633346761, -0.585391263037434, -0.516810060007426, 0.000000000000000,  0.000000000000000,  0.334290074763376,
        0.154048652900023,  0.000000000000000,  -0.000000000000000, 0.965650356291754,  0.661526930490595,  0.000000000000000,  0.000000000000000,
        -1.108974767793779, -1.168965762345837, 0.000000000000000,  0.000000000000000,  0.129702757478090,  0.058132634284469,  -0.000000000000000,
        0.000000000000000,  1.155867501887098,  1.116523117744837,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.596718558594981,  0.184850657286636,  0.000000000000000,  0.000000000000000,  0.101782477884976,  -0.072577419488190, -0.000000000000000,
        -0.000000000000000, -0.284471453985139, -0.054319126227018, 0.000000000000000,  0.000000000000000,  0.582116344296126,  0.263299085172547,
        0.000000000000000,  0.000000000000000,  -0.036919061301850, -0.139703496266059, -0.000000000000000, -0.000000000000000, -0.246227550033141,
        -0.060651210083934, -0.504972112708790, -0.293046643222565, 0.000000000000000,  -0.000000000000000, -0.129592377235342, 0.040833068093339,
        0.000000000000000,  0.000000000000000,  0.364748897976032,  0.272173895906918,  -0.000000000000000, -0.000000000000000, -0.440369966571092,
        -0.394948627758821, -0.000000000000000, 0.000000000000000,  0.262162027226318,  0.337449938844463,  0.000000000000000,  0.000000000000000,
        0.505939326631284,  0.501651661900173,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.575596503322272,
        0.245914766458345,  0.000000000000000,  0.000000000000000,  0.020653034371599,  -0.015422047853832, 0.000000000000000,  0.000000000000000,
        -0.671623030176423, -0.361729375146458, 0.000000000000000,  0.000000000000000,  0.646788679332665,  0.375076564121834,  0.000000000000000,
        0.000000000000000,  -0.009656058364321, -0.029102788032398, 0.000000000000000,  0.000000000000000,  -0.847558942380352, -0.572170307213120,
        -0.348821696930114, -0.230228240864711, 0.000000000000000,  0.000000000000000,  -0.020262399832397, 0.005546113364033,  -0.000000000000000,
        -0.000000000000000, 0.355226355971247,  0.285251302214992,  0.000000000000000,  0.000000000000000,  -0.393870467998885, -0.377615042441524,
        0.000000000000000,  0.000000000000000,  0.034568684016399,  0.043654182048597,  -0.000000000000000, 0.000000000000000,  0.567910286178347,
        0.580755755207840,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.442351211348522, -0.215803342990943,
        0.000000000000000,  0.000000000000000,  -0.067656039240976, 0.152935069898819,  0.000000000000000,  0.000000000000000,  -0.932001777747012,
        -0.324076077248778, 0.000000000000000,  0.000000000000000,  -0.535742192464130, -0.334434441266781, 0.000000000000000,  0.000000000000000,
        0.129885238457281,  0.290548419158752,  0.000000000000000,  0.000000000000000,  -0.966547405111352, -0.469730521295306, 0.243005966617089,
        0.122895913113688,  -0.000000000000000, 0.000000000000000,  0.120228268673607,  -0.099308890669263, 0.000000000000000,  0.000000000000000,
        0.782950608010582,  0.487687122336649,  -0.000000000000000, -0.000000000000000, 0.134225562654423,  0.090976815125901,  0.000000000000000,
        0.000000000000000,  -0.493268615687445, -0.627664670406190, 0.000000000000000,  0.000000000000000,  0.769413916685663,  0.704595781942959,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.388054634941275, -0.088609375231354, 0.000000000000000,
        0.000000000000000,  -0.543086942973415, -0.063771068709320, 0.000000000000000,  0.000000000000000,  0.091186377644560,  0.113287484300368,
        0.000000000000000,  0.000000000000000,  -0.344030767427250, -0.112593359178798, 0.000000000000000,  0.000000000000000,  -0.409164234952080,
        -0.048279366617124, 0.000000000000000,  0.000000000000000,  0.192324263951561,  0.194040920206143,  0.122121162373663,  -0.035053614701413,
        0.000000000000000,  0.000000000000000,  0.703198332465000,  0.304916684296485,  0.000000000000000,  0.000000000000000,  -0.466531548568630,
        -0.459038896923841, 0.000000000000000,  0.000000000000000,  -0.255313980979856, -0.335986305296006, 0.000000000000000,  0.000000000000000,
        0.248163665973136,  0.109430489410705,  0.000000000000000,  0.000000000000000,  -1.035589758993986, -1.108840129227580, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.247604269746896, -0.128759362472683, 0.000000000000000,  0.000000000000000,
        -0.031884707235244, -0.005258894816299, 0.000000000000000,  0.000000000000000,  0.417242998793424,  0.202996584733673,  0.000000000000000,
        -0.000000000000000, -0.305042065756270, -0.203321924607026, 0.000000000000000,  0.000000000000000,  -0.023455960510131, -0.006490356748865,
        0.000000000000000,  0.000000000000000,  0.500775705523699,  0.315919281650817,  0.344270708653990,  0.268122355933049,  -0.000000000000000,
        0.000000000000000,  0.058908610996416,  0.029546027097839,  0.000000000000000,  0.000000000000000,  -0.646704815924873, -0.505492902326556,
        0.000000000000000,  0.000000000000000,  0.527053534705388,  0.537091233210169,  0.000000000000000,  0.000000000000000,  0.038510627172210,
        0.031951512838730,  0.000000000000000,  0.000000000000000,  -0.989932344783424, -1.006164772385401, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 28, 12));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeFDForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix amomxmat(28, 20);

    CDenseMatrix amomymat(28, 20);

    CDenseMatrix amomzmat(28, 20);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.425294388578750, -0.193519793385831, 0.000000000000000,  0.000000000000000,  0.697162147779752,
        0.447026316455423,  -0.000000000000000, -0.000000000000000, -0.483164003264029, -0.203007888708771, 0.000000000000000,  0.000000000000000,
        -0.602172526652358, -0.295388960755159, 5.266702137250438,  3.489994073136784,  -0.175194651684395, 0.180381593235099,  0.000000000000000,
        0.000000000000000,  -0.389527508250301, -0.262944869587191, 0.000000000000000,  0.000000000000000,  0.745770517560850,  0.655648519562330,
        -0.000000000000000, 0.000000000000000,  -0.425045612483275, -0.272002557974474, 0.000000000000000,  0.000000000000000,  -0.555126795883050,
        -0.418807586732340, 4.439372017431729,  4.024922359499622,  0.023542682292491,  0.363091386877998,  -0.284741500961286, -0.189215792016033,
        -0.000000000000000, 0.000000000000000,  0.722271374065912,  0.539143337190077,  0.000000000000000,  -0.000000000000000, -0.396936198687333,
        -0.254326241199364, -0.000000000000000, 0.000000000000000,  -0.703247107454688, -0.442593853704895, -0.000000000000000, -0.000000000000000,
        -0.119410271158934, 0.129062248732328,  3.642828834295709,  1.098900521641598,  -0.190837561939722, -0.202413531616813, 0.000000000000000,
        0.000000000000000,  0.560586905537858,  0.586121549416708,  0.000000000000000,  0.000000000000000,  -0.247573315851381, -0.258478120881209,
        0.000000000000000,  0.000000000000000,  -0.397970842101330, -0.389184524758614, -0.000000000000000, 0.000000000000000,  0.515608547893624,
        0.804207306073437,  1.879232773647146,  2.081345718519633,  -2.866829525219820, -1.899712152116142, -0.951858633857943, -0.647567975433146,
        0.000000000000000,  0.000000000000000,  1.078997942963811,  0.314377940668712,  0.000000000000000,  0.000000000000000,  -0.205246813085550,
        -0.052717971089164, 4.300244287829728,  2.849568228174213,  -0.016571566137341, 0.118965746598504,  0.000000000000000,  0.000000000000000,
        -0.372872189646947, -0.081994951143611, -2.416488049132818, -2.190890230020665, -1.070732615233847, -0.946516107191428, 0.000000000000000,
        0.000000000000000,  0.789244660195416,  0.393350752048244,  0.000000000000000,  0.000000000000000,  -0.128079214969686, -0.076654141584884,
        3.624732073699228,  3.286335345030997,  0.079057957791480,  0.213713111670121,  0.000000000000000,  0.000000000000000,  -0.231424032524669,
        -0.103310396673074, -1.044221056491010, -0.997299211739410, -2.191631685973859, -0.661130487463201, 1.001271257279524,  0.559414227519789,
        0.000000000000000,  0.000000000000000,  -0.388004787740672, -0.266794717735689, -0.000000000000000, -0.000000000000000, 0.047593846318825,
        0.248710115760889,  2.974357288107380,  0.897248518700059,  -0.602334107247477, -0.340983090035378, -0.000000000000000, -0.000000000000000,
        -1.416474360048297, -1.746400168697757, -1.130601046437006, -1.252198067399883, 0.485222706012187,  0.481754316229111,  0.000000000000000,
        0.000000000000000,  -0.227068861404837, -0.203995583618310, -0.000000000000000, 0.000000000000000,  0.678275426489514,  1.007284314596907,
        1.534387134450222,  1.699411662899841,  -0.271710111813068, -0.246971767964535, -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  1.103795801074266,  0.417898414660111,  -3.626284385245503, -2.402966919754908, 1.022638162885773,  0.277898877726583,
        4.710681598454165,  3.121545595442091,  -1.326297520293076, -0.293786835928491, 0.000000000000000,  0.000000000000000,  -0.435176199568522,
        -0.150033394544972, 1.359856644467063,  0.901112594908090,  -0.567335253211982, -0.202220717229634, 0.000000000000000,  0.000000000000000,
        0.914510669950093,  0.552234786238229,  -3.056642469534633, -2.771281292110205, 0.736761012640393,  0.332565787149302,  3.970695043355093,
        3.600000000000001,  -0.890163914525718, -0.333305143772760, 0.000000000000000,  0.000000000000000,  -0.365182205201212, -0.184963441848995,
        1.146240926075487,  1.039230484541327,  -0.426687492198338, -0.284313195188722, 1.425393695907493,  0.991078034768541,  -0.000000000000000,
        0.000000000000000,  1.176306514923965,  0.559098176295215,  -2.772219167948919, -0.836271268384445, -1.619664960886245, -0.698035247932488,
        3.258245161552610,  0.982886506760236,  -0.605870475783287, -0.462273983135413, 0.000000000000000,  0.000000000000000,  -0.711428549262898,
        -0.322840746114049, 0.940574360554097,  0.283734894630436,  1.050767653528845,  1.139659515677545,  0.000000000000000,  0.000000000000000,
        0.182711939910266,  -0.061138084387480, -1.430109772684295, -1.583919189857868, -0.036039409000294, 0.396112363496142,  1.680836890968199,
        1.861612204515217,  -0.510962541113494, -0.562329510725159, 0.000000000000000,  0.000000000000000,  -0.069004246049533, 0.094978930829373,
        0.485215815732172,  0.537401153701776,  0.000000000000000,  0.000000000000000,  0.191485296628975,  0.098830628743528,  -3.330954902277623,
        -2.207266058320100, -1.488916274088509, -0.399586578372302, -3.846255418976980, -2.548731305888469, 0.067783445193102,  0.432015551747109,
        0.000000000000000,  0.000000000000000,  -1.044889695565119, -0.298166415783574, 0.000000000000000,  0.000000000000000,  -0.896824356933317,
        -0.378068143877180, 0.000000000000000,  0.000000000000000,  0.197629093037011,  0.129669387448458,  -2.807705391180197, -2.545584412271571,
        -1.117513213343091, -0.451376119754765, -3.242058926806101, -2.939387691339816, 0.522295408956786,  0.649527574012666,  0.000000000000000,
        0.000000000000000,  -0.773154450714876, -0.364709513143586, 0.000000000000000,  0.000000000000000,  -0.806465830760654, -0.495516972003903,
        0.172536495454091,  0.238387479247419,  -0.000000000000000, -0.000000000000000, -1.152814005483548, -0.790395834952954, -2.303927248502108,
        -0.695005714066919, 0.179582075689062,  0.440464775470327,  -2.940382458888013, -0.886999627179174, -0.923181290846326, -0.424132670547967,
        -0.000000000000000, 0.000000000000000,  -1.186698106073661, -0.940838588232396, -0.000000000000000, 0.000000000000000,  0.372988191494457,
        0.463321207726249,  -0.000000000000000, 0.000000000000000,  -1.072380322751029, -1.370547338048753, -1.188531163672126, -1.316358613752347,
        0.558990753587591,  0.568248230876574,  -1.516860477159325, -1.680000000000002, -0.250678793221220, -0.184675493845896, 0.000000000000000,
        0.000000000000000,  -1.115326878317925, -1.269477665660055, 0.000000000000000,  -0.000000000000000, -1.359856644467063, -0.901112594908090,
        -0.137434548535022, -0.001120722920732, 0.000000000000000,  0.000000000000000,  -0.694297197895463, -0.316020898048850, 0.000000000000000,
        0.000000000000000,  -0.857928996041757, -0.032583514419890, -3.626284385245503, -2.402966919754908, 0.938239490427690,  0.528426766604782,
        0.000000000000000,  0.000000000000000,  -0.174371560716776, 0.060029596698122,  -1.146240926075487, -1.039230484541327, -0.096341019339240,
        0.034466293935290,  0.000000000000000,  0.000000000000000,  -0.672764118738132, -0.407990682512949, 0.000000000000000,  0.000000000000000,
        -0.418312519996267, 0.038776213320098,  -3.056642469534633, -2.771281292110205, 1.019018142069627,  0.702829844589754,  0.000000000000000,
        0.000000000000000,  -0.010698198496485, 0.111527228121053,  -0.182848505392858, -0.238505803650213, -0.940574360554097, -0.283734894630436,
        -0.372748888302879, -0.242580687073592, 0.000000000000000,  0.000000000000000,  -0.917773892864464, -0.394095356963276, 0.000000000000000,
        0.000000000000000,  0.919978150762138,  0.741534582273415,  -2.772219167948919, -0.836271268384445, -0.059699643424434, 0.028754329398985,
        -0.000000000000000, 0.000000000000000,  -0.465777809485293, -0.647714744240257, -0.485215815732171, -0.537401153701776, -0.256791017277244,
        -0.289178041541365, 0.000000000000000,  0.000000000000000,  -0.187019101496610, -0.100428730780113, 0.000000000000000,  0.000000000000000,
        0.734949493618054,  0.715002014325976,  -1.430109772684295, -1.583919189857868, 0.088855422101460,  0.121009004716454,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.575852311954554, -0.133551125103907, -4.300244287829729, -2.849568228174213,
        -0.701012340856827, -0.240269589083773, 0.000000000000000,  0.000000000000000,  -0.713638716438646, -0.171518104223822, 0.000000000000000,
        0.000000000000000,  0.232857156401993,  0.290927690227786,  -2.866829525219820, -1.899712152116142, -1.121330163820556, -0.680211264394929,
        0.000000000000000,  0.000000000000000,  -0.405305394785016, -0.143550193797155, -3.624732073699228, -3.286335345030997, -0.522453637020488,
        -0.332154429557985, 0.000000000000000,  0.000000000000000,  -0.527853290273909, -0.174010611972543, 0.000000000000000,  0.000000000000000,
        0.411610696934073,  0.434827895802418,  -2.416488049132819, -2.190890230020665, -1.175304979044931, -0.982572055043661, -0.416142877417949,
        -0.217723627066115, 0.000000000000000,  0.000000000000000,  -0.703213648484915, -0.521490502248135, -2.974357288107380, -0.897248518700059,
        -0.367644942833167, -0.162146152633618, 0.000000000000000,  0.000000000000000,  0.237118374976460,  0.391509774762119,  0.000000000000000,
        0.000000000000000,  -1.206339091135114, -1.080098685362694, -2.191631685973859, -0.661130487463201, -0.190112255483737, -0.197688282810979,
        0.000000000000000,  0.000000000000000,  -0.801132014785742, -1.067784377350972, -1.534387134450222, -1.699411662899841, -0.149872746767300,
        -0.177021476233393, 0.000000000000000,  0.000000000000000,  0.604328023637026,  0.735498036657904,  0.000000000000000,  0.000000000000000,
        -1.482396169883047, -1.809201717666323, -1.130601046437006, -1.252198067399883, -5.266702137250438, -3.489994073136785, -0.086461293128487,
        -0.245369074454737, 0.000000000000000,  0.000000000000000,  -0.233019992905935, 0.058110186496420,  0.000000000000000,  0.000000000000000,
        -0.878461912462217, -0.406992579256691, 0.000000000000000,  -0.000000000000000, 0.566918103781709,  0.413534363093312,  0.000000000000000,
        0.000000000000000,  -0.176711803719121, -0.129923646679810, -4.439372017431729, -4.024922359499623, -0.204651650784308, -0.440066090800592,
        0.000000000000000,  0.000000000000000,  -0.055771010744958, 0.126512050719407,  0.000000000000000,  0.000000000000000,  -0.808879325704474,
        -0.555978685999360, -0.000000000000000, 0.000000000000000,  0.656713205118786,  0.614591700261620,  0.000000000000000,  0.000000000000000,
        -0.214498688692786, -0.187296476337145, -0.145142257792017, -0.268656704868514, -3.642828834295710, -1.098900521641597, -0.074867932769525,
        0.051685394256124,  0.000000000000000,  0.000000000000000,  -0.817436070695036, -0.528152759022962, 0.000000000000000,  0.000000000000000,
        0.581803512802681,  0.474304128813768,  0.000000000000000,  0.000000000000000,  -0.032372204065926, -0.053793870175671, -0.000000000000000,
        0.000000000000000,  -0.625487149248047, -0.907062508751335, -1.879232773647146, -2.081345718519633, 0.113974706126256,  0.137247981817524,
        0.000000000000000,  0.000000000000000,  -0.523833788751089, -0.552415724922287, 0.000000000000000,  0.000000000000000,  0.516989430620410,
        0.549072480428872,  -0.000000000000000, -0.000000000000000, -0.083079107952315, -0.101110613327766, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 28, 20));

    std::vector<double> intyvals{
        -5.266702137250438, -3.489994073136785, -0.285839760637814, -0.346852415180996, 0.000000000000000,  -0.000000000000000, 0.217237555278205,
        0.253958384988631,  0.000000000000000,  0.000000000000000,  -1.034293074471177, -0.452694275654729, 0.000000000000000,  0.000000000000000,
        0.375212496677870,  0.353715553392420,  0.000000000000000,  0.000000000000000,  0.484647765769728,  0.241184637606637,  -4.439372017431729,
        -4.024922359499623, -0.399813528027901, -0.579844291944718, -0.000000000000000, 0.000000000000000,  0.343217803396543,  0.392204235309559,
        0.000000000000000,  0.000000000000000,  -0.927935490556764, -0.611323258983124, 0.000000000000000,  0.000000000000000,  0.507742462875796,
        0.540302416843935,  0.000000000000000,  0.000000000000000,  0.465424372244357,  0.332374417962542,  -0.230605697214311, -0.329530518088954,
        -3.642828834295710, -1.098900521641597, 0.171916712615078,  0.223755789238818,  0.000000000000000,  -0.000000000000000, -0.887567255457340,
        -0.572627199852819, 0.000000000000000,  0.000000000000000,  0.457321181878716,  0.401376247284611,  0.000000000000000,  0.000000000000000,
        0.337920566866076,  0.243544231500398,  0.000000000000000,  0.000000000000000,  -0.688906528356577, -0.974960712749653, -1.879232773647146,
        -2.081345718519633, 0.300166693298798,  0.341374349129149,  0.000000000000000,  0.000000000000000,  -0.562694822806409, -0.590224055098096,
        0.000000000000000,  0.000000000000000,  0.455553846082688,  0.489955433845794,  0.000000000000000,  0.000000000000000,  0.263352619631355,
        0.287447014912559,  0.000000000000000,  0.000000000000000,  1.433414762609910,  0.949856076058071,  0.229265792844845,  0.344983812973753,
        -4.300244287829728, -2.849568228174213, 0.113742863971856,  0.126458105451800,  0.000000000000000,  0.000000000000000,  -0.514731451633024,
        -0.140126252966319, 0.000000000000000,  0.000000000000000,  -1.310286028095235, -0.319717790302950, 0.000000000000000,  0.000000000000000,
        0.035642034822197,  0.011631032816229,  1.208244024566409,  1.095445115010332,  0.454813203446170,  0.527603999114296,  -3.624732073699228,
        -3.286335345030997, 0.211004461564829,  0.168731111959121,  0.000000000000000,  0.000000000000000,  -0.414858271407221, -0.141631781215164,
        0.000000000000000,  0.000000000000000,  -0.909714831189512, -0.372846071670287, 0.000000000000000,  0.000000000000000,  0.051591580411772,
        -0.001024608210552, 0.246754388342551,  0.428052515026720,  0.939270722560225,  0.283341637484229,  0.059511104431120,  0.040591186243060,
        -2.974357288107380, -0.897248518700059, -0.180860047550087, -0.070311217964397, 0.000000000000000,  0.000000000000000,  -1.218230374052981,
        -0.643687119482422, -0.000000000000000, 0.000000000000000,  -0.273704596863038, -0.165437019006246, -0.000000000000000, 0.000000000000000,
        0.749277372710230,  0.970715614466253,  0.484543305615860,  0.536656314599950,  -0.171739092070692, -0.369767045333742, -1.534387134450222,
        -1.699411662899841, -0.077308536610382, -0.107579454649116, 0.000000000000000,  0.000000000000000,  -0.496293510927639, -0.456641314096685,
        0.000000000000000,  0.000000000000000,  -0.120897516273311, -0.094087264128685, 0.000000000000000,  0.000000000000000,  1.359856644467063,
        0.901112594908090,  -0.045881135820827, 0.043848775957191,  1.813142192622752,  1.201483459877454,  -0.087122964750097, -0.151209581633187,
        0.000000000000000,  0.000000000000000,  0.717519975718919,  0.057985181953819,  0.000000000000000,  0.000000000000000,  0.268287056654881,
        0.266669603633047,  0.000000000000000,  0.000000000000000,  -0.259513542868022, 0.010516225844513,  1.146240926075487,  1.039230484541327,
        0.055326677357335,  0.053954101263783,  1.528321234767317,  1.385640646055102,  -0.226737192698263, -0.211715581270847, 0.000000000000000,
        0.000000000000000,  0.369641206907307,  0.021255242149034,  0.000000000000000,  0.000000000000000,  0.431860407218911,  0.370880917314072,
        0.000000000000000,  0.000000000000000,  -0.101180242690493, 0.042335766573968,  0.063834130433671,  0.221203010901672,  0.940574360554097,
        0.283734894630436,  -0.098466565871390, -0.179695637191120, 1.188093929120965,  0.358401972164762,  0.784813712617292,  0.360786908232429,
        -0.000000000000000, 0.000000000000000,  -0.185074643216482, -0.034432299505025, -0.000000000000000, 0.000000000000000,  -0.219786261440999,
        -0.080430777679623, -0.000000000000000, 0.000000000000000,  0.513273922747368,  0.729057390060503,  0.485215815732171,  0.537401153701776,
        -0.205380104657535, -0.196652557613287, 0.612904188293269,  0.678822509939086,  0.223277574264227,  0.173951947988104,  0.000000000000000,
        0.000000000000000,  0.100708282355217,  0.190292530897998,  0.000000000000000,  0.000000000000000,  -0.022385800202403, 0.002754437590258,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.693028241251509, -0.327253565296468, 0.000000000000000,
        0.000000000000000,  0.882421794659522,  0.226117984968250,  1.923127709488490,  1.274365652944235,  0.036598195559612,  -0.150672886328315,
        3.330954902277623,  2.207266058320100,  0.509862927180513,  0.103082278009107,  0.000000000000000,  0.000000000000000,  -0.936796457818738,
        -0.368977420644203, 0.000000000000000,  0.000000000000000,  -0.665499705259580, -0.435128044383238, 0.000000000000000,  0.000000000000000,
        0.621285226385506,  0.269281934985258,  1.621029463403051,  1.469693845669908,  -0.154598405285324, -0.234199955827594, 2.807705391180197,
        2.545584412271571,  0.371971688194448,  0.083833140029558,  0.000000000000000,  0.000000000000000,  -0.808889019134690, -0.480928739024219,
        -0.912632087593799, -0.790108341768431, 0.000000000000000,  0.000000000000000,  0.774540331219926,  0.316064728611955,  0.000000000000000,
        0.000000000000000,  -0.051841072051656, -0.154337866378732, 1.260163910952006,  0.380142697362503,  0.284402290027343,  0.364906648205639,
        2.303927248502108,  0.695005714066919,  -1.291948479620935, -0.933053898748777, -0.000000000000000, 0.000000000000000,  -0.989802045722308,
        -1.148016976313409, 0.000000000000000,  0.000000000000000,  0.140079273357862,  0.067801056907164,  0.000000000000000,  0.000000000000000,
        -0.163882662170384, -0.135330305298076, 0.650083061639711,  0.720000000000001,  0.789748315157773,  1.138734801884685,  1.188531163672126,
        1.316358613752347,  -1.027455178741890, -1.136300336863924, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -1.250150294952112, -0.444909378537869, 0.000000000000000,  0.000000000000000,  -0.120394440835532, 0.017688348377230,  -4.710681598454165,
        -3.121545595442091, 0.517750676709720,  0.283568352267869,  1.813142192622752,  1.201483459877454,  -0.981263770110273, -0.185184161191309,
        1.359856644467063,  0.901112594908090,  0.349692290290708,  0.168326177183003,  0.000000000000000,  0.000000000000000,  -1.014702831326187,
        -0.576981093327182, 0.000000000000000,  0.000000000000000,  -0.029512463086469, 0.036340056318142,  -3.970695043355093, -3.600000000000001,
        0.509122605802855,  0.405639625185596,  1.528321234767316,  1.385640646055102,  -0.619712927738353, -0.196591228516474, 1.146240926075487,
        1.039230484541327,  0.361030497873516,  0.210031524550363,  -1.644097333855250, -1.106425367055676, 0.000000000000000,  0.000000000000000,
        0.164607738004130,  0.295107644587708,  -0.000000000000000, 0.000000000000000,  0.766213263334411,  0.347416817975861,  -3.258245161552610,
        -0.982886506760236, -1.086068337496170, -0.455189924222233, 1.188093929120965,  0.358401972164762,  0.506586189478043,  0.540214199968413,
        0.940574360554097,  0.283734894630436,  -1.128986306356825, -1.203480107822936, 0.000000000000000,  0.000000000000000,  0.481965568109592,
        0.600019734673689,  0.000000000000000,  0.000000000000000,  -0.095637527068470, -0.430787494340908, -1.680836890968199, -1.861612204515217,
        -0.099650519117069, 0.106068592968782,  0.612904188293269,  0.678822509939086,  0.855200583364234,  1.100482701991328,  0.485215815732172,
        0.537401153701776,  0.000000000000000,  0.000000000000000,  -0.268828148639214, -0.065703228124215, 0.000000000000000,  0.000000000000000,
        -0.057600551442488, 0.131912987137187,  0.000000000000000,  0.000000000000000,  -0.984265894656010, -0.231839949530494, -4.300244287829729,
        -2.849568228174213, 0.334475359255532,  0.121177820250579,  1.433414762609910,  0.949856076058071,  1.155043297831285,  0.563022074268842,
        0.000000000000000,  0.000000000000000,  -0.209230462978748, -0.061384303896673, 0.000000000000000,  0.000000000000000,  0.115323704781288,
        0.213626059340172,  0.000000000000000,  0.000000000000000,  -0.698971831680575, -0.249911514276381, -3.624732073699228, -3.286335345030997,
        0.305407955336903,  0.136687897915127,  1.208244024566409,  1.095445115010332,  1.088764455640450,  0.778836367820746,  0.005582247881253,
        0.019452175447648,  0.000000000000000,  0.000000000000000,  -0.027391087806464, 0.180203657922198,  0.000000000000000,  0.000000000000000,
        -0.718612053441800, -0.380669586716733, 0.000000000000000,  0.000000000000000,  0.253372991651437,  0.066333680901031,  -2.974357288107380,
        -0.897248518700059, 1.252673854992611,  0.990161243084655,  0.939270722560225,  0.283341637484229,  0.001499268220685,  -0.020162036398351,
        0.000000000000000,  0.000000000000000,  0.361312705691834,  0.464582221908368,  0.000000000000000,  0.000000000000000,  -0.334515268274647,
        -0.348204681341068, 0.000000000000000,  0.000000000000000,  -0.245079732477060, -0.493572141286983, -1.534387134450222, -1.699411662899841,
        1.218952166659913,  1.424647893519339,  0.484543305615860,  0.536656314599950,  0.000000000000000,  0.000000000000000,  -0.244695234000354,
        -0.178683312391673, 0.000000000000000,  0.000000000000000,  -0.599099373576166, -0.415437162981033, -0.000000000000000, -0.000000000000000,
        0.264436598024027,  0.146888059916337,  0.000000000000000,  0.000000000000000,  1.042199209199957,  0.495465368813296,  -5.266702137250438,
        -3.489994073136784, -0.042207502739696, -0.284151445941761, 0.000000000000000,  0.000000000000000,  -0.294691365423029, -0.257841024871114,
        0.000000000000000,  0.000000000000000,  -0.669569638952605, -0.615657737183625, -0.000000000000000, 0.000000000000000,  0.270779378583868,
        0.205220127999292,  0.000000000000000,  0.000000000000000,  0.957863705816438,  0.690681256840873,  -4.439372017431729, -4.024922359499622,
        -0.227676275351937, -0.505198242731273, -0.093692080432401, -0.111143023003901, -0.000000000000000, 0.000000000000000,  -0.645674911344966,
        -0.496963440995217, -0.000000000000000, 0.000000000000000,  0.267123231914297,  0.184697589295955,  -0.000000000000000, 0.000000000000000,
        0.931876927999717,  0.613182676341384,  0.000000000000000,  0.000000000000000,  0.016944917906062,  -0.196244759129910, -3.642828834295709,
        -1.098900521641598, -0.157313998238053, -0.187509687349379, 0.000000000000000,  0.000000000000000,  -0.526181837314151, -0.553357467088622,
        0.000000000000000,  0.000000000000000,  0.192182989689984,  0.206411545250905,  0.000000000000000,  0.000000000000000,  0.587175308547680,
        0.597682670306461,  0.000000000000000,  -0.000000000000000, -0.582619761710211, -0.874957517984028, -1.879232773647146, -2.081345718519633};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 28, 20));

    std::vector<double> intzvals{
        3.511134758166959,  2.326662715424523,  0.092336372611125,  0.032617751138933,  0.000000000000000,  0.000000000000000,  -0.154649362971881,
        -0.150653043919427, 0.000000000000000,  0.000000000000000,  0.681301233267170,  0.278350952551119,  0.000000000000000,  0.000000000000000,
        0.000525410453050,  -0.081356933751298, -1.755567379083480, -1.163331357712262, -0.105872868067184, -0.030728988401250, 2.959581344954486,
        2.683281572999749,  0.065196691771772,  0.048599650146841,  0.000000000000000,  0.000000000000000,  -0.225898246692945, -0.222601539059255,
        0.000000000000000,  -0.000000000000000, 0.590499054289131,  0.371264168141269,  0.000000000000000,  0.000000000000000,  -0.085359782703269,
        -0.128653109363723, -1.479790672477243, -1.341640786499874, -0.088088837964280, -0.031520904261677, 0.471905188058117,  0.534268715090519,
        2.684189667375786,  0.809716173841177,  -0.557778930190566, -0.514351005992970, 0.000000000000000,  0.000000000000000,  0.922652978171269,
        0.617380301122013,  0.000000000000000,  -0.000000000000000, -0.145320131854442, -0.195511836276431, 0.000000000000000,  0.000000000000000,
        -0.350216187964018, -0.385406448975532, -1.150367000303908, -0.347021217360504, 0.949187779326524,  1.280996435917696,  1.384697833213687,
        1.533623161014466,  -0.651215380770832, -0.751137488802011, 0.000000000000000,  0.000000000000000,  0.627273604925696,  0.667535267289675,
        -0.000000000000000, -0.000000000000000, -0.288098491790761, -0.346994440208752, 0.000000000000000,  0.000000000000000,  -0.645743621830360,
        -0.851111991216412, -0.593441928520152, -0.657267069006200, 0.000000000000000,  0.000000000000000,  0.164716039416178,  -0.033729734577951,
        2.866829525219820,  1.899712152116142,  -0.179823648882966, -0.046137892234094, 0.000000000000000,  0.000000000000000,  0.283294936115053,
        0.082296992751414,  -1.433414762609910, -0.949856076058071, 0.711851345181316,  0.085490594157046,  0.000000000000000,  0.000000000000000,
        0.286727844200436,  0.293776106522436,  0.000000000000000,  0.000000000000000,  0.038339419777940,  -0.070686993031174, 2.416488049132818,
        2.190890230020665,  -0.152024073016509, -0.036468585131816, 0.000000000000000,  0.000000000000000,  0.215180545286515,  0.099545818446520,
        -1.208244024566409, -1.095445115010332, 0.411917188130551,  0.056823154539973,  0.000000000000000,  0.000000000000000,  0.348179196040883,
        0.493005951632405,  0.157498846366249,  0.025732698877921,  0.000000000000000,  0.000000000000000,  -0.597702548134970, -0.390716214606096,
        2.191631685973859,  0.661130487463201,  0.381828550029278,  0.216996486828957,  0.000000000000000,  0.000000000000000,  1.015156122392523,
        0.503263199831265,  -0.939270722560225, -0.283341637484229, 0.219178800537608,  0.003984483974314,  0.000000000000000,  0.000000000000000,
        -0.049025281150797, -0.086573532189023, 0.000000000000000,  0.000000000000000,  -0.259030781098251, -0.156768874220101, 1.130601046437006,
        1.252198067399883,  0.178812240350105,  0.170356752759600,  0.000000000000000,  0.000000000000000,  0.272248737887662,  0.149735841585574,
        -0.484543305615860, -0.536656314599950, -0.240838026661216, -0.415691340057270, 0.000000000000000,  0.000000000000000,  -0.906571096311375,
        -0.600741729938727, -0.698758921060975, -0.492639227670441, 0.000000000000000,  0.000000000000000,  -0.302020288033619, 0.035810452462622,
        -1.570227199484722, -1.040515198480697, -0.052909420917736, -0.023922485090782, 0.000000000000000,  0.000000000000000,  0.185157901119025,
        0.074162538646558,  -0.453285548155688, -0.300370864969363, 0.273714261909630,  -0.060890967176483, -0.764160617383658, -0.692820323027551,
        -0.788432064676939, -0.730931082516425, 0.000000000000000,  0.000000000000000,  -0.084311250880046, 0.083012556633016,  -1.323565014451697,
        -1.200000000000000, -0.014874617587455, -0.052794163140889, 0.000000000000000,  0.000000000000000,  0.110968847432625,  0.132293774682864,
        -0.382080308691829, -0.346410161513775, 0.070742684223526,  -0.134577604380682, -0.175761420896412, -0.153569489248257, -0.693054791987230,
        -0.209067817096111, -0.288371495757850, -0.057593391330407, 0.000000000000000,  0.000000000000000,  -0.029474353477041, 0.013674726993827,
        -1.028919524700824, -0.310385212661127, 0.120201591418860,  -0.034064891030915, 0.000000000000000,  0.000000000000000,  0.466167489382613,
        0.261101070434319,  -0.297023482280241, -0.089600493041190, -0.206847624476151, -0.249505525113448, -0.357527443171074, -0.395979797464467,
        0.051141343518884,  0.101669202997390,  0.000000000000000,  0.000000000000000,  -0.024800551231269, -0.070153685985279, -0.530790597147852,
        -0.587877538267963, -0.220908331585302, -0.351661193426601, 0.000000000000000,  0.000000000000000,  0.218002622418384,  0.209622145665206,
        -0.153226047073317, -0.169705627484772, 0.000000000000000,  0.000000000000000,  0.622088629640037,  0.328059583270829,  1.110318300759208,
        0.735755352773366,  -0.157773533313726, 0.089543839237760,  0.000000000000000,  0.000000000000000,  -0.036869110811297, -0.041122082863041,
        -2.220636601518415, -1.471510705546733, 0.063066984198546,  -0.170202422864314, 0.000000000000000,  0.000000000000000,  1.403319138976287,
        0.651197331251719,  0.000000000000000,  0.000000000000000,  0.617890127831780,  0.455417355094521,  0.935901797060066,  0.848528137423857,
        -0.001578410965419, 0.176302909410140,  0.000000000000000,  0.000000000000000,  -0.057096563095876, -0.062207322598847, -1.871803594120131,
        -1.697056274847714, -0.089917965114865, -0.316303476227972, 0.000000000000000,  0.000000000000000,  1.297411148782676,  0.888109836725050,
        0.391907535190519,  0.312750366249985,  0.000000000000000,  0.000000000000000,  -0.127426820080180, -0.009009931014160, 0.727555973211192,
        0.219475488652711,  -0.032521021863281, -0.041006622505647, 0.000000000000000,  0.000000000000000,  0.027613732851998,  -0.051572591615533,
        -1.697630604159448, -0.512109473522994, 0.864421375026697,  0.617174145050338,  0.000000000000000,  0.000000000000000,  0.362312432103147,
        0.405449435734056,  0.000000000000000,  0.000000000000000,  0.080761344645112,  0.136224816653305,  0.375325630633303,  0.415692193816531,
        -0.062325604531639, -0.076188099315940, 0.000000000000000,  0.000000000000000,  -0.176081654990981, -0.267839159126271, -0.875759804811040,
        -0.969948452238572, 0.663143552491504,  0.722138445535792,  0.000000000000000,  0.000000000000000,  0.453285548155688,  0.300370864969363,
        1.319990814294474,  0.593104471853524,  0.000000000000000,  0.000000000000000,  0.122596547738858,  -0.149424508799343, 3.140454398969443,
        2.081030396961393,  -0.146868652347793, -0.042783207967624, 0.000000000000000,  0.000000000000000,  0.424445311486820,  -0.080815266414326,
        -0.906571096311375, -0.600741729938727, -0.513205534882125, -0.446349452247819, 0.382080308691829,  0.346410161513775,  1.185336050051191,
        0.815138315505655,  0.000000000000000,  0.000000000000000,  -0.043821057739518, -0.287130162077783, 2.647130028903395,  2.400000000000001,
        -0.163532152715610, -0.015008741535538, 0.000000000000000,  0.000000000000000,  0.103731485244220,  -0.171902865549281, -0.764160617383658,
        -0.692820323027551, -0.663193178917010, -0.674635001289340, 0.830600064223088,  0.524022098779922,  0.297023482280241,  0.089600493041190,
        0.174079334185853,  0.078736450076578,  0.000000000000000,  0.000000000000000,  -0.164540681252948, -0.152586474066068, 2.400812224301923,
        0.724232162875964,  0.405605535620235,  0.069917841747461,  0.000000000000000,  0.000000000000000,  -0.037398331192733, -0.085740306910662,
        -0.693054791987229, -0.209067817096111, 0.504200020893814,  0.524778191755280,  0.153226047073317,  0.169705627484771,  0.111170862481392,
        0.162026122059872,  0.000000000000000,  0.000000000000000,  -0.084356933708748, -0.010140421063098, 1.238511393344988,  1.371714255958581,
        -0.117186482470651, -0.210537152959000, 0.000000000000000,  0.000000000000000,  -0.154305348971414, -0.199948843325129, -0.357527443171074,
        -0.395979797464467, 0.000000000000000,  0.000000000000000,  0.228323204393321,  -0.164323800289803, 1.433414762609910,  0.949856076058071,
        0.379176378290147,  0.031821159717312,  0.000000000000000,  0.000000000000000,  0.635360906417294,  0.159997183334981,  2.866829525219819,
        1.899712152116142,  -0.072013325240672, -0.038380224046773, 0.000000000000000,  0.000000000000000,  -0.476626243198114, -0.202461113455018,
        0.000000000000000,  0.000000000000000,  0.010767136762955,  -0.339410557878026, 1.208244024566409,  1.095445115010332,  0.188340068408734,
        0.018493386835508,  0.000000000000000,  0.000000000000000,  0.443282060054401,  0.189889418807198,  2.416488049132819,  2.190890230020665,
        -0.104647692443089, -0.031871096354729, 0.000000000000000,  0.000000000000000,  -0.420679148737850, -0.272178121603544, 0.259686039702472,
        0.250067316600438,  0.000000000000000,  0.000000000000000,  0.147342061148908,  -0.024284848542652, 0.939270722560225,  0.283341637484229,
        0.877839905293030,  0.468533645182926,  0.000000000000000,  0.000000000000000,  -0.468443941196779, -0.346377009373116, 2.191631685973859,
        0.661130487463201,  -0.437962831019237, -0.299285815746346, 0.000000000000000,  0.000000000000000,  0.441517484410314,  0.603806510827318,
        0.000000000000000,  0.000000000000000,  -0.058134720453727, -0.045058800292770, 0.484543305615860,  0.536656314599950,  0.371546148194085,
        0.348818544972637,  0.000000000000000,  0.000000000000000,  -0.241494644249909, -0.148705483384082, 1.130601046437006,  1.252198067399883,
        -0.310437211173738, -0.333348758538937, 0.000000000000000,  0.000000000000000,  1.755567379083479,  1.163331357712261,  0.022683280868901,
        0.008031685997141,  0.000000000000000,  0.000000000000000,  0.374383281273459,  0.175287521170466,  0.000000000000000,  0.000000000000000,
        0.064092881452676,  0.014930767184026,  0.000000000000000,  0.000000000000000,  -0.632290980784413, -0.276555979367282, 3.511134758166959,
        2.326662715424523,  -0.159150664759059, -0.031981676659751, 1.479790672477243,  1.341640786499874,  0.027251523804795,  0.004284156531433,
        0.000000000000000,  0.000000000000000,  0.346161374068581,  0.240050788421345,  0.000000000000000,  -0.000000000000000, 0.042219901688964,
        0.017742374000505,  0.000000000000000,  0.000000000000000,  -0.568137242227518, -0.372988170283940, 2.959581344954486,  2.683281572999748,
        -0.112293477994165, -0.028285947964306, 0.269115402102897,  0.340185049053877,  1.150367000303908,  0.347021217360504,  0.578702069007678,
        0.425794374227888,  0.000000000000000,  0.000000000000000,  0.117683356720615,  0.068491317050056,  0.000000000000000,  -0.000000000000000,
        -1.086718008340776, -0.802769641068421, 0.000000000000000,  0.000000000000000,  0.218905464619071,  0.398199437702308,  2.684189667375785,
        0.809716173841177,  0.608895985691885,  0.816154441895411,  0.593441928520151,  0.657267069006200,  0.470187383374556,  0.517751491606760,
        0.000000000000000,  0.000000000000000,  0.062311659192122,  0.063370804016576,  -0.000000000000000, -0.000000000000000, -0.883045361934896,
        -0.969934490628461, 0.000000000000000,  0.000000000000000,  0.840757384542529,  1.179004219452735,  1.384697833213687,  1.533623161014466};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 28, 20));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeFFForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix amomxmat(28, 28);

    CDenseMatrix amomymat(28, 28);

    CDenseMatrix amomzmat(28, 28);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  -0.000000000000000, -0.615668331356208, -0.833587560013567, -0.000000000000000, -0.000000000000000, 0.827332012207712,
        0.469110243689903,  -0.000000000000000, -0.000000000000000, -0.842980678871298, -0.687195746334220, 0.000000000000000,  0.000000000000000,
        0.739991729527061,  0.339119088161082,  -0.000000000000000, -0.000000000000000, 0.627634037202723,  0.421728470312110,  -1.224744871391588,
        -1.061971377453528, 0.502442545517825,  -0.088256205098381, -0.000000000000000, -0.000000000000000, 0.085032308531739,  0.128077331601126,
        0.000000000000000,  0.000000000000000,  -0.786625733054938, -1.207510364520931, 0.000000000000000,  -0.000000000000000, 0.639089559878430,
        0.604351735729181,  0.000000000000000,  -0.000000000000000, -0.795468215162363, -0.935695014660148, 0.000000000000000,  -0.000000000000000,
        0.525731178551351,  0.410528804942101,  0.000000000000000,  -0.000000000000000, 0.516681953724833,  0.568943917327185,  -1.061971377453528,
        -1.224744871391589, 0.185860316491185,  -0.257105512933187, 0.000000000000000,  -0.000000000000000, 0.116106046617918,  0.187610539152999,
        0.615668331356208,  0.786625733054938,  0.000000000000001,  -0.000000000000000, -0.566173323875331, -0.415406480241251, 0.000000000000000,
        0.000000000000000,  0.688053395396414,  0.534294327582287,  -0.000000000000000, -0.000000000000000, -0.564321187542723, -0.368515794373190,
        -0.000000000000000, 0.000000000000000,  -0.625848814978583, -0.392708144546343, -0.000000000000000, 0.000000000000000,  -0.347218117943880,
        -0.032107501581802, -1.224744871391589, -0.646635859710682, 0.118776526142058,  0.133612641356554,  0.000000000000001,  0.000000000000000,
        0.833587560013567,  1.207510364520931,  0.000000000000000,  0.000000000000000,  -0.297926150263778, -0.382548850402710, 0.000000000000000,
        -0.000000000000000, 0.362315782597955,  0.444147694772510,  0.000000000000000,  -0.000000000000000, -0.208458604350134, -0.234777975438139,
        0.000000000000000,  0.000000000000000,  -0.226778371335979, -0.262919375590811, -0.000000000000000, -0.000000000000000, 0.133792436445767,
        0.232914526321374,  -0.646635859710681, -1.224744871391589, 0.135992064331394,  0.195724312565245,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.566173323875331,  0.297926150263778,  0.000000000000000,  -0.000000000000000, 1.106368762580656,
        0.721248618215577,  -0.000000000000000, -0.000000000000000, -0.995265486165284, -0.180852814279058, -0.000000000000000, -0.000000000000000,
        0.693467814754160,  0.406111428025394,  -1.581138830084189, -1.370999153008821, -0.484732027372784, -0.409824698068523, -0.000000000000000,
        -0.000000000000000, 0.463874993251936,  0.191728177521230,  -1.224744871391588, -1.061971377453528, 0.024579063942749,  0.204288030395442,
        0.000000000000000,  0.000000000000000,  0.415406480241251,  0.382548850402710,  0.000000000000000,  0.000000000000000,  0.951153931910058,
        0.930573443774208,  0.000000000000000,  -0.000000000000000, -0.514833154856214, -0.130391862205951, 0.000000000000000,  -0.000000000000000,
        0.492099826226314,  0.564403691949121,  -1.370999153008821, -1.581138830084190, -0.453986091222645, -0.586461766260033, 0.000000000000000,
        -0.000000000000000, 0.257642006202249,  0.265900627134527,  -1.061971377453528, -1.224744871391589, 0.141817468455604,  0.301099941419485,
        -0.827332012207712, -0.639089559878430, -0.000000000000000, -0.000000000000000, -1.106368762580656, -0.951153931910058, 0.000000000000001,
        -0.000000000000000, 0.905807828986932,  0.548476480781490,  0.000000000000000,  0.000000000000000,  -0.874870920960660, -0.607913003462014,
        0.000000000000000,  0.000000000000000,  0.828794265511472,  0.877357568297792,  -1.581138830084189, -0.834803305239995, -0.382049117642216,
        -0.025712130142527, 0.000000000000001,  0.000000000000000,  0.105277839434006,  -0.017552265837776, -1.224744871391589, -0.646635859710681,
        -0.469110243689903, -0.604351735729181, -0.000000000000000, 0.000000000000000,  -0.721248618215577, -0.930573443774208, 0.000000000000000,
        0.000000000000000,  0.317912278225320,  0.371501229995418,  0.000000000000000,  -0.000000000000000, -0.411409938876205, -0.516928506307990,
        -0.000000000000000, -0.000000000000000, 0.762673146428677,  1.008843279359749,  -0.834803305239995, -1.581138830084190, 0.151899241239513,
        0.274571575124863,  0.000000000000000,  -0.000000000000000, -0.182467667854417, -0.355630036623976, -0.646635859710682, -1.224744871391589,
        0.000000000000000,  -0.000000000000000, -0.688053395396414, -0.362315782597955, 0.000000000000000,  -0.000000000000000, -0.905807828986932,
        -0.317912278225320, 0.000000000000000,  -0.000000000000000, 0.090601778285292,  0.318163884967647,  -2.449489742783177, -2.123942754907056,
        1.204101803478260,  0.352757270855424,  -0.000000000000000, -0.000000000000000, 0.639688652860514,  0.056746448393564,  -1.581138830084188,
        -1.370999153008821, 1.460008867102669,  0.850950041480177,  -0.000000000000000, -0.000000000000000, 0.423583419058514,  0.062894946297991,
        0.000000000000000,  0.000000000000000,  -0.534294327582287, -0.444147694772510, 0.000000000000000,  0.000000000000000,  -0.548476480781490,
        -0.371501229995418, 0.000000000000000,  0.000000000000000,  0.227020215992426,  0.497177968966634,  -2.123942754907056, -2.449489742783179,
        0.664432134661557,  0.375337135631710,  0.000000000000000,  -0.000000000000000, 0.261371502832225,  0.016929655819148,  -1.370999153008821,
        -1.581138830084190, 1.132493288799599,  1.091079283085066,  0.000000000000000,  -0.000000000000000, 0.184777990756618,  0.051865435543877,
        0.842980678871298,  0.795468215162363,  0.000000000000000,  -0.000000000000000, 0.995265486165284,  0.514833154856214,  -0.000000000000000,
        -0.000000000000000, -0.090601778285292, -0.227020215992426, 0.000000000000001,  -0.000000000000000, -0.801256975796189, 0.073071717410986,
        -2.449489742783177, -1.293271719421363, -0.859279727981596, -0.331546162676869, 0.000000000000000,  0.000000000000000,  -1.235417664473212,
        -0.749690389378831, -1.581138830084189, -0.834803305239995, -0.613260486466259, -0.247115520957800, -0.000000000000000, -0.000000000000000,
        0.687195746334220,  0.935695014660148,  0.000000000000000,  0.000000000000000,  0.180852814279058,  0.130391862205951,  -0.000000000000000,
        0.000000000000000,  -0.318163884967647, -0.497177968966634, 0.000000000000000,  0.000000000000000,  0.438908376993703,  0.698756559431875,
        -1.293271719421363, -2.449489742783178, 0.021386280246027,  0.161544248705065,  0.000000000000000,  -0.000000000000000, -0.469320109754248,
        -0.597657397687062, -0.834803305239995, -1.581138830084189, -0.007802251183609, 0.078451694281112,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, -0.000000000000000, 0.564321187542723,  0.208458604350134,  0.000000000000000,  -0.000000000000000, 0.874870920960660,
        0.411409938876205,  2.449489742783177,  2.123942754907056,  0.801256975796189,  -0.438908376993703, 0.000000000000000,  -0.000000000000000,
        -0.901681832354329, -0.018087430604490, -0.000000000000000, -0.000000000000000, 0.590348403369761,  -0.041024360459209, -0.000000000000000,
        -0.000000000000000, 0.087058229607396,  -0.151289207921985, -0.000000000000000, -0.000000000000000, 0.961209078015949,  0.354560060269183,
        -0.000000000000000, 0.000000000000000,  0.368515794373190,  0.234777975438139,  0.000000000000000,  0.000000000000000,  0.607913003462014,
        0.516928506307990,  2.123942754907056,  2.449489742783179,  -0.073071717410986, -0.698756559431875, 0.000000000000000,  0.000000000000000,
        -0.507892505009604, 0.204576739927754,  0.000000000000000,  -0.000000000000000, 0.152775607142110,  -0.111587758277068, 0.000000000000000,
        -0.000000000000000, -0.062754489200084, -0.249705923690920, 0.000000000000000,  -0.000000000000000, 0.631827830463902,  0.395661508246190,
        -0.739991729527061, -0.525731178551351, 0.000000000000000,  -0.000000000000000, -0.693467814754160, -0.492099826226314, -0.000000000000000,
        0.000000000000000,  -1.204101803478260, -0.664432134661557, 2.449489742783177,  1.293271719421363,  0.901681832354329,  0.507892505009604,
        0.000000000000001,  -0.000000000000000, -0.421129286268560, -0.066808802652929, -0.000000000000000, -0.000000000000000, -0.318620278812534,
        0.004710594230569,  0.000000000000000,  -0.000000000000000, -1.106286186149553, -0.847812123273312, 0.000000000000000,  -0.000000000000000,
        -0.339119088161082, -0.410528804942101, -0.000000000000000, -0.000000000000000, -0.406111428025394, -0.564403691949121, -0.000000000000000,
        0.000000000000000,  -0.352757270855424, -0.375337135631710, 1.293271719421363,  2.449489742783178,  0.018087430604490,  -0.204576739927754,
        0.000000000000000,  0.000000000000000,  0.021161680612966,  0.032888528804563,  -0.000000000000000, -0.000000000000000, 0.255261042045357,
        0.470162493193033,  0.000000000000000,  -0.000000000000000, -0.582502910394952, -0.722076592423158, 0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.625848814978583,  0.226778371335979,  1.581138830084189,  1.370999153008821,  -0.828794265511472,
        -0.762673146428677, 0.000000000000000,  -0.000000000000000, 0.859279727981596,  -0.021386280246027, 0.000000000000000,  -0.000000000000000,
        0.421129286268560,  -0.021161680612966, 0.000000000000000,  -0.000000000000000, -0.461484397339920, 0.332622947805979,  -0.000000000000000,
        -0.000000000000000, -0.785669013676636, -0.438752559403357, -0.000000000000000, -0.000000000000000, -0.544808470507709, -0.323097645924350,
        0.000000000000000,  0.000000000000000,  0.392708144546343,  0.262919375590811,  1.370999153008821,  1.581138830084190,  -0.877357568297792,
        -1.008843279359749, 0.000000000000000,  0.000000000000000,  0.331546162676869,  -0.161544248705065, 0.000000000000000,  0.000000000000000,
        0.066808802652929,  -0.032888528804563, 0.000000000000000,  0.000000000000000,  -0.078221340503275, 0.667843901989033,  0.000000000000000,
        -0.000000000000000, -0.673442457275954, -0.513326850777754, 0.000000000000000,  -0.000000000000000, -0.457511678692780, -0.400851277390073,
        -0.627634037202723, -0.516681953724833, 0.000000000000000,  0.000000000000000,  0.484732027372784,  0.453986091222645,  1.581138830084189,
        0.834803305239995,  -0.639688652860514, -0.261371502832225, -0.000000000000000, -0.000000000000000, -0.590348403369761, -0.152775607142110,
        0.000000000000000,  0.000000000000000,  0.461484397339920,  0.078221340503275,  0.000000000000001,  -0.000000000000000, 0.615941398548192,
        0.497479630999876,  -0.000000000000000, -0.000000000000000, 0.712577884329849,  0.707567437965252,  -0.000000000000000, -0.000000000000000,
        -0.421728470312110, -0.568943917327185, -0.000000000000000, 0.000000000000000,  0.409824698068523,  0.586461766260033,  0.834803305239995,
        1.581138830084190,  -0.056746448393564, -0.016929655819148, -0.000000000000000, 0.000000000000000,  0.041024360459209,  0.111587758277068,
        0.000000000000000,  0.000000000000000,  -0.332622947805979, -0.667843901989033, 0.000000000000000,  0.000000000000000,  0.313406233394483,
        0.362518383731438,  -0.000000000000000, -0.000000000000000, 0.631859859224251,  0.869473983622817,  0.000000000000000,  -0.000000000000000,
        1.224744871391588,  1.061971377453528,  0.347218117943880,  -0.133792436445767, 0.000000000000000,  -0.000000000000000, 0.382049117642216,
        -0.151899241239513, 1.581138830084188,  1.370999153008821,  1.235417664473212,  0.469320109754248,  0.000000000000000,  -0.000000000000000,
        0.318620278812534,  -0.255261042045357, 0.000000000000000,  -0.000000000000000, -0.615941398548192, -0.313406233394483, 0.000000000000000,
        -0.000000000000000, 1.094514800592920,  0.681625946204093,  -0.000000000000000, -0.000000000000000, 0.182349331215353,  0.221951838861147,
        1.061971377453528,  1.224744871391589,  0.032107501581802,  -0.232914526321374, 0.000000000000000,  0.000000000000000,  0.025712130142527,
        -0.274571575124863, 1.370999153008821,  1.581138830084190,  0.749690389378831,  0.597657397687062,  0.000000000000000,  0.000000000000000,
        -0.004710594230569, -0.470162493193033, 0.000000000000000,  0.000000000000000,  -0.497479630999876, -0.362518383731438, 0.000000000000000,
        0.000000000000000,  0.906552506789003,  0.879474567071731,  0.000000000000000,  -0.000000000000000, 0.231539742710642,  0.308398846522028,
        -0.502442545517825, -0.185860316491185, 1.224744871391589,  0.646635859710681,  -0.463874993251936, -0.257642006202249, -0.000000000000001,
        -0.000000000000000, -1.460008867102669, -1.132493288799599, 1.581138830084189,  0.834803305239995,  -0.087058229607396, 0.062754489200084,
        -0.000000000000000, -0.000000000000000, 0.785669013676636,  0.673442457275954,  0.000000000000000,  0.000000000000000,  -1.094514800592920,
        -0.906552506789003, 0.000000000000001,  -0.000000000000000, -0.403393561508068, -0.418167654909550, -0.000000000000000, -0.000000000000000,
        0.088256205098381,  0.257105512933187,  0.646635859710682,  1.224744871391589,  -0.191728177521230, -0.265900627134527, -0.000000000000000,
        0.000000000000000,  -0.850950041480177, -1.091079283085066, 0.834803305239995,  1.581138830084189,  0.151289207921985,  0.249705923690920,
        0.000000000000000,  0.000000000000000,  0.438752559403357,  0.513326850777754,  0.000000000000000,  0.000000000000000,  -0.681625946204093,
        -0.879474567071731, 0.000000000000000,  0.000000000000000,  -0.365971571726016, -0.496298588004193, -0.000000000000000, -0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.118776526142058, -0.135992064331394, 1.224744871391588,  1.061971377453528,  -0.105277839434006,
        0.182467667854417,  0.000000000000000,  -0.000000000000000, 0.613260486466259,  0.007802251183609,  0.000000000000000,  -0.000000000000000,
        1.106286186149553,  0.582502910394952,  0.000000000000000,  -0.000000000000000, -0.712577884329849, -0.631859859224251, 0.000000000000000,
        -0.000000000000000, 0.403393561508068,  0.365971571726016,  0.000000000000000,  -0.000000000000000, -0.804333357665318, -0.874854581998452,
        0.000000000000000,  0.000000000000000,  -0.133612641356554, -0.195724312565245, 1.061971377453528,  1.224744871391589,  0.017552265837776,
        0.355630036623976,  0.000000000000000,  0.000000000000000,  0.247115520957800,  -0.078451694281112, 0.000000000000000,  0.000000000000000,
        0.847812123273312,  0.722076592423158,  0.000000000000000,  0.000000000000000,  -0.707567437965252, -0.869473983622817, 0.000000000000000,
        0.000000000000000,  0.418167654909550,  0.496298588004193,  0.000000000000000,  0.000000000000000,  -0.880387033475920, -1.249407316363251,
        -0.085032308531739, -0.116106046617918, -0.000000000000001, -0.000000000000000, -0.024579063942749, -0.141817468455604, 1.224744871391589,
        0.646635859710682,  -0.423583419058514, -0.184777990756618, 0.000000000000000,  -0.000000000000000, -0.961209078015949, -0.631827830463902,
        -0.000000000000000, -0.000000000000000, 0.544808470507709,  0.457511678692780,  0.000000000000000,  -0.000000000000000, -0.182349331215353,
        -0.231539742710642, 0.000000000000000,  0.000000000000000,  0.804333357665318,  0.880387033475920,  0.000000000000001,  -0.000000000000000,
        -0.128077331601126, -0.187610539152999, -0.000000000000000, 0.000000000000000,  -0.204288030395442, -0.301099941419485, 0.646635859710681,
        1.224744871391589,  -0.062894946297991, -0.051865435543877, 0.000000000000000,  0.000000000000000,  -0.354560060269183, -0.395661508246190,
        0.000000000000000,  0.000000000000000,  0.323097645924350,  0.400851277390073,  0.000000000000000,  0.000000000000000,  -0.221951838861147,
        -0.308398846522028, 0.000000000000000,  0.000000000000000,  0.874854581998452,  1.249407316363251,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 28, 28));

    std::vector<double> intyvals{
        0.000000000000000,  -0.000000000000000, 0.429174911515918,  0.591133365375075,  1.224744871391588,  1.061971377453528,  0.387300055155428,
        0.524992368796121,  -0.000000000000000, -0.000000000000000, -0.301872604070434, -0.400192419958874, -0.000000000000000, -0.000000000000000,
        1.492244166376914,  0.719148960462044,  -0.000000000000000, -0.000000000000000, -0.355692893873541, -0.517290197767733, -0.000000000000000,
        -0.000000000000000, -0.869365709350231, -0.483245984667552, -0.000000000000000, -0.000000000000000, 0.062859405149879,  0.177885725578743,
        0.000000000000000,  0.000000000000000,  0.547421330002228,  0.862733884073661,  1.061971377453528,  1.224744871391590,  0.441412359912771,
        0.812756205176458,  0.000000000000000,  -0.000000000000000, -0.399697680897263, -0.564779934625598, 0.000000000000000,  -0.000000000000000,
        1.089568800357634,  0.878183613556971,  0.000000000000000,  -0.000000000000000, -0.493971591112500, -0.741589074308442, 0.000000000000000,
        -0.000000000000000, -0.674642952378443, -0.613160961967016, 0.000000000000000,  -0.000000000000000, 0.141898997192278,  0.266956486196764,
        -0.429174911515918, -0.547421330002228, -0.000000000000000, 0.000000000000000,  -0.305969919923362, -0.389542708212228, 1.224744871391589,
        0.646635859710681,  0.145736963489195,  0.220457971818441,  0.000000000000000,  -0.000000000000000, -1.183538541894903, -0.778121413336286,
        -0.000000000000000, -0.000000000000000, 0.310074568980956,  0.318625247393645,  0.000000000000000,  -0.000000000000000, 0.612385331112419,
        0.453064230083849,  -0.000000000000000, -0.000000000000000, 0.242853846860815,  0.232679034769430,  0.000000000000002,  -0.000000000000000,
        -0.591133365375075, -0.862733884073661, -0.000000000000000, 0.000000000000000,  -0.413182009296927, -0.585178573902584, 0.646635859710681,
        1.224744871391589,  0.194998833068280,  0.256641180786113,  0.000000000000000,  -0.000000000000000, -0.440530186655502, -0.495326572792700,
        0.000000000000000,  -0.000000000000000, 0.250077916252643,  0.320164454714026,  0.000000000000000,  -0.000000000000000, 0.312996003172096,
        0.392309405199007,  0.000000000000000,  -0.000000000000000, 0.218218368320038,  0.308045791380602,  0.000000000000000,  -0.000000000000000,
        -1.224744871391588, -1.061971377453528, 0.305969919923362,  0.413182009296927,  0.000000000000000,  -0.000000000000000, -0.259744150826315,
        -0.354781603121638, 1.581138830084189,  1.370999153008821,  0.106547246434643,  0.142221579236546,  -0.000000000000000, -0.000000000000000,
        0.109063349305917,  -0.266516722247679, -0.000000000000000, -0.000000000000000, 1.308782751363462,  0.181296952866704,  -0.000000000000000,
        -0.000000000000000, 0.238005127919832,  0.282340347845676,  -0.000000000000000, -0.000000000000000, 0.252150604963180,  0.240658838347166,
        -1.061971377453528, -1.224744871391590, 0.389542708212228,  0.585178573902584,  0.000000000000000,  0.000000000000000,  -0.416847112600420,
        -0.454649396015993, 1.370999153008821,  1.581138830084190,  0.077703770197726,  0.264877479017662,  0.000000000000000,  -0.000000000000000,
        -0.075649348698193, -0.470143348655460, 0.000000000000000,  -0.000000000000000, 0.609905553730432,  0.108416012567695,  0.000000000000000,
        -0.000000000000000, 0.248583783623894,  0.425573334863535,  0.000000000000000,  -0.000000000000000, 0.278819541919901,  0.321628947124726,
        -0.387300055155428, -0.441412359912771, -1.224744871391589, -0.646635859710681, 0.259744150826315,  0.416847112600420,  -0.000000000000000,
        0.000000000000000,  -0.305774192267655, -0.359981338046297, 1.581138830084190,  0.834803305239995,  0.131854686846439,  0.160387675410178,
        -0.000000000000000, -0.000000000000000, -1.211175622908378, -0.656849150064079, -0.000000000000000, -0.000000000000000, -0.115266314505252,
        0.099311030465690,  0.000000000000001,  -0.000000000000000, -0.477373145350464, -0.467551811461395, -0.000000000000000, -0.000000000000000,
        -0.524992368796121, -0.812756205176458, -0.646635859710681, -1.224744871391589, 0.354781603121638,  0.454649396015993,  -0.000000000000000,
        0.000000000000000,  -0.397686060427134, -0.571471363362403, 0.834803305239995,  1.581138830084190,  0.188372488216521,  0.284127654008828,
        0.000000000000000,  -0.000000000000000, -0.335327547623755, -0.373252005437855, 0.000000000000000,  -0.000000000000000, 0.233100780295439,
        0.385134968525549,  0.000000000000000,  -0.000000000000000, -0.385612683142702, -0.510480017165352, 0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.145736963489195, -0.194998833068280, -1.581138830084189, -1.370999153008821, 0.305774192267655,
        0.397686060427134,  0.000000000000000,  -0.000000000000000, -0.188936829380405, -0.194499765181073, -0.000000000000000, -0.000000000000000,
        -0.366890302085549, -0.010266367090538, -0.000000000000000, -0.000000000000000, -0.555560837733166, 0.044337879506564,  -0.000000000000000,
        -0.000000000000000, -0.251645155787634, -0.253163870232237, -0.000000000000000, -0.000000000000000, 0.611214630755163,  0.327929711932358,
        0.000000000000000,  0.000000000000000,  -0.220457971818441, -0.256641180786113, -1.370999153008821, -1.581138830084190, 0.359981338046297,
        0.571471363362403,  0.000000000000000,  0.000000000000000,  -0.127413435363690, -0.327078746662622, 0.000000000000000,  -0.000000000000000,
        -0.080434934248228, -0.012655621703545, 0.000000000000000,  -0.000000000000000, -0.253521240252227, 0.196233464593925,  0.000000000000000,
        -0.000000000000000, -0.333797993416259, -0.307927633433135, 0.000000000000000,  -0.000000000000000, 0.479531286987478,  0.403284643598487,
        0.301872604070434,  0.399697680897263,  -0.000000000000000, -0.000000000000000, -0.106547246434643, -0.077703770197726, -1.581138830084190,
        -0.834803305239995, 0.188936829380405,  0.127413435363690,  -0.000000000000000, 0.000000000000000,  0.536109419186750,  0.166401738737409,
        -0.000000000000000, -0.000000000000000, 0.226174225051543,  0.148259250485263,  0.000000000000001,  -0.000000000000000, 0.073768069382456,
        0.171135437548551,  -0.000000000000000, -0.000000000000000, -0.748785049681349, -0.718774152801189, 0.000000000000000,  -0.000000000000000,
        0.400192419958874,  0.564779934625598,  0.000000000000000,  0.000000000000000,  -0.142221579236546, -0.264877479017662, -0.834803305239995,
        -1.581138830084190, 0.194499765181073,  0.327078746662622,  -0.000000000000000, 0.000000000000000,  -0.009596312755706, -0.066043607768960,
        0.000000000000000,  -0.000000000000000, 0.072861213452823,  0.071477392192393,  0.000000000000000,  -0.000000000000000, 0.144788675034153,
        0.180845791467511,  0.000000000000000,  -0.000000000000000, -0.634687764553343, -0.871493699637145, 0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.000000000000000, 1.183538541894903,  0.440530186655502,  0.000000000000000,  -0.000000000000000, -0.131854686846439,
        -0.188372488216521, 0.000000000000000,  -0.000000000000000, -0.536109419186750, 0.009596312755706,  0.000000000000000,  -0.000000000000000,
        0.372429252760577,  0.004208069254247,  -2.449489742783177, -2.123942754907056, -0.273140650199381, 0.383769378142027,  -0.000000000000000,
        -0.000000000000000, 0.732321122864189,  0.108685936671534,  0.000000000000000,  -0.000000000000000, -0.280920937055813, -0.121576008039990,
        0.000000000000000,  0.000000000000000,  0.778121413336286,  0.495326572792700,  0.000000000000000,  0.000000000000000,  -0.160387675410178,
        -0.284127654008828, 0.000000000000000,  0.000000000000000,  -0.166401738737409, 0.066043607768960,  0.000000000000000,  0.000000000000000,
        0.193890192318192,  -0.079542208164346, -2.123942754907056, -2.449489742783179, 0.191300635632545,  0.575403993862246,  0.000000000000000,
        -0.000000000000000, 0.352642091451206,  0.066907953409792,  -0.000000000000000, 0.000000000000000,  -0.204035498939596, -0.138212409101007,
        -1.492244166376914, -1.089568800357634, 0.000000000000000,  -0.000000000000000, -0.109063349305917, 0.075649348698193,  0.000000000000000,
        -0.000000000000000, 0.366890302085549,  0.080434934248228,  0.000000000000000,  -0.000000000000000, -0.372429252760577, -0.193890192318192,
        -0.000000000000000, 0.000000000000000,  0.817001408799120,  0.617842220180983,  -2.449489742783178, -1.293271719421363, -0.865904740229351,
        -0.332017062003173, 0.000000000000000,  -0.000000000000000, 0.294326533661314,  0.266583314690918,  -0.000000000000000, 0.000000000000000,
        -0.719148960462044, -0.878183613556971, 0.000000000000000,  0.000000000000000,  0.266516722247679,  0.470143348655460,  0.000000000000000,
        0.000000000000000,  0.010266367090538,  0.012655621703545,  0.000000000000000,  0.000000000000000,  -0.004208069254247, 0.079542208164346,
        -0.000000000000000, 0.000000000000000,  0.391344036501898,  0.433107009974251,  -1.293271719421363, -2.449489742783178, 0.018023286282297,
        0.156598370381574,  0.000000000000000,  -0.000000000000000, 0.201982867534171,  0.257991631655894,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.310074568980956, -0.250077916252643, 0.000000000000000,  -0.000000000000000, 1.211175622908378,
        0.335327547623755,  0.000000000000000,  -0.000000000000000, -0.226174225051543, -0.072861213452823, 2.449489742783177,  2.123942754907056,
        -0.817001408799120, -0.391344036501898, 0.000000000000000,  -0.000000000000000, 0.245512088035055,  -0.138826343353756, -1.581138830084188,
        -1.370999153008822, 0.421027528815141,  0.473267482942699,  -0.000000000000000, -0.000000000000000, -1.193269463026898, -0.489857657322684,
        0.000000000000000,  0.000000000000000,  -0.318625247393645, -0.320164454714026, 0.000000000000000,  0.000000000000000,  0.656849150064079,
        0.373252005437855,  0.000000000000000,  0.000000000000000,  -0.148259250485263, -0.071477392192393, 2.123942754907056,  2.449489742783179,
        -0.617842220180983, -0.433107009974251, 0.000000000000000,  0.000000000000000,  -0.047293691356769, -0.213445664516694, -1.370999153008821,
        -1.581138830084190, 0.477422540951820,  0.655328837169978,  0.000000000000000,  -0.000000000000000, -0.804729468816782, -0.577511440631548,
        0.355692893873541,  0.493971591112500,  -0.000000000000000, -0.000000000000000, -1.308782751363462, -0.609905553730432, 0.000000000000000,
        -0.000000000000000, 0.555560837733166,  0.253521240252227,  -0.000000000000001, -0.000000000000000, 0.273140650199381,  -0.191300635632545,
        2.449489742783178,  1.293271719421363,  -0.245512088035055, 0.047293691356769,  -0.000000000000000, 0.000000000000000,  -0.118492665505086,
        -0.128197525805604, -1.581138830084190, -0.834803305239995, 1.562282628373127,  1.181066051684061,  -0.000000000000000, -0.000000000000000,
        0.517290197767733,  0.741589074308442,  0.000000000000000,  0.000000000000000,  -0.181296952866704, -0.108416012567695, 0.000000000000000,
        0.000000000000000,  -0.044337879506564, -0.196233464593925, 0.000000000000000,  0.000000000000000,  -0.383769378142027, -0.575403993862246,
        1.293271719421363,  2.449489742783178,  0.138826343353756,  0.213445664516694,  -0.000000000000000, 0.000000000000000,  -0.212925075676484,
        -0.372717518713486, -0.834803305239995, -1.581138830084189, 0.839696283789739,  1.066233483066337,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.612385331112419, -0.312996003172096, 0.000000000000000,  -0.000000000000000, 0.115266314505252,
        -0.233100780295439, 0.000000000000000,  -0.000000000000000, -0.073768069382456, -0.144788675034153, 0.000000000000000,  -0.000000000000000,
        0.865904740229351,  -0.018023286282297, 1.581138830084188,  1.370999153008821,  0.118492665505086,  0.212925075676484,  0.000000000000000,
        -0.000000000000000, -1.185509695024762, -0.424631916037264, -1.224744871391589, -1.061971377453528, -0.082182282005534, 0.335612213552162,
        0.000000000000000,  0.000000000000000,  -0.453064230083849, -0.392309405199007, 0.000000000000000,  0.000000000000000,  -0.099311030465690,
        -0.385134968525549, 0.000000000000000,  0.000000000000000,  -0.171135437548551, -0.180845791467511, 0.000000000000000,  0.000000000000000,
        0.332017062003173,  -0.156598370381574, 1.370999153008822,  1.581138830084190,  0.128197525805604,  0.372717518713486,  0.000000000000000,
        0.000000000000000,  -0.757209714546305, -0.478298295982249, -1.061971377453528, -1.224744871391589, 0.202664078420246,  0.509298537676228,
        0.869365709350231,  0.674642952378443,  0.000000000000000,  -0.000000000000000, -0.238005127919832, -0.248583783623894, -0.000000000000001,
        -0.000000000000000, 0.251645155787634,  0.333797993416259,  0.000000000000000,  -0.000000000000000, -0.732321122864189, -0.352642091451206,
        -0.000000000000000, -0.000000000000000, -0.421027528815141, -0.477422540951820, 1.581138830084190,  0.834803305239995,  1.185509695024762,
        0.757209714546305,  -0.000000000000000, 0.000000000000000,  0.046757982667386,  -0.214702235722566, -1.224744871391589, -0.646635859710682,
        0.483245984667552,  0.613160961967016,  0.000000000000000,  0.000000000000000,  -0.282340347845676, -0.425573334863535, 0.000000000000000,
        0.000000000000000,  0.253163870232237,  0.307927633433135,  0.000000000000000,  0.000000000000000,  -0.108685936671534, -0.066907953409792,
        0.000000000000000,  0.000000000000000,  -0.473267482942699, -0.655328837169978, 0.834803305239995,  1.581138830084189,  0.424631916037264,
        0.478298295982249,  -0.000000000000000, 0.000000000000000,  -0.419115115407051, -0.701860843892522, -0.646635859710682, -1.224744871391589,
        0.000000000000000,  -0.000000000000000, -0.242853846860815, -0.218218368320038, 0.000000000000000,  -0.000000000000000, 0.477373145350464,
        0.385612683142702,  0.000000000000000,  -0.000000000000000, 0.748785049681349,  0.634687764553343,  -0.000000000000000, 0.000000000000000,
        -0.294326533661314, -0.201982867534171, 0.000000000000000,  -0.000000000000000, -1.562282628373127, -0.839696283789739, 1.224744871391589,
        1.061971377453528,  -0.046757982667386, 0.419115115407051,  0.000000000000000,  -0.000000000000000, 0.464153778605704,  0.599181149208607,
        0.000000000000000,  0.000000000000000,  -0.232679034769430, -0.308045791380602, 0.000000000000000,  0.000000000000000,  0.467551811461395,
        0.510480017165352,  0.000000000000000,  0.000000000000000,  0.718774152801189,  0.871493699637145,  0.000000000000000,  -0.000000000000000,
        -0.266583314690918, -0.257991631655894, 0.000000000000000,  0.000000000000000,  -1.181066051684061, -1.066233483066337, 1.061971377453528,
        1.224744871391589,  0.214702235722566,  0.701860843892522,  0.000000000000000,  0.000000000000000,  0.565352442208702,  0.870962662479538,
        -0.062859405149879, -0.141898997192278, -0.000000000000002, -0.000000000000000, -0.252150604963180, -0.278819541919901, 0.000000000000000,
        -0.000000000000000, -0.611214630755163, -0.479531286987478, -0.000000000000000, -0.000000000000000, 0.280920937055813,  0.204035498939596,
        0.000000000000000,  0.000000000000000,  1.193269463026898,  0.804729468816782,  0.000000000000000,  -0.000000000000000, 0.082182282005534,
        -0.202664078420246, 1.224744871391589,  0.646635859710682,  -0.464153778605704, -0.565352442208702, -0.000000000000000, 0.000000000000000,
        -0.177885725578743, -0.266956486196764, 0.000000000000000,  0.000000000000000,  -0.240658838347166, -0.321628947124726, 0.000000000000000,
        0.000000000000000,  -0.327929711932358, -0.403284643598487, 0.000000000000000,  0.000000000000000,  0.121576008039990,  0.138212409101007,
        -0.000000000000000, -0.000000000000000, 0.489857657322684,  0.577511440631548,  0.000000000000000,  0.000000000000000,  -0.335612213552162,
        -0.509298537676228, 0.646635859710682,  1.224744871391589,  -0.599181149208607, -0.870962662479538, -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 28, 28));

    std::vector<double> intzvals{
        0.000000000000000,  -0.000000000000000, -0.096760279384528, -0.137982315561949, -0.000000000000000, -0.000000000000000, -0.147731319400047,
        -0.044595306007139, -0.000000000000000, -0.000000000000000, 0.133686489682969,  0.188835521519032,  -0.000000000000000, -0.000000000000000,
        -0.922958603888563, -0.398354546110317, -0.000000000000000, 0.000000000000000,  -0.067619146403130, 0.087545562404793,  -0.000000000000000,
        -0.000000000000000, 0.165652239435063,  0.042606865236845,  2.999999999999999,  2.601287996201740,  -0.023241007290743, 0.208451833664471,
        0.000000000000000,  0.000000000000000,  -0.122985989616260, -0.204342576044277, 0.000000000000000,  -0.000000000000000, -0.073978551259796,
        -0.057378880105031, 0.000000000000000,  -0.000000000000000, 0.192242997256538,  0.262665751645268,  0.000000000000000,  -0.000000000000000,
        -0.642736037140303, -0.471494163986939, -0.000000000000000, 0.000000000000000,  0.044646995575065,  0.136008088502374,  0.000000000000000,
        -0.000000000000000, 0.099938026456011,  0.037214963090644,  2.601287996201740,  3.000000000000002,  0.039957199055783,  0.423611815658869,
        0.096760279384528,  0.122985989616260,  0.000000000000000,  -0.000000000000000, 0.788335303661331,  0.846927754008875,  -0.000000000000000,
        -0.000000000000000, -0.676829234507047, -0.672277265524040, -0.000000000000000, 0.000000000000000,  1.359605044159566,  0.945211285969615,
        -0.000000000000000, -0.000000000000000, -0.120279719916436, -0.222252003136569, 0.000000000000000,  -0.000000000000000, -0.585061327102545,
        -0.611379506493991, -0.000000000000000, -0.000000000000000, -0.159153629738436, -0.028749470198122, 2.999999999999999,  1.583927905677097,
        0.137982315561949,  0.204342576044277,  0.000000000000000,  0.000000000000000,  0.856843697225974,  1.234869933503085,  0.000000000000000,
        -0.000000000000000, -0.566851969620520, -0.757860804985767, -0.000000000000000, -0.000000000000000, 0.585121659648377,  0.692266138502299,
        0.000000000000000,  -0.000000000000000, -0.233156609234460, -0.329090019662441, 0.000000000000000,  -0.000000000000000, -0.582393254176510,
        -0.820464896332167, 0.000000000000000,  -0.000000000000000, 0.177881515768791,  0.392451473804860,  1.583927905677097,  3.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.788335303661331, -0.856843697225974, 0.000000000000000,  -0.000000000000000, -0.181032634146853,
        0.010665237034418,  -0.000000000000000, -0.000000000000000, 0.074372280746413,  -0.049686431855801, -0.000000000000000, -0.000000000000000,
        -0.198266488962092, 0.021241448888652,  -0.000000000000000, -0.000000000000000, -0.570449755230154, -0.023455592615779, 1.999999999999998,
        1.734191997467826,  -0.268594575922538, -0.100125491145204, -0.000000000000000, -0.000000000000000, -0.446243264206447, -0.549557865068521,
        0.000000000000000,  0.000000000000000,  -0.846927754008875, -1.234869933503085, 0.000000000000000,  0.000000000000000,  -0.021340022084625,
        0.011610293146050,  0.000000000000000,  -0.000000000000000, 0.006887503450589,  -0.096499364959290, 0.000000000000000,  -0.000000000000000,
        -0.079295045669469, 0.072458309170743,  0.000000000000000,  -0.000000000000000, -0.202405016725001, 0.019243426021768,  1.734191997467826,
        2.000000000000000,  -0.189196442229283, -0.080975910499902, 0.000000000000000,  -0.000000000000000, -0.538980109167359, -0.786766108892115,
        0.147731319400047,  0.073978551259796,  0.000000000000000,  -0.000000000000000, 0.181032634146853,  0.021340022084625,  0.000000000000000,
        -0.000000000000000, -0.260285762652716, -0.036615771853625, -0.000000000000000, -0.000000000000000, 0.298029721141160,  0.116112024847442,
        0.000000000000000,  -0.000000000000000, 0.749186245567691,  0.241843174635945,  -0.000000000000000, -0.000000000000000, 0.252752665235815,
        0.006904369788989,  1.999999999999999,  1.055951937118064,  0.033606268503834,  0.030949314580766,  -0.000000000000000, -0.000000000000000,
        0.044595306007139,  0.057378880105031,  0.000000000000000,  0.000000000000000,  -0.010665237034418, -0.011610293146050, 0.000000000000000,
        0.000000000000000,  0.162081287909404,  0.319940862912145,  0.000000000000000,  -0.000000000000000, -0.027450209996188, -0.097825342226645,
        0.000000000000000,  -0.000000000000000, -0.047837888437811, -0.167453882503289, 0.000000000000000,  -0.000000000000000, -0.052953893651009,
        -0.055747965854062, 1.055951937118064,  2.000000000000000,  0.011285459475422,  0.005058063241722,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.676829234507047,  0.566851969620520,  0.000000000000000,  -0.000000000000000, 0.260285762652716,
        -0.162081287909404, 0.000000000000000,  -0.000000000000000, 0.101514770334063,  0.031068772585186,  -0.000000000000000, -0.000000000000000,
        0.005804275858519,  0.014588891504864,  0.999999999999999,  0.867095998733913,  -0.138802360033348, -0.155294850602852, -0.000000000000000,
        -0.000000000000000, -0.300816221190870, -0.117317768595992, -0.000000000000000, 0.000000000000000,  -0.801311081174515, -0.438833207797271,
        0.000000000000000,  0.000000000000000,  0.672277265524040,  0.757860804985767,  0.000000000000000,  0.000000000000000,  0.036615771853625,
        -0.319940862912145, 0.000000000000000,  0.000000000000000,  0.014280272377279,  0.064608773123735,  0.000000000000000,  -0.000000000000000,
        -0.000218210043525, 0.029925502876200,  0.867095998733913,  1.000000000000000,  -0.139153321151135, -0.223453958043113, 0.000000000000000,
        -0.000000000000000, -0.134957438343167, -0.181106009327044, -0.000000000000000, 0.000000000000000,  -0.613702225123230, -0.557320702209220,
        -0.133686489682969, -0.192242997256538, 0.000000000000000,  0.000000000000000,  -0.074372280746413, -0.006887503450589, 0.000000000000000,
        -0.000000000000000, -0.101514770334063, -0.014280272377279, 0.000000000000000,  -0.000000000000000, 0.034044070657152,  0.021604642905404,
        -0.000000000000000, -0.000000000000000, -0.191771707813069, -0.224334015782343, 1.000000000000000,  0.527975968559032,  0.353526122675070,
        0.129271177943595,  -0.000000000000000, -0.000000000000000, 0.480923441748704,  0.358801471616471,  0.000000000000000,  -0.000000000000000,
        -0.188835521519032, -0.262665751645268, -0.000000000000000, 0.000000000000000,  0.049686431855801,  0.096499364959290,  0.000000000000000,
        0.000000000000000,  -0.031068772585186, -0.064608773123735, 0.000000000000000,  0.000000000000000,  -0.014007017588947, -0.038636114564178,
        0.000000000000000,  -0.000000000000000, -0.163540374354121, -0.184109611604799, 0.527975968559032,  1.000000000000000,  0.037660514683468,
        0.031169305891978,  0.000000000000000,  -0.000000000000000, 0.252190248533737,  0.318538145346203,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.000000000000000, -1.359605044159566, -0.585121659648377, 0.000000000000000,  -0.000000000000000, -0.298029721141160,
        0.027450209996188,  0.000000000000000,  -0.000000000000000, -0.034044070657152, 0.014007017588947,  0.000000000000000,  -0.000000000000000,
        0.036006422934891,  0.002986215000560,  -0.000000000000000, -0.000000000000000, 0.242959596333038,  0.013217171165411,  -0.000000000000000,
        -0.000000000000000, -0.740435628409772, 0.042371675433568,  -0.000000000000000, -0.000000000000000, -0.180690006739959, -0.059005448553926,
        0.000000000000000,  0.000000000000000,  -0.945211285969615, -0.692266138502299, 0.000000000000000,  0.000000000000000,  -0.116112024847442,
        0.097825342226645,  0.000000000000000,  0.000000000000000,  -0.021604642905404, 0.038636114564178,  0.000000000000000,  0.000000000000000,
        0.031306398802758,  -0.011608015535843, 0.000000000000000,  -0.000000000000000, 0.128173123808922,  -0.032313334877062, 0.000000000000000,
        -0.000000000000000, -0.270700475856001, 0.179087060556713,  0.000000000000000,  -0.000000000000000, -0.107887925059049, -0.066626566794614,
        0.922958603888563,  0.642736037140303,  0.000000000000000,  -0.000000000000000, 0.198266488962092,  0.079295045669469,  -0.000000000000000,
        -0.000000000000000, -0.005804275858519, 0.000218210043525,  0.000000000000000,  -0.000000000000000, -0.036006422934891, -0.031306398802758,
        0.000000000000000,  -0.000000000000000, -0.183187076559532, -0.096093474516104, -0.000000000000000, -0.000000000000000, 0.501003871180009,
        0.182339725828865,  -0.000000000000000, 0.000000000000000,  0.095259181469545,  0.048707985070705,  -0.000000000000000, -0.000000000000000,
        0.398354546110317,  0.471494163986939,  0.000000000000000,  0.000000000000000,  -0.021241448888652, -0.072458309170743, 0.000000000000000,
        0.000000000000000,  -0.014588891504864, -0.029925502876200, 0.000000000000000,  0.000000000000000,  -0.002986215000560, 0.011608015535843,
        0.000000000000000,  0.000000000000000,  -0.012344360291536, 0.019247417345096,  0.000000000000000,  -0.000000000000000, -0.027470648775481,
        -0.118206181222549, -0.000000000000000, -0.000000000000000, 0.022464056774741,  0.023432050041609,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.120279719916436,  0.233156609234460,  0.000000000000000,  -0.000000000000000, -0.749186245567691,
        0.047837888437811,  -0.999999999999999, -0.867095998733913, 0.191771707813069,  0.163540374354121,  0.000000000000000,  -0.000000000000000,
        0.183187076559532,  0.012344360291536,  0.000000000000000,  -0.000000000000000, -0.019666543586799, -0.012283091650366, -0.000000000000000,
        -0.000000000000000, 0.122281930348963,  -0.172280993690506, -0.000000000000000, -0.000000000000000, 1.499667871064066,  0.826881828977423,
        -0.000000000000000, -0.000000000000000, 0.222252003136569,  0.329090019662441,  0.000000000000000,  0.000000000000000,  -0.241843174635945,
        0.167453882503289,  -0.867095998733913, -1.000000000000000, 0.224334015782343,  0.184109611604799,  0.000000000000000,  0.000000000000000,
        0.096093474516104,  -0.019247417345096, 0.000000000000000,  0.000000000000000,  0.058357692942501,  -0.069966323229734, 0.000000000000000,
        -0.000000000000000, -0.008492342265327, -0.325563624510918, 0.000000000000000,  -0.000000000000000, 1.158156244082422,  1.048318752650658,
        0.067619146403130,  -0.044646995575065, -0.000000000000000, -0.000000000000000, 0.570449755230154,  0.202405016725001,  0.000000000000000,
        -0.000000000000000, 0.138802360033348,  0.139153321151135,  -1.000000000000000, -0.527975968559032, -0.242959596333038, -0.128173123808922,
        0.000000000000000,  -0.000000000000000, 0.019666543586799,  -0.058357692942501, 0.000000000000000,  -0.000000000000000, 0.038974175477340,
        0.029391920129349,  -0.000000000000000, -0.000000000000000, -0.822923002099236, -0.600176685786092, 0.000000000000000,  0.000000000000000,
        -0.087545562404793, -0.136008088502374, 0.000000000000000,  0.000000000000000,  0.023455592615779,  -0.019243426021768, 0.000000000000000,
        0.000000000000000,  0.155294850602852,  0.223453958043113,  -0.527975968559032, -1.000000000000000, -0.013217171165411, 0.032313334877062,
        0.000000000000000,  0.000000000000000,  0.012283091650366,  0.069966323229734,  0.000000000000000,  0.000000000000000,  0.058249747294938,
        0.101784382588892,  0.000000000000000,  -0.000000000000000, -0.407488662455230, -0.507039034735756, -0.000000000000000, -0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.585061327102545,  0.582393254176510,  -1.999999999999998, -1.734191997467826, -0.252752665235815,
        0.052953893651009,  0.000000000000000,  -0.000000000000000, -0.353526122675070, -0.037660514683468, 0.000000000000000,  -0.000000000000000,
        -0.501003871180009, 0.027470648775481,  0.000000000000000,  -0.000000000000000, -0.038974175477340, -0.058249747294938, 0.000000000000000,
        -0.000000000000000, 0.465205975946024,  0.072070816449010,  -0.000000000000000, -0.000000000000000, -0.354629685546883, -0.760251571249420,
        0.000000000000000,  0.000000000000000,  0.611379506493991,  0.820464896332167,  -1.734191997467826, -2.000000000000000, -0.006904369788989,
        0.055747965854062,  0.000000000000000,  0.000000000000000,  -0.129271177943595, -0.031169305891978, 0.000000000000000,  0.000000000000000,
        -0.182339725828865, 0.118206181222549,  0.000000000000000,  0.000000000000000,  -0.029391920129349, -0.101784382588892, 0.000000000000000,
        0.000000000000000,  0.229393677264292,  0.044705081433649,  0.000000000000000,  -0.000000000000000, -0.629004839724284, -1.136550283242941,
        -0.165652239435063, -0.099938026456011, 0.000000000000000,  -0.000000000000000, 0.268594575922538,  0.189196442229283,  -1.999999999999999,
        -1.055951937118064, 0.300816221190870,  0.134957438343167,  0.000000000000000,  -0.000000000000000, 0.740435628409772,  0.270700475856001,
        0.000000000000000,  0.000000000000000,  -0.122281930348963, 0.008492342265327,  0.000000000000000,  -0.000000000000000, -0.465205975946024,
        -0.229393677264292, 0.000000000000000,  -0.000000000000000, -0.252835455246975, -0.127254369463495, -0.000000000000000, -0.000000000000000,
        -0.042606865236845, -0.037214963090644, 0.000000000000000,  0.000000000000000,  0.100125491145204,  0.080975910499902,  -1.055951937118064,
        -2.000000000000000, 0.117317768595992,  0.181106009327044,  0.000000000000000,  0.000000000000000,  -0.042371675433568, -0.179087060556713,
        -0.000000000000000, 0.000000000000000,  0.172280993690506,  0.325563624510918,  0.000000000000000,  0.000000000000000,  -0.072070816449010,
        -0.044705081433649, 0.000000000000000,  0.000000000000000,  -0.044588229330892, -0.033395631696879, 0.000000000000000,  -0.000000000000000,
        -2.999999999999999, -2.601287996201740, 0.159153629738436,  -0.177881515768791, 0.000000000000000,  -0.000000000000000, -0.033606268503834,
        -0.011285459475422, 0.000000000000000,  0.000000000000000,  -0.480923441748704, -0.252190248533737, 0.000000000000000,  -0.000000000000000,
        -0.095259181469545, -0.022464056774741, 0.000000000000000,  -0.000000000000000, 0.822923002099236,  0.407488662455230,  0.000000000000000,
        -0.000000000000000, 0.252835455246975,  0.044588229330892,  0.000000000000000,  -0.000000000000000, -0.059426423468344, -0.130091546145253,
        -2.601287996201740, -3.000000000000002, 0.028749470198122,  -0.392451473804860, 0.000000000000000,  0.000000000000000,  -0.030949314580766,
        -0.005058063241722, -0.000000000000000, -0.000000000000000, -0.358801471616471, -0.318538145346203, 0.000000000000000,  0.000000000000000,
        -0.048707985070705, -0.023432050041609, 0.000000000000000,  0.000000000000000,  0.600176685786092,  0.507039034735756,  0.000000000000000,
        0.000000000000000,  0.127254369463495,  0.033395631696879,  0.000000000000000,  0.000000000000000,  -0.104812051009819, -0.196371703316169,
        0.023241007290743,  -0.039957199055783, -2.999999999999999, -1.583927905677097, 0.446243264206447,  0.538980109167359,  0.000000000000000,
        -0.000000000000000, 0.801311081174515,  0.613702225123230,  -0.000000000000000, -0.000000000000000, 0.180690006739959,  0.107887925059049,
        0.000000000000000,  -0.000000000000000, -1.499667871064066, -1.158156244082422, -0.000000000000000, 0.000000000000000,  0.354629685546883,
        0.629004839724284,  0.000000000000000,  -0.000000000000000, 0.059426423468344,  0.104812051009819,  0.000000000000000,  -0.000000000000000,
        -0.208451833664471, -0.423611815658869, -1.583927905677097, -3.000000000000000, 0.549557865068521,  0.786766108892115,  0.000000000000000,
        0.000000000000000,  0.438833207797271,  0.557320702209220,  0.000000000000000,  -0.000000000000000, 0.059005448553926,  0.066626566794614,
        0.000000000000000,  0.000000000000000,  -0.826881828977423, -1.048318752650658, -0.000000000000000, 0.000000000000000,  0.760251571249420,
        1.136550283242941,  0.000000000000000,  0.000000000000000,  0.130091546145253,  0.196371703316169,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 28, 28));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeFGForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 3);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix amomxmat(28, 36);

    CDenseMatrix amomymat(28, 36);

    CDenseMatrix amomzmat(28, 36);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        -0.000000000000000, -0.000000000000000, 0.228319586552494,  0.220261166711307,  2.867643157122556,  2.335751307936078,  0.921338465671278,
        1.494987182960661,  -0.000000000000000, -0.000000000000000, -1.213819129202962, -0.773253414820861, -0.000000000000000, -0.000000000000000,
        0.804619298104607,  0.794484552378952,  -0.000000000000001, -0.000000000000000, -0.949154431078272, -0.470699509576762, -0.000000000000000,
        -0.000000000000000, -0.505550471031139, -0.424631792092488, 1.149614807301361,  0.936383693036348,  -0.986934291356453, -0.182152789970316,
        -0.000000000000000, -0.000000000000000, -0.057407373425555, -0.038840862041395, 6.083189767273680,  4.954876767020846,  -0.225586760819571,
        0.297528212651783,  -0.000000000000000, -0.000000000000000, 0.188535506531347,  0.268903521126028,  1.847150607357738,  2.190890230020666,
        1.013349140421022,  2.007170831845390,  -0.000000000000000, -0.000000000000000, -0.772459715547809, -0.897941822990099, 0.000000000000000,
        0.000000000000000,  0.664544049402892,  0.984291066178482,  0.000000000000000,  0.000000000000000,  -0.537550285247009, -0.514620579175025,
        -0.000000000000000, -0.000000000000000, -0.366506414940154, -0.525135034437117, 0.740507647982577,  0.878310065653681,  -0.455003002218802,
        -0.035314319414831, -0.000000000000000, -0.000000000000000, -0.054751766989577, -0.024898121011327, 3.918398161006520,  4.647580015448902,
        -0.021248776747044, 0.578546014168489,  0.427581091850427,  0.447692674347247,  0.000000000000000,  -0.000000000000000, 0.876900981132596,
        1.110742732019981,  2.191745578227026,  0.982900232625671,  -0.875038533006016, -0.697953797126791, 0.000000000000000,  -0.000000000000000,
        0.527383168698778,  0.455554824610002,  -0.000000000000000, -0.000000000000000, -0.667183139329883, -0.440797229728023, -0.000000000000000,
        -0.000000000000000, -0.403938160190473, -0.240003760922135, 0.000000000000000,  0.000000000000000,  -0.814417358602465, -0.534041407939275,
        0.794971732761955,  0.356509400007386,  0.131750579145466,  0.109065763876599,  -0.000000000000000, -0.000000000000000, -0.238607246929165,
        -0.116210465634265, 4.206595008428467,  1.886470424952785,  0.249530864828454,  0.376831726754378,  -0.000000000000000, -0.000000000000000,
        0.700017195124739,  1.097314430016879,  0.577602284845846,  1.252198067399883,  -0.326141605272070, -0.469755335224091, -0.000000000000000,
        -0.000000000000000, 0.200946477357148,  0.274986064882637,  -0.000000000000000, -0.000000000000000, -0.152175394562698, -0.191338440912377,
        0.000000000000000,  0.000000000000000,  -0.072232976716949, -0.082508687817348, 0.000000000000000,  -0.000000000000000, -0.233042397071700,
        -0.347032672009797, 0.209503098257695,  0.454186871547070,  0.032966159000523,  0.029308056929327,  -0.000000000000000, -0.000000000000000,
        0.078468731397540,  0.221158448068793,  1.108586193774784,  2.403331021727972,  -0.000000000000000, -0.000000000000000, -0.756803821486200,
        -0.611515554497423, -0.000000000000000, -0.000000000000000, -0.972038086267567, -0.611073399033592, 3.754626238181789,  3.058216335202624,
        -0.599615481385219, -0.013677420473142, -0.000000000000000, -0.000000000000000, 0.365410259859739,  -0.353504284955382, -0.000000000000000,
        -0.000000000000000, -1.133462750606254, -0.631906420912182, 1.991191255379460,  1.621864131717935,  0.670715143197708,  0.681250024877330,
        -0.000000000000000, -0.000000000000000, -0.423829382201230, -0.145350580037302, 5.268196874500553,  4.291049152861361,  0.543000538349067,
        0.741835267282847,  -0.000000000000000, -0.000000000000000, -0.148677354992795, -0.223838228614343, -0.000000000000000, -0.000000000000000,
        -0.574493682055552, -0.705686137273309, -0.000000000000000, -0.000000000000000, -0.601774649940159, -0.717539984439086, 2.418487850914425,
        2.868548662402545,  -0.290588167105567, 0.189297889612907,  -0.000000000000000, -0.000000000000000, -0.069679997087720, -0.542641046259350,
        -0.000000000000000, -0.000000000000000, -0.627014610347534, -0.757564400473712, 1.282596869699153,  1.521277658511331,  0.494718302756556,
        0.945267607232526,  -0.000000000000000, -0.000000000000000, -0.179493360068820, -0.153803451911539, 3.393432349573872,  4.024922359499621,
        0.453910464040873,  1.087445627978667,  -0.000000000000000, -0.000000000000000, -0.184162747067353, -0.262285674979514, -0.768210476881554,
        -0.808275099786256, -0.000000000000000, -0.000000000000000, -1.008011128089072, -0.718193261181762, 0.000000000000000,  -0.000000000000000,
        -0.499222688168928, -0.368537879908576, 2.869668576088602,  1.286918490456240,  0.486133765528424,  0.240852450147275,  0.000000000000000,
        -0.000000000000000, -1.335995462737395, -0.923048333552676, 0.000000000000000,  0.000000000000000,  0.924968914283301,  0.752747558560357,
        1.376931431724776,  0.617492394188689,  -0.021541311981835, 0.214344589384890,  -0.000000000000000, -0.000000000000000, 0.541678412165042,
        0.459632234111641,  3.643018140731867,  1.633731311497136,  0.065846336197395,  -0.099692856372527, -0.000000000000000, -0.000000000000000,
        -0.498586548022582, -0.791433004262143, -0.000000000000000, 0.000000000000000,  -0.297126026307848, -0.409931344805084, -0.000000000000000,
        -0.000000000000000, -0.118375693904624, -0.131660640349618, 0.756258911967294,  1.639512122553538,  0.040481411611883,  0.022422574723451,
        -0.000000000000000, -0.000000000000000, -0.352643501293796, -0.462173574944832, 0.000000000000000,  -0.000000000000000, 0.266810632544202,
        0.309496019762280,  0.362870010525423,  0.786674737650285,  0.148351843578558,  0.220524443732269,  -0.000000000000000, -0.000000000000000,
        0.228901889289754,  0.346532692812440,  0.960063806093660,  2.081345718519633,  -0.140405283270395, -0.257993612319827, -0.000000000000000,
        -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.428765565449858,  0.297844323708829,  0.000000000000000,  0.000000000000000,
        -0.061061577259479, -0.211050493454942, -0.000000000000000, -0.000000000000000, 0.340905648896204,  0.071305475835872,  4.197799749339398,
        3.419189807706676,  -1.176325490642374, -0.491335980829570, 3.982382510758920,  3.243728263435870,  -0.693981048702890, 0.294828131240863,
        -0.000000000000000, -0.000000000000000, -0.520265574186946, 0.010234465597506,  4.452439003231616,  3.626598448789976,  -1.412958079232733,
        -0.161728453054316, -0.000000000000000, -0.000000000000000, -1.031384800702036, -0.474778493243500, -0.000000000000001, -0.000000000000000,
        -0.599189656521997, -0.252264542094630, -0.000000000000000, -0.000000000000000, 0.303170466466446,  0.337992725347094,  -0.000000000000000,
        0.000000000000001,  -0.148089245585999, -0.253304307119617, -0.000000000000000, -0.000000000000000, 0.138421941385652,  0.051013145624271,
        2.703951618701017,  3.207134902949095,  -0.697966341193619, -0.386459102284956, 2.565193739398305,  3.042555317022662,  -0.155857529479308,
        0.666254274062380,  -0.000000000000000, -0.000000000000000, -0.114595844770576, 0.067234625415667,  2.867973788375745,  3.401680257083047,
        -0.615904200827580, 0.120823136075799,  -0.000000000000000, -0.000000000000000, -0.548942378840904, -0.510314700848534, 0.000000000000000,
        0.000000000000001,  -0.311233605805356, -0.266422126319724, 0.457939474295790,  0.519095779326279,  -0.000000000000000, -0.000000000000000,
        0.293088091604625,  0.172626634853657,  0.000000000000000,  0.000000000000000,  0.235633073269276,  0.042899978256160,  -0.000000000000000,
        -0.000000000000000, -0.862432497790507, -0.642023162870970, 3.208387004514571,  1.438818613080784,  -0.055223212338185, 0.323501542977737,
        2.753862863449550,  1.234984788377378,  -0.379940920628763, 0.155316383615253,  -0.000000000000000, -0.000000000000000, -1.221022426216374,
        -0.701558270073045, 3.078912281692708,  1.380754968995004,  -0.927961242158369, -0.490529296224473, -0.000000000000000, -0.000000000000000,
        -0.761488073993797, -0.571962111421208, -0.000000000000000, -0.000000000000000, 0.293899549822552,  0.443981854823017,  -0.000000000000000,
        -0.000000000000000, -0.001790747219815, -0.063606365103069, -0.000000000000000, 0.000000000000000,  -0.049047290759894, -0.105211206544858,
        -0.000000000000000, -0.000000000000000, -0.322509306111457, -0.486265314599790, 0.845523167874450,  1.833030277982338,  0.175693930733213,
        0.214514084017596,  0.725740021050846,  1.573349475300570,  0.207189132904049,  0.338189736636351,  -0.000000000000000, -0.000000000000000,
        -0.219419242843120, -0.270277428509038, 0.811402010530911,  1.759058189567851,  -0.156108016991563, -0.205087178753840, -0.000000000000000,
        -0.000000000000000, -0.242585517869948, -0.335928851096623, 0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000,
        -0.803596505847979, -0.256173755588333, -0.000000000000000, 0.000000000000000,  -0.509825869646370, -0.056067307429925, -0.000000000000000,
        -0.000000000000000, -0.940843363071390, -0.154943244583567, -5.141233714132327, -4.187635181303145, 0.346697495497755,  0.036141412054757,
        4.335468938641377,  3.531324048738692,  0.365682228268305,  -0.604609519719635, -0.000000000000000, -0.000000000000000, -0.002718096286245,
        0.008399347616376,  -0.000000000000000, -0.000000000000000, 0.224692430571282,  0.099659097915221,  -0.000000000000000, -0.000000000000000,
        -0.096195254956712, 0.232975575812067,  -0.000000000000000, -0.000000000000000, -0.096643902133467, -0.028836395026145, -0.000000000000000,
        -0.000000000000000, -0.374490915796285, -0.244129628992175, -0.000000000000001, -0.000000000000000, -0.174267331328119, -0.014028220878758,
        -0.000000000000000, -0.000000000000000, -0.303339874618791, -0.144841902580841, -3.311650877495056, -3.927922024247866, 0.393243966940055,
        -0.300809145449909, 2.792629223514567,  3.312314684843302,  -0.300083332866723, -0.756233442821578, -0.000000000000000, -0.000000000000000,
        0.057795981302206,  -0.030066303969372, -0.000000000000000, -0.000000000000000, 0.080044879643428,  0.156579989081162,  -0.000000000000000,
        -0.000000000000000, 0.099661052398420,  0.329498715107878,  -0.000000000000000, -0.000000000000000, -0.044164650406849, -0.026483498845447,
        -0.956725555892734, -0.667294695936757, -0.000000000000000, -0.000000000000000, -0.623917712350277, -0.292826375735670, -0.000000000000000,
        -0.000000000000000, -1.015710608573748, -0.615175972194929, 0.000000000000000,  0.000000000000000,  -0.260620823986597, 0.009336571187543,
        -3.555221669293060, -1.594358506068358, 0.571403624651300,  -0.165876273937084, 3.313607849779529,  1.486005473780034,  0.042150979868277,
        0.011298169430095,  -0.000000000000000, -0.000000000000000, 0.490696507511308,  0.487671664102973,  -0.000000000000001, -0.000000000000000,
        -0.316221964541378, -0.043441019813451, -0.000000000000000, -0.000000000000000, -0.073624487968704, -0.062378378716535, 0.000000000000000,
        0.000000000000000,  -0.253104823379803, -0.333790168110102, -0.000000000000000, -0.000000000000000, -0.043488710146797, -0.018532855322931,
        -0.000000000000000, 0.000000000000000,  -0.219547322026885, -0.278743760989260, 0.000000000000000,  -0.000000000000000, 0.055693282955298,
        0.111000104018587,  -0.936926338402050, -2.031185438534427, -0.373921141470231, -0.673842157672449, 0.873252572802743,  1.893145530591881,
        -0.085119419557284, -0.181255859583184, -0.000000000000000, -0.000000000000000, 0.229781331566197,  0.309058234941930,  -0.000000000000000,
        -0.000000000000000, 0.095501640670735,  0.196514422857744,  -0.000000000000000, -0.000000000000000, -0.027397695508354, -0.037932297948648,
        -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.190992256421624,  0.147869480013467,  -0.000000000000000,
        -0.000000000000000, 0.397396939896334,  0.383784333999369,  -4.452439003231618, -3.626598448789976, 1.003456353202218,  0.032128710572886,
        -0.000000000000000, -0.000000000000000, -0.461262180869680, 0.268305483671651,  -0.000000000000000, -0.000000000000000, -0.021774401882245,
        0.010075959035384,  4.197799749339397,  3.419189807706676,  -0.630555687937122, -0.893799375938264, -0.000000000000000, -0.000000000000000,
        0.833269560586835,  -0.134035451574315, -0.000000000000000, -0.000000000000000, 0.062845411779524,  -0.174593476067063, -0.000000000000000,
        -0.000000000000000, 0.869568197485838,  0.410337097585493,  0.000000000000000,  -0.000000000000000, 0.147918862427064,  0.167755413900685,
        -0.000000000000000, -0.000000000000000, 0.372577261138638,  0.424718631569188,  -2.867973788375747, -3.401680257083047, 0.485738584163595,
        -0.290657352088875, -0.000000000000000, -0.000000000000000, 0.048395252314431,  0.399752651637743,  -0.000000000000000, -0.000000000000000,
        0.045559101118909,  -0.018937911868406, 2.703951618701017,  3.207134902949094,  -0.702446730718946, -1.069621949268018, -0.000000000000000,
        -0.000000000000000, 0.212529121503911,  -0.323042358466058, 0.000000000000000,  -0.000000000000000, -0.088330493715609, -0.221926772395896,
        -0.000000000000000, -0.000000000000000, 0.480015373084515,  0.443935408149279,  0.295841303503616,  0.297712389815463,  0.000000000000000,
        0.000000000000000,  0.108673154827436,  0.166845494640980,  0.000000000000000,  0.000000000000000,  0.804813121356493,  0.585256476578177,
        -3.078912281692709, -1.380754968995004, -0.454641338960972, -0.069878614458330, -0.000000000000000, -0.000000000000000, -0.072433175001617,
        0.174087965238720,  0.000000000000000,  -0.000000000000000, -0.573176149215778, -0.858883582073179, 3.208387004514572,  1.438818613080783,
        0.665710542193486,  0.226343751440534,  -0.000000000000000, -0.000000000000000, 0.395142275561015,  0.231088233054895,  -0.000000000000001,
        0.000000000000000,  0.986685643254055,  0.826007803389899,  -0.000000000000000, -0.000000000000000, 0.154030972025386,  0.226372682811327,
        -0.000000000000000, 0.000000000000000,  0.112106433823336,  0.184552572963133,  0.000000000000000,  -0.000000000000000, 0.198143878693570,
        0.242199726025773,  -0.811402010530911, -1.759058189567850, 0.035385322864308,  0.066689905129189,  -0.000000000000000, -0.000000000000000,
        0.152165627516945,  0.245980193568474,  -0.000000000000000, -0.000000000000000, -0.586606361654120, -0.917817392766507, 0.845523167874450,
        1.833030277982338,  -0.069659182391024, -0.190052469025708, -0.000000000000000, -0.000000000000000, 0.017629334471908,  -0.038339906784595,
        -0.000000000000000, -0.000000000000000, 0.391105019777770,  0.563288935082594,  -0.000000000000000, -0.000000000000000, -0.000000000000000,
        -0.000000000000000, 0.200878492225292,  0.233107802882403,  -5.268196874500553, -4.291049152861360, -0.834033960673193, -0.738429786766509,
        -0.000000000000000, -0.000000000000000, -0.072457943613209, 0.264080780802782,  -1.991191255379460, -1.621864131717935, -1.213161468505744,
        -0.533230724437491, -0.000000000000000, -0.000000000000000, 0.358494263692351,  0.771777883995593,  -0.000000000000000, -0.000000000000000,
        0.717256076670700,  0.260463837217557,  3.754626238181789,  3.058216335202625,  -0.405623922720428, 0.055530761459677,  -0.000000000000000,
        -0.000000000000000, -0.571342738702949, -0.589933681510645, 0.000000000000001,  -0.000000000000000, -0.512378137073826, -0.571672301699150,
        -0.000000000000000, -0.000000000000000, 0.202049203039540,  0.270019864229627,  -3.393432349573873, -4.024922359499622, -0.506574167724168,
        -1.067789553219675, -0.000000000000000, -0.000000000000000, 0.163988206375977,  0.331290644629582,  -1.282596869699154, -1.521277658511331,
        -0.539099040902499, -0.698954479219822, 0.000000000000000,  0.000000000000000,  0.482250496898640,  1.048684277286678,  -0.000000000000000,
        -0.000000000000000, 0.363772362671479,  0.252196887666362,  2.418487850914425,  2.868548662402545,  -0.196881092370241, 0.259743875658443,
        -0.000000000000000, -0.000000000000000, -0.506289700023333, -0.715605050200325, -0.000000000000000, 0.000000000000000,  -0.494831803059150,
        -0.673028037857003, -0.004198013951142, 0.130490332397998,  0.000000000000000,  0.000000000000000,  -0.849738564732331, -0.551800453894271,
        -3.643018140731867, -1.633731311497136, -0.413070408169219, -0.264163300569170, 0.000000000000000,  0.000000000000000,  -1.459285516292384,
        -0.939359006660328, -1.376931431724776, -0.617492394188689, 0.425324202838805,  0.478520443158273,  -0.000000000000000, -0.000000000000000,
        0.996584090751668,  0.704982359258293,  0.000000000000000,  -0.000000000000000, -0.285704095255403, -0.234440027690357, 2.869668576088603,
        1.286918490456240,  -0.583445481051970, -0.565284234367884, 0.000000000000000,  -0.000000000000000, -0.499136397107912, -0.678236836302760,
        -0.000000000000001, 0.000000000000000,  0.148552965211467,  0.267230456501753,  0.000000000000000,  -0.000000000000000, -0.234644372941730,
        -0.343103571542082, -0.960063806093660, -2.081345718519632, -0.122199607808490, -0.175553227521781, 0.000000000000000,  -0.000000000000000,
        -0.284643932009462, -0.310361266526520, -0.362870010525424, -0.786674737650285, 0.268238434130212,  0.395171086167175,  0.000000000000000,
        0.000000000000000,  0.243006387260239,  0.300459702782939,  -0.000000000000000, -0.000000000000000, -0.078483604191749, -0.085496556217126,
        0.756258911967295,  1.639512122553538,  -0.275498309780286, -0.395625430658695, -0.000000000000000, -0.000000000000000, -0.464660651832146,
        -0.753069786209347, -0.000000000000000, -0.000000000000000, -6.083189767273682, -4.954876767020846, 0.305508318442030,  -0.282526541001793,
        -0.000000000000000, -0.000000000000000, 0.127480768661869,  0.053660857848107,  -1.149614807301360, -0.936383693036349, 0.461422065059324,
        0.036594170910714,  -0.000000000000000, -0.000000000000000, -1.050484893224120, -0.168601092583140, -0.000000000000000, -0.000000000000000,
        -1.100957399864004, -0.710949392321011, 0.000000000000000,  -0.000000000000000, 0.732088730866551,  0.741567646859219,  -0.000000000000000,
        -0.000000000000000, -0.600880132681308, -0.608144802539728, 2.867643157122556,  2.335751307936078,  1.229129311646403,  1.556883413201283,
        -0.000000000000000, -0.000000000000000, 0.262817708600392,  0.226543203432044,  -3.918398161006523, -4.647580015448904, 0.048948480917276,
        -0.565601855709723, -0.000000000000000, -0.000000000000000, 0.080634589811058,  0.038064381857957,  -0.740507647982577, -0.878310065653681,
        0.235988851869883,  -0.104796541771283, -0.000000000000000, -0.000000000000000, -0.405329226848968, -0.084614047780927, -0.000000000000000,
        -0.000000000000000, -0.722915947904895, -0.814405478229019, -0.000000000000000, -0.000000000000000, 0.610549916696301,  0.924968946740192,
        -0.000000000000000, -0.000000000000000, -0.519614160152052, -0.740499232251622, 1.847150607357738,  2.190890230020665,  1.123103991344099,
        2.061930550743250,  -0.000000000000000, -0.000000000000000, 0.200265156832528,  0.274299930080752,  0.317958884651808,  0.153069411151828,
        -4.206595008428469, -1.886470424952785, -0.071104104155335, -0.080860369645576, 0.000000000000000,  0.000000000000000,  0.362646767020563,
        0.313734431412612,  -0.794971732761956, -0.356509400007386, -0.818738187655416, -0.458014497031803, -0.000000000000000, -0.000000000000000,
        -0.822958168018033, -0.552425473492489, 0.000000000000000,  -0.000000000000000, 0.436395004916281,  0.404325500912790,  -0.000000000000000,
        0.000000000000000,  -0.369781455260128, -0.448500783776919, 0.000000000000000,  -0.000000000000000, 1.159700969146300,  1.235982400775059,
        2.191745578227027,  0.982900232625671,  0.461934908748767,  0.463345036384236,  0.000000000000000,  -0.000000000000000, -0.069415120606968,
        -0.211240236718112, -1.108586193774783, -2.403331021727971, -0.026243416254703, -0.022100611390096, 0.000000000000000,  -0.000000000000000,
        0.174483307932541,  0.280147820425836,  -0.209503098257696, -0.454186871547069, -0.137874892381521, -0.167017970080106, -0.000000000000000,
        -0.000000000000000, -0.189546211903498, -0.236451418261997, -0.000000000000000, -0.000000000000000, 0.186009661756800,  0.257785910055378,
        -0.000000000000000, 0.000000000000000,  -0.259724279051876, -0.393991171947954, -0.000000000000000, -0.000000000000000, 0.728786652577649,
        1.127691686714314,  0.577602284845846,  1.252198067399884,  0.253327624397194,  0.380973140090983,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 28, 36));

    std::vector<double> intyvals{
        6.083189767273682,  4.954876767020846,  -0.049292192038857, 0.440475335324174,  -1.433821578561278, -1.167875653968039, -0.662055013893944,
        -1.020383060235454, -1.149614807301360, -0.936383693036349, -0.344652364302478, -0.567506955877439, 0.000000000000000,  -0.000000000000000,
        0.310859736432333,  0.491444619384006,  -0.000000000000000, -0.000000000000000, -1.790991258442399, -0.960215557139403, -0.000000000000000,
        -0.000000000000000, 0.182131577026503,  0.556242656916698,  -0.000000000000000, -0.000000000000000, 1.196653605347548,  0.744431839603130,
        -0.000000000000000, -0.000000000000000, 0.017888638230019,  -0.037194841663265, -0.000000000000000, -0.000000000000000, 0.302295877217734,
        0.291101591932177,  3.918398161006523,  4.647580015448904,  0.109778175458886,  0.749042097858296,  -0.923575303678869, -1.095445115010333,
        -0.703197922967594, -1.359437872476989, -0.740507647982577, -0.878310065653681, -0.327210787356421, -0.824145886771082, -0.000000000000000,
        -0.000000000000000, 0.361520906004224,  0.629544367517189,  -0.000000000000000, -0.000000000000000, -1.058439810049765, -1.065458401959892,
        -0.000000000000000, -0.000000000000000, 0.354965334106052,  0.739288531664228,  -0.000000000000000, -0.000000000000000, 0.758878721974009,
        0.855372524071651,  -0.000000000000000, -0.000000000000000, -0.044879384965892, -0.018686625145769, -0.000000000000000, -0.000000000000000,
        0.246019800047640,  0.357858749317417,  0.100229590417212,  0.220347409434415,  4.206595008428469,  1.886470424952785,  -0.624380401182663,
        -0.771355798655900, -0.939319533525869, -0.421242956839573, -0.182205912715410, -0.186045588437021, -0.794971732761956, -0.356509400007386,
        0.108084015816553,  0.225690349092351,  -0.000000000000000, -0.000000000000000, -1.276900016578868, -0.851322630100192, 0.000000000000000,
        -0.000000000000000, 0.061211431429308,  0.177049764880299,  -0.000000000000000, -0.000000000000000, 0.867563034348708,  0.684408006313711,
        -0.000000000000000, -0.000000000000000, 0.293564638051550,  0.206224916509641,  -0.000000000000000, -0.000000000000000, 0.506451836320470,
        0.526900387542157,  0.000000000000000,  -0.000000000000000, 0.259246637300047,  0.491318378374290,  1.108586193774783,  2.403331021727971,
        -0.479317251391148, -0.745408521636534, -0.247543836362505, -0.536656314599950, -0.085425087298831, -0.106240956739307, -0.209503098257696,
        -0.454186871547069, 0.138809024288422,  0.207568409475544,  -0.000000000000000, 0.000000000000000,  -0.294505363688625, -0.369999688865146,
        -0.000000000000000, -0.000000000000000, 0.111825633046624,  0.165771808084194,  -0.000000000000000, -0.000000000000000, 0.308014600790432,
        0.436398500100147,  -0.000000000000000, -0.000000000000000, 0.059257497049766,  0.054322742502897,  -0.000000000000000, -0.000000000000000,
        0.296273706453868,  0.449198630304078,  -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.620469057161648,
        -0.524259299523202, 5.268196874500553,  4.291049152861361,  -0.190792516210514, 0.151100891158738,  -1.877313119090894, -1.529108167601312,
        -0.019489205654187, -0.064892848689465, -1.991191255379460, -1.621864131717935, -0.260755728378884, -0.480138837861152, -0.000000000000000,
        -0.000000000000000, 0.503415662438283,  0.738810458237424,  -0.000000000000000, -0.000000000000000, -0.750163433177817, 0.331679433262886,
        -0.000000000000000, -0.000000000000000, -0.453967106463134, -0.314806778575627, -0.000000000000000, -0.000000000000000, -0.578782904256008,
        -0.484264484774111, -0.000000000000000, -0.000000000000000, 0.605756806387885,  0.540911300293262,  -0.000000000000000, -0.000000000000000,
        -0.487574602927787, -0.608673115448213, 3.393432349573872,  4.024922359499621,  -0.075468253853404, 0.372505258989765,  -1.209243925457212,
        -1.434274331201272, 0.070080138381364,  -0.198032522678389, -1.282596869699153, -1.521277658511331, -0.242481779056520, -0.743285892543559,
        -0.000000000000000, -0.000000000000000, 0.489890684553986,  0.997899583874661,  -0.000000000000000, -0.000000000000000, -0.023306940885294,
        0.537724066493881,  -0.000000000000000, -0.000000000000000, -0.302501326702262, -0.360935095502931, -0.000000000000000, -0.000000000000000,
        -0.457862769561188, -0.564981390056452, -0.000000000000000, -0.000000000000000, 0.488831164353746,  0.631651063060300,  -0.781974287813753,
        -0.794873318614358, -0.000000000000000, -0.000000000000000, -0.220271732541467, -0.169472708091187, 3.643018140731867,  1.633731311497136,
        -0.070172923501812, 0.056831696204790,  -1.229857961180830, -0.551536495909817, -0.297494022402911, -0.255848844172142, -1.376931431724776,
        -0.617492394188689, 0.611240497768688,  0.549636403901190,  -0.000000000000000, -0.000000000000000, -0.902974166728754, -0.416938145108858,
        -0.000000000000000, -0.000000000000000, 0.106512296567624,  0.288831582865636,  -0.000000000000000, -0.000000000000000, -0.587261157807899,
        -0.498999493506253, 0.000000000000000,  -0.000000000000000, 0.542709367609226,  0.636552140236287,  0.000000000000000,  -0.000000000000000,
        -0.457623619705753, -0.708116823097329, -0.000000000000000, -0.000000000000000, -0.069781840289206, -0.085296488495519, 0.960063806093660,
        2.081345718519633,  0.004359161950691,  -0.018812176439029, -0.324110962271698, -0.702648052522945, -0.084092379367508, -0.079822949831046,
        -0.362870010525423, -0.786674737650285, 0.280588659125477,  0.405977855070867,  -0.000000000000000, -0.000000000000000, -0.077382123526764,
        -0.060107227309272, -0.000000000000000, -0.000000000000000, 0.190216671658397,  0.285195394799940,  -0.000000000000000, -0.000000000000000,
        -0.204549821648827, -0.272641727144403, -0.000000000000000, -0.000000000000000, 0.429457859838910,  0.698659252022861,  -0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.406882288988957, -0.177561715232144, -0.000000000000000, -0.000000000000000,
        0.146204912663246,  0.020629620515591,  4.452439003231618,  3.626598448789976,  -0.455750876972544, -0.173202322481246, -2.098899874669699,
        -1.709594903853338, 0.579973278205639,  0.422006124361352,  -0.000000000000000, -0.000000000000000, 0.036607693376303,  0.066718305784902,
        -0.000000000000000, -0.000000000000000, 0.316340464045991,  -0.366466339200700, -0.000000000000000, -0.000000000000000, 0.271126931818474,
        -0.131471731665028, -0.000000000000000, -0.000000000000000, -0.008879897619201, 0.211626619004529,  -0.000000000000000, -0.000000000000000,
        -0.615951509456567, -0.374202788279467, 0.000000000000001,  -0.000000000000000, -0.213820049676872, -0.190219953753778, -0.000000000000000,
        -0.000000000000000, 0.078163673085256,  0.000173278087144,  2.867973788375746,  3.401680257083047,  -0.342215607810753, -0.020878037689868,
        -1.351975809350508, -1.603567451474547, 0.390680958273787,  0.483417119418548,  -0.000000000000000, -0.000000000000000, 0.003558536011859,
        0.119635329003962,  -0.000000000000000, -0.000000000000000, -0.091443109455619, -0.558385044841630, -0.000000000000000, -0.000000000000000,
        0.064269702853756,  -0.257828459117032, -0.000000000000000, -0.000000000000000, 0.132578048616079,  0.259700448370186,  -0.000000000000000,
        -0.000000000000000, -0.400665575228901, -0.416529013617150, -0.443093150936185, -0.357966036311823, -0.000000000000000, 0.000000000000000,
        0.300806316947663,  0.263091233122730,  -0.000000000000000, -0.000000000000000, -0.388286478253382, -0.433373983925900, 3.078912281692708,
        1.380754968995004,  0.540389355819877,  0.451158113944668,  -1.375023001934816, -0.616636548463193, 0.092044774819531,  -0.106155253955753,
        -0.000000000000000, -0.000000000000000, 0.294189611293439,  0.099692423732948,  0.000000000000000,  -0.000000000000000, 0.109947238671073,
        0.040304608059671,  -0.000000000000000, -0.000000000000000, -0.372955720600573, -0.208434654051271, 0.000000000000000,  -0.000000000000000,
        -0.800156543122357, -0.746953265003640, 0.000000000000000,  -0.000000000000000, -0.166156701114793, -0.238123061818497, 0.000000000000000,
        0.000000000000000,  0.068123341009000,  0.051888377291761,  -0.000000000000000, -0.000000000000000, -0.271582112562675, -0.429613591799170,
        0.811402010530911,  1.759058189567850,  0.252114935448276,  0.382915361809834,  -0.362367071946193, -0.785584404849573, -0.101003199430291,
        -0.163761096769040, -0.000000000000000, -0.000000000000000, 0.005156055350343,  -0.004195004389702, -0.000000000000000, -0.000000000000000,
        -0.054690231299734, -0.123537651926137, -0.000000000000000, -0.000000000000000, -0.009957800133103, 0.047565971649497,  -0.000000000000000,
        -0.000000000000000, -0.374926250842876, -0.547558942248190, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000,
        -0.244107150383374, -0.074040086029793, -0.000000000000000, -0.000000000000000, -0.772992825006017, 0.007467171579539,  -0.000000000000000,
        -0.000000000000000, 0.392342221067171,  0.105173206526396,  -0.000000000000000, -0.000000000000000, 0.074525457230836,  -0.042607878862259,
        -2.167734469320688, -1.765662024369346, -0.163903638827824, 0.228649930998306,  5.141233714132327,  4.187635181303145,  -0.301091001773231,
        -0.051947643205032, -0.000000000000000, -0.000000000000000, -0.414464381507351, 0.008826949622104,  -0.000000000000000, 0.000000000000000,
        -0.102105666359815, -0.118551536873411, -0.000000000000000, 0.000000000000000,  0.808311025118490,  0.264380783585550,  -0.000000000000000,
        -0.000000000000000, -0.109549729016185, -0.070669267913083, -0.000000000000000, -0.000000000000000, -0.215287769218773, 0.105878046279764,
        -0.000000000000000, -0.000000000000000, 0.122090924317617,  0.149550092763554,  -0.000000000000000, -0.000000000000000, -0.032791229356903,
        -0.043763778295504, -1.396314611757283, -1.656157342421651, 0.135094144160539,  0.257411790858114,  3.311650877495056,  3.927922024247866,
        -0.328410814558015, 0.226533837298849,  0.000000000000000,  -0.000000000000000, -0.120391320637276, 0.082031255857236,  -0.000000000000001,
        -0.000000000000000, -0.086198252244216, -0.154456079505235, -0.000000000000000, 0.000000000000000,  0.382171447028984,  0.253337217510548,
        -0.332407126623300, -0.211224224380163, -0.000000000000000, -0.000000000000000, -1.025921830796644, -0.445478162042979, -0.000000000000000,
        -0.000000000000000, 0.615932475098868,  0.525156998603807,  -0.000000000000000, -0.000000000000000, 0.034906777554395,  0.025023524617608,
        0.000000000000000,  -0.000000000000000, -0.303762731754864, 0.022884226921577,  -1.420117649905512, -0.636859488762871, 0.347118478825275,
        0.024293032702673,  3.555221669293060,  1.594358506068358,  -0.155412900382826, 0.128207097447709,  -0.000000000000000, -0.000000000000000,
        -0.014101606314674, -0.033275359918420, -0.000000000000000, -0.000000000000000, 0.983055465202614,  0.689569269620795,  0.000000000000000,
        0.000000000000000,  -0.073989749061275, -0.094839896836185, -0.000000000000000, -0.000000000000000, -0.028032844551610, 0.046787423284223,
        -0.000000000000000, -0.000000000000000, 0.236612497650516,  0.317051438231237,  -0.000000000000000, -0.000000000000000, 0.061007419841566,
        0.120973849844300,  -0.000000000000000, -0.000000000000000, 0.132091088817244,  0.247762605276418,  -0.374251102629747, -0.811348084539377,
        -0.142700799063512, -0.302234660163830, 0.936926338402050,  2.031185438534427,  0.108866380394778,  0.157267735864926,  -0.000000000000000,
        0.000000000000000,  -0.046882000188890, -0.086449308864106, -0.000000000000000, 0.000000000000000,  0.262023713695827,  0.345564863778255,
        0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.000000000000000, 1.020873872505460,  0.480824558201798,  -0.000000000000000,
        -0.000000000000000, -0.369626251631991, -0.280365495033702, -0.000000000000000, -0.000000000000000, -0.668479515050639, -0.134263233542380,
        -0.000000000000000, -0.000000000000000, 0.404845554021889,  0.020640187910517,  -3.982382510758921, -3.243728263435871, 0.685724574797058,
        -0.235235322164519, -2.098899874669699, -1.709594903853338, 0.484678961158175,  0.136492729695776,  4.452439003231616,  3.626598448789976,
        -0.825805039150589, -0.116610806005190, 0.000000000000000,  0.000000000000000,  0.899770407829466,  0.142502906410790,  0.000000000000001,
        0.000000000000000,  0.046447869265460,  -0.062611754235200, -0.000000000000000, -0.000000000000000, 0.566088347007472,  0.517513246231815,
        -0.000000000000000, -0.000000000000000, -0.257908259274080, -0.321312820571322, -0.000000000000000, -0.000000000000000, -0.221821229943284,
        -0.131959741230308, -0.000000000000000, -0.000000000000000, 0.153043536171891,  -0.059608005508515, -2.565193739398305, -3.042555317022661,
        0.226568538498911,  -0.614904255862347, -1.351975809350509, -1.603567451474547, 0.316918159235593,  0.008037001414897,  2.867973788375745,
        3.401680257083047,  -0.423727871377438, 0.108227185183010,  -0.000000000000000, 0.000000000000000,  0.305859121237112,  0.113464797459625,
        -0.000000000000000, -0.000000000000001, -0.032418981534045, -0.082187143539904, 1.274921248399629,  1.030086999908588,  -0.000000000000000,
        -0.000000000000000, -0.055876935993909, 0.029060558932867,  -0.000000000000000, -0.000000000000000, -0.542981946939427, -0.134898201485658,
        0.000000000000000,  -0.000000000000000, 0.182138983795125,  -0.238100073377426, 0.000000000000000,  -0.000000000000000, 0.007936633048780,
        -0.133139764423492, -2.753862863449550, -1.234984788377378, 0.254189718484817,  0.236935944882964,  -1.375023001934816, -0.616636548463193,
        -0.720819769865676, -0.566377041210500, 3.078912281692708,  1.380754968995004,  1.247319571664149,  0.654383974287615,  -0.000000000000000,
        -0.000000000000000, 0.110269564739855,  -0.039524323017489, 0.000000000000001,  0.000000000000000,  0.466494668296207,  0.660766827682504,
        -0.000000000000000, -0.000000000000000, -0.023937168145092, -0.077372779797698, -0.000000000000000, -0.000000000000000, 0.017566846997877,
        0.052386479246916,  -0.000000000000000, -0.000000000000000, -0.252549659709269, -0.411444751650444, -0.000000000000000, -0.000000000000000,
        -0.014780955744658, 0.045282141822423,  -0.725740021050846, -1.573349475300570, 0.110659055472391,  0.161820252346614,  -0.362367071946193,
        -0.785584404849573, -0.275869333168652, -0.408476321976122, 0.811402010530911,  1.759058189567851,  0.129093308300112,  0.090774872802848,
        -0.000000000000000, 0.000000000000000,  -0.066205830886926, -0.115879595230128, -0.000000000000000, -0.000000000000000, -0.000000000000000,
        -0.000000000000000, -0.361448783919701, -0.499829498924910, -0.000000000000000, -0.000000000000000, 0.919271450718454,  0.496336326119357,
        -0.000000000000000, -0.000000000000000, 0.073090051418897,  0.299340262684499,  -0.000000000000000, -0.000000000000000, 0.099372786432257,
        0.119961113920170,  0.000000000000000,  -0.000000000000000, -0.380429349606333, 0.454887621991015,  -1.991191255379460, -1.621864131717935,
        -0.565478858268959, -0.732757036831930, -1.877313119090894, -1.529108167601312, 0.632022449906443,  -0.153029377687592, 5.268196874500553,
        4.291049152861360,  0.251458681093309,  0.181387416003242,  0.000000000000000,  -0.000000000000000, -0.661829146872260, -0.531289215411953,
        -0.000000000000000, -0.000000000000000, -0.407731174384352, -0.597767661617524, -0.000000000000000, -0.000000000000000, 0.535100760779229,
        0.559369588873246,  -0.000000000000000, -0.000000000000000, 0.212721022964935,  0.366706049308751,  -0.000000000000000, -0.000000000000000,
        0.124268349631195,  0.127602883412106,  0.000000000000000,  0.000000000000000,  0.127370495316590,  0.683757172352838,  -1.282596869699154,
        -1.521277658511331, -0.448580543237888, -1.063188309743754, -1.209243925457212, -1.434274331201273, 0.144672532062942,  -0.350652880254071,
        3.393432349573873,  4.024922359499622,  0.035832047566819,  0.382579689535926,  -0.000000000000000, 0.000000000000000,  -0.501463514786584,
        -0.614449383292449, -0.268599666329702, -0.502165364579689, -0.000000000000000, -0.000000000000000, 0.948477805904787,  0.625995688746504,
        -0.000000000000000, -0.000000000000000, -0.480781347713451, -0.428930252065454, 0.000000000000000,  -0.000000000000000, 0.326614923348243,
        0.323131434116846,  0.000000000000000,  -0.000000000000000, -0.451694400689618, -0.088139712025176, -0.000000000000000, -0.000000000000000,
        -0.682409683803968, -0.510885226423994, -1.376931431724776, -0.617492394188689, 0.525439757206892,  0.193152627128917,  -1.229857961180829,
        -0.551536495909817, 0.248329771535736,  0.005685940941135,  3.643018140731867,  1.633731311497136,  -0.824778311205397, -0.816564465530933,
        0.000000000000000,  -0.000000000000000, -0.394148242500284, -0.658662062145718, -0.000000000000000, -0.000000000000000, 0.220364330723961,
        0.280785757621589,  -0.000000000000000, -0.000000000000000, -0.215610505422174, -0.308921112081135, -0.000000000000000, -0.000000000000000,
        0.128745072478393,  0.165059168886419,  -0.000000000000000, -0.000000000000000, 0.065043521584414,  0.134740705297382,  -0.000000000000000,
        0.000000000000000,  -0.179548617548077, -0.205821850995297, -0.362870010525424, -0.786674737650285, 0.000113627329616,  -0.039988737323909,
        -0.324110962271698, -0.702648052522945, -0.042332300029652, -0.064450753834966, 0.960063806093660,  2.081345718519632,  -0.463479065467177,
        -0.714821772026179, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.000000000000000, -0.270068695452454, -0.285023930829764,
        -0.000000000000000, -0.000000000000000, 0.295220851361155,  0.101557738170988,  -0.000000000000000, -0.000000000000000, -0.649774566855172,
        -0.590434206880394, -0.000000000000000, -0.000000000000000, -0.762403721719867, -0.739589147716837, -0.000000000000001, -0.000000000000000,
        0.225668582865062,  0.232648074586919,  -0.000000000000000, -0.000000000000000, 1.941229946417363,  1.112684573682600,  -1.149614807301361,
        -0.936383693036348, 0.301911942693664,  -0.395932711626730, -1.433821578561278, -1.167875653968039, -0.711574991741874, -1.031089991677936,
        6.083189767273680,  4.954876767020846,  -0.126673326273539, 0.425702291703135,  -0.000000000000000, -0.000000000000000, -0.234816918523919,
        -0.352611117301989, -0.000000000000000, -0.000000000000000, 0.158200150235061,  0.075757129158158,  -0.000000000000000, -0.000000000000000,
        -0.527416697866951, -0.707356894214053, -0.000000000000000, -0.000000000000000, -0.614192062117284, -0.921230600090746, 0.000000000000000,
        0.000000000000000,  0.204210698169941,  0.278643618998501,  0.000000000000000,  0.000000000000000,  1.171568718827851,  1.267137063636131,
        -0.740507647982577, -0.878310065653681, -0.062377892210714, -0.661178306257480, -0.923575303678869, -1.095445115010333, -0.721657966220887,
        -1.369023492718211, 3.918398161006520,  4.647580015448903,  0.082667749541566,  0.736264371083816,  -0.474469429578601, -0.511999635583676,
        -0.000000000000000, -0.000000000000000, -0.010717386899652, -0.078664283773620, 0.000000000000000,  -0.000000000000000, -0.409877078673231,
        -0.454950369491642, 0.000000000000000,  -0.000000000000000, -0.486444652269361, -0.410620449621556, 0.000000000000000,  -0.000000000000000,
        0.176869875624727,  0.143120915691849,  -0.000000000000000, -0.000000000000000, 1.368643226897181,  0.955524259884604,  -0.000000000000000,
        -0.000000000000000, 0.343666797953847,  0.073711806970246,  -0.794971732761955, -0.356509400007386, -0.671763500305512, -0.793023978769182,
        -0.939319533525868, -0.421242956839573, 0.023530768301224,  0.184329264459494,  4.206595008428467,  1.886470424952785,  -0.292606607029291,
        -0.445178692829729, -0.000000000000000, -0.000000000000000, -0.029556865833073, -0.022790259976237, -0.000000000000000, -0.000000000000000,
        -0.246178656508879, -0.365529714360870, -0.000000000000000, -0.000000000000000, -0.180479375721177, -0.246944677501427, -0.000000000000000,
        -0.000000000000000, 0.054252293794822,  0.069504346478420,  0.000000000000000,  0.000000000000000,  0.360857628019607,  0.472442652018361,
        -0.000000000000000, -0.000000000000000, -0.016385862649973, -0.027579501942450, -0.209503098257695, -0.454186871547070, -0.484375157354723,
        -0.750770021171599, -0.247543836362505, -0.536656314599950, 0.250338072887495,  0.481536057924786,  1.108586193774784,  2.403331021727972};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 28, 36));

    std::vector<double> intzvals{
        -4.055459844849120, -3.303251178013897, -0.306759580837015, -0.939777789927875, -0.000000000000000, -0.000000000000000, 0.145505043347038,
        0.188378366003839,  0.766409871534240,  0.624255795357566,  0.206554021064123,  0.053418302364789,  -0.000000000000000, -0.000000000000000,
        -0.074310998820624, -0.203971833607461, 0.000000000000000,  0.000000000000000,  1.043175201880540,  0.490046040379217,  -0.000000000000000,
        -0.000000000000000, 0.154979700934259,  -0.080813726576996, -0.383204935767120, -0.312127897678783, -0.212925400981861, -0.070662914010322,
        -0.000000000000000, -0.000000000000000, 0.040669429244952,  -0.279627190838004, -2.027729922424561, -1.651625589006949, -0.320673450756793,
        -0.693797385158361, -2.612265440671015, -3.098386676965936, -0.456641490020845, -1.419551214990448, -0.000000000000000, -0.000000000000000,
        0.140471299986613,  0.241255814306720,  0.493671765321719,  0.585540043769120,  0.076033086360614,  0.056882812095655,  -0.000000000000000,
        -0.000000000000000, -0.140251808107650, -0.262447093498036, -0.000000000000000, -0.000000000000000, 0.579294963209342,  0.525859674275956,
        -0.000000000000000, -0.000000000000000, -0.006400705217370, -0.124374631981910, -0.246835882660859, -0.292770021884560, -0.104304470246955,
        -0.065092541142649, -0.000000000000000, -0.000000000000000, -0.046496439751695, -0.500134702787459, -1.306132720335507, -1.549193338482968,
        -0.386372571339771, -1.008207154366241, 0.090410320183662,  0.142509767871707,  -3.099596321999923, -1.390030839438894, 0.161612600592779,
        0.195447281390741,  -0.000000000000000, -0.000000000000000, 0.886908940683498,  0.917700448000846,  0.585768645193020,  0.262691136847548,
        -0.691097172515727, -0.762436005040403, -0.000000000000000, -0.000000000000000, 1.656773229710550,  1.197845321928590,  0.000000000000000,
        0.000000000000000,  -0.040436367516554, -0.211665487381325, -0.000000000000000, -0.000000000000000, -0.662632936098703, -0.681313806582940,
        -0.251043705082723, -0.112581915791806, -0.275974375604732, -0.049378480893427, -0.000000000000000, -0.000000000000000, -0.065839125625686,
        -0.019459744341787, -1.328398423714253, -0.595727502616669, 0.115881065347292,  0.199035366837766,  -0.816852984886682, -1.770875489694294,
        0.125181819964601,  0.196984547510371,  -0.000000000000000, -0.000000000000000, 0.561535504749939,  0.886983111128318,  0.154370703979355,
        0.334664010613631,  -0.424735454808337, -0.638621735405513, -0.000000000000000, -0.000000000000000, 0.471304564137287,  0.630687300617531,
        0.000000000000000,  0.000000000000000,  -0.164792475793749, -0.265368336066750, -0.000000000000000, -0.000000000000000, -0.395183564710644,
        -0.611537450862211, -0.066158873134009, -0.143427433120127, 0.164178984874987,  0.378319963875162,  -0.000000000000000, -0.000000000000000,
        0.033652744589089,  0.082302649134264,  -0.350079850665721, -0.758946638440412, -0.000000000000000, -0.000000000000000, 1.092730421207514,
        1.027605258328501,  -3.512131249667036, -2.860699435240907, 0.740475971595502,  0.300706949047762,  -0.000000000000000, -0.000000000000000,
        0.205794555026239,  0.051616240522523,  1.327460836919641,  1.081242754478624,  0.017899395072672,  0.115617826195040,  -0.000000000000000,
        -0.000000000000000, 0.006957381325215,  -0.180152970188199, -0.663730418459820, -0.540621377239312, 0.313234581063058,  -0.149690556819271,
        -0.000000000000000, -0.000000000000000, 0.108039310878033,  -0.232633032510266, -1.756065624833518, -1.430349717620454, 0.404865867011724,
        0.193044254353084,  -0.000000000000000, -0.000000000000000, -0.535841934037981, -0.501717507712572, -0.000000000000000, -0.000000000000000,
        0.879238229846751,  1.257345738392250,  -2.262288233049248, -2.683281572999748, 0.459411729373175,  0.202826592424028,  -0.000000000000000,
        -0.000000000000000, 0.051759444524326,  0.072119536802368,  0.855064579799436,  1.014185105674220,  0.058683248075424,  0.167701502856556,
        -0.000000000000000, -0.000000000000000, -0.083127751942180, -0.256406588942471, -0.427532289899718, -0.507092552837110, -0.010534293560459,
        -0.229777306260081, -0.000000000000000, -0.000000000000000, -0.045456531750741, -0.405792358519372, -1.131144116524624, -1.341640786499874,
        0.292280276488709,  0.129225827410511,  -0.000000000000000, -0.000000000000000, -0.422993132606713, -0.619004126269976, 0.336488709049857,
        0.323117956624626,  -0.000000000000000, -0.000000000000000, 0.164272206671238,  0.057427409767192,  -2.684329156328744, -1.203802018997890,
        0.214699359798731,  0.073276356877260,  -0.000000000000000, -0.000000000000000, 0.102153933487541,  0.280271707279323,  1.014581054955098,
        0.454994395717981,  0.022319873302880,  -0.151079125932236, -0.000000000000000, -0.000000000000000, 0.301963390256341,  -0.141422298315890,
        -0.434820452123614, -0.194997598164849, 0.313751222086885,  0.165798605766048,  -0.000000000000000, -0.000000000000000, 0.033711349364116,
        0.023941069012506,  -1.150426781283747, -0.515915150999096, -0.217224048166880, -0.208736798536197, -0.000000000000000, -0.000000000000000,
        0.171664801035830,  0.256141682065184,  -0.000000000000000, -0.000000000000000, 0.010152631654297,  0.007695026430906,  -0.707415436069013,
        -1.533623161014467, 0.034441204947035,  0.058885355217225,  -0.000000000000000, -0.000000000000000, 0.270381595477425,  0.476919751378989,
        0.267377902492417,  0.579655069847578,  -0.164554754704591, -0.284813556634599, -0.000000000000000, -0.000000000000000, -0.237427803576938,
        -0.428406190531169, -0.114590529639608, -0.248423601363248, 0.153410289827468,  0.306922411810421,  -0.000000000000000, -0.000000000000000,
        0.002712076589761,  0.000678331997122,  -0.303178044029577, -0.657267069006200, -0.119218529838214, -0.183059181917591, -0.000000000000000,
        -0.000000000000000, 0.000000000000001,  -0.000000000000000, 0.127366680879477,  0.008163502924373,  -0.000000000000000, -0.000000000000000,
        -0.339370221374586, -0.026562960753542, -2.968292668821078, -2.417732299193318, 0.300404722783976,  0.309579905396790,  -0.000000000000000,
        -0.000000000000000, -0.051658649774928, -0.118614366249456, -1.327460836919640, -1.081242754478623, 0.054447966108136,  -0.054239236836215,
        -0.000000000000000, -0.000000000000000, 0.068218490421770,  0.041006573422876,  -1.484146334410539, -1.208866149596659, 0.378479402534043,
        0.231366551123216,  -0.000000000000000, -0.000000000000000, 0.539502647560117,  0.062429818394015,  0.000000000000000,  0.000000000000000,
        0.917431668240434,  0.570004472337478,  -0.000000000000000, -0.000000000000000, 0.035206305115625,  -0.000577819410491, -0.000000000000000,
        -0.000000000000000, -0.150106116635782, 0.036162024666012,  -1.911982525583831, -2.267786838055364, 0.309864070751346,  0.308401339624002,
        -0.000000000000000, -0.000000000000000, -0.058831304471052, -0.170093107034980, -0.855064579799435, -1.014185105674220, 0.005623847794705,
        -0.102959939001534, -0.000000000000000, -0.000000000000000, 0.066144929743499,  0.008841863975314,  -0.955991262791915, -1.133893419027682,
        0.227779811273868,  0.254028807229475,  -0.000000000000000, -0.000000000000000, 0.189079767090633,  0.016319553585833,  -0.000000000000000,
        -0.000000000000000, 0.590437469196700,  0.647781939617410,  0.174533842489516,  0.098615967352214,  -0.000000000000000, -0.000000000000000,
        -0.025860844227005, -0.035788647702895, -0.000000000000000, -0.000000000000000, 0.084884873918776,  0.123918807343743,  -2.268672207563048,
        -1.017398398206846, -0.057270483238202, -0.081018497979165, -0.000000000000000, -0.000000000000000, 0.110416916363016,  0.030383282644552,
        -0.869640904247226, -0.389995196329698, -0.199811074910412, -0.075038180729515, -0.000000000000000, -0.000000000000000, 0.208170756963348,
        0.101518457475179,  -0.972288088955592, -0.436027884945791, 0.350264207661549,  0.161211385627131,  -0.000000000000000, -0.000000000000000,
        0.482724295690169,  0.410278796154857,  0.000000000000000,  0.000000000000000,  0.031119094588200,  0.038382603370071,  -0.000000000000000,
        0.000000000000000,  0.004785146306780,  0.022674652379436,  -0.000000000000000, -0.000000000000000, 0.061625233862640,  0.078873018998673,
        -0.597875165654356, -1.296148139681573, -0.079656489295132, -0.138880440333435, -0.000000000000000, -0.000000000000000, -0.049480208233167,
        -0.117758865995933, -0.229181059279215, -0.496847202726496, 0.071976988213842,  0.183688958767927,  -0.000000000000000, -0.000000000000000,
        0.051532810161525,  0.080419777296616,  -0.256232213851867, -0.555492059863532, 0.023564802206050,  0.009560062776330,  -0.000000000000000,
        -0.000000000000000, 0.188834209522006,  0.267733225681607,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.000000000000000,
        0.569347997283809,  0.207754642357478,  -0.000000000000000, 0.000000000000000,  0.934707102692057,  0.042721604717478,  -0.000000000000000,
        -0.000000000000000, -0.018376755586175, -0.092905917869897, 1.713744571377442,  1.395878393767715,  -0.054019472741793, -0.047453021042673,
        -0.000000000000000, -0.000000000000000, 0.007878228481034,  0.042228712124738,  -3.427489142754883, -2.791756787535429, -0.015298474779664,
        0.126810552044573,  -0.000000000000000, -0.000000000000000, 0.103063358636665,  -0.161204265757889, -0.000000000000000, 0.000000000000000,
        0.134528363767845,  0.005786885231485,  -0.000000000000000, -0.000000000000000, -0.671976091452150, -0.257243139505652, -0.000000000000000,
        -0.000000000000000, 0.278610715425789,  0.209525431083332,  0.000000000000000,  0.000000000000000,  0.291976200528460,  -0.060178109035350,
        -0.000000000000000, -0.000000000000000, -0.057325405460218, -0.122878105659590, 1.103883625831685,  1.309307341415955,  -0.073198904326056,
        -0.018006604036186, -0.000000000000000, -0.000000000000000, 0.015984459303654,  0.063623739787457,  -2.207767251663371, -2.618614682831910,
        0.117546126695802,  0.104036628751993,  -0.000000000000000, -0.000000000000000, -0.074494493650743, -0.220230058426009, 0.000000000000001,
        0.000000000000000,  0.035795433854621,  -0.004640836094104, -0.000000000000000, -0.000000000000000, -0.338632867511444, -0.261245425665702,
        0.394526242869313,  0.251728230350507,  -0.000000000000000, -0.000000000000000, 0.669463327012819,  0.283042350505655,  -0.000000000000000,
        0.000000000000000,  -0.034149828903055, -0.063693568699073, -0.000000000000000, -0.000000000000000, -0.057175835633325, -0.067665417955432,
        1.122701579776756,  0.503481633495271,  0.009064423808936,  0.021794900599678,  -0.000000000000000, -0.000000000000000, -0.012706075361854,
        0.110634446393882,  -2.619637019479097, -1.174790478155632, 0.074330462404152,  -0.064202636482932, -0.000000000000000, -0.000000000000000,
        0.079120052543534,  0.025047968208552,  0.000000000000000,  -0.000000000000000, -0.503646695639263, -0.334884544154794, -0.000000000000000,
        -0.000000000000000, 0.086254043352073,  0.108848439281376,  -0.000000000000000, -0.000000000000000, 0.015411280572807,  -0.033522961990546,
        -0.000000000000000, -0.000000000000000, -0.046522474983533, -0.074757891195991, -0.000000000000000, -0.000000000000000, -0.014567440083051,
        -0.000490264816611, 0.295871475284858,  0.641426980589819,  0.028498087153158,  0.051948566002294,  -0.000000000000000, -0.000000000000000,
        0.059290005909677,  0.063627452947669,  -0.690366775664669, -1.496662954709578, -0.070862010609824, -0.118445101052092, -0.000000000000000,
        -0.000000000000000, 0.001797281672648,  -0.000734654530620, -0.000000000000000, -0.000000000000000, -0.118171517234711, -0.150554710638475,
        -0.000000000000000, -0.000000000000000, 0.000000000000000,  -0.000000000000000, -1.086232951759034, -0.619916286292106, -0.000000000000000,
        -0.000000000000000, 0.017386581387080,  0.014017411089903,  1.484146334410539,  1.208866149596659,  0.063803462941897,  -0.084645924263566,
        -0.000000000000000, -0.000000000000000, -0.188158126173331, 0.102358312058013,  2.654921673839279,  2.162485508957247,  -0.189702189829270,
        0.039616164781819,  -0.000000000000000, -0.000000000000000, -0.063112683866925, 0.184387326390721,  -2.968292668821078, -2.417732299193317,
        0.396832216224350,  0.332636072999407,  -0.000000000000000, -0.000000000000000, -1.002514949358566, -0.121167807208073, -0.000000000000000,
        -0.000000000000000, -0.421337525817706, -0.144210596088527, 0.000000000000000,  -0.000000000000000, -0.664083934178043, -0.696097643545911,
        -0.000000000000000, -0.000000000000000, -0.019309419251637, 0.041511058537545,  0.955991262791915,  1.133893419027682,  -0.108380783515968,
        -0.042540949641143, -0.000000000000000, -0.000000000000000, -0.051427137976527, 0.224972110182279,  1.710129159598869,  2.028370211348440,
        -0.062601321662020, 0.117050867511076,  -0.000000000000000, -0.000000000000000, 0.047110801014737,  0.286609771773049,  -1.911982525583830,
        -2.267786838055364, 0.338891549651479,  0.335144110045028,  -0.000000000000000, -0.000000000000000, -0.357775162210529, -0.035598290994554,
        0.000000000000000,  0.000000000000000,  -0.194939914860236, -0.146777006496272, -0.637289733579589, -0.500056735779643, 0.000000000000000,
        -0.000000000000000, 0.122835375272177,  0.032839710813371,  -0.000000000000000, -0.000000000000000, 0.197088772044084,  0.046127925214711,
        0.972288088955592,  0.436027884945791,  0.076364289474117,  0.092428874107872,  -0.000000000000000, -0.000000000000000, -0.281310230036101,
        -0.121692602246529, 2.029162109910196,  0.909988791435963,  -0.062480771416515, 0.062614904990284,  -0.000000000000000, -0.000000000000000,
        0.175073415046589,  0.160917350900835,  -2.268672207563047, -1.017398398206846, -0.610528975454292, -0.283215251762149, -0.000000000000000,
        -0.000000000000000, -0.285198605603975, -0.157069368264998, -0.000000000000001, 0.000000000000000,  -0.216911941948501, -0.301969423130950,
        0.000000000000000,  -0.000000000000000, 0.015532827468919,  0.028336163387519,  -0.000000000000000, -0.000000000000000, 0.034917560478870,
        0.071553210800879,  0.256232213851866,  0.555492059863532,  0.025642354575189,  0.007219351704872,  -0.000000000000000, -0.000000000000000,
        0.047145285130649,  0.146110274860397,  0.534755804984834,  1.159310139695156,  0.124881745598010,  0.234015898713170,  -0.000000000000000,
        -0.000000000000000, 0.074463628992275,  0.096657201334150,  -0.597875165654355, -1.296148139681573, -0.045816554806613, -0.026516790684874,
        -0.000000000000000, -0.000000000000000, -0.046583471512786, -0.055477012206799, 0.000000000000000,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, 0.331387668903617,  0.462632475277521,  1.756065624833518,  1.430349717620453,  -0.550415554528824, -0.205329121779908,
        -0.000000000000000, -0.000000000000000, 0.297794952949520,  0.226209776626045,  0.663730418459820,  0.540621377239312,  0.239620651841206,
        -0.039410952097968, -0.000000000000000, -0.000000000000000, 0.133398881330508,  -0.304841442705441, 1.327460836919640,  1.081242754478624,
        0.107017838555351,  0.105793304926127,  -0.000000000000000, -0.000000000000000, -0.283514195400970, 0.062363834750282,  -3.512131249667036,
        -2.860699435240907, 0.283235641930544,  0.264511518413745,  -0.000000000000000, -0.000000000000000, 1.034838449912753,  1.017176361949856,
        -0.000000000000000, -0.000000000000000, 0.351301592280628,  0.585191736891761,  1.131144116524625,  1.341640786499874,  -0.331770860805293,
        -0.134760831575604, -0.000000000000000, -0.000000000000000, 0.118661233638767,  0.375901649779950,  0.427532289899718,  0.507092552837110,
        0.024903741722684,  -0.065782142351761, -0.000000000000000, -0.000000000000000, -0.125547319599160, -0.433805441287998, 0.855064579799436,
        1.014185105674221,  0.068026764544326,  0.150755575787414,  -0.000000000000000, -0.000000000000000, -0.037605176168820, 0.113335341330718,
        -2.262288233049249, -2.683281572999748, 0.340521650849273,  0.186677653098883,  -0.000000000000000, -0.000000000000000, 0.859687170238566,
        1.248401570884298,  0.026142632653357,  0.118905455160661,  -0.000000000000000, -0.000000000000000, -0.179030890454219, -0.077629255019677,
        1.150426781283747,  0.515915150999096,  0.108463080987305,  -0.060035790995564, -0.000000000000000, -0.000000000000000, 0.344611812359992,
        0.172509886713785,  0.434820452123613,  0.194997598164849,  0.178739007878295,  -0.259970806991163, -0.000000000000000, -0.000000000000000,
        0.209466370341710,  0.294913799929955,  1.014581054955098,  0.454994395717981,  -0.294602020796356, -0.055894275276149, -0.000000000000000,
        -0.000000000000000, -0.278495340660081, -0.099295286013701, -2.684329156328743, -1.203802018997890, 0.285576302631439,  0.300184446612074,
        -0.000000000000000, -0.000000000000000, 0.096984740526525,  0.158639001491843,  -0.000000000000000, -0.000000000000000, -0.009978516986948,
        -0.004990862911293, 0.303178044029577,  0.657267069006200,  -0.158910946458420, -0.331328073297665, -0.000000000000000, -0.000000000000000,
        0.091642364456750,  0.154578298186408,  0.114590529639607,  0.248423601363248,  -0.309403623216655, -0.535300947845246, -0.000000000000000,
        -0.000000000000000, 0.260218415660481,  0.456723861652672,  0.267377902492417,  0.579655069847578,  0.043140570076809,  0.092537918694808,
        -0.000000000000000, -0.000000000000000, -0.010555624746424, -0.004478656051040, -0.707415436069013, -1.533623161014466, 0.166144030631938,
        0.250135736717316,  -0.000000000000000, -0.000000000000000, 2.027729922424560,  1.651625589006949,  0.272271380036642,  0.684692460806983,
        -0.000000000000000, -0.000000000000000, -0.263030788919862, 0.237103275131323,  0.383204935767120,  0.312127897678783,  0.033510988765264,
        0.023724163196563,  -0.000000000000000, -0.000000000000000, 0.542705412188818,  0.303372638100379,  -0.000000000000000, 0.000000000000000,
        0.121636133409914,  0.031559991862431,  -0.000000000000000, -0.000000000000000, -0.939906121945857, -0.498088773854503, 0.766409871534240,
        0.624255795357566,  -0.345122916191356, -0.081401516579878, -0.000000000000000, -0.000000000000000, 0.084240391652184,  0.177397089866022,
        -4.055459844849121, -3.303251178013897, -0.264727901188128, -0.931653760594745, 1.306132720335507,  1.549193338482968,  0.369574071973854,
        1.000348553821096,  -0.000000000000000, -0.000000000000000, -0.031492525211782, 0.463345435501156,  0.246835882660859,  0.292770021884560,
        0.030747687548515,  0.020942814001096,  -0.000000000000000, -0.000000000000000, 0.321780733510694,  0.343998158357764,  -0.000000000000000,
        -0.000000000000000, 0.049163761828163,  0.029918011614971,  -0.000000000000000, -0.000000000000000, -0.546958806787789, -0.555409389830459,
        0.493671765321718,  0.585540043769120,  -0.140587463474737, -0.068718472382863, -0.000000000000000, -0.000000000000000, 0.119845975017440,
        0.231845052105414,  -2.612265440671013, -3.098386676965935, -0.441798821973136, -1.412512283085857, 0.017676790570990,  -0.002943088701178,
        1.328398423714253,  0.595727502616669,  0.040823389829684,  -0.061142968713606, -0.000000000000000, -0.000000000000000, 0.461924826617415,
        0.572188313531067,  0.251043705082723,  0.112581915791806,  0.964072771015041,  0.765419361813233,  -0.000000000000000, -0.000000000000000,
        0.233540080300670,  0.144564363483609,  0.000000000000000,  0.000000000000000,  -1.797069825530706, -1.445579973883571, -0.000000000000000,
        -0.000000000000000, 0.252789086986908,  0.586043831446779,  0.585768645193020,  0.262691136847547,  0.096920531126013,  0.166201951218209,
        -0.000000000000000, -0.000000000000000, 0.132831749418266,  0.162587341769860,  -3.099596321999923, -1.390030839438894, -0.039160446492353,
        -0.088338168170175, 0.350079850665721,  0.758946638440412,  -0.191529366194547, -0.408358274829265, -0.000000000000000, -0.000000000000000,
        0.363313978513325,  0.573748304001133,  0.066158873134009,  0.143427433120127,  0.345421380904507,  0.489493525675832,  -0.000000000000000,
        -0.000000000000000, 0.049905466727241,  0.063817564424628,  -0.000000000000000, -0.000000000000000, -0.652334268459095, -0.923004278515360,
        -0.000000000000000, -0.000000000000000, 0.467079553659655,  0.775910385038515,  0.154370703979355,  0.334664010613631,  0.118124641085491,
        0.189300692349081,  -0.000000000000000, -0.000000000000000, 0.120871236763823,  0.204523998476114,  -0.816852984886682, -1.770875489694295};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 28, 36));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeGSForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 0);

    CDenseMatrix amomxmat(36, 4);

    CDenseMatrix amomymat(36, 4);

    CDenseMatrix amomzmat(36, 4);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.185458449741992, -0.030705809301467, 0.000000000000000,  0.000000000000000,  -0.221381521849173,
        -0.051653398414232, 0.205737522150743,  0.086902196915375,  0.000000000000000,  0.000000000000000,  0.275765692932913,  0.181777305638529,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.227552312745387, -0.039785353020290, 0.000000000000000,
        -0.000000000000000, -0.279397243599371, -0.067405771049963, 0.259737461330393,  0.112358222693820,  0.000000000000000,  0.000000000000000,
        0.361371083682367,  0.239748378587283,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.146540385947762,
        0.013730050418028,  0.000000000000000,  0.000000000000000,  0.136152359965029,  0.020707283460854,  -0.161685816961841, -0.055272918157278,
        0.000000000000000,  0.000000000000000,  -0.151652766920654, -0.092377334660287, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.000000000000000, -0.445469039347620, -0.086498350913919, 0.000000000000000,  -0.000000000000000, -0.578668547634319, -0.148398857045198,
        0.471503517422279,  0.214790319630305,  0.000000000000000,  0.000000000000000,  0.710091288051068,  0.477180894078105,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.872875705886213, -0.146668744300016, 0.000000000000000,  0.000000000000000,
        -1.049862911311355, -0.247214181354379, 0.953593699077736,  0.405370254806906,  -0.000000000000000, 0.000000000000000,  1.291058004414469,
        0.852533089779921,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.602672161327634, -0.109731306076265,
        0.000000000000000,  0.000000000000000,  -0.756033449486438, -0.186847364182297, 0.659805850051974,  0.290947507967935,  -0.000000000000000,
        0.000000000000000,  0.945596085723171,  0.630449465276866,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.585995191467914, -0.095128314418206, 0.000000000000000,  0.000000000000000,  -0.692532269276182, -0.159595609811686, 0.660611619983323,
        0.276753977442665,  -0.000000000000000, 0.000000000000000,  0.874055317435882,  0.574822730579625,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.503845396539023, -0.080558206472555, 0.000000000000000,  0.000000000000000,  -0.590903641169180,
        -0.134865939551139, 0.556242719597079,  0.231401714371055,  0.000000000000000,  0.000000000000000,  0.727828381691747,  0.477695289486364,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.044615644902092, -0.006724744235360, 0.000000000000000,
        0.000000000000000,  -0.050820085254057, -0.011162164425000, 0.046600074329830,  0.018849862854303,  -0.000000000000000, 0.000000000000000,
        0.058295888576921,  0.037941270670567,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 36, 4));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.036854099161120, -0.006056617323870, 0.000000000000000,  0.000000000000000,  -0.043826268679428,
        -0.010178202425421, 0.040686339904801,  0.017128725212906,  0.000000000000000,  0.000000000000000,  0.054250588669172,  0.035727356171514,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.521918262043197, -0.089150493365541, 0.000000000000000,
        0.000000000000000,  -0.633092798996883, -0.150590386017144, 0.590475223897727,  0.252857857406285,  0.000000000000000,  0.000000000000000,
        0.808672192397686,  0.535062287788351,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.479195189286985,
        -0.084423939263340, 0.000000000000000,  0.000000000000000,  -0.590734364595981, -0.143171823401255, 0.542529718974081,  0.235503860382172,
        0.000000000000000,  0.000000000000000,  0.758886851843804,  0.503933744650015,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.544923328426050,  0.090155127556240,  0.000000000000000,  0.000000000000000,  0.650230512686299,  0.151644184068708,
        -0.623812577000843, -0.263514777672449, 0.000000000000000,  0.000000000000000,  -0.836245434227800, -0.551242310021290, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.506795211944449,  0.086817555926304,  0.000000000000000,  0.000000000000000,
        0.615669727497367,  0.146704693658396,  -0.580956030063746, -0.249086725151101, 0.000000000000000,  0.000000000000000,  -0.797160623523127,
        -0.527619681886436, 0.000000000000000,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.095256983693131, -0.017995189829651,
        0.000000000000000,  0.000000000000000,  -0.121894618137805, -0.030776066515775, 0.102330206321786,  0.045954423873299,  -0.000000000000000,
        0.000000000000000,  0.150805884381822,  0.100998430489667,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        -0.587740383781609, -0.098934548756316, 0.000000000000000,  0.000000000000000,  -0.707563860354470, -0.166796436137305, 0.663809744801301,
        0.282458783823127,  -0.000000000000000, -0.000000000000000, 0.900097141893496,  0.594525868102585,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.167246402364285,  0.029799727670602,  0.000000000000000,  -0.000000000000000, 0.207406643301789,
        0.050607707822307,  -0.192299861437528, -0.083868992311811, 0.000000000000000,  -0.000000000000000, -0.270959213707956, -0.180148967519526,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.172398994969965,  0.029581629470055,  0.000000000000000,
        0.000000000000000,  0.209613836095794,  0.049997799431795,  -0.195787165632225, -0.084006237794034, 0.000000000000000,  -0.000000000000000,
        -0.268959134942065, -0.178052207928044, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 36, 4));

    std::vector<double> intzvals{
        -0.000000000000000, 0.000000000000000,  0.085721478247771,  0.014159342018051,  0.000000000000000,  0.000000000000000,  0.102202994347738,
        0.023811327602173,  -0.095703400653448, -0.040386549113729, -0.000000000000000, 0.000000000000000,  -0.128088956757085, -0.084410672660519,
        0.000000000000000,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.456429976056688,  0.078253632907332,  0.000000000000000,
        0.000000000000000,  0.554720139344873,  0.132247370028410,  -0.480229303041949, -0.206024645835463, 0.000000000000000,  0.000000000000000,
        -0.659571822825913, -0.436624318054661, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.306815280754275,
        0.057871307746241,  0.000000000000000,  0.000000000000000,  0.392282470765976,  0.098955885623813,  -0.307791206995440, -0.138578267535689,
        0.000000000000000,  -0.000000000000000, -0.455373645588985, -0.305163384879914, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.260848019046262, -0.039114825279150, 0.000000000000000,  0.000000000000000,  -0.296379783779067, -0.064875022878459,
        0.258707212193136,  0.104079745238198,  0.000000000000000,  0.000000000000000,  0.320799860134844,  0.208434575321492,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.097783091152895, -0.017654385114114, 0.000000000000000,  0.000000000000000,
        -0.122115721952369, -0.030030559110067, 0.069439453683252,  0.030934398498432,  0.000000000000000,  -0.000000000000000, 0.101087747543928,
        0.067568757997650,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.260506881035244,  0.047911604951195,
        0.000000000000000,  0.000000000000000,  0.328564492149889,  0.081681532437612,  -0.288155420898516, -0.127618785238178, 0.000000000000000,
        0.000000000000000,  -0.415735951495605, -0.277482108752066, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.618122974828947,  0.102939661531456,  0.000000000000000,  0.000000000000000,  0.740057245295772,  0.173301250778547,  -0.662743703195308,
        -0.280557181696307, 0.000000000000000,  0.000000000000000,  -0.891416533740958, -0.587958155594932, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.035874881375481,  0.003481739549837,  0.000000000000000,  0.000000000000000,  0.033775202146844,
        0.005299354094449,  -0.057214332240674, -0.021221243249144, 0.000000000000000,  0.000000000000000,  -0.061969984758611, -0.039132451482437,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.112941687377208, -0.019673386693085, 0.000000000000000,
        0.000000000000000,  -0.138403852306146, -0.033315589762901, 0.114991418978207,  0.049720870911255,  0.000000000000000,  0.000000000000000,
        0.159874127102403,  0.106054381728507,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 36, 4));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeGPForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 1);

    CDenseMatrix amomxmat(36, 12);

    CDenseMatrix amomymat(36, 12);

    CDenseMatrix amomzmat(36, 12);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.283055754912303, -0.107885614300350, 0.000000000000000,  0.000000000000000,  0.305342478495851,
        0.054076016129638,  0.000000000000000,  0.000000000000000,  -0.069461210145638, -0.037702520429629, 0.000000000000000,  0.000000000000000,
        -0.393453830742950, -0.187158167908795, 0.000000000000000,  0.000000000000000,  0.291084093830353,  0.083182039728954,  -0.000000000000000,
        0.000000000000000,  -0.120499982626318, -0.067338600004933, -0.349568357258917, -0.233212913622471, -0.000000000000000, 0.000000000000000,
        0.283918897955986,  0.104531397341240,  -0.000000000000000, 0.000000000000000,  -0.084030860002314, -0.072644899809741, -0.000000000000001,
        0.000000000000000,  -0.616400075976620, -0.551031289618188, 0.000000000000000,  0.000000000000000,  0.166122895862279,  0.111289675058391,
        -0.000000000000000, 0.000000000000000,  -0.213634660422134, -0.198302077316383, 0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.000000000000001,  -0.677518550264271, -0.212058093096806, -0.000000000000000, -0.000000000000000, 0.333611462872097,  0.044614032475909,
        0.000000000000000,  0.000000000000000,  0.614885341081321,  0.144181758257146,  0.000000000000000,  -0.000000000000000, -0.841811851152425,
        -0.360236811389544, -0.000000000000000, 0.000000000000000,  0.290933104284246,  0.062494847130374,  0.000000000000000,  0.000000000000000,
        0.663957725457114,  0.234260498806174,  -0.762961218231390, -0.466988394934797, 0.000000000000000,  0.000000000000000,  0.253968610857822,
        0.067216904977701,  0.000000000000000,  0.000000000000000,  0.713938470129535,  0.363399239350244,  -0.000000000000000, -0.000000000000000,
        -1.182136845801180, -1.039524860149995, 0.000000000000000,  0.000000000000000,  0.039637195828390,  -0.012030135567946, 0.000000000000000,
        -0.000000000000000, 0.811339320272183,  0.674499114097850,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -1.045266768116533, -0.212686499131913, 0.000000000000000,  0.000000000000000,  0.572066877248041,  0.135281170735953,  0.000000000000000,
        0.000000000000000,  0.101630465621044,  0.019105049205877,  0.000000000000000,  0.000000000000000,  -1.049245495625678, -0.338605166205617,
        0.000000000000000,  0.000000000000000,  0.638277640487894,  0.216274092029481,  0.000000000000000,  0.000000000000000,  0.106515220373237,
        0.028252975103291,  -1.195271391836920, -0.612958105705349, -0.000000000000000, 0.000000000000000,  0.663739160146048,  0.389637660844010,
        -0.000000000000000, 0.000000000000000,  0.117706853644103,  0.065649805847809,  0.000000000000000,  0.000000000000000,  -1.392847177249617,
        -1.170256501195988, 0.000000000000000,  0.000000000000000,  0.933868937231556,  0.798209763296331,  0.000000000000000,  0.000000000000000,
        0.146820955409989,  0.120676745407002,  0.000000000000000,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -1.456733565629403,
        -0.401378151438959, 0.000000000000001,  -0.000000000000000, 1.224003245495909,  0.184511030913133,  0.000000000000000,  0.000000000000000,
        0.056522688628495,  -0.004553221250186, -0.000000000000000, 0.000000000000000,  -1.687576034833793, -0.671764336073400, 0.000000000000000,
        0.000000000000001,  1.122643467919048,  0.266707324739081,  0.000000000000000,  0.000000000000000,  0.029980621767469,  -0.013892890362320,
        -1.938596323867818, -1.136530436671144, -0.000000000000000, 0.000000000000000,  1.306556272030799,  0.557653120391924,  0.000000000000000,
        0.000000000000000,  0.078599976808153,  0.010772919377246,  0.000000000000000,  -0.000000000000000, -2.815284875404118, -2.455303078613208,
        -0.000000000000000, -0.000000000000000, 1.033556818971309,  0.770064983391678,  0.000000000000000,  0.000000000000000,  -0.036227910894734,
        -0.055899665796584, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000001,  0.795483581666252,  0.141684659305767,
        0.000000000000001,  0.000000000000000,  -0.127492035826222, -0.236390922924358, 0.000000000000000,  0.000000000000000,  0.828702694163531,
        0.194954157793579,  0.000000000000000,  0.000000000000001,  0.762042269848875,  0.217820191040052,  0.000000000000001,  -0.000000000000000,
        -0.575090555967895, -0.442985841636022, 0.000000000000000,  0.000000000000000,  0.894120293274942,  0.317372828637631,  0.697181339816468,
        0.261869188877666,  0.000000000000000,  0.000000000000001,  -0.430323661595615, -0.539149382661401, 0.000000000000002,  -0.000000000000000,
        1.009463298482683,  0.495603491345503,  0.000000000000000,  0.000000000000000,  0.425943731467505,  0.290466708245189,  0.000000000000000,
        0.000000000000000,  -1.757887998169384, -1.684815707282072, 0.000000000000000,  0.000000000000000,  1.077765434410711,  0.884832914379222,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.131195726416106,  0.039220444660260,  0.000000000000000,
        0.000000000000000,  0.681644573786595,  0.015028253451009,  -0.000000000000000, 0.000000000000000,  -0.610388151781229, -0.241521363670792,
        0.000000000000000,  0.000000000000000,  0.165764571535506,  0.064823813395834,  0.000000000000000,  0.000000000000000,  0.442676607961081,
        -0.019732191117560, -0.000000000000000, 0.000000000000000,  -0.861084261884518, -0.421851388121088, 0.027189630735889,  -0.039312164612065,
        0.000000000000000,  0.000000000000000,  0.536092826765856,  0.076383228258926,  -0.000000000000000, 0.000000000000000,  -0.683076479047643,
        -0.473003687530194, 0.000000000000000,  -0.000000000000000, -0.189840640064276, -0.200511484627559, 0.000000000000000,  0.000000000000000,
        -0.188771936982872, -0.304721086912923, 0.000000000000000,  0.000000000000000,  -1.281787883516417, -1.157957970662873, -0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.000000000000000, 0.546037440397103,  0.080637616481874,  -0.000000000000000, 0.000000000000000,
        0.075129177452292,  -0.078497545212667, 0.000000000000000,  0.000000000000000,  0.021887401603522,  -0.064296557177044, -0.000000000000000,
        0.000000000000001,  0.485129473124146,  0.118359864166788,  0.000000000000000,  0.000000000000000,  -0.128866672604964, -0.153601901902547,
        0.000000000000000,  0.000000000000000,  -0.125221029475904, -0.123894148293765, 0.663049475863555,  0.276301624261496,  -0.000000000000000,
        0.000000000000000,  -0.196220428441202, -0.291225751564172, 0.000000000000000,  -0.000000000000000, 0.036821857918826,  -0.073381437763702,
        0.000000000000000,  0.000000000000000,  0.517156935306398,  0.390679750735676,  0.000000000000000,  0.000000000000000,  -0.972924616256872,
        -0.937632869431867, 0.000000000000000,  -0.000000000000000, -0.320378647615406, -0.329005797460113, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.177904891033980,  -0.032449558313177, 0.000000000000000,  0.000000000000000,  0.400425854522936,
        0.034785258516508,  -0.000000000000000, -0.000000000000001, -0.537704758284750, -0.195369968336040, 0.000000000000000,  0.000000000000000,
        0.031182731363530,  -0.073070740139929, 0.000000000000000,  0.000000000000000,  0.298909986343293,  0.041408864217881,  0.000000000000000,
        0.000000000000000,  -0.728955201530357, -0.336861593578458, 0.137964459529965,  -0.020472577496286, 0.000000000000000,  0.000000000000000,
        0.294156780582726,  0.018997055002826,  -0.000000000000000, 0.000000000000000,  -0.624989109119313, -0.415429767411454, -0.000000000000000,
        0.000000000000000,  -0.196805031239922, -0.223622316566220, 0.000000000000000,  0.000000000000000,  -0.172528562415299, -0.228344260882345,
        0.000000000000000,  0.000000000000000,  -1.093421201716799, -0.975506991163929, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.257042592662391,  0.065280781289598,  0.000000000000000,  -0.000000000000000, 0.046476697424670,  0.007548737445401,
        0.000000000000000,  0.000000000000000,  -0.460407165025359, -0.134802709976684, 0.000000000000000,  0.000000000000001,  0.287030463387846,
        0.107734924536697,  -0.000000000000000, -0.000000000000000, 0.041636713586739,  0.011618001941159,  0.000000000000000,  0.000000000000000,
        -0.553660967479211, -0.226754754671366, 0.277955024969881,  0.148986762946735,  -0.000000000000000, 0.000000000000000,  0.051693720729969,
        0.017488552586797,  -0.000000000000000, -0.000000000000000, -0.535228914380440, -0.307511162181785, -0.000000000000000, 0.000000000000000,
        0.347238925416636,  0.294808511492056,  0.000000000000000,  0.000000000000000,  0.025838591950454,  0.016472751531248,  0.000000000000000,
        -0.000000000000000, -0.747664478927376, -0.646255853270355, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 36, 12));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  0.198800864227133,  0.056873589259542,  0.000000000000000,  0.000000000000000,  0.083507582025919,
        0.014150033381119,  0.000000000000000,  0.000000000000000,  -0.461221403120725, -0.134588267662055, -0.000000000000000, 0.000000000000000,
        0.235833794695982,  0.095451298501705,  0.000000000000000,  0.000000000000000,  0.078298704573097,  0.021519126344987,  0.000000000000000,
        0.000000000000000,  -0.553290169912821, -0.226373748226272, 0.245430374180860,  0.136631784844968,  -0.000000000000001, 0.000000000000000,
        0.067803287554364,  0.025280775574405,  0.000000000000000,  0.000000000000000,  -0.521549149408411, -0.301533668635068, -0.000000000000000,
        0.000000000000000,  0.326075764053581,  0.279673265254600,  0.000000000000000,  -0.000000000000000, 0.040958502452086,  0.027883919786171,
        0.000000000000000,  0.000000000000000,  -0.736597919791066, -0.638062236799607, 0.000000000000000,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, -0.191105097183259, -0.117794366280722, 0.000000000000000,  0.000000000000000,  0.639084505816030,  0.079184176145153,
        0.000000000000000,  0.000000000000000,  -0.374350166244150, -0.168295707383571, 0.000000000000000,  0.000000000000000,  -0.359395824082184,
        -0.212538953328255, 0.000000000000000,  0.000000000000000,  0.541260935327736,  0.108307916245977,  0.000000000000000,  0.000000000000000,
        -0.572997477970781, -0.296788148432670, -0.199921543262933, -0.208007151307766, -0.000000000000000, -0.000000000000000, 0.481589678040348,
        0.105442724636453,  -0.000000000000000, 0.000000000000000,  -0.466447731069560, -0.342980242799763, 0.000000000000000,  0.000000000000000,
        -0.650356068426301, -0.615943846695332, 0.000000000000000,  -0.000000000000000, -0.008298824606038, -0.105442854573790, 0.000000000000000,
        0.000000000000000,  -0.950723090307712, -0.865289386054903, 0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000,
        -0.035951497558342, -0.070922683189823, 0.000000000000000,  0.000000000000000,  -0.016670232962551, -0.082085798555261, 0.000000000000000,
        0.000000000000000,  1.199650045371508,  0.223218017095693,  -0.000000000000000, 0.000000000000000,  -0.167636969620624, -0.133815826140437,
        0.000000000000000,  0.000000000000000,  -0.177687609419903, -0.156927020481425, 0.000000000000000,  0.000000000000000,  1.173741694449795,
        0.345811267008252,  -0.017806705385687, -0.098941162978042, -0.000000000000000, -0.000000000000000, -0.286507286862199, -0.308007902041756,
        0.000000000000000,  0.000000000000000,  1.396833745144968,  0.687180548073486,  0.000000000000000,  0.000000000000000,  -0.381438607217311,
        -0.382584206736374, 0.000000000000000,  0.000000000000000,  -0.977775674947351, -0.931253464995023, 0.000000000000000,  0.000000000000000,
        1.491973970066161,  1.223147690774193,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.000000000000000, 0.050860973930037,
        0.081574971691496,  0.000000000000000,  0.000000000000000,  -0.496815357615931, -0.005783569168210, 0.000000000000000,  0.000000000000000,
        0.233939033427923,  0.030227201835657,  0.000000000000000,  0.000000000000000,  0.203742810888531,  0.152135926637548,  0.000000000000000,
        0.000000000000000,  -0.298723083651917, 0.021503495343172,  0.000000000000000,  0.000000000000000,  0.202196185046962,  0.041713189755651,
        0.041442341681965,  0.125817588845365,  0.000000000000000,  0.000000000000000,  -0.386089456116698, -0.026435110990086, 0.000000000000000,
        0.000000000000000,  0.497484570001026,  0.305291092400495,  -0.000000000000000, 0.000000000000000,  0.460142050245414,  0.454480159153089,
        0.000000000000000,  0.000000000000000,  0.230776765201728,  0.307975180561910,  0.000000000000000,  0.000000000000000,  0.770731542374241,
        0.676517235607173,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.789844716262617, -0.169597782124570,
        -0.000000000000000, -0.000000000000000, 0.062998764961315,  0.121623903512624,  -0.000000000000000, -0.000000000000001, -0.078992684596033,
        0.037681389301556,  0.000000000000000,  0.000000000000000,  -0.819710257159021, -0.271124549277851, -0.000000000000000, 0.000000000000000,
        0.291813694417607,  0.228634321413556,  0.000000000000000,  -0.000000000000001, 0.032664665290858,  0.077489352397828,  -0.983071924423748,
        -0.468057723011162, -0.000000000000000, 0.000000000000000,  0.278303358651620,  0.325012900382582,  -0.000000000000000, 0.000000000000000,
        0.161632324958390,  0.169497566133147,  -0.000000000000000, -0.000000000000002, -0.989185146357909, -0.799869399944357, 0.000000000000000,
        0.000000000000000,  1.047084569347944,  1.000693902741600,  -0.000000000000000, -0.000000000000000, 0.531247655909954,  0.503536396694072,
        -0.000000000000000, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.345948590109338,  0.095887700701326,  -0.000000000000001,
        0.000000000000000,  -0.532746623226637, -0.165824363515427, 0.000000000000000,  -0.000000000000000, 1.196083260964648,  0.290479291917966,
        0.000000000000000,  0.000000000000000,  0.405872109699018,  0.159788245392882,  -0.000000000000000, -0.000000000000001, -0.657777278412038,
        -0.281969947853307, 0.000000000000000,  0.000000000000000,  1.312459426649313,  0.474878244150073,  0.420369050892630,  0.230163466416529,
        -0.000000000000000, 0.000000000000000,  -0.759810002626481, -0.460701685330259, -0.000000000000000, 0.000000000000000,  1.608401604921567,
        0.880164618111269,  0.000000000000000,  -0.000000000000000, 0.540312448619930,  0.459599507360712,  0.000000000000000,  0.000000000000000,
        -1.162863547644465, -1.021829826719789, 0.000000000000000,  0.000000000000000,  2.072826364146680,  1.766858875826883,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.147067404151137,  -0.020323972071509, -0.000000000000000, 0.000000000000000,
        0.477181494859527,  0.001006829955663,  0.000000000000000,  0.000000000000000,  -0.352988816621533, -0.120658007886147, 0.000000000000000,
        0.000000000000000,  0.042338759847349,  -0.048580183983533, 0.000000000000000,  0.000000000000000,  0.279660020322447,  -0.029845286801468,
        -0.000000000000000, 0.000000000000001,  -0.461179942212542, -0.206898622550616, 0.207013881779237,  0.018358043310933,  0.000000000000000,
        0.000000000000000,  0.239884368622059,  -0.064978463468020, -0.000000000000000, -0.000000000000000, -0.381311731028181, -0.274034663970147,
        -0.000000000000000, 0.000000000000000,  -0.109005423681231, -0.150992473083357, 0.000000000000000,  0.000000000000000,  -0.468312307387523,
        -0.519545925006334, 0.000000000000000,  -0.000000000000000, -0.750744554352219, -0.680212793347403, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.572613239278810,  0.196568918451005,  -0.000000000000000, -0.000000000000000, -0.108105254811449,
        -0.010500319096272, 0.000000000000000,  0.000000000000000,  -0.964048998726116, -0.230926225581022, 0.000000000000000,  0.000000000000000,
        0.747536249875607,  0.337732009080417,  -0.000000000000000, 0.000000000000000,  -0.087592668203157, -0.012333336486421, 0.000000000000000,
        -0.000000000000000, -1.051047997030838, -0.376643230818647, 0.687065537822423,  0.431483341665477,  -0.000000000000000, 0.000000000000000,
        -0.073130500311058, 0.004895705858071,  0.000000000000000,  0.000000000000000,  -1.041389662433399, -0.553007046488680, 0.000000000000000,
        0.000000000000000,  1.108602770312427,  0.980755006599440,  0.000000000000000,  0.000000000000000,  0.087508539047789,  0.104182714921599,
        0.000000000000000,  -0.000000000000000, -1.274838341230543, -1.076092872504534, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.290541541128068,  0.108175744460941,  -0.000000000000000, 0.000000000000000,  -0.301670205116537, -0.055082851388458,
        0.000000000000000,  -0.000000000000000, 0.025152871609759,  0.030349117550586,  0.000000000000000,  0.000000000000000,  0.397447044133148,
        0.187420907105425,  0.000000000000000,  0.000000000000000,  -0.292886303824221, -0.084966480892968, -0.000000000000000, -0.000000000000001,
        0.078417460319364,  0.056399423393117,  0.341479097897824,  0.228752752354476,  0.000000000000000,  0.000000000000000,  -0.277550519456497,
        -0.104187522220281, 0.000000000000000,  -0.000000000000000, 0.063181864249590,  0.063458838706670,  0.000000000000000,  -0.000000000000000,
        0.607290170648377,  0.544020309407214,  0.000000000000000,  0.000000000000000,  -0.167732738071140, -0.113182710564531, 0.000000000000000,
        0.000000000000000,  0.196557929961455,  0.185636742382748,  0.000000000000000,  -0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 36, 12));

    std::vector<double> intzvals{
        0.000000000000000,  -0.000000000000000, -0.069400585527552, -0.011401663372677, 0.000000000000000,  0.000000000000000,  -0.129339654081495,
        -0.019171068829913, 0.000000000000000,  -0.000000000000000, 0.299868657524792,  0.093007867649233,  0.000000000000000,  -0.000000000000000,
        -0.064223291838801, -0.017219207059530, 0.000000000000000,  0.000000000000000,  -0.115333812069665, -0.028112698496771, 0.000000000000000,
        -0.000000000000000, 0.371481853880578,  0.157671659188520,  -0.037934188412352, -0.008138113588924, 0.000000000000001,  0.000000000000000,
        -0.161399514178546, -0.063986885035227, 0.000000000000000,  0.000000000000000,  0.422056238500137,  0.251680908775130,  0.000000000000000,
        -0.000000000000000, 0.000687183889856,  0.008099741311418,  0.000000000000000,  0.000000000000000,  -0.112441103631447, -0.081371187938217,
        0.000000000000000,  0.000000000000000,  0.626351574262571,  0.546788589605606,  -0.000000000000000, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.180427643446637,  0.101301940502419,  0.000000000000000,  0.000000000000000,  -0.423780243898062, -0.026387391976424,
        0.000000000000000,  0.000000000000000,  0.005617794136934,  0.055065030764008,  0.000000000000000,  0.000000000000000,  0.318227791346977,
        0.181753395551131,  0.000000000000000,  -0.000000000000000, -0.304561901374930, -0.021721545477919, 0.000000000000000,  0.000000000000000,
        0.118768054933975,  0.105044823921200,  0.520747497186915,  0.371276428263358,  0.000000000000000,  0.000000000000000,  -0.514016926866602,
        -0.155392088042478, 0.000000000000000,  0.000000000000000,  0.131596353128823,  0.141709933800091,  0.000000000000000,  0.000000000000000,
        1.015567742404858,  0.919951787120220,  0.000000000000000,  0.000000000000000,  -0.160983251845883, -0.058555267402518, 0.000000000000000,
        0.000000000000000,  0.447376332661886,  0.424979661047065,  0.000000000000000,  0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.196410573797402,  0.069744643360173,  0.000000000000000,  0.000000000000000,  -0.065678968062702, 0.051817633983946,  0.000000000000000,
        0.000000000000000,  -0.867516190596947, -0.162430310748890, 0.000000000000000,  0.000000000000000,  0.256588544320011,  0.121281206066358,
        0.000000000000000,  0.000000000000000,  0.061121749247387,  0.105562851037146,  -0.000000000000000, -0.000000000000000, -0.853084506722593,
        -0.251545322184008, 0.532749350628726,  0.341941686504291,  -0.000000000000000, 0.000000000000000,  -0.099900148258416, 0.033291357130233,
        0.000000000000000,  0.000000000000000,  -1.006391089143002, -0.496822647383748, 0.000000000000000,  0.000000000000000,  0.895004516466317,
        0.798483793463391,  0.000000000000000,  0.000000000000000,  0.234617651807323,  0.261907461329372,  0.000000000000000,  0.000000000000000,
        -1.078619613082733, -0.883766903427153, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.604460428675697,
        0.119693909138548,  -0.000000000000000, -0.000000000000000, -0.107383662558532, -0.077021750441310, 0.000000000000000,  0.000000000000000,
        -0.339414769129735, -0.071733813743361, 0.000000000000000,  0.000000000000000,  0.600898449493342,  0.189269292808702,  0.000000000000000,
        0.000000000000000,  -0.233723432656001, -0.138243036275228, 0.000000000000000,  0.000000000000000,  -0.352866924591768, -0.113672472372994,
        0.478043437824476,  0.214780093011716,  0.000000000000000,  0.000000000000000,  -0.120042318490118, -0.136590508222611, -0.000000000000000,
        -0.000000000000000, -0.251052558576809, -0.141759755173155, 0.000000000000000,  0.000000000000000,  0.437363209088993,  0.347709893519056,
        0.000000000000000,  0.000000000000000,  -0.423914139350680, -0.398580493356505, 0.000000000000000,  -0.000000000000000, -0.336505557509768,
        -0.287176746418664, 0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000, 0.500083004924190,  0.131311093545653,
        0.000000000000000,  0.000000000000000,  -0.038857977900914, -0.025356375669009, 0.000000000000000,  0.000000000000001,  -0.494972777538927,
        -0.175635305743690, -0.000000000000000, -0.000000000000000, 0.569937516437046,  0.217317414833783,  0.000000000000000,  0.000000000000000,
        -0.074410036115921, -0.046248279359781, 0.000000000000000,  0.000000000000001,  -0.658631389259802, -0.302790867260376, 0.291976434300284,
        0.148954075636916,  -0.000000000000000, -0.000000000000000, -0.026391374058935, -0.027545768334341, 0.000000000000000,  0.000000000000000,
        -0.229329445577190, -0.154849300815399, 0.000000000000000,  0.000000000000001,  0.332194876137545,  0.275874474129563,  -0.000000000000000,
        -0.000000000000000, -0.088580288052802, -0.084963514434865, 0.000000000000000,  0.000000000000000,  -0.413399236554521, -0.371217677982433,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.328223054989473, -0.093628569285037, 0.000000000000000,
        0.000000000000001,  0.264439561671891,  0.145633662969466,  0.000000000000000,  0.000000000000000,  -0.890136964096741, -0.202337642266242,
        0.000000000000000,  0.000000000000000,  -0.392351583094039, -0.156319221048526, 0.000000000000000,  0.000000000000000,  0.455212152185500,
        0.262063142728207,  0.000000000000000,  0.000000000000000,  -0.948992622864928, -0.326642322527151, -0.266154547173781, -0.126354770200020,
        0.000000000000000,  0.000000000000000,  0.262707428155013,  0.242840221113665,  0.000000000000000,  0.000000000000000,  -0.695480076909632,
        -0.340576008917475, 0.000000000000000,  0.000000000000000,  -0.261844640639204, -0.208829666335839, 0.000000000000000,  0.000000000000000,
        0.741475434896487,  0.698358463302162,  0.000000000000000,  0.000000000000000,  -0.734715777515287, -0.600080263941848, 0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.477071026571632, -0.068705893242214, 0.000000000000000,  0.000000000000000,
        -0.168954805754659, 0.084620529248553,  -0.000000000000000, -0.000000000000000, 0.057625719428009,  0.053232871860416,  0.000000000000000,
        -0.000000000000000, -0.421774154262272, -0.099730392487887, 0.000000000000000,  0.000000000000000,  0.082882269628555,  0.172474332277299,
        0.000000000000000,  -0.000000000000000, 0.147109302662531,  0.097663812801258,  -0.209411350757850, -0.018389766147009, 0.000000000000000,
        -0.000000000000000, -0.243835739698063, 0.055023394452769,  0.000000000000000,  0.000000000000000,  0.390663986904798,  0.291363808748345,
        0.000000000000001,  0.000000000000000,  0.109456988458276,  0.151343525688194,  0.000000000000000,  -0.000000000000000, 0.429384071296637,
        0.479998270543469,  0.000000000000000,  0.000000000000000,  0.810341567036113,  0.738056781443404,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.422193862728346, -0.117057706553830, 0.000000000000000,  0.000000000000000,  -0.034908480994060,
        -0.001198950114964, 0.000000000000000,  0.000000000000000,  0.712054920478685,  0.184448359950530,  0.000000000000000,  0.000000000000000,
        -0.491041525447946, -0.196000647995033, 0.000000000000000,  -0.000000000000000, -0.018581048345250, -0.000870415501960, 0.000000000000000,
        0.000000000000000,  0.806514737861586,  0.304543565763325,  -0.547450705659495, -0.306351890258449, 0.000000000000000,  0.000000000000000,
        -0.062076428703110, -0.016053574254023, 0.000000000000000,  -0.000000000000000, 1.027760705346539,  0.577561252799824,  0.000000000000000,
        0.000000000000000,  -0.736466762879718, -0.634113484000725, 0.000000000000000,  0.000000000000000,  -0.015181568595628, -0.005248015435511,
        0.000000000000000,  0.000000000000000,  1.383422004335383,  1.187922292983022,  0.000000000000000,  0.000000000000000,  -0.000000000000000,
        -0.000000000000000, -0.237662030110902, -0.082916444120500, 0.000000000000000,  0.000000000000000,  0.169865623897292,  0.026626965515743,
        0.000000000000000,  0.000000000000000,  0.111988050158904,  0.016249667786531,  0.000000000000000,  -0.000000000000000, -0.313160710358284,
        -0.142700518706403, 0.000000000000000,  0.000000000000000,  0.156213923346063,  0.039333847565941,  0.000000000000000,  0.000000000000001,
        0.100028444591914,  0.023481042545942,  -0.364458589194474, -0.227726373335749, 0.000000000000000,  -0.000000000000000, 0.193749816482616,
        0.078758409827308,  0.000000000000000,  0.000000000000000,  0.146754628574191,  0.065933658862360,  -0.000000000000000, 0.000000000000000,
        -0.583120407142675, -0.515129271599822, 0.000000000000000,  -0.000000000000000, 0.140374308278998,  0.102235543863142,  0.000000000000000,
        0.000000000000000,  0.131714802166075,  0.103205950505330,  -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 36, 12));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeGDForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 2);

    CDenseMatrix amomxmat(36, 20);

    CDenseMatrix amomymat(36, 20);

    CDenseMatrix amomzmat(36, 20);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.502753557986765, -0.299186002388756, 0.000000000000000,  0.000000000000000,  0.385693080050182,
        0.170184430169309,  0.000000000000000,  0.000000000000000,  -0.639376396501063, -0.153225910906042, 0.000000000000000,  0.000000000000000,
        0.178409786174837,  0.085157658018173,  0.000000000000000,  0.000000000000000,  0.120929112911004,  0.146284711265319,  0.000000000000000,
        0.000000000000000,  -0.649294671459247, -0.516796190851908, 0.000000000000000,  0.000000000000000,  0.453210231836015,  0.272661083976382,
        0.000000000000000,  0.000000000000000,  -0.547969507843538, -0.222095566944769, 0.000000000000000,  -0.000000000000000, 0.223040973090082,
        0.136393737776795,  0.000000000000000,  0.000000000000000,  0.245635265822746,  0.267099237668186,  0.570306553155949,  0.487282847861199,
        -0.000000000000001, 0.000000000000000,  -0.426081915248715, -0.253814065865535, 0.000000000000000,  0.000000000000000,  0.579392135419206,
        0.273894488275992,  -0.000000000000000, 0.000000000000000,  -0.145567962499722, -0.105674487708566, 0.000000000000000,  0.000000000000000,
        -0.263837095011304, -0.269626581947255, 0.000000000000000,  0.000000000000000,  1.023561982541201,  1.175428610092683,  0.000000000000000,
        0.000000000000000,  -0.337629958933001, -0.303722727833426, -0.000000000000000, 0.000000000000000,  0.339827508534084,  0.307023943135719,
        0.000000000000000,  0.000000000000000,  -0.155198795844946, -0.145660846116582, 0.000000000000000,  0.000000000000000,  -0.613718481470981,
        -0.721548300506853, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.743366752399347, -0.213385603589915,
        0.000000000000000,  0.000000000000000,  0.543853916927826,  0.111581411005556,  0.000000000000000,  0.000000000000000,  -0.558278399919254,
        -0.087774279798377, 0.000000000000000,  0.000000000000000,  -0.220303035261656, 0.036565477977935,  -0.000000000000000, 0.000000000000000,
        -0.418336096168250, 0.055062188564595,  0.000000000000000,  0.000000000000000,  -0.681318331911371, -0.325448917054183, 0.000000000000000,
        0.000000000000000,  0.465318904683951,  0.144621324588095,  0.000000000000000,  0.000000000000000,  -0.406398271919425, -0.112027228843938,
        0.000000000000000,  0.000000000000000,  -0.045488465569227, 0.081572507008606,  -0.000000000000000, 0.000000000000000,  -0.165585507406119,
        0.150807395886531,  0.670717382216275,  0.410251758521277,  -0.000000000000000, -0.000000000000000, -0.402702279198328, -0.076046886063311,
        -0.000000000000001, 0.000000000000000,  0.457252600947600,  0.198068429163515,  0.000000000000000,  -0.000000000000000, 0.144684931515395,
        -0.130523294325895, 0.000000000000000,  0.000000000000000,  0.443624111501277,  0.071061504188267,  -0.000000000000000, -0.000000000000000,
        0.683065189857790,  0.720528055857113,  -0.000000000000000, 0.000000000000000,  0.215516602554180,  0.397768687396875,  0.000000000000000,
        0.000000000000000,  0.240015491751069,  0.219524646297737,  0.000000000000000,  -0.000000000000000, -0.491224860606591, -0.629977762177920,
        0.000000000000000,  0.000000000000000,  -0.209930973184170, -0.373938436126334, 0.000000000000000,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  -1.003889947913636, -0.470312571151825, 0.000000000000000,  0.000000000000000,  0.633312074295581,  0.069219078121652,
        0.000000000000000,  0.000000000000000,  -0.661443406294741, -0.057491286400490, 0.000000000000000,  -0.000000000000000, 0.650159840674527,
        0.326184441760079,  0.000000000000000,  0.000000000000000,  -0.512730853598223, -0.111068727730295, 0.000000000000000,  0.000000000000000,
        -1.184527646646289, -0.773079749238022, 0.000000000000000,  0.000000000000000,  0.391792640823418,  0.079039281520965,  0.000000000000000,
        0.000000000000000,  -0.380579600640854, -0.061656719265143, 0.000000000000000,  0.000000000000000,  0.809106695344275,  0.534479742251267,
        0.000000000000000,  0.000000000000000,  -0.381912584446900, -0.171520131405675, 1.249870284444213,  1.011657504379476,  -0.000000000000000,
        0.000000000000000,  -0.676110722206274, -0.202755700035875, -0.000000000000000, -0.000000000000000, 0.796275733415174,  0.205425951215743,
        0.000000000000000,  0.000000000000000,  -0.804499011797157, -0.692081478237824, -0.000000000000001, -0.000000000000000, 0.646919941613215,
        0.254951062100805,  0.000000000000000,  -0.000000000000000, 1.986645491779359,  2.218540110823146,  0.000000000000000,  0.000000000000000,
        -0.049432234359247, 0.074713049649111,  -0.000000000000000, 0.000000000000000,  -0.081549898982951, -0.273349293463781, 0.000000000000000,
        0.000000000000000,  -1.395774570054763, -1.568046608132682, -0.000000000000000, 0.000000000000000,  0.229400165393668,  0.157172854826156,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  1.224015567337882,  0.317763836669627,  0.000000000000000,
        0.000000000000000,  -0.039343366209578, -0.189907486705916, -0.000000000000000, 0.000000000000000,  -0.715573518020547, 0.113727836601033,
        0.000000000000000,  0.000000000000000,  -0.677121516309835, -0.113706176680323, -0.000000000000000, -0.000000000000000, -1.104596081539293,
        -0.271756220335540, 0.000000000000000,  0.000000000000000,  1.083328132106276,  0.469868876107570,  0.000000000000000,  0.000000000000000,
        -0.247997020583833, -0.363325075750913, 0.000000000000000,  -0.000000000000000, -0.122373794619066, 0.242350578609364,  0.000000000000000,
        0.000000000000000,  -0.489200687626853, -0.155476660503140, -0.000000000000000, -0.000000000000000, -0.944415342719867, -0.401206279996259,
        -1.614522025836364, -0.911259066426347, 0.000000000000000,  0.000000000000000,  0.180352053523216,  0.550356268274738,  -0.000000000000001,
        0.000000000000000,  0.591353672812757,  -0.244578590575168, -0.000000000000001, -0.000000000000000, 0.812100602876461,  0.386548747662046,
        -0.000000000000000, -0.000000000000000, 1.219405645337672,  0.528046824927714,  -0.000000000000000, 0.000000000000000,  -1.310665898327770,
        -1.270751269569510, 0.000000000000000,  0.000000000000000,  1.700093698201993,  2.171332728512369,  0.000000000000000,  0.000000000000000,
        -1.148542405743406, -1.508245395602413, 0.000000000000000,  -0.000000000000000, 0.521920728257356,  0.506455764876031,  -0.000000000000000,
        0.000000000000000,  0.489035621585949,  0.328167928626378,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.241796769057950, -0.054773286946975, -0.000000000000000, -0.000000000000000, -1.203076583302324, -0.168667096556366, 0.000000000000000,
        0.000000000000000,  0.809314248536637,  0.094741342370482,  0.000000000000000,  0.000000000000000,  -0.804788549924149, -0.086890632765200,
        0.000000000000000,  0.000000000000000,  -0.670757472551865, -0.165981519253374, 0.000000000000000,  0.000000000000000,  -0.183429591502101,
        -0.085334078871520, -0.000000000000000, -0.000000000000000, -0.816412420556067, -0.214474358399743, 0.000000000000000,  0.000000000000000,
        0.684712128406405,  0.049364754780429,  0.000000000000000,  0.000000000000000,  -0.525227589723292, -0.089754048312506, 0.000000000000000,
        0.000000000000000,  -0.611895687167400, -0.231675413668918, 0.242716769142929,  0.008791614768873,  0.000000000000000,  0.000000000000000,
        1.274564301973358,  0.718366995174680,  -0.000000000000000, -0.000000000000000, -0.726683809596864, -0.147297606447641, -0.000000000000000,
        0.000000000000000,  0.528525364481484,  0.078683060236300,  0.000000000000000,  0.000000000000000,  1.046577701679201,  0.686084277474992,
        -0.000000000000000, 0.000000000000000,  -0.150046534311740, -0.223518963640805, 0.000000000000000,  0.000000000000000,  1.275020400313969,
        1.412801093086334,  -0.000000000000000, -0.000000000000001, 0.514467425056994,  0.943625661081550,  0.000000000000000,  0.000000000000000,
        -0.136656355904969, -0.245114450691280, 0.000000000000000,  0.000000000000000,  1.123452206200403,  1.159436635834255,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.283445487380162,  0.118047732662313,  0.000000000000000,  0.000000000000000,
        -0.911346913615286, -0.134377919167185, 0.000000000000000,  0.000000000000000,  -0.243089262488264, 0.085961153484947,  0.000000000000000,
        0.000000000000000,  0.509454577930375,  -0.020311826488185, 0.000000000000000,  0.000000000000000,  0.112939822776933,  0.108261335967757,
        0.000000000000000,  -0.000000000000000, 0.313842901789277,  0.190405425268145,  0.000000000000000,  0.000000000000000,  -0.672014170421062,
        -0.159437417160440, 0.000000000000000,  0.000000000000000,  0.097079598075650,  0.142064764040028,  0.000000000000000,  0.000000000000000,
        0.347095910602949,  -0.128130569343435, 0.000000000000000,  0.000000000000000,  0.228459239455096,  0.182680270913245,  -0.107737851048735,
        0.017213655801459,  0.000000000000000,  0.000000000000000,  0.610864628742562,  0.295356379218522,  -0.000000000000000, -0.000000000000000,
        0.356823583640382,  0.037185044618892,  -0.000000000000000, -0.000000000000000, -0.389714196229946, -0.041795026647208, -0.000000000000000,
        0.000000000000000,  -0.160689151248424, -0.125872277523269, 0.000000000000000,  0.000000000000000,  0.210106422588256,  0.314679389136257,
        0.000000000000000,  0.000000000000000,  0.466416458101752,  0.500514629890083,  -0.000000000000000, 0.000000000000000,  0.005142258662388,
        0.023492413982845,  -0.000000000000000, 0.000000000000000,  0.425423124123380,  0.710783295711774,  0.000000000000000,  0.000000000000000,
        -0.220881670412650, -0.232478600267746, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.547332081771313,
        -0.036292228361199, 0.000000000000000,  0.000000000000000,  -1.184918589423015, -0.336620447813822, 0.000000000000000,  0.000000000000000,
        -0.036988373105644, 0.027962104764386,  0.000000000000000,  0.000000000000000,  0.764300344128412,  0.223103489001163,  0.000000000000000,
        0.000000000000000,  -1.121060527017821, -0.483985056007151, 0.000000000000000,  0.000000000000000,  -0.324099083975153, -0.019226318800411,
        0.000000000000000,  -0.000000000000000, -1.038812910742372, -0.527298046543720, 0.000000000000000,  0.000000000000000,  0.029544462671949,
        0.052185182731932,  0.000000000000000,  0.000000000000000,  0.777823938469361,  0.314792748372335,  0.000000000000000,  0.000000000000000,
        -1.254325860852381, -0.790555510931245, 0.609998478766252,  0.286932652901608,  -0.000000000000000, 0.000000000000000,  1.276853133962898,
        0.745010672472157,  0.000000000000000,  -0.000000000000000, -0.080132787627213, 0.083194688753891,  -0.000000000000001, 0.000000000000000,
        -0.845423398089624, -0.532028292109139, -0.000000000000000, -0.000000000000000, 1.360891375132490,  1.062115876216328,  -0.000000000000000,
        0.000000000000000,  0.393532429931383,  0.385613573734052,  0.000000000000000,  0.000000000000000,  1.276068081549995,  1.377931519428285,
        0.000000000000000,  0.000000000000000,  0.459793748204905,  0.651710804417365,  0.000000000000000,  0.000000000000000,  -0.716933496126615,
        -0.644129007563637, -0.000000000000000, 0.000000000000000,  2.051272327654599,  2.278374298739946,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.041495574272322,  -0.099482839338646, 0.000000000000000,  0.000000000000000,  -0.537117718332511,
        -0.083635055091061, 0.000000000000000,  0.000000000000000,  -0.639583752641668, -0.111901587130376, 0.000000000000000,  0.000000000000000,
        0.553456685808442,  0.127656093727244,  0.000000000000000,  0.000000000000000,  -0.353301299057954, -0.165383610614263, 0.000000000000000,
        0.000000000000000,  -0.069503512788302, -0.205540957106216, 0.000000000000000,  0.000000000000000,  -0.347395691397273, -0.121242919446368,
        0.000000000000000,  0.000000000000000,  -0.496680768634188, -0.142694429055188, 0.000000000000000,  0.000000000000000,  0.504431210671859,
        0.169794646740141,  0.000000000000000,  0.000000000000000,  -0.432276740076187, -0.265853185260645, -0.043526057763308, 0.079738704320132,
        0.000000000000000,  -0.000000000000000, 0.508971900555857,  0.261837995903535,  -0.000000000000000, -0.000000000000000, 0.462950934853586,
        0.199313046665572,  0.000000000000000,  0.000000000000000,  -0.412046845330633, -0.108469617473225, -0.000000000000001, 0.000000000000000,
        0.245240953191926,  0.246919475878725,  -0.000000000000000, -0.000000000000000, 0.361110305542244,  0.496015236838515,  0.000000000000000,
        0.000000000000000,  0.483313108488190,  0.553130247540604,  -0.000000000000000, 0.000000000000000,  0.266093033326393,  0.261620711690548,
        0.000000000000000,  0.000000000000000,  0.153280839639259,  0.333330917219988,  0.000000000000000,  0.000000000000000,  0.517893947554715,
        0.586769278066991,  -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.091817292712964, -0.142163529179389,
        0.000000000000000,  0.000000000000000,  -0.465340560684730, -0.127712216975010, 0.000000000000000,  0.000000000000000,  -0.085420676406656,
        -0.023991995261368, 0.000000000000000,  0.000000000000000,  0.693281039227559,  0.216862495473263,  0.000000000000000,  0.000000000000000,
        -0.338547942307181, -0.277606365528841, 0.000000000000000,  0.000000000000000,  -0.225798363870296, -0.261807038075275, 0.000000000000000,
        -0.000000000000000, -0.418541431243923, -0.192612502586680, 0.000000000000000,  0.000000000000000,  -0.079113082125371, -0.035706631469712,
        0.000000000000000,  0.000000000000000,  0.666183268268798,  0.334375619282252,  0.000000000000000,  0.000000000000000,  -0.542188179035029,
        -0.489348665953124, 0.233764716048911,  0.257995359609402,  -0.000000000000000, -0.000000000000000, 0.412202154307038,  0.197303969852530,
        0.000000000000000,  -0.000000000000000, 0.097272056437835,  0.046493627892604,  -0.000000000000000, 0.000000000000000,  -0.700739104581290,
        -0.350502209035564, 0.000000000000000,  0.000000000000000,  0.403494229282155,  0.425420229589638,  -0.000000000000001, 0.000000000000000,
        0.602116735696226,  0.712274687293789,  -0.000000000000000, 0.000000000000000,  0.236293333740514,  0.205707740956291,  0.000000000000000,
        0.000000000000000,  0.058940373305837,  0.053882226987960,  0.000000000000000,  0.000000000000000,  -0.424792275773892, -0.368943482814719,
        0.000000000000000,  0.000000000000000,  0.963290861716229,  1.127723041164606,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 36, 20));

    std::vector<double> intyvals{
        0.000000000000000,  0.000000000000000,  -0.430026639417535, -0.237634602144153, 0.000000000000000,  0.000000000000000,  -0.304803354081787,
        -0.091805553481675, 0.000000000000000,  0.000000000000000,  -0.188673943938814, -0.038485699761476, 0.000000000000000,  0.000000000000000,
        0.811548338514484,  0.251793540079292,  0.000000000000000,  0.000000000000000,  -0.208318554574905, -0.236003082110529, 0.000000000000000,
        0.000000000000000,  -0.543393715352056, -0.403194011305525, 0.000000000000000,  -0.000000000000000, -0.286289493672151, -0.141011230425408,
        0.000000000000000,  0.000000000000000,  -0.149116386584672, -0.054299145579760, 0.000000000000000,  0.000000000000000,  0.779564596065347,
        0.386527952617378,  0.000000000000000,  0.000000000000000,  -0.410808098642796, -0.426828967588787, 0.393167501361362,  0.345772293860012,
        -0.000000000000000, -0.000000000000000, 0.321471739060492,  0.154383648553573,  0.000000000000000,  0.000000000000000,  0.149158785351737,
        0.066967679343910,  -0.000000000000000, 0.000000000000000,  -0.748763996817820, -0.382448192342930, 0.000000000000000,  0.000000000000000,
        0.318927791788188,  0.373006394050730,  -0.000000000000001, 0.000000000000000,  0.722746983127762,  0.826008919183932,  -0.000000000000000,
        0.000000000000000,  0.182341493631878,  0.156573457878134,  0.000000000000000,  0.000000000000000,  0.079581627679622,  0.070453290465680,
        0.000000000000000,  0.000000000000000,  -0.474024137802538, -0.417448812518213, 0.000000000000000,  0.000000000000000,  0.886232432964204,
        1.053185146913689,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.381685650471150, -0.252415713829295,
        0.000000000000000,  0.000000000000000,  0.344991568238098,  0.142064828720988,  0.000000000000000,  0.000000000000000,  -1.053735912323136,
        -0.171470617747430, 0.000000000000000,  0.000000000000000,  0.232321619261071,  0.088439866453062,  0.000000000000000,  0.000000000000000,
        0.795006211084065,  0.223017032319156,  0.000000000000000,  0.000000000000000,  -0.502540683617116, -0.448800885149912, 0.000000000000000,
        0.000000000000000,  0.430422414785012,  0.210175771063669,  0.000000000000000,  0.000000000000000,  -0.782827730417524, -0.219056372612215,
        0.000000000000000,  0.000000000000000,  0.295493798849041,  0.122252341117862,  0.000000000000000,  0.000000000000000,  0.734637154238244,
        0.333418376673317,  0.319405459492701,  0.341676993243417,  0.000000000000000,  0.000000000000000,  -0.257452827012207, -0.162808410624336,
        -0.000000000000000, -0.000000000000000, 0.837806371621871,  0.364161121248266,  0.000000000000000,  0.000000000000000,  -0.127278008831152,
        0.001820498540472,  -0.000000000000001, 0.000000000000000,  -0.709582353347158, -0.435624148565870, 0.000000000000000,  0.000000000000000,
        0.852622051905114,  1.038912123492121,  0.000000000000000,  0.000000000000000,  -0.110774575271531, -0.012174354871431, -0.000000000000000,
        0.000000000000000,  0.452132775355743,  0.421123425350719,  0.000000000000000,  0.000000000000000,  0.261074049526662,  0.417983269127815,
        0.000000000000000,  0.000000000000000,  -0.705748842583694, -0.731317110512829, 0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.144283473959089,  0.217810496724991,  -0.000000000000000, 0.000000000000000,  -0.143218020622855, -0.133466734767491,
        0.000000000000000,  0.000000000000000,  0.128386149405967,  0.045862346560244,  0.000000000000000,  0.000000000000000,  -0.912053785363682,
        -0.063905303672325, 0.000000000000000,  0.000000000000000,  -0.138799106848745, -0.078605754992657, 0.000000000000000,  0.000000000000000,
        0.419787077612522,  0.373623653179385,  -0.000000000000000, 0.000000000000000,  -0.205303706950464, -0.254572388456140, 0.000000000000000,
        0.000000000000000,  0.123816043098845,  0.074887286212461,  0.000000000000000,  0.000000000000000,  -0.494846411340139, -0.057965814213935,
        0.000000000000000,  0.000000000000000,  -0.152489879837598, -0.143207048435076, -0.201048926099353, -0.394941059721813, 0.000000000000000,
        0.000000000000000,  0.225948170471505,  0.268290207737718,  0.000000000000000,  0.000000000000000,  -0.272472182556747, 0.007539681341158,
        -0.000000000000001, 0.000000000000000,  0.947850985631809,  0.248782264028981,  0.000000000000000,  0.000000000000000,  0.235038608206401,
        0.060565740388957,  0.000000000000000,  0.000000000000000,  -0.970933519894820, -1.145723034613536, 0.000000000000000,  0.000000000000000,
        0.778336551037292,  0.996863600856856,  0.000000000000000,  -0.000000000000000, 0.373574205852204,  0.575833721510490,  0.000000000000000,
        0.000000000000000,  0.025581299921098,  -0.125616224398913, 0.000000000000000,  0.000000000000000,  -0.031291373015986, -0.093752148963859,
        0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.264653569967148, -0.037400663579436, 0.000000000000000,
        0.000000000000000,  0.154160904272990,  0.054964738509976,  0.000000000000000,  0.000000000000000,  0.283567181588042,  -0.026783524861749,
        0.000000000000000,  0.000000000000000,  0.547257397877767,  0.105181322629128,  0.000000000000000,  0.000000000000000,  -0.151607121522388,
        0.041612885705455,  -0.000000000000000, 0.000000000000000,  -0.180797009914166, -0.047666436438180, 0.000000000000000,  0.000000000000000,
        0.081967341659285,  0.114783975316014,  0.000000000000000,  0.000000000000000,  0.040456183442412,  -0.050550877218196, 0.000000000000000,
        0.000000000000000,  0.478296088850594,  0.124766652495813,  0.000000000000000,  0.000000000000000,  0.000040707242522,  0.083545530285932,
        0.096653517288908,  -0.069762505805406, -0.000000000000000, -0.000000000000000, -0.160788802645282, -0.091926646132813, 0.000000000000000,
        0.000000000000000,  -0.380162164556850, -0.108493403580870, 0.000000000000000,  0.000000000000000,  -0.215797136641078, -0.232950809291511,
        0.000000000000000,  0.000000000000000,  0.204840608655064,  0.046499634408158,  0.000000000000000,  0.000000000000000,  -0.344633473563571,
        -0.472416652786877, -0.000000000000000, -0.000000000000000, -0.316206588144175, -0.439475602109394, 0.000000000000000,  0.000000000000000,
        -0.142141833332747, -0.160763244215592, 0.000000000000000,  0.000000000000000,  -0.575052426518546, -0.696825717961417, 0.000000000000000,
        0.000000000000000,  -0.002771117126671, -0.031569174504636, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        -0.417322237305672, -0.124321105475823, 0.000000000000000,  0.000000000000000,  0.633844728607037,  0.050145274860961,  0.000000000000000,
        0.000000000000000,  -0.348999595317262, -0.033565689788854, 0.000000000000000,  0.000000000000000,  0.418456910820791,  0.071761330649207,
        0.000000000000000,  0.000000000000000,  -0.983374923944985, -0.231405122606994, 0.000000000000000,  0.000000000000000,  -0.429603400878128,
        -0.175669974076513, 0.000000000000000,  0.000000000000000,  0.374580423512758,  0.042224942624950,  0.000000000000000,  0.000000000000000,
        -0.277299652508352, -0.010551387125766, 0.000000000000000,  0.000000000000000,  0.278291318312967,  0.107993247680950,  0.000000000000000,
        0.000000000000000,  -0.853485608407360, -0.327651097266197, 0.704435547383442,  0.536712015306779,  -0.000000000000000, 0.000000000000000,
        -0.382731723511611, -0.002696577963878, -0.000000000000000, 0.000000000000000,  0.324290342610150,  0.008182588447774,  0.000000000000000,
        0.000000000000000,  -0.736930737592206, -0.602140123462814, 0.000000000000000,  0.000000000000000,  1.428049721823365,  0.810991169065209,
        -0.000000000000000, -0.000000000000000, 0.951478245408478,  1.009741539735937,  0.000000000000000,  0.000000000000000,  0.224602009150747,
        0.316408109222614,  0.000000000000000,  0.000000000000000,  -0.417862206004350, -0.662621448146147, 0.000000000000000,  0.000000000000000,
        -1.330270261404257, -1.569534029641511, 0.000000000000000,  0.000000000000001,  1.194949956435567,  1.178729959919240,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  -1.459902242179633, -0.346442327599999, 0.000000000000000,  0.000000000000000,
        0.195919301919591,  0.074173708898834,  0.000000000000000,  0.000000000000000,  0.539984412013514,  -0.002641789614780, 0.000000000000000,
        0.000000000000000,  -0.325091906469180, 0.079574405795229,  -0.000000000000000, -0.000000000000000, 0.009848339115083,  0.027930994000689,
        0.000000000000000,  0.000000000000000,  -1.244057851127956, -0.502058275982484, 0.000000000000000,  0.000000000000000,  0.204075864659280,
        0.118825517509865,  0.000000000000000,  0.000000000000000,  0.294963980694148,  -0.062954017361454, 0.000000000000000,  0.000000000000000,
        -0.035474195136270, 0.169257698885127,  -0.000000000000000, -0.000000000000000, 0.060820783833427,  0.044475914192720,  1.959596538481511,
        1.048341518478162,  -0.000000000000000, 0.000000000000000,  -0.517651097841926, -0.369739361956797, 0.000000000000000,  0.000000000000000,
        -0.309559740390085, 0.228027221782926,  0.000000000000000,  0.000000000000000,  0.179068523521450,  -0.302841979528580, 0.000000000000000,
        0.000000000000000,  -0.262489499978718, -0.307206751612762, -0.000000000000000, 0.000000000000000,  1.442804993707949,  1.371242684204022,
        0.000000000000000,  0.000000000000000,  -0.658308831751952, -0.705737420440340, 0.000000000000000,  0.000000000000000,  1.061494571515155,
        1.436308520432952,  0.000000000000000,  0.000000000000000,  -1.096601183508277, -1.416541946914065, 0.000000000000000,  0.000000000000000,
        -0.710041273326284, -0.833731706673113, -0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.190700949108379,
        0.033558994060987,  0.000000000000000,  0.000000000000000,  0.184169966723791,  0.107422976107957,  0.000000000000000,  0.000000000000000,
        -0.522378917511831, -0.013098207920496, 0.000000000000000,  0.000000000000000,  -0.326257616563680, -0.205073157309042, 0.000000000000000,
        0.000000000000000,  1.218616999507515,  0.371829820370859,  0.000000000000000,  0.000000000000000,  -0.065769629129978, 0.085233670472820,
        0.000000000000000,  0.000000000000000,  0.305992323866444,  0.158734896220591,  0.000000000000000,  0.000000000000000,  -0.245135574350462,
        0.008539288635325,  0.000000000000000,  -0.000000000000000, -0.422083520334737, -0.360924495788580, 0.000000000000000,  0.000000000000000,
        1.148841433355010,  0.573655088841867,  0.179656413935957,  0.108538126590162,  0.000000000000000,  0.000000000000000,  -0.327648239180049,
        -0.297869126087008, -0.000000000000000, 0.000000000000000,  0.491003228008975,  0.250041718748526,  -0.000000000000000, -0.000000000000000,
        0.423435611385943,  0.431060214832068,  0.000000000000000,  -0.000000000000000, -1.492944210090222, -0.957610859944999, 0.000000000000000,
        0.000000000000000,  0.214907023790586,  0.248908929397986,  0.000000000000000,  0.000000000000000,  -0.457295773019949, -0.429335203125279,
        0.000000000000000,  0.000000000000000,  0.483066016337928,  0.566792180915148,  -0.000000000000000, 0.000000000000000,  1.065875553466037,
        1.297469908983231,  0.000000000000000,  0.000000000000000,  -1.618519981276494, -1.709502757957802, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.430263167974593, -0.177372461876746, 0.000000000000000,  0.000000000000000,  -0.546542365572349,
        -0.119702433277141, 0.000000000000000,  0.000000000000000,  0.146251301308133,  0.035616853781527,  0.000000000000000,  0.000000000000000,
        1.174456852438329,  0.205190803325416,  0.000000000000000,  -0.000000000000000, 0.013361496431543,  -0.203356805916278, 0.000000000000000,
        0.000000000000000,  -0.499326067130893, -0.276655517168077, 0.000000000000000,  0.000000000000000,  -0.481330521001241, -0.158103847659459,
        0.000000000000000,  0.000000000000000,  0.140378273356023,  0.046704395298347,  0.000000000000000,  0.000000000000000,  0.889217974453614,
        0.271392748805826,  0.000000000000000,  -0.000000000000000, -0.249127782166980, -0.387784692087480, 0.314693095251941,  0.282093705240585,
        -0.000000000000000, 0.000000000000000,  0.401189323343188,  0.078290619972616,  0.000000000000001,  0.000000000000000,  -0.082091778744253,
        -0.043773759461388, 0.000000000000000,  -0.000000000000000, -0.972155493692215, -0.327329600477134, -0.000000000000000, -0.000000000000000,
        -0.115468424711051, 0.174278489284148,  0.000000000000000,  0.000000000000000,  0.549258885852235,  0.604137910701124,  0.000000000000000,
        0.000000000000000,  -0.209452678559083, -0.390883796264238, 0.000000000000000,  0.000000000000000,  -0.071642531737119, -0.076955262640756,
        0.000000000000000,  -0.000000000000000, -0.141168295491608, 0.032353311809293,  -0.000000000000000, 0.000000000000000,  0.683186113982771,
        0.901684202882914,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.364513296907306,  0.257062303124753,
        0.000000000000000,  0.000000000000000,  -0.528267725052515, -0.207643436140016, 0.000000000000000,  0.000000000000000,  0.635839714112691,
        0.153770563983889,  0.000000000000000,  0.000000000000000,  0.010735089579303,  -0.043855117116519, 0.000000000000000,  0.000000000000000,
        -0.460279169390815, -0.241829888939600, 0.000000000000000,  0.000000000000000,  0.514218024299074,  0.453705400058555,  0.000000000000000,
        0.000000000000000,  -0.580532732899472, -0.327915060115430, 0.000000000000000,  0.000000000000000,  0.548561269699406,  0.222960555925847,
        0.000000000000000,  0.000000000000000,  -0.067430393207884, -0.077650159201019, 0.000000000000000,  0.000000000000000,  -0.563756990605427,
        -0.408567531709303, -0.478500446834472, -0.433047240685504, 0.000000000000001,  0.000000000000000,  0.490108775324251,  0.290576919871134,
        -0.000000000000000, 0.000000000000000,  -0.568021921305511, -0.271267994122254, 0.000000000000000,  0.000000000000000,  0.044075559957700,
        0.056213226887147,  0.000000000000000,  0.000000000000000,  0.424270774290385,  0.357662927703236,  -0.000000000000000, -0.000000000000000,
        -0.945214864023396, -1.100034077198242, 0.000000000000000,  0.000000000000000,  0.390925232055705,  0.355232772344858,  0.000000000000000,
        0.000000000000000,  -0.338164411536735, -0.306008595220642, -0.000000000000000, 0.000000000000000,  0.093437828983611,  0.089862825668869,
        -0.000000000000000, -0.000000000000000, 0.734532232117380,  0.835404513613297,  -0.000000000000000, 0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 36, 20));

    std::vector<double> intzvals{
        0.000000000000000,  0.000000000000000,  0.224047019838728,  0.126897896324720,  0.000000000000000,  0.000000000000000,  0.107522197307164,
        0.015520993608347,  0.000000000000000,  0.000000000000000,  0.266109806260581,  0.057205742661088,  0.000000000000000,  0.000000000000000,
        -0.450886916693005, -0.125874089294630, 0.000000000000000,  0.000000000000000,  0.024474507352014,  0.072049570020694,  0.000000000000000,
        0.000000000000000,  0.284253111510275,  0.216950838245792,  0.000000000000000,  0.000000000000000,  0.072581222260107,  0.020329751641981,
        0.000000000000000,  0.000000000000000,  0.215681809807122,  0.081492703911080,  0.000000000000000,  0.000000000000000,  -0.420746350065253,
        -0.186154081381335, 0.000000000000000,  0.000000000000000,  0.104148532007536,  0.134366511825171,  -0.654235729218497, -0.555660681666655,
        0.000000000000001,  0.000000000000000,  -0.065399266756818, -0.013101397822130, 0.000000000000000,  0.000000000000000,  -0.355397723376088,
        -0.169667331836381, -0.000000000000000, -0.000000000000000, 0.708879037409409,  0.398582243754182,  0.000000000000000,  0.000000000000000,
        -0.201308736431326, -0.222476269243224, 0.000000000000001,  0.000000000000000,  -1.145504692871084, -1.304311786932622, 0.000000000000000,
        0.000000000000000,  0.000894249260722,  0.007808083406147,  0.000000000000000,  0.000000000000000,  -0.212047673356175, -0.192196556322091,
        0.000000000000000,  0.000000000000000,  0.555742946923267,  0.527099662695628,  0.000000000000000,  0.000000000000000,  -0.514972815517777,
        -0.607050596138722, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.159653317993483,  0.029560465698792,
        0.000000000000000,  0.000000000000000,  -0.150859014090185, -0.033710523106975, 0.000000000000000,  0.000000000000000,  0.708870940022493,
        0.127170772572716,  -0.000000000000000, -0.000000000000000, 0.012829581658640,  -0.018058167974774, 0.000000000000000,  0.000000000000000,
        -0.181273024643947, -0.027559445742771, 0.000000000000000,  0.000000000000000,  0.104957879318611,  0.046849659423220,  0.000000000000000,
        0.000000000000000,  -0.173680499806585, -0.029852878332340, 0.000000000000000,  0.000000000000000,  0.528810657511449,  0.174648245799226,
        -0.000000000000000, 0.000000000000000,  -0.064525212628697, -0.017253544773965, 0.000000000000000,  0.000000000000000,  -0.141855602486711,
        -0.030385890122863, -0.723413825972723, -0.611000855979898, 0.000000000000000,  0.000000000000000,  0.533774757019808,  0.278948921125095,
        0.000000000000000,  0.000000000000000,  -0.908346343128069, -0.390695711983956, 0.000000000000000,  0.000000000000000,  0.125139545278487,
        0.105868511563229,  0.000000000000000,  0.000000000000000,  0.537451017299354,  0.440602358573380,  0.000000000000000,  0.000000000000000,
        -1.305168540970296, -1.512400617893575, 0.000000000000000,  0.000000000000000,  0.240452561022199,  0.123373849473737,  0.000000000000000,
        0.000000000000000,  -0.444559320737884, -0.384785167998420, 0.000000000000000,  0.000000000000000,  0.105423670873048,  0.056993613649634,
        -0.000000000000000, -0.000000000000000, 0.889004341287253,  1.004860173939653,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.262221196416634,  -0.005775030361714, 0.000000000000000,  0.000000000000000,  -0.035279429126011, 0.069223237280500,
        0.000000000000000,  0.000000000000000,  0.078327923863611,  0.037174685992526,  0.000000000000000,  0.000000000000000,  0.368656429513499,
        -0.071893105902414, 0.000000000000000,  -0.000000000000000, 0.311759631972593,  0.145970188619142,  0.000000000000000,  0.000000000000000,
        0.106414272931839,  -0.026930841728748, 0.000000000000000,  0.000000000000000,  0.053363558166748,  0.141644496238579,  0.000000000000000,
        0.000000000000000,  0.066617059870594,  0.071880743623243,  0.000000000000000,  0.000000000000000,  0.037138265261272,  -0.146826389257385,
        0.000000000000000,  -0.000000000000000, 0.326571634161339,  0.255052828925763,  -0.237371857298468, -0.051339958335197, -0.000000000000000,
        -0.000000000000000, 0.127999502982320,  -0.100949183362271, 0.000000000000000,  0.000000000000000,  -0.118669306908858, -0.055955685477749,
        0.000000000000000,  -0.000000000000000, -0.439692079102144, 0.032223630641231,  0.000000000000000,  0.000000000000000,  -0.338205514653080,
        -0.075277410744268, 0.000000000000000,  0.000000000000000,  0.007921341582753,  0.040396262593122,  -0.000000000000000, 0.000000000000000,
        -0.523533471262415, -0.729880608260067, 0.000000000000000,  0.000000000000000,  -0.122791444438041, -0.154735364186852, -0.000000000000000,
        0.000000000000000,  0.414686145982567,  0.580392143640569,  0.000000000000000,  0.000000000000000,  0.071212653587901,  0.163247912034107,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.604024315308206, -0.291187762949399, 0.000000000000000,
        0.000000000000000,  -0.063057783612097, 0.086499731508672,  0.000000000000000,  0.000000000000000,  -0.047711798111066, -0.094679866069285,
        0.000000000000000,  0.000000000000000,  0.105971944302700,  0.024767692778868,  0.000000000000000,  0.000000000000000,  0.460580665692821,
        0.004474444797515,  0.000000000000000,  0.000000000000000,  -0.712463126525880, -0.484003637307982, 0.000000000000000,  0.000000000000000,
        0.121496954817336,  0.154183484771318,  0.000000000000000,  0.000000000000000,  -0.129447489097316, -0.180181898774577, 0.000000000000000,
        0.000000000000000,  0.060800528895350,  0.047216236429659,  0.000000000000000,  0.000000000000000,  0.238059666466275,  -0.032560965747546,
        0.141382600564655,  0.097323281821921,  0.000000000000000,  0.000000000000000,  0.072716034922768,  -0.064856105755175, 0.000000000000000,
        -0.000000000000000, 0.004412635542924,  0.081865613788401,  0.000000000000000,  0.000000000000000,  0.110457564005448,  0.153003277888689,
        0.000000000000000,  0.000000000000000,  -0.538893896089963, -0.242022342686018, 0.000000000000000,  0.000000000000000,  0.179760507442849,
        0.197260896611506,  0.000000000000000,  0.000000000000000,  -0.195056863058281, -0.231275227156976, -0.000000000000000, 0.000000000000000,
        0.301541243486446,  0.399853596357838,  0.000000000000000,  0.000000000000000,  0.372546692957598,  0.442670101540056,  0.000000000000000,
        0.000000000000000,  -0.281186830347169, -0.243646828217076, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,
        0.624801933454383,  0.214447820318468,  0.000000000000000,  0.000000000000000,  0.104724160097212,  0.165150945675780,  0.000000000000000,
        0.000000000000000,  -0.021596255489112, -0.031029078979484, 0.000000000000000,  0.000000000000000,  -0.269232990897232, -0.267889900608991,
        0.000000000000000,  0.000000000000000,  1.479879765672622,  0.437440811944745,  0.000000000000000,  0.000000000000000,  0.643356410745989,
        0.330160272524102,  0.000000000000000,  0.000000000000000,  0.275096839977818,  0.299030996753405,  0.000000000000000,  0.000000000000000,
        -0.055926266515969, -0.054950694088302, 0.000000000000000,  0.000000000000000,  -0.460556602570673, -0.490074645436861, 0.000000000000000,
        0.000000000000000,  1.401339648242379,  0.660882555354593,  -0.354524200454582, -0.229477824973462, 0.000000000000000,  -0.000000000000000,
        -0.033392778513093, -0.093434388483203, 0.000000000000000,  0.000000000000000,  0.014813938259273,  0.029126248544721,  -0.000000000000000,
        -0.000000000000000, 0.152647443080939,  0.164021987885814,  0.000000000000000,  0.000000000000000,  -0.847323289075486, -0.476122769148488,
        0.000000000000000,  0.000000000000000,  -0.357255254666303, -0.357047254552370, 0.000000000000000,  0.000000000000000,  -0.244500475924154,
        -0.293425050393803, 0.000000000000000,  0.000000000000000,  0.070234762493727,  0.082426041132453,  -0.000000000000000, 0.000000000000000,
        0.411448359907755,  0.502429801050834,  0.000000000000000,  0.000000000000000,  -0.681519299044553, -0.659660262870810, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.000000000000000,  1.432697333445856,  0.412003226641555,  -0.000000000000000, 0.000000000000000,
        -0.147113932954502, -0.164891388584115, 0.000000000000000,  0.000000000000000,  -0.164224012220587, 0.123231678438783,  0.000000000000000,
        0.000000000000000,  0.005737244696958,  -0.162439650172532, 0.000000000000000,  0.000000000000000,  -0.366680427453923, -0.253313155401025,
        0.000000000000000,  0.000000000000000,  1.317651625220232,  0.627391355446929,  -0.000000000000000, -0.000000000000000, -0.294130497071082,
        -0.295113401026704, 0.000000000000000,  0.000000000000000,  0.020900921393294,  0.268620978738200,  0.000000000000000,  0.000000000000000,
        -0.256874581199123, -0.288074166276115, 0.000000000000000,  0.000000000000000,  -0.547133583650966, -0.432719643100213, -0.896470196334181,
        -0.448768977410885, 0.000000000000000,  0.000000000000000,  -0.095046671700615, -0.030594809114399, -0.000000000000000, 0.000000000000000,
        0.197496364171085,  -0.036425128358566, 0.000000000000000,  0.000000000000000,  -0.031805540406086, 0.135435025514400,  -0.000000000000000,
        -0.000000000000000, -0.028158656961112, 0.032794975853304,  0.000000000000000,  0.000000000000000,  -0.585141507511306, -0.542430586376302,
        0.000000000000000,  0.000000000000000,  -0.055679646486336, -0.070824354644489, -0.000000000000000, -0.000000000000000, -0.401409945488103,
        -0.597302590401259, 0.000000000000000,  0.000000000000000,  0.366999778869881,  0.432111249414172,  -0.000000000000000, 0.000000000000000,
        0.112321294566971,  0.141106938552056,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.376256689079680,
        -0.036816532895639, 0.000000000000000,  0.000000000000000,  0.237031538551957,  -0.012689342959864, 0.000000000000000,  0.000000000000000,
        0.303120268187417,  0.087066936049218,  0.000000000000000,  0.000000000000000,  0.042293157363162,  0.065786085952358,  0.000000000000000,
        0.000000000000000,  -0.586321072104964, -0.147017662966366, 0.000000000000000,  0.000000000000000,  0.157556477507707,  -0.108831941356071,
        0.000000000000000,  0.000000000000000,  0.053450678151588,  -0.026694758075500, 0.000000000000000,  0.000000000000000,  0.223247741606875,
        0.153015260289736,  0.000000000000000,  0.000000000000000,  0.070659667673784,  0.133619979052447,  0.000000000000000,  0.000000000000000,
        -0.507295620874584, -0.217361784076949, -0.263398814890166, -0.167313154644788, -0.000000000000000, 0.000000000000000,  -0.203460389429116,
        -0.075125617843503, 0.000000000000000,  0.000000000000000,  -0.386897646830217, -0.165426166906210, 0.000000000000000,  0.000000000000000,
        0.040652292383834,  -0.109988703055001, 0.000000000000000,  0.000000000000000,  0.502600305373777,  0.256453179447669,  -0.000000000000000,
        -0.000000000000000, -0.332082030037828, -0.382579243388645, 0.000000000000000,  -0.000000000000000, -0.207248561125733, -0.285127459855948,
        0.000000000000000,  0.000000000000000,  -0.293918114931364, -0.342117087439375, 0.000000000000000,  0.000000000000000,  -0.511678394081865,
        -0.710999339762007, 0.000000000000000,  0.000000000000000,  0.345053008630518,  0.326042676115423,  -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.037960369455757,  0.007130564222774,  -0.000000000000000, -0.000000000000000, 0.394090406138142,
        0.039552753383153,  0.000000000000000,  0.000000000000000,  0.074295356783912,  0.007871368457891,  0.000000000000000,  0.000000000000000,
        -0.667427475849140, -0.062500075773238, 0.000000000000000,  0.000000000000000,  -0.274258854432317, -0.028563843310193, 0.000000000000000,
        0.000000000000000,  0.043796981242943,  0.004129891342982,  -0.000000000000000, 0.000000000000000,  0.268675435016025,  0.032192980383739,
        0.000000000000000,  0.000000000000000,  0.042711090384748,  0.009760500865127,  0.000000000000000,  0.000000000000000,  -0.441405427048442,
        -0.050021084822439, 0.000000000000000,  0.000000000000000,  -0.181229733779870, -0.027267419098424, -0.405457883872330, -0.389146330670515,
        0.000000000000000,  0.000000000000000,  -0.578425898209542, -0.231203274335991, -0.000000000000000, 0.000000000000000,  -0.123209960708442,
        -0.045716152452490, 0.000000000000000,  0.000000000000000,  1.084910829680046,  0.435903185059510,  0.000000000000000,  0.000000000000000,
        -0.310411837565058, -0.456199603753600, 0.000000000000000,  0.000000000000000,  -0.837460231590603, -0.963587756850334, 0.000000000000000,
        0.000000000000000,  -0.175210732988902, -0.085040349526653, 0.000000000000000,  -0.000000000000000, -0.046869662956789, -0.038669342465001,
        0.000000000000000,  0.000000000000000,  0.329200255813725,  0.159311116313785,  0.000000000000000,  0.000000000000000,  -1.153426530202688,
        -1.391984130480449, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  -0.144148149650722, -0.088248226117359,
        0.000000000000000,  0.000000000000000,  0.354737415622452,  0.112126441041301,  0.000000000000000,  0.000000000000000,  -0.343166133950048,
        -0.078589839694404, 0.000000000000000,  0.000000000000000,  -0.173913599648027, -0.022164688101835, 0.000000000000000,  0.000000000000000,
        0.192276400629413,  0.122877628019769,  0.000000000000000,  0.000000000000000,  -0.183561594867171, -0.155050293436831, 0.000000000000000,
        0.000000000000000,  0.354838184292836,  0.168478495813055,  0.000000000000000,  0.000000000000000,  -0.288102869787120, -0.112921647964096,
        0.000000000000000,  0.000000000000000,  -0.113000693531093, -0.027722749462474, 0.000000000000000,  0.000000000000000,  0.263975087669525,
        0.211863829887087,  0.320280954475902,  0.267344845180717,  -0.000000000000000, -0.000000000000000, -0.610986216432858, -0.360484118612406,
        0.000000000000000,  0.000000000000000,  0.421811325840355,  0.206856780108515,  -0.000000000000000, -0.000000000000000, 0.248949289171445,
        0.104743155646906,  0.000000000000000,  0.000000000000000,  -0.620595935768478, -0.543428607647333, 0.000000000000001,  0.000000000000000,
        0.559108216370182,  0.642125990808413,  0.000000000000000,  0.000000000000000,  -0.517614055732284, -0.496580342872113, 0.000000000000000,
        0.000000000000000,  0.262900337942114,  0.239927850556704,  0.000000000000000,  0.000000000000000,  0.116421364815153,  0.099489679802534,
        0.000000000000000,  0.000000000000000,  -1.133724367605136, -1.295033524996618, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 36, 20));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeGFForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 3);

    CDenseMatrix amomxmat(36, 28);

    CDenseMatrix amomymat(36, 28);

    CDenseMatrix amomzmat(36, 28);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  0.000000000000000,  -0.427581091850427, -0.249530864828454, 0.000000000000000,  0.000000000000000,  0.768210476881554,
        0.498586548022582,  0.000000000000000,  0.000000000000000,  -0.457939474295790, -0.293899549822552, 0.000000000000000,  0.000000000000000,
        0.956725555892734,  0.253104823379803,  0.000000000000000,  -0.000000000000000, -0.295841303503616, -0.154030972025386, 0.000000000000000,
        0.000000000000000,  0.004198013951142,  -0.148552965211467, 6.083189767273682,  3.918398161006523,  -0.317958884651808, 0.069415120606968,
        0.000000000000000,  0.000000000000000,  -0.447692674347247, -0.376831726754378, 0.000000000000000,  0.000000000000000,  0.808275099786256,
        0.791433004262143,  0.000000000000000,  0.000000000000000,  -0.519095779326279, -0.443981854823017, 0.000000000000000,  0.000000000000000,
        0.667294695936757,  0.333790168110102,  0.000000000000000,  0.000000000000000,  -0.297712389815463, -0.226372682811327, 0.000000000000000,
        0.000000000000000,  -0.130490332397998, -0.267230456501753, 4.954876767020846,  4.647580015448904,  -0.153069411151828, 0.211240236718112,
        -0.228319586552494, -0.188535506531347, -0.000000000000000, 0.000000000000000,  0.756803821486200,  0.574493682055552,  0.000000000000000,
        0.000000000000000,  -0.428765565449858, -0.303170466466446, 0.000000000000000,  0.000000000000000,  0.803596505847979,  0.374490915796285,
        0.000000000000000,  0.000000000000000,  -0.190992256421624, -0.147918862427064, -0.000000000000000, 0.000000000000000,  -0.200878492225292,
        -0.202049203039540, -0.000000000000000, -0.000000000000000, -0.305508318442030, -0.048948480917276, 4.206595008428469,  1.108586193774783,
        -0.220261166711307, -0.268903521126028, 0.000000000000000,  0.000000000000000,  0.611515554497423,  0.705686137273309,  0.000000000000000,
        -0.000000000000000, -0.297844323708829, -0.337992725347094, 0.000000000000000,  0.000000000000000,  0.256173755588333,  0.244129628992175,
        0.000000000000000,  0.000000000000000,  -0.147869480013467, -0.167755413900685, -0.000000000000000, -0.000000000000000, -0.233107802882403,
        -0.270019864229627, -0.000000000000000, 0.000000000000000,  0.282526541001793,  0.565601855709723,  1.886470424952785,  2.403331021727971,
        -2.867643157122556, -1.847150607357738, -0.876900981132596, -0.700017195124739, 0.000000000000000,  0.000000000000000,  1.008011128089072,
        0.297126026307848,  -0.000000000000000, 0.000000000000000,  -0.293088091604625, 0.001790747219815,  0.000000000000000,  0.000000000000001,
        0.623917712350277,  0.043488710146797,  0.000000000000000,  0.000000000000000,  -0.108673154827436, -0.112106433823336, 5.268196874500553,
        3.393432349573873,  0.849738564732331,  0.234644372941730,  0.000000000000000,  0.000000000000000,  0.071104104155335,  0.026243416254703,
        -2.335751307936078, -2.190890230020666, -1.110742732019981, -1.097314430016879, 0.000000000000000,  0.000000000000000,  0.718193261181762,
        0.409931344805084,  -0.000000000000000, -0.000000000000001, -0.172626634853657, 0.063606365103069,  -0.000000000000000, 0.000000000000000,
        0.292826375735670,  0.018532855322931,  0.000000000000000,  0.000000000000000,  -0.166845494640980, -0.184552572963133, 4.291049152861360,
        4.024922359499622,  0.551800453894271,  0.343103571542082,  0.000000000000000,  0.000000000000000,  0.080860369645576,  0.022100611390096,
        -0.921338465671278, -1.013349140421022, -2.191745578227026, -0.577602284845846, 0.972038086267567,  0.601774649940159,  -0.000000000000000,
        0.000000000000000,  0.061061577259479,  0.148089245585999,  -0.000000000000000, 0.000000000000000,  0.509825869646370,  0.174267331328119,
        0.000000000000000,  0.000000000000000,  -0.397396939896334, -0.372577261138638, -0.000000000000000, -0.000000000000000, 0.834033960673193,
        0.506574167724168,  3.643018140731867,  0.960063806093660,  -0.127480768661869, -0.080634589811058, -0.000000000000000, -0.000000000000000,
        -1.494987182960661, -2.007170831845390, -0.982900232625671, -1.252198067399883, 0.611073399033592,  0.717539984439086,  0.000000000000000,
        0.000000000000000,  0.211050493454942,  0.253304307119617,  -0.000000000000000, -0.000000000000000, 0.056067307429925,  0.014028220878758,
        0.000000000000000,  -0.000000000000000, -0.383784333999369, -0.424718631569188, -0.000000000000000, 0.000000000000000,  0.738429786766509,
        1.067789553219675,  1.633731311497136,  2.081345718519632,  -0.053660857848107, -0.038064381857957, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.875038533006016,  0.326141605272070,  -3.754626238181789, -2.418487850914425, 0.499222688168928,
        0.118375693904624,  0.000000000000000,  0.000000000000000,  -0.235633073269276, 0.049047290759894,  0.000000000000000,  0.000000000000000,
        1.015710608573748,  0.219547322026885,  4.452439003231618,  2.867973788375747,  -0.804813121356493, -0.198143878693570, 0.000000000000000,
        0.000000000000000,  0.413070408169219,  0.122199607808490,  1.149614807301360,  0.740507647982577,  -0.362646767020563, -0.174483307932541,
        0.000000000000000,  0.000000000000000,  0.697953797126791,  0.469755335224091,  -3.058216335202624, -2.868548662402545, 0.368537879908576,
        0.131660640349618,  0.000000000000000,  0.000000000000000,  -0.042899978256160, 0.105211206544858,  0.000000000000000,  0.000000000000000,
        0.615175972194929,  0.278743760989260,  3.626598448789976,  3.401680257083047,  -0.585256476578177, -0.242199726025773, 0.000000000000000,
        0.000000000000000,  0.264163300569170,  0.175553227521781,  0.936383693036349,  0.878310065653681,  -0.313734431412612, -0.280147820425836,
        1.213819129202962,  0.772459715547809,  -0.000000000000000, 0.000000000000000,  0.599615481385219,  0.290588167105567,  -2.869668576088602,
        -0.756258911967294, -0.340905648896204, -0.138421941385652, 0.000000000000000,  0.000000000000000,  0.940843363071390,  0.303339874618791,
        -0.000000000000000, -0.000000000000000, -1.003456353202218, -0.485738584163595, 3.078912281692709,  0.811402010530911,  0.072457943613209,
        -0.163988206375977, -0.000000000000000, -0.000000000000000, -0.461422065059324, -0.235988851869883, 0.794971732761956,  0.209503098257696,
        0.773253414820861,  0.897941822990099,  0.000000000000000,  0.000000000000000,  0.013677420473142,  -0.189297889612907, -1.286918490456240,
        -1.639512122553538, -0.071305475835872, -0.051013145624271, 0.000000000000000,  0.000000000000000,  0.154943244583567,  0.144841902580841,
        -0.000000000000000, 0.000000000000000,  -0.032128710572886, 0.290657352088875,  1.380754968995004,  1.759058189567850,  -0.264080780802782,
        -0.331290644629582, -0.000000000000000, 0.000000000000000,  -0.036594170910714, 0.104796541771283,  0.356509400007386,  0.454186871547069,
        0.000000000000000,  -0.000000000000000, -0.527383168698778, -0.200946477357148, 0.000000000000000,  0.000000000000000,  -0.486133765528424,
        -0.040481411611883, -4.197799749339398, -2.703951618701017, 0.862432497790507,  0.322509306111457,  5.141233714132327,  3.311650877495056,
        0.260620823986597,  -0.055693282955298, 0.000000000000000,  0.000000000000000,  0.454641338960972,  -0.035385322864308, 1.991191255379460,
        1.282596869699154,  1.459285516292384,  0.284643932009462,  0.000000000000000,  0.000000000000000,  0.818738187655416,  0.137874892381521,
        0.000000000000000,  -0.000000000000000, -0.455554824610002, -0.274986064882637, 0.000000000000000,  0.000000000000000,  -0.240852450147275,
        -0.022422574723451, -3.419189807706676, -3.207134902949095, 0.642023162870970,  0.486265314599790,  4.187635181303145,  3.927922024247866,
        -0.009336571187543, -0.111000104018587, 0.000000000000000,  0.000000000000000,  0.069878614458330,  -0.066689905129189, 1.621864131717935,
        1.521277658511331,  0.939359006660328,  0.310361266526520,  0.000000000000000,  0.000000000000000,  0.458014497031803,  0.167017970080106,
        -0.804619298104607, -0.664544049402892, 0.000000000000000,  0.000000000000000,  -0.365410259859739, 0.069679997087720,  -0.000000000000000,
        0.000000000000000,  1.176325490642374,  0.697966341193619,  -3.208387004514571, -0.845523167874450, -0.346697495497755, -0.393243966940055,
        3.555221669293060,  0.936926338402050,  0.461262180869680,  -0.048395252314431, 0.000000000000000,  0.000000000000000,  1.213161468505744,
        0.539099040902499,  1.376931431724776,  0.362870010525424,  1.050484893224120,  0.405329226848968,  0.000000000000000,  0.000000000000000,
        -0.794484552378952, -0.984291066178482, 0.000000000000000,  0.000000000000000,  0.353504284955382,  0.542641046259350,  0.000000000000000,
        0.000000000000000,  0.491335980829570,  0.386459102284956,  -1.438818613080784, -1.833030277982338, -0.036141412054757, 0.300809145449909,
        1.594358506068358,  2.031185438534427,  -0.268305483671651, -0.399752651637743, 0.000000000000000,  0.000000000000000,  0.533230724437491,
        0.698954479219822,  0.617492394188689,  0.786674737650285,  0.168601092583140,  0.084614047780927,  0.000000000000000,  0.000000000000000,
        0.000000000000001,  -0.000000000000000, 0.667183139329883,  0.152175394562698,  0.000000000000000,  0.000000000000000,  1.335995462737395,
        0.352643501293796,  -3.982382510758920, -2.565193739398305, 0.055223212338185,  -0.175693930733213, -4.335468938641377, -2.792629223514567,
        -0.571403624651300, 0.373921141470231,  0.000000000000000,  0.000000000000000,  0.072433175001617,  -0.152165627516945, 0.000000000000000,
        -0.000000000000000, -0.425324202838805, -0.268238434130212, 0.000000000000000,  0.000000000000000,  0.822958168018033,  0.189546211903498,
        0.000000000000000,  -0.000000000000000, 0.440797229728023,  0.191338440912377,  0.000000000000000,  0.000000000000000,  0.923048333552676,
        0.462173574944832,  -3.243728263435870, -3.042555317022662, -0.323501542977737, -0.214514084017596, -3.531324048738692, -3.312314684843302,
        0.165876273937084,  0.673842157672449,  0.000000000000000,  0.000000000000000,  -0.174087965238720, -0.245980193568474, 0.000000000000000,
        -0.000000000000000, -0.478520443158273, -0.395171086167175, 0.000000000000000,  0.000000000000000,  0.552425473492489,  0.236451418261997,
        0.949154431078272,  0.537550285247009,  0.000000000000000,  -0.000000000000000, 1.133462750606254,  0.627014610347534,  -0.000000000000000,
        -0.000000000000000, 0.693981048702890,  0.155857529479308,  -2.753862863449550, -0.725740021050846, -0.365682228268305, 0.300083332866723,
        -3.313607849779529, -0.873252572802743, 0.021774401882245,  -0.045559101118909, -0.000000000000000, 0.000000000000000,  -0.358494263692351,
        -0.482250496898640, 0.000000000000000,  -0.000000000000000, 1.100957399864004,  0.722915947904895,  -0.000000000000000, 0.000000000000000,
        0.470699509576762,  0.514620579175025,  0.000000000000000,  -0.000000000000000, 0.631906420912182,  0.757564400473712,  -0.000000000000000,
        0.000000000000000,  -0.294828131240863, -0.666254274062380, -1.234984788377378, -1.573349475300570, 0.604609519719635,  0.756233442821578,
        -1.486005473780034, -1.893145530591881, -0.010075959035384, 0.018937911868406,  0.000000000000000,  0.000000000000000,  -0.771777883995593,
        -1.048684277286678, 0.000000000000000,  -0.000000000000000, 0.710949392321011,  0.814405478229019,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.403938160190473,  0.072232976716949,  -1.991191255379460, -1.282596869699153, -0.924968914283301,
        -0.266810632544202, 0.000000000000000,  0.000000000000000,  0.379940920628763,  -0.207189132904049, 0.000000000000000,  0.000000000000000,
        -0.042150979868277, 0.085119419557284,  -4.197799749339397, -2.703951618701017, 0.573176149215778,  0.586606361654120,  0.000000000000000,
        0.000000000000000,  -0.996584090751668, -0.243006387260239, -0.000000000000000, 0.000000000000000,  -0.436395004916281, -0.186009661756800,
        0.000000000000000,  0.000000000000000,  0.240003760922135,  0.082508687817348,  -1.621864131717935, -1.521277658511331, -0.752747558560357,
        -0.309496019762280, 0.000000000000000,  0.000000000000000,  -0.155316383615253, -0.338189736636351, 0.000000000000000,  0.000000000000000,
        -0.011298169430095, 0.181255859583184,  -3.419189807706676, -3.207134902949094, 0.858883582073179,  0.917817392766507,  0.000000000000000,
        0.000000000000000,  -0.704982359258293, -0.300459702782939, 0.000000000000000,  0.000000000000000,  -0.404325500912790, -0.257785910055378,
        0.505550471031139,  0.366506414940154,  -0.000000000000000, -0.000000000000000, -0.670715143197708, -0.494718302756556, -1.376931431724776,
        -0.362870010525423, 0.520265574186946,  0.114595844770576,  0.000000000000000,  0.000000000000000,  0.002718096286245,  -0.057795981302206,
        0.000000000000000,  0.000000000000000,  0.630555687937122,  0.702446730718946,  -3.208387004514572, -0.845523167874450, -0.717256076670700,
        -0.363772362671479, -0.000000000000000, 0.000000000000000,  -0.732088730866551, -0.610549916696301, 0.000000000000000,  0.000000000000000,
        0.424631792092488,  0.525135034437117,  -0.000000000000000, 0.000000000000000,  -0.681250024877330, -0.945267607232526, -0.617492394188689,
        -0.786674737650285, -0.010234465597506, -0.067234625415667, 0.000000000000000,  0.000000000000000,  -0.008399347616376, 0.030066303969372,
        0.000000000000000,  0.000000000000000,  0.893799375938264,  1.069621949268018,  -1.438818613080783, -1.833030277982338, -0.260463837217557,
        -0.252196887666362, 0.000000000000000,  0.000000000000000,  -0.741567646859219, -0.924968946740192, -0.000000000000000, -0.000000000000000,
        -1.149614807301361, -0.740507647982577, 0.814417358602465,  0.233042397071700,  0.000000000000000,  0.000000000000000,  0.021541311981835,
        -0.148351843578558, -4.452439003231616, -2.867973788375745, 1.221022426216374,  0.219419242843120,  0.000000000000000,  0.000000000000000,
        -0.490696507511308, -0.229781331566197, 0.000000000000000,  0.000000000000000,  -0.665710542193486, 0.069659182391024,  -3.754626238181789,
        -2.418487850914425, 0.285704095255403,  0.078483604191749,  0.000000000000000,  0.000000000000000,  0.369781455260128,  0.259724279051876,
        -0.936383693036348, -0.878310065653681, 0.534041407939275,  0.347032672009797,  0.000000000000000,  0.000000000000000,  -0.214344589384890,
        -0.220524443732269, -3.626598448789976, -3.401680257083047, 0.701558270073045,  0.270277428509038,  0.000000000000000,  0.000000000000000,
        -0.487671664102973, -0.309058234941930, 0.000000000000000,  0.000000000000000,  -0.226343751440534, 0.190052469025708,  -3.058216335202625,
        -2.868548662402545, 0.234440027690357,  0.085496556217126,  0.000000000000000,  0.000000000000000,  0.448500783776919,  0.393991171947954,
        0.986934291356453,  0.455003002218802,  -0.794971732761955, -0.209503098257695, 0.423829382201230,  0.179493360068820,  0.000000000000000,
        0.000000000000000,  1.412958079232733,  0.615904200827580,  -3.078912281692708, -0.811402010530911, -0.224692430571282, -0.080044879643428,
        0.000000000000001,  0.000000000000000,  -0.833269560586835, -0.212529121503911, 0.000000000000000,  0.000000000000000,  0.405623922720428,
        0.196881092370241,  -2.869668576088603, -0.756258911967295, 0.600880132681308,  0.519614160152052,  -0.000000000000000, 0.000000000000000,
        0.182152789970316,  0.035314319414831,  -0.356509400007386, -0.454186871547070, 0.145350580037302,  0.153803451911539,  0.000000000000000,
        0.000000000000000,  0.161728453054316,  -0.120823136075799, -1.380754968995004, -1.759058189567851, -0.099659097915221, -0.156579989081162,
        0.000000000000000,  0.000000000000000,  0.134035451574315,  0.323042358466058,  0.000000000000000,  0.000000000000000,  -0.055530761459677,
        -0.259743875658443, -1.286918490456240, -1.639512122553538, 0.608144802539728,  0.740499232251622,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.131750579145466, -0.032966159000523, -5.268196874500553, -3.393432349573872, -0.541678412165042,
        -0.228901889289754, 0.000000000000000,  0.000000000000000,  0.927961242158369,  0.156108016991563,  0.000000000000000,  0.000000000000000,
        0.316221964541378,  -0.095501640670735, 0.000000000000000,  -0.000000000000000, -0.395142275561015, -0.017629334471908, 0.000000000000000,
        0.000000000000000,  0.583445481051970,  0.275498309780286,  -2.867643157122556, -1.847150607357738, -1.159700969146300, -0.728786652577649,
        0.000000000000000,  0.000000000000000,  -0.109065763876599, -0.029308056929327, -4.291049152861361, -4.024922359499621, -0.459632234111641,
        -0.346532692812440, 0.000000000000000,  0.000000000000000,  0.490529296224473,  0.205087178753840,  0.000000000000000,  0.000000000000000,
        0.043441019813451,  -0.196514422857744, 0.000000000000000,  0.000000000000000,  -0.231088233054895, 0.038339906784595,  0.000000000000000,
        0.000000000000000,  0.565284234367884,  0.395625430658695,  -2.335751307936078, -2.190890230020665, -1.235982400775059, -1.127691686714314,
        0.057407373425555,  0.054751766989577,  0.000000000000000,  0.000000000000000,  -0.543000538349067, -0.453910464040873, -3.643018140731867,
        -0.960063806093660, 1.031384800702036,  0.548942378840904,  0.000000000000000,  0.000000000000000,  0.096195254956712,  -0.099661052398420,
        0.000000000000000,  0.000000000000000,  -0.062845411779524, 0.088330493715609,  0.000000000000001,  0.000000000000000,  0.571342738702949,
        0.506289700023333,  -0.000000000000000, 0.000000000000000,  -1.229129311646403, -1.123103991344099, -2.191745578227027, -0.577602284845846,
        0.038840862041395,  0.024898121011327,  0.000000000000000,  0.000000000000000,  -0.741835267282847, -1.087445627978667, -1.633731311497136,
        -2.081345718519633, 0.474778493243500,  0.510314700848534,  0.000000000000000,  0.000000000000000,  -0.232975575812067, -0.329498715107878,
        0.000000000000000,  0.000000000000000,  0.174593476067063,  0.221926772395896,  -0.000000000000000, 0.000000000000000,  0.589933681510645,
        0.715605050200325,  0.000000000000000,  0.000000000000000,  -1.556883413201283, -2.061930550743250, -0.982900232625671, -1.252198067399884,
        -6.083189767273680, -3.918398161006520, 0.238607246929165,  -0.078468731397540, 0.000000000000000,  0.000000000000000,  -0.065846336197395,
        0.140405283270395,  0.000000000000001,  -0.000000000000000, 0.761488073993797,  0.242585517869948,  0.000000000000000,  0.000000000000000,
        0.073624487968704,  0.027397695508354,  0.000000000000000,  0.000000000000000,  -0.986685643254055, -0.391105019777770, -0.000000000000001,
        0.000000000000000,  0.499136397107912,  0.464660651832146,  0.000000000000000,  0.000000000000000,  -0.461934908748767, -0.253327624397194,
        -4.954876767020846, -4.647580015448902, 0.116210465634265,  -0.221158448068793, 0.000000000000000,  0.000000000000000,  0.099692856372527,
        0.257993612319827,  0.000000000000000,  -0.000000000000001, 0.571962111421208,  0.335928851096623,  0.000000000000000,  0.000000000000000,
        0.062378378716535,  0.037932297948648,  0.000000000000000,  0.000000000000000,  -0.826007803389899, -0.563288935082594, 0.000000000000000,
        -0.000000000000000, 0.678236836302760,  0.753069786209347,  0.000000000000000,  0.000000000000000,  -0.463345036384236, -0.380973140090983,
        0.225586760819571,  0.021248776747044,  -4.206595008428467, -1.108586193774784, 0.148677354992795,  0.184162747067353,  0.000000000000000,
        0.000000000000000,  0.599189656521997,  0.311233605805356,  0.000000000000000,  -0.000000000000000, 0.096643902133467,  0.044164650406849,
        -0.000000000000000, 0.000000000000000,  -0.869568197485838, -0.480015373084515, 0.000000000000000,  0.000000000000000,  0.512378137073826,
        0.494831803059150,  0.000000000000001,  0.000000000000000,  -0.262817708600392, -0.200265156832528, -0.000000000000000, 0.000000000000000,
        -0.297528212651783, -0.578546014168489, -1.886470424952785, -2.403331021727972, 0.223838228614343,  0.262285674979514,  0.000000000000000,
        0.000000000000000,  0.252264542094630,  0.266422126319724,  0.000000000000000,  -0.000000000000000, 0.028836395026145,  0.026483498845447,
        -0.000000000000000, -0.000000000000000, -0.410337097585493, -0.443935408149279, 0.000000000000000,  0.000000000000000,  0.571672301699150,
        0.673028037857003,  -0.000000000000000, 0.000000000000000,  -0.226543203432044, -0.274299930080752, 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 36, 28));

    std::vector<double> intyvals{
        -6.083189767273682, -3.918398161006523, -0.100229590417212, -0.259246637300047, 0.000000000000000,  0.000000000000000,  0.781974287813753,
        0.457623619705753,  -0.000000000000000, -0.000000000000001, 0.443093150936185,  0.166156701114793,  0.000000000000000,  0.000000000000000,
        0.332407126623300,  0.073989749061275,  0.000000000000000,  0.000000000000000,  -1.274921248399629, -0.466494668296207, 0.000000000000000,
        0.000000000000000,  0.268599666329702,  0.394148242500284,  0.000000000000000,  0.000000000000000,  0.474469429578601,  0.292606607029291,
        -4.954876767020846, -4.647580015448904, -0.220347409434415, -0.491318378374290, 0.000000000000000,  0.000000000000000,  0.794873318614358,
        0.708116823097329,  0.000000000000000,  0.000000000000000,  0.357966036311823,  0.238123061818497,  0.000000000000000,  0.000000000000000,
        0.211224224380163,  0.094839896836185,  0.000000000000000,  0.000000000000000,  -1.030086999908588, -0.660766827682504, 0.000000000000000,
        0.000000000000000,  0.502165364579689,  0.658662062145718,  0.000000000000000,  0.000000000000000,  0.511999635583676,  0.445178692829729,
        0.049292192038857,  -0.109778175458886, -4.206595008428469, -1.108586193774783, 0.620469057161648,  0.487574602927787,  0.000000000000000,
        0.000000000000000,  0.406882288988957,  0.213820049676872,  0.000000000000000,  -0.000000000000000, 0.244107150383374,  0.109549729016185,
        0.000000000000000,  0.000000000000000,  -1.020873872505460, -0.566088347007472, 0.000000000000000,  0.000000000000000,  0.361448783919701,
        0.407731174384352,  0.000000000000000,  0.000000000000000,  0.270068695452454,  0.234816918523919,  0.000000000000000,  0.000000000000000,
        -0.440475335324174, -0.749042097858296, -1.886470424952785, -2.403331021727971, 0.524259299523202,  0.608673115448213,  0.000000000000000,
        0.000000000000000,  0.177561715232144,  0.190219953753778,  -0.000000000000000, -0.000000000000000, 0.074040086029793,  0.070669267913083,
        0.000000000000000,  0.000000000000000,  -0.480824558201798, -0.517513246231815, 0.000000000000000,  0.000000000000000,  0.499829498924910,
        0.597767661617524,  0.000000000000000,  0.000000000000000,  0.285023930829764,  0.352611117301989,  0.000000000000000,  0.000000000000000,
        1.433821578561278,  0.923575303678869,  0.624380401182663,  0.479317251391148,  -5.268196874500553, -3.393432349573872, 0.220271732541467,
        0.069781840289206,  0.000000000000000,  0.000000000000000,  -0.300806316947663, -0.068123341009000, 0.000000000000000,  0.000000000000000,
        1.025921830796644,  0.028032844551610,  0.000000000000000,  0.000000000000000,  0.055876935993909,  0.023937168145092,  0.000000000000000,
        0.000000000000000,  -0.948477805904787, -0.220364330723961, 0.000000000000000,  0.000000000000000,  0.010717386899652,  0.029556865833073,
        1.167875653968039,  1.095445115010333,  0.771355798655900,  0.745408521636534,  -4.291049152861361, -4.024922359499621, 0.169472708091187,
        0.085296488495519,  0.000000000000000,  0.000000000000000,  -0.263091233122730, -0.051888377291761, 0.000000000000000,  0.000000000000000,
        0.445478162042979,  -0.046787423284223, 0.000000000000000,  0.000000000000000,  -0.029060558932867, 0.077372779797698,  0.000000000000000,
        0.000000000000000,  -0.625995688746504, -0.280785757621589, 0.000000000000000,  0.000000000000000,  0.078664283773620,  0.022790259976237,
        0.662055013893944,  0.703197922967594,  0.939319533525869,  0.247543836362505,  0.190792516210514,  0.075468253853404,  -3.643018140731867,
        -0.960063806093660, -0.146204912663246, -0.078163673085256, 0.000000000000000,  0.000000000000000,  0.772992825006017,  0.215287769218773,
        0.000000000000000,  0.000000000000000,  0.369626251631991,  0.257908259274080,  0.000000000000000,  0.000000000000000,  -0.919271450718454,
        -0.535100760779229, 0.000000000000000,  0.000000000000000,  -0.295220851361155, -0.158200150235061, -0.000000000000000, 0.000000000000000,
        1.020383060235454,  1.359437872476989,  0.421242956839573,  0.536656314599950,  -0.151100891158738, -0.372505258989765, -1.633731311497136,
        -2.081345718519633, -0.020629620515591, -0.000173278087144, 0.000000000000000,  0.000000000000000,  -0.007467171579539, -0.105878046279764,
        0.000000000000000,  0.000000000000000,  0.280365495033702,  0.321312820571322,  0.000000000000000,  0.000000000000000,  -0.496336326119357,
        -0.559369588873246, 0.000000000000000,  0.000000000000000,  -0.101557738170988, -0.075757129158158, 0.000000000000000,  0.000000000000000,
        1.149614807301360,  0.740507647982577,  0.182205912715410,  0.085425087298831,  1.877313119090894,  1.209243925457212,  0.070172923501812,
        -0.004359161950691, -4.452439003231618, -2.867973788375746, 0.388286478253382,  0.271582112562675,  0.000000000000000,  0.000000000000000,
        -0.615932475098868, -0.236612497650516, 0.000000000000000,  0.000000000000000,  0.542981946939427,  -0.017566846997877, 0.000000000000000,
        0.000000000000000,  0.480781347713451,  0.215610505422174,  0.000000000000000,  0.000000000000000,  0.409877078673231,  0.246178656508879,
        0.936383693036349,  0.878310065653681,  0.186045588437021,  0.106240956739307,  1.529108167601312,  1.434274331201272,  -0.056831696204790,
        0.018812176439029,  -3.626598448789976, -3.401680257083047, 0.433373983925900,  0.429613591799170,  0.000000000000000,  0.000000000000000,
        -0.525156998603807, -0.317051438231237, 0.000000000000000,  0.000000000000000,  0.134898201485658,  -0.052386479246916, 0.000000000000000,
        0.000000000000000,  0.428930252065454,  0.308921112081135,  0.000000000000000,  0.000000000000000,  0.454950369491642,  0.365529714360870,
        0.344652364302478,  0.327210787356421,  0.794971732761956,  0.209503098257696,  0.019489205654187,  -0.070080138381364, 1.229857961180830,
        0.324110962271698,  0.455750876972544,  0.342215607810753,  -3.078912281692708, -0.811402010530911, -0.392342221067171, -0.122090924317617,
        0.000000000000000,  0.000000000000000,  0.668479515050639,  0.221821229943284,  -0.000000000000000, 0.000000000000000,  -0.073090051418897,
        -0.212721022964935, -0.000000000000000, 0.000000000000000,  0.649774566855172,  0.527416697866951,  -0.000000000000000, 0.000000000000000,
        0.567506955877439,  0.824145886771082,  0.356509400007386,  0.454186871547069,  0.064892848689465,  0.198032522678389,  0.551536495909817,
        0.702648052522945,  0.173202322481246,  0.020878037689868,  -1.380754968995004, -1.759058189567850, -0.105173206526396, -0.149550092763554,
        0.000000000000000,  0.000000000000000,  0.134263233542380,  0.131959741230308,  0.000000000000000,  0.000000000000000,  -0.299340262684499,
        -0.366706049308751, 0.000000000000000,  0.000000000000000,  0.590434206880394,  0.707356894214053,  0.000000000000000,  0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.108084015816553, -0.138809024288422, 1.991191255379460,  1.282596869699153,  0.297494022402911,
        0.084092379367508,  2.098899874669699,  1.351975809350508,  -0.540389355819877, -0.252114935448276, 0.000000000000000,  0.000000000000000,
        -0.034906777554395, -0.061007419841566, 0.000000000000000,  0.000000000000000,  -0.182138983795125, 0.252549659709269,  0.000000000000000,
        0.000000000000000,  -0.326614923348243, -0.128745072478393, 0.000000000000000,  0.000000000000000,  0.486444652269361,  0.180479375721177,
        0.000000000000000,  0.000000000000000,  -0.225690349092351, -0.207568409475544, 1.621864131717935,  1.521277658511331,  0.255848844172142,
        0.079822949831046,  1.709594903853338,  1.603567451474547,  -0.451158113944668, -0.382915361809834, 0.000000000000000,  0.000000000000000,
        -0.025023524617608, -0.120973849844300, 0.000000000000000,  0.000000000000000,  0.238100073377426,  0.411444751650444,  0.000000000000000,
        0.000000000000000,  -0.323131434116846, -0.165059168886419, 0.000000000000000,  0.000000000000000,  0.410620449621556,  0.246944677501427,
        -0.310859736432333, -0.361520906004224, 0.000000000000000,  0.000000000000000,  0.260755728378884,  0.242481779056520,  1.376931431724776,
        0.362870010525423,  -0.579973278205639, -0.390680958273787, 1.375023001934816,  0.362367071946193,  -0.074525457230836, 0.032791229356903,
        -0.000000000000000, 0.000000000000000,  -0.404845554021889, -0.153043536171891, -0.000000000000000, 0.000000000000000,  -0.099372786432257,
        -0.124268349631195, -0.000000000000000, 0.000000000000000,  0.762403721719867,  0.614192062117284,  -0.000000000000000, 0.000000000000000,
        -0.491444619384006, -0.629544367517189, 0.000000000000000,  -0.000000000000000, 0.480138837861152,  0.743285892543559,  0.617492394188689,
        0.786674737650285,  -0.422006124361352, -0.483417119418548, 0.616636548463193,  0.785584404849573,  0.042607878862259,  0.043763778295504,
        0.000000000000000,  0.000000000000000,  -0.020640187910517, 0.059608005508515,  0.000000000000000,  0.000000000000000,  -0.119961113920170,
        -0.127602883412106, 0.000000000000000,  0.000000000000000,  0.739589147716837,  0.921230600090746,  0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  1.276900016578868,  0.294505363688625,  0.000000000000000,  0.000000000000000,  -0.611240497768688,
        -0.280588659125477, 0.000000000000000,  0.000000000000000,  -0.092044774819531, 0.101003199430291,  2.167734469320688,  1.396314611757283,
        0.303762731754864,  -0.132091088817244, 3.982382510758921,  2.565193739398305,  -0.007936633048780, 0.014780955744658,  -0.000000000000000,
        -0.000000000000000, 0.451694400689618,  -0.065043521584414, 0.000000000000001,  -0.000000000000000, -0.176869875624727, -0.054252293794822,
        0.000000000000000,  0.000000000000000,  0.851322630100192,  0.369999688865146,  0.000000000000000,  0.000000000000000,  -0.549636403901190,
        -0.405977855070867, 0.000000000000000,  0.000000000000000,  0.106155253955753,  0.163761096769040,  1.765662024369346,  1.656157342421651,
        -0.022884226921577, -0.247762605276418, 3.243728263435871,  3.042555317022661,  0.133139764423492,  -0.045282141822423, 0.000000000000000,
        -0.000000000000000, 0.088139712025176,  -0.134740705297382, 0.000000000000000,  -0.000000000000000, -0.143120915691849, -0.069504346478420,
        1.790991258442399,  1.058439810049765,  -0.000000000000000, 0.000000000000000,  -0.503415662438283, -0.489890684553986, 0.000000000000000,
        0.000000000000000,  -0.036607693376303, -0.003558536011859, 0.000000000000000,  0.000000000000000,  0.163903638827824,  -0.135094144160539,
        1.420117649905512,  0.374251102629747,  -0.685724574797058, -0.226568538498911, 2.753862863449550,  0.725740021050846,  0.380429349606333,
        -0.127370495316590, 0.000000000000000,  0.000000000000000,  -0.225668582865062, -0.204210698169941, 0.000000000000000,  -0.000000000000000,
        0.960215557139403,  1.065458401959892,  0.000000000000000,  0.000000000000000,  -0.738810458237424, -0.997899583874661, 0.000000000000000,
        0.000000000000000,  -0.066718305784902, -0.119635329003962, 0.000000000000000,  0.000000000000000,  -0.228649930998306, -0.257411790858114,
        0.636859488762871,  0.811348084539377,  0.235235322164519,  0.614904255862347,  1.234984788377378,  1.573349475300570,  -0.454887621991015,
        -0.683757172352838, 0.000000000000000,  -0.000000000000000, -0.232648074586919, -0.278643618998501, 0.000000000000000,  -0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.061211431429308, -0.111825633046624, 0.000000000000000,  0.000000000000000,  0.902974166728754,
        0.077382123526764,  0.000000000000000,  0.000000000000000,  -0.294189611293439, -0.005156055350343, -5.141233714132327, -3.311650877495056,
        -0.347118478825275, 0.142700799063512,  2.098899874669699,  1.351975809350509,  -0.254189718484817, -0.110659055472391, 1.991191255379460,
        1.282596869699154,  0.682409683803968,  0.179548617548077,  0.000000000000000,  -0.000000000000000, -1.368643226897181, -0.360857628019607,
        0.000000000000000,  0.000000000000000,  -0.177049764880299, -0.165771808084194, 0.000000000000000,  0.000000000000000,  0.416938145108858,
        0.060107227309272,  0.000000000000000,  0.000000000000000,  -0.099692423732948, 0.004195004389702,  -4.187635181303145, -3.927922024247866,
        -0.024293032702673, 0.302234660163830,  1.709594903853338,  1.603567451474547,  -0.236935944882964, -0.161820252346614, 1.621864131717935,
        1.521277658511331,  0.510885226423994,  0.205821850995297,  0.000000000000000,  -0.000000000000000, -0.955524259884604, -0.472442652018361,
        -0.182131577026503, -0.354965334106052, 0.000000000000000,  0.000000000000000,  0.750163433177817,  0.023306940885294,  0.000000000000000,
        0.000000000000000,  -0.316340464045991, 0.091443109455619,  -0.000000000000000, 0.000000000000000,  0.301091001773231,  0.328410814558015,
        -3.555221669293060, -0.936926338402050, -0.484678961158175, -0.316918159235593, 1.375023001934816,  0.362367071946193,  0.565478858268959,
        0.448580543237888,  1.376931431724776,  0.362870010525424,  -1.941229946417363, -1.171568718827851, 0.000000000000000,  0.000000000000000,
        -0.556242656916698, -0.739288531664228, 0.000000000000000,  0.000000000000000,  -0.331679433262886, -0.537724066493881, 0.000000000000000,
        0.000000000000000,  0.366466339200700,  0.558385044841630,  0.000000000000000,  0.000000000000000,  0.051947643205032,  -0.226533837298849,
        -1.594358506068358, -2.031185438534427, -0.136492729695776, -0.008037001414897, 0.616636548463193,  0.785584404849573,  0.732757036831930,
        1.063188309743754,  0.617492394188689,  0.786674737650285,  -1.112684573682600, -1.267137063636131, 0.000000000000000,  0.000000000000000,
        0.000000000000000,  0.000000000000000,  -0.867563034348708, -0.308014600790432, 0.000000000000000,  0.000000000000000,  -0.106512296567624,
        -0.190216671658397, 0.000000000000000,  0.000000000000000,  -0.109947238671073, 0.054690231299734,  0.000000000000000,  -0.000000000000000,
        0.155412900382826,  -0.108866380394778, -4.452439003231616, -2.867973788375745, 0.720819769865676,  0.275869333168652,  1.877313119090894,
        1.209243925457212,  -0.525439757206892, -0.000113627329616, 1.149614807301361,  0.740507647982577,  -0.343666797953847, 0.016385862649973,
        0.000000000000000,  0.000000000000000,  -0.684408006313711, -0.436398500100147, 0.000000000000000,  0.000000000000000,  -0.288831582865636,
        -0.285195394799940, 0.000000000000000,  0.000000000000000,  -0.040304608059671, 0.123537651926137,  0.000000000000000,  0.000000000000000,
        -0.128207097447709, -0.157267735864926, -3.626598448789976, -3.401680257083047, 0.566377041210500,  0.408476321976122,  1.529108167601312,
        1.434274331201273,  -0.193152627128917, 0.039988737323909,  0.936383693036348,  0.878310065653681,  -0.073711806970246, 0.027579501942450,
        -1.196653605347548, -0.758878721974009, 0.000000000000000,  0.000000000000000,  0.453967106463134,  0.302501326702262,  0.000000000000000,
        0.000000000000000,  -0.271126931818474, -0.064269702853756, 0.000000000000000,  0.000000000000000,  0.414464381507351,  0.120391320637276,
        0.000000000000000,  0.000000000000000,  0.825805039150589,  0.423727871377438,  -3.078912281692708, -0.811402010530911, -0.632022449906443,
        -0.144672532062942, 1.229857961180829,  0.324110962271698,  -0.301911942693664, 0.062377892210714,  0.794971732761955,  0.209503098257695,
        -0.744431839603130, -0.855372524071651, 0.000000000000000,  0.000000000000000,  0.314806778575627,  0.360935095502931,  0.000000000000000,
        0.000000000000000,  0.131471731665028,  0.257828459117032,  0.000000000000000,  0.000000000000000,  -0.008826949622104, -0.082031255857236,
        0.000000000000000,  -0.000000000000000, 0.116610806005190,  -0.108227185183010, -1.380754968995004, -1.759058189567851, 0.153029377687592,
        0.350652880254071,  0.551536495909817,  0.702648052522945,  0.395932711626730,  0.661178306257480,  0.356509400007386,  0.454186871547070,
        0.000000000000000,  0.000000000000000,  -0.293564638051550, -0.059257497049766, 0.000000000000000,  0.000000000000000,  0.587261157807899,
        0.204549821648827,  0.000000000000000,  0.000000000000000,  0.372955720600573,  0.009957800133103,  0.000000000000000,  0.000000000000001,
        0.014101606314674,  0.046882000188890,  -0.000000000000000, 0.000000000000000,  -1.247319571664149, -0.129093308300112, -5.268196874500553,
        -3.393432349573873, -0.248329771535736, 0.042332300029652,  1.433821578561278,  0.923575303678869,  0.671763500305512,  0.484375157354723,
        0.000000000000000,  0.000000000000000,  -0.206224916509641, -0.054322742502897, 0.000000000000000,  0.000000000000000,  0.498999493506253,
        0.272641727144403,  0.000000000000000,  0.000000000000000,  0.208434654051271,  -0.047565971649497, -0.000000000000000, 0.000000000000000,
        0.033275359918420,  0.086449308864106,  -0.000000000000000, -0.000000000000000, -0.654383974287615, -0.090774872802848, -4.291049152861360,
        -4.024922359499622, -0.005685940941135, 0.064450753834966,  1.167875653968039,  1.095445115010333,  0.793023978769182,  0.750770021171599,
        -0.017888638230019, 0.044879384965892,  0.000000000000000,  0.000000000000000,  0.578782904256008,  0.457862769561188,  -0.000000000000000,
        0.000000000000000,  0.008879897619201,  -0.132578048616079, -0.000000000000000, 0.000000000000000,  0.102105666359815,  0.086198252244216,
        0.000000000000000,  0.000000000000000,  -0.899770407829466, -0.305859121237112, 0.000000000000000,  0.000000000000000,  -0.251458681093309,
        -0.035832047566819, -3.643018140731867, -0.960063806093660, 0.711574991741874,  0.721657966220887,  0.939319533525868,  0.247543836362505,
        0.037194841663265,  0.018686625145769,  0.000000000000000,  0.000000000000000,  0.484264484774111,  0.564981390056452,  0.000000000000000,
        0.000000000000000,  -0.211626619004529, -0.259700448370186, 0.000000000000000,  0.000000000000000,  0.118551536873411,  0.154456079505235,
        0.000000000000000,  -0.000000000000000, -0.142502906410790, -0.113464797459625, 0.000000000000000,  -0.000000000000000, -0.181387416003242,
        -0.382579689535926, -1.633731311497136, -2.081345718519632, 1.031089991677936,  1.369023492718211,  0.421242956839573,  0.536656314599950,
        0.000000000000000,  0.000000000000000,  -0.506451836320470, -0.296273706453868, 0.000000000000000,  0.000000000000000,  -0.542709367609226,
        -0.429457859838910, 0.000000000000000,  0.000000000000000,  0.800156543122357,  0.374926250842876,  0.000000000000000,  0.000000000000000,
        -0.983055465202614, -0.262023713695827, -0.000000000000001, 0.000000000000000,  -0.110269564739855, 0.066205830886926,  -0.000000000000000,
        0.000000000000000,  0.824778311205397,  0.463479065467177,  -6.083189767273680, -3.918398161006520, -0.023530768301224, -0.250338072887495,
        0.000000000000000,  0.000000000000000,  -0.526900387542157, -0.449198630304078, 0.000000000000000,  0.000000000000000,  -0.636552140236287,
        -0.698659252022861, 0.000000000000000,  0.000000000000000,  0.746953265003640,  0.547558942248190,  -0.000000000000000, -0.000000000000000,
        -0.689569269620795, -0.345564863778255, -0.000000000000000, 0.000000000000001,  0.039524323017489,  0.115879595230128,  0.000000000000000,
        -0.000000000000000, 0.816564465530933,  0.714821772026179,  -4.954876767020846, -4.647580015448903, -0.184329264459494, -0.481536057924786,
        -0.302295877217734, -0.246019800047640, -0.000000000000000, 0.000000000000000,  -0.605756806387885, -0.488831164353746, -0.000000000000000,
        0.000000000000000,  0.615951509456567,  0.400665575228901,  -0.000000000000000, 0.000000000000000,  -0.808311025118490, -0.382171447028984,
        -0.000000000000000, -0.000000000000000, -0.046447869265460, 0.032418981534045,  -0.000000000000001, 0.000000000000000,  0.661829146872260,
        0.501463514786584,  -0.000000000000000, 0.000000000000000,  0.126673326273539,  -0.082667749541566, -4.206595008428467, -1.108586193774784,
        -0.291101591932177, -0.357858749317417, 0.000000000000000,  0.000000000000000,  -0.540911300293262, -0.631651063060300, 0.000000000000000,
        0.000000000000000,  0.374202788279467,  0.416529013617150,  0.000000000000000,  0.000000000000000,  -0.264380783585550, -0.253337217510548,
        -0.000000000000000, 0.000000000000000,  0.062611754235200,  0.082187143539904,  -0.000000000000000, 0.000000000000000,  0.531289215411953,
        0.614449383292449,  0.000000000000000,  0.000000000000000,  -0.425702291703135, -0.736264371083816, -1.886470424952785, -2.403331021727972};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 36, 28));

    std::vector<double> intzvals{
        4.055459844849120,  2.612265440671015,  -0.090410320183662, -0.115881065347292, 0.000000000000000,  0.000000000000000,  -0.336488709049857,
        -0.171664801035830, -0.000000000000001, 0.000000000000000,  -0.174533842489516, -0.031119094588200, 0.000000000000000,  0.000000000000000,
        -0.394526242869313, -0.086254043352073, -0.000000000000000, -0.000000000000000, 0.637289733579589,  0.216911941948501,  0.000000000000000,
        0.000000000000000,  -0.026142632653357, -0.096984740526525, -2.027729922424560, -1.306132720335507, -0.017676790570990, 0.039160446492353,
        3.303251178013897,  3.098386676965936,  -0.142509767871707, -0.199035366837766, 0.000000000000000,  0.000000000000000,  -0.323117956624626,
        -0.256141682065184, 0.000000000000000,  0.000000000000000,  -0.098615967352214, -0.038382603370071, 0.000000000000000,  0.000000000000000,
        -0.251728230350507, -0.108848439281376, 0.000000000000000,  0.000000000000000,  0.500056735779643,  0.301969423130950,  0.000000000000000,
        0.000000000000000,  -0.118905455160661, -0.158639001491843, -1.651625589006949, -1.549193338482968, 0.002943088701178,  0.088338168170175,
        0.306759580837015,  0.456641490020845,  3.099596321999923,  0.816852984886682,  -1.092730421207514, -0.879238229846751, 0.000000000000000,
        0.000000000000000,  -0.127366680879477, -0.035206305115625, 0.000000000000000,  0.000000000000000,  -0.569347997283809, -0.278610715425789,
        0.000000000000000,  0.000000000000000,  1.086232951759034,  0.664083934178043,  -0.000000000000000, -0.000000000000000, -0.331387668903617,
        -0.351301592280628, 0.000000000000000,  0.000000000000000,  -0.272271380036642, -0.369574071973854, -1.328398423714253, -0.350079850665721,
        0.939777789927875,  1.419551214990448,  1.390030839438894,  1.770875489694294,  -1.027605258328501, -1.257345738392250, 0.000000000000000,
        0.000000000000000,  -0.008163502924373, 0.000577819410491,  0.000000000000000,  -0.000000000000000, -0.207754642357478, -0.209525431083332,
        0.000000000000000,  0.000000000000000,  0.619916286292106,  0.696097643545911,  0.000000000000000,  0.000000000000000,  -0.462632475277521,
        -0.585191736891761, 0.000000000000000,  0.000000000000000,  -0.684692460806983, -1.000348553821096, -0.595727502616669, -0.758946638440412,
        0.000000000000000,  0.000000000000000,  -0.161612600592779, -0.125181819964601, 3.512131249667036,  2.262288233049248,  -0.164272206671238,
        -0.010152631654297, 0.000000000000000,  0.000000000000000,  0.025860844227005,  -0.004785146306780, 0.000000000000000,  -0.000000000000000,
        -0.669463327012819, -0.015411280572807, 0.000000000000000,  0.000000000000000,  -0.122835375272177, -0.015532827468919, -1.756065624833518,
        -1.131144116524625, 0.179030890454219,  0.009978516986948,  0.000000000000000,  0.000000000000000,  -0.040823389829684, 0.191529366194547,
        0.000000000000000,  0.000000000000000,  -0.195447281390741, -0.196984547510371, 2.860699435240907,  2.683281572999748,  -0.057427409767192,
        -0.007695026430906, 0.000000000000000,  0.000000000000000,  0.035788647702895,  -0.022674652379436, -0.000000000000000, -0.000000000000000,
        -0.283042350505655, 0.033522961990546,  0.000000000000000,  0.000000000000000,  -0.032839710813371, -0.028336163387519, -1.430349717620453,
        -1.341640786499874, 0.077629255019677,  0.004990862911293,  0.000000000000000,  0.000000000000000,  0.061142968713606,  0.408358274829265,
        -0.145505043347038, -0.140471299986613, 0.000000000000000,  0.000000000000000,  -0.740475971595502, -0.459411729373175, 2.684329156328744,
        0.707415436069013,  0.339370221374586,  0.150106116635782,  0.000000000000000,  0.000000000000000,  -0.934707102692057, -0.291976200528460,
        0.000000000000000,  0.000000000000000,  -0.017386581387080, 0.019309419251637,  0.000000000000000,  0.000000000000000,  0.550415554528824,
        0.331770860805293,  -1.150426781283747, -0.303178044029577, 0.263030788919862,  0.031492525211782,  0.000000000000000,  0.000000000000000,
        -0.188378366003839, -0.241255814306720, 0.000000000000000,  0.000000000000000,  -0.300706949047762, -0.202826592424028, 1.203802018997890,
        1.533623161014467,  0.026562960753542,  -0.036162024666012, 0.000000000000000,  0.000000000000000,  -0.042721604717478, 0.060178109035350,
        -0.000000000000000, 0.000000000000000,  -0.014017411089903, -0.041511058537545, 0.000000000000000,  0.000000000000000,  0.205329121779908,
        0.134760831575604,  -0.515915150999096, -0.657267069006200, -0.237103275131323, -0.463345435501156, 0.000000000000000,  0.000000000000000,
        -0.766409871534240, -0.493671765321719, -0.886908940683498, -0.561535504749939, 0.000000000000000,  0.000000000000000,  -0.214699359798731,
        -0.034441204947035, 2.968292668821078,  1.911982525583831,  -0.084884873918776, -0.061625233862640, 0.000000000000000,  0.000000000000000,
        0.034149828903055,  0.046522474983533,  -1.484146334410539, -0.955991262791915, -0.197088772044084, -0.034917560478870, 0.000000000000000,
        0.000000000000000,  -0.108463080987305, 0.158910946458420,  -0.383204935767120, -0.246835882660859, -0.461924826617415, -0.363313978513325,
        -0.624255795357566, -0.585540043769120, -0.917700448000846, -0.886983111128318, 0.000000000000000,  0.000000000000000,  -0.073276356877260,
        -0.058885355217225, 2.417732299193318,  2.267786838055364,  -0.123918807343743, -0.078873018998673, 0.000000000000000,  0.000000000000000,
        0.063693568699073,  0.074757891195991,  -1.208866149596659, -1.133893419027682, -0.046127925214711, -0.071553210800879, 0.000000000000000,
        0.000000000000000,  0.060035790995564,  0.331328073297665,  -0.312127897678783, -0.292770021884560, -0.572188313531067, -0.573748304001133,
        -0.206554021064123, -0.076033086360614, -0.585768645193020, -0.154370703979355, -0.205794555026239, -0.051759444524326, 0.000000000000000,
        0.000000000000000,  -0.300404722783976, -0.309864070751346, 2.268672207563048,  0.597875165654356,  0.018376755586175,  0.057325405460218,
        0.000000000000000,  0.000000000000000,  -0.063803462941897, 0.108380783515968,  -0.972288088955592, -0.256232213851866, -0.297794952949520,
        -0.118661233638767, 0.000000000000000,  0.000000000000000,  -0.033510988765264, -0.030747687548515, -0.251043705082723, -0.066158873134009,
        -0.053418302364789, -0.056882812095655, -0.262691136847548, -0.334664010613631, -0.051616240522523, -0.072119536802368, 0.000000000000000,
        0.000000000000000,  -0.309579905396790, -0.308401339624002, 1.017398398206846,  1.296148139681573,  0.092905917869897,  0.122878105659590,
        0.000000000000000,  0.000000000000000,  0.084645924263566,  0.042540949641143,  -0.436027884945791, -0.555492059863532, -0.226209776626045,
        -0.375901649779950, 0.000000000000000,  0.000000000000000,  -0.023724163196563, -0.020942814001096, -0.112581915791806, -0.143427433120127,
        0.000000000000000,  0.000000000000000,  0.691097172515727,  0.424735454808337,  -1.327460836919641, -0.855064579799436, -0.102153933487541,
        -0.270381595477425, 0.000000000000000,  0.000000000000000,  0.057270483238202,  0.079656489295132,  -1.713744571377442, -1.103883625831685,
        0.057175835633325,  0.014567440083051,  0.000000000000000,  0.000000000000000,  -0.076364289474117, -0.025642354575189, -0.663730418459820,
        -0.427532289899718, -0.344611812359992, -0.091642364456750, 0.000000000000000,  0.000000000000000,  -0.964072771015041, -0.345421380904507,
        0.000000000000000,  0.000000000000000,  0.762436005040403,  0.638621735405513,  -1.081242754478624, -1.014185105674220, -0.280271707279323,
        -0.476919751378989, 0.000000000000000,  0.000000000000000,  0.081018497979165,  0.138880440333435,  -1.395878393767715, -1.309307341415955,
        0.067665417955432,  0.000490264816611,  0.000000000000000,  0.000000000000000,  -0.092428874107872, -0.007219351704872, -0.540621377239312,
        -0.507092552837110, -0.172509886713785, -0.154578298186408, 0.000000000000000,  0.000000000000000,  -0.765419361813233, -0.489493525675832,
        0.074310998820624,  0.140251808107650,  0.000000000000000,  0.000000000000000,  -0.017899395072672, -0.058683248075424, -1.014581054955098,
        -0.267377902492417, 0.051658649774928,  0.058831304471052,  0.000000000000000,  0.000000000000000,  0.054019472741793,  0.073198904326056,
        -1.122701579776756, -0.295871475284858, 0.188158126173331,  0.051427137976527,  0.000000000000000,  0.000000000000000,  -0.239620651841206,
        -0.024903741722684, -0.434820452123613, -0.114590529639607, -0.542705412188818, -0.321780733510694, 0.000000000000000,  0.000000000000000,
        0.203971833607461,  0.262447093498036,  0.000000000000000,  0.000000000000000,  -0.115617826195040, -0.167701502856556, -0.454994395717981,
        -0.579655069847578, 0.118614366249456,  0.170093107034980,  0.000000000000000,  0.000000000000000,  0.047453021042673,  0.018006604036186,
        -0.503481633495271, -0.641426980589819, -0.102358312058013, -0.224972110182279, 0.000000000000000,  0.000000000000000,  0.039410952097968,
        0.065782142351761,  -0.194997598164849, -0.248423601363248, -0.303372638100379, -0.343998158357764, 0.000000000000000,  0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -1.656773229710550, -0.471304564137287, 0.000000000000000,  0.000000000000000,  -0.022319873302880,
        0.164554754704591,  1.327460836919640,  0.855064579799435,  -0.110416916363016, 0.049480208233167,  0.000000000000000,  0.000000000000000,
        -0.009064423808936, -0.028498087153158, -2.654921673839279, -1.710129159598869, 0.281310230036101,  -0.047145285130649, 0.000000000000000,
        0.000000000000000,  -0.178739007878295, 0.309403623216655,  0.000000000000000,  0.000000000000000,  -0.233540080300670, -0.049905466727241,
        -0.000000000000000, 0.000000000000000,  -1.197845321928590, -0.630687300617531, 0.000000000000000,  0.000000000000000,  0.151079125932236,
        0.284813556634599,  1.081242754478623,  1.014185105674220,  -0.030383282644552, 0.117758865995933,  0.000000000000000,  0.000000000000000,
        -0.021794900599678, -0.051948566002294, -2.162485508957247, -2.028370211348440, 0.121692602246529,  -0.146110274860397, 0.000000000000000,
        0.000000000000000,  0.259970806991163,  0.535300947845246,  -0.000000000000000, 0.000000000000000,  -0.144564363483609, -0.063817564424628,
        -1.043175201880540, -0.579294963209342, -0.000000000000000, -0.000000000000000, -0.006957381325215, 0.083127751942180,  0.000000000000000,
        0.000000000000000,  -0.054447966108136, -0.005623847794705, 0.869640904247226,  0.229181059279215,  -0.007878228481034, -0.015984459303654,
        0.000000000000000,  0.000000000000000,  0.189702189829270,  0.062601321662020,  -2.029162109910196, -0.534755804984834, -0.133398881330508,
        0.125547319599160,  0.000000000000000,  0.000000000000000,  -0.121636133409914, -0.049163761828163, -0.000000000000000, 0.000000000000000,
        -0.490046040379217, -0.525859674275956, -0.000000000000000, -0.000000000000000, 0.180152970188199,  0.256406588942471,  0.000000000000000,
        0.000000000000000,  0.054239236836215,  0.102959939001534,  0.389995196329698,  0.496847202726496,  -0.042228712124738, -0.063623739787457,
        0.000000000000000,  0.000000000000000,  -0.039616164781819, -0.117050867511076, -0.909988791435963, -1.159310139695156, 0.304841442705441,
        0.433805441287998,  0.000000000000000,  0.000000000000000,  -0.031559991862431, -0.029918011614971, -0.000000000000000, 0.000000000000000,
        0.000000000000000,  0.000000000000000,  0.040436367516554,  0.164792475793749,  0.663730418459820,  0.427532289899718,  -0.301963390256341,
        0.237427803576938,  0.000000000000000,  0.000000000000000,  0.199811074910412,  -0.071976988213842, 3.427489142754883,  2.207767251663371,
        0.012706075361854,  -0.059290005909677, 0.000000000000000,  0.000000000000000,  0.062480771416515,  -0.124881745598010, -1.327460836919640,
        -0.855064579799436, -0.209466370341710, -0.260218415660481, 0.000000000000000,  0.000000000000000,  1.797069825530706,  0.652334268459095,
        0.000000000000000,  0.000000000000000,  0.211665487381325,  0.265368336066750,  0.540621377239312,  0.507092552837110,  0.141422298315890,
        0.428406190531169,  0.000000000000000,  0.000000000000000,  0.075038180729515,  -0.183688958767927, 2.791756787535429,  2.618614682831910,
        -0.110634446393882, -0.063627452947669, 0.000000000000000,  0.000000000000000,  -0.062614904990284, -0.234015898713170, -1.081242754478624,
        -1.014185105674221, -0.294913799929955, -0.456723861652672, 0.000000000000000,  0.000000000000000,  1.445579973883571,  0.923004278515360,
        -0.154979700934259, 0.006400705217370,  0.000000000000000,  0.000000000000000,  -0.313234581063058, 0.010534293560459,  0.434820452123614,
        0.114590529639608,  -0.068218490421770, -0.066144929743499, 0.000000000000000,  0.000000000000000,  0.015298474779664,  -0.117546126695802,
        2.619637019479097,  0.690366775664669,  0.063112683866925,  -0.047110801014737, 0.000000000000000,  0.000000000000000,  -0.107017838555351,
        -0.068026764544326, -1.014581054955098, -0.267377902492417, 0.939906121945857,  0.546958806787789,  0.000000000000000,  0.000000000000000,
        0.080813726576996,  0.124374631981910,  0.000000000000000,  0.000000000000000,  0.149690556819271,  0.229777306260081,  0.194997598164849,
        0.248423601363248,  -0.041006573422876, -0.008841863975314, 0.000000000000000,  0.000000000000000,  -0.126810552044573, -0.104036628751993,
        1.174790478155632,  1.496662954709578,  -0.184387326390721, -0.286609771773049, 0.000000000000000,  0.000000000000000,  -0.105793304926127,
        -0.150755575787414, -0.454994395717981, -0.579655069847578, 0.498088773854503,  0.555409389830459,  0.000000000000000,  0.000000000000000,
        0.383204935767120,  0.246835882660859,  0.662632936098703,  0.395183564710644,  0.000000000000000,  0.000000000000000,  -0.313751222086885,
        -0.153410289827468, 1.484146334410539,  0.955991262791915,  -0.208170756963348, -0.051532810161525, 0.000000000000000,  0.000000000000000,
        -0.074330462404152, 0.070862010609824,  2.968292668821078,  1.911982525583830,  -0.175073415046589, -0.074463628992275, 0.000000000000000,
        0.000000000000000,  0.294602020796356,  -0.043140570076809, -0.766409871534240, -0.493671765321718, -0.252789086986908, -0.467079553659655,
        0.312127897678783,  0.292770021884560,  0.681313806582940,  0.611537450862211,  0.000000000000000,  0.000000000000000,  -0.165798605766048,
        -0.306922411810421, 1.208866149596659,  1.133893419027682,  -0.101518457475179, -0.080419777296616, 0.000000000000000,  0.000000000000000,
        0.064202636482932,  0.118445101052092,  2.417732299193317,  2.267786838055364,  -0.160917350900835, -0.096657201334150, 0.000000000000000,
        0.000000000000000,  0.055894275276149,  -0.092537918694808, -0.624255795357566, -0.585540043769120, -0.586043831446779, -0.775910385038515,
        0.212925400981861,  0.104304470246955,  0.251043705082723,  0.066158873134009,  -0.108039310878033, 0.045456531750741,  0.000000000000000,
        0.000000000000000,  -0.378479402534043, -0.227779811273868, 0.972288088955592,  0.256232213851867,  -0.103063358636665, 0.074494493650743,
        0.000000000000000,  0.000000000000000,  -0.396832216224350, -0.338891549651479, 2.268672207563047,  0.597875165654355,  0.283514195400970,
        0.037605176168820,  0.000000000000000,  0.000000000000000,  0.345122916191356,  0.140587463474737,  -0.585768645193020, -0.154370703979355,
        0.070662914010322,  0.065092541142649,  0.112581915791806,  0.143427433120127,  0.232633032510266,  0.405792358519372,  0.000000000000000,
        0.000000000000000,  -0.231366551123216, -0.254028807229475, 0.436027884945791,  0.555492059863532,  0.161204265757889,  0.220230058426009,
        0.000000000000000,  0.000000000000000,  -0.332636072999407, -0.335144110045028, 1.017398398206846,  1.296148139681573,  -0.062363834750282,
        -0.113335341330718, 0.000000000000000,  0.000000000000000,  0.081401516579878,  0.068718472382863,  -0.262691136847547, -0.334664010613631,
        0.000000000000000,  0.000000000000000,  0.275974375604732,  -0.164178984874987, 1.756065624833518,  1.131144116524624,  -0.033711349364116,
        -0.002712076589761, 0.000000000000000,  0.000000000000000,  -0.350264207661549, -0.023564802206050, 0.000000000000000,  -0.000000000000001,
        -0.079120052543534, -0.001797281672648, 0.000000000000000,  0.000000000000000,  0.610528975454292,  0.045816554806613,  3.512131249667036,
        2.262288233049249,  0.278495340660081,  0.010555624746424,  0.000000000000000,  0.000000000000000,  -0.096920531126013, -0.118124641085491,
        0.000000000000000,  0.000000000000000,  0.049378480893427,  -0.378319963875162, 1.430349717620454,  1.341640786499874,  -0.023941069012506,
        -0.000678331997122, 0.000000000000000,  0.000000000000000,  -0.161211385627131, -0.009560062776330, -0.000000000000000, -0.000000000000000,
        -0.025047968208552, 0.000734654530620,  0.000000000000000,  0.000000000000000,  0.283215251762149,  0.026516790684874,  2.860699435240907,
        2.683281572999748,  0.099295286013701,  0.004478656051040,  0.000000000000000,  0.000000000000000,  -0.166201951218209, -0.189300692349081,
        -0.040669429244952, 0.046496439751695,  0.000000000000000,  0.000000000000000,  -0.404865867011724, -0.292280276488709, 1.150426781283747,
        0.303178044029577,  -0.539502647560117, -0.189079767090633, 0.000000000000000,  0.000000000000000,  -0.134528363767845, -0.035795433854621,
        -0.000000000000000, 0.000000000000000,  1.002514949358566,  0.357775162210529,  0.000000000000000,  0.000000000000000,  -0.283235641930544,
        -0.340521650849273, 2.684329156328743,  0.707415436069013,  -0.084240391652184, -0.119845975017440, 0.000000000000000,  0.000000000000000,
        0.279627190838004,  0.500134702787459,  0.000000000000000,  0.000000000000000,  -0.193044254353084, -0.129225827410511, 0.515915150999096,
        0.657267069006200,  -0.062429818394015, -0.016319553585833, 0.000000000000000,  0.000000000000000,  -0.005786885231485, 0.004640836094104,
        0.000000000000000,  0.000000000000000,  0.121167807208073,  0.035598290994554,  0.000000000000000,  0.000000000000000,  -0.264511518413745,
        -0.186677653098883, 1.203802018997890,  1.533623161014466,  -0.177397089866022, -0.231845052105414, 0.000000000000000,  0.000000000000000,
        2.027729922424561,  1.306132720335507,  0.065839125625686,  -0.033652744589089, 0.000000000000000,  0.000000000000000,  0.217224048166880,
        0.119218529838214,  -0.000000000000000, 0.000000000000000,  -0.482724295690169, -0.188834209522006, 0.000000000000000,  0.000000000000000,
        0.503646695639263,  0.118171517234711,  0.000000000000000,  -0.000000000000000, 0.285198605603975,  0.046583471512786,  0.000000000000000,
        0.000000000000000,  -0.285576302631439, -0.166144030631938, 4.055459844849121,  2.612265440671013,  -0.132831749418266, -0.120871236763823,
        1.651625589006949,  1.549193338482968,  0.019459744341787,  -0.082302649134264, 0.000000000000000,  0.000000000000000,  0.208736798536197,
        0.183059181917591,  -0.000000000000000, 0.000000000000000,  -0.410278796154857, -0.267733225681607, 0.000000000000000,  0.000000000000000,
        0.334884544154794,  0.150554710638475,  0.000000000000000,  -0.000000000000000, 0.157069368264998,  0.055477012206799,  0.000000000000000,
        0.000000000000000,  -0.300184446612074, -0.250135736717316, 3.303251178013897,  3.098386676965935,  -0.162587341769860, -0.204523998476114,
        0.320673450756793,  0.386372571339771,  1.328398423714253,  0.350079850665721,  0.535841934037981,  0.422993132606713,  0.000000000000000,
        0.000000000000000,  -0.917431668240434, -0.590437469196700, -0.000000000000000, 0.000000000000000,  0.671976091452150,  0.338632867511444,
        0.000000000000000,  0.000000000000000,  0.421337525817706,  0.194939914860236,  0.000000000000001,  -0.000000000000000, -1.034838449912753,
        -0.859687170238566, 0.000000000000000,  0.000000000000000,  0.264727901188128,  0.441798821973136,  3.099596321999923,  0.816852984886682,
        0.693797385158361,  1.008207154366241,  0.595727502616669,  0.758946638440412,  0.501717507712572,  0.619004126269976,  0.000000000000000,
        0.000000000000000,  -0.570004472337478, -0.647781939617410, -0.000000000000000, -0.000000000000000, 0.257243139505652,  0.261245425665702,
        0.000000000000000,  0.000000000000000,  0.144210596088527,  0.146777006496272,  -0.000000000000000, -0.000000000000000, -1.017176361949856,
        -1.248401570884298, 0.000000000000000,  0.000000000000000,  0.931653760594745,  1.412512283085857,  1.390030839438894,  1.770875489694295};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 36, 28));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeGGForLiH)
{
    CAngularMomentumIntegralsDriver amomdrv(MPI_COMM_WORLD);

    amomdrv.setAngularMomentumOrigin(1.0, 2.0, 3.0);

    auto mlih = vlxmol::getTestLiH();

    auto mbas = vlxbas::getTestBasisForLiH();

    CGtoBlock bgtos(mlih, mbas, 4);

    CGtoBlock kgtos(mlih, mbas, 4);

    CDenseMatrix amomxmat(36, 36);

    CDenseMatrix amomymat(36, 36);

    CDenseMatrix amomzmat(36, 36);

    amomdrv.compute(amomxmat.values(), amomymat.values(), amomzmat.values(), bgtos, kgtos);

    std::vector<double> intxvals{
        0.000000000000000,  -0.000000000000000, -0.608729123769530, -0.899418087932048, -0.000000000000000, -0.000000000000000, 0.765185654464865,
        0.514416539987725,  -0.000000000000000, -0.000000000000000, -0.905406185822738, -0.691300012022726, -0.000000000000000, -0.000000000000000,
        0.402015510398945,  0.372318117472509,  -0.000000000000000, -0.000000000000000, -1.223706374634121, -0.378235314186502, 0.000000000000000,
        0.000000000000000,  0.414187274288235,  0.230789192361889,  -0.000000000000000, -0.000000000000000, -0.280602137296376, 0.119353132823494,
        -1.414213562373094, -1.192330590038906, 0.721345503440574,  0.087959560360944,  -0.000000000000000, -0.000000000000000, 0.101480533592001,
        0.137555269342696,  0.000000000000000,  0.000000000000000,  -0.811729414076814, -1.415236442766992, 0.000000000000000,  -0.000000000000000,
        0.662751507034760,  0.722397853975322,  0.000000000000000,  -0.000000000000000, -0.804481135447119, -1.013768069657613, 0.000000000000000,
        -0.000000000000000, 0.457713556396526,  0.520170300794229,  0.000000000000000,  -0.000000000000000, -0.707777135416485, -0.459413898841252,
        0.000000000000000,  0.000000000000000,  0.333715618763030,  0.308118696931154,  0.000000000000000,  -0.000000000000000, -0.036249636814242,
        0.243200353685275,  -1.192330590038906, -1.414213562373094, 0.400609115086632,  -0.020381703940177, 0.000000000000000,  -0.000000000000000,
        0.123977989739191,  0.217381089655202,  0.608729123769530,  0.811729414076814,  0.000000000000000,  -0.000000000000000, -0.466166726337047,
        -0.408650256690841, 0.000000000000000,  0.000000000000000,  0.694233457087761,  0.502906926568770,  0.000000000000000,  -0.000000000000000,
        -0.320097894419991, -0.276816599312781, -0.000000000000000, -0.000000000000000, 0.927184704681591,  0.452641504671213,  -0.000000000000000,
        0.000000000000000,  -0.246286076683600, -0.198163458309859, -0.000000000000000, 0.000000000000000,  0.105666072088528,  0.028716598047918,
        0.000000000000000,  0.000000000000000,  -0.592344719841572, -0.242436637612962, -1.414213562373095, -0.652335286367939, 0.069067005636624,
        0.113658082974135,  0.000000000000001,  0.000000000000000,  0.899418087932048,  1.415236442766992,  0.000000000000000,  0.000000000000000,
        -0.321588300613887, -0.454381266579198, 0.000000000000000,  -0.000000000000000, 0.315928246367379,  0.401463610714548,  0.000000000000000,
        -0.000000000000000, -0.170686084950032, -0.210123860798346, 0.000000000000000,  -0.000000000000000, 0.199370716115516,  0.221691298371887,
        -0.000000000000000, -0.000000000000000, -0.121432973403106, -0.151109789938521, 0.000000000000000,  0.000000000000000,  0.007368308004589,
        0.009353133898233,  -0.000000000000000, -0.000000000000000, -0.007343122488235, 0.066786553851903,  -0.652335286367939, -1.414213562373096,
        0.134469623793759,  0.214498937860071,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, 0.466166726337047,
        0.321588300613887,  0.000000000000000,  -0.000000000000000, 0.687968733435071,  0.506885795002636,  -0.000000000000000, -0.000000000000000,
        -0.947795917674673, -0.146437651142872, -0.000000000000000, -0.000000000000000, -0.192552789297905, -0.360577411481510, -0.000000000000000,
        -0.000000000000000, -0.487169222052572, 0.073792916322807,  -0.000000000000000, -0.000000000000000, 0.529984667030218,  0.379342905299610,
        -1.870828693386970, -1.577305110908926, -1.125075760029947, -0.411235751220492, -0.000000000000000, -0.000000000000000, 0.092857169763011,
        0.205015101848979,  -1.414213562373095, -1.192330590038906, -0.469669243517990, 0.003172849024622,  0.000000000000000,  0.000000000000000,
        0.408650256690841,  0.454381266579198,  0.000000000000000,  0.000000000000000,  0.700367263103084,  0.673015028521531,  0.000000000000000,
        -0.000000000000000, -0.444069002438761, -0.113371749934058, 0.000000000000000,  -0.000000000000000, -0.264844383387016, -0.601600533613674,
        -0.000000000000000, -0.000000000000000, -0.079149893147490, 0.151634663355898,  0.000000000000000,  -0.000000000000000, 0.441467371130952,
        0.565289621844842,  -1.577305110908926, -1.870828693386970, -0.643681492450949, -0.578325114685430, 0.000000000000000,  -0.000000000000000,
        0.141221566788572,  0.347250857055381,  -1.192330590038906, -1.414213562373094, -0.204978491114565, 0.076230717205291,  -0.765185654464865,
        -0.662751507034760, -0.000000000000000, -0.000000000000000, -0.687968733435071, -0.700367263103084, 0.000000000000000,  -0.000000000000000,
        1.051542843011219,  0.640876705844549,  0.000000000000000,  0.000000000000000,  0.432658968756060,  0.325606361536661,  0.000000000000000,
        -0.000000000000000, 0.404740220011808,  0.090462898351821,  0.000000000000000,  -0.000000000000000, -0.846670265703254, -0.604933923681493,
        0.000000000000000,  0.000000000000000,  1.237642750867392,  0.943757741906500,  -1.870828693386971, -0.862958469580835, 0.001078953558959,
        0.116151690154567,  0.000000000000001,  0.000000000000000,  0.585239732270066,  0.355209449338862,  -1.414213562373096, -0.652335286367939,
        -0.514416539987725, -0.722397853975322, -0.000000000000000, 0.000000000000000,  -0.506885795002636, -0.673015028521531, 0.000000000000000,
        0.000000000000000,  0.362134323901468,  0.444531141297417,  0.000000000000000,  -0.000000000000000, 0.231893297203986,  0.314728296463891,
        0.000000000000000,  -0.000000000000000, -0.010257080361318, -0.034359239658080, -0.000000000000000, 0.000000000000000,  -0.371096614984023,
        -0.473145872153477, -0.000000000000000, -0.000000000000000, 0.762729695418418,  1.088878550871881,  -0.862958469580835, -1.870828693386972,
        0.199505896121657,  0.343233642559394,  0.000000000000000,  -0.000000000000000, 0.073620234558619,  -0.034181660687509, -0.652335286367939,
        -1.414213562373096, 0.000000000000000,  -0.000000000000000, -0.694233457087761, -0.315928246367379, 0.000000000000000,  -0.000000000000000,
        -1.051542843011219, -0.362134323901468, 0.000000000000000,  -0.000000000000000, 0.459913157993248,  0.504453323912091,  -0.000000000000000,
        -0.000000000000000, -0.443833863502521, -0.149745850620901, -0.000000000000000, -0.000000000000000, -0.916731392770691, 0.060607130836299,
        -2.121320343559642, -1.788495885058360, 0.380495748736864,  0.013138127511655,  -0.000000000000000, -0.000000000000000, -0.237915025984419,
        0.024780016960665,  -1.870828693386970, -1.577305110908926, 1.061128646244100,  0.764911180028847,  -0.000000000000000, -0.000000000000000,
        0.188723197030352,  0.017346796944210,  0.000000000000000,  0.000000000000000,  -0.502906926568770, -0.401463610714548, 0.000000000000000,
        0.000000000000000,  -0.640876705844549, -0.444531141297417, 0.000000000000000,  0.000000000000000,  0.483755275428016,  0.790754480291828,
        0.000000000000000,  -0.000000000000000, -0.316414493971832, -0.143463702935307, 0.000000000000000,  -0.000000000000000, -0.268048796144672,
        0.213347821536896,  -1.788495885058359, -2.121320343559643, 0.146752615277879,  -0.038863898604668, 0.000000000000000,  -0.000000000000000,
        -0.086703723171417, 0.093408395828450,  -1.577305110908926, -1.870828693386970, 0.924224591380115,  1.092997368551271,  0.000000000000000,
        -0.000000000000000, 0.058429056374242,  0.019236099838114,  0.905406185822738,  0.804481135447119,  -0.000000000000000, -0.000000000000000,
        0.947795917674673,  0.444069002438761,  -0.000000000000000, -0.000000000000000, -0.459913157993248, -0.483755275428016, 0.000000000000000,
        -0.000000000000000, 0.151734644973762,  0.145289977475350,  0.000000000000000,  0.000000000000000,  0.793440198165174,  0.128241434801460,
        -0.000000000000000, 0.000000000000000,  -0.124140717339095, 0.355558570216988,  -2.121320343559642, -0.978502929551909, -0.100784338990293,
        -0.033050803530118, 0.000000000000000,  0.000000000000000,  -0.903318016860565, -0.617210621684056, -1.870828693386971, -0.862958469580835,
        -0.387423642035841, -0.077448384960625, 0.000000000000000,  -0.000000000000000, 0.691300012022726,  1.013768069657613,  0.000000000000000,
        0.000000000000000,  0.146437651142872,  0.113371749934058,  -0.000000000000000, 0.000000000000000,  -0.504453323912091, -0.790754480291828,
        0.000000000000000,  0.000000000000000,  0.158751862992826,  0.249116146114872,  0.000000000000000,  -0.000000000000000, -0.116659645347998,
        -0.245106753428647, -0.000000000000000, -0.000000000000000, 0.583022256389122,  0.942183589863822,  -0.978502929551909, -2.121320343559645,
        0.101657456459305,  0.219752472438056,  0.000000000000000,  -0.000000000000000, -0.425175487658414, -0.605128553525889, -0.862958469580835,
        -1.870828693386971, 0.104400510464606,  0.227838971127288,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.000000000000000,
        0.320097894419991,  0.170686084950032,  0.000000000000000,  -0.000000000000000, -0.432658968756060, -0.231893297203986, 0.000000000000000,
        -0.000000000000000, -0.151734644973762, -0.158751862992826, 0.000000000000000,  -0.000000000000000, -1.005567754836157, 0.004569255246849,
        -3.162277660168380, -2.666132250979429, 0.246191887614793,  0.390514494428544,  -0.000000000000000, -0.000000000000000, -0.209580843259485,
        -0.046141165893413, -2.121320343559643, -1.788495885058359, -0.457824277857588, 0.542083650902371,  -0.000000000000000, -0.000000000000000,
        -1.197814317495205, -0.296114442642013, -0.000000000000000, 0.000000000000000,  -0.755114369292845, -0.197703537206475, 0.000000000000000,
        0.000000000000000,  0.276816599312781,  0.210123860798346,  0.000000000000000,  0.000000000000000,  -0.325606361536661, -0.314728296463891,
        0.000000000000000,  0.000000000000000,  -0.145289977475350, -0.249116146114872, 0.000000000000000,  0.000000000000000,  -0.356803328998215,
        0.151575301964981,  -2.666132250979428, -3.162277660168379, 0.355817327239091,  0.590314979728796,  0.000000000000000,  -0.000000000000000,
        -0.036676526226116, -0.083476729569386, -1.788495885058359, -2.121320343559642, 0.242448474251182,  0.904742758201893,  0.000000000000000,
        -0.000000000000000, -0.598516801877775, -0.353249360271366, -0.000000000000000, 0.000000000000000,  -0.405466765717840, -0.228684735695454,
        -0.402015510398945, -0.457713556396526, 0.000000000000000,  -0.000000000000000, 0.192552789297905,  0.264844383387016,  -0.000000000000000,
        -0.000000000000000, 0.443833863502521,  0.316414493971832,  -0.000000000000000, -0.000000000000000, 1.005567754836157,  0.356803328998215,
        0.000000000000000,  -0.000000000000000, -0.251063062655256, 0.225929979584050,  -3.162277660168381, -1.458666044440504, -0.060774071147971,
        -0.141717845311149, 0.000000000000000,  0.000000000000000,  0.575916420281327,  0.163523569541781,  -2.121320343559643, -0.978502929551909,
        1.033427834293936,  0.428556672641495,  0.000000000000000,  -0.000000000000000, 1.032936579405903,  0.628210616448633,  -0.000000000000000,
        0.000000000000000,  -0.372318117472509, -0.520170300794229, 0.000000000000000,  0.000000000000000,  0.360577411481510,  0.601600533613674,
        0.000000000000000,  0.000000000000000,  0.149745850620901,  0.143463702935307,  -0.000000000000000, 0.000000000000000,  -0.004569255246849,
        -0.151575301964981, 0.000000000000000,  0.000000000000000,  0.554201187064364,  0.943314734059760,  -1.458666044440505, -3.162277660168381,
        0.030507364250878,  0.143441631007349,  0.000000000000000,  -0.000000000000000, 0.043543529249339,  0.026969401060174,  -0.978502929551909,
        -2.121320343559644, 0.236999878561925,  0.330156594470345,  0.000000000000000,  -0.000000000000000, 0.361048718841140,  0.454053358831094,
        -0.000000000000000, 0.000000000000000,  0.000000000000000,  -0.000000000000000, -0.927184704681591, -0.199370716115516, 0.000000000000000,
        0.000000000000000,  -0.404740220011808, 0.010257080361318,  0.000000000000000,  -0.000000000000000, -0.793440198165174, 0.116659645347998,
        3.162277660168380,  2.666132250979428,  0.251063062655256,  -0.554201187064364, 0.000000000000000,  -0.000000000000000, -0.205627372784291,
        -0.123150531923568, -0.000000000000000, -0.000000000000000, 0.246639245085157,  -0.045019605702504, -0.000000000000000, -0.000000000000000,
        0.442601063474635,  -0.018529904118250, -0.000000000000000, -0.000000000000000, 0.539266106624035,  0.277795992222066,  -0.000000000000000,
        -0.000000000000000, -0.047971119887699, -0.011894958446615, 0.000000000000000,  0.000000000000000,  -0.452641504671213, -0.221691298371887,
        0.000000000000000,  0.000000000000000,  -0.090462898351821, 0.034359239658080,  0.000000000000000,  0.000000000000000,  -0.128241434801460,
        0.245106753428647,  2.666132250979429,  3.162277660168379,  -0.225929979584050, -0.943314734059760, 0.000000000000000,  0.000000000000000,
        -0.432245151523214, 0.017159949346882,  0.000000000000000,  -0.000000000000000, 0.074851819425905,  -0.111905224316069, 0.000000000000000,
        -0.000000000000000, 0.153420730872039,  -0.095971139701068, 0.000000000000000,  -0.000000000000000, 0.441954240902606,  0.343915318365634,
        0.000000000000000,  -0.000000000000000, -0.025279949532389, -0.013618500069772, 1.223706374634121,  0.707777135416485,  0.000000000000000,
        0.000000000000000,  0.487169222052572,  0.079149893147490,  -0.000000000000000, 0.000000000000000,  0.916731392770691,  0.268048796144672,
        0.000000000000000,  0.000000000000000,  -0.246191887614793, -0.355817327239091, 3.162277660168381,  1.458666044440505,  0.205627372784291,
        0.432245151523214,  0.000000000000000,  -0.000000000000000, -0.063514395916572, 0.088727416209292,  -0.000000000000001, -0.000000000000000,
        -0.759126021975913, -0.346616662286725, -0.000000000000000, -0.000000000000000, -0.265402312634705, -0.340757708187650, 0.000000000000000,
        -0.000000000000000, 0.019097906470722,  0.037126975573353,  -0.000000000000000, -0.000000000000000, 0.378235314186502,  0.459413898841252,
        -0.000000000000000, 0.000000000000000,  -0.073792916322807, -0.151634663355898, 0.000000000000000,  -0.000000000000000, -0.060607130836299,
        -0.213347821536896, -0.000000000000000, 0.000000000000000,  -0.390514494428544, -0.590314979728796, 1.458666044440504,  3.162277660168381,
        0.123150531923568,  -0.017159949346882, 0.000000000000000,  0.000000000000000,  0.088832989360736,  0.109460335666745,  -0.000000000000000,
        -0.000000000000000, 0.010947865180615,  0.177288792695384,  0.000000000000000,  -0.000000000000000, -0.331210847220158, -0.492454234091952,
        -0.000000000000000, -0.000000000000000, 0.031444008887703,  0.043509368831242,  0.000000000000000,  -0.000000000000000, -0.000000000000000,
        -0.000000000000000, 0.246286076683600,  0.121432973403106,  0.000000000000000,  -0.000000000000000, 0.846670265703254,  0.371096614984023,
        2.121320343559642,  1.788495885058359,  0.124140717339095,  -0.583022256389122, 0.000000000000000,  -0.000000000000000, 0.060774071147971,
        -0.030507364250878, 0.000000000000000,  -0.000000000000000, 0.063514395916572,  -0.088832989360736, 0.000000000000000,  -0.000000000000000,
        -1.127764612913535, -0.056298914296692, -0.000000000000000, -0.000000000000000, 0.334971020212477,  -0.255613490702417, -0.000000000000000,
        -0.000000000000000, -0.127666600362131, -0.165395985334388, -0.000000000000000, -0.000000000000000, 0.913487458605858,  0.260693527160141,
        -0.000000000000000, -0.000000000000000, 0.198163458309859,  0.151109789938521,  0.000000000000000,  0.000000000000000,  0.604933923681493,
        0.473145872153477,  1.788495885058360,  2.121320343559643,  -0.355558570216988, -0.942183589863822, 0.000000000000000,  0.000000000000000,
        0.141717845311149,  -0.143441631007349, 0.000000000000000,  0.000000000000000,  -0.088727416209292, -0.109460335666745, 0.000000000000000,
        0.000000000000000,  -0.633553483582423, 0.197798389054149,  0.000000000000000,  -0.000000000000000, -0.163767969061292, -0.381026646222936,
        0.000000000000000,  -0.000000000000000, -0.180330752627955, -0.238287892560888, 0.000000000000000,  -0.000000000000000, 0.519743717356497,
        0.302139407743672,  -0.414187274288235, -0.333715618763030, 0.000000000000000,  -0.000000000000000, -0.529984667030218, -0.441467371130952,
        -0.000000000000000, 0.000000000000000,  -0.380495748736864, -0.146752615277879, 2.121320343559642,  0.978502929551909,  0.209580843259485,
        0.036676526226116,  -0.000000000000000, -0.000000000000000, -0.246639245085157, -0.074851819425905, 0.000000000000001,  0.000000000000000,
        1.127764612913535,  0.633553483582423,  0.000000000000000,  -0.000000000000000, -0.277195138116882, 0.103363821615492,  -0.000000000000000,
        -0.000000000000000, -0.077337116579633, 0.135677506213901,  -0.000000000000000, -0.000000000000000, -1.162888605491230, -0.809749415605741,
        -0.000000000000000, -0.000000000000000, -0.230789192361889, -0.308118696931154, -0.000000000000000, -0.000000000000000, -0.379342905299610,
        -0.565289621844842, -0.000000000000000, 0.000000000000000,  -0.013138127511655, 0.038863898604668,  0.978502929551909,  2.121320343559645,
        0.046141165893413,  0.083476729569386,  -0.000000000000000, 0.000000000000000,  0.045019605702504,  0.111905224316069,  0.000000000000000,
        0.000000000000000,  0.056298914296692,  -0.197798389054149, 0.000000000000000,  0.000000000000000,  0.171496170318321,  0.255575992172292,
        -0.000000000000000, -0.000000000000000, 0.292352914850641,  0.516706592896076,  0.000000000000000,  -0.000000000000000, -0.524301328506162,
        -0.688798502400961, -0.000000000000000, -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.105666072088528, -0.007368308004589,
        1.870828693386970,  1.577305110908926,  -1.237642750867392, -0.762729695418418, 0.000000000000000,  -0.000000000000000, 0.100784338990293,
        -0.101657456459305, 2.121320343559643,  1.788495885058359,  -0.575916420281327, -0.043543529249339, 0.000000000000000,  -0.000000000000000,
        0.759126021975913,  -0.010947865180615, 0.000000000000000,  -0.000000000000000, 0.277195138116882,  -0.171496170318321, 0.000000000000000,
        -0.000000000000000, 0.747788117322410,  0.496504840498016,  -0.000000000000000, -0.000000000000000, -0.686191042151191, -0.344763420601503,
        -0.000000000000000, -0.000000000000000, -0.348920895358951, -0.274956475482805, 0.000000000000000,  0.000000000000000,  -0.028716598047918,
        -0.009353133898233, 1.577305110908926,  1.870828693386970,  -0.943757741906500, -1.088878550871881, 0.000000000000000,  0.000000000000000,
        0.033050803530118,  -0.219752472438056, 1.788495885058359,  2.121320343559642,  -0.163523569541781, -0.026969401060174, 0.000000000000000,
        0.000000000000000,  0.346616662286725,  -0.177288792695384, 0.000000000000000,  0.000000000000000,  -0.103363821615492, -0.255575992172292,
        0.000000000000000,  0.000000000000000,  0.543771776989054,  0.764738794656307,  0.000000000000000,  -0.000000000000000, -0.557165033693132,
        -0.430369050539778, 0.000000000000000,  -0.000000000000000, -0.381286822245014, -0.360700150235767, 0.280602137296376,  0.036249636814242,
        -0.000000000000000, 0.000000000000000,  1.125075760029947,  0.643681492450949,  1.870828693386971,  0.862958469580835,  0.237915025984419,
        0.086703723171417,  -0.000000000000000, -0.000000000000000, 0.457824277857588,  -0.242448474251182, 2.121320343559643,  0.978502929551909,
        -0.442601063474635, -0.153420730872039, 0.000000000000000,  -0.000000000000000, -0.334971020212477, 0.163767969061292,  0.000000000000000,
        0.000000000000000,  -0.747788117322410, -0.543771776989054, 0.000000000000000,  -0.000000000000000, 0.533676261775657,  0.357647478275774,
        -0.000000000000000, -0.000000000000000, 0.495212511413990,  0.643256880426893,  -0.000000000000000, -0.000000000000000, -0.119353132823494,
        -0.243200353685275, -0.000000000000000, 0.000000000000000,  0.411235751220492,  0.578325114685430,  0.862958469580835,  1.870828693386972,
        -0.024780016960665, -0.093408395828450, -0.000000000000000, 0.000000000000000,  -0.542083650902371, -0.904742758201893, 0.978502929551909,
        2.121320343559644,  0.018529904118250,  0.095971139701068,  0.000000000000000,  0.000000000000000,  0.255613490702417,  0.381026646222936,
        0.000000000000000,  0.000000000000000,  -0.496504840498016, -0.764738794656307, 0.000000000000000,  0.000000000000000,  0.144318479638090,
        0.126403561153869,  -0.000000000000000, -0.000000000000000, 0.630992878155277,  0.950885627275564,  0.000000000000000,  -0.000000000000000,
        1.414213562373094,  1.192330590038906,  0.592344719841572,  0.007343122488235,  0.000000000000000,  -0.000000000000000, -0.001078953558959,
        -0.199505896121657, 1.870828693386970,  1.577305110908926,  0.903318016860565,  0.425175487658414,  0.000000000000000,  -0.000000000000000,
        -1.033427834293936, -0.236999878561925, 0.000000000000000,  -0.000000000000000, 0.265402312634705,  0.331210847220158,  0.000000000000000,
        -0.000000000000000, 0.077337116579633,  -0.292352914850641, 0.000000000000000,  -0.000000000000000, -0.533676261775657, -0.144318479638090,
        0.000000000000000,  -0.000000000000000, 0.962805363324107,  0.513255061647783,  -0.000000000000000, -0.000000000000000, 0.515019509302510,
        0.325582245774578,  1.192330590038906,  1.414213562373094,  0.242436637612962,  -0.066786553851903, 0.000000000000000,  0.000000000000000,
        -0.116151690154567, -0.343233642559394, 1.577305110908926,  1.870828693386970,  0.617210621684056,  0.605128553525889,  0.000000000000000,
        0.000000000000000,  -0.428556672641495, -0.330156594470345, 0.000000000000000,  0.000000000000000,  0.340757708187650,  0.492454234091952,
        0.000000000000000,  0.000000000000000,  -0.135677506213901, -0.516706592896076, 0.000000000000000,  0.000000000000000,  -0.357647478275774,
        -0.126403561153869, 0.000000000000000,  0.000000000000000,  0.759093060937192,  0.672932988064389,  0.000000000000000,  -0.000000000000000,
        0.423164319873962,  0.457934547507835,  -0.721345503440574, -0.400609115086632, 1.414213562373095,  0.652335286367939,  -0.092857169763011,
        -0.141221566788572, -0.000000000000001, -0.000000000000000, -1.061128646244100, -0.924224591380115, 1.870828693386971,  0.862958469580835,
        1.197814317495205,  0.598516801877775,  -0.000000000000000, -0.000000000000000, -0.539266106624035, -0.441954240902606, -0.000000000000000,
        0.000000000000000,  0.127666600362131,  0.180330752627955,  0.000000000000000,  -0.000000000000000, 0.686191042151191,  0.557165033693132,
        0.000000000000000,  0.000000000000000,  -0.962805363324107, -0.759093060937192, 0.000000000000000,  -0.000000000000000, -0.817556034885505,
        -0.679868019341862, -0.000000000000000, -0.000000000000000, -0.087959560360944, 0.020381703940177,  0.652335286367939,  1.414213562373096,
        -0.205015101848979, -0.347250857055381, -0.000000000000000, 0.000000000000000,  -0.764911180028847, -1.092997368551271, 0.862958469580835,
        1.870828693386971,  0.296114442642013,  0.353249360271366,  0.000000000000000,  0.000000000000000,  -0.277795992222066, -0.343915318365634,
        0.000000000000000,  0.000000000000000,  0.165395985334388,  0.238287892560888,  0.000000000000000,  0.000000000000000,  0.344763420601503,
        0.430369050539778,  0.000000000000000,  0.000000000000000,  -0.513255061647783, -0.672932988064389, 0.000000000000000,  0.000000000000000,
        -0.519776573017318, -0.727545826420893, -0.000000000000000, -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.069067005636624,
        -0.134469623793759, 1.414213562373095,  1.192330590038906,  -0.585239732270066, -0.073620234558619, 0.000000000000000,  -0.000000000000000,
        0.387423642035841,  -0.104400510464606, 0.000000000000000,  0.000000000000000,  -1.032936579405903, -0.361048718841140, 0.000000000000000,
        -0.000000000000000, -0.019097906470722, -0.031444008887703, 0.000000000000000,  -0.000000000000000, 1.162888605491230,  0.524301328506162,
        0.000000000000000,  -0.000000000000000, -0.495212511413990, -0.630992878155277, 0.000000000000000,  -0.000000000000000, 0.817556034885505,
        0.519776573017318,  0.000000000000000,  -0.000000000000000, -0.629828800826621, -0.901471822436713, 0.000000000000000,  0.000000000000000,
        -0.113658082974135, -0.214498937860071, 1.192330590038906,  1.414213562373094,  -0.355209449338862, 0.034181660687509,  0.000000000000000,
        0.000000000000000,  0.077448384960625,  -0.227838971127288, -0.000000000000000, -0.000000000000000, -0.628210616448633, -0.454053358831094,
        0.000000000000000,  0.000000000000000,  -0.037126975573353, -0.043509368831242, 0.000000000000000,  0.000000000000000,  0.809749415605741,
        0.688798502400961,  0.000000000000000,  0.000000000000000,  -0.643256880426893, -0.950885627275564, 0.000000000000000,  0.000000000000000,
        0.679868019341862,  0.727545826420893,  0.000000000000000,  0.000000000000000,  -0.818542708566868, -1.417160470422766, -0.101480533592001,
        -0.123977989739191, -0.000000000000001, -0.000000000000000, 0.469669243517990,  0.204978491114565,  1.414213562373096,  0.652335286367939,
        -0.188723197030352, -0.058429056374242, -0.000000000000000, -0.000000000000000, 0.755114369292845,  0.405466765717840,  0.000000000000000,
        0.000000000000000,  0.047971119887699,  0.025279949532389,  0.000000000000000,  -0.000000000000000, -0.913487458605858, -0.519743717356497,
        0.000000000000000,  0.000000000000000,  0.348920895358951,  0.381286822245014,  0.000000000000000,  -0.000000000000000, -0.515019509302510,
        -0.423164319873962, 0.000000000000000,  0.000000000000000,  0.629828800826621,  0.818542708566868,  0.000000000000000,  -0.000000000000000,
        -0.137555269342696, -0.217381089655202, -0.000000000000000, 0.000000000000000,  -0.003172849024622, -0.076230717205291, 0.652335286367939,
        1.414213562373096,  -0.017346796944210, -0.019236099838114, 0.000000000000000,  0.000000000000000,  0.197703537206475,  0.228684735695454,
        -0.000000000000000, -0.000000000000000, 0.011894958446615,  0.013618500069772,  0.000000000000000,  0.000000000000000,  -0.260693527160141,
        -0.302139407743672, 0.000000000000000,  0.000000000000000,  0.274956475482805,  0.360700150235767,  0.000000000000000,  0.000000000000000,
        -0.325582245774578, -0.457934547507835, 0.000000000000000,  0.000000000000000,  0.901471822436713,  1.417160470422766,  0.000000000000000,
        0.000000000000000};

    ASSERT_EQ(amomxmat, CDenseMatrix(intxvals, 36, 36));

    std::vector<double> intyvals{
        0.000000000000000,  -0.000000000000000, 0.383016592220681,  0.609477403715365,  1.414213562373094,  1.192330590038906,  0.046282815744493,
        0.347497521063814,  -0.000000000000000, -0.000000000000000, -1.071725522084303, -0.687230922671101, 0.000000000000000,  0.000000000000000,
        -0.538920193051929, -0.224331358825804, -0.000000000000000, -0.000000000000000, -0.497263776069473, -0.119607921719242, -0.000000000000000,
        -0.000000000000000, 1.671628870354717,  0.673854789823964,  -0.000000000000000, -0.000000000000000, -0.163370950261310, -0.519173064257113,
        -0.000000000000000, -0.000000000000000, -0.800959361317251, -0.528581796889527, -0.000000000000000, -0.000000000000000, 0.117534873343215,
        0.202999677475696,  0.000000000000000,  0.000000000000000,  0.528993459516099,  0.969999903565507,  1.192330590038906,  1.414213562373094,
        0.180860373187439,  0.630840455139150,  0.000000000000000,  -0.000000000000000, -0.889731055482334, -0.968105833019801, 0.000000000000000,
        0.000000000000000,  -0.355799860841352, -0.292648016953448, 0.000000000000000,  -0.000000000000000, -0.251125357712230, -0.138916790163909,
        0.000000000000000,  -0.000000000000000, 1.099203132094980,  0.867499643862808,  0.000000000000000,  -0.000000000000000, -0.440377903901987,
        -0.813779412392196, 0.000000000000000,  -0.000000000000000, -0.695945141479175, -0.733137802641992, 0.000000000000000,  -0.000000000000000,
        0.174857418791841,  0.322954257530233,  -0.383016592220681, -0.528993459516099, -0.000000000000000, 0.000000000000000,  0.088811149346431,
        -0.118250655719984, 1.414213562373095,  0.652335286367939,  0.719863270982416,  0.549935491181765,  0.000000000000000,  -0.000000000000000,
        0.437724691924633,  0.232219697555826,  -0.000000000000000, 0.000000000000000,  0.345122946130968,  0.159965578306269,  -0.000000000000000,
        -0.000000000000000, -1.220044120878106, -0.700196663878445, -0.000000000000000, -0.000000000000000, 0.129255744378698,  0.250050432541201,
        -0.000000000000000, -0.000000000000000, 0.503894000542624,  0.442474832540106,  -0.000000000000000, -0.000000000000000, 0.138286435499723,
        0.181596690278147,  0.000000000000002,  -0.000000000000000, -0.609477403715365, -0.969999903565507, -0.000000000000000, 0.000000000000000,
        -0.263029610191561, -0.448876409465842, 0.652335286367939,  1.414213562373096,  0.353041366174256,  0.453007590760996,  0.000000000000000,
        -0.000000000000000, 0.111186116332123,  0.126693887445218,  0.000000000000000,  0.000000000000000,  0.067879880061173,  0.074401395959075,
        0.000000000000000,  -0.000000000000000, -0.356423474560626, -0.417663262506127, 0.000000000000000,  -0.000000000000000, 0.205135455678496,
        0.276439862783448,  0.000000000000000,  -0.000000000000000, 0.335943762166743,  0.465299413983352,  0.000000000000000,  -0.000000000000000,
        0.205037662228986,  0.324865783742676,  0.000000000000000,  -0.000000000000000, -1.414213562373094, -1.192330590038906, -0.088811149346431,
        0.263029610191561,  0.000000000000000,  -0.000000000000000, -0.535785174224440, -0.300157350701811, 1.870828693386970,  1.577305110908926,
        0.082114034359967,  0.236827317196696,  -0.000000000000000, -0.000000000000000, 0.136797710408643,  -0.110856973870339, -0.000000000000000,
        -0.000000000000000, -0.604341222196482, 0.234249777071221,  -0.000000000000000, -0.000000000000000, -0.433403004338091, -0.312718086682677,
        -0.000000000000000, -0.000000000000000, 0.794470036112983,  0.059342717943525,  -0.000000000000000, -0.000000000000000, 0.229173530749169,
        0.309316546866692,  -0.000000000000000, -0.000000000000000, 0.556855363655724,  0.340545878651953,  -1.192330590038906, -1.414213562373094,
        0.118250655719984,  0.448876409465842,  0.000000000000000,  0.000000000000000,  -0.482592209964627, -0.363341621571092, 1.577305110908926,
        1.870828693386970,  0.167444089727360,  0.421626105773293,  0.000000000000000,  -0.000000000000000, 0.031800221136378,  -0.236610168287296,
        0.000000000000000,  -0.000000000000000, 0.013811556852318,  0.410202692693969,  0.000000000000000,  -0.000000000000000, -0.279041368886230,
        -0.518098676201225, 0.000000000000000,  -0.000000000000000, 0.319986883336374,  -0.000036689531343, 0.000000000000000,  -0.000000000000000,
        0.230685093936257,  0.520473366734987,  0.000000000000000,  -0.000000000000000, 0.458756457051166,  0.469448338218317,  -0.046282815744493,
        -0.180860373187439, -1.414213562373095, -0.652335286367939, 0.535785174224440,  0.482592209964627,  -0.000000000000000, 0.000000000000000,
        -0.135370429526527, -0.306294046268563, 1.870828693386971,  0.862958469580835,  -0.134345070076157, -0.090927066995484, -0.000000000000000,
        -0.000000000000000, 0.375468072639992,  -0.039062678203161, -0.000000000000000, -0.000000000000000, 0.675836105399838,  0.387342802765227,
        0.000000000000000,  -0.000000000000000, -0.899120834933073, -0.515562356472760, -0.000000000000000, -0.000000000000000, -0.088269345766214,
        0.155374791478451,  0.000000000000001,  -0.000000000000000, -0.861345456591909, -0.716091097923918, -0.000000000000000, -0.000000000000000,
        -0.347497521063814, -0.630840455139150, -0.652335286367939, -1.414213562373096, 0.300157350701811,  0.363341621571092,  -0.000000000000000,
        0.000000000000000,  -0.400772089310257, -0.641808111921082, 0.862958469580835,  1.870828693386972,  -0.023352220674787, -0.009590344788887,
        0.000000000000000,  -0.000000000000000, -0.122212939049766, -0.183011646110583, 0.000000000000000,  -0.000000000000000, 0.235991392000366,
        0.307634389539070,  0.000000000000000,  -0.000000000000000, -0.274063456923940, -0.329881132351843, 0.000000000000000,  -0.000000000000000,
        0.297464950089260,  0.515253382687176,  0.000000000000000,  -0.000000000000000, -0.534930410545745, -0.739237815868858, 0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.719863270982416, -0.353041366174256, -1.870828693386970, -1.577305110908926,
        0.135370429526527,  0.400772089310257,  0.000000000000000,  -0.000000000000000, -0.569879742473144, -0.337901089002844, 2.121320343559642,
        1.788495885058360,  -0.328831474212862, -0.200814622150962, -0.000000000000000, -0.000000000000000, 0.824419404409842,  0.007840515866860,
        -0.000000000000000, -0.000000000000000, 0.090067882089972,  0.073428374910529,  -0.000000000000000, -0.000000000000000, -0.420488371328960,
        0.082203647982812,  -0.000000000000000, -0.000000000000000, -0.625848135148353, -0.264453116613111, -0.000000000000000, -0.000000000000000,
        0.486009604753385,  0.247923355457083,  0.000000000000000,  0.000000000000000,  -0.549935491181765, -0.453007590760996, -1.577305110908926,
        -1.870828693386970, 0.306294046268563,  0.641808111921082,  0.000000000000000,  0.000000000000000,  -0.403898015756135, -0.490883289191327,
        1.788495885058359,  2.121320343559643,  -0.303496863897236, -0.235267706734556, 0.000000000000000,  -0.000000000000000, 0.367378616088218,
        -0.147940629933656, 0.000000000000000,  -0.000000000000000, 0.187275207251803,  0.040834542892041,  0.000000000000000,  -0.000000000000000,
        -0.130370176649798, 0.220718792307251,  0.000000000000000,  -0.000000000000000, -0.458959516405721, -0.322861560196355, 0.000000000000000,
        -0.000000000000000, 0.376852108571020,  0.318992054121345,  1.071725522084303,  0.889731055482334,  -0.000000000000000, -0.000000000000000,
        -0.082114034359967, -0.167444089727360, -1.870828693386971, -0.862958469580835, 0.569879742473144,  0.403898015756135,  -0.000000000000000,
        0.000000000000000,  0.036350041698019,  -0.148516329379201, 2.121320343559643,  0.978502929551909,  -0.538260945891564, -0.170371505304270,
        0.000000000000000,  -0.000000000000000, 0.230879737948996,  -0.016243804322691, -0.000000000000000, -0.000000000000000, -0.087560676133107,
        -0.049261613402504, 0.000000000000001,  -0.000000000000000, 0.474237228256363,  0.258209730718961,  -0.000000000000000, -0.000000000000000,
        -0.597531256712323, -0.610829023172934, -0.000000000000000, -0.000000000000000, 0.687230922671101,  0.968105833019801,  0.000000000000000,
        0.000000000000000,  -0.236827317196696, -0.421626105773293, -0.862958469580835, -1.870828693386972, 0.337901089002844,  0.490883289191327,
        -0.000000000000000, 0.000000000000000,  -0.331390945825001, -0.574350519127127, 0.978502929551909,  2.121320343559645,  0.017394615262293,
        0.096382065592865,  0.000000000000000,  -0.000000000000000, -0.097177469831097, -0.172504777218965, 0.000000000000000,  -0.000000000000000,
        0.107452562147142,  0.249022510092507,  0.000000000000000,  -0.000000000000000, 0.063032241871518,  0.017654501330274,  0.000000000000000,
        -0.000000000000000, -0.582515827674177, -0.879593110150960, 0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.000000000000000,
        -0.437724691924633, -0.111186116332123, 0.000000000000000,  -0.000000000000000, 0.134345070076157,  0.023352220674787,  -2.121320343559642,
        -1.788495885058359, -0.036350041698019, 0.331390945825001,  0.000000000000000,  -0.000000000000000, 0.649514246425986,  0.039890955691739,
        -0.000000000000000, -0.000000000000000, -0.007840942021661, 0.065806091221887,  -0.000000000000000, -0.000000000000000, -0.201075938086866,
        -0.041670702359632, -0.000000000000000, -0.000000000000000, -0.058454992048271, -0.193815201244248, -0.000000000000000, -0.000000000000000,
        0.244541836770063,  0.206109744604050,  -0.000000000000000, -0.000000000000000, -0.692819785216480, -0.273849944895759, -0.000000000000000,
        -0.000000000000000, -0.232219697555826, -0.126693887445218, 0.000000000000000,  0.000000000000000,  0.090927066995484,  0.009590344788887,
        -1.788495885058360, -2.121320343559643, 0.148516329379201,  0.574350519127127,  0.000000000000000,  0.000000000000000,  0.308148334951872,
        -0.062348934611097, 0.000000000000000,  -0.000000000000000, 0.088288893429732,  0.070558108711502,  0.000000000000000,  -0.000000000000000,
        -0.255831539823993, 0.064773910119972,  0.000000000000000,  -0.000000000000000, -0.185880363149351, -0.277788941081522, 0.000000000000000,
        -0.000000000000000, 0.258324754987216,  0.286485683457814,  0.000000000000000,  -0.000000000000000, -0.479839746268918, -0.332976421711671,
        0.538920193051929,  0.355799860841352,  0.000000000000000,  -0.000000000000000, -0.136797710408643, -0.031800221136378, 0.000000000000000,
        -0.000000000000000, 0.328831474212862,  0.303496863897236,  -2.121320343559643, -0.978502929551909, -0.649514246425986, -0.308148334951872,
        -0.000000000000000, 0.000000000000000,  0.190965791190246,  0.075290342205465,  -0.000000000000000, -0.000000000000000, -0.204456433524318,
        -0.011760017481903, 0.000000000000000,  -0.000000000000000, 0.087382472633657,  0.125569329270920,  -0.000000000000000, -0.000000000000000,
        0.021942241586157,  -0.170120626275622, -0.000000000000000, -0.000000000000000, 1.009487180650430,  0.781918046704024,  -0.000000000000000,
        -0.000000000000000, 0.224331358825804,  0.292648016953448,  -0.000000000000000, -0.000000000000000, 0.110856973870339,  0.236610168287296,
        0.000000000000000,  0.000000000000000,  0.200814622150962,  0.235267706734556,  -0.978502929551909, -2.121320343559645, -0.039890955691739,
        0.062348934611097,  -0.000000000000000, 0.000000000000000,  -0.021992707563654, -0.073002997360826, 0.000000000000000,  -0.000000000000000,
        0.018219999895830,  0.025173442036973,  0.000000000000000,  -0.000000000000000, 0.124440963408793,  0.178356078178237,  0.000000000000000,
        -0.000000000000000, -0.308421758075393, -0.534762843130755, 0.000000000000000,  -0.000000000000000, 0.533636882172976,  0.710615123916257,
        0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.345122946130968, -0.067879880061173, 0.000000000000000,
        -0.000000000000000, -0.375468072639992, 0.122212939049766,  0.000000000000000,  -0.000000000000000, 0.538260945891564,  -0.017394615262293,
        0.000000000000000,  -0.000000000000000, -0.190965791190246, 0.021992707563654,  0.000000000000000,  -0.000000000000000, -0.000771680492253,
        0.027860284667594,  -3.162277660168380, -2.666132250979428, -0.008414722487685, 0.501333583553045,  -0.000000000000000, -0.000000000000000,
        -0.056273922762766, 0.052365178524413,  0.000000000000000,  -0.000000000000000, -0.375050155550073, -0.129312306262270, -0.000000000000000,
        -0.000000000000000, 0.964983646802442,  0.211407288157911,  0.000000000000000,  0.000000000000000,  -0.159965578306269, -0.074401395959075,
        0.000000000000000,  0.000000000000000,  0.039062678203161,  0.183011646110583,  0.000000000000000,  0.000000000000000,  0.170371505304270,
        -0.096382065592865, 0.000000000000000,  0.000000000000000,  -0.075290342205465, 0.073002997360826,  0.000000000000000,  0.000000000000000,
        0.130217508330432,  -0.028837107447908, -2.666132250979429, -3.162277660168380, 0.288014147252598,  0.824125562492874,  0.000000000000000,
        -0.000000000000000, 0.078992072347033,  0.049394205338330,  0.000000000000000,  0.000000000000001,  -0.230271214603987, -0.156099042971470,
        0.000000000000000,  -0.000000000000000, 0.476751782079464,  0.235556671897442,  0.497263776069473,  0.251125357712230,  0.000000000000000,
        -0.000000000000000, 0.604341222196482,  -0.013811556852318, 0.000000000000000,  -0.000000000000000, -0.824419404409842, -0.367378616088218,
        -0.000000000000000, -0.000000000000000, 0.007840942021661,  -0.088288893429732, 0.000000000000000,  -0.000000000000000, 0.000771680492253,
        -0.130217508330432, -0.000000000000000, 0.000000000000000,  0.156147588421043,  0.430049189266541,  -3.162277660168381, -1.458666044440505,
        -0.222223827311420, -0.199320072469577, -0.000000000000000, -0.000000000000000, 0.248005431113412,  0.166271686872239,  -0.000000000000000,
        0.000000000000000,  -1.298496461293278, -0.748095379174032, 0.000000000000000,  0.000000000000000,  0.119607921719242,  0.138916790163909,
        0.000000000000000,  0.000000000000000,  -0.234249777071221, -0.410202692693969, 0.000000000000000,  0.000000000000000,  -0.007840515866860,
        0.147940629933656,  0.000000000000000,  0.000000000000000,  -0.065806091221887, -0.070558108711502, 0.000000000000000,  0.000000000000000,
        -0.027860284667594, 0.028837107447908,  -0.000000000000000, 0.000000000000000,  0.479893250988390,  0.707466744087912,  -1.458666044440504,
        -3.162277660168383, -0.018190777390572, 0.070948871443493,  0.000000000000000,  -0.000000000000000, 0.134714675725592,  0.195377770236029,
        -0.000000000000000, 0.000000000000000,  -0.396847827482620, -0.480354971033624, -0.000000000000000, -0.000000000000000, 0.000000000000000,
        -0.000000000000000, 1.220044120878106,  0.356423474560626,  0.000000000000000,  -0.000000000000000, -0.675836105399838, -0.235991392000366,
        0.000000000000000,  -0.000000000000000, -0.230879737948996, 0.097177469831097,  0.000000000000000,  -0.000000000000000, 0.204456433524318,
        -0.018219999895830, 3.162277660168380,  2.666132250979429,  -0.156147588421043, -0.479893250988390, 0.000000000000000,  -0.000000000000000,
        0.371806186974619,  -0.074362170690645, -2.121320343559643, -1.788495885058359, -0.385710221241076, 0.366162044973854,  -0.000000000000000,
        -0.000000000000000, 0.686460249983050,  -0.018070426547569, 0.000000000000000,  -0.000000000000000, 0.188646176132711,  -0.016428694717347,
        0.000000000000000,  0.000000000000000,  0.700196663878445,  0.417663262506127,  0.000000000000000,  0.000000000000000,  -0.387342802765227,
        -0.307634389539070, 0.000000000000000,  0.000000000000000,  0.016243804322691,  0.172504777218965,  0.000000000000000,  0.000000000000000,
        0.011760017481903,  -0.025173442036973, 2.666132250979428,  3.162277660168380,  -0.430049189266541, -0.707466744087912, 0.000000000000000,
        0.000000000000000,  0.060370395146243,  -0.151338474372386, -1.788495885058359, -2.121320343559642, 0.120653240265366,  0.627557452632201,
        0.000000000000000,  -0.000000000000000, 0.171352114295651,  -0.075067577645160, 0.000000000000000,  -0.000000000000000, 0.023594682685588,
        -0.029756010327803, -1.671628870354717, -1.099203132094980, 0.000000000000000,  -0.000000000000000, 0.433403004338091,  0.279041368886230,
        -0.000000000000000, -0.000000000000000, -0.090067882089972, -0.187275207251803, 0.000000000000000,  -0.000000000000000, 0.201075938086866,
        0.255831539823993,  -0.000000000000000, -0.000000000000000, 0.008414722487685,  -0.288014147252598, 3.162277660168381,  1.458666044440504,
        -0.371806186974619, -0.060370395146243, -0.000000000000000, 0.000000000000000,  0.759238546401368,  0.427883769954927,  -2.121320343559644,
        -0.978502929551909, -0.838953578321518, -0.098332803137464, 0.000000000000000,  -0.000000000000000, -0.277410540071498, -0.017142763828147,
        0.000000000000000,  0.000000000000000,  -0.673854789823964, -0.867499643862808, 0.000000000000000,  0.000000000000000,  0.312718086682677,
        0.518098676201225,  0.000000000000000,  0.000000000000000,  -0.073428374910529, -0.040834542892041, 0.000000000000000,  0.000000000000000,
        0.041670702359632,  -0.064773910119972, 0.000000000000000,  0.000000000000000,  -0.501333583553045, -0.824125562492874, 1.458666044440505,
        3.162277660168383,  0.074362170690645,  0.151338474372386,  -0.000000000000000, 0.000000000000000,  0.205817173805983,  0.205270257668830,
        -0.978502929551909, -2.121320343559644, 0.224516007065232,  0.442504336558679,  0.000000000000000,  -0.000000000000000, 0.064939587633991,
        0.116499608280651,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, -0.129255744378698, -0.205135455678496,
        0.000000000000000,  -0.000000000000000, 0.899120834933073,  0.274063456923940,  0.000000000000000,  -0.000000000000000, 0.087560676133107,
        -0.107452562147142, 0.000000000000000,  -0.000000000000000, -0.087382472633657, -0.124440963408793, 0.000000000000000,  -0.000000000000000,
        0.222223827311420,  0.018190777390572,  2.121320343559643,  1.788495885058359,  -0.759238546401368, -0.205817173805983, 0.000000000000000,
        -0.000000000000000, -0.264238704311526, -0.260507129416020, -1.870828693386970, -1.577305110908926, 0.573446119895634,  0.425533218407253,
        -0.000000000000000, -0.000000000000000, -0.772500988748584, -0.359958152554195, 0.000000000000000,  0.000000000000000,  -0.250050432541201,
        -0.276439862783448, 0.000000000000000,  0.000000000000000,  0.515562356472760,  0.329881132351843,  0.000000000000000,  0.000000000000000,
        0.049261613402504,  -0.249022510092507, 0.000000000000000,  0.000000000000000,  -0.125569329270920, -0.178356078178237, 0.000000000000000,
        0.000000000000000,  0.199320072469577,  -0.070948871443493, 1.788495885058359,  2.121320343559642,  -0.427883769954927, -0.205270257668830,
        0.000000000000000,  0.000000000000000,  -0.314497204001713, -0.370037857158198, -1.577305110908926, -1.870828693386970, 0.414306926297186,
        0.662879314778410,  0.000000000000000,  -0.000000000000000, -0.569611773922669, -0.460009689706029, 0.163370950261310,  0.440377903901987,
        0.000000000000000,  -0.000000000000000, -0.794470036112983, -0.319986883336374, 0.000000000000000,  -0.000000000000000, 0.420488371328960,
        0.130370176649798,  -0.000000000000001, -0.000000000000000, 0.058454992048271,  0.185880363149351,  0.000000000000000,  -0.000000000000000,
        0.056273922762766,  -0.078992072347033, 0.000000000000000,  -0.000000000000000, 0.385710221241076,  -0.120653240265366, 2.121320343559644,
        0.978502929551909,  0.264238704311526,  0.314497204001713,  -0.000000000000000, 0.000000000000000,  -0.569876316267947, -0.276337712706068,
        -1.870828693386971, -0.862958469580835, 1.129676049614410,  0.914934345656760,  -0.000000000000000, -0.000000000000000, 0.519173064257113,
        0.813779412392196,  0.000000000000000,  0.000000000000000,  -0.059342717943525, 0.000036689531343,  0.000000000000000,  0.000000000000000,
        -0.082203647982812, -0.220718792307251, 0.000000000000000,  0.000000000000000,  0.193815201244248,  0.277788941081522,  0.000000000000000,
        0.000000000000000,  -0.052365178524413, -0.049394205338330, 0.000000000000000,  0.000000000000000,  -0.366162044973854, -0.627557452632201,
        0.978502929551909,  2.121320343559644,  0.260507129416020,  0.370037857158198,  -0.000000000000000, 0.000000000000000,  -0.245033032054129,
        -0.413909803672089, -0.862958469580835, -1.870828693386972, 0.697325347236137,  0.978903249979131,  0.000000000000000,  -0.000000000000000,
        0.000000000000000,  -0.000000000000000, -0.503894000542624, -0.335943762166743, 0.000000000000000,  -0.000000000000000, 0.088269345766214,
        -0.297464950089260, 0.000000000000000,  -0.000000000000000, -0.474237228256363, -0.063032241871518, 0.000000000000000,  -0.000000000000000,
        -0.021942241586157, 0.308421758075393,  -0.000000000000000, -0.000000000000000, -0.248005431113412, -0.134714675725592, 0.000000000000000,
        -0.000000000000000, 0.838953578321518,  -0.224516007065232, 1.870828693386970,  1.577305110908926,  0.569876316267947,  0.245033032054129,
        0.000000000000000,  -0.000000000000000, -0.565369901789358, -0.299421263487018, -1.414213562373095, -1.192330590038906, -0.208589703352695,
        0.252562842048393,  0.000000000000000,  0.000000000000000,  -0.442474832540106, -0.465299413983352, 0.000000000000000,  0.000000000000000,
        -0.155374791478451, -0.515253382687176, 0.000000000000000,  0.000000000000000,  -0.258209730718961, -0.017654501330274, 0.000000000000000,
        0.000000000000000,  0.170120626275622,  0.534762843130755,  0.000000000000000,  -0.000000000000001, -0.166271686872239, -0.195377770236029,
        0.000000000000000,  0.000000000000000,  0.098332803137464,  -0.442504336558679, 1.577305110908926,  1.870828693386970,  0.276337712706068,
        0.413909803672089,  0.000000000000000,  0.000000000000000,  -0.487173400986816, -0.361484151204019, -1.192330590038906, -1.414213562373094,
        0.081235220672177,  0.439449414587456,  0.800959361317251,  0.695945141479175,  0.000000000000000,  -0.000000000000000, -0.229173530749169,
        -0.230685093936257, -0.000000000000001, -0.000000000000000, 0.625848135148353,  0.458959516405721,  0.000000000000000,  -0.000000000000000,
        -0.244541836770063, -0.258324754987216, 0.000000000000000,  -0.000000000000000, 0.375050155550073,  0.230271214603987,  0.000000000000000,
        0.000000000000000,  -0.686460249983050, -0.171352114295651, -0.000000000000000, -0.000000000000000, -0.573446119895634, -0.414306926297186,
        1.870828693386971,  0.862958469580835,  0.565369901789358,  0.487173400986816,  -0.000000000000000, 0.000000000000000,  0.086958729369020,
        -0.135892859016606, -1.414213562373096, -0.652335286367939, 0.528581796889527,  0.733137802641992,  0.000000000000000,  0.000000000000000,
        -0.309316546866692, -0.520473366734987, 0.000000000000000,  0.000000000000000,  0.264453116613111,  0.322861560196355,  0.000000000000000,
        0.000000000000000,  -0.206109744604050, -0.286485683457814, 0.000000000000000,  0.000000000000000,  0.129312306262270,  0.156099042971470,
        -0.000000000000000, -0.000000000000000, 0.018070426547569,  0.075067577645160,  0.000000000000000,  0.000000000000000,  -0.425533218407253,
        -0.662879314778410, 0.862958469580835,  1.870828693386972,  0.299421263487018,  0.361484151204019,  -0.000000000000000, 0.000000000000000,
        -0.333204215234005, -0.617054684408959, -0.652335286367939, -1.414213562373096, 0.000000000000000,  -0.000000000000000, -0.138286435499723,
        -0.205037662228986, 0.000000000000000,  -0.000000000000000, 0.861345456591909,  0.534930410545745,  0.000000000000000,  -0.000000000000000,
        0.597531256712323,  0.582515827674177,  0.000000000000000,  -0.000000000000000, -1.009487180650430, -0.533636882172976, 0.000000000000000,
        -0.000000000000000, 1.298496461293278,  0.396847827482620,  -0.000000000000000, -0.000000000000000, 0.277410540071498,  -0.064939587633991,
        0.000000000000000,  -0.000000000000000, -1.129676049614410, -0.697325347236137, 1.414213562373095,  1.192330590038906,  -0.086958729369020,
        0.333204215234005,  0.000000000000000,  -0.000000000000000, 0.351947604405612,  0.606452589153232,  0.000000000000000,  0.000000000000000,
        -0.181596690278147, -0.324865783742676, 0.000000000000000,  0.000000000000000,  0.716091097923918,  0.739237815868858,  0.000000000000000,
        0.000000000000000,  0.610829023172934,  0.879593110150960,  0.000000000000000,  0.000000000000000,  -0.781918046704024, -0.710615123916257,
        0.000000000000000,  0.000000000000000,  0.748095379174032,  0.480354971033624,  0.000000000000000,  0.000000000000000,  0.017142763828147,
        -0.116499608280651, 0.000000000000000,  0.000000000000000,  -0.914934345656760, -0.978903249979131, 1.192330590038906,  1.414213562373094,
        0.135892859016606,  0.617054684408959,  0.000000000000000,  0.000000000000000,  0.518959455192100,  0.967166036668099,  -0.117534873343215,
        -0.174857418791841, -0.000000000000002, -0.000000000000000, -0.556855363655724, -0.458756457051166, 0.000000000000000,  -0.000000000000000,
        -0.486009604753385, -0.376852108571020, 0.000000000000000,  -0.000000000000000, 0.692819785216480,  0.479839746268918,  0.000000000000000,
        -0.000000000000000, -0.964983646802442, -0.476751782079464, -0.000000000000000, 0.000000000000000,  -0.188646176132711, -0.023594682685588,
        -0.000000000000000, -0.000000000000000, 0.772500988748584,  0.569611773922669,  0.000000000000000,  -0.000000000000000, 0.208589703352695,
        -0.081235220672177, 1.414213562373096,  0.652335286367939,  -0.351947604405612, -0.518959455192100, -0.000000000000000, 0.000000000000000,
        -0.202999677475696, -0.322954257530233, 0.000000000000000,  0.000000000000000,  -0.340545878651953, -0.469448338218317, 0.000000000000000,
        0.000000000000000,  -0.247923355457083, -0.318992054121345, 0.000000000000000,  0.000000000000000,  0.273849944895759,  0.332976421711671,
        0.000000000000000,  0.000000000000000,  -0.211407288157911, -0.235556671897442, -0.000000000000000, 0.000000000000000,  0.016428694717347,
        0.029756010327803,  -0.000000000000000, 0.000000000000000,  0.359958152554195,  0.460009689706029,  0.000000000000000,  0.000000000000000,
        -0.252562842048393, -0.439449414587456, 0.652335286367939,  1.414213562373096,  -0.606452589153232, -0.967166036668099, -0.000000000000000,
        0.000000000000000};

    ASSERT_EQ(amomymat, CDenseMatrix(intyvals, 36, 36));

    std::vector<double> intzvals{
        0.000000000000000,  -0.000000000000000, -0.066997921534503, -0.129215149375707, -0.000000000000000, -0.000000000000000, 0.131117207573841,
        0.156695807055138,  -0.000000000000000, -0.000000000000000, 0.396581944406314,  0.214537369318687,  -0.000000000000000, -0.000000000000000,
        0.240418936357769,  0.044507084708527,  0.000000000000000,  0.000000000000000,  0.506403461664993,  0.124234217592622,  -0.000000000000000,
        -0.000000000000000, -0.783306816387657, -0.288736019488476, -0.000000000000000, -0.000000000000000, -0.026945158243179, 0.104966880418035,
        -0.000000000000000, -0.000000000000000, 0.028415225879751,  -0.052115780976145, 4.000000000000001,  3.372420182530673,  -0.220103582108927,
        0.080487977536275,  0.000000000000000,  0.000000000000000,  -0.102002183639150, -0.210943135448069, 0.000000000000000,  -0.000000000000000,
        0.162663792415912,  0.234989890172850,  0.000000000000000,  -0.000000000000000, 0.301936670883574,  0.292516001074648,  0.000000000000000,
        -0.000000000000000, 0.106296767118238,  0.048845481588875,  0.000000000000000,  -0.000000000000000, 0.259896098126855,  0.144200844517208,
        0.000000000000000,  -0.000000000000000, -0.497596972582505, -0.361732494670047, 0.000000000000000,  0.000000000000000,  0.083023194009248,
        0.161730119256912,  0.000000000000000,  -0.000000000000000, -0.003686495882480, -0.104295918691176, 3.372420182530672,  3.999999999999999,
        -0.131467091466029, 0.278041101261747,  0.066997921534503,  0.102002183639150,  0.000000000000000,  -0.000000000000000, 0.503681998397611,
        0.720055694506974,  -0.000000000000000, -0.000000000000000, -1.368892611733205, -1.123917851133438, -0.000000000000000, 0.000000000000000,
        -0.201460892460601, -0.061870222558397, -0.000000000000000, -0.000000000000000, -0.780441555148607, -0.404262882812576, 0.000000000000000,
        0.000000000000000,  1.438824924785105,  0.924640951831019,  -0.000000000000000, -0.000000000000000, -0.356120647384377, -0.417262993681833,
        -0.000000000000000, -0.000000000000000, -0.448033156379870, -0.583636436157216, -0.000000000000000, -0.000000000000000, -0.223918616109647,
        -0.132773555186305, 4.000000000000002,  1.845082818392153,  0.129215149375707,  0.210943135448069,  0.000000000000000,  0.000000000000000,
        0.853308050163476,  1.368435590692075,  0.000000000000000,  -0.000000000000000, -0.836175078742207, -1.155679168200896, -0.000000000000000,
        -0.000000000000000, -0.010993464610020, -0.003663052371807, 0.000000000000000,  -0.000000000000000, -0.194465409863835, -0.226217553107111,
        0.000000000000000,  -0.000000000000000, 0.541162258905728,  0.679965354441353,  0.000000000000000,  -0.000000000000000, -0.361048068167848,
        -0.518390285628378, 0.000000000000000,  0.000000000000000,  -0.620871415309335, -0.964327704200053, 0.000000000000000,  -0.000000000000000,
        0.080081423396909,  0.277655846924993,  1.845082818392154,  4.000000000000004,  0.000000000000000,  -0.000000000000000, -0.503681998397611,
        -0.853308050163476, 0.000000000000000,  -0.000000000000000, 0.147126452829997,  0.042758718445294,  -0.000000000000000, -0.000000000000000,
        0.165297565366916,  -0.005674400165191, -0.000000000000000, -0.000000000000000, 0.077783584845664,  0.070183387398575,  -0.000000000000000,
        -0.000000000000000, 0.391713542183151,  -0.111431429377634, 0.000000000000000,  -0.000000000000000, 0.175477523581471,  0.044914063926174,
        -0.000000000000000, -0.000000000000000, -0.148817701268140, -0.012472096767705, 2.999999999999998,  2.529315136898003,  0.047836338012717,
        -0.061141350221305, -0.000000000000000, -0.000000000000000, -0.532073479152205, -0.628968722714159, 0.000000000000000,  0.000000000000000,
        -0.720055694506974, -1.368435590692075, 0.000000000000000,  0.000000000000000,  0.106168549574449,  0.032354585246380,  0.000000000000000,
        -0.000000000000000, 0.030510367807335,  -0.018774164829144, 0.000000000000000,  -0.000000000000000, 0.044747925420661,  0.123737925131943,
        0.000000000000000,  -0.000000000000000, 0.007243069296955,  -0.191505676308763, 0.000000000000000,  -0.000000000000001, 0.054118644076330,
        0.075176797103210,  0.000000000000000,  -0.000000000000000, -0.043479887373420, -0.015007306656138, 2.529315136898003,  2.999999999999999,
        -0.032496076369139, -0.067072584022524, 0.000000000000000,  -0.000000000000000, -0.610598725175594, -0.971903329908690, -0.131117207573841,
        -0.162663792415912, 0.000000000000000,  -0.000000000000000, -0.147126452829997, -0.106168549574449, 0.000000000000000,  -0.000000000000000,
        -0.336640157058257, 0.004958639058935,  -0.000000000000000, -0.000000000000000, 0.061772695205251,  -0.062894607687410, 0.000000000000000,
        0.000000000000000,  -0.579389867969301, -0.011452454623508, -0.000000000000000, -0.000000000000000, -0.144678615344122, -0.066588317538985,
        0.000000000000000,  -0.000000000000000, 0.254827062838155,  0.017941467805997,  -0.000000000000000, -0.000000000000000, 0.298071220885938,
        0.027946134033095,  2.999999999999999,  1.383812113794114,  0.107524159129645,  0.021683107924365,  -0.000000000000000, -0.000000000000000,
        -0.156695807055138, -0.234989890172850, 0.000000000000000,  0.000000000000000,  -0.042758718445294, -0.032354585246380, 0.000000000000000,
        0.000000000000000,  0.270677196172094,  0.536946593168921,  0.000000000000000,  -0.000000000000000, -0.183994019695643, -0.332995447933096,
        -0.000000000000000, -0.000000000000000, 0.163354943990928,  0.280845139356103,  0.000000000000000,  -0.000000000000000, -0.090781649353119,
        -0.158699862717135, -0.000000000000000, -0.000000000000001, -0.164464692700945, -0.330528686105524, 0.000000000000000,  -0.000000000000000,
        -0.051118868954573, -0.062138810766169, 1.383812113794114,  3.000000000000001,  -0.044498607118694, -0.097170120005654, 0.000000000000000,
        -0.000000000000000, 0.000000000000000,  -0.000000000000000, 1.368892611733205,  0.836175078742207,  0.000000000000000,  -0.000000000000000,
        0.336640157058257,  -0.270677196172094, 0.000000000000000,  -0.000000000000000, 0.245251035024386,  0.069742527418433,  -0.000000000000000,
        -0.000000000000000, 0.086158065615459,  0.002245822931852,  -0.000000000000000, -0.000000000000000, -0.170517808920663, -0.023536557509322,
        -0.000000000000000, -0.000000000000000, 0.052890569058848,  0.033981237157035,  2.000000000000000,  1.686210091265336,  -0.064857208165821,
        -0.218064359370796, -0.000000000000000, -0.000000000000000, 0.110307913137726,  -0.169269467740412, -0.000000000000000, -0.000000000000000,
        -0.680385371024889, -0.404448437774544, 0.000000000000000,  0.000000000000000,  1.123917851133438,  1.155679168200896,  0.000000000000000,
        0.000000000000000,  -0.004958639058935, -0.536946593168921, 0.000000000000000,  0.000000000000000,  0.122294859772660,  0.082407349955834,
        0.000000000000000,  -0.000000000000000, 0.055554933516412,  -0.023984243714038, 0.000000000000000,  -0.000000000000000, -0.106092776925284,
        0.006042267080252,  0.000000000000000,  -0.000000000000000, 0.010844869133000,  0.063651007444991,  1.686210091265335,  1.999999999999999,
        -0.197818707706720, -0.318707861493512, 0.000000000000000,  -0.000000000000000, -0.016454783559692, -0.331913588581056, 0.000000000000000,
        -0.000000000000000, -0.539024967814461, -0.562665702503846, -0.396581944406314, -0.301936670883574, 0.000000000000000,  0.000000000000000,
        -0.165297565366916, -0.030510367807335, 0.000000000000000,  -0.000000000000000, -0.245251035024386, -0.122294859772660, 0.000000000000000,
        -0.000000000000000, -0.361704540029245, -0.202743223968652, -0.000000000000000, -0.000000000000000, 0.216592118737989,  0.137639068629950,
        -0.000000000000000, -0.000000000000000, 0.119963637589634,  0.083880606163757,  -0.000000000000000, -0.000000000000000, -0.340645629156944,
        -0.271617439638736, 2.000000000000001,  0.922541409196076,  -0.011564653108922, -0.010756640564027, -0.000000000000000, -0.000000000000000,
        0.259588888462726,  0.190672941178443,  -0.000000000000000, 0.000000000000000,  -0.214537369318687, -0.292516001074648, -0.000000000000000,
        0.000000000000000,  0.005674400165191,  0.018774164829144,  0.000000000000000,  0.000000000000000,  -0.069742527418433, -0.082407349955834,
        0.000000000000000,  0.000000000000000,  -0.007884144678400, 0.083108369276668,  0.000000000000000,  -0.000000000000000, 0.027717096358107,
        -0.013788313500422, 0.000000000000000,  -0.000000000000000, -0.033723810614887, -0.108659664630960, 0.000000000000000,  -0.000000000000000,
        -0.260686851484378, -0.379602384563969, 0.922541409196076,  2.000000000000001,  -0.007904478056356, -0.013699942431481, 0.000000000000000,
        -0.000000000000000, 0.143348966513956,  0.200890412692718,  -0.000000000000000, -0.000000000000000, 0.000000000000000,  -0.000000000000000,
        0.201460892460601,  0.010993464610020,  0.000000000000000,  -0.000000000000000, -0.061772695205251, 0.183994019695643,  0.000000000000000,
        -0.000000000000000, 0.361704540029245,  0.007884144678400,  0.000000000000000,  -0.000000000000000, -0.122334700022551, -0.029171440356504,
        -0.000000000000000, -0.000000000000000, -0.010903595102512, -0.002222482415297, 1.000000000000000,  0.843105045632668,  0.001878842285913,
        -0.116424169786989, -0.000000000000000, -0.000000000000000, 0.318267725682202,  0.033176484573919,  -0.000000000000000, -0.000000000000000,
        0.349623506404567,  -0.117084893600483, -0.000000000000000, -0.000000000000000, 1.192735593481285,  0.494467226044512,  0.000000000000000,
        0.000000000000000,  0.061870222558397,  0.003663052371807,  0.000000000000000,  0.000000000000000,  0.062894607687410,  0.332995447933096,
        0.000000000000000,  0.000000000000000,  0.202743223968652,  -0.083108369276668, 0.000000000000000,  0.000000000000000,  -0.097310002538616,
        -0.006231450095151, 0.000000000000000,  -0.000000000000000, -0.019564748293727, 0.006970538830707,  0.843105045632668,  1.000000000000000,
        -0.040070868594210, -0.211938168185911, 0.000000000000000,  -0.000000000000000, 0.146441073263745,  -0.001128410516616, 0.000000000000000,
        -0.000000000000000, 0.021271792929566,  -0.221433236104351, 0.000000000000000,  -0.000000000000000, 0.812350234054537,  0.629289948289318,
        -0.240418936357769, -0.106296767118238, 0.000000000000000,  -0.000000000000000, -0.077783584845664, -0.044747925420661, -0.000000000000000,
        0.000000000000000,  -0.086158065615459, -0.055554933516412, 0.000000000000000,  -0.000000000000000, 0.122334700022551,  0.097310002538616,
        0.000000000000000,  -0.000000000000000, 0.013517839083528,  0.031866849749247,  -0.000000000000000, -0.000000000000000, -0.044365474222472,
        -0.175127412558915, 1.000000000000000,  0.461270704598038,  -0.120473600224089, -0.043895479122761, -0.000000000000000, -0.000000000000000,
        -0.224488497521421, -0.016810505629043, -0.000000000000000, -0.000000000000000, -0.572310366083100, -0.400682481776965, -0.000000000000000,
        -0.000000000000000, -0.044507084708527, -0.048845481588875, 0.000000000000000,  0.000000000000000,  -0.070183387398575, -0.123737925131943,
        -0.000000000000000, 0.000000000000000,  -0.002245822931852, 0.023984243714038,  0.000000000000000,  0.000000000000000,  0.029171440356504,
        0.006231450095151,  0.000000000000000,  0.000000000000000,  0.005250417105831,  -0.008680858370033, 0.000000000000000,  -0.000000000000000,
        -0.183009075072589, -0.258556083581947, 0.461270704598038,  1.000000000000001,  -0.024865712400671, -0.031017327670990, 0.000000000000000,
        -0.000000000000000, 0.065858819702335,  0.125259715490424,  0.000000000000000,  -0.000000000000001, -0.248279472263627, -0.317769685665260,
        0.000000000000000,  -0.000000000000000, -0.000000000000000, -0.000000000000000, 0.780441555148607,  0.194465409863835,  0.000000000000000,
        -0.000000000000000, 0.579389867969301,  -0.163354943990928, 0.000000000000000,  -0.000000000000000, -0.216592118737989, -0.027717096358107,
        0.000000000000000,  -0.000000000000000, -0.013517839083528, -0.005250417105831, 0.000000000000000,  -0.000000000000000, 0.067679083699699,
        0.020880792491406,  -0.000000000000000, -0.000000000000000, 0.008416400484427,  0.016685953199672,  -0.000000000000000, -0.000000000000000,
        -0.309063968942658, -0.024682546540252, -0.000000000000000, -0.000000000000000, 0.103147347080513,  -0.012907964495324, -0.000000000000000,
        -0.000000000000000, -0.912509439277354, -0.239362220428038, -0.000000000000000, 0.000000000000000,  0.404262882812576,  0.226217553107111,
        0.000000000000000,  0.000000000000000,  0.011452454623508,  -0.280845139356103, 0.000000000000000,  0.000000000000000,  -0.137639068629950,
        0.013788313500422,  0.000000000000000,  0.000000000000000,  -0.031866849749247, 0.008680858370033,  0.000000000000000,  0.000000000000000,
        0.050786268186464,  0.014406172728138,  0.000000000000000,  -0.000000000000000, 0.060769443203969,  -0.005614891348818, 0.000000000000000,
        -0.000000000000000, -0.216051582844630, 0.061387271682967,  0.000000000000000,  -0.000000000000000, 0.010198190396494,  -0.023348925899763,
        0.000000000000000,  -0.000000000000000, -0.487548064052680, -0.280403472081992, -0.506403461664993, -0.259896098126855, -0.000000000000000,
        -0.000000000000000, -0.391713542183151, -0.007243069296955, 0.000000000000000,  -0.000000000000000, 0.170517808920663,  0.106092776925284,
        0.000000000000000,  -0.000000000000000, 0.010903595102512,  0.019564748293727,  0.000000000000000,  -0.000000000000000, -0.067679083699699,
        -0.050786268186464, 0.000000000000000,  -0.000000000000000, -0.004495034512902, -0.042316291020689, -0.000000000000000, -0.000000000000000,
        0.198485625381077,  0.140340482753430,  0.000000000000000,  0.000000000000000,  -0.066428065948440, -0.009374615006517, -0.000000000000000,
        -0.000000000000000, 0.636168504672029,  0.341968113109095,  -0.000000000000000, -0.000000000000000, -0.124234217592622, -0.144200844517208,
        -0.000000000000000, 0.000000000000000,  0.111431429377634,  0.191505676308763,  0.000000000000000,  0.000000000000000,  0.023536557509322,
        -0.006042267080252, 0.000000000000000,  0.000000000000000,  0.002222482415297,  -0.006970538830707, 0.000000000000000,  0.000000000000000,
        -0.020880792491406, -0.014406172728138, 0.000000000000000,  0.000000000000000,  -0.012144051163871, 0.003049412039829,  0.000000000000000,
        -0.000000000000000, 0.014649253303169,  -0.042796760274558, -0.000000000000000, -0.000000000000000, 0.002749015984028,  0.005869465738327,
        0.000000000000000,  -0.000000000000000, 0.168540850070513,  0.197697547453519,  0.000000000000000,  -0.000000000000000, 0.000000000000000,
        -0.000000000000000, -1.438824924785105, -0.541162258905728, -0.000000000000000, -0.000000000000000, 0.144678615344122,  0.090781649353119,
        0.000000000000000,  -0.000000000000000, -0.119963637589634, 0.033723810614887,  -1.000000000000000, -0.843105045632668, 0.044365474222472,
        0.183009075072589,  0.000000000000000,  -0.000000000000000, 0.004495034512902,  0.012144051163871,  0.000000000000000,  -0.000000000000000,
        0.110261703050602,  0.069981559841408,  -0.000000000000000, -0.000000000000000, 0.437494640103393,  0.017709324455356,  -0.000000000000000,
        -0.000000000000000, -0.638350707680721, 0.218504229590514,  -0.000000000000000, -0.000000000000000, -0.606034841938885, -0.131953258977651,
        0.000000000000000,  0.000000000000000,  -0.924640951831019, -0.679965354441353, 0.000000000000000,  0.000000000000001,  0.066588317538985,
        0.158699862717135,  0.000000000000000,  0.000000000000000,  -0.083880606163757, 0.108659664630960,  -0.843105045632668, -1.000000000000000,
        0.175127412558915,  0.258556083581947,  0.000000000000000,  0.000000000000000,  0.042316291020689,  -0.003049412039829, 0.000000000000000,
        0.000000000000000,  0.164984944945847,  0.040423140893770,  0.000000000000000,  -0.000000000000000, 0.224562694201917,  -0.070876411447142,
        0.000000000000000,  -0.000000000000000, -0.041434247649594, 0.413837314014091,  0.000000000000000,  -0.000000000000000, -0.291028117651467,
        -0.150059105120654, 0.783306816387657,  0.497596972582505,  0.000000000000000,  -0.000000000000000, -0.175477523581471, -0.054118644076330,
        -0.000000000000000, 0.000000000000000,  -0.052890569058848, -0.010844869133000, 0.000000000000000,  -0.000000000000000, -0.001878842285913,
        0.040070868594210,  -1.000000000000000, -0.461270704598038, -0.008416400484427, -0.060769443203969, 0.000000000000000,  -0.000000000000000,
        -0.110261703050602, -0.164984944945847, 0.000000000000000,  -0.000000000000000, -0.157068616357288, -0.075844380497545, -0.000000000000000,
        -0.000000000000000, 0.403665586642449,  0.042507692171962,  -0.000000000000000, 0.000000000000000,  0.395351798397778,  0.171358888651855,
        -0.000000000000000, -0.000000000000000, 0.288736019488476,  0.361732494670047,  0.000000000000000,  0.000000000000000,  -0.044914063926174,
        -0.075176797103210, 0.000000000000000,  0.000000000000001,  -0.033981237157035, -0.063651007444991, 0.000000000000000,  0.000000000000000,
        0.116424169786989,  0.211938168185911,  -0.461270704598038, -1.000000000000001, -0.016685953199672, 0.005614891348818,  0.000000000000000,
        0.000000000000000,  -0.069981559841408, -0.040423140893770, 0.000000000000000,  0.000000000000000,  -0.010495348128810, 0.014268943949408,
        0.000000000000000,  -0.000000000000000, -0.099290079507358, -0.191823029868398, -0.000000000000000, -0.000000000000000, 0.067911967363479,
        0.072028966912543,  0.000000000000000,  -0.000000000000000, 0.000000000000000,  -0.000000000000000, 0.356120647384377,  0.361048068167848,
        0.000000000000000,  -0.000000000000000, -0.254827062838155, 0.164464692700945,  -2.000000000000000, -1.686210091265335, 0.340645629156944,
        0.260686851484378,  0.000000000000000,  -0.000000000000000, 0.120473600224089,  0.024865712400671,  0.000000000000000,  -0.000000000000000,
        -0.198485625381077, -0.014649253303169, 0.000000000000000,  -0.000000000000000, 0.157068616357288,  0.010495348128810,  0.000000000000000,
        -0.000000000000000, -0.060826406746258, 0.018636019432172,  -0.000000000000000, -0.000000000000000, -0.129607706858109, -0.285876981117586,
        -0.000000000000000, -0.000000000000000, 1.276236083722471,  0.824520677438279,  0.000000000000000,  -0.000000000000000, 0.417262993681833,
        0.518390285628378,  0.000000000000000,  0.000000000000000,  -0.017941467805997, 0.330528686105524,  -1.686210091265336, -1.999999999999999,
        0.271617439638736,  0.379602384563969,  0.000000000000000,  0.000000000000000,  0.043895479122761,  0.031017327670990,  0.000000000000000,
        0.000000000000000,  -0.140340482753430, 0.042796760274558,  0.000000000000000,  0.000000000000000,  0.075844380497545,  -0.014268943949408,
        0.000000000000000,  0.000000000000000,  0.040664418453742,  0.007050335283221,  0.000000000000000,  -0.000000000000000, -0.112082139892447,
        -0.541954176009931, 0.000000000000000,  -0.000000000000000, 1.090438655613262,  1.143892110687384,  0.026945158243179,  -0.083023194009248,
        0.000000000000000,  -0.000000000000000, 0.148817701268140,  0.043479887373420,  0.000000000000000,  -0.000000000000000, 0.064857208165821,
        0.197818707706720,  -2.000000000000001, -0.922541409196076, -0.318267725682202, -0.146441073263745, 0.000000000000000,  -0.000000000000000,
        0.309063968942658,  0.216051582844630,  -0.000000000000000, 0.000000000000000,  -0.437494640103393, -0.224562694201917, 0.000000000000000,
        -0.000000000000000, 0.060826406746258,  -0.040664418453742, 0.000000000000000,  -0.000000000000000, 0.265394047564997,  0.068426381222005,
        -0.000000000000000, -0.000000000000000, -0.319277259394035, -0.274199452722476, 0.000000000000000,  0.000000000000000,  -0.104966880418035,
        -0.161730119256912, 0.000000000000000,  -0.000000000000000, 0.012472096767705,  0.015007306656138,  0.000000000000000,  0.000000000000000,
        0.218064359370796,  0.318707861493512,  -0.922541409196076, -2.000000000000001, -0.033176484573919, 0.001128410516616,  0.000000000000000,
        0.000000000000000,  0.024682546540252,  -0.061387271682967, -0.000000000000000, 0.000000000000000,  -0.017709324455356, 0.070876411447142,
        0.000000000000000,  0.000000000000000,  -0.018636019432172, -0.007050335283221, 0.000000000000000,  0.000000000000000,  0.019713674226363,
        0.023402318688409,  0.000000000000000,  -0.000000000000000, -0.204924805236835, -0.282810182975406, -0.000000000000000, -0.000000000000000,
        0.000000000000000,  -0.000000000000000, 0.448033156379870,  0.620871415309335,  -2.999999999999998, -2.529315136898003, -0.298071220885938,
        0.051118868954573,  0.000000000000000,  -0.000000000000000, 0.011564653108922,  0.007904478056356,  0.000000000000000,  -0.000000000000000,
        0.224488497521421,  -0.065858819702335, 0.000000000000000,  -0.000000000000000, 0.066428065948440,  -0.002749015984028, 0.000000000000000,
        -0.000000000000000, -0.403665586642449, 0.099290079507358,  0.000000000000000,  -0.000000000000000, -0.265394047564997, -0.019713674226363,
        0.000000000000000,  -0.000000000000000, 0.077912058115356,  0.040168203514165,  -0.000000000000000, -0.000000000000000, -0.430751977706996,
        -0.846082037900585, 0.000000000000000,  0.000000000000000,  0.583636436157216,  0.964327704200053,  -2.529315136898003, -2.999999999999999,
        -0.027946134033095, 0.062138810766169,  0.000000000000000,  0.000000000000000,  0.010756640564027,  0.013699942431481,  0.000000000000000,
        0.000000000000000,  0.016810505629043,  -0.125259715490424, 0.000000000000000,  0.000000000000000,  0.009374615006517,  -0.005869465738327,
        0.000000000000000,  0.000000000000000,  -0.042507692171962, 0.191823029868398,  0.000000000000000,  0.000000000000000,  -0.068426381222005,
        -0.023402318688409, 0.000000000000000,  0.000000000000000,  0.090171564460340,  0.031092516977682,  0.000000000000000,  -0.000000000000000,
        -0.696236231127891, -1.361650118750675, -0.028415225879751, 0.003686495882480,  0.000000000000000,  -0.000000000000000, -0.047836338012717,
        0.032496076369139,  -2.999999999999999, -1.383812113794114, -0.110307913137726, 0.016454783559692,  0.000000000000000,  -0.000000000000000,
        -0.349623506404567, -0.021271792929566, 0.000000000000000,  -0.000000000000000, -0.103147347080513, -0.010198190396494, 0.000000000000000,
        -0.000000000000000, 0.638350707680721,  0.041434247649594,  0.000000000000000,  0.000000000000000,  0.129607706858109,  0.112082139892447,
        0.000000000000000,  -0.000000000000000, -0.077912058115356, -0.090171564460340, 0.000000000000000,  -0.000000000000000, -0.200699692105569,
        -0.185402105885609, -0.000000000000000, -0.000000000000000, 0.052115780976145,  0.104295918691176,  0.000000000000000,  0.000000000000000,
        0.061141350221305,  0.067072584022524,  -1.383812113794114, -3.000000000000001, 0.169269467740412,  0.331913588581056,  0.000000000000000,
        0.000000000000000,  0.117084893600483,  0.221433236104351,  0.000000000000000,  0.000000000000001,  0.012907964495324,  0.023348925899763,
        0.000000000000000,  0.000000000000000,  -0.218504229590514, -0.413837314014091, -0.000000000000000, 0.000000000000000,  0.285876981117586,
        0.541954176009931,  0.000000000000000,  0.000000000000000,  -0.040168203514165, -0.031092516977682, 0.000000000000000,  0.000000000000000,
        -0.163595894058302, -0.241470009592761, 0.000000000000000,  -0.000000000000000, -4.000000000000001, -3.372420182530672, 0.223918616109647,
        -0.080081423396909, 0.000000000000000,  -0.000000000000000, -0.107524159129645, 0.044498607118694,  0.000000000000000,  -0.000000000000000,
        -0.259588888462726, -0.143348966513956, 0.000000000000000,  -0.000000000000000, 0.572310366083100,  0.248279472263627,  0.000000000000000,
        -0.000000000000000, -0.636168504672029, -0.168540850070513, 0.000000000000000,  -0.000000000000000, -0.395351798397778, -0.067911967363479,
        0.000000000000000,  -0.000000000000000, 0.319277259394035,  0.204924805236835,  0.000000000000000,  -0.000000000000000, 0.200699692105569,
        0.163595894058302,  0.000000000000000,  -0.000000000000000, -0.038550157889079, -0.126445691269847, -3.372420182530673, -3.999999999999999,
        0.132773555186305,  -0.277655846924993, 0.000000000000000,  0.000000000000000,  -0.021683107924365, 0.097170120005654,  0.000000000000000,
        0.000000000000000,  -0.190672941178443, -0.200890412692718, 0.000000000000000,  0.000000000000000,  0.400682481776965,  0.317769685665260,
        0.000000000000000,  0.000000000000000,  -0.341968113109095, -0.197697547453519, 0.000000000000000,  0.000000000000000,  -0.171358888651855,
        -0.072028966912543, 0.000000000000000,  0.000000000000000,  0.274199452722476,  0.282810182975406,  0.000000000000000,  0.000000000000000,
        0.185402105885609,  0.241470009592761,  0.000000000000000,  0.000000000000000,  -0.092815064070643, -0.208348524896961, 0.220103582108927,
        0.131467091466029,  -4.000000000000002, -1.845082818392154, 0.532073479152205,  0.610598725175594,  0.000000000000000,  -0.000000000000000,
        0.680385371024889,  0.539024967814461,  0.000000000000000,  0.000000000000000,  -1.192735593481285, -0.812350234054537, 0.000000000000000,
        -0.000000000000000, 0.912509439277354,  0.487548064052680,  0.000000000000000,  -0.000000000000000, 0.606034841938885,  0.291028117651467,
        0.000000000000000,  -0.000000000000000, -1.276236083722471, -1.090438655613262, -0.000000000000000, 0.000000000000000,  0.430751977706996,
        0.696236231127891,  0.000000000000000,  -0.000000000000000, 0.038550157889079,  0.092815064070643,  0.000000000000000,  -0.000000000000000,
        -0.080487977536275, -0.278041101261747, -1.845082818392153, -4.000000000000004, 0.628968722714159,  0.971903329908690,  0.000000000000000,
        0.000000000000000,  0.404448437774544,  0.562665702503846,  -0.000000000000000, 0.000000000000000,  -0.494467226044512, -0.629289948289318,
        0.000000000000000,  0.000000000000000,  0.239362220428038,  0.280403472081992,  0.000000000000000,  0.000000000000000,  0.131953258977651,
        0.150059105120654,  0.000000000000000,  0.000000000000000,  -0.824520677438279, -1.143892110687384, -0.000000000000000, 0.000000000000000,
        0.846082037900585,  1.361650118750675,  0.000000000000000,  0.000000000000000,  0.126445691269847,  0.208348524896961,  0.000000000000000,
        0.000000000000000};

    ASSERT_EQ(amomzmat, CDenseMatrix(intzvals, 36, 36));
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeAngularMomentumForH2O)
{
    auto mh2o = vlxmol::getMoleculeH2O();

    auto mbas = vlxbas::getMolecularBasisForH2O();

    const int nrows = 24, ncols = 24;

    CAngularMomentumIntegralsDriver angmomdrv(MPI_COMM_WORLD);

    auto angmommat = angmomdrv.compute(mh2o, mbas);

    std::vector<double> intxvals{
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  -0.0000000000000000, -0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  0.0000000000000000,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000001, 0.0000000000000000,  0.0000000000000001,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, 0.0000000000000000,  0.0000000000000001,  -0.0000000000000000, -0.0000000000000002, -0.1939664014132821,
        -0.1913545533996495, 0.1782225329298709,  0.3856014700561949,  0.8399205656517930,  -0.2254025700926137, -0.2268286782743811,
        -0.4907655073442480, -1.0689898108295544, -0.0769426862228424, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0947315911983290, -0.3369107876233599, -0.0000000000000000, -0.1945155339272356,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, 0.0000000000000002,  -0.0000000000000001, -0.1913545533996495,
        -0.2328734318924804, 0.0651253229246738,  0.2396286956939832,  0.1451703666924939,  -0.0417467145258720, -0.0828867746314030,
        -0.3049819763377968, -0.1847622848813558, -0.0805960680405594, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0094967632217946, -0.0337750262236051, -0.0000000000000000, -0.0195000204820851,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000001, 0.1939664014132821,  0.1913545533996495,  0.0000000000000000,
        0.0000000000000002,  0.1782225329298709,  0.3856014700561949,  -0.2254025700926138, 0.8399205656517930,  0.2268286782743811,
        0.4907655073442480,  0.0769426862228424,  1.0689898108295544,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0947315911983290, 0.3369107876233599,  -0.0000000000000000, 0.1945155339272357,
        -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  0.1913545533996495,  0.2328734318924804,  -0.0000000000000002,
        0.0000000000000001,  0.0651253229246738,  0.2396286956939832,  -0.0417467145258721, 0.1451703666924939,  0.0828867746314030,
        0.3049819763377968,  0.0805960680405595,  0.1847622848813558,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0094967632217946, 0.0337750262236051,  -0.0000000000000000, 0.0195000204820851,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1782225329298709, -0.0651253229246738, -0.1782225329298709,
        -0.0651253229246738, -0.0000000000000000, -0.0000000000000000, 0.2828630877472139,  -0.2828630877472139, -1.0000000000000013,
        -0.5021408928230424, 0.0295023943321291,  0.0295023943321291,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.3856014700561949, -0.2396286956939832, -0.3856014700561949,
        -0.2396286956939832, -0.0000000000000000, -0.0000000000000000, 0.2354180977999339,  -0.2354180977999339, -0.5021408928230424,
        -1.0000000000000013, -0.1870918729160488, -0.1870918729160488, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  -0.8399205656517930, -0.1451703666924939, 0.2254025700926138,
        0.0417467145258721,  -0.2828630877472139, -0.2354180977999339, 0.0000000000000004,  0.3503535345509106,  0.1672603916116163,
        -0.0724402019095875, -1.0000000000000009, 0.0928226051474664,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.3258630911853555, 0.3054372927421273,  -0.0000000000000000, 0.1763443031852177,
        -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  0.2254025700926137,  0.0417467145258720,  -0.8399205656517930,
        -0.1451703666924939, 0.2828630877472139,  0.2354180977999339,  -0.3503535345509106, -0.0000000000000004, 0.1672603916116163,
        -0.0724402019095875, 0.0928226051474664,  -1.0000000000000009, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.3258630911853554,  0.3054372927421273,  -0.0000000000000000, 0.1763443031852177,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2268286782743811,  0.0828867746314030,  -0.2268286782743811,
        -0.0828867746314030, 1.0000000000000013,  0.5021408928230424,  -0.1672603916116163, -0.1672603916116163, -0.0000000000000000,
        -0.0000000000000000, -0.2828630877472138, 0.2828630877472138,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.4907655073442480,  0.3049819763377968,  -0.4907655073442480,
        -0.3049819763377968, 0.5021408928230424,  1.0000000000000013,  0.0724402019095875,  0.0724402019095875,  -0.0000000000000000,
        -0.0000000000000000, -0.2354180977999338, 0.2354180977999338,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.0000000000000000,  0.0000000000000000,  0.0000000000000000,  1.0689898108295544,  0.1847622848813558,  -0.0769426862228424,
        -0.0805960680405595, -0.0295023943321291, 0.1870918729160488,  1.0000000000000009,  -0.0928226051474664, 0.2828630877472138,
        0.2354180977999338,  0.0000000000000004,  -0.1070762636158040, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.5440749826041197,  0.0712569430683663,  -0.0000000000000000, 0.0411402152621511,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0769426862228424,  0.0805960680405594,  -1.0689898108295544,
        -0.1847622848813558, -0.0295023943321291, 0.1870918729160488,  -0.0928226051474664, 1.0000000000000009,  -0.2828630877472138,
        -0.2354180977999338, 0.1070762636158040,  -0.0000000000000004, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.5440749826041197,  -0.0712569430683663, -0.0000000000000000, -0.0411402152621511,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  0.0000000000000004,
        -0.1070762636158040, 0.2000275671338677,  -0.0000000000000000, -0.0000000000000000, -0.2545805399885588, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  -0.0000000000000000, 0.1070762636158040,
        -0.0000000000000004, 0.2000275671338677,  -0.0000000000000000, -0.0000000000000000, 0.2545805399885588,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2000275671338677,
        -0.2000275671338677, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.9999999999999986, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0947315911983290,  0.0094967632217946,  0.0947315911983290,
        0.0094967632217946,  -0.0000000000000000, -0.0000000000000000, 0.3258630911853555,  -0.3258630911853554, -0.0000000000000000,
        -0.0000000000000000, -0.5440749826041197, -0.5440749826041197, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -1.7320508075688759, -0.0000000000000000, -0.9999999999999990,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.3369107876233599,  0.0337750262236051,  -0.3369107876233599,
        -0.0337750262236051, -0.0000000000000000, -0.0000000000000000, -0.3054372927421273, -0.3054372927421273, -0.0000000000000000,
        -0.0000000000000000, -0.0712569430683663, 0.0712569430683663,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 1.7320508075688745,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2545805399885588,
        -0.2545805399885588, 0.9999999999999987,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1945155339272356,  0.0195000204820851,  -0.1945155339272357,
        -0.0195000204820851, -0.0000000000000000, -0.0000000000000000, -0.1763443031852177, -0.1763443031852177, -0.0000000000000000,
        -0.0000000000000000, -0.0411402152621511, 0.0411402152621511,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.9999999999999983,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000};

    CDenseMatrix refxangmom(intxvals, nrows, ncols);

    std::vector<double> intyvals{
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1782225329298709, -0.3856014700561949, -0.8399205656517931,
        -0.0604549677465191, -0.1945155339272357, -0.0000000000000000, -0.0000000000000000, -0.1528336337999709, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0651253229246738, -0.2396286956939832, -0.1451703666924939,
        -0.0633254820318681, -0.0195000204820850, -0.0000000000000000, -0.0000000000000000, -0.0153214446644953, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1782225329298709, -0.3856014700561949, -0.0604549677465190,
        -0.8399205656517930, 0.1945155339272357,  -0.0000000000000000, -0.0000000000000000, -0.1528336337999709, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0651253229246738, -0.2396286956939832, -0.0633254820318680,
        -0.1451703666924939, 0.0195000204820850,  -0.0000000000000000, -0.0000000000000000, -0.0153214446644953, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2828630877472139,  0.2354180977999339,  0.0000000000000004,
        0.1070762636158040,  0.1763443031852178,  -0.0000000000000000, -0.0000000000000000, 0.2957207552507101,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2828630877472139, -0.2354180977999339, -0.1070762636158040,
        -0.0000000000000004, 0.1763443031852178,  -0.0000000000000000, -0.0000000000000000, -0.2957207552507101, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -1.0000000000000013, -0.5021408928230424, -0.1927471746121104,
        -0.1927471746121104, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.5021408928230424, -1.0000000000000013, -0.3720632354731396,
        -0.3720632354731396, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0295023943321291,  -0.1870918729160488, -1.0000000000000013,
        -0.0434562758181023, 0.0411402152621511,  -0.0000000000000000, -0.0000000000000000, -0.1677031122850346, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0295023943321291,  -0.1870918729160488, -0.0434562758181023,
        -1.0000000000000013, -0.0411402152621511, -0.0000000000000000, -0.0000000000000000, -0.1677031122850346, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1782225329298709,  0.0651253229246738,  0.1782225329298709,
        0.0651253229246738,  -0.0000000000000000, -0.0000000000000000, -0.2828630877472139, 0.2828630877472138,  1.0000000000000013,
        0.5021408928230424,  -0.0295023943321291, -0.0295023943321291, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.3856014700561949,  0.2396286956939832,  0.3856014700561949,
        0.2396286956939832,  -0.0000000000000000, -0.0000000000000000, -0.2354180977999339, 0.2354180977999339,  0.5021408928230424,
        1.0000000000000013,  0.1870918729160488,  0.1870918729160488,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.8399205656517931,  0.1451703666924939,  0.0604549677465190,
        0.0633254820318680,  0.0000000000000000,  -0.0000000000000000, -0.0000000000000004, 0.1070762636158040,  0.1927471746121104,
        0.3720632354731396,  1.0000000000000013,  0.0434562758181023,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.2545805399885588,  0.3464579091902533,  -0.0000000000000000, -0.2000275671338677,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0604549677465191,  0.0633254820318681,  0.8399205656517930,
        0.1451703666924939,  -0.0000000000000000, -0.0000000000000000, -0.1070762636158040, 0.0000000000000004,  0.1927471746121104,
        0.3720632354731396,  0.0434562758181023,  1.0000000000000013,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.2545805399885588, 0.3464579091902533,  -0.0000000000000000, -0.2000275671338677,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1945155339272357,  0.0195000204820850,  -0.1945155339272357,
        -0.0195000204820850, -0.0000000000000000, -0.0000000000000000, -0.1763443031852178, -0.1763443031852178, -0.0000000000000000,
        -0.0000000000000000, -0.0411402152621511, 0.0411402152621511,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.9999999999999986,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2545805399885588,
        0.2545805399885588,  -0.9999999999999987, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.3464579091902533,
        -0.3464579091902533, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -1.7320508075688745, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1528336337999709,  0.0153214446644953,  0.1528336337999709,
        0.0153214446644953,  -0.0000000000000000, -0.0000000000000000, -0.2957207552507101, 0.2957207552507101,  -0.0000000000000000,
        -0.0000000000000000, 0.1677031122850346,  0.1677031122850346,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 1.7320508075688759,  -0.0000000000000000, -0.9999999999999990,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2000275671338677,
        0.2000275671338677,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.9999999999999983,  -0.0000000000000000};

    CDenseMatrix refyangmom(intyvals, nrows, ncols);

    std::vector<double> intzvals{
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2268286782743811,  0.4907655073442480,  1.0689898108295544,
        0.0769426862228424,  0.2475652249982999,  -0.0000000000000000, -0.0000000000000000, 0.1945155339272357,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0828867746314030,  0.3049819763377968,  0.1847622848813558,
        0.0805960680405594,  0.0248182078862899,  -0.0000000000000000, -0.0000000000000000, 0.0195000204820850,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2268286782743811, -0.4907655073442480, -0.0769426862228424,
        -1.0689898108295544, 0.2475652249982999,  -0.0000000000000000, -0.0000000000000000, -0.1945155339272357, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0828867746314030, -0.3049819763377968, -0.0805960680405595,
        -0.1847622848813558, 0.0248182078862899,  -0.0000000000000000, -0.0000000000000000, -0.0195000204820851, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 1.0000000000000013,  0.5021408928230424,  0.1927471746121104,
        0.1927471746121104,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.5021408928230424,  1.0000000000000013,  0.3720632354731397,
        0.3720632354731397,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1672603916116163, 0.0724402019095875,  1.0000000000000009,
        -0.0928226051474664, 0.0301423359346454,  -0.0000000000000000, -0.0000000000000000, -0.1763443031852177, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1672603916116163, 0.0724402019095875,  -0.0928226051474664,
        1.0000000000000009,  -0.0301423359346454, -0.0000000000000000, -0.0000000000000000, -0.1763443031852178, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2828630877472138, -0.2354180977999338, -0.0000000000000000,
        -0.0000000000000000, -0.3763718703190853, -0.0000000000000000, -0.0000000000000000, -0.0411402152621511, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2828630877472138,  0.2354180977999338,  -0.0000000000000000,
        -0.0000000000000000, -0.3763718703190853, -0.0000000000000000, -0.0000000000000000, 0.0411402152621511,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2268286782743811, -0.0828867746314030, 0.2268286782743811,
        0.0828867746314030,  -1.0000000000000013, -0.5021408928230424, 0.1672603916116163,  0.1672603916116163,  -0.0000000000000000,
        -0.0000000000000000, 0.2828630877472138,  -0.2828630877472138, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.4907655073442480, -0.3049819763377968, 0.4907655073442480,
        0.3049819763377968,  -0.5021408928230424, -1.0000000000000013, -0.0724402019095875, -0.0724402019095875, -0.0000000000000000,
        -0.0000000000000000, 0.2354180977999338,  -0.2354180977999338, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,  -1.0689898108295544, -0.1847622848813558, 0.0769426862228424,
        0.0805960680405595,  -0.1927471746121104, -0.3720632354731397, -1.0000000000000009, 0.0928226051474664,  0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.2000275671338677, 0.0000000000000000,  -0.0000000000000000, 0.5091610799771178,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0769426862228424, -0.0805960680405594, 1.0689898108295544,
        0.1847622848813558,  -0.1927471746121104, -0.3720632354731397, 0.0928226051474664,  -1.0000000000000009, 0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.2000275671338677, -0.0000000000000000, -0.0000000000000000, -0.5091610799771178,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2475652249982999, -0.0248182078862899, -0.2475652249982999,
        -0.0248182078862899, -0.0000000000000000, -0.0000000000000000, -0.0301423359346454, 0.0301423359346454,  -0.0000000000000000,
        -0.0000000000000000, 0.3763718703190853,  0.3763718703190853,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 1.9999999999999978,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2000275671338677,
        0.2000275671338677,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.9999999999999987,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.0000000000000000,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1945155339272357, -0.0195000204820850, 0.1945155339272357,
        0.0195000204820851,  -0.0000000000000000, -0.0000000000000000, 0.1763443031852177,  0.1763443031852178,  -0.0000000000000000,
        -0.0000000000000000, 0.0411402152621511,  -0.0411402152621511, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.9999999999999987, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.5091610799771178,
        0.5091610799771178,  -1.9999999999999962, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000};

    CDenseMatrix refzangmom(intzvals, nrows, ncols);

    CAngularMomentumMatrix refmat(refxangmom, refyangmom, refzangmom, 0.0, 0.0, 0.0);

    ASSERT_EQ(refmat, angmommat);
}

TEST_F(CAngularMomentumIntegralsDriverTest, ComputeAngularMomentumForH2OWithOrigin)
{
    auto mh2o = vlxmol::getMoleculeH2O();

    auto mbas = vlxbas::getMolecularBasisForH2O();

    const int nrows = 24, ncols = 24;

    CAngularMomentumIntegralsDriver angmomdrv(MPI_COMM_WORLD);

    angmomdrv.setAngularMomentumOrigin(1.0, 1.0, 1.0);

    auto angmommat = angmomdrv.compute(mh2o, mbas);

    std::vector<double> intxvals{
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0133166237586880,  0.0045707898642253,  -0.1109718646557337,
        -0.0380899155352104, 1.5331165578922252,  0.1703100142160346,  0.0208900124082997,  -0.2258283364999412, -1.5331165578922252,
        -0.1703100142160346, -0.0809675324346570, 0.1657508164735840,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0646086360085791, -0.0251778860718373, 0.5384053000714932,
        0.2098157172653110,  -0.8090920500989308, -0.6373844944940497, -0.1663288710934319, 0.4565445905008624,  0.8090920500989308,
        0.6373844944940497,  0.3180026036245099,  -0.3048708579697843, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0529902576688974, -0.0344874334817603, 0.4415854805741459,
        0.2873952790146693,  -0.2383655916315809, -0.5042847427521140, -0.1555413318139454, 0.0658983723539979,  0.2383655916315809,
        0.5042847427521140,  0.2094633376989964,  -0.0119763664689468, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0133166237586880, 0.0646086360085791,  0.0529902576688974,  -0.0000000000000000, -0.0000000000000000, -0.0176333092193893,
        -0.0173958684908772, 0.0692899487813933,  0.0886618684345858,  0.0763564150592540,  -0.0204911427356922, -0.0230962721022906,
        -0.0980987819037674, -0.3054256602370156, -0.0219836246350978, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0025528731406923, -0.0697019405942021, -0.0000000000000000, -0.0522289186341248,
        -0.0045707898642253, 0.0251778860718373,  0.0344874334817603,  0.0000000000000000,  -0.0000000000000000, -0.0173958684908772,
        -0.0211703119902255, 0.0113968396478689,  0.0372685614214640,  0.0131973060629540,  -0.0037951558659884, -0.0193790846659809,
        -0.0749716018149333, -0.0527892242518159, -0.0230274480115884, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0044028690413825, -0.0073451428930605, -0.0000000000000000, -0.0025969402476312,
        0.1109718646557337,  -0.5384053000714932, -0.4415854805741459, 0.0176333092193893,  0.0173958684908772,  0.0000000000000000,
        0.0000000000000003,  0.4586012178916973,  0.4817812569174184,  -0.0204911427356922, 0.0763564150592540,  0.0412498153361676,
        0.4903128443018960,  0.1319017478105870,  1.8325539614220934,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0418804512931173,  0.3562423132027759,  -0.0000000000000000, 0.3055639659995488,
        0.0380899155352104,  -0.2098157172653110, -0.2873952790146693, 0.0173958684908772,  0.0211703119902255,  -0.0000000000000003,
        0.0000000000000000,  0.0515567817824567,  0.1508188813828777,  -0.0037951558659884, 0.0131973060629540,  0.1062345224622372,
        0.4214420308992465,  0.1381646880695304,  0.3167353455108957,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0303593998636583, 0.0386928399597686,  -0.0000000000000000, 0.0086411550755375,
        -1.5331165578922252, 0.8090920500989308,  0.2383655916315809,  -0.0692899487813933, -0.0113968396478689, -0.4586012178916973,
        -0.0515567817824567, -0.0000000000000000, -0.0000000000000000, -0.1816490973263591, -0.1834360487636230, -1.0000000000000011,
        -0.5021408928230424, 0.1670172294699754,  0.2570727052842652,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 1.1460320378031288,  0.6616619055255714,  -0.0000000000000000, 1.1460320378031277,
        -0.1703100142160346, 0.6373844944940497,  0.5042847427521140,  -0.0886618684345858, -0.0372685614214640, -0.4817812569174184,
        -0.1508188813828777, -0.0000000000000000, -0.0000000000000000, -0.2015438165614624, 0.2670232178792503,  -0.5021408928230424,
        -1.0000000000000013, -0.1122134723383393, -0.3274496748115460, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.2205247419605120,  0.1273200191338743,  -0.0000000000000000, 0.2205247419605118,
        -0.0208900124082997, 0.1663288710934319,  0.1555413318139454,  -0.0763564150592540, -0.0131973060629540, 0.0204911427356922,
        0.0037951558659884,  0.1816490973263591,  0.2015438165614624,  0.0000000000000000,  0.0318503213228101,  0.0297455564737704,
        -0.1473186024872968, -1.0000000000000013, -0.0045194526850827, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0007108470574858,  -0.1260420760797426, -0.0000000000000000, -0.1593873189573350,
        0.2258283364999412,  -0.4565445905008624, -0.0658983723539979, 0.0204911427356922,  0.0037951558659884,  -0.0763564150592540,
        -0.0131973060629540, 0.1834360487636230,  -0.2670232178792503, -0.0318503213228101, -0.0000000000000000, -0.0603099193405199,
        0.0679175999859097,  0.1901646629800155,  -1.0000000000000007, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0511023154783892,  0.1158420864658339,  -0.0000000000000000, -0.1912176257043207,
        1.5331165578922252,  -0.8090920500989308, -0.2383655916315809, 0.0230962721022906,  0.0193790846659809,  -0.0412498153361676,
        -0.1062345224622372, 1.0000000000000011,  0.5021408928230424,  -0.0297455564737704, 0.0603099193405199,  -0.0000000000000000,
        -0.0000000000000000, 0.1308758385860513,  0.6065465382661890,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -1.1460320378031288, 1.3233238110511425,  -0.0000000000000000, 0.0000000000000001,
        0.1703100142160346,  -0.6373844944940497, -0.5042847427521140, 0.0980987819037674,  0.0749716018149333,  -0.4903128443018960,
        -0.4214420308992465, 0.5021408928230424,  1.0000000000000013,  0.1473186024872968,  -0.0679175999859097, -0.0000000000000000,
        -0.0000000000000000, 0.0778324487921283,  0.7639048468652024,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.2205247419605120, 0.2546400382677485,  -0.0000000000000000, -0.0000000000000000,
        0.0809675324346570,  -0.3180026036245099, -0.2094633376989964, 0.3054256602370156,  0.0527892242518159,  -0.1319017478105870,
        -0.1381646880695304, -0.1670172294699754, 0.1122134723383393,  1.0000000000000013,  -0.1901646629800155, -0.1308758385860513,
        -0.0778324487921283, 0.0000000000000000,  -0.0097342057832549, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.0239383681971779,  -0.0818931420876497, -0.0000000000000000, -0.0024211627675073,
        -0.1657508164735840, 0.3048708579697843,  0.0119763664689468,  0.0219836246350978,  0.0230274480115884,  -1.8325539614220934,
        -0.3167353455108957, -0.2570727052842652, 0.3274496748115460,  0.0045194526850827,  1.0000000000000004,  -0.6065465382661890,
        -0.7639048468652024, 0.0097342057832549,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 1.0123984344751871,  -0.4662911907699588, -0.0000000000000000, -0.0528712865448238,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0551031989117949,
        0.4591933242649576,  -1.1460320378031286, -0.0000000000000000, -0.0000000000000000, 1.1460320378031288,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0458606684025845,
        0.3821722366882045,  -0.2205247419605120, -0.0000000000000000, -0.0000000000000000, 0.2205247419605120,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0551031989117949,  0.0458606684025845,  0.0000000000000000,
        -0.0097342057832549, 0.0915035198016019,  -0.0000000000000000, -0.0000000000000000, -0.0151293578050344, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.4591933242649576, -0.3821722366882045, 0.0097342057832549,
        -0.0000000000000000, 0.6291776202574384,  -0.0000000000000000, -0.0000000000000000, -0.0436423782837530, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 1.1460320378031286,  0.2205247419605120,  -0.0915035198016019,
        -0.6291776202574384, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.9999999999999988, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0025528731406923,  0.0044028690413825,  -0.0418804512931173,
        0.0303593998636583,  -1.1460320378031288, -0.2205247419605120, -0.0007108470574858, -0.0511023154783892, 1.1460320378031288,
        0.2205247419605120,  -0.0239383681971779, -1.0123984344751871, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -1.7320508075688759, -0.0000000000000000, -0.9999999999999990,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0697019405942021,  0.0073451428930605,  -0.3562423132027759,
        -0.0386928399597686, -0.6616619055255714, -0.1273200191338743, 0.1260420760797426,  -0.1158420864658339, -1.3233238110511425,
        -0.2546400382677485, 0.0818931420876497,  0.4662911907699588,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 1.7320508075688745,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -1.1460320378031288, -0.2205247419605120, 0.0151293578050344,
        0.0436423782837530,  0.9999999999999989,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0522289186341248,  0.0025969402476312,  -0.3055639659995488,
        -0.0086411550755375, -1.1460320378031277, -0.2205247419605118, 0.1593873189573350,  0.1912176257043207,  -0.0000000000000001,
        -0.0000000000000000, 0.0024211627675073,  0.0528712865448238,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, 0.9999999999999983,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000};

    CDenseMatrix refxangmom(intxvals, nrows, ncols);

    std::vector<double> intyvals{
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0488276204485228,  0.0167595628354926,  0.0488276204485228,
        0.0167595628354926,  -0.0000000000000000, -0.0000000000000000, -0.1233591744541205, 0.1233591744541205,  1.5331165578922252,
        0.1703100142160346,  -0.0423916420194635, -0.0423916420194635, -1.5331165578922252, -0.1703100142160346, -0.0545334236230598,
        -0.0545334236230598, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.2368983320314570, -0.0923189155967368, -0.2368983320314570,
        -0.0923189155967368, -0.0000000000000000, -0.0000000000000000, 0.3114367307971471,  -0.3114367307971471, -0.8090920500989308,
        -0.6373844944940497, -0.0065658728273628, -0.0065658728273628, 0.8090920500989308,  0.6373844944940497,  0.2512661613108356,
        0.2512661613108356,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1942976114526243, -0.1264539227664545, -0.1942976114526243,
        -0.1264539227664545, -0.0000000000000000, -0.0000000000000000, 0.1107198520839716,  -0.1107198520839716, -0.2383655916315809,
        -0.5042847427521140, -0.0987434856150248, -0.0987434856150248, 0.2383655916315809,  0.5042847427521140,  0.1857376551095739,
        0.1857376551095739,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0488276204485228, 0.2368983320314570,  0.1942976114526243,  -0.0000000000000000, -0.0000000000000001, -0.0000000000000000,
        -0.0000000000000001, 0.1946556345551520,  0.1965596942414163,  -0.0000000000000000, -0.0000000000000000, -0.0090767716169385,
        -0.1961070311990643, -0.7635641505925389, -0.0549590615877446, -0.0162020484481701, -0.0350546790960177, -0.0763564150592540,
        -0.0054959061587745, -0.0176832303570216, 0.0222166622169048,  -0.1432701863042869, -0.0138939667090884, -0.1266675236827120,
        -0.0167595628354926, 0.0923189155967368,  0.1264539227664545,  0.0000000000000001,  -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, 0.0200799710672939,  0.0567751599807069,  -0.0000000000000000, -0.0000000000000000, -0.0434277188981282,
        -0.1732352145421566, -0.1319730606295399, -0.0575686200289710, -0.0059204839022433, -0.0217844268812712, -0.0131973060629540,
        -0.0057568620028971, -0.0017727291347351, -0.0129782654111379, -0.0156738485333540, -0.0013928586058632, -0.0030221074139532,
        -0.0488276204485228, 0.2368983320314570,  0.1942976114526243,  -0.0000000000000000, 0.0000000000000000,  -0.0000000000000000,
        -0.0000000000000001, -0.1946556345551520, -0.1965596942414163, -0.0000000000000000, -0.0000000000000000, -0.0090767716169385,
        -0.1961070311990643, -0.0549590615877446, -0.7635641505925390, -0.0162020484481701, -0.0350546790960177, -0.0054959061587745,
        -0.0763564150592540, 0.0176832303570216,  -0.0222166622169048, -0.1432701863042870, -0.0138939667090884, -0.1266675236827121,
        -0.0167595628354926, 0.0923189155967368,  0.1264539227664545,  0.0000000000000001,  -0.0000000000000000, 0.0000000000000001,
        -0.0000000000000000, -0.0200799710672939, -0.0567751599807069, -0.0000000000000000, -0.0000000000000000, -0.0434277188981282,
        -0.1732352145421566, -0.0575686200289709, -0.1319730606295399, -0.0059204839022433, -0.0217844268812712, -0.0057568620028971,
        -0.0131973060629540, 0.0017727291347351,  0.0129782654111379,  -0.0156738485333540, -0.0013928586058632, -0.0030221074139532,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1946556345551520, -0.0200799710672939, 0.1946556345551520,
        0.0200799710672939,  -0.0000000000000000, -0.0000000000000000, 0.1825425730449910,  0.1825425730449911,  -0.0000000000000000,
        -0.0000000000000000, 0.0450277379071450,  -0.0450277379071450, -0.0000000000000000, -0.0000000000000000, 0.2571482615883762,
        -0.2571482615883763, 1.1460320378031286,  -1.1460320378031288, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.1965596942414163, -0.0567751599807069, 0.1965596942414163,
        0.0567751599807069,  -0.0000000000000000, -0.0000000000000000, -0.0327397006588940, -0.0327397006588940, -0.0000000000000000,
        -0.0000000000000000, -0.1076181012366033, 0.1076181012366033,  -0.0000000000000000, -0.0000000000000000, 0.2140164525453945,
        -0.2140164525453945, 0.2205247419605120,  -0.2205247419605120, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.1233591744541205,  -0.3114367307971471, -0.1107198520839716, -0.0000000000000000, -0.0000000000000000, 0.0000000000000000,
        -0.0000000000000000, -0.1825425730449910, 0.0327397006588940,  -0.0000000000000000, -0.0000000000000000, -0.0450277379071452,
        0.1076181012366032,  0.0000000000000003,  0.0973420578325491,  0.0257148261588378,  0.0214016452545395,  0.0000000000000000,
        0.0097342057832549,  0.0160313002895652,  -0.0259065812679375, 0.1209420812727882,  0.0268837050227919,  -0.0159151533734928,
        -0.1233591744541205, 0.3114367307971471,  0.1107198520839716,  0.0000000000000000,  -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.1825425730449911, 0.0327397006588940,  -0.0000000000000000, -0.0000000000000000, 0.0450277379071452,
        -0.1076181012366032, -0.0973420578325491, -0.0000000000000003, -0.0257148261588378, -0.0214016452545395, -0.0097342057832549,
        -0.0000000000000000, 0.0160313002895652,  -0.0259065812679375, -0.1209420812727882, -0.0268837050227919, 0.0159151533734927,
        -1.5331165578922252, 0.8090920500989308,  0.2383655916315809,  0.0090767716169385,  0.0434277188981282,  0.0090767716169385,
        0.0434277188981282,  -0.0000000000000000, -0.0000000000000000, 0.0450277379071452,  -0.0450277379071452, -0.0000000000000000,
        -0.0000000000000000, -0.3687111884261201, -0.3687111884261201, -1.0000000000000011, -0.5021408928230424, 0.0092978880644710,
        0.0092978880644710,  -0.0000000000000000, -0.0000000000000000, -1.3233238110511425, 1.1460320378031288,  0.0000000000000001,
        -0.1703100142160346, 0.6373844944940497,  0.5042847427521140,  0.1961070311990643,  0.1732352145421566,  0.1961070311990643,
        0.1732352145421566,  -0.0000000000000000, -0.0000000000000000, -0.1076181012366032, 0.1076181012366032,  -0.0000000000000000,
        -0.0000000000000000, -0.4208686478286653, -0.4208686478286653, -0.5021408928230424, -1.0000000000000013, -0.2039074513303297,
        -0.2039074513303297, -0.0000000000000000, -0.0000000000000000, -0.2546400382677485, 0.2205247419605120,  -0.0000000000000000,
        0.0423916420194635,  0.0065658728273628,  0.0987434856150248,  0.7635641505925389,  0.1319730606295399,  0.0549590615877446,
        0.0575686200289709,  -0.0450277379071450, 0.1076181012366033,  -0.0000000000000003, 0.0973420578325491,  0.3687111884261201,
        0.4208686478286653,  -0.0000000000000000, -0.0000000000000000, -0.1725426683444521, -0.3552476570588586, -1.0000000000000013,
        -0.0434562758181023, -0.2276968349657670, 0.4942300331390046,  0.2740921664288043,  -0.1970889803294283, 0.0276462246561656,
        0.0423916420194635,  0.0065658728273628,  0.0987434856150248,  0.0549590615877446,  0.0575686200289710,  0.7635641505925390,
        0.1319730606295399,  0.0450277379071450,  -0.1076181012366033, -0.0973420578325491, 0.0000000000000003,  0.3687111884261201,
        0.4208686478286653,  -0.0000000000000000, -0.0000000000000000, -0.1725426683444521, -0.3552476570588586, -0.0434562758181023,
        -1.0000000000000013, 0.2276968349657670,  -0.4942300331390046, 0.2740921664288043,  -0.1970889803294283, 0.0276462246561656,
        1.5331165578922252,  -0.8090920500989308, -0.2383655916315809, 0.0162020484481701,  0.0059204839022433,  0.0162020484481701,
        0.0059204839022433,  -0.0000000000000000, -0.0000000000000000, -0.0257148261588378, 0.0257148261588378,  1.0000000000000011,
        0.5021408928230424,  0.1725426683444521,  0.1725426683444521,  -0.0000000000000000, -0.0000000000000000, -0.2020450626765814,
        -0.2020450626765814, -0.0000000000000000, -0.0000000000000000, -0.6616619055255712, -1.1460320378031288, 1.1460320378031277,
        0.1703100142160346,  -0.6373844944940497, -0.5042847427521140, 0.0350546790960177,  0.0217844268812712,  0.0350546790960177,
        0.0217844268812712,  -0.0000000000000000, -0.0000000000000000, -0.0214016452545395, 0.0214016452545395,  0.5021408928230424,
        1.0000000000000013,  0.3552476570588586,  0.3552476570588586,  -0.0000000000000000, -0.0000000000000000, -0.1681557841428100,
        -0.1681557841428100, -0.0000000000000000, -0.0000000000000000, -0.1273200191338743, -0.2205247419605120, 0.2205247419605118,
        0.0545334236230598,  -0.2512661613108356, -0.1857376551095739, 0.0763564150592540,  0.0131973060629540,  0.0054959061587745,
        0.0057568620028971,  -0.2571482615883762, -0.2140164525453945, -0.0000000000000000, 0.0097342057832549,  -0.0092978880644710,
        0.2039074513303297,  1.0000000000000013,  0.0434562758181023,  0.2020450626765814,  0.1681557841428100,  -0.0000000000000000,
        -0.0000000000000000, 0.2688370502279182,  -0.0142565102393593, 0.2182894802389013,  0.0293858680443937,  0.1528937985874147,
        0.0545334236230598,  -0.2512661613108356, -0.1857376551095739, 0.0054959061587745,  0.0057568620028971,  0.0763564150592540,
        0.0131973060629540,  0.2571482615883763,  0.2140164525453945,  -0.0097342057832549, 0.0000000000000000,  -0.0092978880644710,
        0.2039074513303297,  0.0434562758181023,  1.0000000000000013,  0.2020450626765814,  0.1681557841428100,  -0.0000000000000000,
        -0.0000000000000000, -0.2688370502279182, 0.0142565102393593,  0.2182894802389013,  0.0293858680443937,  0.1528937985874147,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0176832303570216,  0.0017727291347351,  -0.0176832303570216,
        -0.0017727291347351, -1.1460320378031286, -0.2205247419605120, -0.0160313002895652, -0.0160313002895652, -0.0000000000000000,
        -0.0000000000000000, 0.2276968349657670,  -0.2276968349657670, -0.0000000000000000, -0.0000000000000000, -0.2688370502279182,
        0.2688370502279182,  -0.0000000000000000, 0.9999999999999988,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0222166622169048, 0.0129782654111379,  0.0222166622169048,
        -0.0129782654111379, 1.1460320378031288,  0.2205247419605120,  0.0259065812679375,  0.0259065812679375,  -0.0000000000000000,
        -0.0000000000000000, -0.4942300331390046, 0.4942300331390046,  -0.0000000000000000, -0.0000000000000000, 0.0142565102393593,
        -0.0142565102393593, -0.9999999999999989, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1432701863042869,  0.0156738485333540,  0.1432701863042870,
        0.0156738485333540,  -0.0000000000000000, -0.0000000000000000, -0.1209420812727882, 0.1209420812727882,  1.3233238110511425,
        0.2546400382677485,  -0.2740921664288043, -0.2740921664288043, 0.6616619055255712,  0.1273200191338743,  -0.2182894802389013,
        -0.2182894802389013, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -1.7320508075688745, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0138939667090884,  0.0013928586058632,  0.0138939667090884,
        0.0013928586058632,  -0.0000000000000000, -0.0000000000000000, -0.0268837050227919, 0.0268837050227919,  -1.1460320378031288,
        -0.2205247419605120, 0.1970889803294283,  0.1970889803294283,  1.1460320378031288,  0.2205247419605120,  -0.0293858680443937,
        -0.0293858680443937, -0.0000000000000000, -0.0000000000000000, 1.7320508075688759,  -0.0000000000000000, -0.9999999999999990,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1266675236827120,  0.0030221074139532,  0.1266675236827121,
        0.0030221074139532,  -0.0000000000000000, -0.0000000000000000, 0.0159151533734928,  -0.0159151533734927, -0.0000000000000001,
        -0.0000000000000000, -0.0276462246561656, -0.0276462246561656, -1.1460320378031277, -0.2205247419605118, -0.1528937985874147,
        -0.1528937985874147, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.9999999999999983,  -0.0000000000000000};

    CDenseMatrix refyangmom(intyvals, nrows, ncols);

    std::vector<double> intzvals{
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0621442442072109, -0.0213303526997178, 0.0621442442072109,
        0.0213303526997178,  -1.5331165578922252, -0.1703100142160346, 0.1024691620458208,  0.1024691620458208,  -0.0000000000000000,
        -0.0000000000000000, 0.1233591744541205,  -0.1233591744541205, 1.5331165578922252,  0.1703100142160346,  0.0545334236230598,
        0.0545334236230598,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.3015069680400361,  0.1174968016685742,  -0.3015069680400361,
        -0.1174968016685742, 0.8090920500989308,  0.6373844944940497,  -0.1451078597037152, -0.1451078597037152, -0.0000000000000000,
        -0.0000000000000000, -0.3114367307971471, 0.3114367307971471,  -0.8090920500989308, -0.6373844944940497, -0.2512661613108356,
        -0.2512661613108356, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.2472878691215217,  0.1609413562482148,  -0.2472878691215217,
        -0.1609413562482148, 0.2383655916315809,  0.5042847427521140,  0.0448214797299737,  0.0448214797299737,  -0.0000000000000000,
        -0.0000000000000000, -0.1107198520839716, 0.1107198520839716,  -0.2383655916315809, -0.5042847427521140, -0.1857376551095739,
        -0.1857376551095740, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        0.0621442442072109,  -0.3015069680400361, -0.2472878691215217, -0.0000000000000000, 0.0000000000000000,  -0.1763330921938928,
        -0.1739586849087721, -0.0857230504066744, 0.1003799073801929,  0.7635641505925389,  -0.2049114273569216, -0.1946556345551520,
        -0.1965596942414163, -0.0000000000000000, -0.0000000000000000, 0.0648081937926803,  0.1402187163840708,  0.3054256602370156,
        0.0219836246350978,  0.0707329214280858,  -0.1143953802745415, -0.1239386607248709, 0.0555758668363531,  -0.0156190916103989,
        0.0213303526997178,  -0.1174968016685742, -0.1609413562482148, -0.0000000000000000, -0.0000000000000001, -0.1739586849087722,
        -0.2117031199022549, 0.0336485122095110,  0.1455849742918123,  0.1319730606295399,  -0.0379515586598836, -0.0200799710672939,
        -0.0567751599807069, -0.0000000000000000, -0.0000000000000000, 0.0236819356089725,  0.0871377075250849,  0.0527892242518159,
        0.0230274480115884,  0.0070909165389399,  0.0078843712307258,  -0.0107560347971905, 0.0055714344234529,  -0.0138809728205007,
        -0.0621442442072109, 0.3015069680400361,  0.2472878691215217,  0.1763330921938928,  0.1739586849087722,  0.0000000000000000,
        -0.0000000000000000, -0.0857230504066744, 0.1003799073801929,  -0.2049114273569216, 0.7635641505925390,  0.1946556345551520,
        0.1965596942414163,  0.0000000000000000,  -0.0000000000000000, -0.3888491627560819, -0.8413122983044251, -0.1319017478105870,
        -1.8325539614220938, 0.4243975285685140,  -0.1143953802745415, 0.1239386607248709,  -0.3334552010181182, 0.0156190916103989,
        -0.0213303526997178, 0.1174968016685742,  0.1609413562482148,  0.1739586849087721,  0.2117031199022549,  0.0000000000000000,
        0.0000000000000001,  0.0336485122095110,  0.1455849742918123,  -0.0379515586598837, 0.1319730606295399,  0.0200799710672939,
        0.0567751599807069,  -0.0000000000000000, -0.0000000000000000, -0.1420916136538335, -0.5228262451505088, -0.1381646880695304,
        -0.3167353455108957, 0.0425454992336399,  0.0078843712307258,  0.0107560347971905,  -0.0334286065407172, 0.0138809728205007,
        1.5331165578922252,  -0.8090920500989308, -0.2383655916315809, 0.0857230504066744,  -0.0336485122095110, 0.0857230504066744,
        -0.0336485122095110, -0.0000000000000000, -0.0000000000000000, 0.2819696120285820,  -0.2819696120285820, -0.0000000000000000,
        -0.0000000000000000, -0.1825425730449912, -0.1825425730449912, 1.0000000000000011,  0.5021408928230424,  -0.0644010869762659,
        0.4498954362004867,  -1.1460320378031286, -0.0000000000000000, -0.6616619055255712, -0.0000000000000000, -1.1460320378031279,
        0.1703100142160346,  -0.6373844944940497, -0.5042847427521140, -0.1003799073801929, -0.1455849742918123, -0.1003799073801929,
        -0.1455849742918123, -0.0000000000000000, -0.0000000000000000, 0.4697016150202903,  -0.4697016150202903, -0.0000000000000000,
        -0.0000000000000000, 0.0327397006588939,  0.0327397006588939,  0.5021408928230424,  1.0000000000000013,  0.1580467829277452,
        0.5860796880185343,  -0.2205247419605120, -0.0000000000000000, -0.1273200191338743, -0.0000000000000000, -0.2205247419605118,
        -0.1024691620458208, 0.1451078597037152,  -0.0448214797299737, -0.7635641505925389, -0.1319730606295399, 0.2049114273569216,
        0.0379515586598837,  -0.2819696120285820, -0.4697016150202903, 0.0000000000000003,  0.3185032132281006,  0.1825425730449910,
        -0.0327397006588939, -0.0000000000000000, -0.0000000000000000, 0.0898878699767598,  0.2864566544549819,  1.0000000000000013,
        0.0045194526850827,  0.1904553388302978,  -0.3006673569749037, 0.3105372875490817,  0.0924927470427005,  0.3516467755160456,
        -0.1024691620458208, 0.1451078597037152,  -0.0448214797299737, 0.2049114273569216,  0.0379515586598836,  -0.7635641505925390,
        -0.1319730606295399, 0.2819696120285820,  0.4697016150202903,  -0.3185032132281006, -0.0000000000000003, 0.1825425730449910,
        -0.0327397006588939, -0.0000000000000000, -0.0000000000000000, -0.4244086531999923, -0.1415762506358070, -0.1901646629800155,
        1.0000000000000007,  0.1301706669610071,  0.3006673569749037,  0.3105372875490817,  -0.4451813534131360, 0.3516467755160456,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1946556345551520,  0.0200799710672939,  -0.1946556345551520,
        -0.0200799710672939, -0.0000000000000000, -0.0000000000000000, -0.1825425730449910, -0.1825425730449910, -0.0000000000000000,
        -0.0000000000000000, -0.0450277379071450, 0.0450277379071450,  -0.0000000000000000, -0.0000000000000000, -0.2020450626765813,
        -0.2020450626765814, -0.0000000000000000, 1.1460320378031288,  -0.0000000000000000, -1.1460320378031288, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1965596942414163,  0.0567751599807069,  -0.1965596942414163,
        -0.0567751599807069, -0.0000000000000000, -0.0000000000000000, 0.0327397006588939,  0.0327397006588939,  -0.0000000000000000,
        -0.0000000000000000, 0.1076181012366033,  -0.1076181012366033, -0.0000000000000000, -0.0000000000000000, -0.1681557841428100,
        -0.1681557841428099, -0.0000000000000000, 0.2205247419605120,  -0.0000000000000000, -0.2205247419605120, -0.0000000000000000,
        -0.1233591744541205, 0.3114367307971471,  0.1107198520839716,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, 0.1825425730449912,  -0.0327397006588939, -0.0000000000000000, -0.0000000000000000, 0.0450277379071450,
        -0.1076181012366033, 0.0000000000000004,  -0.0973420578325491, -0.0808180250706326, -0.0672623136571240, -0.0000000000000000,
        -0.0000000000000000, -0.1075348200911672, 0.0259065812679374,  -0.1209420812727882, -0.0117543472177575, 0.0159151533734929,
        0.1233591744541205,  -0.3114367307971471, -0.1107198520839716, 0.0000000000000000,  -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, 0.1825425730449912,  -0.0327397006588939, -0.0000000000000000, -0.0000000000000000, -0.0450277379071450,
        0.1076181012366033,  0.0973420578325491,  -0.0000000000000004, 0.4849081504237949,  0.4035738819427436,  -0.0000000000000000,
        -0.0000000000000000, -0.6452089205470035, 0.0259065812679374,  0.1209420812727882,  0.0705260833065448,  -0.0159151533734929,
        -1.5331165578922252, 0.8090920500989308,  0.2383655916315809,  -0.0648081937926803, -0.0236819356089725, 0.3888491627560819,
        0.1420916136538335,  -1.0000000000000011, -0.5021408928230424, -0.0898878699767598, 0.4244086531999923,  -0.0000000000000000,
        -0.0000000000000000, 0.0808180250706326,  -0.4849081504237949, -0.0000000000000000, -0.0000000000000000, 0.2571482615883763,
        -0.2571482615883763, 1.1460320378031286,  -0.0000000000000000, 0.6616619055255712,  -0.0000000000000000, -1.1460320378031279,
        -0.1703100142160346, 0.6373844944940497,  0.5042847427521140,  -0.1402187163840708, -0.0871377075250849, 0.8413122983044251,
        0.5228262451505088,  -0.5021408928230424, -1.0000000000000013, -0.2864566544549819, 0.1415762506358070,  -0.0000000000000000,
        -0.0000000000000000, 0.0672623136571240,  -0.4035738819427436, -0.0000000000000000, -0.0000000000000000, 0.2140164525453945,
        -0.2140164525453945, 0.2205247419605120,  -0.0000000000000000, 0.1273200191338743,  -0.0000000000000000, -0.2205247419605118,
        -0.0545334236230598, 0.2512661613108356,  0.1857376551095739,  -0.3054256602370156, -0.0527892242518159, 0.1319017478105870,
        0.1381646880695304,  0.0644010869762659,  -0.1580467829277452, -1.0000000000000013, 0.1901646629800155,  0.2020450626765813,
        0.1681557841428100,  -0.0000000000000000, -0.0000000000000000, -0.2571482615883763, -0.2140164525453945, 0.0000000000000004,
        -0.0973420578325491, -0.1603130028956524, 0.0688094830940504,  0.1281684289513521,  -0.2688370502279182, 0.1562397142558354,
        -0.0545334236230598, 0.2512661613108356,  0.1857376551095740,  -0.0219836246350978, -0.0230274480115884, 1.8325539614220938,
        0.3167353455108957,  -0.4498954362004867, -0.5860796880185343, -0.0045194526850827, -1.0000000000000004, 0.2020450626765814,
        0.1681557841428099,  -0.0000000000000000, -0.0000000000000000, 0.2571482615883763,  0.2140164525453945,  0.0973420578325491,
        -0.0000000000000004, -0.1603130028956524, -0.4688646173617859, 0.1281684289513521,  0.2688370502279182,  -0.8620824456984002,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0707329214280858, -0.0070909165389399, -0.4243975285685140,
        -0.0425454992336399, 1.1460320378031286,  0.2205247419605120,  -0.1904553388302978, -0.1301706669610071, -0.0000000000000000,
        -0.0000000000000000, 0.1075348200911672,  0.6452089205470035,  -1.1460320378031286, -0.2205247419605120, 0.1603130028956524,
        0.1603130028956524,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 1.9999999999999978,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1143953802745415,  -0.0078843712307258, 0.1143953802745415,
        -0.0078843712307258, -0.0000000000000000, -0.0000000000000000, 0.3006673569749037,  -0.3006673569749037, -1.1460320378031288,
        -0.2205247419605120, -0.0259065812679374, -0.0259065812679374, -0.0000000000000000, -0.0000000000000000, -0.0688094830940504,
        0.4688646173617859,  -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.9999999999999989,  -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.1239386607248709,  0.0107560347971905,  -0.1239386607248709,
        -0.0107560347971905, 0.6616619055255712,  0.1273200191338743,  -0.3105372875490817, -0.3105372875490817, -0.0000000000000000,
        -0.0000000000000000, 0.1209420812727882,  -0.1209420812727882, -0.6616619055255712, -0.1273200191338743, -0.1281684289513521,
        -0.1281684289513521, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0555758668363531, -0.0055714344234529, 0.3334552010181182,
        0.0334286065407172,  -0.0000000000000000, -0.0000000000000000, -0.0924927470427005, 0.4451813534131360,  1.1460320378031288,
        0.2205247419605120,  0.0117543472177575,  -0.0705260833065448, -0.0000000000000000, -0.0000000000000000, 0.2688370502279182,
        -0.2688370502279182, -0.0000000000000000, -0.9999999999999989, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000,
        -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, 0.0156190916103989,  0.0138809728205007,  -0.0156190916103989,
        -0.0138809728205007, 1.1460320378031279,  0.2205247419605118,  -0.3516467755160456, -0.3516467755160456, -0.0000000000000000,
        -0.0000000000000000, -0.0159151533734929, 0.0159151533734929,  1.1460320378031279,  0.2205247419605118,  -0.1562397142558354,
        0.8620824456984002,  -1.9999999999999962, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000, -0.0000000000000000};

    CDenseMatrix refzangmom(intzvals, nrows, ncols);

    CAngularMomentumMatrix refmat(refxangmom, refyangmom, refzangmom, 1.0, 1.0, 1.0);

    ASSERT_EQ(refmat, angmommat);
}
